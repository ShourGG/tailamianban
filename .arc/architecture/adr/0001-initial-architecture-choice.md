# ADR-0001: 初始架构选择

## 状态
已接受 (Accepted)

## 上下文
我们需要为泰拉瑞亚服务器管理面板选择合适的技术架构。项目的核心目标是：

1. **一键部署** - 用户下载后直接使用，无需安装任何依赖
2. **简单易用** - 参考DST管理平台的简单快捷实现方式
3. **现代化界面** - 参考Robot_Admin的Vue3+TypeScript现代化界面
4. **Linux专用** - 仅在Linux环境运行，不考虑Windows兼容性
5. **单端口策略** - 所有功能通过一个端口访问，提高安全性

## 决策
我们选择以下技术架构：

### 后端技术栈
- **Go 1.21+** 作为主要编程语言
- **Gin框架** 作为Web框架
- **SQLite** 作为内嵌数据库
- **embed包** 用于内嵌前端静态资源
- **systemd** 用于系统服务管理

### 前端技术栈
- **Vue3** + **TypeScript** 作为前端框架
- **Naive UI** 作为UI组件库
- **Vite7** 作为构建工具
- **UnoCSS** 作为CSS框架
- **WebSocket** 用于实时通信

### 部署架构
- **单一二进制** - 所有功能打包在一个可执行文件中
- **内嵌前端** - 前端资源通过Go embed内嵌到二进制中
- **脚本管理** - 提供run.sh脚本进行服务管理
- **自动化安装** - 提供install.sh脚本一键安装

## 理由

### 选择Go语言的原因
1. **性能优秀** - 编译型语言，运行效率高
2. **部署简单** - 编译为单一二进制文件，无运行时依赖
3. **并发支持** - 原生goroutine支持，适合服务器管理场景
4. **跨平台** - 虽然我们只支持Linux，但Go的跨平台特性为未来扩展留下空间
5. **生态丰富** - 有丰富的第三方库支持

### 选择Gin框架的原因
1. **轻量级** - 性能优秀，内存占用小
2. **简单易用** - API设计简洁，学习成本低
3. **中间件支持** - 丰富的中间件生态
4. **文档完善** - 社区活跃，文档齐全

### 选择SQLite的原因
1. **零配置** - 无需单独安装数据库服务
2. **文件数据库** - 便于备份和迁移
3. **性能足够** - 对于单机应用性能完全满足
4. **ACID支持** - 支持事务，数据一致性有保障

### 选择Vue3+TypeScript的原因
1. **现代化** - 组合式API，开发体验优秀
2. **类型安全** - TypeScript提供类型检查
3. **生态丰富** - 组件库和工具链完善
4. **参考项目** - Robot_Admin已验证该技术栈的可行性

### 选择Naive UI的原因
1. **Vue3原生** - 专为Vue3设计，兼容性好
2. **TypeScript支持** - 完整的类型定义
3. **美观现代** - 设计风格现代化
4. **性能优秀** - 组件性能优化良好
5. **成功案例** - Robot_Admin项目已验证其可用性

### 选择单一二进制部署的原因
1. **部署简单** - 一个文件包含所有功能
2. **无依赖** - 不需要安装运行时环境
3. **便于分发** - 文件传输和版本管理简单
4. **参考成功** - DST管理平台已验证该方案的可行性

## 后果

### 积极后果
1. **部署极简** - 用户体验优秀，真正的一键部署
2. **维护简单** - 单一进程，问题排查容易
3. **性能优秀** - Go语言性能和SQLite效率保证
4. **开发效率** - 现代化前端技术栈提高开发效率
5. **安全性高** - 单端口策略减少攻击面

### 消极后果
1. **扩展限制** - 单体架构在大规模场景下扩展性有限
2. **技术绑定** - 深度绑定特定技术栈，迁移成本高
3. **资源共享** - 前后端共享进程资源，可能存在资源竞争

### 风险缓解
1. **扩展性问题** - 当前目标是单机部署，暂不考虑大规模扩展
2. **技术绑定** - 选择的都是成熟稳定的技术，风险可控
3. **资源竞争** - 通过合理的资源管理和监控来避免

## 替代方案

### 方案A：微服务架构
**优点**: 扩展性好，技术栈灵活
**缺点**: 部署复杂，运维成本高，不符合"一键部署"目标

### 方案B：传统LAMP/LNMP
**优点**: 技术成熟，社区支持好
**缺点**: 需要安装多个组件，部署复杂，不符合"零依赖"目标

### 方案C：Node.js全栈
**优点**: 前后端技术栈统一
**缺点**: 性能不如Go，运行时依赖Node.js环境

### 方案D：Python Django/Flask
**优点**: 开发效率高，库丰富
**缺点**: 运行时依赖Python环境，性能不如Go

## 相关决策
- ADR-0002: 数据库设计决策（待定）
- ADR-0003: 安全架构决策（待定）
- ADR-0004: 部署策略决策（待定）

## 注释
本决策基于对DST管理平台和Robot_Admin项目的深入分析，结合泰拉瑞亚面板的特定需求制定。

决策制定日期：2025-01-28
决策制定者：项目架构团队
复审日期：2025-04-28（3个月后复审）