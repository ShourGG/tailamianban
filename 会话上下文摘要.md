# æ³°æ‹‰ç‘äºšé¢æ¿é¡¹ç›® - ä¼šè¯ä¸Šä¸‹æ–‡æ‘˜è¦

## ğŸ“‹ é¡¹ç›®åŸºæœ¬ä¿¡æ¯

**é¡¹ç›®åç§°**: æ³°æ‹‰ç‘äºšæœåŠ¡å™¨ç®¡ç†é¢æ¿  
**æŠ€æœ¯æ ˆ**: Go + Gin + SQLite (åç«¯) / Vue3 + TypeScript + Naive UI (å‰ç«¯)  
**å½“å‰ç‰ˆæœ¬**: v1.1.9.11  
**GitHub ä»“åº“**: https://github.com/ShourGG/tailamianban

---

## ğŸ¯ æ ¸å¿ƒå¼€å‘è§„èŒƒï¼ˆé“å¾‹ï¼‰

### ç‰ˆæœ¬ç®¡ç†ä¸‰æ­¥èµ°
```bash
# 1. ä¿®æ”¹ä»£ç åæ›´æ–°ç‰ˆæœ¬å·
cd web
npm version patch  # è‡ªåŠ¨æ›´æ–° package.json

# 2. æäº¤ä»£ç 
git add .
git commit -m "ç±»å‹: ç®€çŸ­æè¿°"

# 3. æ‰“æ ‡ç­¾å¹¶æ¨é€ï¼ˆå¿…é¡»åˆ†ä¸¤æ­¥ï¼‰
git tag v1.x.x.x
git push origin main
git push origin v1.x.x.x  # æ ‡ç­¾å¿…é¡»å•ç‹¬æ¨é€
```

**âš ï¸ å…³é”®è§„åˆ™**ï¼š
- **æ¯æ¬¡ä¿®æ”¹ä»£ç ï¼ˆæ— è®ºå¤§å°ï¼‰éƒ½å¿…é¡»æ›´æ–°ç‰ˆæœ¬å·**
- **æ ‡ç­¾æ¨é€å¿…é¡»å•ç‹¬æ‰§è¡Œï¼Œä¸èƒ½åˆå¹¶åˆ°ä¸€æ¡å‘½ä»¤**
- **ç‰ˆæœ¬å·æ ¼å¼**: `ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·.è¡¥ä¸å·`ï¼ˆä¾‹å¦‚ï¼š1.1.9.11ï¼‰

---

## ğŸ”§ å·²è§£å†³çš„å…³é”®é—®é¢˜

### é—®é¢˜ 1: ç™»å½•è¡¨å•ä¸æ˜¾ç¤º âœ…
**ç—‡çŠ¶**: ç”¨æˆ·åå’Œå¯†ç è¾“å…¥æ¡†ä¸æ˜¾ç¤º  
**åŸå› **: ä½¿ç”¨äº†åŠ¨æ€ç»„ä»¶ `C_Form`ï¼Œä½†ç»„ä»¶æœªæ­£ç¡®æ³¨å†Œ  
**è§£å†³æ–¹æ¡ˆ**:
```vue
<!-- ä½¿ç”¨åŸç”Ÿ Naive UI ç»„ä»¶ -->
<NForm ref="formRef" :model="formModel" :rules="formRules">
  <NFormItem label="ç”¨æˆ·å" path="username">
    <NInput v-model:value="formModel.username" />
  </NFormItem>
  <NFormItem label="å¯†ç " path="password">
    <NInput v-model:value="formModel.password" type="password" />
  </NFormItem>
</NForm>
```

### é—®é¢˜ 2: Vite æ„å»ºå¤±è´¥ âœ…
**ç—‡çŠ¶**: æ„å»ºæ—¶æŠ¥é”™ `Cannot find module '../../package.json'`  
**åŸå› **: Vite ä¸æ”¯æŒåœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ç›´æ¥ import JSON æ–‡ä»¶  
**è§£å†³æ–¹æ¡ˆ**:
1. åˆ›å»º `web/src/config/version.ts` é…ç½®æ–‡ä»¶
2. åˆ›å»º `web/scripts/sync-version.js` åŒæ­¥è„šæœ¬
3. åœ¨ `package.json` ä¸­æ·»åŠ  `prebuild` hook è‡ªåŠ¨æ‰§è¡Œ

```json
{
  "scripts": {
    "prebuild": "node scripts/sync-version.js",
    "build": "env-manager prod && vite build"
  }
}
```

### é—®é¢˜ 3: è¡¨å•å®ä¾‹æœªå‡†å¤‡å¥½ âœ…
**ç—‡çŠ¶**: ç‚¹å‡»ç™»å½•æŒ‰é’®æŠ¥é”™ "Cannot read properties of null"  
**åŸå› **: è¡¨å• DOM å°šæœªå®Œå…¨æ¸²æŸ“  
**è§£å†³æ–¹æ¡ˆ**:
```typescript
// æ·»åŠ è¡¨å•å°±ç»ªçŠ¶æ€
const formReady = ref(false)

onMounted(() => {
  nextTick(() => {
    formReady.value = true
  })
})

const handleDirectLogin = (): void => {
  // å…ˆæ£€æŸ¥è¡¨å•æ˜¯å¦å‡†å¤‡å¥½
  if (!formReady.value || !formRef.value) {
    message.warning('è¡¨å•æ­£åœ¨åˆå§‹åŒ–ï¼Œè¯·ç¨å€™...')
    return
  }
  
  // å†æ‰§è¡Œè¡¨å•éªŒè¯
  formRef.value.validate((errors: any) => {
    // ...
  })
}
```

---

## ğŸš€ GitHub Actions å·¥ä½œæµç¨‹

### è§¦å‘æ¡ä»¶
1. **æ¨é€åˆ° main åˆ†æ”¯** â†’ è§¦å‘æ„å»ºï¼ˆä¸åˆ›å»º Releaseï¼‰
2. **æ¨é€ v* æ ‡ç­¾** â†’ è§¦å‘æ„å»º + åˆ›å»º Release

### æ„å»ºé˜¶æ®µ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ build-frontend  â”‚  (~2-3 åˆ†é’Ÿ)
â”‚ - å®‰è£…ä¾èµ–      â”‚
â”‚ - æ„å»º Vue é¡¹ç›® â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ build-backend   â”‚  (~3-5 åˆ†é’Ÿ)
â”‚ - ç¼–è¯‘ Go ç¨‹åº  â”‚
â”‚ - åµŒå…¥å‰ç«¯èµ„æº  â”‚
â”‚ - æ‰“åŒ…å‘å¸ƒæ–‡ä»¶  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ create-release  â”‚  (~1 åˆ†é’Ÿ)
â”‚ - ç”Ÿæˆå˜æ›´æ—¥å¿—  â”‚  â† åªåœ¨æ¨é€æ ‡ç­¾æ—¶æ‰§è¡Œ
â”‚ - åˆ›å»º Release  â”‚
â”‚ - ä¸Šä¼ å®‰è£…åŒ…    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ–°å¢åŠŸèƒ½ï¼šè‡ªåŠ¨ç”Ÿæˆæ›´æ–°æ—¥å¿— ğŸ†•
ç°åœ¨ Release æè¿°ä¼šè‡ªåŠ¨åˆ†ç±»æ˜¾ç¤ºæäº¤è®°å½•ï¼š
- âœ¨ æ–°å¢ç‰¹æ€§ (feat/feature)
- ğŸ› Bug ä¿®å¤ (fix)
- â™»ï¸ ä»£ç é‡æ„ (refactor)
- ğŸ“ æ–‡æ¡£æ›´æ–° (docs)
- ğŸ”§ æ„å»º/å·¥å…· (chore/build/ci)
- ğŸ”„ å…¶ä»–å˜æ›´

---

## ğŸ“ å…³é”®æ–‡ä»¶è·¯å¾„

### ç‰ˆæœ¬ç®¡ç†ç›¸å…³
- `web/package.json` - ç‰ˆæœ¬å·æºå¤´
- `web/src/config/version.ts` - å‰ç«¯ç‰ˆæœ¬å·é…ç½®ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
- `web/scripts/sync-version.js` - ç‰ˆæœ¬å·åŒæ­¥è„šæœ¬

### ç™»å½•é¡µé¢ç›¸å…³
- `web/src/views/login/index.vue` - ç™»å½•é¡µé¢ä¸»æ–‡ä»¶
- `web/src/views/login/index.scss` - ç™»å½•é¡µé¢æ ·å¼
- `web/src/views/login/data.ts` - ç™»å½•é¡µé¢æ•°æ®

### GitHub Actions
- `.github/workflows/release.yml` - æ„å»ºå’Œå‘å¸ƒå·¥ä½œæµ

### é¡¹ç›®æ–‡æ¡£
- `å¼€å‘åä½œè§„èŒƒ.md` - è¯¦ç»†çš„å¼€å‘è§„èŒƒï¼ˆ364è¡Œï¼‰
- `ä¼šè¯ä¸Šä¸‹æ–‡æ‘˜è¦.md` - æœ¬æ–‡ä»¶

---

## ğŸ” ä»£ç ç‰‡æ®µå‚è€ƒ

### ç™»å½•è¡¨å•å®Œæ•´å®ç°
```vue
<script setup lang="ts">
import { ref, onMounted, nextTick } from 'vue'
import { NForm, NFormItem, NInput, NButton } from 'naive-ui'
import { VERSION } from '@/config/version'

const formRef = ref<any>(null)
const formReady = ref(false)
const formModel = ref({
  username: 'admin',
  password: 'admin123'
})

const formRules = {
  username: [{ required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å', trigger: 'blur' }],
  password: [
    { required: true, message: 'è¯·è¾“å…¥å¯†ç ', trigger: 'blur' },
    { min: 6, max: 15, message: 'å¯†ç é•¿åº¦åœ¨ 6 åˆ° 15 ä¸ªå­—ç¬¦', trigger: 'blur' }
  ]
}

onMounted(() => {
  nextTick(() => {
    formReady.value = true
  })
})

const handleDirectLogin = (): void => {
  if (!formReady.value || !formRef.value) {
    message.warning('è¡¨å•æ­£åœ¨åˆå§‹åŒ–ï¼Œè¯·ç¨å€™...')
    return
  }
  
  if (!captchaValid.value) {
    message.error('è¯·å…ˆå®ŒæˆäººæœºéªŒè¯')
    return
  }

  formRef.value.validate((errors: any) => {
    if (errors) {
      message.error('è¡¨å•æ ¡éªŒå¤±è´¥,è¯·æ£€æŸ¥è¾“å…¥')
      return
    }
    
    const { username, password } = formModel.value
    const formScope = {
      model: {
        username,
        password,
        captcha: {
          token: captchaData.value!.token,
          timestamp: captchaData.value!.timestamp,
          type: 'puzzle-captcha',
        },
      }
    }
    
    login(formScope)
  })
}
</script>
```

### ç‰ˆæœ¬å·åŒæ­¥è„šæœ¬
```javascript
// web/scripts/sync-version.js
const fs = require('fs')
const path = require('path')

const packageJson = require('../package.json')
const version = packageJson.version

const versionConfig = `/**
 * ç‰ˆæœ¬å·é…ç½®
 * æ­¤æ–‡ä»¶ç”±æ„å»ºè„šæœ¬è‡ªåŠ¨ç”Ÿæˆï¼Œè¯·å‹¿æ‰‹åŠ¨ä¿®æ”¹
 */
export const VERSION = '${version}'
`

const targetPath = path.join(__dirname, '../src/config/version.ts')
fs.writeFileSync(targetPath, versionConfig, 'utf-8')

console.log(`âœ… ç‰ˆæœ¬å·å·²åŒæ­¥: ${version}`)
```

---

## ğŸ“ æäº¤è§„èŒƒ

### æ ¼å¼
```
<ç±»å‹>: <ç®€çŸ­æè¿°>

[å¯é€‰çš„è¯¦ç»†æè¿°]
```

### ç±»å‹è¯´æ˜
- `feat` / `âœ¨` - æ–°åŠŸèƒ½
- `fix` / `ğŸ›` - Bug ä¿®å¤
- `docs` / `ğŸ“` - æ–‡æ¡£æ›´æ–°
- `refactor` / `â™»ï¸` - ä»£ç é‡æ„
- `chore` / `ğŸ”§` - æ„å»º/å·¥å…·å˜æ›´
- `style` / `ğŸ’„` - ä»£ç æ ¼å¼è°ƒæ•´
- `test` / `âœ…` - æµ‹è¯•ç›¸å…³

### ç¤ºä¾‹
```bash
git commit -m "fix: ä¿®å¤ç™»å½•è¡¨å•æ˜¾ç¤ºé—®é¢˜"
git commit -m "feat: æ·»åŠ ç‰ˆæœ¬å·è‡ªåŠ¨åŒæ­¥æœºåˆ¶"
git commit -m "docs: æ›´æ–°å¼€å‘åä½œè§„èŒƒæ–‡æ¡£"
```

---

## ğŸ¤– AI åŠ©æ‰‹åä½œè¦ç‚¹

### æ¯æ¬¡ä¿®æ”¹ä»£ç åå¿…é¡»æ£€æŸ¥ï¼š
1. âœ… ç‰ˆæœ¬å·æ˜¯å¦å·²æ›´æ–°ï¼ˆ`web/package.json`ï¼‰
2. âœ… ä»£ç æ˜¯å¦å·²æäº¤åˆ° Git
3. âœ… æ ‡ç­¾æ˜¯å¦å·²åˆ›å»º
4. âœ… ä»£ç æ˜¯å¦å·²æ¨é€åˆ° main åˆ†æ”¯
5. âœ… æ ‡ç­¾æ˜¯å¦å·²å•ç‹¬æ¨é€åˆ°è¿œç¨‹
6. âœ… GitHub Actions æ˜¯å¦æ­£åœ¨è¿è¡Œ
7. âœ… æ„å»ºæ˜¯å¦æˆåŠŸ
8. âœ… Release æ˜¯å¦å·²åˆ›å»ºï¼ˆå¦‚æœæ¨é€äº†æ ‡ç­¾ï¼‰

### æ ‡å‡†æ“ä½œæµç¨‹ç¤ºä¾‹ï¼š
```bash
# å‡è®¾ä¿®å¤äº†ä¸€ä¸ª bug
cd web
npm version patch  # 1.1.9.11 -> 1.1.9.12

cd ..
git add .
git commit -m "fix: ä¿®å¤æŸä¸ªé—®é¢˜"

git tag v1.1.9.12
git push origin main      # å…ˆæ¨é€ä»£ç 
git push origin v1.1.9.12 # å†æ¨é€æ ‡ç­¾

# ç­‰å¾… 5-10 åˆ†é’Ÿï¼ŒGitHub Actions ä¼šè‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒ
```

---

## ğŸ“Š ç‰ˆæœ¬å†å²è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¸»è¦å˜æ›´ |
|------|------|----------|
| v1.1.9.11 | 2025-01-01 | åˆ›å»ºå¼€å‘åä½œè§„èŒƒæ–‡æ¡£ |
| v1.1.9.10 | 2025-01-01 | ä¿®å¤è¡¨å•å®ä¾‹æœªå‡†å¤‡å¥½é”™è¯¯ |
| v1.1.9.9 | 2025-01-01 | ä¿®å¤ç™»å½•è¡¨å•æ˜¾ç¤ºå’Œæ„å»ºé—®é¢˜ |

---

## ğŸ”— ç›¸å…³èµ„æº

- **GitHub ä»“åº“**: https://github.com/ShourGG/tailamianban
- **è¯¦ç»†å¼€å‘è§„èŒƒ**: å‚è§é¡¹ç›®æ ¹ç›®å½• `å¼€å‘åä½œè§„èŒƒ.md`
- **Naive UI æ–‡æ¡£**: https://www.naiveui.com/
- **Vue 3 æ–‡æ¡£**: https://cn.vuejs.org/
- **Vite æ–‡æ¡£**: https://cn.vitejs.dev/

---

## ğŸ’¡ å¸¸è§é—®é¢˜ FAQ

### Q: ä¸ºä»€ä¹ˆæ¨é€æ ‡ç­¾åæ²¡æœ‰åˆ›å»º Releaseï¼Ÿ
A: ç¡®ä¿æ ‡ç­¾å·²æ­£ç¡®æ¨é€åˆ°è¿œç¨‹ã€‚ä½¿ç”¨ `git push origin v1.x.x.x` å•ç‹¬æ¨é€æ ‡ç­¾ã€‚

### Q: å¦‚ä½•æŸ¥çœ‹ GitHub Actions æ„å»ºçŠ¶æ€ï¼Ÿ
A: è®¿é—®ä»“åº“é¡µé¢ï¼Œç‚¹å‡» "Actions" æ ‡ç­¾é¡µï¼ŒæŸ¥çœ‹æœ€æ–°çš„å·¥ä½œæµè¿è¡ŒçŠ¶æ€ã€‚

### Q: ç‰ˆæœ¬å·åº”è¯¥å¦‚ä½•é€’å¢ï¼Ÿ
A: 
- è¡¥ä¸å·ï¼ˆæœ€åä¸€ä½ï¼‰ï¼šå°ä¿®å¤ã€æ–‡æ¡£æ›´æ–°
- ä¿®è®¢å·ï¼ˆç¬¬ä¸‰ä½ï¼‰ï¼šè¾ƒå¤§çš„ä¿®å¤ã€å°åŠŸèƒ½
- æ¬¡ç‰ˆæœ¬å·ï¼ˆç¬¬äºŒä½ï¼‰ï¼šæ–°åŠŸèƒ½ã€é‡æ„
- ä¸»ç‰ˆæœ¬å·ï¼ˆç¬¬ä¸€ä½ï¼‰ï¼šé‡å¤§æ¶æ„å˜æ›´ã€ä¸å…¼å®¹æ›´æ–°

---

**æœ€åæ›´æ–°**: 2025-01-01  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0