import{k as de,az as pe,c as F,r as m,Q as g,R as d,S as a,U as t,K as l,V as r,j as o,F as b,N as w,_ as T,$ as u,Y as $,m as D}from"./vue-vendor-B-HGZVTd.js";import{am as me,K as n,J as K,aa as fe,ab as L,M as z,S as I,H as f,aM as R,aN as H,aO as V,a7 as k,as as ve,T as ye,U as ge,aK as ce,aF as ke,aB as _e,aL as be,ac as we,a4 as N,aD as j,aE as v,R as Te,a2 as Me,ag as xe}from"./ui-vendor-C2DiPTQI.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ce={class:"mod-market-page"},Se={class:"text-sm text-gray-600"},he={class:"text-xs text-gray-500"},$e={class:"text-xs text-gray-500"},Le={class:"text-xs text-gray-500"},Ie={key:0},Ue={key:1},De=de({__name:"mod-market",setup(Ne){const E=pe(),y=me(),G=E.params.id,Z=F(()=>({Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`})),C=m(""),P=m("workshop"),M=m(""),c=m(!1),S=m(!1),x=m(!1),U=m(!1),h=m("all"),p=m(null),A=m([{id:"1",name:"Calamity Mod（灾厄）",description:"大型内容扩展Mod，添加了大量新的Boss、武器、敌怪和生物群落",author:"Fabsol",version:"v2.0.5.007",workshopId:"2850907660",subscribers:"2.3M",icon:"https://example.com/calamity.png"},{id:"2",name:"Thorium Mod（钍）",description:"大量新武器、盔甲、Boss和三个新职业",author:"DivermanSam",version:"v1.7.4.2",workshopId:"2909886416",subscribers:"1.8M",icon:"https://example.com/thorium.png"},{id:"3",name:"Magic Storage（魔法存储）",description:"强大的物品存储系统，可以连接多个箱子统一管理",author:"blushiemagic",version:"v0.6.2.1",workshopId:"2563309347",subscribers:"1.5M",icon:"https://example.com/magic-storage.png"},{id:"4",name:"Fargo's Mod（法尔戈）",description:"添加多种质量改进和便利功能",author:"Fargowilta",version:"v4.0.2",workshopId:"2844616031",subscribers:"1.2M",icon:"https://example.com/fargos.png"}]),O=[{key:"all",label:"全部"},{key:"admin",label:"管理工具"},{key:"economy",label:"经济系统"},{key:"protection",label:"保护类"},{key:"gameplay",label:"游戏玩法"},{key:"utility",label:"实用工具"}],Q=m([{id:"ssc",name:"SSC (Server Side Characters)",description:"服务器端人物存档系统，防止玩家使用修改器",author:"TShock Team",version:"v5.2",downloads:"150K",official:!0,category:"admin",tags:["反作弊","必备"],features:["服务器端存储玩家数据","防止修改器作弊","支持备份恢复","跨服角色同步"],commands:["/ssc enable - 启用SSC","/ssc disable - 禁用SSC","/ssc reset <玩家> - 重置玩家数据"],updateTime:"2024-01-15"},{id:"economics",name:"Economics（经济系统）",description:"完整的服务器经济系统，支持货币、商店、交易等",author:"MistZZT",version:"v3.5.1",downloads:"120K",official:!1,category:"economy",tags:["经济","商店","货币"],features:["虚拟货币系统","可自定义商店","玩家间转账","签到奖励","商店购买记录"],commands:["/balance - 查看余额","/shop - 打开商店","/pay <玩家> <金额> - 转账","/sign - 每日签到"],updateTime:"2024-02-20"},{id:"regiontrigger",name:"Region Trigger",description:"领地触发器，玩家进入特定区域时执行命令",author:"Ancientgods",version:"v2.1",downloads:"80K",official:!1,category:"protection",tags:["领地","触发器"],features:["进入/离开区域执行命令","定时触发","消息提示","权限控制"],commands:["/rt define <区域> - 定义触发器","/rt add <区域> <命令> - 添加命令","/rt enable <区域> - 启用触发器"],updateTime:"2024-01-10"},{id:"timerate",name:"Time Rate",description:"时间倍率调整插件，可以加快或减慢游戏时间",author:"InanZen",version:"v1.3",downloads:"60K",official:!1,category:"gameplay",tags:["时间","游戏玩法"],features:["调整时间流速","快速跳过夜晚","固定时间段","自动调整"],commands:["/time rate <倍率> - 设置时间倍率","/time set <时间> - 设置时间","/time freeze - 冻结时间"],updateTime:"2023-12-15"},{id:"crossplay",name:"Crossplay",description:"跨版本插件，允许不同版本客户端连接服务器",author:"Moneylover3246",version:"v1.10.2",downloads:"95K",official:!1,category:"utility",tags:["跨版本","兼容性"],features:["支持多个游戏版本","自动版本适配","物品ID转换","协议兼容"],commands:["/crossplay info - 查看版本信息","/crossplay reload - 重载配置"],updateTime:"2024-03-01"},{id:"autoplugin",name:"AutoPlugin",description:"自动化管理插件，自动执行定时任务",author:"Zoom",version:"v2.0",downloads:"55K",official:!1,category:"admin",tags:["自动化","定时任务"],features:["定时重启服务器","自动备份","定时广播","自动清理"],commands:["/auto add <任务> - 添加任务","/auto list - 查看任务列表","/auto remove <任务> - 删除任务"],updateTime:"2024-02-10"}]),q=F(()=>{let i=Q.value;if(h.value!=="all"&&(i=i.filter(e=>e.category===h.value)),C.value){const e=C.value.toLowerCase();i=i.filter(s=>s.name.toLowerCase().includes(e)||s.description.toLowerCase().includes(e)||s.author.toLowerCase().includes(e))}return i}),J=m([{id:"1",name:"TShock官方论坛",description:"TShock官方插件发布论坛",url:"https://forums.terraria.org/index.php?forums/released.119/",type:"TShock插件",trusted:!0},{id:"2",name:"bbstr.net镜像站",description:"国内访问友好的模组镜像站",url:"https://mirror.bbstr.net/",type:"Mod模组",trusted:!0},{id:"3",name:"sgkoi.dev镜像",description:"模组下载镜像",url:"http://mirror.sgkoi.dev/",type:"Mod模组",trusted:!0},{id:"4",name:"Calamity官方下载",description:"灾厄Mod官方论坛下载页",url:"https://forums.terraria.org/index.php?threads/calamity-mod.44065/",type:"Mod模组",trusted:!0},{id:"5",name:"汉化者Mod",description:"泰拉瑞亚汉化Mod",url:"https://github.com/chi-rei-den/localizer/releases",type:"Mod模组",trusted:!0},{id:"6",name:"GitHub - TShock",description:"TShock官方GitHub仓库",url:"https://github.com/Pryaxis/TShock/releases/",type:"TShock服务端",trusted:!0},{id:"7",name:"GitHub - tModLoader",description:"tModLoader官方GitHub仓库",url:"https://github.com/tModLoader/tModLoader/releases",type:"tModLoader服务端",trusted:!0},{id:"8",name:"Crossplay跨版本插件",description:"允许不同版本玩家连接的插件",url:"https://github.com/Moneylover3246/Crossplay/releases/tag/1.10.2",type:"TShock插件",trusted:!0}]),W=m([{id:"1",name:"Calamity Mod",type:"Mod",version:"v2.0.5.007",enabled:!0,size:"125 MB",installTime:"2024-01-15 10:30:00"}]),Y=[{title:"名称",key:"name"},{title:"类型",key:"type"},{title:"版本",key:"version"},{title:"状态",key:"enabled",render:i=>D(xe,{value:i.enabled,onUpdateValue:e=>le(i,e)})},{title:"大小",key:"size"},{title:"安装时间",key:"installTime"},{title:"操作",key:"actions",render:i=>D(n,{},{default:()=>[D(f,{size:"small",onClick:()=>ae(i)},{default:()=>"卸载"})]})}],X=async()=>{if(!M.value){y.warning("请输入Workshop URL或ID");return}c.value=!0;try{const i=M.value.match(/id=(\d+)/)||M.value.match(/^(\d+)$/);if(!i)throw new Error("无效的Workshop URL或ID");const e=i[1];await new Promise(s=>setTimeout(s,2e3)),y.success(`正在从Workshop下载模组 ${e}`),M.value=""}catch(i){y.error(i.message||"安装失败")}finally{c.value=!1}},ee=async i=>{c.value=!0;try{await new Promise(e=>setTimeout(e,2e3)),y.success(`${i.name} 安装成功`)}catch{y.error("安装失败")}finally{c.value=!1}},B=async i=>{c.value=!0;try{await new Promise(e=>setTimeout(e,2e3)),y.success(`${i.name} 安装成功`),x.value=!1}catch{y.error("安装失败")}finally{c.value=!1}},te=i=>{p.value=i,x.value=!0},le=(i,e)=>{i.enabled=e,y.success(`${i.name} 已${e?"启用":"禁用"}`)},ae=i=>{y.warning(`确定要卸载 ${i.name} 吗？`)},se=()=>{window.open("https://steamcommunity.com/workshop/browse/?appid=1281930","_blank")},oe=i=>{window.open(i,"_blank")},ie=()=>{},re=()=>{y.success("列表已刷新")},ne=()=>{y.success("上传成功"),S.value=!1},ue=()=>{U.value=!0};return(i,e)=>(d(),g("div",Ce,[a(l(I),{title:"模组/插件市场",bordered:!1},{"header-extra":t(()=>[a(l(n),null,{default:t(()=>[a(l(f),{onClick:e[0]||(e[0]=s=>S.value=!0)},{icon:t(()=>[...e[9]||(e[9]=[r("i",{class:"i-mdi:upload"},null,-1)])]),default:t(()=>[e[10]||(e[10]=o(" 本地上传 ",-1))]),_:1}),a(l(f),{type:"primary",onClick:re},{icon:t(()=>[...e[11]||(e[11]=[r("i",{class:"i-mdi:refresh"},null,-1)])]),default:t(()=>[e[12]||(e[12]=o(" 刷新列表 ",-1))]),_:1})]),_:1})]),default:t(()=>[a(l(n),{vertical:"",size:"large"},{default:t(()=>[a(l(K),{value:C.value,"onUpdate:value":e[1]||(e[1]=s=>C.value=s),placeholder:"搜索模组/插件名称、ID、作者...",clearable:"",onInput:ie},{prefix:t(()=>[...e[13]||(e[13]=[r("i",{class:"i-mdi:magnify"},null,-1)])]),_:1},8,["value"]),a(l(fe),{value:P.value,"onUpdate:value":e[3]||(e[3]=s=>P.value=s),type:"segment"},{default:t(()=>[a(l(L),{name:"workshop",tab:"Steam Workshop"},{default:t(()=>[a(l(n),{vertical:"",size:"large",class:"mt-4"},{default:t(()=>[a(l(z),{type:"info",bordered:!1},{icon:t(()=>[...e[14]||(e[14]=[r("i",{class:"i-mdi:steam"},null,-1)])]),default:t(()=>[e[15]||(e[15]=o(" 输入Steam创意工坊URL或ID即可下载模组 ",-1))]),_:1}),a(l(I),{title:"从Workshop安装",size:"small"},{default:t(()=>[a(l(n),{vertical:""},{default:t(()=>[a(l(K),{value:M.value,"onUpdate:value":e[2]||(e[2]=s=>M.value=s),placeholder:"粘贴Workshop URL或ID，如：https://steamcommunity.com/sharedfiles/filedetails/?id=2909886416",clearable:""},{prefix:t(()=>[...e[16]||(e[16]=[r("i",{class:"i-mdi:steam"},null,-1)])]),_:1},8,["value"]),a(l(n),null,{default:t(()=>[a(l(f),{type:"primary",onClick:X,loading:c.value},{icon:t(()=>[...e[17]||(e[17]=[r("i",{class:"i-mdi:download"},null,-1)])]),default:t(()=>[e[18]||(e[18]=o(" 立即安装 ",-1))]),_:1},8,["loading"]),a(l(f),{onClick:se},{icon:t(()=>[...e[19]||(e[19]=[r("i",{class:"i-mdi:open-in-new"},null,-1)])]),default:t(()=>[e[20]||(e[20]=o(" 打开Workshop ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),a(l(I),{title:"热门模组",size:"small"},{default:t(()=>[a(l(R),{bordered:""},{default:t(()=>[(d(!0),g(b,null,w(A.value,s=>(d(),T(l(H),{key:s.id},{prefix:t(()=>[a(l(ve),{src:s.icon},null,8,["src"])]),default:t(()=>[a(l(V),{title:s.name,description:s.description},{"header-extra":t(()=>[a(l(n),null,{default:t(()=>[a(l(k),{type:"info",size:"small"},{icon:t(()=>[...e[21]||(e[21]=[r("i",{class:"i-mdi:download"},null,-1)])]),default:t(()=>[o(" "+u(s.subscribers),1)]),_:2},1024),a(l(f),{size:"small",onClick:_=>ee(s),loading:c.value},{default:t(()=>[...e[22]||(e[22]=[o(" 安装 ",-1)])]),_:1},8,["onClick","loading"])]),_:2},1024)]),description:t(()=>[a(l(n),{vertical:"",size:"small"},{default:t(()=>[r("div",null,u(s.description),1),a(l(n),{size:"small"},{default:t(()=>[a(l(k),{size:"tiny"},{default:t(()=>[o("作者: "+u(s.author),1)]),_:2},1024),a(l(k),{size:"tiny",type:"success"},{default:t(()=>[o(u(s.version),1)]),_:2},1024),a(l(k),{size:"tiny",type:"warning"},{default:t(()=>[o("Workshop ID: "+u(s.workshopId),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title","description"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),a(l(L),{name:"plugins",tab:"TShock插件"},{default:t(()=>[a(l(n),{vertical:"",size:"large",class:"mt-4"},{default:t(()=>[a(l(z),{type:"info",bordered:!1},{icon:t(()=>[...e[23]||(e[23]=[r("i",{class:"i-mdi:puzzle"},null,-1)])]),default:t(()=>[e[24]||(e[24]=o(" TShock插件可以扩展服务器功能，如权限管理、经济系统、传送系统等 ",-1))]),_:1}),a(l(n),null,{default:t(()=>[(d(),g(b,null,w(O,s=>a(l(f),{key:s.key,type:h.value===s.key?"primary":"default",onClick:_=>h.value=s.key},{default:t(()=>[o(u(s.label),1)]),_:2},1032,["type","onClick"])),64))]),_:1}),a(l(ye),{"x-gap":16,"y-gap":16,cols:2},{default:t(()=>[(d(!0),g(b,null,w(q.value,s=>(d(),T(l(ge),{key:s.id},{default:t(()=>[a(l(I),{size:"small",title:s.name,hoverable:""},{"header-extra":t(()=>[a(l(n),null,{default:t(()=>[s.official?(d(),T(l(k),{key:0,type:"success",size:"small"},{default:t(()=>[...e[25]||(e[25]=[o("官方",-1)])]),_:1})):$("",!0),a(l(k),{type:"info",size:"small"},{default:t(()=>[o(u(s.version),1)]),_:2},1024)]),_:2},1024)]),default:t(()=>[a(l(n),{vertical:"",size:"small"},{default:t(()=>[r("div",Se,u(s.description),1),a(l(n),{size:"small"},{default:t(()=>[(d(!0),g(b,null,w(s.tags,_=>(d(),T(l(k),{size:"tiny",key:_},{default:t(()=>[o(u(_),1)]),_:2},1024))),128))]),_:2},1024),a(l(n),{justify:"space-between",align:"center"},{default:t(()=>[a(l(n),{size:"small"},{default:t(()=>[r("span",he,"作者: "+u(s.author),1),r("span",$e,"下载: "+u(s.downloads),1)]),_:2},1024),a(l(n),null,{default:t(()=>[a(l(f),{size:"small",text:"",onClick:_=>te(s)},{default:t(()=>[...e[26]||(e[26]=[o(" 详情 ",-1)])]),_:1},8,["onClick"]),a(l(f),{size:"small",type:"primary",onClick:_=>B(s),loading:c.value},{default:t(()=>[...e[27]||(e[27]=[o(" 安装 ",-1)])]),_:1},8,["onClick","loading"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),a(l(L),{name:"thirdparty",tab:"第三方源"},{default:t(()=>[a(l(n),{vertical:"",size:"large",class:"mt-4"},{default:t(()=>[a(l(z),{type:"warning",bordered:!1},{icon:t(()=>[...e[28]||(e[28]=[r("i",{class:"i-mdi:alert"},null,-1)])]),default:t(()=>[e[29]||(e[29]=o(" 第三方源的模组可能未经验证，请谨慎使用 ",-1))]),_:1}),a(l(R),{bordered:""},{default:t(()=>[(d(!0),g(b,null,w(J.value,s=>(d(),T(l(H),{key:s.id},{default:t(()=>[a(l(V),{title:s.name,description:s.description},{"header-extra":t(()=>[a(l(f),{size:"small",onClick:_=>oe(s.url),type:"primary"},{icon:t(()=>[...e[30]||(e[30]=[r("i",{class:"i-mdi:open-in-new"},null,-1)])]),default:t(()=>[e[31]||(e[31]=o(" 访问 ",-1))]),_:1},8,["onClick"])]),description:t(()=>[a(l(n),{vertical:"",size:"small"},{default:t(()=>[r("div",null,u(s.description),1),a(l(n),{size:"small"},{default:t(()=>[a(l(k),{size:"tiny",type:s.trusted?"success":"warning"},{default:t(()=>[o(u(s.trusted?"可信源":"第三方源"),1)]),_:2},1032,["type"]),a(l(k),{size:"tiny"},{default:t(()=>[o(u(s.type),1)]),_:2},1024)]),_:2},1024),r("div",Le,u(s.url),1)]),_:2},1024)]),_:2},1032,["title","description"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),a(l(L),{name:"installed",tab:"已安装"},{default:t(()=>[a(l(n),{vertical:"",size:"large",class:"mt-4"},{default:t(()=>[a(l(n),{justify:"space-between"},{default:t(()=>[a(l(ce),{label:"已安装数量",value:W.value.length},null,8,["value"]),a(l(f),{onClick:ue},{icon:t(()=>[...e[32]||(e[32]=[r("i",{class:"i-mdi:folder-open"},null,-1)])]),default:t(()=>[e[33]||(e[33]=o(" 查看安装路径 ",-1))]),_:1})]),_:1}),a(l(ke),{columns:Y,data:W.value,pagination:{pageSize:10},bordered:!1},null,8,["data"])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),a(l(N),{show:S.value,"onUpdate:show":e[4]||(e[4]=s=>S.value=s),preset:"card",title:"上传本地文件",style:{width:"600px"}},{default:t(()=>[a(l(n),{vertical:""},{default:t(()=>[a(l(z),{type:"info",bordered:!1},{icon:t(()=>[...e[34]||(e[34]=[r("i",{class:"i-mdi:information"},null,-1)])]),default:t(()=>[e[35]||(e[35]=o(" 支持上传 .tmod 文件（TModLoader）或 .dll 文件（TShock插件） ",-1))]),_:1}),a(l(_e),{action:`/api/terraria/rooms/${l(G)}/mods/upload`,headers:Z.value,onFinish:ne},{default:t(()=>[a(l(be),null,{default:t(()=>[e[37]||(e[37]=r("div",{style:{"margin-bottom":"12px"}},[r("i",{class:"i-mdi:cloud-upload text-5xl"})],-1)),a(l(we),null,{default:t(()=>[...e[36]||(e[36]=[o("点击或拖拽文件到此区域上传",-1)])]),_:1})]),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1},8,["show"]),a(l(N),{show:x.value,"onUpdate:show":e[7]||(e[7]=s=>x.value=s),preset:"card",title:p.value?.name,style:{width:"800px"}},{footer:t(()=>[a(l(n),{justify:"end"},{default:t(()=>[a(l(f),{onClick:e[5]||(e[5]=s=>x.value=!1)},{default:t(()=>[...e[41]||(e[41]=[o("关闭",-1)])]),_:1}),a(l(f),{type:"primary",onClick:e[6]||(e[6]=s=>B(p.value)),loading:c.value},{default:t(()=>[...e[42]||(e[42]=[o(" 安装 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:t(()=>[p.value?(d(),T(l(n),{key:0,vertical:""},{default:t(()=>[a(l(j),{bordered:"",column:2},{default:t(()=>[a(l(v),{label:"版本"},{default:t(()=>[o(u(p.value.version),1)]),_:1}),a(l(v),{label:"作者"},{default:t(()=>[o(u(p.value.author),1)]),_:1}),a(l(v),{label:"下载量"},{default:t(()=>[o(u(p.value.downloads),1)]),_:1}),a(l(v),{label:"更新时间"},{default:t(()=>[o(u(p.value.updateTime),1)]),_:1})]),_:1}),a(l(Te)),r("div",null,[e[38]||(e[38]=r("h4",null,"功能介绍",-1)),r("p",null,u(p.value.description),1)]),p.value.features?(d(),g("div",Ie,[e[39]||(e[39]=r("h4",null,"主要特性",-1)),r("ul",null,[(d(!0),g(b,null,w(p.value.features,s=>(d(),g("li",{key:s},u(s),1))),128))])])):$("",!0),p.value.commands?(d(),g("div",Ue,[e[40]||(e[40]=r("h4",null,"指令列表",-1)),a(l(n),{vertical:"",size:"small"},{default:t(()=>[(d(!0),g(b,null,w(p.value.commands,s=>(d(),T(l(Me),{key:s},{default:t(()=>[o(u(s),1)]),_:2},1024))),128))]),_:1})])):$("",!0)]),_:1})):$("",!0)]),_:1},8,["show","title"]),a(l(N),{show:U.value,"onUpdate:show":e[8]||(e[8]=s=>U.value=s),preset:"card",title:"安装路径信息",style:{width:"700px"}},{default:t(()=>[a(l(n),{vertical:""},{default:t(()=>[a(l(z),{type:"info",bordered:!1},{default:t(()=>[...e[43]||(e[43]=[o(" 根据服务器类型，文件会安装到以下路径 ",-1)])]),_:1}),a(l(j),{bordered:"",column:1},{default:t(()=>[a(l(v),{label:"原版游戏启动程序"},{default:t(()=>[...e[44]||(e[44]=[o(" /root/Terraria/server/Linux/ ",-1)])]),_:1}),a(l(v),{label:"原版游戏存档"},{default:t(()=>[...e[45]||(e[45]=[o(" /root/Terraria/Worlds/ ",-1)])]),_:1}),a(l(v),{label:"MOD版启动程序"},{default:t(()=>[...e[46]||(e[46]=[o(" /root/Terraria/TMLserver/ ",-1)])]),_:1}),a(l(v),{label:"MOD版存档"},{default:t(()=>[...e[47]||(e[47]=[o(" /root/Terraria/WorldsTML/ ",-1)])]),_:1}),a(l(v),{label:"模组文件"},{default:t(()=>[...e[48]||(e[48]=[o(" /root/Terraria/Mods/ ",-1)])]),_:1}),a(l(v),{label:"插件版启动程序"},{default:t(()=>[...e[49]||(e[49]=[o(" /root/Terraria/TSserver/ ",-1)])]),_:1}),a(l(v),{label:"插件版存档"},{default:t(()=>[...e[50]||(e[50]=[o(" /root/Terraria/WorldsTS/ ",-1)])]),_:1}),a(l(v),{label:"插件文件"},{default:t(()=>[...e[51]||(e[51]=[o(" /root/Terraria/TSserver/ServerPlugins/ ",-1)])]),_:1}),a(l(v),{label:"Mod配置文件 (1.4版)"},{default:t(()=>[...e[52]||(e[52]=[o(" /root/.local/share/Terraria/tModLoader/Mod Configs ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])]))}}),Fe=ze(De,[["__scopeId","data-v-1a8ccf17"]]);export{Fe as default};
