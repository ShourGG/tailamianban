import{P as B,_ as O}from"./index.vue_vue_type_script_setup_true_lang-U37ubnC8.js";import{r as i,k as V,aF as L,Q as P,_ as $,Y as A,V as _,K as l,S as d,$ as b,U as E,aE as G,j as I,R as S}from"./vue-vendor-B-HGZVTd.js";import{n as y,c as U,l as Y,i as z}from"./index-CZdsPYOi.js";import{a as W}from"./ParentSize.vue_vue_type_script_setup_true_lang-Clm6hvFF.js";import{_ as q}from"./Spline.vue_vue_type_script_setup_true_lang-JHiQxtXu.js";import J from"./index-BNAf0YSU.js";import K from"./Typewriter-Dcsyi-K-.js";import{am as Q,H as Z}from"./ui-vendor-C2DiPTQI.js";import"./index-CcExhs5G.js";import"./charts-vendor-CzveNv9z.js";import"./editor-vendor-CkYh0R4B.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./spline-vendor-CTguZ3V6.js";const{required:k,length:X}=B,ee=[{type:"input",value:"CHENY",prop:"username",placeholder:"请输入用户名",rules:[k("用户名")],attrs:{clearable:!0,prefixIcon:"user"}},{type:"input",value:"123456",placeholder:"请输入密码",prop:"password",rules:[k("密码"),X("密码",6,15)],attrs:{type:"password",showPasswordOn:"mousedown",clearable:!0}}],te=()=>{const u=i(!1),p=()=>{y.error({content:"表单实例未准备好",duration:3e3})},g=async a=>await a.form.validate(),m=(a,e)=>{if(a.code===(e.successCode||"0")){e.onSuccess?.(a);const s=e.successMsg||"提交成功";let r;return e.meta&&(r=typeof e.meta=="function"?e.meta(a):e.meta),y.success({content:s,meta:r,duration:3e3}),!0}return!1},h=(a,e)=>{e.globalErrorHandler&&e.globalErrorHandler(a),y.error({content:a instanceof Error?a.message:"提交失败",duration:3e3})};return{loading:u,createSubmit:(a,e={})=>{const s=e.debounce!==!1?W(a,e.debounce||500):a;return async r=>{if(!r.form){p();return}try{await g(r),u.value=!0;const n=await s(r.model);if(m(n,e))return n;throw new Error(n.message||e.errorMsg||"操作失败")}catch(n){throw h(n,e),n}finally{u.value=!1}}}}},ae={class:"login-container bg-[#181818]"},re={class:"spline-background"},se={class:"login-wrapper"},ve=V({__name:"index",setup(u){const p=L(),g=U(),m=Q(),{loading:h,createSubmit:v}=te(),a=i(!0),e=i(),s=i(!1),r=i(null),n={timeSlots:[{hours:[6,12],greeting:"早上好",emoji:"🌅"},{hours:[12,14],greeting:"中午好",emoji:"☀️"},{hours:[14,18],greeting:"下午好",emoji:"🌤️"},{hours:[18,22],greeting:"晚上好",emoji:"🌆"},{hours:[22,24,0,6],greeting:"夜深了",emoji:"🌙"}],templates:["{greeting}，{username}！欢迎回来～ {emoji}","{emoji} {greeting}，{username}！开始今天的工作吧","欢迎回来，{username}！{greeting} {emoji}","{greeting}，{username}！准备好了吗？ {emoji}"]},j=()=>{const t=new Date().getHours();return n.timeSlots.find(({hours:c})=>c.length===2?t>=c[0]&&t<c[1]:c.includes(t))||n.timeSlots[0]},M=t=>{const o=t.data?.username||"CHENY",{greeting:c,emoji:f}=j();return n.templates[Math.floor(Math.random()*n.templates.length)].replace("{greeting}",c).replace("{username}",o).replace("{emoji}",f)},H=()=>{},N=()=>{a.value=!1},R=t=>{s.value=!0,r.value=t,m.success("人机验证成功")},F=()=>{s.value=!1,r.value=null},x=t=>{s.value=t,t||(r.value=null)},C=()=>{s.value=!1,r.value=null,e.value?.reset()},D=t=>{if(!s.value||!r.value){m.error("请先完成人机验证");return}t.model={...t.model,captcha:{token:r.value.token,timestamp:r.value.timestamp,type:"puzzle-captcha"}},T(t)},T=v(Y,{successMsg:"登录成功",meta:M,errorMsg:"账号或密码错误",onSuccess:async t=>{try{const{data:{token:o}}=t;g.handleLoginSuccess(o),await z(),p.push("/home")}catch{C()}},globalErrorHandler:t=>{C()}});return(t,o)=>{const c=Z,f=O;return S(),P("div",ae,[l(a)?(S(),$(K,{key:0,text:"Hey！伙计，欢迎来到我的世界。",duration:2e3,delay:300,"pause-after":1e3,onComplete:H,onHidden:N})):A("",!0),_("div",re,[d(q,{scene:"https://prod.spline.design/kZDDjO5HuC9GJUM2/scene.splinecode"})]),_("div",se,[o[0]||(o[0]=_("h3",{class:"login-title"},b("Robot Admin 管理系统"),-1)),d(f,{class:"login-form",options:l(ee)},{action:E(w=>[d(c,{class:"login-btn",type:"primary",loading:l(h),disabled:!l(s),onClick:G(ne=>D(w),["prevent"])},{default:E(()=>[I(b(l(s)?"登录":"请先点击下方图标完成人机验证"),1)]),_:1},8,["loading","disabled","onClick"])]),_:1},8,["options"]),d(J,{ref_key:"captchaRef",ref:e,class:"login-captcha","trigger-text":"",theme:"dark",onSuccess:R,onFail:F,onChange:x},null,512)])])}}});export{ve as default};
