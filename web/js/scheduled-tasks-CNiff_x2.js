import{am as A,aG as G,K as d,S as M,a7 as w,ag as N,H as c,ad as H,P as J,Q as r,V as $,J as _,X as q,Y as k,a9 as R,R as L,a4 as X}from"./ui-vendor-C2DiPTQI.js";import{k as W,r as T,c as Z,Q as C,R as i,S as t,U as a,K as l,_ as v,Y as p,F as z,N as h,V as m,I as E,$ as g,j as o}from"./vue-vendor-B-HGZVTd.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"scheduled-tasks-page"},ne={class:"font-bold text-lg"},ae={class:"text-sm text-gray-500"},te={class:"text-xs text-gray-400"},ue=W({__name:"scheduled-tasks",setup(se){const y=A(),V=G(),f=T(!1),U=T(null),u=T({type:"backup",name:"",server:"all",scheduleType:"interval",intervalValue:1,intervalUnit:"hour",cronExpression:"",description:"",config:{backupType:"full",keepCount:10,announceBeforeRestart:!0,announceMinutes:5,message:"",command:""}}),P=[{label:"â° å®šæ—¶é‡å¯",value:"restart",icon:"i-mdi:restart"},{label:"ðŸ’¾ å®šæ—¶å¤‡ä»½",value:"backup",icon:"i-mdi:backup-restore"},{label:"ðŸ“¢ å®šæ—¶å…¬å‘Š",value:"announce",icon:"i-mdi:bullhorn"},{label:"ðŸ”§ æ‰§è¡Œå‘½ä»¤",value:"command",icon:"i-mdi:console"},{label:"ðŸ§¹ æ¸…ç†æ—¥å¿—",value:"clean",icon:"i-mdi:delete-sweep"}],B=[{label:"å…¨éƒ¨æœåŠ¡å™¨",value:"all"},{label:"ç”Ÿå­˜æœ",value:"1"},{label:"Modæœ",value:"2"},{label:"PVPæœ",value:"3"}],S=Z(()=>["backup","restart","announce","command"].includes(u.value.type)),x=T([{id:"1",name:"æ¯æ—¥å‡Œæ™¨é‡å¯",type:"restart",server:"all",schedule:"æ¯å¤© 03:00",enabled:!0,description:"æ¯å¤©å‡Œæ™¨3ç‚¹è‡ªåŠ¨é‡å¯æ‰€æœ‰æœåŠ¡å™¨",nextRun:"2024-01-21 03:00:00",lastRun:"2024-01-20 03:00:00"},{id:"2",name:"æ¯å°æ—¶å¤‡ä»½",type:"backup",server:"1",schedule:"æ¯å°æ—¶",enabled:!0,description:"æ¯å°æ—¶è‡ªåŠ¨å¤‡ä»½ç”Ÿå­˜æœ",nextRun:"2024-01-20 16:00:00",lastRun:"2024-01-20 15:00:00"},{id:"3",name:"å…¬å‘Šæé†’",type:"announce",server:"all",schedule:"æ¯2å°æ—¶",enabled:!1,description:"å®šæ—¶å‘é€æœåŠ¡å™¨å…¬å‘Š",nextRun:"2024-01-20 17:00:00",lastRun:null}]),j=s=>({restart:"i-mdi:restart text-blue-500",backup:"i-mdi:backup-restore text-green-500",announce:"i-mdi:bullhorn text-orange-500",command:"i-mdi:console text-purple-500",clean:"i-mdi:delete-sweep text-red-500"})[s]||"i-mdi:clock-outline",F=s=>B.find(n=>n.value===s)?.label||s,I=()=>{const s={restart:"å®šæ—¶é‡å¯",backup:"å®šæ—¶å¤‡ä»½",announce:"å®šæ—¶å…¬å‘Š",command:"å®šæ—¶å‘½ä»¤",clean:"æ¸…ç†æ—¥å¿—"};u.value.name||(u.value.name=s[u.value.type]||"")},D=s=>{y.success(`ä»»åŠ¡ "${s.name}" å·²${s.enabled?"å¯ç”¨":"ç¦ç”¨"}`)},K=s=>{V.info({title:"ç¡®è®¤æ‰§è¡Œ",content:`ç¡®å®šè¦ç«‹å³æ‰§è¡Œä»»åŠ¡ "${s.name}" å—ï¼Ÿ`,positiveText:"ç¡®å®š",negativeText:"å–æ¶ˆ",onPositiveClick:()=>{y.success(`ä»»åŠ¡ "${s.name}" æ­£åœ¨æ‰§è¡Œ...`)}})},O=s=>{U.value=s,f.value=!0},Q=s=>{V.error({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ä»»åŠ¡ "${s.name}" å—ï¼Ÿ`,positiveText:"åˆ é™¤",negativeText:"å–æ¶ˆ",onPositiveClick:()=>{const e=x.value.findIndex(n=>n.id===s.id);e>-1&&x.value.splice(e,1),y.success("ä»»åŠ¡å·²åˆ é™¤")}})},Y=()=>{if(!u.value.name||!u.value.server){y.error("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯");return}y.success("ä»»åŠ¡ä¿å­˜æˆåŠŸ"),f.value=!1,U.value=null,u.value={type:"backup",name:"",server:"all",scheduleType:"interval",intervalValue:1,intervalUnit:"hour",cronExpression:"",description:"",config:{backupType:"full",keepCount:10,announceBeforeRestart:!0,announceMinutes:5,message:"",command:""}}};return(s,e)=>(i(),C("div",le,[t(l(M),{title:"è®¡åˆ’ä»»åŠ¡",bordered:!1},{"header-extra":a(()=>[t(l(c),{type:"primary",onClick:e[0]||(e[0]=n=>f.value=!0)},{icon:a(()=>[...e[18]||(e[18]=[m("div",{class:"i-mdi:plus"},null,-1)])]),default:a(()=>[e[19]||(e[19]=o(" åˆ›å»ºä»»åŠ¡ ",-1))]),_:1})]),default:a(()=>[t(l(d),{vertical:"",size:"large"},{default:a(()=>[(i(!0),C(z,null,h(x.value,n=>(i(),v(l(M),{key:n.id,size:"small",hoverable:""},{default:a(()=>[t(l(d),{justify:"space-between",align:"center"},{default:a(()=>[t(l(d),{align:"center"},{default:a(()=>[m("div",{class:E(["task-icon",n.enabled?"text-green-500":"text-gray-400"])},[m("div",{class:E(j(n.type))},null,2)],2),t(l(d),{vertical:"",size:"small"},{default:a(()=>[m("div",ne,g(n.name),1),t(l(d),{size:"small"},{default:a(()=>[t(l(w),{type:"info",size:"small"},{icon:a(()=>[...e[20]||(e[20]=[m("div",{class:"i-mdi:clock-outline"},null,-1)])]),default:a(()=>[o(" "+g(n.schedule),1)]),_:2},1024),n.server!=="all"?(i(),v(l(w),{key:0,type:"success",size:"small"},{default:a(()=>[o(g(F(n.server)),1)]),_:2},1024)):(i(),v(l(w),{key:1,type:"warning",size:"small"},{default:a(()=>[...e[21]||(e[21]=[o(" å…¨éƒ¨æœåŠ¡å™¨ ",-1)])]),_:1}))]),_:2},1024),m("div",ae,g(n.description),1),m("div",te," ä¸‹æ¬¡æ‰§è¡Œ: "+g(n.nextRun)+" | ä¸Šæ¬¡æ‰§è¡Œ: "+g(n.lastRun||"ä»Žæœª"),1)]),_:2},1024)]),_:2},1024),t(l(d),null,{default:a(()=>[t(l(N),{value:n.enabled,"onUpdate:value":[b=>n.enabled=b,b=>D(n)]},{checked:a(()=>[...e[22]||(e[22]=[o("å¯ç”¨",-1)])]),unchecked:a(()=>[...e[23]||(e[23]=[o("ç¦ç”¨",-1)])]),_:1},8,["value","onUpdate:value"]),t(l(c),{size:"small",onClick:b=>K(n)},{icon:a(()=>[...e[24]||(e[24]=[m("div",{class:"i-mdi:play"},null,-1)])]),default:a(()=>[e[25]||(e[25]=o(" ç«‹å³æ‰§è¡Œ ",-1))]),_:1},8,["onClick"]),t(l(c),{size:"small",onClick:b=>O(n)},{default:a(()=>[...e[26]||(e[26]=[o(" ç¼–è¾‘ ",-1)])]),_:1},8,["onClick"]),t(l(c),{size:"small",type:"error",onClick:b=>Q(n)},{default:a(()=>[...e[27]||(e[27]=[o(" åˆ é™¤ ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),x.value.length===0?(i(),v(l(H),{key:0,description:"è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•è®¡åˆ’ä»»åŠ¡"},{extra:a(()=>[t(l(c),{type:"primary",onClick:e[1]||(e[1]=n=>f.value=!0)},{default:a(()=>[...e[28]||(e[28]=[o("åˆ›å»ºç¬¬ä¸€ä¸ªä»»åŠ¡",-1)])]),_:1})]),_:1})):p("",!0)]),_:1})]),_:1}),t(l(X),{show:f.value,"onUpdate:show":e[17]||(e[17]=n=>f.value=n),preset:"card",title:U.value?"ç¼–è¾‘ä»»åŠ¡":"åˆ›å»ºè®¡åˆ’ä»»åŠ¡",style:{width:"700px"}},{footer:a(()=>[t(l(d),{justify:"end"},{default:a(()=>[t(l(c),{onClick:e[16]||(e[16]=n=>f.value=!1)},{default:a(()=>[...e[36]||(e[36]=[o("å–æ¶ˆ",-1)])]),_:1}),t(l(c),{type:"primary",onClick:Y},{default:a(()=>[...e[37]||(e[37]=[o("ä¿å­˜",-1)])]),_:1})]),_:1})]),default:a(()=>[t(l(J),{model:u.value,"label-placement":"left","label-width":"120px"},{default:a(()=>[t(l(r),{label:"ä»»åŠ¡ç±»åž‹",required:""},{default:a(()=>[t(l($),{value:u.value.type,"onUpdate:value":[e[2]||(e[2]=n=>u.value.type=n),I],options:P},null,8,["value"])]),_:1}),t(l(r),{label:"ä»»åŠ¡åç§°",required:""},{default:a(()=>[t(l(_),{value:u.value.name,"onUpdate:value":e[3]||(e[3]=n=>u.value.name=n),placeholder:"ç»™ä»»åŠ¡èµ·ä¸ªåå­—"},null,8,["value"])]),_:1}),t(l(r),{label:"é€‰æ‹©æœåŠ¡å™¨",required:""},{default:a(()=>[t(l($),{value:u.value.server,"onUpdate:value":e[4]||(e[4]=n=>u.value.server=n),options:B},null,8,["value"])]),_:1}),t(l(r),{label:"æ‰§è¡Œè®¡åˆ’",required:""},{default:a(()=>[t(l(q),{value:u.value.scheduleType,"onUpdate:value":e[5]||(e[5]=n=>u.value.scheduleType=n)},{default:a(()=>[t(l(d),{vertical:""},{default:a(()=>[t(l(k),{value:"interval"},{default:a(()=>[...e[29]||(e[29]=[o("æŒ‰é—´éš”æ‰§è¡Œ",-1)])]),_:1}),t(l(k),{value:"cron"},{default:a(()=>[...e[30]||(e[30]=[o("æŒ‰æ—¶é—´æ‰§è¡Œ",-1)])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),u.value.scheduleType==="interval"?(i(),v(l(r),{key:0,label:"æ‰§è¡Œé—´éš”"},{default:a(()=>[t(l(d),null,{default:a(()=>[t(l(R),{value:u.value.intervalValue,"onUpdate:value":e[6]||(e[6]=n=>u.value.intervalValue=n),min:1,style:{width:"120px"}},null,8,["value"]),t(l($),{value:u.value.intervalUnit,"onUpdate:value":e[7]||(e[7]=n=>u.value.intervalUnit=n),options:[{label:"åˆ†é’Ÿ",value:"minute"},{label:"å°æ—¶",value:"hour"},{label:"å¤©",value:"day"}],style:{width:"100px"}},null,8,["value"])]),_:1})]),_:1})):p("",!0),u.value.scheduleType==="cron"?(i(),v(l(r),{key:1,label:"Cronè¡¨è¾¾å¼"},{default:a(()=>[t(l(_),{value:u.value.cronExpression,"onUpdate:value":e[8]||(e[8]=n=>u.value.cronExpression=n),placeholder:"ä¾‹å¦‚: 0 0 * * *"},null,8,["value"]),e[31]||(e[31]=m("div",{class:"text-xs text-gray-500 mt-1"}," æç¤º: 0 0 * * * è¡¨ç¤ºæ¯å¤©0ç‚¹æ‰§è¡Œ ",-1))]),_:1})):p("",!0),t(l(r),{label:"ä»»åŠ¡æè¿°"},{default:a(()=>[t(l(_),{value:u.value.description,"onUpdate:value":e[9]||(e[9]=n=>u.value.description=n),type:"textarea",rows:2,placeholder:"é€‰å¡«ï¼Œæè¿°æ­¤ä»»åŠ¡çš„ç”¨é€”"},null,8,["value"])]),_:1}),S.value?(i(),v(l(L),{key:2,"title-placement":"left"},{default:a(()=>[...e[32]||(e[32]=[o("ä»»åŠ¡é…ç½®",-1)])]),_:1})):p("",!0),u.value.type==="backup"?(i(),C(z,{key:3},[t(l(r),{label:"å¤‡ä»½ç±»åž‹"},{default:a(()=>[t(l(q),{value:u.value.config.backupType,"onUpdate:value":e[10]||(e[10]=n=>u.value.config.backupType=n)},{default:a(()=>[t(l(d),null,{default:a(()=>[t(l(k),{value:"full"},{default:a(()=>[...e[33]||(e[33]=[o("å®Œæ•´å¤‡ä»½",-1)])]),_:1}),t(l(k),{value:"world"},{default:a(()=>[...e[34]||(e[34]=[o("ä»…ä¸–ç•Œ",-1)])]),_:1}),t(l(k),{value:"config"},{default:a(()=>[...e[35]||(e[35]=[o("ä»…é…ç½®",-1)])]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),t(l(r),{label:"ä¿ç•™æ•°é‡"},{default:a(()=>[t(l(R),{value:u.value.config.keepCount,"onUpdate:value":e[11]||(e[11]=n=>u.value.config.keepCount=n),min:1,max:50},null,8,["value"])]),_:1})],64)):p("",!0),u.value.type==="restart"?(i(),C(z,{key:4},[t(l(r),{label:"é‡å¯å‰å…¬å‘Š"},{default:a(()=>[t(l(N),{value:u.value.config.announceBeforeRestart,"onUpdate:value":e[12]||(e[12]=n=>u.value.config.announceBeforeRestart=n)},null,8,["value"])]),_:1}),u.value.config.announceBeforeRestart?(i(),v(l(r),{key:0,label:"æå‰æ—¶é—´(åˆ†é’Ÿ)"},{default:a(()=>[t(l(R),{value:u.value.config.announceMinutes,"onUpdate:value":e[13]||(e[13]=n=>u.value.config.announceMinutes=n),min:1,max:60},null,8,["value"])]),_:1})):p("",!0)],64)):p("",!0),u.value.type==="announce"?(i(),v(l(r),{key:5,label:"å…¬å‘Šå†…å®¹",required:""},{default:a(()=>[t(l(_),{value:u.value.config.message,"onUpdate:value":e[14]||(e[14]=n=>u.value.config.message=n),type:"textarea",rows:3,placeholder:"è¾“å…¥è¦å‘é€çš„å…¬å‘Šå†…å®¹"},null,8,["value"])]),_:1})):p("",!0),u.value.type==="command"?(i(),v(l(r),{key:6,label:"æ‰§è¡Œå‘½ä»¤",required:""},{default:a(()=>[t(l(_),{value:u.value.config.command,"onUpdate:value":e[15]||(e[15]=n=>u.value.config.command=n),placeholder:"ä¾‹å¦‚: /save"},null,8,["value"])]),_:1})):p("",!0)]),_:1},8,["model"])]),_:1},8,["show","title"])]))}}),de=ee(ue,[["__scopeId","data-v-128dd9a8"]]);export{de as default};
