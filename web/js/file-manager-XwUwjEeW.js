import{am as Q,aG as q,K as v,S as b,V as A,R as W,aj as X,H as i,au as Y,av as V,aF as Z,aB as h,aL as ee,ac as le,a4 as F,J as U,a7 as te}from"./ui-vendor-C2DiPTQI.js";import{k as se,r as u,c as ae,Q as j,R as N,S as s,U as l,K as t,V as f,j as o,F as ne,N as ie,_ as oe,$ as de,m as d}from"./vue-vendor-B-HGZVTd.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"file-manager-page"},pe=se({__name:"file-manager",setup(fe){const r=Q(),B=q(),C=u("1"),w=u("/"),z=u(!1),x=u(!1),m=u(!1),g=u(!1),y=u(""),$=u(""),_=u(null),P=[{label:"生存服 (TShock)",value:"1"},{label:"Mod服 (TModLoader)",value:"2"},{label:"PVP服 (TShock)",value:"3"},{label:"建筑服 (Vanilla)",value:"4"}],T=u([{name:"worlds",type:"folder",size:"-",modifiedTime:"2024-01-15 10:30:00",path:"/worlds"},{name:"plugins",type:"folder",size:"-",modifiedTime:"2024-01-15 10:30:00",path:"/plugins"},{name:"config",type:"folder",size:"-",modifiedTime:"2024-01-15 10:30:00",path:"/config"},{name:"server.log",type:"file",size:"2.5 MB",modifiedTime:"2024-01-20 15:45:00",path:"/server.log"},{name:"config.json",type:"file",size:"15 KB",modifiedTime:"2024-01-18 12:00:00",path:"/config.json"}]),c=ae(()=>w.value.split("/").filter(a=>a)),D=[{title:"名称",key:"name",render:a=>d("div",{class:"flex items-center gap-2 cursor-pointer hover:text-blue-500",onClick:()=>K(a)},[d("div",{class:a.type==="folder"?"i-mdi:folder text-yellow-500 text-xl":"i-mdi:file text-gray-500 text-xl"}),d("span",a.name)])},{title:"类型",key:"type",width:100,render:a=>d(te,{size:"small",type:a.type==="folder"?"warning":"default"},()=>a.type==="folder"?"文件夹":"文件")},{title:"大小",key:"size",width:120},{title:"修改时间",key:"modifiedTime",width:180},{title:"操作",key:"actions",width:280,fixed:"right",render:a=>{const e=[];return a.type==="file"&&e.push(d(i,{size:"small",onClick:()=>M(a)},{default:()=>"编辑",icon:()=>d("div",{class:"i-mdi:pencil"})}),d(i,{size:"small",type:"success",onClick:()=>R(a)},{default:()=>"下载",icon:()=>d("div",{class:"i-mdi:download"})})),e.push(d(i,{size:"small",onClick:()=>G(a)},{default:()=>"重命名",icon:()=>d("div",{class:"i-mdi:rename-box"})}),d(i,{size:"small",type:"error",onClick:()=>H(a)},{default:()=>"删除",icon:()=>d("div",{class:"i-mdi:delete"})})),d(v,{size:"small"},()=>e)}}],k=()=>{z.value=!0,setTimeout(()=>{z.value=!1,r.success("文件列表已刷新")},500)},E=()=>{k()},p=a=>{w.value=a,k()},I=a=>"/"+c.value.slice(0,a+1).join("/"),K=a=>{a.type==="folder"?p(a.path):M(a)},M=a=>{_.value=a,$.value="// 文件内容加载中...",g.value=!0},L=()=>{r.success("文件保存成功"),g.value=!1},R=a=>{r.success(`正在下载: ${a.name}`)},G=a=>{B.info({title:"重命名",content:()=>d(U,{placeholder:"请输入新名称",defaultValue:a.name}),positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{r.success("重命名成功")}})},H=a=>{B.warning({title:"确认删除",content:`确定要删除 "${a.name}" 吗？${a.type==="folder"?"文件夹内所有内容将被删除！":""}`,positiveText:"删除",negativeText:"取消",onPositiveClick:()=>{const e=T.value.findIndex(n=>n.path===a.path);e>-1&&T.value.splice(e,1),r.success("删除成功")}})},J=()=>{if(!y.value){r.error("请输入文件夹名称");return}r.success(`文件夹 "${y.value}" 创建成功`),m.value=!1,y.value="",k()},O=()=>{r.success("文件上传成功"),x.value=!1,k()};return(a,e)=>(N(),j("div",re,[s(t(b),{title:"文件管理器",bordered:!1},{"header-extra":l(()=>[s(t(v),null,{default:l(()=>[s(t(i),{onClick:k},{icon:l(()=>[...e[16]||(e[16]=[f("div",{class:"i-mdi:refresh"},null,-1)])]),default:l(()=>[e[17]||(e[17]=o(" 刷新 ",-1))]),_:1}),s(t(i),{onClick:e[0]||(e[0]=n=>x.value=!0)},{icon:l(()=>[...e[18]||(e[18]=[f("div",{class:"i-mdi:upload"},null,-1)])]),default:l(()=>[e[19]||(e[19]=o(" 上传文件 ",-1))]),_:1}),s(t(i),{type:"primary",onClick:e[1]||(e[1]=n=>m.value=!0)},{icon:l(()=>[...e[20]||(e[20]=[f("div",{class:"i-mdi:folder-plus"},null,-1)])]),default:l(()=>[e[21]||(e[21]=o(" 新建文件夹 ",-1))]),_:1})]),_:1})]),default:l(()=>[s(t(v),{vertical:"",size:"large"},{default:l(()=>[s(t(b),{size:"small"},{default:l(()=>[s(t(v),{align:"center"},{default:l(()=>[e[27]||(e[27]=f("span",null,"选择服务器：",-1)),s(t(A),{value:C.value,"onUpdate:value":[e[2]||(e[2]=n=>C.value=n),E],options:P,style:{width:"200px"}},null,8,["value"]),s(t(W),{vertical:""}),e[28]||(e[28]=f("span",null,"快捷路径：",-1)),s(t(X),null,{default:l(()=>[s(t(i),{size:"small",onClick:e[3]||(e[3]=n=>p("/"))},{default:l(()=>[...e[22]||(e[22]=[o("根目录",-1)])]),_:1}),s(t(i),{size:"small",onClick:e[4]||(e[4]=n=>p("/worlds"))},{default:l(()=>[...e[23]||(e[23]=[o("世界",-1)])]),_:1}),s(t(i),{size:"small",onClick:e[5]||(e[5]=n=>p("/plugins"))},{default:l(()=>[...e[24]||(e[24]=[o("插件",-1)])]),_:1}),s(t(i),{size:"small",onClick:e[6]||(e[6]=n=>p("/mods"))},{default:l(()=>[...e[25]||(e[25]=[o("模组",-1)])]),_:1}),s(t(i),{size:"small",onClick:e[7]||(e[7]=n=>p("/config"))},{default:l(()=>[...e[26]||(e[26]=[o("配置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),s(t(b),{size:"small"},{default:l(()=>[s(t(Y),null,{default:l(()=>[s(t(V),{onClick:e[8]||(e[8]=n=>p("/"))},{default:l(()=>[...e[29]||(e[29]=[f("div",{class:"i-mdi:home"},null,-1)])]),_:1}),(N(!0),j(ne,null,ie(c.value,(n,S)=>(N(),oe(t(V),{key:S,onClick:ve=>p(I(S))},{default:l(()=>[o(de(n),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),s(t(Z),{columns:D,data:T.value,loading:z.value,pagination:{pageSize:20},bordered:!1},null,8,["data","loading"])]),_:1})]),_:1}),s(t(F),{show:x.value,"onUpdate:show":e[9]||(e[9]=n=>x.value=n),preset:"card",title:"上传文件",style:{width:"600px"}},{default:l(()=>[s(t(h),{multiple:"","directory-dnd":"",action:`/api/files/upload?server=${C.value}&path=${w.value}`,onFinish:O},{default:l(()=>[s(t(ee),null,{default:l(()=>[e[31]||(e[31]=f("div",{style:{"margin-bottom":"12px"}},[f("div",{class:"i-mdi:cloud-upload text-5xl text-gray-400"})],-1)),s(t(le),null,{default:l(()=>[...e[30]||(e[30]=[o("点击或拖拽文件到此区域上传",-1)])]),_:1})]),_:1})]),_:1},8,["action"])]),_:1},8,["show"]),s(t(F),{show:m.value,"onUpdate:show":e[12]||(e[12]=n=>m.value=n),preset:"card",title:"新建文件夹",style:{width:"500px"}},{footer:l(()=>[s(t(v),{justify:"end"},{default:l(()=>[s(t(i),{onClick:e[11]||(e[11]=n=>m.value=!1)},{default:l(()=>[...e[32]||(e[32]=[o("取消",-1)])]),_:1}),s(t(i),{type:"primary",onClick:J},{default:l(()=>[...e[33]||(e[33]=[o("创建",-1)])]),_:1})]),_:1})]),default:l(()=>[s(t(U),{value:y.value,"onUpdate:value":e[10]||(e[10]=n=>y.value=n),placeholder:"请输入文件夹名称"},null,8,["value"])]),_:1},8,["show"]),s(t(F),{show:g.value,"onUpdate:show":e[15]||(e[15]=n=>g.value=n),preset:"card",title:`编辑文件: ${_.value?.name}`,style:{width:"80%"}},{footer:l(()=>[s(t(v),{justify:"end"},{default:l(()=>[s(t(i),{onClick:e[14]||(e[14]=n=>g.value=!1)},{default:l(()=>[...e[34]||(e[34]=[o("取消",-1)])]),_:1}),s(t(i),{type:"primary",onClick:L},{default:l(()=>[...e[35]||(e[35]=[o("保存",-1)])]),_:1})]),_:1})]),default:l(()=>[s(t(U),{value:$.value,"onUpdate:value":e[13]||(e[13]=n=>$.value=n),type:"textarea",rows:20,placeholder:"文件内容"},null,8,["value"])]),_:1},8,["show","title"])]))}}),ke=ue(pe,[["__scopeId","data-v-52df7ac8"]]);export{ke as default};
