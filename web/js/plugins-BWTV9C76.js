import{am as J,M as g,aF as U,K as y,H as o,S as B,J as O,a4 as h,aB as M,a7 as $}from"./ui-vendor-C2DiPTQI.js";import{k as z,r as d,Q as D,R as I,S as t,U as s,K as a,j as u,m as p}from"./vue-vendor-B-HGZVTd.js";const R={class:"p-4"},P=z({__name:"plugins",setup(j){const i=J(),c=d(!1),r=d(!1),f=d(!1),k=d(null),m=d(""),v=d([{id:1,name:"AutoBroadcast",version:"1.0.0",author:"TShock",description:"自动广播插件",enabled:!0},{id:2,name:"RegionProtector",version:"2.1.0",author:"Community",description:"区域保护插件",enabled:!0},{id:3,name:"EconomySystem",version:"1.5.2",author:"Developer",description:"经济系统插件",enabled:!1}]),w=[{title:"插件名称",key:"name",width:200},{title:"版本",key:"version",width:120},{title:"作者",key:"author",width:150},{title:"描述",key:"description",ellipsis:{tooltip:!0}},{title:"状态",key:"enabled",width:100,render:l=>p($,{type:l.enabled?"success":"default"},()=>l.enabled?"已启用":"已禁用")},{title:"操作",key:"actions",width:280,fixed:"right",render:l=>p(y,null,{default:()=>[p(o,{size:"small",type:l.enabled?"warning":"success",onClick:()=>b(l)},()=>l.enabled?"禁用":"启用"),p(o,{size:"small",type:"primary",onClick:()=>C(l)},()=>"配置"),p(o,{size:"small",type:"error",onClick:()=>x(l)},()=>"删除")]})}],_=()=>{c.value=!0,setTimeout(()=>{c.value=!1,i.success("刷新成功")},1e3)},b=l=>{l.enabled=!l.enabled,i.success(`${l.name} 已${l.enabled?"启用":"禁用"}，请重启服务器`)},C=l=>{k.value=l,m.value=JSON.stringify({enabled:!0,settings:{example:"value"}},null,2),r.value=!0},S=()=>{try{JSON.parse(m.value),i.success("配置保存成功"),r.value=!1}catch{i.error("JSON格式错误，请检查")}},x=l=>{const e=v.value.findIndex(n=>n.id===l.id);e>-1&&(v.value.splice(e,1),i.success("删除成功"))},N=()=>{f.value=!0},T=l=>{l.fileList.length>0&&(i.success("插件安装成功，请重启服务器"),f.value=!1,_())};return(l,e)=>(I(),D("div",R,[t(a(B),{title:"插件管理"},{"header-extra":s(()=>[t(a(y),null,{default:s(()=>[t(a(o),{onClick:_},{default:s(()=>[...e[4]||(e[4]=[u("刷新",-1)])]),_:1}),t(a(o),{type:"primary",onClick:N},{default:s(()=>[...e[5]||(e[5]=[u("安装插件",-1)])]),_:1})]),_:1})]),default:s(()=>[t(a(g),{type:"info",class:"mb-4","show-icon":!1},{default:s(()=>[...e[6]||(e[6]=[u(" 这里管理TShock插件，插件文件需要是.dll格式。安装插件后需要重启服务器才能生效。 ",-1)])]),_:1}),t(a(U),{columns:w,data:v.value,loading:c.value,bordered:!1},null,8,["data","loading"])]),_:1}),t(a(h),{show:r.value,"onUpdate:show":e[2]||(e[2]=n=>r.value=n),preset:"card",title:"插件配置",style:{width:"60%"}},{footer:s(()=>[t(a(y),{justify:"end"},{default:s(()=>[t(a(o),{onClick:e[1]||(e[1]=n=>r.value=!1)},{default:s(()=>[...e[8]||(e[8]=[u("取消",-1)])]),_:1}),t(a(o),{type:"primary",onClick:S},{default:s(()=>[...e[9]||(e[9]=[u("保存",-1)])]),_:1})]),_:1})]),default:s(()=>[t(a(g),{type:"warning",class:"mb-4","show-icon":!1},{default:s(()=>[...e[7]||(e[7]=[u(" 请使用JSON格式编辑插件配置 ",-1)])]),_:1}),t(a(O),{value:m.value,"onUpdate:value":e[0]||(e[0]=n=>m.value=n),type:"textarea",rows:15,placeholder:"请输入JSON格式的配置"},null,8,["value"])]),_:1},8,["show"]),t(a(h),{show:f.value,"onUpdate:show":e[3]||(e[3]=n=>f.value=n),preset:"card",title:"安装插件",style:{width:"50%"}},{default:s(()=>[t(a(M),{"default-upload":!1,accept:".dll",max:1,onChange:T},{default:s(()=>[t(a(o),null,{default:s(()=>[...e[10]||(e[10]=[u("点击上传插件文件",-1)])]),_:1})]),_:1}),t(a(g),{type:"info",class:"mt-4","show-icon":!1},{default:s(()=>[...e[11]||(e[11]=[u(" 仅支持 .dll 格式的TShock插件文件 ",-1)])]),_:1})]),_:1},8,["show"])]))}});export{P as default};
