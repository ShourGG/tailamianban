import{k as re,r as v,c as B,o as ie,_,R as r,U as l,S as p,K as i,Q as h,V as u,F as E,N as z,Y as d,$ as V,aE as M,j as H,I as ce}from"./vue-vendor-B-HGZVTd.js";import{g as ue,s as pe}from"./index-CZdsPYOi.js";import{am as de,P as fe,Q as me,J as _e,an as he,V as ve,a5 as ge,K as ye,a1 as ke,H as Fe,S as Se}from"./ui-vendor-C2DiPTQI.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./spline-vendor-CTguZ3V6.js";import"./charts-vendor-CzveNv9z.js";import"./editor-vendor-CkYh0R4B.js";const Ie={key:1,class:"input-history"},Ne=["onClick"],xe={class:"history-text"},He={key:0,class:"history-footer"},Le=["onClick"],we={class:"form-search-item-box"},Ce={class:"form-item-input"},Be=re({__name:"index",props:{bordered:{type:Boolean,default:!0},formItemList:{default:()=>[]},formParams:{},formSearchInputHistoryString:{},size:{default:"medium"}},emits:["search","reset","change-params"],setup(F,{expose:P,emit:U}){const f=F,S=U,A=de(),b=v(null),c=v([...f.formItemList]),t=v({...f.formParams}),g=v(!1),$=v(!1),D=B(()=>c.value.filter(e=>e.show!==!1)),j=B(()=>c.value.length>7),y=e=>{c.value.forEach(s=>{s.isFocus=s.hisList&&s.prop===e})},O=e=>{const s=ue(f.formSearchInputHistoryString);s&&(c.value=s),y(e)},T=(e,s)=>{t.value[s]=e,y()},I=e=>c.value.find(s=>s.prop===e),k=()=>{f.formSearchInputHistoryString&&pe(f.formSearchInputHistoryString,c.value)},R=(e,s)=>{const n=I(e);n?.hisList&&(n.hisList.splice(s,1),n.hisList.length===0&&(n.isFocus=!1),k())},K=e=>{const s=I(e);s?.hisList&&(s.hisList=[],s.isFocus=!1,k())},Q=()=>{setTimeout(()=>y(),200)},J=(e,s)=>{const n=e.indexOf(s);return n>-1&&e.splice(n,1),e.unshift(s),e.length>5?e.slice(0,5):e},Y=e=>{const s=I(e);if(!s?.hisList)return;s.isFocus=!0;const n=t.value[e];if(n&&n.toString().trim()){const m=n.toString().trim();s.hisList=J(s.hisList,m)}c.value.forEach(m=>{m.prop!==e&&(m.isFocus=!1)})},q=e=>e===void 0||e===""||e===null||Array.isArray(e)&&e.length===0,G=()=>{Object.keys(t.value).forEach(e=>{t.value[e]&&Y(e)}),y(),k()},L=()=>{Object.entries(t.value).filter(([s])=>s!=="pageNum"&&s!=="pageSize").some(([s,n])=>s.includes("Time")&&Array.isArray(n)?n[0]:!q(n))?(f.formSearchInputHistoryString&&G(),S("search",t.value)):A.warning("请输入搜索内容，或选择筛选条件")},w=()=>{b.value?.restoreValidation(),Object.keys(t.value).forEach(e=>{e!=="pageNum"&&e!=="pageSize"&&(t.value[e]=null)}),S("change-params",t.value),S("reset")},C=()=>{g.value=!g.value,c.value.forEach((e,s)=>{s>6&&(e.show=!e.show)}),k()},W=()=>{c.value.forEach((e,s)=>{e.isFocus=!1,s>6&&e.show===void 0&&(e.show=!1),e.type==="select"&&(e.placeholder||(e.placeholder="请选择"),t.value[e.prop]===void 0&&(t.value[e.prop]=null))})};return ie(()=>{W()}),P({formRef:b,formParams:t,searchFn:L,cleanFn:w,changeFoldState:C}),(e,s)=>{const n=_e,m=he,X=ve,Z=ge,ee=me,N=Fe,x=ke,se=ye,oe=fe,te=Se;return r(),_(te,{class:"form-search-card custom-card",bordered:F.bordered},{default:l(()=>[p(oe,{class:"form-search",model:i(t),ref_key:"formRef",ref:b,size:F.size},{default:l(()=>[(r(!0),h(E,null,z(i(D),(o,ae)=>(r(),h("div",{class:"form-search-item-box",key:ae},[o.type!=="%"?(r(),_(ee,{key:0,class:"form-item-input",path:o.prop,"show-feedback":!1,"show-label":!1},{default:l(()=>[o.type==="input"?(r(),_(n,{key:0,clearable:"",value:i(t)[o.prop],"onUpdate:value":a=>i(t)[o.prop]=a,placeholder:o.placeholder,onFocus:a=>O(o.prop),onBlur:Q},null,8,["value","onUpdate:value","placeholder","onFocus"])):d("",!0),o.isFocus?(r(),h("div",Ie,[(r(!0),h(E,null,z(o.hisList,(a,ne)=>(r(),h("div",{class:"history-item",onClick:le=>T(a,o.prop),key:a},[u("span",xe,V(a),1),p(m,{class:"delete-icon",size:"14",onClick:M(le=>R(o.prop,ne),["stop"])},{default:l(()=>[...s[1]||(s[1]=[u("div",{class:"i-mdi:close"},null,-1)])]),_:1},8,["onClick"])],8,Ne))),128)),o.hisList&&o.hisList.length>0?(r(),h("div",He,[u("span",{class:"clear-all",onClick:M(a=>K(o.prop),["stop"])}," 清空历史记录 ",8,Le)])):d("",!0)])):d("",!0),o.type==="select"?(r(),_(X,{key:2,value:i(t)[o.prop],"onUpdate:value":a=>i(t)[o.prop]=a,placeholder:o.placeholder||"请选择",clearable:"",options:o.list?.map(a=>({label:a.label||a.labelDefault,value:a.value!==void 0?a.value:a.label||a.labelDefault}))},null,8,["value","onUpdate:value","placeholder","options"])):d("",!0),o.type==="date-range"?(r(),_(Z,{key:3,type:"datetimerange",value:i(t)[o.prop],"onUpdate:value":a=>i(t)[o.prop]=a,format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm","start-placeholder":"开始时间","end-placeholder":"结束时间",clearable:""},null,8,["value","onUpdate:value"])):d("",!0)]),_:2},1032,["path"])):d("",!0)]))),128)),u("div",we,[u("div",Ce,[s[6]||(s[6]=u("div",{class:"button-label-placeholder"},null,-1)),p(se,null,{default:l(()=>[p(x,{trigger:"hover"},{trigger:l(()=>[p(N,{type:"primary",onClick:L,loading:i($)},{icon:l(()=>[...s[2]||(s[2]=[u("div",{class:"i-mdi:search w-4 h-4"},null,-1)])]),_:1},8,["loading"])]),default:l(()=>[s[3]||(s[3]=H(" 搜索 ",-1))]),_:1}),p(x,{trigger:"hover"},{trigger:l(()=>[p(N,{onClick:s[0]||(s[0]=o=>w())},{icon:l(()=>[...s[4]||(s[4]=[u("div",{class:"i-mdi:refresh w-4 h-4"},null,-1)])]),_:1})]),default:l(()=>[s[5]||(s[5]=H(" 重置 ",-1))]),_:1}),i(j)?(r(),_(x,{key:0,trigger:"hover"},{trigger:l(()=>[p(N,{onClick:C},{icon:l(()=>[u("div",{class:ce(i(g)?"i-mdi:chevron-up w-4 h-4":"i-mdi:chevron-down w-4 h-4")},null,2)]),_:1})]),default:l(()=>[H(" "+V(i(g)?"收起":"展开"),1)]),_:1})):d("",!0)]),_:1})])])]),_:1},8,["model","size"])]),_:1},8,["bordered"])}}}),$e=be(Be,[["__scopeId","data-v-63fe2683"]]);export{$e as default};
