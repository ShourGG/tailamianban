import{k as L,aF as $,r as D,o as W,e as F,c as G,Q as p,R as f,S as o,U as n,K as a,Y as P,V as u,F as k,N as U,M as K,I as S,$ as v,j as m}from"./vue-vendor-B-HGZVTd.js";import{c as Q}from"./terraria-rooms-CwNP5Fu0.js";import{am as j,aG as H,P as J,R as g,T as Y,U as X,S as h,M as A,Q as s,J as i,a9 as _,V as c,ag as y,K as Z,H as z}from"./ui-vendor-C2DiPTQI.js";import"./index-CZdsPYOi.js";import"./spline-vendor-CTguZ3V6.js";import"./charts-vendor-CzveNv9z.js";import"./editor-vendor-CkYh0R4B.js";const ee={style:{padding:"16px"}},le={style:{"text-align":"center"}},oe={style:{"font-weight":"bold","margin-bottom":"8px"}},ae={style:{"font-size":"13px",color:"#999","margin-bottom":"12px"}},te={style:{"text-align":"left","font-size":"12px"}},me=L({__name:"create",setup(ne){const w=$(),d=j(),M=H(),b=D(!1),N=()=>localStorage.getItem("game_servers_installed")==="true";W(()=>{N()||M.warning({title:"未安装游戏服务器",content:"创建房间前需要先安装游戏服务器，请选择要安装的服务器版本。",positiveText:"前往安装",negativeText:"取消",onPositiveClick:()=>{w.push({name:"system-install-game"})},onNegativeClick:()=>{w.back()}})});const x=[{value:"vanilla",label:"原版服务器 (Vanilla)",description:"稳定纯净，适合原汁原味的游戏体验",icon:"i-mdi:cube",features:["✅ 官方原版","✅ 最稳定","✅ 无需额外配置","❌ 功能有限"],color:"info"},{value:"tshock",label:"TShock服务器 (插件服)",description:"强大的插件系统和管理功能，推荐用于公共服务器",icon:"i-mdi:puzzle",features:["✅ 插件系统","✅ REST API","✅ 权限管理","✅ 经济系统"],color:"success"},{value:"tmodloader",label:"TModLoader服务器 (Mod服)",description:"支持Mod，可以添加新内容，客户端需要安装相同Mod",icon:"i-mdi:package-variant",features:["✅ 支持Mod","✅ 新物品/BOSS","✅ Steam Workshop","⚠️ 需客户端同步"],color:"warning"}],l=F({name:"",type:"tshock",port:7777,password:"",maxPlayers:8,worldName:"",worldConfig:{size:"2",difficulty:"0",autoSave:!0,pvp:!1,hardcore:!1,language:"zh-CN",motd:"欢迎来到泰拉瑞亚服务器！"},tshockConfig:{restApiPort:7878,restApiToken:"",superAdminPassword:"",enableWhitelist:!1},tmodloaderConfig:{enabledMods:[]}}),R=[{label:"小型 (4200×1200)",value:"1"},{label:"中型 (6400×1800)",value:"2"},{label:"大型 (8400×2400)",value:"3"}],q=[{label:"普通模式",value:"0"},{label:"专家模式",value:"1"},{label:"大师模式",value:"2"},{label:"旅途模式",value:"3"}],I=[{label:"简体中文",value:"zh-CN"},{label:"English",value:"en-US"}],C=G(()=>x.find(r=>r.value===l.type)),V=r=>{l.type=r,r==="vanilla"||r==="tshock"?l.port=7777:r==="tmodloader"&&(l.port=7778)},E=async()=>{if(!l.name){d.error("请输入房间名称");return}if(!l.worldName){d.error("请输入世界名称");return}if(l.type==="tshock"){if(!l.tshockConfig?.restApiToken){d.error("请设置REST API Token");return}if(!l.tshockConfig?.superAdminPassword){d.error("请设置超级管理员密码");return}}try{b.value=!0;const r=await Q(l);r.code==="0"?(d.success("房间创建成功！"),w.push("/terraria/rooms")):d.error(r.msg||"创建失败")}catch(r){d.error(r.message||"创建失败")}finally{b.value=!1}},O=()=>{w.back()};return(r,e)=>(f(),p("div",ee,[o(a(h),{title:"创建房间"},{default:n(()=>[o(a(J),{model:l,"label-placement":"left","label-width":"140px","require-mark-placement":"left"},{default:n(()=>[o(a(g),{"title-placement":"left"},{default:n(()=>[...e[18]||(e[18]=[u("span",{style:{"font-size":"18px","font-weight":"bold"}},"选择服务器类型",-1)])]),_:1}),o(a(Y),{cols:3,"x-gap":12,style:{"margin-bottom":"16px"}},{default:n(()=>[(f(),p(k,null,U(x,t=>o(a(X),{key:t.value},{default:n(()=>[o(a(h),{style:K({cursor:"pointer",border:l.type===t.value?"2px solid #3b82f6":"",backgroundColor:l.type===t.value?"#eff6ff":""}),onClick:T=>V(t.value)},{default:n(()=>[u("div",le,[u("div",{class:S(t.icon),style:{"font-size":"36px","margin-bottom":"8px"}},null,2),u("div",oe,v(t.label),1),u("div",ae,v(t.description),1),u("div",te,[(f(!0),p(k,null,U(t.features,(T,B)=>(f(),p("div",{key:B,style:{"margin-bottom":"4px"}},v(T),1))),128))])])]),_:2},1032,["style","onClick"])]),_:2},1024)),64))]),_:1}),o(a(A),{type:C.value.color,style:{"margin-bottom":"16px"}},{icon:n(()=>[u("div",{class:S(C.value.icon)},null,2)]),default:n(()=>[m(" 当前选择："+v(C.value.label)+" - "+v(C.value.description),1)]),_:1},8,["type"]),o(a(g),{"title-placement":"left"},{default:n(()=>[...e[19]||(e[19]=[m("基础配置",-1)])]),_:1}),o(a(s),{label:"房间名称",path:"name",required:""},{default:n(()=>[o(a(i),{value:l.name,"onUpdate:value":e[0]||(e[0]=t=>l.name=t),placeholder:"请输入房间名称，如：生存服"},null,8,["value"])]),_:1}),o(a(s),{label:"服务器端口",path:"port",required:""},{default:n(()=>[o(a(_),{value:l.port,"onUpdate:value":e[1]||(e[1]=t=>l.port=t),min:1,max:65535,class:"w-full"},null,8,["value"])]),_:1}),o(a(s),{label:"最大玩家数",path:"maxPlayers",required:""},{default:n(()=>[o(a(_),{value:l.maxPlayers,"onUpdate:value":e[2]||(e[2]=t=>l.maxPlayers=t),min:1,max:255,class:"w-full"},null,8,["value"])]),_:1}),o(a(s),{label:"服务器密码",path:"password"},{default:n(()=>[o(a(i),{value:l.password,"onUpdate:value":e[3]||(e[3]=t=>l.password=t),type:"password","show-password-on":"mousedown",placeholder:"留空表示无密码"},null,8,["value"])]),_:1}),o(a(g),{"title-placement":"left"},{default:n(()=>[...e[20]||(e[20]=[m("世界配置",-1)])]),_:1}),o(a(s),{label:"世界名称",path:"worldName",required:""},{default:n(()=>[o(a(i),{value:l.worldName,"onUpdate:value":e[4]||(e[4]=t=>l.worldName=t),placeholder:"请输入世界名称"},null,8,["value"])]),_:1}),o(a(s),{label:"世界种子",path:"worldConfig.seed"},{default:n(()=>[o(a(i),{value:l.worldConfig.seed,"onUpdate:value":e[5]||(e[5]=t=>l.worldConfig.seed=t),placeholder:"留空则随机生成"},null,8,["value"])]),_:1}),o(a(s),{label:"世界大小",path:"worldConfig.size"},{default:n(()=>[o(a(c),{value:l.worldConfig.size,"onUpdate:value":e[6]||(e[6]=t=>l.worldConfig.size=t),options:R},null,8,["value"])]),_:1}),o(a(s),{label:"难度模式",path:"worldConfig.difficulty"},{default:n(()=>[o(a(c),{value:l.worldConfig.difficulty,"onUpdate:value":e[7]||(e[7]=t=>l.worldConfig.difficulty=t),options:q},null,8,["value"])]),_:1}),o(a(s),{label:"自动保存"},{default:n(()=>[o(a(y),{value:l.worldConfig.autoSave,"onUpdate:value":e[8]||(e[8]=t=>l.worldConfig.autoSave=t)},null,8,["value"])]),_:1}),o(a(s),{label:"PvP模式"},{default:n(()=>[o(a(y),{value:l.worldConfig.pvp,"onUpdate:value":e[9]||(e[9]=t=>l.worldConfig.pvp=t)},null,8,["value"])]),_:1}),o(a(s),{label:"硬核模式"},{default:n(()=>[o(a(y),{value:l.worldConfig.hardcore,"onUpdate:value":e[10]||(e[10]=t=>l.worldConfig.hardcore=t)},null,8,["value"])]),_:1}),o(a(s),{label:"语言"},{default:n(()=>[o(a(c),{value:l.worldConfig.language,"onUpdate:value":e[11]||(e[11]=t=>l.worldConfig.language=t),options:I},null,8,["value"])]),_:1}),o(a(s),{label:"欢迎信息 (MOTD)",path:"worldConfig.motd"},{default:n(()=>[o(a(i),{value:l.worldConfig.motd,"onUpdate:value":e[12]||(e[12]=t=>l.worldConfig.motd=t),type:"textarea",rows:2,placeholder:"服务器欢迎信息"},null,8,["value"])]),_:1}),l.type==="tshock"?(f(),p(k,{key:0},[o(a(g),{"title-placement":"left"},{default:n(()=>[...e[21]||(e[21]=[u("span",{style:{color:"#3b82f6"}},"TShock专属配置",-1)])]),_:1}),o(a(s),{label:"REST API端口",path:"tshockConfig.restApiPort",required:""},{default:n(()=>[o(a(_),{value:l.tshockConfig.restApiPort,"onUpdate:value":e[13]||(e[13]=t=>l.tshockConfig.restApiPort=t),min:1,max:65535,class:"w-full"},null,8,["value"])]),_:1}),o(a(s),{label:"REST API Token",path:"tshockConfig.restApiToken",required:""},{default:n(()=>[o(a(i),{value:l.tshockConfig.restApiToken,"onUpdate:value":e[14]||(e[14]=t=>l.tshockConfig.restApiToken=t),type:"password","show-password-on":"mousedown",placeholder:"用于API访问的Token"},null,8,["value"])]),_:1}),o(a(s),{label:"超级管理员密码",path:"tshockConfig.superAdminPassword",required:""},{default:n(()=>[o(a(i),{value:l.tshockConfig.superAdminPassword,"onUpdate:value":e[15]||(e[15]=t=>l.tshockConfig.superAdminPassword=t),type:"password","show-password-on":"mousedown",placeholder:"TShock超级管理员密码"},null,8,["value"])]),_:1}),o(a(s),{label:"启用白名单"},{default:n(()=>[o(a(y),{value:l.tshockConfig.enableWhitelist,"onUpdate:value":e[16]||(e[16]=t=>l.tshockConfig.enableWhitelist=t)},null,8,["value"])]),_:1})],64)):P("",!0),l.type==="tmodloader"?(f(),p(k,{key:1},[o(a(g),{"title-placement":"left"},{default:n(()=>[...e[22]||(e[22]=[u("span",{style:{color:"#eab308"}},"TModLoader专属配置",-1)])]),_:1}),o(a(A),{type:"warning",style:{"margin-bottom":"16px"}},{icon:n(()=>[...e[23]||(e[23]=[u("div",{class:"i-mdi:alert"},null,-1)])]),default:n(()=>[e[24]||(e[24]=m(" 使用TModLoader服务器时，客户端需要安装相同的Mod才能连接 ",-1))]),_:1}),o(a(s),{label:"Mod包URL",path:"tmodloaderConfig.modPackUrl"},{default:n(()=>[o(a(i),{value:l.tmodloaderConfig.modPackUrl,"onUpdate:value":e[17]||(e[17]=t=>l.tmodloaderConfig.modPackUrl=t),placeholder:"Mod包下载链接（可选）"},null,8,["value"])]),_:1})],64)):P("",!0),o(a(s),null,{default:n(()=>[o(a(Z),null,{default:n(()=>[o(a(z),{type:"primary",size:"large",onClick:E,loading:b.value},{default:n(()=>[...e[25]||(e[25]=[m(" 创建房间 ",-1)])]),_:1},8,["loading"]),o(a(z),{size:"large",onClick:O,disabled:b.value},{default:n(()=>[...e[26]||(e[26]=[m(" 取消 ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]))}});export{me as default};
