import{b as C,c as I}from"./terraria-uXugt_Dn.js";import{k as A,r as _,o as D,E as G,O as k,P as o,Q as a,R as l,J as e,Z as r,S as n,j as f,_ as u,m as O}from"./vue-vendor-DIhTWhib.js";import{a0 as S,a1 as p,$ as d,K as z,aN as v,ao as h,ak as c,aA as R,ab as T,L as U}from"./ui-vendor-qucRfopV.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./auth-CeaSTiOI.js";import"./index-CIpQTZjJ.js";import"./spline-vendor-BYERog9l.js";import"./charts-vendor-XI8Sg87J.js";import"./editor-vendor-CUlQiixb.js";const M={class:"terraria-monitor"},$={style:{"font-size":"12px",color:"#666"}},P={style:{"font-size":"12px",color:"#666"}},V={style:{"font-size":"12px",color:"#666"}},j={key:0,style:{"font-size":"13px"}},J={style:{"margin-bottom":"8px"}},K={style:{"font-weight":"600","margin-left":"8px"}},Q={style:{"font-weight":"600","margin-left":"8px"}},W={key:0,style:{"font-size":"13px"}},Z=A({__name:"index",setup(q){const y=_(!0),t=_(null),g=_([]),x=_(null),F=async()=>{try{const s=await C();t.value=s}catch{}},b=async()=>{try{const s=await I(50);g.value=s||[]}catch{}},w=async()=>{y.value=!0;try{await Promise.all([F(),b()])}catch{window.$message?.error("加载监控数据失败")}finally{y.value=!1}},m=(s,i)=>i==="disk"?s>90?"#d03050":s>80?"#f0a020":"#18a058":s>80?"#d03050":s>60?"#f0a020":"#18a058",N=s=>({ERROR:"error",WARN:"warning",INFO:"success",DEBUG:"default"})[s]||"default",B=s=>{try{return new Date(s).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return s}},L=[{title:"时间",key:"timestamp",width:180,render:s=>B(s.timestamp)},{title:"级别",key:"level",width:100,render:s=>O(U,{type:N(s.level),size:"small"},{default:()=>s.level})},{title:"消息",key:"message",ellipsis:{tooltip:!0}}];return D(()=>{w(),x.value=window.setInterval(w,3e3)}),G(()=>{x.value&&clearInterval(x.value)}),(s,i)=>(o(),k("div",M,[a(e(T),{show:y.value},{default:l(()=>[a(e(S),{"x-gap":16,"y-gap":16,cols:3,responsive:"screen"},{default:l(()=>[a(e(p),null,{default:l(()=>[a(e(d),{title:"CPU使用率",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),r(e(z),{key:0,vertical:""},{default:l(()=>[a(e(v),{value:t.value.cpu.toFixed(2),"value-style":{color:m(t.value.cpu,"cpu")}},{suffix:l(()=>[...i[0]||(i[0]=[f("%",-1)])]),_:1},8,["value","value-style"]),a(e(h),{type:"line",percentage:t.value.cpu,color:m(t.value.cpu,"cpu"),"show-indicator":!1},null,8,["percentage","color"]),n("div",$," 更新时间: "+u(new Date(t.value.timestamp).toLocaleTimeString()),1)]),_:1})):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1}),a(e(p),null,{default:l(()=>[a(e(d),{title:"内存使用率",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),r(e(z),{key:0,vertical:""},{default:l(()=>[a(e(v),{value:t.value.memory.toFixed(2),"value-style":{color:m(t.value.memory,"memory")}},{suffix:l(()=>[...i[1]||(i[1]=[f("%",-1)])]),_:1},8,["value","value-style"]),a(e(h),{type:"line",percentage:t.value.memory,color:m(t.value.memory,"memory"),"show-indicator":!1},null,8,["percentage","color"]),n("div",P,u((t.value.memoryUsed/1024/1024/1024).toFixed(2))+" GB / "+u((t.value.memoryTotal/1024/1024/1024).toFixed(2))+" GB ",1)]),_:1})):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1}),a(e(p),null,{default:l(()=>[a(e(d),{title:"磁盘使用率",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),r(e(z),{key:0,vertical:""},{default:l(()=>[a(e(v),{value:t.value.disk.toFixed(2),"value-style":{color:m(t.value.disk,"disk")}},{suffix:l(()=>[...i[2]||(i[2]=[f("%",-1)])]),_:1},8,["value","value-style"]),a(e(h),{type:"line",percentage:t.value.disk,color:m(t.value.disk,"disk"),"show-indicator":!1},null,8,["percentage","color"]),n("div",V,u((t.value.diskUsed/1024/1024/1024).toFixed(2))+" GB / "+u((t.value.diskTotal/1024/1024/1024).toFixed(2))+" GB ",1)]),_:1})):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1})]),_:1}),a(e(S),{"x-gap":16,"y-gap":16,cols:4,responsive:"screen",style:{"margin-top":"16px"}},{default:l(()=>[a(e(p),null,{default:l(()=>[a(e(d),{title:"网络IO",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),k("div",j,[n("div",J,[i[3]||(i[3]=n("span",{style:{color:"#666"}},"接收:",-1)),n("span",K,u((t.value.networkIn/1024/1024).toFixed(2))+" MB ",1)]),n("div",null,[i[4]||(i[4]=n("span",{style:{color:"#666"}},"发送:",-1)),n("span",Q,u((t.value.networkOut/1024/1024).toFixed(2))+" MB ",1)])])):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1}),a(e(p),null,{default:l(()=>[a(e(d),{title:"进程数",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),r(e(v),{key:0,value:t.value.processes||0},null,8,["value"])):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1}),a(e(p),null,{default:l(()=>[a(e(d),{title:"系统负载",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),k("div",W,[n("div",null,"1分钟: "+u(t.value.load1?.toFixed(2)||"N/A"),1),n("div",null,"5分钟: "+u(t.value.load5?.toFixed(2)||"N/A"),1),n("div",null,"15分钟: "+u(t.value.load15?.toFixed(2)||"N/A"),1)])):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1}),a(e(p),null,{default:l(()=>[a(e(d),{title:"运行时间",bordered:!1,size:"small"},{default:l(()=>[t.value?(o(),r(e(v),{key:0,value:Math.floor(t.value.uptime/3600)},{suffix:l(()=>[...i[5]||(i[5]=[f("小时",-1)])]),_:1},8,["value"])):(o(),r(e(c),{key:1,description:"无数据",size:"small"}))]),_:1})]),_:1})]),_:1}),a(e(d),{title:"最近日志",bordered:!1,style:{"margin-top":"16px"}},{default:l(()=>[g.value.length>0?(o(),r(e(R),{key:0,columns:L,data:g.value,pagination:{pageSize:10},bordered:!1,size:"small","max-height":"400"},null,8,["data"])):(o(),r(e(c),{key:1,description:"暂无日志"}))]),_:1})]),_:1},8,["show"])]))}}),ie=E(Z,[["__scopeId","data-v-9cc3c223"]]);export{ie as default};
