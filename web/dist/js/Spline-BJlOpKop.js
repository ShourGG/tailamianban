import{C as _}from"./spline-vendor-BYERog9l.js";import{u as z,_ as C}from"./ParentSize.vue_vue_type_script_setup_true_lang-DFtG3uX1.js";import{k as L,r as o,c as f,o as O,w as B,E,O as F,P as V,Q as R,S as v,R as q,q as x,X as D,L as H,s as N,F as W,n as $}from"./vue-vendor-DIhTWhib.js";import{u as P}from"./index-Dn66_L_1.js";const M=L({__name:"Spline",props:{scene:{type:String,required:!0},onLoad:Function,renderOnDemand:{type:Boolean,default:!0},style:Object},emits:["error","spline-mouse-down","spline-mouse-up","spline-mouse-hover","spline-key-down","spline-key-up","spline-start","spline-look-at","spline-follow","spline-scroll"],setup(m,{emit:y}){const w=console.log;console.log=(...e)=>{e.some(s=>typeof s=="string"&&s.includes("updating from"))||w.apply(console,e)};const r=m,i=y,t=o(null),l=o(!1),n=o(null),u=o(!0);let c=()=>{};const h=f(()=>({overflow:"hidden",...r.style})),g=f(()=>({display:"block",width:"100%",height:"100%"})),{stop:k}=z(t,([{isIntersecting:e}])=>{u.value=e,e&&n.value&&$(()=>{t.value&&n.value&&(n.value.requestRender(),n.value.setSize(t.value.clientWidth,t.value.clientHeight))})},{threshold:.1});function S(e,s){if(!s||!n.value)return;const a=P(s,100,{maxWait:200});return n.value.addEventListener(e,a),()=>n.value?.removeEventListener(e,a)}async function b(){if(t.value){l.value=!0;try{n.value&&(n.value.dispose(),n.value=null),n.value=new _(t.value,{renderOnDemand:!0,alpha:!1,antialias:!1});const e=console.warn;console.warn=(...a)=>{a.some(d=>typeof d=="string"&&d.includes("updating from"))||e.apply(console,a)},await n.value.load(r.scene),console.warn=e;const s=[S("start",a=>i("spline-start",a))].filter(Boolean);return l.value=!1,r.onLoad?.(n.value),()=>{s.forEach(a=>a?.())}}catch(e){return i("error",e),l.value=!1,()=>{}}}}async function p(){c(),c=await b()??(()=>{})}return O(async()=>{await p(),B(u,e=>{e&&p()})}),E(()=>{k(),n.value&&(n.value.dispose(),n.value=null)}),(e,s)=>(V(),F(W,null,[R(C,N({"parent-size-styles":h.value,"debounce-time":50},e.$attrs),{default:q(()=>[v("canvas",{ref_key:"canvasRef",ref:t,style:H(g.value)},null,4),l.value?x(e.$slots,"default",{key:0}):D("",!0)]),_:3},16,["parent-size-styles"]),s[0]||(s[0]=v("div",{class:"login-logo"},null,-1))],64))}});export{M as default};
