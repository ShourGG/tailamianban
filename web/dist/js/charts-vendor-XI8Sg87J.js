import{s as LQ,c as Kx,i as Rv,a as is,u as XD,l as OQ,b as ql,d as i8,e as Ki,f as DQ,m as Cn,g as n8,h as IQ,j as HQ,k as YD,n as kl,o as FQ,p as r8,q as zQ,r as KD,t as NQ,v as Gy,w as T2,x as qD,y as WQ}from"./ui-vendor-qucRfopV.js";import{k as tn,N as VQ,E as GQ,O as Di,P as ti,Q as Al,q as Zd,R as M2,S as Jd,J as Xt,g as ty,r as qi,w as li,c as be,U as o8,i as hp,V as s8,d as $Q,o as uu,F as Fa,W as yE,L as jh,n as El,b as a8,X as za,Y as jQ,Z as cg,x as MC,t as dn,H as V0,_ as R2,e as UQ,$ as N_,p as fg,a0 as l8,m as hi,a1 as Be,a2 as bE,K as XQ,a3 as YQ,a4 as KQ,s as h8,a5 as qQ,a as ZQ,a6 as JQ,j as QQ,G as t0}from"./vue-vendor-DIhTWhib.js";var $y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _E(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function c7t(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),e}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var B2=function(n,t){return B2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])},B2(n,t)};function ct(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");B2(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var ttt=function(){function n(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return n}(),ett=function(){function n(){this.browser=new ttt,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return n}(),ie=new ett;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(ie.wxa=!0,ie.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?ie.worker=!0:!ie.hasGlobalWindow||"Deno"in window?(ie.node=!0,ie.svgSupported=!0):itt(navigator.userAgent,ie);function itt(n,t){var e=t.browser,i=n.match(/Firefox\/([\d.]+)/),r=n.match(/MSIE\s([\d.]+)/)||n.match(/Trident\/.+?rv:(([\d.]+))/),o=n.match(/Edge?\/([\d.]+)/),s=/micromessenger/i.test(n);i&&(e.firefox=!0,e.version=i[1]),r&&(e.ie=!0,e.version=r[1]),o&&(e.edge=!0,e.version=o[1],e.newEdge=+o[1].split(".")[0]>18),s&&(e.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!e.ie&&!e.edge,t.pointerEventsSupported="onpointerdown"in window&&(e.edge||e.ie&&+e.version>=11),t.domSupported=typeof document<"u";var a=document.documentElement.style;t.transform3dSupported=(e.ie&&"transition"in a||e.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in a)&&!("OTransition"in a),t.transformSupported=t.transform3dSupported||e.ie&&+e.version>=9}var CE=12,ntt="sans-serif",Qd=CE+"px "+ntt,rtt=20,ott=100,stt="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function att(n){var t={};if(typeof JSON>"u")return t;for(var e=0;e<n.length;e++){var i=String.fromCharCode(e+32),r=(n.charCodeAt(e)-rtt)/ott;t[i]=r}return t}var ltt=att(stt),up={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var n,t;return function(e,i){if(!n){var r=up.createCanvas();n=r&&r.getContext("2d")}if(n)return t!==i&&(t=n.font=i||Qd),n.measureText(e);e=e||"",i=i||Qd;var o=/((?:\d+)?\.?\d*)px/.exec(i),s=o&&+o[1]||CE,a=0;if(i.indexOf("mono")>=0)a=s*e.length;else for(var l=0;l<e.length;l++){var h=ltt[e[l]];a+=h==null?s:h*s}return{width:a}}}(),loadImage:function(n,t,e){var i=new Image;return i.onload=t,i.onerror=e,i.src=n,i}},u8=Uh(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(n,t){return n["[object "+t+"]"]=!0,n},{}),d8=Uh(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(n,t){return n["[object "+t+"Array]"]=!0,n},{}),ey=Object.prototype.toString,qx=Array.prototype,htt=qx.forEach,utt=qx.filter,wE=qx.slice,dtt=qx.map,ZD=function(){}.constructor,jy=ZD?ZD.prototype:null,xE="__proto__",ctt=2311;function c8(){return ctt++}function SE(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t]}function ne(n){if(n==null||typeof n!="object")return n;var t=n,e=ey.call(n);if(e==="[object Array]"){if(!i0(n)){t=[];for(var i=0,r=n.length;i<r;i++)t[i]=ne(n[i])}}else if(d8[e]){if(!i0(n)){var o=n.constructor;if(o.from)t=o.from(n);else{t=new o(n.length);for(var i=0,r=n.length;i<r;i++)t[i]=n[i]}}}else if(!u8[e]&&!i0(n)&&!gg(n)){t={};for(var s in n)n.hasOwnProperty(s)&&s!==xE&&(t[s]=ne(n[s]))}return t}function we(n,t,e){if(!Ht(t)||!Ht(n))return e?ne(t):n;for(var i in t)if(t.hasOwnProperty(i)&&i!==xE){var r=n[i],o=t[i];Ht(o)&&Ht(r)&&!_t(o)&&!_t(r)&&!gg(o)&&!gg(r)&&!JD(o)&&!JD(r)&&!i0(o)&&!i0(r)?we(r,o,e):(e||!(i in n))&&(n[i]=ne(t[i]))}return n}function ft(n,t){if(Object.assign)Object.assign(n,t);else for(var e in t)t.hasOwnProperty(e)&&e!==xE&&(n[e]=t[e]);return n}function Gt(n,t,e){for(var i=yi(t),r=0,o=i.length;r<o;r++){var s=i[r];n[s]==null&&(n[s]=t[s])}return n}function _e(n,t){if(n){if(n.indexOf)return n.indexOf(t);for(var e=0,i=n.length;e<i;e++)if(n[e]===t)return e}return-1}function ftt(n,t){var e=n.prototype;function i(){}i.prototype=t.prototype,n.prototype=new i;for(var r in e)e.hasOwnProperty(r)&&(n.prototype[r]=e[r]);n.prototype.constructor=n,n.superClass=t}function ea(n,t,e){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var i=Object.getOwnPropertyNames(t),r=0;r<i.length;r++){var o=i[r];o!=="constructor"&&n[o]==null&&(n[o]=t[o])}else Gt(n,t)}function Yr(n){return!n||typeof n=="string"?!1:typeof n.length=="number"}function N(n,t,e){if(n&&t)if(n.forEach&&n.forEach===htt)n.forEach(t,e);else if(n.length===+n.length)for(var i=0,r=n.length;i<r;i++)t.call(e,n[i],i,n);else for(var o in n)n.hasOwnProperty(o)&&t.call(e,n[o],o,n)}function St(n,t,e){if(!n)return[];if(!t)return AE(n);if(n.map&&n.map===dtt)return n.map(t,e);for(var i=[],r=0,o=n.length;r<o;r++)i.push(t.call(e,n[r],r,n));return i}function Uh(n,t,e,i){if(n&&t){for(var r=0,o=n.length;r<o;r++)e=t.call(i,e,n[r],r,n);return e}}function Ti(n,t,e){if(!n)return[];if(!t)return AE(n);if(n.filter&&n.filter===utt)return n.filter(t,e);for(var i=[],r=0,o=n.length;r<o;r++)t.call(e,n[r],r,n)&&i.push(n[r]);return i}function yi(n){if(!n)return[];if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t}function gtt(n,t){for(var e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];return function(){return n.apply(t,e.concat(wE.call(arguments)))}}var zt=jy&&jt(jy.bind)?jy.call.bind(jy.bind):gtt;function he(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){return n.apply(this,t.concat(wE.call(arguments)))}}function _t(n){return Array.isArray?Array.isArray(n):ey.call(n)==="[object Array]"}function jt(n){return typeof n=="function"}function Pt(n){return typeof n=="string"}function P2(n){return ey.call(n)==="[object String]"}function di(n){return typeof n=="number"}function Ht(n){var t=typeof n;return t==="function"||!!n&&t==="object"}function JD(n){return!!u8[ey.call(n)]}function Kr(n){return!!d8[ey.call(n)]}function gg(n){return typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.ownerDocument=="object"}function Zx(n){return n.colorStops!=null}function ptt(n){return n.image!=null}function RC(n){return n!==n}function pg(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var e=0,i=n.length;e<i;e++)if(n[e]!=null)return n[e]}function ve(n,t){return n??t}function e0(n,t,e){return n??t??e}function AE(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return wE.apply(n,t)}function TE(n){if(typeof n=="number")return[n,n,n,n];var t=n.length;return t===2?[n[0],n[1],n[0],n[1]]:t===3?[n[0],n[1],n[2],n[1]]:n}function ps(n,t){if(!n)throw new Error(t)}function Ba(n){return n==null?null:typeof n.trim=="function"?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var f8="__ec_primitive__";function k2(n){n[f8]=!0}function i0(n){return n[f8]}var vtt=function(){function n(){this.data={}}return n.prototype.delete=function(t){var e=this.has(t);return e&&delete this.data[t],e},n.prototype.has=function(t){return this.data.hasOwnProperty(t)},n.prototype.get=function(t){return this.data[t]},n.prototype.set=function(t,e){return this.data[t]=e,this},n.prototype.keys=function(){return yi(this.data)},n.prototype.forEach=function(t){var e=this.data;for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)},n}(),g8=typeof Map=="function";function mtt(){return g8?new Map:new vtt}var ytt=function(){function n(t){var e=_t(t);this.data=mtt();var i=this;t instanceof n?t.each(r):t&&N(t,r);function r(o,s){e?i.set(o,s):i.set(s,o)}}return n.prototype.hasKey=function(t){return this.data.has(t)},n.prototype.get=function(t){return this.data.get(t)},n.prototype.set=function(t,e){return this.data.set(t,e),e},n.prototype.each=function(t,e){this.data.forEach(function(i,r){t.call(e,i,r)})},n.prototype.keys=function(){var t=this.data.keys();return g8?Array.from(t):t},n.prototype.removeKey=function(t){this.data.delete(t)},n}();function $t(n){return new ytt(n)}function p8(n,t){for(var e=new n.constructor(n.length+t.length),i=0;i<n.length;i++)e[i]=n[i];for(var r=n.length,i=0;i<t.length;i++)e[i+r]=t[i];return e}function Jx(n,t){var e;if(Object.create)e=Object.create(n);else{var i=function(){};i.prototype=n,e=new i}return t&&ft(e,t),e}function v8(n){var t=n.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function tc(n,t){return n.hasOwnProperty(t)}function ir(){}var btt=180/Math.PI;function dp(n,t){return n==null&&(n=0),t==null&&(t=0),[n,t]}function _tt(n){return[n[0],n[1]]}function QD(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n}function Ctt(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n}function wtt(n){return Math.sqrt(xtt(n))}function xtt(n){return n[0]*n[0]+n[1]*n[1]}function bT(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n}function Stt(n,t){var e=wtt(t);return e===0?(n[0]=0,n[1]=0):(n[0]=t[0]/e,n[1]=t[1]/e),n}function E2(n,t){return Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1]))}var L2=E2;function Att(n,t){return(n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])}var Hf=Att;function W_(n,t,e,i){return n[0]=t[0]+i*(e[0]-t[0]),n[1]=t[1]+i*(e[1]-t[1]),n}function hs(n,t,e){var i=t[0],r=t[1];return n[0]=e[0]*i+e[2]*r+e[4],n[1]=e[1]*i+e[3]*r+e[5],n}function xf(n,t,e){return n[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n}function Sf(n,t,e){return n[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n}var Oc=function(){function n(t,e){this.target=t,this.topTarget=e&&e.topTarget}return n}(),Ttt=function(){function n(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return n.prototype._dragStart=function(t){for(var e=t.target;e&&!e.draggable;)e=e.parent||e.__hostTarget;e&&(this._draggingTarget=e,e.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new Oc(e,t),"dragstart",t.event))},n.prototype._drag=function(t){var e=this._draggingTarget;if(e){var i=t.offsetX,r=t.offsetY,o=i-this._x,s=r-this._y;this._x=i,this._y=r,e.drift(o,s,t),this.handler.dispatchToElement(new Oc(e,t),"drag",t.event);var a=this.handler.findHover(i,r,e).target,l=this._dropTarget;this._dropTarget=a,e!==a&&(l&&a!==l&&this.handler.dispatchToElement(new Oc(l,t),"dragleave",t.event),a&&a!==l&&this.handler.dispatchToElement(new Oc(a,t),"dragenter",t.event))}},n.prototype._dragEnd=function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.handler.dispatchToElement(new Oc(e,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new Oc(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},n}(),ys=function(){function n(t){t&&(this._$eventProcessor=t)}return n.prototype.on=function(t,e,i,r){this._$handlers||(this._$handlers={});var o=this._$handlers;if(typeof e=="function"&&(r=i,i=e,e=null),!i||!t)return this;var s=this._$eventProcessor;e!=null&&s&&s.normalizeQuery&&(e=s.normalizeQuery(e)),o[t]||(o[t]=[]);for(var a=0;a<o[t].length;a++)if(o[t][a].h===i)return this;var l={h:i,query:e,ctx:r||this,callAtLast:i.zrEventfulCallAtLast},h=o[t].length-1,u=o[t][h];return u&&u.callAtLast?o[t].splice(h,0,l):o[t].push(l),this},n.prototype.isSilent=function(t){var e=this._$handlers;return!e||!e[t]||!e[t].length},n.prototype.off=function(t,e){var i=this._$handlers;if(!i)return this;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var r=[],o=0,s=i[t].length;o<s;o++)i[t][o].h!==e&&r.push(i[t][o]);i[t]=r}i[t]&&i[t].length===0&&delete i[t]}else delete i[t];return this},n.prototype.trigger=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this._$handlers)return this;var r=this._$handlers[t],o=this._$eventProcessor;if(r)for(var s=e.length,a=r.length,l=0;l<a;l++){var h=r[l];if(!(o&&o.filter&&h.query!=null&&!o.filter(t,h.query)))switch(s){case 0:h.h.call(h.ctx);break;case 1:h.h.call(h.ctx,e[0]);break;case 2:h.h.call(h.ctx,e[0],e[1]);break;default:h.h.apply(h.ctx,e);break}}return o&&o.afterTrigger&&o.afterTrigger(t),this},n.prototype.triggerWithContext=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this._$handlers)return this;var r=this._$handlers[t],o=this._$eventProcessor;if(r)for(var s=e.length,a=e[s-1],l=r.length,h=0;h<l;h++){var u=r[h];if(!(o&&o.filter&&u.query!=null&&!o.filter(t,u.query)))switch(s){case 0:u.h.call(a);break;case 1:u.h.call(a,e[0]);break;case 2:u.h.call(a,e[0],e[1]);break;default:u.h.apply(a,e.slice(1,s-1));break}}return o&&o.afterTrigger&&o.afterTrigger(t),this},n}(),Mtt=Math.log(2);function O2(n,t,e,i,r,o){var s=i+"-"+r,a=n.length;if(o.hasOwnProperty(s))return o[s];if(t===1){var l=Math.round(Math.log((1<<a)-1&~r)/Mtt);return n[e][l]}for(var h=i|1<<e,u=e+1;i&1<<u;)u++;for(var d=0,c=0,f=0;c<a;c++){var g=1<<c;g&r||(d+=(f%2?-1:1)*n[e][c]*O2(n,t-1,u,h,r|g,o),f++)}return o[s]=d,d}function tI(n,t){var e=[[n[0],n[1],1,0,0,0,-t[0]*n[0],-t[0]*n[1]],[0,0,0,n[0],n[1],1,-t[1]*n[0],-t[1]*n[1]],[n[2],n[3],1,0,0,0,-t[2]*n[2],-t[2]*n[3]],[0,0,0,n[2],n[3],1,-t[3]*n[2],-t[3]*n[3]],[n[4],n[5],1,0,0,0,-t[4]*n[4],-t[4]*n[5]],[0,0,0,n[4],n[5],1,-t[5]*n[4],-t[5]*n[5]],[n[6],n[7],1,0,0,0,-t[6]*n[6],-t[6]*n[7]],[0,0,0,n[6],n[7],1,-t[7]*n[6],-t[7]*n[7]]],i={},r=O2(e,8,0,0,0,i);if(r!==0){for(var o=[],s=0;s<8;s++)for(var a=0;a<8;a++)o[a]==null&&(o[a]=0),o[a]+=((s+a)%2?-1:1)*O2(e,7,s===0?1:0,1<<s,1<<a,i)/r*t[s];return function(l,h,u){var d=h*o[6]+u*o[7]+1;l[0]=(h*o[0]+u*o[1]+o[2])/d,l[1]=(h*o[3]+u*o[4]+o[5])/d}}}var eI="___zrEVENTSAVED",_T=[];function Rtt(n,t,e,i,r){return D2(_T,t,i,r,!0)&&D2(n,e,_T[0],_T[1])}function D2(n,t,e,i,r){if(t.getBoundingClientRect&&ie.domSupported&&!m8(t)){var o=t[eI]||(t[eI]={}),s=Btt(t,o),a=Ptt(s,o,r);if(a)return a(n,e,i),!0}return!1}function Btt(n,t){var e=t.markers;if(e)return e;e=t.markers=[];for(var i=["left","right"],r=["top","bottom"],o=0;o<4;o++){var s=document.createElement("div"),a=s.style,l=o%2,h=(o>>1)%2;a.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",i[l]+":0",r[h]+":0",i[1-l]+":auto",r[1-h]+":auto",""].join("!important;"),n.appendChild(s),e.push(s)}return e}function Ptt(n,t,e){for(var i=e?"invTrans":"trans",r=t[i],o=t.srcCoords,s=[],a=[],l=!0,h=0;h<4;h++){var u=n[h].getBoundingClientRect(),d=2*h,c=u.left,f=u.top;s.push(c,f),l=l&&o&&c===o[d]&&f===o[d+1],a.push(n[h].offsetLeft,n[h].offsetTop)}return l&&r?r:(t.srcCoords=s,t[i]=e?tI(a,s):tI(s,a))}function m8(n){return n.nodeName.toUpperCase()==="CANVAS"}var ktt=/([&<>"'])/g,Ett={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Hr(n){return n==null?"":(n+"").replace(ktt,function(t,e){return Ett[e]})}var Ltt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,CT=[],Ott=ie.browser.firefox&&+ie.browser.version.split(".")[0]<39;function I2(n,t,e,i){return e=e||{},i?iI(n,t,e):Ott&&t.layerX!=null&&t.layerX!==t.offsetX?(e.zrX=t.layerX,e.zrY=t.layerY):t.offsetX!=null?(e.zrX=t.offsetX,e.zrY=t.offsetY):iI(n,t,e),e}function iI(n,t,e){if(ie.domSupported&&n.getBoundingClientRect){var i=t.clientX,r=t.clientY;if(m8(n)){var o=n.getBoundingClientRect();e.zrX=i-o.left,e.zrY=r-o.top;return}else if(D2(CT,n,i,r)){e.zrX=CT[0],e.zrY=CT[1];return}}e.zrX=e.zrY=0}function ME(n){return n||window.event}function Fo(n,t,e){if(t=ME(t),t.zrX!=null)return t;var i=t.type,r=i&&i.indexOf("touch")>=0;if(r){var s=i!=="touchend"?t.targetTouches[0]:t.changedTouches[0];s&&I2(n,s,t,e)}else{I2(n,t,t,e);var o=Dtt(t);t.zrDelta=o?o/120:-(t.detail||0)/3}var a=t.button;return t.which==null&&a!==void 0&&Ltt.test(t.type)&&(t.which=a&1?1:a&2?3:a&4?2:0),t}function Dtt(n){var t=n.wheelDelta;if(t)return t;var e=n.deltaX,i=n.deltaY;if(e==null||i==null)return t;var r=Math.abs(i!==0?i:e),o=i>0?-1:i<0?1:e>0?-1:1;return 3*r*o}function H2(n,t,e,i){n.addEventListener(t,e,i)}function Itt(n,t,e,i){n.removeEventListener(t,e,i)}var vg=function(n){n.preventDefault(),n.stopPropagation(),n.cancelBubble=!0};function nI(n){return n.which===2||n.which===3}var Htt=function(){function n(){this._track=[]}return n.prototype.recognize=function(t,e,i){return this._doTrack(t,e,i),this._recognize(t)},n.prototype.clear=function(){return this._track.length=0,this},n.prototype._doTrack=function(t,e,i){var r=t.touches;if(r){for(var o={points:[],touches:[],target:e,event:t},s=0,a=r.length;s<a;s++){var l=r[s],h=I2(i,l,{});o.points.push([h.zrX,h.zrY]),o.touches.push(l)}this._track.push(o)}},n.prototype._recognize=function(t){for(var e in wT)if(wT.hasOwnProperty(e)){var i=wT[e](this._track,t);if(i)return i}},n}();function rI(n){var t=n[1][0]-n[0][0],e=n[1][1]-n[0][1];return Math.sqrt(t*t+e*e)}function Ftt(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}var wT={pinch:function(n,t){var e=n.length;if(e){var i=(n[e-1]||{}).points,r=(n[e-2]||{}).points||i;if(r&&r.length>1&&i&&i.length>1){var o=rI(i)/rI(r);!isFinite(o)&&(o=1),t.pinchScale=o;var s=Ftt(i);return t.pinchX=s[0],t.pinchY=s[1],{type:"pinch",target:n[0].target,event:t}}}}};function Nh(){return[1,0,0,1,0,0]}function RE(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function ztt(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function Ff(n,t,e){var i=t[0]*e[0]+t[2]*e[1],r=t[1]*e[0]+t[3]*e[1],o=t[0]*e[2]+t[2]*e[3],s=t[1]*e[2]+t[3]*e[3],a=t[0]*e[4]+t[2]*e[5]+t[4],l=t[1]*e[4]+t[3]*e[5]+t[5];return n[0]=i,n[1]=r,n[2]=o,n[3]=s,n[4]=a,n[5]=l,n}function mg(n,t,e){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4]+e[0],n[5]=t[5]+e[1],n}function Qx(n,t,e,i){i===void 0&&(i=[0,0]);var r=t[0],o=t[2],s=t[4],a=t[1],l=t[3],h=t[5],u=Math.sin(e),d=Math.cos(e);return n[0]=r*d+a*u,n[1]=-r*u+a*d,n[2]=o*d+l*u,n[3]=-o*u+d*l,n[4]=d*(s-i[0])+u*(h-i[1])+i[0],n[5]=d*(h-i[1])-u*(s-i[0])+i[1],n}function y8(n,t,e){var i=e[0],r=e[1];return n[0]=t[0]*i,n[1]=t[1]*r,n[2]=t[2]*i,n[3]=t[3]*r,n[4]=t[4]*i,n[5]=t[5]*r,n}function tS(n,t){var e=t[0],i=t[2],r=t[4],o=t[1],s=t[3],a=t[5],l=e*s-o*i;return l?(l=1/l,n[0]=s*l,n[1]=-o*l,n[2]=-i*l,n[3]=e*l,n[4]=(i*a-s*r)*l,n[5]=(o*r-e*a)*l,n):null}var Vt=function(){function n(t,e){this.x=t||0,this.y=e||0}return n.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set=function(t,e){return this.x=t,this.y=e,this},n.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},n.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.scale=function(t){this.x*=t,this.y*=t},n.prototype.scaleAndAdd=function(t,e){this.x+=t.x*e,this.y+=t.y*e},n.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y},n.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},n.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},n.prototype.distanceSquare=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.transform=function(t){if(t){var e=this.x,i=this.y;return this.x=t[0]*e+t[2]*i+t[4],this.y=t[1]*e+t[3]*i+t[5],this}},n.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},n.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},n.set=function(t,e,i){t.x=e,t.y=i},n.copy=function(t,e){t.x=e.x,t.y=e.y},n.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.lenSquare=function(t){return t.x*t.x+t.y*t.y},n.dot=function(t,e){return t.x*e.x+t.y*e.y},n.add=function(t,e,i){t.x=e.x+i.x,t.y=e.y+i.y},n.sub=function(t,e,i){t.x=e.x-i.x,t.y=e.y-i.y},n.scale=function(t,e,i){t.x=e.x*i,t.y=e.y*i},n.scaleAndAdd=function(t,e,i,r){t.x=e.x+i.x*r,t.y=e.y+i.y*r},n.lerp=function(t,e,i,r){var o=1-r;t.x=o*e.x+r*i.x,t.y=o*e.y+r*i.y},n}(),Uy=Math.min,Xy=Math.max,_u=new Vt,Cu=new Vt,wu=new Vt,xu=new Vt,Fp=new Vt,zp=new Vt,Te=function(){function n(t,e,i,r){i<0&&(t=t+i,i=-i),r<0&&(e=e+r,r=-r),this.x=t,this.y=e,this.width=i,this.height=r}return n.prototype.union=function(t){var e=Uy(t.x,this.x),i=Uy(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=Xy(t.x+t.width,this.x+this.width)-e:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=Xy(t.y+t.height,this.y+this.height)-i:this.height=t.height,this.x=e,this.y=i},n.prototype.applyTransform=function(t){n.applyTransform(this,this,t)},n.prototype.calculateTransform=function(t){var e=this,i=t.width/e.width,r=t.height/e.height,o=Nh();return mg(o,o,[-e.x,-e.y]),y8(o,o,[i,r]),mg(o,o,[t.x,t.y]),o},n.prototype.intersect=function(t,e){if(!t)return!1;t instanceof n||(t=n.create(t));var i=this,r=i.x,o=i.x+i.width,s=i.y,a=i.y+i.height,l=t.x,h=t.x+t.width,u=t.y,d=t.y+t.height,c=!(o<l||h<r||a<u||d<s);if(e){var f=1/0,g=0,p=Math.abs(o-l),v=Math.abs(h-r),m=Math.abs(a-u),y=Math.abs(d-s),b=Math.min(p,v),_=Math.min(m,y);o<l||h<r?b>g&&(g=b,p<v?Vt.set(zp,-p,0):Vt.set(zp,v,0)):b<f&&(f=b,p<v?Vt.set(Fp,p,0):Vt.set(Fp,-v,0)),a<u||d<s?_>g&&(g=_,m<y?Vt.set(zp,0,-m):Vt.set(zp,0,y)):b<f&&(f=b,m<y?Vt.set(Fp,0,m):Vt.set(Fp,0,-y))}return e&&Vt.copy(e,c?Fp:zp),c},n.prototype.contain=function(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copy=function(t){n.copy(this,t)},n.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},n.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.prototype.isZero=function(){return this.width===0||this.height===0},n.create=function(t){return new n(t.x,t.y,t.width,t.height)},n.copy=function(t,e){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},n.applyTransform=function(t,e,i){if(!i){t!==e&&n.copy(t,e);return}if(i[1]<1e-5&&i[1]>-1e-5&&i[2]<1e-5&&i[2]>-1e-5){var r=i[0],o=i[3],s=i[4],a=i[5];t.x=e.x*r+s,t.y=e.y*o+a,t.width=e.width*r,t.height=e.height*o,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}_u.x=wu.x=e.x,_u.y=xu.y=e.y,Cu.x=xu.x=e.x+e.width,Cu.y=wu.y=e.y+e.height,_u.transform(i),xu.transform(i),Cu.transform(i),wu.transform(i),t.x=Uy(_u.x,Cu.x,wu.x,xu.x),t.y=Uy(_u.y,Cu.y,wu.y,xu.y);var l=Xy(_u.x,Cu.x,wu.x,xu.x),h=Xy(_u.y,Cu.y,wu.y,xu.y);t.width=l-t.x,t.height=h-t.y},n}(),b8="silent";function Ntt(n,t,e){return{type:n,event:e,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:e.zrX,offsetY:e.zrY,gestureEvent:e.gestureEvent,pinchX:e.pinchX,pinchY:e.pinchY,pinchScale:e.pinchScale,wheelDelta:e.zrDelta,zrByTouch:e.zrByTouch,which:e.which,stop:Wtt}}function Wtt(){vg(this.event)}var Vtt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.handler=null,e}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(ys),Np=function(){function n(t,e){this.x=t,this.y=e}return n}(),Gtt=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],xT=new Te(0,0,0,0),_8=function(n){ct(t,n);function t(e,i,r,o,s){var a=n.call(this)||this;return a._hovered=new Np(0,0),a.storage=e,a.painter=i,a.painterRoot=o,a._pointerSize=s,r=r||new Vtt,a.proxy=null,a.setHandlerProxy(r),a._draggingMgr=new Ttt(a),a}return t.prototype.setHandlerProxy=function(e){this.proxy&&this.proxy.dispose(),e&&(N(Gtt,function(i){e.on&&e.on(i,this[i],this)},this),e.handler=this),this.proxy=e},t.prototype.mousemove=function(e){var i=e.zrX,r=e.zrY,o=C8(this,i,r),s=this._hovered,a=s.target;a&&!a.__zr&&(s=this.findHover(s.x,s.y),a=s.target);var l=this._hovered=o?new Np(i,r):this.findHover(i,r),h=l.target,u=this.proxy;u.setCursor&&u.setCursor(h?h.cursor:"default"),a&&h!==a&&this.dispatchToElement(s,"mouseout",e),this.dispatchToElement(l,"mousemove",e),h&&h!==a&&this.dispatchToElement(l,"mouseover",e)},t.prototype.mouseout=function(e){var i=e.zrEventControl;i!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",e),i!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:e})},t.prototype.resize=function(){this._hovered=new Np(0,0)},t.prototype.dispatch=function(e,i){var r=this[e];r&&r.call(this,i)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(e){var i=this.proxy;i.setCursor&&i.setCursor(e)},t.prototype.dispatchToElement=function(e,i,r){e=e||{};var o=e.target;if(!(o&&o.silent)){for(var s="on"+i,a=Ntt(i,e,r);o&&(o[s]&&(a.cancelBubble=!!o[s].call(o,a)),o.trigger(i,a),o=o.__hostTarget?o.__hostTarget:o.parent,!a.cancelBubble););a.cancelBubble||(this.trigger(i,a),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[s]=="function"&&l[s].call(l,a),l.trigger&&l.trigger(i,a)}))}},t.prototype.findHover=function(e,i,r){var o=this.storage.getDisplayList(),s=new Np(e,i);if(oI(o,s,e,i,r),this._pointerSize&&!s.target){for(var a=[],l=this._pointerSize,h=l/2,u=new Te(e-h,i-h,l,l),d=o.length-1;d>=0;d--){var c=o[d];c!==r&&!c.ignore&&!c.ignoreCoarsePointer&&(!c.parent||!c.parent.ignoreCoarsePointer)&&(xT.copy(c.getBoundingRect()),c.transform&&xT.applyTransform(c.transform),xT.intersect(u)&&a.push(c))}if(a.length)for(var f=4,g=Math.PI/12,p=Math.PI*2,v=0;v<h;v+=f)for(var m=0;m<p;m+=g){var y=e+v*Math.cos(m),b=i+v*Math.sin(m);if(oI(a,s,y,b,r),s.target)return s}}return s},t.prototype.processGesture=function(e,i){this._gestureMgr||(this._gestureMgr=new Htt);var r=this._gestureMgr;i==="start"&&r.clear();var o=r.recognize(e,this.findHover(e.zrX,e.zrY,null).target,this.proxy.dom);if(i==="end"&&r.clear(),o){var s=o.type;e.gestureEvent=s;var a=new Np;a.target=o.target,this.dispatchToElement(a,s,o.event)}},t}(ys);N(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){_8.prototype[n]=function(t){var e=t.zrX,i=t.zrY,r=C8(this,e,i),o,s;if((n!=="mouseup"||!r)&&(o=this.findHover(e,i),s=o.target),n==="mousedown")this._downEl=s,this._downPoint=[t.zrX,t.zrY],this._upEl=s;else if(n==="mouseup")this._upEl=s;else if(n==="click"){if(this._downEl!==this._upEl||!this._downPoint||L2(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(o,n,t)}});function $tt(n,t,e){if(n[n.rectHover?"rectContain":"contain"](t,e)){for(var i=n,r=void 0,o=!1;i;){if(i.ignoreClip&&(o=!0),!o){var s=i.getClipPath();if(s&&!s.contain(t,e))return!1}i.silent&&(r=!0);var a=i.__hostTarget;i=a||i.parent}return r?b8:!0}return!1}function oI(n,t,e,i,r){for(var o=n.length-1;o>=0;o--){var s=n[o],a=void 0;if(s!==r&&!s.ignore&&(a=$tt(s,e,i))&&(!t.topTarget&&(t.topTarget=s),a!==b8)){t.target=s;break}}}function C8(n,t,e){var i=n.painter;return t<0||t>i.getWidth()||e<0||e>i.getHeight()}var w8=32,Wp=7;function jtt(n){for(var t=0;n>=w8;)t|=n&1,n>>=1;return n+t}function sI(n,t,e,i){var r=t+1;if(r===e)return 1;if(i(n[r++],n[t])<0){for(;r<e&&i(n[r],n[r-1])<0;)r++;Utt(n,t,r)}else for(;r<e&&i(n[r],n[r-1])>=0;)r++;return r-t}function Utt(n,t,e){for(e--;t<e;){var i=n[t];n[t++]=n[e],n[e--]=i}}function aI(n,t,e,i,r){for(i===t&&i++;i<e;i++){for(var o=n[i],s=t,a=i,l;s<a;)l=s+a>>>1,r(o,n[l])<0?a=l:s=l+1;var h=i-s;switch(h){case 3:n[s+3]=n[s+2];case 2:n[s+2]=n[s+1];case 1:n[s+1]=n[s];break;default:for(;h>0;)n[s+h]=n[s+h-1],h--}n[s]=o}}function ST(n,t,e,i,r,o){var s=0,a=0,l=1;if(o(n,t[e+r])>0){for(a=i-r;l<a&&o(n,t[e+r+l])>0;)s=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a),s+=r,l+=r}else{for(a=r+1;l<a&&o(n,t[e+r-l])<=0;)s=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a);var h=s;s=r-l,l=r-h}for(s++;s<l;){var u=s+(l-s>>>1);o(n,t[e+u])>0?s=u+1:l=u}return l}function AT(n,t,e,i,r,o){var s=0,a=0,l=1;if(o(n,t[e+r])<0){for(a=r+1;l<a&&o(n,t[e+r-l])<0;)s=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a);var h=s;s=r-l,l=r-h}else{for(a=i-r;l<a&&o(n,t[e+r+l])>=0;)s=l,l=(l<<1)+1,l<=0&&(l=a);l>a&&(l=a),s+=r,l+=r}for(s++;s<l;){var u=s+(l-s>>>1);o(n,t[e+u])<0?l=u:s=u+1}return l}function Xtt(n,t){var e=Wp,i,r,o=0,s=[];i=[],r=[];function a(f,g){i[o]=f,r[o]=g,o+=1}function l(){for(;o>1;){var f=o-2;if(f>=1&&r[f-1]<=r[f]+r[f+1]||f>=2&&r[f-2]<=r[f]+r[f-1])r[f-1]<r[f+1]&&f--;else if(r[f]>r[f+1])break;u(f)}}function h(){for(;o>1;){var f=o-2;f>0&&r[f-1]<r[f+1]&&f--,u(f)}}function u(f){var g=i[f],p=r[f],v=i[f+1],m=r[f+1];r[f]=p+m,f===o-3&&(i[f+1]=i[f+2],r[f+1]=r[f+2]),o--;var y=AT(n[v],n,g,p,0,t);g+=y,p-=y,p!==0&&(m=ST(n[g+p-1],n,v,m,m-1,t),m!==0&&(p<=m?d(g,p,v,m):c(g,p,v,m)))}function d(f,g,p,v){var m=0;for(m=0;m<g;m++)s[m]=n[f+m];var y=0,b=p,_=f;if(n[_++]=n[b++],--v===0){for(m=0;m<g;m++)n[_+m]=s[y+m];return}if(g===1){for(m=0;m<v;m++)n[_+m]=n[b+m];n[_+v]=s[y];return}for(var w=e,C,x,S;;){C=0,x=0,S=!1;do if(t(n[b],s[y])<0){if(n[_++]=n[b++],x++,C=0,--v===0){S=!0;break}}else if(n[_++]=s[y++],C++,x=0,--g===1){S=!0;break}while((C|x)<w);if(S)break;do{if(C=AT(n[b],s,y,g,0,t),C!==0){for(m=0;m<C;m++)n[_+m]=s[y+m];if(_+=C,y+=C,g-=C,g<=1){S=!0;break}}if(n[_++]=n[b++],--v===0){S=!0;break}if(x=ST(s[y],n,b,v,0,t),x!==0){for(m=0;m<x;m++)n[_+m]=n[b+m];if(_+=x,b+=x,v-=x,v===0){S=!0;break}}if(n[_++]=s[y++],--g===1){S=!0;break}w--}while(C>=Wp||x>=Wp);if(S)break;w<0&&(w=0),w+=2}if(e=w,e<1&&(e=1),g===1){for(m=0;m<v;m++)n[_+m]=n[b+m];n[_+v]=s[y]}else{if(g===0)throw new Error;for(m=0;m<g;m++)n[_+m]=s[y+m]}}function c(f,g,p,v){var m=0;for(m=0;m<v;m++)s[m]=n[p+m];var y=f+g-1,b=v-1,_=p+v-1,w=0,C=0;if(n[_--]=n[y--],--g===0){for(w=_-(v-1),m=0;m<v;m++)n[w+m]=s[m];return}if(v===1){for(_-=g,y-=g,C=_+1,w=y+1,m=g-1;m>=0;m--)n[C+m]=n[w+m];n[_]=s[b];return}for(var x=e;;){var S=0,A=0,T=!1;do if(t(s[b],n[y])<0){if(n[_--]=n[y--],S++,A=0,--g===0){T=!0;break}}else if(n[_--]=s[b--],A++,S=0,--v===1){T=!0;break}while((S|A)<x);if(T)break;do{if(S=g-AT(s[b],n,f,g,g-1,t),S!==0){for(_-=S,y-=S,g-=S,C=_+1,w=y+1,m=S-1;m>=0;m--)n[C+m]=n[w+m];if(g===0){T=!0;break}}if(n[_--]=s[b--],--v===1){T=!0;break}if(A=v-ST(n[y],s,0,v,v-1,t),A!==0){for(_-=A,b-=A,v-=A,C=_+1,w=b+1,m=0;m<A;m++)n[C+m]=s[w+m];if(v<=1){T=!0;break}}if(n[_--]=n[y--],--g===0){T=!0;break}x--}while(S>=Wp||A>=Wp);if(T)break;x<0&&(x=0),x+=2}if(e=x,e<1&&(e=1),v===1){for(_-=g,y-=g,C=_+1,w=y+1,m=g-1;m>=0;m--)n[C+m]=n[w+m];n[_]=s[b]}else{if(v===0)throw new Error;for(w=_-(v-1),m=0;m<v;m++)n[w+m]=s[m]}}return{mergeRuns:l,forceMergeRuns:h,pushRun:a}}function V_(n,t,e,i){e||(e=0),i||(i=n.length);var r=i-e;if(!(r<2)){var o=0;if(r<w8){o=sI(n,e,i,t),aI(n,e,i,e+o,t);return}var s=Xtt(n,t),a=jtt(r);do{if(o=sI(n,e,i,t),o<a){var l=r;l>a&&(l=a),aI(n,e,e+l,e+o,t),o=l}s.pushRun(e,o),s.mergeRuns(),r-=o,e+=o}while(r!==0);s.forceMergeRuns()}}var go=1,Bv=2,mf=4,lI=!1;function TT(){lI||(lI=!0)}function hI(n,t){return n.zlevel===t.zlevel?n.z===t.z?n.z2-t.z2:n.z-t.z:n.zlevel-t.zlevel}var Ytt=function(){function n(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=hI}return n.prototype.traverse=function(t,e){for(var i=0;i<this._roots.length;i++)this._roots[i].traverse(t,e)},n.prototype.getDisplayList=function(t,e){e=e||!1;var i=this._displayList;return(t||!i.length)&&this.updateDisplayList(e),i},n.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,r=0,o=e.length;r<o;r++)this._updateAndAddDisplayable(e[r],null,t);i.length=this._displayListLen,V_(i,hI)},n.prototype._updateAndAddDisplayable=function(t,e,i){if(!(t.ignore&&!i)){t.beforeUpdate(),t.update(),t.afterUpdate();var r=t.getClipPath();if(t.ignoreClip)e=null;else if(r){e?e=e.slice():e=[];for(var o=r,s=t;o;)o.parent=s,o.updateTransform(),e.push(o),s=o,o=o.getClipPath()}if(t.childrenRef){for(var a=t.childrenRef(),l=0;l<a.length;l++){var h=a[l];t.__dirty&&(h.__dirty|=go),this._updateAndAddDisplayable(h,e,i)}t.__dirty=0}else{var u=t;e&&e.length?u.__clipPaths=e:u.__clipPaths&&u.__clipPaths.length>0&&(u.__clipPaths=[]),isNaN(u.z)&&(TT(),u.z=0),isNaN(u.z2)&&(TT(),u.z2=0),isNaN(u.zlevel)&&(TT(),u.zlevel=0),this._displayList[this._displayListLen++]=u}var d=t.getDecalElement&&t.getDecalElement();d&&this._updateAndAddDisplayable(d,e,i);var c=t.getTextGuideLine();c&&this._updateAndAddDisplayable(c,e,i);var f=t.getTextContent();f&&this._updateAndAddDisplayable(f,e,i)}},n.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},n.prototype.delRoot=function(t){if(t instanceof Array){for(var e=0,i=t.length;e<i;e++)this.delRoot(t[e]);return}var r=_e(this._roots,t);r>=0&&this._roots.splice(r,1)},n.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},n.prototype.getRoots=function(){return this._roots},n.prototype.dispose=function(){this._displayList=null,this._roots=null},n}(),BC;BC=ie.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(n){return setTimeout(n,16)};var n0={linear:function(n){return n},quadraticIn:function(n){return n*n},quadraticOut:function(n){return n*(2-n)},quadraticInOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)},quarticIn:function(n){return n*n*n*n},quarticOut:function(n){return 1- --n*n*n*n},quarticInOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)},quinticIn:function(n){return n*n*n*n*n},quinticOut:function(n){return--n*n*n*n*n+1},quinticInOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)},sinusoidalIn:function(n){return 1-Math.cos(n*Math.PI/2)},sinusoidalOut:function(n){return Math.sin(n*Math.PI/2)},sinusoidalInOut:function(n){return .5*(1-Math.cos(Math.PI*n))},exponentialIn:function(n){return n===0?0:Math.pow(1024,n-1)},exponentialOut:function(n){return n===1?1:1-Math.pow(2,-10*n)},exponentialInOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)},circularIn:function(n){return 1-Math.sqrt(1-n*n)},circularOut:function(n){return Math.sqrt(1- --n*n)},circularInOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)},elasticIn:function(n){var t,e=.1,i=.4;return n===0?0:n===1?1:(!e||e<1?(e=1,t=i/4):t=i*Math.asin(1/e)/(2*Math.PI),-(e*Math.pow(2,10*(n-=1))*Math.sin((n-t)*(2*Math.PI)/i)))},elasticOut:function(n){var t,e=.1,i=.4;return n===0?0:n===1?1:(!e||e<1?(e=1,t=i/4):t=i*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*n)*Math.sin((n-t)*(2*Math.PI)/i)+1)},elasticInOut:function(n){var t,e=.1,i=.4;return n===0?0:n===1?1:(!e||e<1?(e=1,t=i/4):t=i*Math.asin(1/e)/(2*Math.PI),(n*=2)<1?-.5*(e*Math.pow(2,10*(n-=1))*Math.sin((n-t)*(2*Math.PI)/i)):e*Math.pow(2,-10*(n-=1))*Math.sin((n-t)*(2*Math.PI)/i)*.5+1)},backIn:function(n){var t=1.70158;return n*n*((t+1)*n-t)},backOut:function(n){var t=1.70158;return--n*n*((t+1)*n+t)+1},backInOut:function(n){var t=2.5949095;return(n*=2)<1?.5*(n*n*((t+1)*n-t)):.5*((n-=2)*n*((t+1)*n+t)+2)},bounceIn:function(n){return 1-n0.bounceOut(1-n)},bounceOut:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},bounceInOut:function(n){return n<.5?n0.bounceIn(n*2)*.5:n0.bounceOut(n*2-1)*.5+.5}},Yy=Math.pow,Wh=Math.sqrt,PC=1e-8,x8=1e-4,uI=Wh(3),Ky=1/3,xa=dp(),Zo=dp(),zf=dp();function Bh(n){return n>-PC&&n<PC}function S8(n){return n>PC||n<-PC}function Bn(n,t,e,i,r){var o=1-r;return o*o*(o*n+3*r*t)+r*r*(r*i+3*o*e)}function dI(n,t,e,i,r){var o=1-r;return 3*(((t-n)*o+2*(e-t)*r)*o+(i-e)*r*r)}function kC(n,t,e,i,r,o){var s=i+3*(t-e)-n,a=3*(e-t*2+n),l=3*(t-n),h=n-r,u=a*a-3*s*l,d=a*l-9*s*h,c=l*l-3*a*h,f=0;if(Bh(u)&&Bh(d))if(Bh(a))o[0]=0;else{var g=-l/a;g>=0&&g<=1&&(o[f++]=g)}else{var p=d*d-4*u*c;if(Bh(p)){var v=d/u,g=-a/s+v,m=-v/2;g>=0&&g<=1&&(o[f++]=g),m>=0&&m<=1&&(o[f++]=m)}else if(p>0){var y=Wh(p),b=u*a+1.5*s*(-d+y),_=u*a+1.5*s*(-d-y);b<0?b=-Yy(-b,Ky):b=Yy(b,Ky),_<0?_=-Yy(-_,Ky):_=Yy(_,Ky);var g=(-a-(b+_))/(3*s);g>=0&&g<=1&&(o[f++]=g)}else{var w=(2*u*a-3*s*d)/(2*Wh(u*u*u)),C=Math.acos(w)/3,x=Wh(u),S=Math.cos(C),g=(-a-2*x*S)/(3*s),m=(-a+x*(S+uI*Math.sin(C)))/(3*s),A=(-a+x*(S-uI*Math.sin(C)))/(3*s);g>=0&&g<=1&&(o[f++]=g),m>=0&&m<=1&&(o[f++]=m),A>=0&&A<=1&&(o[f++]=A)}}return f}function A8(n,t,e,i,r){var o=6*e-12*t+6*n,s=9*t+3*i-3*n-9*e,a=3*t-3*n,l=0;if(Bh(s)){if(S8(o)){var h=-a/o;h>=0&&h<=1&&(r[l++]=h)}}else{var u=o*o-4*s*a;if(Bh(u))r[0]=-o/(2*s);else if(u>0){var d=Wh(u),h=(-o+d)/(2*s),c=(-o-d)/(2*s);h>=0&&h<=1&&(r[l++]=h),c>=0&&c<=1&&(r[l++]=c)}}return l}function Xh(n,t,e,i,r,o){var s=(t-n)*r+n,a=(e-t)*r+t,l=(i-e)*r+e,h=(a-s)*r+s,u=(l-a)*r+a,d=(u-h)*r+h;o[0]=n,o[1]=s,o[2]=h,o[3]=d,o[4]=d,o[5]=u,o[6]=l,o[7]=i}function T8(n,t,e,i,r,o,s,a,l,h,u){var d,c=.005,f=1/0,g,p,v,m;xa[0]=l,xa[1]=h;for(var y=0;y<1;y+=.05)Zo[0]=Bn(n,e,r,s,y),Zo[1]=Bn(t,i,o,a,y),v=Hf(xa,Zo),v<f&&(d=y,f=v);f=1/0;for(var b=0;b<32&&!(c<x8);b++)g=d-c,p=d+c,Zo[0]=Bn(n,e,r,s,g),Zo[1]=Bn(t,i,o,a,g),v=Hf(Zo,xa),g>=0&&v<f?(d=g,f=v):(zf[0]=Bn(n,e,r,s,p),zf[1]=Bn(t,i,o,a,p),m=Hf(zf,xa),p<=1&&m<f?(d=p,f=m):c*=.5);return u&&(u[0]=Bn(n,e,r,s,d),u[1]=Bn(t,i,o,a,d)),Wh(f)}function Ktt(n,t,e,i,r,o,s,a,l){for(var h=n,u=t,d=0,c=1/l,f=1;f<=l;f++){var g=f*c,p=Bn(n,e,r,s,g),v=Bn(t,i,o,a,g),m=p-h,y=v-u;d+=Math.sqrt(m*m+y*y),h=p,u=v}return d}function gr(n,t,e,i){var r=1-i;return r*(r*n+2*i*t)+i*i*e}function cI(n,t,e,i){return 2*((1-i)*(t-n)+i*(e-t))}function qtt(n,t,e,i,r){var o=n-2*t+e,s=2*(t-n),a=n-i,l=0;if(Bh(o)){if(S8(s)){var h=-a/s;h>=0&&h<=1&&(r[l++]=h)}}else{var u=s*s-4*o*a;if(Bh(u)){var h=-s/(2*o);h>=0&&h<=1&&(r[l++]=h)}else if(u>0){var d=Wh(u),h=(-s+d)/(2*o),c=(-s-d)/(2*o);h>=0&&h<=1&&(r[l++]=h),c>=0&&c<=1&&(r[l++]=c)}}return l}function M8(n,t,e){var i=n+e-2*t;return i===0?.5:(n-t)/i}function EC(n,t,e,i,r){var o=(t-n)*i+n,s=(e-t)*i+t,a=(s-o)*i+o;r[0]=n,r[1]=o,r[2]=a,r[3]=a,r[4]=s,r[5]=e}function R8(n,t,e,i,r,o,s,a,l){var h,u=.005,d=1/0;xa[0]=s,xa[1]=a;for(var c=0;c<1;c+=.05){Zo[0]=gr(n,e,r,c),Zo[1]=gr(t,i,o,c);var f=Hf(xa,Zo);f<d&&(h=c,d=f)}d=1/0;for(var g=0;g<32&&!(u<x8);g++){var p=h-u,v=h+u;Zo[0]=gr(n,e,r,p),Zo[1]=gr(t,i,o,p);var f=Hf(Zo,xa);if(p>=0&&f<d)h=p,d=f;else{zf[0]=gr(n,e,r,v),zf[1]=gr(t,i,o,v);var m=Hf(zf,xa);v<=1&&m<d?(h=v,d=m):u*=.5}}return l&&(l[0]=gr(n,e,r,h),l[1]=gr(t,i,o,h)),Wh(d)}function Ztt(n,t,e,i,r,o,s){for(var a=n,l=t,h=0,u=1/s,d=1;d<=s;d++){var c=d*u,f=gr(n,e,r,c),g=gr(t,i,o,c),p=f-a,v=g-l;h+=Math.sqrt(p*p+v*v),a=f,l=g}return h}var Jtt=/cubic-bezier\(([0-9,\.e ]+)\)/;function B8(n){var t=n&&Jtt.exec(n);if(t){var e=t[1].split(","),i=+Ba(e[0]),r=+Ba(e[1]),o=+Ba(e[2]),s=+Ba(e[3]);if(isNaN(i+r+o+s))return;var a=[];return function(l){return l<=0?0:l>=1?1:kC(0,i,o,1,l,a)&&Bn(0,r,s,1,a[0])}}}var Qtt=function(){function n(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||ir,this.ondestroy=t.ondestroy||ir,this.onrestart=t.onrestart||ir,t.easing&&this.setEasing(t.easing)}return n.prototype.step=function(t,e){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=e;return}var i=this._life,r=t-this._startTime-this._pausedTime,o=r/i;o<0&&(o=0),o=Math.min(o,1);var s=this.easingFunc,a=s?s(o):o;if(this.onframe(a),o===1)if(this.loop){var l=r%i;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){this._paused=!1},n.prototype.setEasing=function(t){this.easing=t,this.easingFunc=jt(t)?t:n0[t]||B8(t)},n}(),P8=function(){function n(t){this.value=t}return n}(),tet=function(){function n(){this._len=0}return n.prototype.insert=function(t){var e=new P8(t);return this.insertEntry(e),e},n.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},n.prototype.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--},n.prototype.len=function(){return this._len},n.prototype.clear=function(){this.head=this.tail=null,this._len=0},n}(),iy=function(){function n(t){this._list=new tet,this._maxSize=10,this._map={},this._maxSize=t}return n.prototype.put=function(t,e){var i=this._list,r=this._map,o=null;if(r[t]==null){var s=i.len(),a=this._lastRemovedEntry;if(s>=this._maxSize&&s>0){var l=i.head;i.remove(l),delete r[l.key],o=l.value,this._lastRemovedEntry=l}a?a.value=e:a=new P8(e),a.key=t,i.insertEntry(a),r[t]=a}return o},n.prototype.get=function(t){var e=this._map[t],i=this._list;if(e!=null)return e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value},n.prototype.clear=function(){this._list.clear(),this._map={}},n.prototype.len=function(){return this._list.len()},n}(),fI={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Vs(n){return n=Math.round(n),n<0?0:n>255?255:n}function eet(n){return n=Math.round(n),n<0?0:n>360?360:n}function G0(n){return n<0?0:n>1?1:n}function MT(n){var t=n;return t.length&&t.charAt(t.length-1)==="%"?Vs(parseFloat(t)/100*255):Vs(parseInt(t,10))}function Id(n){var t=n;return t.length&&t.charAt(t.length-1)==="%"?G0(parseFloat(t)/100):G0(parseFloat(t))}function RT(n,t,e){return e<0?e+=1:e>1&&(e-=1),e*6<1?n+(t-n)*e*6:e*2<1?t:e*3<2?n+(t-n)*(2/3-e)*6:n}function Ph(n,t,e){return n+(t-n)*e}function Io(n,t,e,i,r){return n[0]=t,n[1]=e,n[2]=i,n[3]=r,n}function F2(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}var k8=new iy(20),qy=null;function Dc(n,t){qy&&F2(qy,t),qy=k8.put(n,qy||t.slice())}function us(n,t){if(n){t=t||[];var e=k8.get(n);if(e)return F2(t,e);n=n+"";var i=n.replace(/ /g,"").toLowerCase();if(i in fI)return F2(t,fI[i]),Dc(n,t),t;var r=i.length;if(i.charAt(0)==="#"){if(r===4||r===5){var o=parseInt(i.slice(1,4),16);if(!(o>=0&&o<=4095)){Io(t,0,0,0,1);return}return Io(t,(o&3840)>>4|(o&3840)>>8,o&240|(o&240)>>4,o&15|(o&15)<<4,r===5?parseInt(i.slice(4),16)/15:1),Dc(n,t),t}else if(r===7||r===9){var o=parseInt(i.slice(1,7),16);if(!(o>=0&&o<=16777215)){Io(t,0,0,0,1);return}return Io(t,(o&16711680)>>16,(o&65280)>>8,o&255,r===9?parseInt(i.slice(7),16)/255:1),Dc(n,t),t}return}var s=i.indexOf("("),a=i.indexOf(")");if(s!==-1&&a+1===r){var l=i.substr(0,s),h=i.substr(s+1,a-(s+1)).split(","),u=1;switch(l){case"rgba":if(h.length!==4)return h.length===3?Io(t,+h[0],+h[1],+h[2],1):Io(t,0,0,0,1);u=Id(h.pop());case"rgb":if(h.length>=3)return Io(t,MT(h[0]),MT(h[1]),MT(h[2]),h.length===3?u:Id(h[3])),Dc(n,t),t;Io(t,0,0,0,1);return;case"hsla":if(h.length!==4){Io(t,0,0,0,1);return}return h[3]=Id(h[3]),z2(h,t),Dc(n,t),t;case"hsl":if(h.length!==3){Io(t,0,0,0,1);return}return z2(h,t),Dc(n,t),t;default:return}}Io(t,0,0,0,1)}}function z2(n,t){var e=(parseFloat(n[0])%360+360)%360/360,i=Id(n[1]),r=Id(n[2]),o=r<=.5?r*(i+1):r+i-r*i,s=r*2-o;return t=t||[],Io(t,Vs(RT(s,o,e+1/3)*255),Vs(RT(s,o,e)*255),Vs(RT(s,o,e-1/3)*255),1),n.length===4&&(t[3]=n[3]),t}function iet(n){if(n){var t=n[0]/255,e=n[1]/255,i=n[2]/255,r=Math.min(t,e,i),o=Math.max(t,e,i),s=o-r,a=(o+r)/2,l,h;if(s===0)l=0,h=0;else{a<.5?h=s/(o+r):h=s/(2-o-r);var u=((o-t)/6+s/2)/s,d=((o-e)/6+s/2)/s,c=((o-i)/6+s/2)/s;t===o?l=c-d:e===o?l=1/3+u-c:i===o&&(l=2/3+d-u),l<0&&(l+=1),l>1&&(l-=1)}var f=[l*360,h,a];return n[3]!=null&&f.push(n[3]),f}}function N2(n,t){var e=us(n);if(e){for(var i=0;i<3;i++)t<0?e[i]=e[i]*(1-t)|0:e[i]=(255-e[i])*t+e[i]|0,e[i]>255?e[i]=255:e[i]<0&&(e[i]=0);return Ll(e,e.length===4?"rgba":"rgb")}}function BT(n,t,e){if(!(!(t&&t.length)||!(n>=0&&n<=1))){e=e||[];var i=n*(t.length-1),r=Math.floor(i),o=Math.ceil(i),s=t[r],a=t[o],l=i-r;return e[0]=Vs(Ph(s[0],a[0],l)),e[1]=Vs(Ph(s[1],a[1],l)),e[2]=Vs(Ph(s[2],a[2],l)),e[3]=G0(Ph(s[3],a[3],l)),e}}function net(n,t,e){if(!(!(t&&t.length)||!(n>=0&&n<=1))){var i=n*(t.length-1),r=Math.floor(i),o=Math.ceil(i),s=us(t[r]),a=us(t[o]),l=i-r,h=Ll([Vs(Ph(s[0],a[0],l)),Vs(Ph(s[1],a[1],l)),Vs(Ph(s[2],a[2],l)),G0(Ph(s[3],a[3],l))],"rgba");return e?{color:h,leftIndex:r,rightIndex:o,value:i}:h}}function r0(n,t,e,i){var r=us(n);if(n)return r=iet(r),t!=null&&(r[0]=eet(t)),e!=null&&(r[1]=Id(e)),i!=null&&(r[2]=Id(i)),Ll(z2(r),"rgba")}function E8(n,t){var e=us(n);if(e&&t!=null)return e[3]=G0(t),Ll(e,"rgba")}function Ll(n,t){if(!(!n||!n.length)){var e=n[0]+","+n[1]+","+n[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(e+=","+n[3]),t+"("+e+")"}}function LC(n,t){var e=us(n);return e?(.299*e[0]+.587*e[1]+.114*e[2])*e[3]/255+(1-e[3])*t:0}var gI=new iy(100);function pI(n){if(Pt(n)){var t=gI.get(n);return t||(t=N2(n,-.1),gI.put(n,t)),t}else if(Zx(n)){var e=ft({},n);return e.colorStops=St(n.colorStops,function(i){return{offset:i.offset,color:N2(i.color,-.1)}}),e}return n}function ret(n){return n.type==="linear"}function oet(n){return n.type==="radial"}(function(){return ie.hasGlobalWindow&&jt(window.btoa)?function(n){return window.btoa(unescape(encodeURIComponent(n)))}:typeof Buffer<"u"?function(n){return Buffer.from(n).toString("base64")}:function(n){return null}})();var W2=Array.prototype.slice;function vl(n,t,e){return(t-n)*e+n}function PT(n,t,e,i){for(var r=t.length,o=0;o<r;o++)n[o]=vl(t[o],e[o],i);return n}function set(n,t,e,i){for(var r=t.length,o=r&&t[0].length,s=0;s<r;s++){n[s]||(n[s]=[]);for(var a=0;a<o;a++)n[s][a]=vl(t[s][a],e[s][a],i)}return n}function Zy(n,t,e,i){for(var r=t.length,o=0;o<r;o++)n[o]=t[o]+e[o]*i;return n}function vI(n,t,e,i){for(var r=t.length,o=r&&t[0].length,s=0;s<r;s++){n[s]||(n[s]=[]);for(var a=0;a<o;a++)n[s][a]=t[s][a]+e[s][a]*i}return n}function aet(n,t){for(var e=n.length,i=t.length,r=e>i?t:n,o=Math.min(e,i),s=r[o-1]||{color:[0,0,0,0],offset:0},a=o;a<Math.max(e,i);a++)r.push({offset:s.offset,color:s.color.slice()})}function het(n,t,e){var i=n,r=t;if(!(!i.push||!r.push)){var o=i.length,s=r.length;if(o!==s){var a=o>s;if(a)i.length=s;else for(var l=o;l<s;l++)i.push(e===1?r[l]:W2.call(r[l]))}for(var h=i[0]&&i[0].length,l=0;l<i.length;l++)if(e===1)isNaN(i[l])&&(i[l]=r[l]);else for(var u=0;u<h;u++)isNaN(i[l][u])&&(i[l][u]=r[l][u])}}function G_(n){if(Yr(n)){var t=n.length;if(Yr(n[0])){for(var e=[],i=0;i<t;i++)e.push(W2.call(n[i]));return e}return W2.call(n)}return n}function $_(n){return n[0]=Math.floor(n[0])||0,n[1]=Math.floor(n[1])||0,n[2]=Math.floor(n[2])||0,n[3]=n[3]==null?1:n[3],"rgba("+n.join(",")+")"}function uet(n){return Yr(n&&n[0])?2:1}var Jy=0,j_=1,L8=2,Pv=3,V2=4,G2=5,mI=6;function yI(n){return n===V2||n===G2}function Qy(n){return n===j_||n===L8}var Vp=[0,0,0,0],det=function(){function n(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return n.prototype.isFinished=function(){return this._finished},n.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},n.prototype.needsAnimate=function(){return this.keyframes.length>=1},n.prototype.getAdditiveTrack=function(){return this._additiveTrack},n.prototype.addKeyframe=function(t,e,i){this._needsSort=!0;var r=this.keyframes,o=r.length,s=!1,a=mI,l=e;if(Yr(e)){var h=uet(e);a=h,(h===1&&!di(e[0])||h===2&&!di(e[0][0]))&&(s=!0)}else if(di(e)&&!RC(e))a=Jy;else if(Pt(e))if(!isNaN(+e))a=Jy;else{var u=us(e);u&&(l=u,a=Pv)}else if(Zx(e)){var d=ft({},l);d.colorStops=St(e.colorStops,function(f){return{offset:f.offset,color:us(f.color)}}),ret(e)?a=V2:oet(e)&&(a=G2),l=d}o===0?this.valType=a:(a!==this.valType||a===mI)&&(s=!0),this.discrete=this.discrete||s;var c={time:t,value:l,rawValue:e,percent:0};return i&&(c.easing=i,c.easingFunc=jt(i)?i:n0[i]||B8(i)),r.push(c),c},n.prototype.prepare=function(t,e){var i=this.keyframes;this._needsSort&&i.sort(function(p,v){return p.time-v.time});for(var r=this.valType,o=i.length,s=i[o-1],a=this.discrete,l=Qy(r),h=yI(r),u=0;u<o;u++){var d=i[u],c=d.value,f=s.value;d.percent=d.time/t,a||(l&&u!==o-1?het(c,f,r):h&&aet(c.colorStops,f.colorStops))}if(!a&&r!==G2&&e&&this.needsAnimate()&&e.needsAnimate()&&r===e.valType&&!e._finished){this._additiveTrack=e;for(var g=i[0].value,u=0;u<o;u++)r===Jy?i[u].additiveValue=i[u].value-g:r===Pv?i[u].additiveValue=Zy([],i[u].value,g,-1):Qy(r)&&(i[u].additiveValue=r===j_?Zy([],i[u].value,g,-1):vI([],i[u].value,g,-1))}},n.prototype.step=function(t,e){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var i=this._additiveTrack!=null,r=i?"additiveValue":"value",o=this.valType,s=this.keyframes,a=s.length,l=this.propName,h=o===Pv,u,d=this._lastFr,c=Math.min,f,g;if(a===1)f=g=s[0];else{if(e<0)u=0;else if(e<this._lastFrP){var p=c(d+1,a-1);for(u=p;u>=0&&!(s[u].percent<=e);u--);u=c(u,a-2)}else{for(u=d;u<a&&!(s[u].percent>e);u++);u=c(u-1,a-2)}g=s[u+1],f=s[u]}if(f&&g){this._lastFr=u,this._lastFrP=e;var v=g.percent-f.percent,m=v===0?1:c((e-f.percent)/v,1);g.easingFunc&&(m=g.easingFunc(m));var y=i?this._additiveValue:h?Vp:t[l];if((Qy(o)||h)&&!y&&(y=this._additiveValue=[]),this.discrete)t[l]=m<1?f.rawValue:g.rawValue;else if(Qy(o))o===j_?PT(y,f[r],g[r],m):set(y,f[r],g[r],m);else if(yI(o)){var b=f[r],_=g[r],w=o===V2;t[l]={type:w?"linear":"radial",x:vl(b.x,_.x,m),y:vl(b.y,_.y,m),colorStops:St(b.colorStops,function(x,S){var A=_.colorStops[S];return{offset:vl(x.offset,A.offset,m),color:$_(PT([],x.color,A.color,m))}}),global:_.global},w?(t[l].x2=vl(b.x2,_.x2,m),t[l].y2=vl(b.y2,_.y2,m)):t[l].r=vl(b.r,_.r,m)}else if(h)PT(y,f[r],g[r],m),i||(t[l]=$_(y));else{var C=vl(f[r],g[r],m);i?this._additiveValue=C:t[l]=C}i&&this._addToTarget(t)}}},n.prototype._addToTarget=function(t){var e=this.valType,i=this.propName,r=this._additiveValue;e===Jy?t[i]=t[i]+r:e===Pv?(us(t[i],Vp),Zy(Vp,Vp,r,1),t[i]=$_(Vp)):e===j_?Zy(t[i],t[i],r,1):e===L8&&vI(t[i],t[i],r,1)},n}(),BE=function(){function n(t,e,i,r){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=e,e&&r){SE("Can' use additive animation on looped animation.");return}this._additiveAnimators=r,this._allowDiscrete=i}return n.prototype.getMaxTime=function(){return this._maxTime},n.prototype.getDelay=function(){return this._delay},n.prototype.getLoop=function(){return this._loop},n.prototype.getTarget=function(){return this._target},n.prototype.changeTarget=function(t){this._target=t},n.prototype.when=function(t,e,i){return this.whenWithKeys(t,e,yi(e),i)},n.prototype.whenWithKeys=function(t,e,i,r){for(var o=this._tracks,s=0;s<i.length;s++){var a=i[s],l=o[a];if(!l){l=o[a]=new det(a);var h=void 0,u=this._getAdditiveTrack(a);if(u){var d=u.keyframes,c=d[d.length-1];h=c&&c.value,u.valType===Pv&&h&&(h=$_(h))}else h=this._target[a];if(h==null)continue;t>0&&l.addKeyframe(0,G_(h),r),this._trackKeys.push(a)}l.addKeyframe(t,G_(e[a]),r)}return this._maxTime=Math.max(this._maxTime,t),this},n.prototype.pause=function(){this._clip.pause(),this._paused=!0},n.prototype.resume=function(){this._clip.resume(),this._paused=!1},n.prototype.isPaused=function(){return!!this._paused},n.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},n.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var e=t.length,i=0;i<e;i++)t[i].call(this)},n.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,e=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,e)for(var i=0;i<e.length;i++)e[i].call(this)},n.prototype._setTracksFinished=function(){for(var t=this._tracks,e=this._trackKeys,i=0;i<e.length;i++)t[e[i]].setFinished()},n.prototype._getAdditiveTrack=function(t){var e,i=this._additiveAnimators;if(i)for(var r=0;r<i.length;r++){var o=i[r].getTrack(t);o&&(e=o)}return e},n.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var e=this,i=[],r=this._maxTime||0,o=0;o<this._trackKeys.length;o++){var s=this._trackKeys[o],a=this._tracks[s],l=this._getAdditiveTrack(s),h=a.keyframes,u=h.length;if(a.prepare(r,l),a.needsAnimate())if(!this._allowDiscrete&&a.discrete){var d=h[u-1];d&&(e._target[a.propName]=d.rawValue),a.setFinished()}else i.push(a)}if(i.length||this._force){var c=new Qtt({life:r,loop:this._loop,delay:this._delay||0,onframe:function(f){e._started=2;var g=e._additiveAnimators;if(g){for(var p=!1,v=0;v<g.length;v++)if(g[v]._clip){p=!0;break}p||(e._additiveAnimators=null)}for(var v=0;v<i.length;v++)i[v].step(e._target,f);var m=e._onframeCbs;if(m)for(var v=0;v<m.length;v++)m[v](e._target,f)},ondestroy:function(){e._doneCallback()}});this._clip=c,this.animation&&this.animation.addClip(c),t&&c.setEasing(t)}else this._doneCallback();return this}},n.prototype.stop=function(t){if(this._clip){var e=this._clip;t&&e.onframe(1),this._abortedCallback()}},n.prototype.delay=function(t){return this._delay=t,this},n.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},n.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},n.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},n.prototype.getClip=function(){return this._clip},n.prototype.getTrack=function(t){return this._tracks[t]},n.prototype.getTracks=function(){var t=this;return St(this._trackKeys,function(e){return t._tracks[e]})},n.prototype.stopTracks=function(t,e){if(!t.length||!this._clip)return!0;for(var i=this._tracks,r=this._trackKeys,o=0;o<t.length;o++){var s=i[t[o]];s&&!s.isFinished()&&(e?s.step(this._target,1):this._started===1&&s.step(this._target,0),s.setFinished())}for(var a=!0,o=0;o<r.length;o++)if(!i[r[o]].isFinished()){a=!1;break}return a&&this._abortedCallback(),a},n.prototype.saveTo=function(t,e,i){if(t){e=e||this._trackKeys;for(var r=0;r<e.length;r++){var o=e[r],s=this._tracks[o];if(!(!s||s.isFinished())){var a=s.keyframes,l=a[i?0:a.length-1];l&&(t[o]=G_(l.rawValue))}}}},n.prototype.__changeFinalValue=function(t,e){e=e||yi(t);for(var i=0;i<e.length;i++){var r=e[i],o=this._tracks[r];if(o){var s=o.keyframes;if(s.length>1){var a=s.pop();o.addKeyframe(a.time,t[r]),o.prepare(this._maxTime,o.getAdditiveTrack())}}}},n}();function Af(){return new Date().getTime()}var cet=function(n){ct(t,n);function t(e){var i=n.call(this)||this;return i._running=!1,i._time=0,i._pausedTime=0,i._pauseStart=0,i._paused=!1,e=e||{},i.stage=e.stage||{},i}return t.prototype.addClip=function(e){e.animation&&this.removeClip(e),this._head?(this._tail.next=e,e.prev=this._tail,e.next=null,this._tail=e):this._head=this._tail=e,e.animation=this},t.prototype.addAnimator=function(e){e.animation=this;var i=e.getClip();i&&this.addClip(i)},t.prototype.removeClip=function(e){if(e.animation){var i=e.prev,r=e.next;i?i.next=r:this._head=r,r?r.prev=i:this._tail=i,e.next=e.prev=e.animation=null}},t.prototype.removeAnimator=function(e){var i=e.getClip();i&&this.removeClip(i),e.animation=null},t.prototype.update=function(e){for(var i=Af()-this._pausedTime,r=i-this._time,o=this._head;o;){var s=o.next,a=o.step(i,r);a&&(o.ondestroy(),this.removeClip(o)),o=s}this._time=i,e||(this.trigger("frame",r),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var e=this;this._running=!0;function i(){e._running&&(BC(i),!e._paused&&e.update())}BC(i)},t.prototype.start=function(){this._running||(this._time=Af(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=Af(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=Af()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var e=this._head;e;){var i=e.next;e.prev=e.next=e.animation=null,e=i}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(e,i){i=i||{},this.start();var r=new BE(e,i.loop);return this.addAnimator(r),r},t}(ys),fet=300,kT=ie.domSupported,ET=function(){var n=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],e={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},i=St(n,function(r){var o=r.replace("mouse","pointer");return e.hasOwnProperty(o)?o:r});return{mouse:n,touch:t,pointer:i}}(),bI={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},_I=!1;function $2(n){var t=n.pointerType;return t==="pen"||t==="touch"}function get(n){n.touching=!0,n.touchTimer!=null&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout(function(){n.touching=!1,n.touchTimer=null},700)}function LT(n){n&&(n.zrByTouch=!0)}function pet(n,t){return Fo(n.dom,new vet(n,t),!0)}function O8(n,t){for(var e=t,i=!1;e&&e.nodeType!==9&&!(i=e.domBelongToZr||e!==t&&e===n.painterRoot);)e=e.parentNode;return i}var vet=function(){function n(t,e){this.stopPropagation=ir,this.stopImmediatePropagation=ir,this.preventDefault=ir,this.type=e.type,this.target=this.currentTarget=t.dom,this.pointerType=e.pointerType,this.clientX=e.clientX,this.clientY=e.clientY}return n}(),Ms={mousedown:function(n){n=Fo(this.dom,n),this.__mayPointerCapture=[n.zrX,n.zrY],this.trigger("mousedown",n)},mousemove:function(n){n=Fo(this.dom,n);var t=this.__mayPointerCapture;t&&(n.zrX!==t[0]||n.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",n)},mouseup:function(n){n=Fo(this.dom,n),this.__togglePointerCapture(!1),this.trigger("mouseup",n)},mouseout:function(n){n=Fo(this.dom,n);var t=n.toElement||n.relatedTarget;O8(this,t)||(this.__pointerCapturing&&(n.zrEventControl="no_globalout"),this.trigger("mouseout",n))},wheel:function(n){_I=!0,n=Fo(this.dom,n),this.trigger("mousewheel",n)},mousewheel:function(n){_I||(n=Fo(this.dom,n),this.trigger("mousewheel",n))},touchstart:function(n){n=Fo(this.dom,n),LT(n),this.__lastTouchMoment=new Date,this.handler.processGesture(n,"start"),Ms.mousemove.call(this,n),Ms.mousedown.call(this,n)},touchmove:function(n){n=Fo(this.dom,n),LT(n),this.handler.processGesture(n,"change"),Ms.mousemove.call(this,n)},touchend:function(n){n=Fo(this.dom,n),LT(n),this.handler.processGesture(n,"end"),Ms.mouseup.call(this,n),+new Date-+this.__lastTouchMoment<fet&&Ms.click.call(this,n)},pointerdown:function(n){Ms.mousedown.call(this,n)},pointermove:function(n){$2(n)||Ms.mousemove.call(this,n)},pointerup:function(n){Ms.mouseup.call(this,n)},pointerout:function(n){$2(n)||Ms.mouseout.call(this,n)}};N(["click","dblclick","contextmenu"],function(n){Ms[n]=function(t){t=Fo(this.dom,t),this.trigger(n,t)}});var j2={pointermove:function(n){$2(n)||j2.mousemove.call(this,n)},pointerup:function(n){j2.mouseup.call(this,n)},mousemove:function(n){this.trigger("mousemove",n)},mouseup:function(n){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",n),t&&(n.zrEventControl="only_globalout",this.trigger("mouseout",n))}};function met(n,t){var e=t.domHandlers;ie.pointerEventsSupported?N(ET.pointer,function(i){U_(t,i,function(r){e[i].call(n,r)})}):(ie.touchEventsSupported&&N(ET.touch,function(i){U_(t,i,function(r){e[i].call(n,r),get(t)})}),N(ET.mouse,function(i){U_(t,i,function(r){r=ME(r),t.touching||e[i].call(n,r)})}))}function yet(n,t){ie.pointerEventsSupported?N(bI.pointer,e):ie.touchEventsSupported||N(bI.mouse,e);function e(i){function r(o){o=ME(o),O8(n,o.target)||(o=pet(n,o),t.domHandlers[i].call(n,o))}U_(t,i,r,{capture:!0})}}function U_(n,t,e,i){n.mounted[t]=e,n.listenerOpts[t]=i,H2(n.domTarget,t,e,i)}function OT(n){var t=n.mounted;for(var e in t)t.hasOwnProperty(e)&&Itt(n.domTarget,e,t[e],n.listenerOpts[e]);n.mounted={}}var CI=function(){function n(t,e){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=e}return n}(),bet=function(n){ct(t,n);function t(e,i){var r=n.call(this)||this;return r.__pointerCapturing=!1,r.dom=e,r.painterRoot=i,r._localHandlerScope=new CI(e,Ms),kT&&(r._globalHandlerScope=new CI(document,j2)),met(r,r._localHandlerScope),r}return t.prototype.dispose=function(){OT(this._localHandlerScope),kT&&OT(this._globalHandlerScope)},t.prototype.setCursor=function(e){this.dom.style&&(this.dom.style.cursor=e||"default")},t.prototype.__togglePointerCapture=function(e){if(this.__mayPointerCapture=null,kT&&+this.__pointerCapturing^+e){this.__pointerCapturing=e;var i=this._globalHandlerScope;e?yet(this,i):OT(i)}},t}(ys),D8=1;ie.hasGlobalWindow&&(D8=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var OC=D8,U2=.4,X2="#333",Y2="#ccc",_et="#eee",wI=RE,xI=5e-5;function Su(n){return n>xI||n<-xI}var Au=[],Ic=[],DT=Nh(),IT=Math.abs,ny=function(){function n(){}return n.prototype.getLocalTransform=function(t){return n.getLocalTransform(this,t)},n.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},n.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},n.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},n.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},n.prototype.needLocalTransform=function(){return Su(this.rotation)||Su(this.x)||Su(this.y)||Su(this.scaleX-1)||Su(this.scaleY-1)||Su(this.skewX)||Su(this.skewY)},n.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,e=this.needLocalTransform(),i=this.transform;if(!(e||t)){i&&(wI(i),this.invTransform=null);return}i=i||Nh(),e?this.getLocalTransform(i):wI(i),t&&(e?Ff(i,t,i):ztt(i,t)),this.transform=i,this._resolveGlobalScaleRatio(i)},n.prototype._resolveGlobalScaleRatio=function(t){var e=this.globalScaleRatio;if(e!=null&&e!==1){this.getGlobalScale(Au);var i=Au[0]<0?-1:1,r=Au[1]<0?-1:1,o=((Au[0]-i)*e+i)/Au[0]||0,s=((Au[1]-r)*e+r)/Au[1]||0;t[0]*=o,t[1]*=o,t[2]*=s,t[3]*=s}this.invTransform=this.invTransform||Nh(),tS(this.invTransform,t)},n.prototype.getComputedTransform=function(){for(var t=this,e=[];t;)e.push(t),t=t.parent;for(;t=e.pop();)t.updateTransform();return this.transform},n.prototype.setLocalTransform=function(t){if(t){var e=t[0]*t[0]+t[1]*t[1],i=t[2]*t[2]+t[3]*t[3],r=Math.atan2(t[1],t[0]),o=Math.PI/2+r-Math.atan2(t[3],t[2]);i=Math.sqrt(i)*Math.cos(o),e=Math.sqrt(e),this.skewX=o,this.skewY=0,this.rotation=-r,this.x=+t[4],this.y=+t[5],this.scaleX=e,this.scaleY=i,this.originX=0,this.originY=0}},n.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(t.invTransform=t.invTransform||Nh(),Ff(Ic,t.invTransform,e),e=Ic);var i=this.originX,r=this.originY;(i||r)&&(DT[4]=i,DT[5]=r,Ff(Ic,e,DT),Ic[4]-=i,Ic[5]-=r,e=Ic),this.setLocalTransform(e)}},n.prototype.getGlobalScale=function(t){var e=this.transform;return t=t||[],e?(t[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),t[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),e[0]<0&&(t[0]=-t[0]),e[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},n.prototype.transformCoordToLocal=function(t,e){var i=[t,e],r=this.invTransform;return r&&hs(i,i,r),i},n.prototype.transformCoordToGlobal=function(t,e){var i=[t,e],r=this.transform;return r&&hs(i,i,r),i},n.prototype.getLineScale=function(){var t=this.transform;return t&&IT(t[0]-1)>1e-10&&IT(t[3]-1)>1e-10?Math.sqrt(IT(t[0]*t[3]-t[2]*t[1])):1},n.prototype.copyTransform=function(t){Cet(this,t)},n.getLocalTransform=function(t,e){e=e||[];var i=t.originX||0,r=t.originY||0,o=t.scaleX,s=t.scaleY,a=t.anchorX,l=t.anchorY,h=t.rotation||0,u=t.x,d=t.y,c=t.skewX?Math.tan(t.skewX):0,f=t.skewY?Math.tan(-t.skewY):0;if(i||r||a||l){var g=i+a,p=r+l;e[4]=-g*o-c*p*s,e[5]=-p*s-f*g*o}else e[4]=e[5]=0;return e[0]=o,e[3]=s,e[1]=f*o,e[2]=c*s,h&&Qx(e,e,h),e[4]+=i+u,e[5]+=r+d,e},n.initDefaultProps=function(){var t=n.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),n}(),$0=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function Cet(n,t){for(var e=0;e<$0.length;e++){var i=$0[e];n[i]=t[i]}}var SI={};function bo(n,t){t=t||Qd;var e=SI[t];e||(e=SI[t]=new iy(500));var i=e.get(n);return i==null&&(i=up.measureText(n,t).width,e.put(n,i)),i}function AI(n,t,e,i){var r=bo(n,t),o=PE(t),s=kv(0,r,e),a=yf(0,o,i),l=new Te(s,a,r,o);return l}function ry(n,t,e,i){var r=((n||"")+"").split(`
`),o=r.length;if(o===1)return AI(r[0],t,e,i);for(var s=new Te(0,0,0,0),a=0;a<r.length;a++){var l=AI(r[a],t,e,i);a===0?s.copy(l):s.union(l)}return s}function kv(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function yf(n,t,e){return e==="middle"?n-=t/2:e==="bottom"&&(n-=t),n}function PE(n){return bo("",n)}function Yh(n,t){return typeof n=="string"?n.lastIndexOf("%")>=0?parseFloat(n)/100*t:parseFloat(n):n}function DC(n,t,e){var i=t.position||"inside",r=t.distance!=null?t.distance:5,o=e.height,s=e.width,a=o/2,l=e.x,h=e.y,u="left",d="top";if(i instanceof Array)l+=Yh(i[0],e.width),h+=Yh(i[1],e.height),u=null,d=null;else switch(i){case"left":l-=r,h+=a,u="right",d="middle";break;case"right":l+=r+s,h+=a,d="middle";break;case"top":l+=s/2,h-=r,u="center",d="bottom";break;case"bottom":l+=s/2,h+=o+r,u="center";break;case"inside":l+=s/2,h+=a,u="center",d="middle";break;case"insideLeft":l+=r,h+=a,d="middle";break;case"insideRight":l+=s-r,h+=a,u="right",d="middle";break;case"insideTop":l+=s/2,h+=r,u="center";break;case"insideBottom":l+=s/2,h+=o-r,u="center",d="bottom";break;case"insideTopLeft":l+=r,h+=r;break;case"insideTopRight":l+=s-r,h+=r,u="right";break;case"insideBottomLeft":l+=r,h+=o-r,d="bottom";break;case"insideBottomRight":l+=s-r,h+=o-r,u="right",d="bottom";break}return n=n||{},n.x=l,n.y=h,n.align=u,n.verticalAlign=d,n}var HT="__zr_normal__",FT=$0.concat(["ignore"]),wet=Uh($0,function(n,t){return n[t]=!0,n},{ignore:!1}),Hc={},xet=new Te(0,0,0,0),eS=function(){function n(t){this.id=c8(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return n.prototype._init=function(t){this.attr(t)},n.prototype.drift=function(t,e,i){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0;break}var r=this.transform;r||(r=this.transform=[1,0,0,1,0,0]),r[4]+=t,r[5]+=e,this.decomposeTransform(),this.markRedraw()},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},n.prototype.updateInnerText=function(t){var e=this._textContent;if(e&&(!e.ignore||t)){this.textConfig||(this.textConfig={});var i=this.textConfig,r=i.local,o=e.innerTransformable,s=void 0,a=void 0,l=!1;o.parent=r?this:null;var h=!1;if(o.copyTransform(e),i.position!=null){var u=xet;i.layoutRect?u.copy(i.layoutRect):u.copy(this.getBoundingRect()),r||u.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Hc,i,u):DC(Hc,i,u),o.x=Hc.x,o.y=Hc.y,s=Hc.align,a=Hc.verticalAlign;var d=i.origin;if(d&&i.rotation!=null){var c=void 0,f=void 0;d==="center"?(c=u.width*.5,f=u.height*.5):(c=Yh(d[0],u.width),f=Yh(d[1],u.height)),h=!0,o.originX=-o.x+c+(r?0:u.x),o.originY=-o.y+f+(r?0:u.y)}}i.rotation!=null&&(o.rotation=i.rotation);var g=i.offset;g&&(o.x+=g[0],o.y+=g[1],h||(o.originX=-g[0],o.originY=-g[1]));var p=i.inside==null?typeof i.position=="string"&&i.position.indexOf("inside")>=0:i.inside,v=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),m=void 0,y=void 0,b=void 0;p&&this.canBeInsideText()?(m=i.insideFill,y=i.insideStroke,(m==null||m==="auto")&&(m=this.getInsideTextFill()),(y==null||y==="auto")&&(y=this.getInsideTextStroke(m),b=!0)):(m=i.outsideFill,y=i.outsideStroke,(m==null||m==="auto")&&(m=this.getOutsideFill()),(y==null||y==="auto")&&(y=this.getOutsideStroke(m),b=!0)),m=m||"#000",(m!==v.fill||y!==v.stroke||b!==v.autoStroke||s!==v.align||a!==v.verticalAlign)&&(l=!0,v.fill=m,v.stroke=y,v.autoStroke=b,v.align=s,v.verticalAlign=a,e.setDefaultTextStyle(v)),e.__dirty|=go,l&&e.dirtyStyle(!0)}},n.prototype.canBeInsideText=function(){return!0},n.prototype.getInsideTextFill=function(){return"#fff"},n.prototype.getInsideTextStroke=function(t){return"#000"},n.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?Y2:X2},n.prototype.getOutsideStroke=function(t){var e=this.__zr&&this.__zr.getBackgroundColor(),i=typeof e=="string"&&us(e);i||(i=[255,255,255,1]);for(var r=i[3],o=this.__zr.isDarkMode(),s=0;s<3;s++)i[s]=i[s]*r+(o?0:255)*(1-r);return i[3]=1,Ll(i,"rgba")},n.prototype.traverse=function(t,e){},n.prototype.attrKV=function(t,e){t==="textConfig"?this.setTextConfig(e):t==="textContent"?this.setTextContent(e):t==="clipPath"?this.setClipPath(e):t==="extra"?(this.extra=this.extra||{},ft(this.extra,e)):this[t]=e},n.prototype.hide=function(){this.ignore=!0,this.markRedraw()},n.prototype.show=function(){this.ignore=!1,this.markRedraw()},n.prototype.attr=function(t,e){if(typeof t=="string")this.attrKV(t,e);else if(Ht(t))for(var i=t,r=yi(i),o=0;o<r.length;o++){var s=r[o];this.attrKV(s,t[s])}return this.markRedraw(),this},n.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var e=this._normalState,i=0;i<this.animators.length;i++){var r=this.animators[i],o=r.__fromStateTransition;if(!(r.getLoop()||o&&o!==HT)){var s=r.targetName,a=s?e[s]:e;r.saveTo(a)}}},n.prototype._innerSaveToNormal=function(t){var e=this._normalState;e||(e=this._normalState={}),t.textConfig&&!e.textConfig&&(e.textConfig=this.textConfig),this._savePrimaryToNormal(t,e,FT)},n.prototype._savePrimaryToNormal=function(t,e,i){for(var r=0;r<i.length;r++){var o=i[r];t[o]!=null&&!(o in e)&&(e[o]=this[o])}},n.prototype.hasState=function(){return this.currentStates.length>0},n.prototype.getState=function(t){return this.states[t]},n.prototype.ensureState=function(t){var e=this.states;return e[t]||(e[t]={}),e[t]},n.prototype.clearStates=function(t){this.useState(HT,!1,t)},n.prototype.useState=function(t,e,i,r){var o=t===HT,s=this.hasState();if(!(!s&&o)){var a=this.currentStates,l=this.stateTransition;if(!(_e(a,t)>=0&&(e||a.length===1))){var h;if(this.stateProxy&&!o&&(h=this.stateProxy(t)),h||(h=this.states&&this.states[t]),!h&&!o){SE("State "+t+" not exists.");return}o||this.saveCurrentToNormalState(h);var u=!!(h&&h.hoverLayer||r);u&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,h,this._normalState,e,!i&&!this.__inHover&&l&&l.duration>0,l);var d=this._textContent,c=this._textGuide;return d&&d.useState(t,e,i,u),c&&c.useState(t,e,i,u),o?(this.currentStates=[],this._normalState={}):e?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!u&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~go),h}}},n.prototype.useStates=function(t,e,i){if(!t.length)this.clearStates();else{var r=[],o=this.currentStates,s=t.length,a=s===o.length;if(a){for(var l=0;l<s;l++)if(t[l]!==o[l]){a=!1;break}}if(a)return;for(var l=0;l<s;l++){var h=t[l],u=void 0;this.stateProxy&&(u=this.stateProxy(h,t)),u||(u=this.states[h]),u&&r.push(u)}var d=r[s-1],c=!!(d&&d.hoverLayer||i);c&&this._toggleHoverLayerFlag(!0);var f=this._mergeStates(r),g=this.stateTransition;this.saveCurrentToNormalState(f),this._applyStateObj(t.join(","),f,this._normalState,!1,!e&&!this.__inHover&&g&&g.duration>0,g);var p=this._textContent,v=this._textGuide;p&&p.useStates(t,e,c),v&&v.useStates(t,e,c),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!c&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~go)}},n.prototype.isSilent=function(){for(var t=this.silent,e=this.parent;!t&&e;){if(e.silent){t=!0;break}e=e.parent}return t},n.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var e=this.animators[t];e.targetName&&e.changeTarget(this[e.targetName])}},n.prototype.removeState=function(t){var e=_e(this.currentStates,t);if(e>=0){var i=this.currentStates.slice();i.splice(e,1),this.useStates(i)}},n.prototype.replaceState=function(t,e,i){var r=this.currentStates.slice(),o=_e(r,t),s=_e(r,e)>=0;o>=0?s?r.splice(o,1):r[o]=e:i&&!s&&r.push(e),this.useStates(r)},n.prototype.toggleState=function(t,e){e?this.useState(t,!0):this.removeState(t)},n.prototype._mergeStates=function(t){for(var e={},i,r=0;r<t.length;r++){var o=t[r];ft(e,o),o.textConfig&&(i=i||{},ft(i,o.textConfig))}return i&&(e.textConfig=i),e},n.prototype._applyStateObj=function(t,e,i,r,o,s){var a=!(e&&r);e&&e.textConfig?(this.textConfig=ft({},r?this.textConfig:i.textConfig),ft(this.textConfig,e.textConfig)):a&&i.textConfig&&(this.textConfig=i.textConfig);for(var l={},h=!1,u=0;u<FT.length;u++){var d=FT[u],c=o&&wet[d];e&&e[d]!=null?c?(h=!0,l[d]=e[d]):this[d]=e[d]:a&&i[d]!=null&&(c?(h=!0,l[d]=i[d]):this[d]=i[d])}if(!o)for(var u=0;u<this.animators.length;u++){var f=this.animators[u],g=f.targetName;f.getLoop()||f.__changeFinalValue(g?(e||i)[g]:e||i)}h&&this._transitionState(t,l,s)},n.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var e=this.__zr;e&&t.addSelfToZr(e),t.__zr=e,t.__hostTarget=this}},n.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},n.prototype.getClipPath=function(){return this._clipPath},n.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},n.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},n.prototype.getTextContent=function(){return this._textContent},n.prototype.setTextContent=function(t){var e=this._textContent;e!==t&&(e&&e!==t&&this.removeTextContent(),t.innerTransformable=new ny,this._attachComponent(t),this._textContent=t,this.markRedraw())},n.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),ft(this.textConfig,t),this.markRedraw()},n.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},n.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},n.prototype.getTextGuideLine=function(){return this._textGuide},n.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},n.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},n.prototype.markRedraw=function(){this.__dirty|=go;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},n.prototype.dirty=function(){this.markRedraw()},n.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var e=this._textContent,i=this._textGuide;e&&(e.__inHover=t),i&&(i.__inHover=t)},n.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.addAnimator(e[i]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},n.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.removeAnimator(e[i]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},n.prototype.animate=function(t,e,i){var r=t?this[t]:this,o=new BE(r,e,i);return t&&(o.targetName=t),this.addAnimator(o,t),o},n.prototype.addAnimator=function(t,e){var i=this.__zr,r=this;t.during(function(){r.updateDuringAnimation(e)}).done(function(){var o=r.animators,s=_e(o,t);s>=0&&o.splice(s,1)}),this.animators.push(t),i&&i.animation.addAnimator(t),i&&i.wakeUp()},n.prototype.updateDuringAnimation=function(t){this.markRedraw()},n.prototype.stopAnimation=function(t,e){for(var i=this.animators,r=i.length,o=[],s=0;s<r;s++){var a=i[s];!t||t===a.scope?a.stop(e):o.push(a)}return this.animators=o,this},n.prototype.animateTo=function(t,e,i){zT(this,t,e,i)},n.prototype.animateFrom=function(t,e,i){zT(this,t,e,i,!0)},n.prototype._transitionState=function(t,e,i,r){for(var o=zT(this,e,i,r),s=0;s<o.length;s++)o[s].__fromStateTransition=t},n.prototype.getBoundingRect=function(){return null},n.prototype.getPaintRect=function(){return null},n.initDefaultProps=function(){var t=n.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=go;function e(i,r,o,s){Object.defineProperty(t,i,{get:function(){if(!this[r]){var l=this[r]=[];a(this,l)}return this[r]},set:function(l){this[o]=l[0],this[s]=l[1],this[r]=l,a(this,l)}});function a(l,h){Object.defineProperty(h,0,{get:function(){return l[o]},set:function(u){l[o]=u}}),Object.defineProperty(h,1,{get:function(){return l[s]},set:function(u){l[s]=u}})}}Object.defineProperty&&(e("position","_legacyPos","x","y"),e("scale","_legacyScale","scaleX","scaleY"),e("origin","_legacyOrigin","originX","originY"))}(),n}();ea(eS,ys);ea(eS,ny);function zT(n,t,e,i,r){e=e||{};var o=[];I8(n,"",n,t,e,i,o,r);var s=o.length,a=!1,l=e.done,h=e.aborted,u=function(){a=!0,s--,s<=0&&(a?l&&l():h&&h())},d=function(){s--,s<=0&&(a?l&&l():h&&h())};s||l&&l(),o.length>0&&e.during&&o[0].during(function(g,p){e.during(p)});for(var c=0;c<o.length;c++){var f=o[c];u&&f.done(u),d&&f.aborted(d),e.force&&f.duration(e.duration),f.start(e.easing)}return o}function NT(n,t,e){for(var i=0;i<e;i++)n[i]=t[i]}function Aet(n){return Yr(n[0])}function Tet(n,t,e){if(Yr(t[e]))if(Yr(n[e])||(n[e]=[]),Kr(t[e])){var i=t[e].length;n[e].length!==i&&(n[e]=new t[e].constructor(i),NT(n[e],t[e],i))}else{var r=t[e],o=n[e],s=r.length;if(Aet(r))for(var a=r[0].length,l=0;l<s;l++)o[l]?NT(o[l],r[l],a):o[l]=Array.prototype.slice.call(r[l]);else NT(o,r,s);o.length=r.length}else n[e]=t[e]}function Met(n,t){return n===t||Yr(n)&&Yr(t)&&Ret(n,t)}function Ret(n,t){var e=n.length;if(e!==t.length)return!1;for(var i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}function I8(n,t,e,i,r,o,s,a){for(var l=yi(i),h=r.duration,u=r.delay,d=r.additive,c=r.setToFinal,f=!Ht(o),g=n.animators,p=[],v=0;v<l.length;v++){var m=l[v],y=i[m];if(y!=null&&e[m]!=null&&(f||o[m]))if(Ht(y)&&!Yr(y)&&!Zx(y)){if(t){a||(e[m]=y,n.updateDuringAnimation(t));continue}I8(n,m,e[m],y,r,o&&o[m],s,a)}else p.push(m);else a||(e[m]=y,n.updateDuringAnimation(t),p.push(m))}var b=p.length;if(!d&&b)for(var _=0;_<g.length;_++){var w=g[_];if(w.targetName===t){var C=w.stopTracks(p);if(C){var x=_e(g,w);g.splice(x,1)}}}if(r.force||(p=Ti(p,function(M){return!Met(i[M],e[M])}),b=p.length),b>0||r.force&&!s.length){var S=void 0,A=void 0,T=void 0;if(a){A={},c&&(S={});for(var _=0;_<b;_++){var m=p[_];A[m]=e[m],c?S[m]=i[m]:e[m]=i[m]}}else if(c){T={};for(var _=0;_<b;_++){var m=p[_];T[m]=G_(e[m]),Tet(e,i,m)}}var w=new BE(e,!1,!1,d?Ti(g,function(R){return R.targetName===t}):null);w.targetName=t,r.scope&&(w.scope=r.scope),c&&S&&w.whenWithKeys(0,S,p),T&&w.whenWithKeys(0,T,p),w.whenWithKeys(h??500,a?A:i,p).delay(u||0),n.addAnimator(w,t),s.push(w)}}var bi=function(n){ct(t,n);function t(e){var i=n.call(this)||this;return i.isGroup=!0,i._children=[],i.attr(e),i}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(e){return this._children[e]},t.prototype.childOfName=function(e){for(var i=this._children,r=0;r<i.length;r++)if(i[r].name===e)return i[r]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(e){return e&&e!==this&&e.parent!==this&&(this._children.push(e),this._doAdd(e)),this},t.prototype.addBefore=function(e,i){if(e&&e!==this&&e.parent!==this&&i&&i.parent===this){var r=this._children,o=r.indexOf(i);o>=0&&(r.splice(o,0,e),this._doAdd(e))}return this},t.prototype.replace=function(e,i){var r=_e(this._children,e);return r>=0&&this.replaceAt(i,r),this},t.prototype.replaceAt=function(e,i){var r=this._children,o=r[i];if(e&&e!==this&&e.parent!==this&&e!==o){r[i]=e,o.parent=null;var s=this.__zr;s&&o.removeSelfFromZr(s),this._doAdd(e)}return this},t.prototype._doAdd=function(e){e.parent&&e.parent.remove(e),e.parent=this;var i=this.__zr;i&&i!==e.__zr&&e.addSelfToZr(i),i&&i.refresh()},t.prototype.remove=function(e){var i=this.__zr,r=this._children,o=_e(r,e);return o<0?this:(r.splice(o,1),e.parent=null,i&&e.removeSelfFromZr(i),i&&i.refresh(),this)},t.prototype.removeAll=function(){for(var e=this._children,i=this.__zr,r=0;r<e.length;r++){var o=e[r];i&&o.removeSelfFromZr(i),o.parent=null}return e.length=0,this},t.prototype.eachChild=function(e,i){for(var r=this._children,o=0;o<r.length;o++){var s=r[o];e.call(i,s,o)}return this},t.prototype.traverse=function(e,i){for(var r=0;r<this._children.length;r++){var o=this._children[r],s=e.call(i,o);o.isGroup&&!s&&o.traverse(e,i)}return this},t.prototype.addSelfToZr=function(e){n.prototype.addSelfToZr.call(this,e);for(var i=0;i<this._children.length;i++){var r=this._children[i];r.addSelfToZr(e)}},t.prototype.removeSelfFromZr=function(e){n.prototype.removeSelfFromZr.call(this,e);for(var i=0;i<this._children.length;i++){var r=this._children[i];r.removeSelfFromZr(e)}},t.prototype.getBoundingRect=function(e){for(var i=new Te(0,0,0,0),r=e||this._children,o=[],s=null,a=0;a<r.length;a++){var l=r[a];if(!(l.ignore||l.invisible)){var h=l.getBoundingRect(),u=l.getLocalTransform(o);u?(Te.applyTransform(i,h,u),s=s||i.clone(),s.union(i)):(s=s||h.clone(),s.union(h))}}return s||i},t}(eS);bi.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var X_={},H8={};function Bet(n){delete H8[n]}function Pet(n){if(!n)return!1;if(typeof n=="string")return LC(n,1)<U2;if(n.colorStops){for(var t=n.colorStops,e=0,i=t.length,r=0;r<i;r++)e+=LC(t[r].color,1);return e/=i,e<U2}return!1}var ket=function(){function n(t,e,i){var r=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,i=i||{},this.dom=e,this.id=t;var o=new Ytt,s=i.renderer||"canvas";X_[s]||(s=yi(X_)[0]),i.useDirtyRect=i.useDirtyRect==null?!1:i.useDirtyRect;var a=new X_[s](e,o,i,t),l=i.ssr||a.ssrOnly;this.storage=o,this.painter=a;var h=!ie.node&&!ie.worker&&!l?new bet(a.getViewportRoot(),a.root):null,u=i.useCoarsePointer,d=u==null||u==="auto"?ie.touchEventsSupported:!!u,c=44,f;d&&(f=ve(i.pointerSize,c)),this.handler=new _8(o,a,h,a.root,f),this.animation=new cet({stage:{update:l?null:function(){return r._flush(!0)}}}),l||this.animation.start()}return n.prototype.add=function(t){this._disposed||!t||(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},n.prototype.remove=function(t){this._disposed||!t||(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},n.prototype.configLayer=function(t,e){this._disposed||(this.painter.configLayer&&this.painter.configLayer(t,e),this.refresh())},n.prototype.setBackgroundColor=function(t){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=Pet(t))},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.setDarkMode=function(t){this._darkMode=t},n.prototype.isDarkMode=function(){return this._darkMode},n.prototype.refreshImmediately=function(t){this._disposed||(t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},n.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},n.prototype.flush=function(){this._disposed||this._flush(!1)},n.prototype._flush=function(t){var e,i=Af();this._needsRefresh&&(e=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(e=!0,this.refreshHoverImmediately());var r=Af();e?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:r-i})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},n.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},n.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},n.prototype.refreshHover=function(){this._needsRefreshHover=!0},n.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},n.prototype.resize=function(t){this._disposed||(t=t||{},this.painter.resize(t.width,t.height),this.handler.resize())},n.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},n.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},n.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},n.prototype.setCursorStyle=function(t){this._disposed||this.handler.setCursorStyle(t)},n.prototype.findHover=function(t,e){if(!this._disposed)return this.handler.findHover(t,e)},n.prototype.on=function(t,e,i){return this._disposed||this.handler.on(t,e,i),this},n.prototype.off=function(t,e){this._disposed||this.handler.off(t,e)},n.prototype.trigger=function(t,e){this._disposed||this.handler.trigger(t,e)},n.prototype.clear=function(){if(!this._disposed){for(var t=this.storage.getRoots(),e=0;e<t.length;e++)t[e]instanceof bi&&t[e].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},n.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,Bet(this.id))},n}();function TI(n,t){var e=new ket(c8(),n,t);return H8[e.id]=e,e}function Eet(n,t){X_[n]=t}var MI=1e-4,F8=20;function Let(n){return n.replace(/^\s+|\s+$/g,"")}function Ui(n,t,e,i){var r=t[0],o=t[1],s=e[0],a=e[1],l=o-r,h=a-s;if(l===0)return h===0?s:(s+a)/2;if(i)if(l>0){if(n<=r)return s;if(n>=o)return a}else{if(n>=r)return s;if(n<=o)return a}else{if(n===r)return s;if(n===o)return a}return(n-r)/l*h+s}function Jt(n,t){switch(n){case"center":case"middle":n="50%";break;case"left":case"top":n="0%";break;case"right":case"bottom":n="100%";break}return Pt(n)?Let(n).match(/%$/)?parseFloat(n)/100*t:parseFloat(n):n==null?NaN:+n}function xn(n,t,e){return t==null&&(t=10),t=Math.min(Math.max(0,t),F8),n=(+n).toFixed(t),e?n:+n}function Ev(n){return n.sort(function(t,e){return t-e}),n}function Tl(n){if(n=+n,isNaN(n))return 0;if(n>1e-14){for(var t=1,e=0;e<15;e++,t*=10)if(Math.round(n*t)/t===n)return e}return Oet(n)}function Oet(n){var t=n.toString().toLowerCase(),e=t.indexOf("e"),i=e>0?+t.slice(e+1):0,r=e>0?e:t.length,o=t.indexOf("."),s=o<0?0:r-1-o;return Math.max(0,s-i)}function z8(n,t){var e=Math.log,i=Math.LN10,r=Math.floor(e(n[1]-n[0])/i),o=Math.round(e(Math.abs(t[1]-t[0]))/i),s=Math.min(Math.max(-r+o,0),20);return isFinite(s)?s:20}function Det(n,t){var e=Uh(n,function(f,g){return f+(isNaN(g)?0:g)},0);if(e===0)return[];for(var i=Math.pow(10,t),r=St(n,function(f){return(isNaN(f)?0:f)/e*i*100}),o=i*100,s=St(r,function(f){return Math.floor(f)}),a=Uh(s,function(f,g){return f+g},0),l=St(r,function(f,g){return f-s[g]});a<o;){for(var h=Number.NEGATIVE_INFINITY,u=null,d=0,c=l.length;d<c;++d)l[d]>h&&(h=l[d],u=d);++s[u],l[u]=0,++a}return St(s,function(f){return f/i})}function Iet(n,t){var e=Math.max(Tl(n),Tl(t)),i=n+t;return e>F8?i:xn(i,e)}var RI=9007199254740991;function N8(n){var t=Math.PI*2;return(n%t+t)%t}function j0(n){return n>-MI&&n<MI}var Het=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Wl(n){if(n instanceof Date)return n;if(Pt(n)){var t=Het.exec(n);if(!t)return new Date(NaN);if(t[8]){var e=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(e-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,e,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(n==null)return new Date(NaN);return new Date(Math.round(n))}function Fet(n){return Math.pow(10,kE(n))}function kE(n){if(n===0)return 0;var t=Math.floor(Math.log(n)/Math.LN10);return n/Math.pow(10,t)>=10&&t++,t}function W8(n,t){var e=kE(n),i=Math.pow(10,e),r=n/i,o;return r<1.5?o=1:r<2.5?o=2:r<4?o=3:r<7?o=5:o=10,n=o*i,e>=-20?+n.toFixed(e<0?-e:0):n}function IC(n){var t=parseFloat(n);return t==n&&(t!==0||!Pt(n)||n.indexOf("x")<=0)?t:NaN}function zet(n){return!isNaN(IC(n))}function V8(){return Math.round(Math.random()*9)}function G8(n,t){return t===0?n:G8(t,n%t)}function BI(n,t){return n==null?t:t==null?n:n*t/G8(n,t)}function Fr(n){throw new Error(n)}function PI(n,t,e){return(t-n)*e+n}var $8="series\0",j8="\0_ec_\0";function Ni(n){return n instanceof Array?n:n==null?[]:[n]}function K2(n,t,e){if(n){n[t]=n[t]||{},n.emphasis=n.emphasis||{},n.emphasis[t]=n.emphasis[t]||{};for(var i=0,r=e.length;i<r;i++){var o=e[i];!n.emphasis[t].hasOwnProperty(o)&&n[t].hasOwnProperty(o)&&(n.emphasis[t][o]=n[t][o])}}}var kI=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function oy(n){return Ht(n)&&!_t(n)&&!(n instanceof Date)?n.value:n}function Net(n){return Ht(n)&&!(n instanceof Array)}function Wet(n,t,e){var i=e==="normalMerge",r=e==="replaceMerge",o=e==="replaceAll";n=n||[],t=(t||[]).slice();var s=$t();N(t,function(l,h){if(!Ht(l)){t[h]=null;return}});var a=Vet(n,s,e);return(i||r)&&Get(a,n,s,t),i&&$et(a,t),i||r?jet(a,t,r):o&&Uet(a,t),Xet(a),a}function Vet(n,t,e){var i=[];if(e==="replaceAll")return i;for(var r=0;r<n.length;r++){var o=n[r];o&&o.id!=null&&t.set(o.id,r),i.push({existing:e==="replaceMerge"||U0(o)?null:o,newOption:null,keyInfo:null,brandNew:null})}return i}function Get(n,t,e,i){N(i,function(r,o){if(!(!r||r.id==null)){var s=o0(r.id),a=e.get(s);if(a!=null){var l=n[a];ps(!l.newOption,'Duplicated option on id "'+s+'".'),l.newOption=r,l.existing=t[a],i[o]=null}}})}function $et(n,t){N(t,function(e,i){if(!(!e||e.name==null))for(var r=0;r<n.length;r++){var o=n[r].existing;if(!n[r].newOption&&o&&(o.id==null||e.id==null)&&!U0(e)&&!U0(o)&&U8("name",o,e)){n[r].newOption=e,t[i]=null;return}}})}function jet(n,t,e){N(t,function(i){if(i){for(var r,o=0;(r=n[o])&&(r.newOption||U0(r.existing)||r.existing&&i.id!=null&&!U8("id",i,r.existing));)o++;r?(r.newOption=i,r.brandNew=e):n.push({newOption:i,brandNew:e,existing:null,keyInfo:null}),o++}})}function Uet(n,t){N(t,function(e){n.push({newOption:e,brandNew:!0,existing:null,keyInfo:null})})}function Xet(n){var t=$t();N(n,function(e){var i=e.existing;i&&t.set(i.id,e)}),N(n,function(e){var i=e.newOption;ps(!i||i.id==null||!t.get(i.id)||t.get(i.id)===e,"id duplicates: "+(i&&i.id)),i&&i.id!=null&&t.set(i.id,e),!e.keyInfo&&(e.keyInfo={})}),N(n,function(e,i){var r=e.existing,o=e.newOption,s=e.keyInfo;if(Ht(o)){if(s.name=o.name!=null?o0(o.name):r?r.name:$8+i,r)s.id=o0(r.id);else if(o.id!=null)s.id=o0(o.id);else{var a=0;do s.id="\0"+s.name+"\0"+a++;while(t.get(s.id))}t.set(s.id,e)}})}function U8(n,t,e){var i=_o(t[n],null),r=_o(e[n],null);return i!=null&&r!=null&&i===r}function o0(n){return _o(n,"")}function _o(n,t){return n==null?t:Pt(n)?n:di(n)||P2(n)?n+"":t}function EE(n){var t=n.name;return!!(t&&t.indexOf($8))}function U0(n){return n&&n.id!=null&&o0(n.id).indexOf(j8)===0}function Yet(n){return j8+n}function Ket(n,t,e){N(n,function(i){var r=i.newOption;Ht(r)&&(i.keyInfo.mainType=t,i.keyInfo.subType=qet(t,r,i.existing,e))})}function qet(n,t,e,i){var r=t.type?t.type:e?e.subType:i.determineSubType(n,t);return r}function ec(n,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return _t(t.dataIndex)?St(t.dataIndex,function(e){return n.indexOfRawIndex(e)}):n.indexOfRawIndex(t.dataIndex);if(t.name!=null)return _t(t.name)?St(t.name,function(e){return n.indexOfName(e)}):n.indexOfName(t.name)}function Ke(){var n="__ec_inner_"+Zet++;return function(t){return t[n]||(t[n]={})}}var Zet=V8();function s0(n,t,e){var i=LE(t,e),r=i.mainTypeSpecified,o=i.queryOptionMap,s=i.others,a=s,l=e?e.defaultMainType:null;return!r&&l&&o.set(l,{}),o.each(function(h,u){var d=sy(n,u,h,{useDefault:l===u,enableAll:e&&e.enableAll!=null?e.enableAll:!0,enableNone:e&&e.enableNone!=null?e.enableNone:!0});a[u+"Models"]=d.models,a[u+"Model"]=d.models[0]}),a}function LE(n,t){var e;if(Pt(n)){var i={};i[n+"Index"]=0,e=i}else e=n;var r=$t(),o={},s=!1;return N(e,function(a,l){if(l==="dataIndex"||l==="dataIndexInside"){o[l]=a;return}var h=l.match(/^(\w+)(Index|Id|Name)$/)||[],u=h[1],d=(h[2]||"").toLowerCase();if(!(!u||!d||t&&t.includeMainTypes&&_e(t.includeMainTypes,u)<0)){s=s||!!u;var c=r.get(u)||r.set(u,{});c[d]=a}}),{mainTypeSpecified:s,queryOptionMap:r,others:o}}var Qn={useDefault:!0,enableAll:!1,enableNone:!1},Jet={useDefault:!1,enableAll:!0,enableNone:!0};function sy(n,t,e,i){i=i||Qn;var r=e.index,o=e.id,s=e.name,a={models:null,specified:r!=null||o!=null||s!=null};if(!a.specified){var l=void 0;return a.models=i.useDefault&&(l=n.getComponent(t))?[l]:[],a}return r==="none"||r===!1?(ps(i.enableNone,'`"none"` or `false` is not a valid value on index option.'),a.models=[],a):(r==="all"&&(ps(i.enableAll,'`"all"` is not a valid value on index option.'),r=o=s=null),a.models=n.queryComponents({mainType:t,index:r,id:o,name:s}),a)}function X8(n,t,e){n.setAttribute?n.setAttribute(t,e):n[t]=e}function Qet(n,t){return n.getAttribute?n.getAttribute(t):n[t]}function tit(n){return n==="auto"?ie.domSupported?"html":"richText":n||"html"}function Y8(n,t,e,i,r){var o=t==null||t==="auto";if(i==null)return i;if(di(i)){var s=PI(e||0,i,r);return xn(s,o?Math.max(Tl(e||0),Tl(i)):t)}else{if(Pt(i))return r<1?e:i;for(var a=[],l=e,h=i,u=Math.max(l?l.length:0,h.length),d=0;d<u;++d){var c=n.getDimensionInfo(d);if(c&&c.type==="ordinal")a[d]=(r<1&&l?l:h)[d];else{var f=l&&l[d]?l[d]:0,g=h[d],s=PI(f,g,r);a[d]=xn(s,o?Math.max(Tl(f),Tl(g)):t)}}return a}}var eit=".",Tu="___EC__COMPONENT__CONTAINER___",K8="___EC__EXTENDED_CLASS___";function Pa(n){var t={main:"",sub:""};if(n){var e=n.split(eit);t.main=e[0]||"",t.sub=e[1]||""}return t}function iit(n){ps(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n),'componentType "'+n+'" illegal')}function nit(n){return!!(n&&n[K8])}function OE(n,t){n.$constructor=n,n.extend=function(e){var i=this,r;return rit(i)?r=function(o){ct(s,o);function s(){return o.apply(this,arguments)||this}return s}(i):(r=function(){(e.$constructor||i).apply(this,arguments)},ftt(r,this)),ft(r.prototype,e),r[K8]=!0,r.extend=this.extend,r.superCall=ait,r.superApply=lit,r.superClass=i,r}}function rit(n){return jt(n)&&/^class\s/.test(Function.prototype.toString.call(n))}function q8(n,t){n.extend=t.extend}var oit=Math.round(Math.random()*10);function sit(n){var t=["__\0is_clz",oit++].join("_");n.prototype[t]=!0,n.isInstance=function(e){return!!(e&&e[t])}}function ait(n,t){for(var e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];return this.superClass.prototype[t].apply(n,e)}function lit(n,t,e){return this.superClass.prototype[t].apply(n,e)}function iS(n){var t={};n.registerClass=function(i){var r=i.type||i.prototype.type;if(r){iit(r),i.prototype.type=r;var o=Pa(r);if(!o.sub)t[o.main]=i;else if(o.sub!==Tu){var s=e(o);s[o.sub]=i}}return i},n.getClass=function(i,r,o){var s=t[i];if(s&&s[Tu]&&(s=r?s[r]:null),o&&!s)throw new Error(r?"Component "+i+"."+(r||"")+" is used but not imported.":i+".type should be specified.");return s},n.getClassesByMainType=function(i){var r=Pa(i),o=[],s=t[r.main];return s&&s[Tu]?N(s,function(a,l){l!==Tu&&o.push(a)}):o.push(s),o},n.hasClass=function(i){var r=Pa(i);return!!t[r.main]},n.getAllClassMainTypes=function(){var i=[];return N(t,function(r,o){i.push(o)}),i},n.hasSubTypes=function(i){var r=Pa(i),o=t[r.main];return o&&o[Tu]};function e(i){var r=t[i.main];return(!r||!r[Tu])&&(r=t[i.main]={},r[Tu]=!0),r}}function yg(n,t){for(var e=0;e<n.length;e++)n[e][1]||(n[e][1]=n[e][0]);return t=t||!1,function(i,r,o){for(var s={},a=0;a<n.length;a++){var l=n[a][1];if(!(r&&_e(r,l)>=0||o&&_e(o,l)<0)){var h=i.getShallow(l,t);h!=null&&(s[n[a][0]]=h)}}return s}}var hit=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],uit=yg(hit),dit=function(){function n(){}return n.prototype.getAreaStyle=function(t,e){return uit(this,t,e)},n}(),q2=new iy(50);function cit(n){if(typeof n=="string"){var t=q2.get(n);return t&&t.image}else return n}function Z8(n,t,e,i,r){if(n)if(typeof n=="string"){if(t&&t.__zrImageSrc===n||!e)return t;var o=q2.get(n),s={hostEl:e,cb:i,cbPayload:r};return o?(t=o.image,!nS(t)&&o.pending.push(s)):(t=up.loadImage(n,EI,EI),t.__zrImageSrc=n,q2.put(n,t.__cachedImgObj={image:t,pending:[s]})),t}else return n;else return t}function EI(){var n=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<n.pending.length;t++){var e=n.pending[t],i=e.cb;i&&i(this,e.cbPayload),e.hostEl.dirty()}n.pending.length=0}function nS(n){return n&&n.width&&n.height}var WT=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function fit(n,t,e,i,r,o){if(!e){n.text="",n.isTruncated=!1;return}var s=(t+"").split(`
`);o=J8(e,i,r,o);for(var a=!1,l={},h=0,u=s.length;h<u;h++)Q8(l,s[h],o),s[h]=l.textLine,a=a||l.isTruncated;n.text=s.join(`
`),n.isTruncated=a}function J8(n,t,e,i){i=i||{};var r=ft({},i);r.font=t,e=ve(e,"..."),r.maxIterations=ve(i.maxIterations,2);var o=r.minChar=ve(i.minChar,0);r.cnCharWidth=bo("",t);var s=r.ascCharWidth=bo("a",t);r.placeholder=ve(i.placeholder,"");for(var a=n=Math.max(0,n-1),l=0;l<o&&a>=s;l++)a-=s;var h=bo(e,t);return h>a&&(e="",h=0),a=n-h,r.ellipsis=e,r.ellipsisWidth=h,r.contentWidth=a,r.containerWidth=n,r}function Q8(n,t,e){var i=e.containerWidth,r=e.font,o=e.contentWidth;if(!i){n.textLine="",n.isTruncated=!1;return}var s=bo(t,r);if(s<=i){n.textLine=t,n.isTruncated=!1;return}for(var a=0;;a++){if(s<=o||a>=e.maxIterations){t+=e.ellipsis;break}var l=a===0?git(t,o,e.ascCharWidth,e.cnCharWidth):s>0?Math.floor(t.length*o/s):0;t=t.substr(0,l),s=bo(t,r)}t===""&&(t=e.placeholder),n.textLine=t,n.isTruncated=!0}function git(n,t,e,i){for(var r=0,o=0,s=n.length;o<s&&r<t;o++){var a=n.charCodeAt(o);r+=0<=a&&a<=127?e:i}return o}function pit(n,t){n!=null&&(n+="");var e=t.overflow,i=t.padding,r=t.font,o=e==="truncate",s=PE(r),a=ve(t.lineHeight,s),l=!!t.backgroundColor,h=t.lineOverflow==="truncate",u=!1,d=t.width,c;d!=null&&(e==="break"||e==="breakAll")?c=n?t9(n,t.font,d,e==="breakAll",0).lines:[]:c=n?n.split(`
`):[];var f=c.length*a,g=ve(t.height,f);if(f>g&&h){var p=Math.floor(g/a);u=u||c.length>p,c=c.slice(0,p)}if(n&&o&&d!=null)for(var v=J8(d,r,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),m={},y=0;y<c.length;y++)Q8(m,c[y],v),c[y]=m.textLine,u=u||m.isTruncated;for(var b=g,_=0,y=0;y<c.length;y++)_=Math.max(bo(c[y],r),_);d==null&&(d=_);var w=_;return i&&(b+=i[0]+i[2],w+=i[1]+i[3],d+=i[1]+i[3]),l&&(w=d),{lines:c,height:g,outerWidth:w,outerHeight:b,lineHeight:a,calculatedLineHeight:s,contentWidth:_,contentHeight:f,width:d,isTruncated:u}}var vit=function(){function n(){}return n}(),LI=function(){function n(t){this.tokens=[],t&&(this.tokens=t)}return n}(),mit=function(){function n(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}return n}();function yit(n,t){var e=new mit;if(n!=null&&(n+=""),!n)return e;for(var i=t.width,r=t.height,o=t.overflow,s=(o==="break"||o==="breakAll")&&i!=null?{width:i,accumWidth:0,breakAll:o==="breakAll"}:null,a=WT.lastIndex=0,l;(l=WT.exec(n))!=null;){var h=l.index;h>a&&VT(e,n.substring(a,h),t,s),VT(e,l[2],t,s,l[1]),a=WT.lastIndex}a<n.length&&VT(e,n.substring(a,n.length),t,s);var u=[],d=0,c=0,f=t.padding,g=o==="truncate",p=t.lineOverflow==="truncate",v={};function m(I,H,F){I.width=H,I.lineHeight=F,d+=F,c=Math.max(c,H)}t:for(var y=0;y<e.lines.length;y++){for(var b=e.lines[y],_=0,w=0,C=0;C<b.tokens.length;C++){var x=b.tokens[C],S=x.styleName&&t.rich[x.styleName]||{},A=x.textPadding=S.padding,T=A?A[1]+A[3]:0,M=x.font=S.font||t.font;x.contentHeight=PE(M);var R=ve(S.height,x.contentHeight);if(x.innerHeight=R,A&&(R+=A[0]+A[2]),x.height=R,x.lineHeight=e0(S.lineHeight,t.lineHeight,R),x.align=S&&S.align||t.align,x.verticalAlign=S&&S.verticalAlign||"middle",p&&r!=null&&d+x.lineHeight>r){var E=e.lines.length;C>0?(b.tokens=b.tokens.slice(0,C),m(b,w,_),e.lines=e.lines.slice(0,y+1)):e.lines=e.lines.slice(0,y),e.isTruncated=e.isTruncated||e.lines.length<E;break t}var P=S.width,B=P==null||P==="auto";if(typeof P=="string"&&P.charAt(P.length-1)==="%")x.percentWidth=P,u.push(x),x.contentWidth=bo(x.text,M);else{if(B){var k=S.backgroundColor,L=k&&k.image;L&&(L=cit(L),nS(L)&&(x.width=Math.max(x.width,L.width*R/L.height)))}var O=g&&i!=null?i-w:null;O!=null&&O<x.width?!B||O<T?(x.text="",x.width=x.contentWidth=0):(fit(v,x.text,O-T,M,t.ellipsis,{minChar:t.truncateMinChar}),x.text=v.text,e.isTruncated=e.isTruncated||v.isTruncated,x.width=x.contentWidth=bo(x.text,M)):x.contentWidth=bo(x.text,M)}x.width+=T,w+=x.width,S&&(_=Math.max(_,x.lineHeight))}m(b,w,_)}e.outerWidth=e.width=ve(i,c),e.outerHeight=e.height=ve(r,d),e.contentHeight=d,e.contentWidth=c,f&&(e.outerWidth+=f[1]+f[3],e.outerHeight+=f[0]+f[2]);for(var y=0;y<u.length;y++){var x=u[y],D=x.percentWidth;x.width=parseInt(D,10)/100*e.width}return e}function VT(n,t,e,i,r){var o=t==="",s=r&&e.rich[r]||{},a=n.lines,l=s.font||e.font,h=!1,u,d;if(i){var c=s.padding,f=c?c[1]+c[3]:0;if(s.width!=null&&s.width!=="auto"){var g=Yh(s.width,i.width)+f;a.length>0&&g+i.accumWidth>i.width&&(u=t.split(`
`),h=!0),i.accumWidth=g}else{var p=t9(t,l,i.width,i.breakAll,i.accumWidth);i.accumWidth=p.accumWidth+f,d=p.linesWidths,u=p.lines}}else u=t.split(`
`);for(var v=0;v<u.length;v++){var m=u[v],y=new vit;if(y.styleName=r,y.text=m,y.isLineHolder=!m&&!o,typeof s.width=="number"?y.width=s.width:y.width=d?d[v]:bo(m,l),!v&&!h){var b=(a[a.length-1]||(a[0]=new LI)).tokens,_=b.length;_===1&&b[0].isLineHolder?b[0]=y:(m||!_||o)&&b.push(y)}else a.push(new LI([y]))}}function bit(n){var t=n.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var _it=Uh(",&?/;] ".split(""),function(n,t){return n[t]=!0,n},{});function Cit(n){return bit(n)?!!_it[n]:!0}function t9(n,t,e,i,r){for(var o=[],s=[],a="",l="",h=0,u=0,d=0;d<n.length;d++){var c=n.charAt(d);if(c===`
`){l&&(a+=l,u+=h),o.push(a),s.push(u),a="",l="",h=0,u=0;continue}var f=bo(c,t),g=i?!1:!Cit(c);if(o.length?u+f>e:r+u+f>e){u?(a||l)&&(g?(a||(a=l,l="",h=0,u=h),o.push(a),s.push(u-h),l+=c,h+=f,a="",u=h):(l&&(a+=l,l="",h=0),o.push(a),s.push(u),a=c,u=f)):g?(o.push(l),s.push(h),l=c,h=f):(o.push(c),s.push(f));continue}u+=f,g?(l+=c,h+=f):(l&&(a+=l,l="",h=0),a+=c)}return!o.length&&!a&&(a=n,l="",h=0),l&&(a+=l),a&&(o.push(a),s.push(u)),o.length===1&&(u+=r),{accumWidth:u,lines:o,linesWidths:s}}var Z2="__zr_style_"+Math.round(Math.random()*10),Hd={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},rS={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};Hd[Z2]=!0;var OI=["z","z2","invisible"],wit=["invisible"],Sc=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype._init=function(e){for(var i=yi(e),r=0;r<i.length;r++){var o=i[r];o==="style"?this.useStyle(e[o]):n.prototype.attrKV.call(this,o,e[o])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(e,i,r,o){var s=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&xit(this,e,i)||s&&!s[0]&&!s[3])return!1;if(r&&this.__clipPaths){for(var a=0;a<this.__clipPaths.length;++a)if(this.__clipPaths[a].isZeroArea())return!1}if(o&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(e,i){return this.rectContain(e,i)},t.prototype.traverse=function(e,i){e.call(i,this)},t.prototype.rectContain=function(e,i){var r=this.transformCoordToLocal(e,i),o=this.getBoundingRect();return o.contain(r[0],r[1])},t.prototype.getPaintRect=function(){var e=this._paintRect;if(!this._paintRect||this.__dirty){var i=this.transform,r=this.getBoundingRect(),o=this.style,s=o.shadowBlur||0,a=o.shadowOffsetX||0,l=o.shadowOffsetY||0;e=this._paintRect||(this._paintRect=new Te(0,0,0,0)),i?Te.applyTransform(e,r,i):e.copy(r),(s||a||l)&&(e.width+=s*2+Math.abs(a),e.height+=s*2+Math.abs(l),e.x=Math.min(e.x,e.x+a-s),e.y=Math.min(e.y,e.y+l-s));var h=this.dirtyRectTolerance;e.isZero()||(e.x=Math.floor(e.x-h),e.y=Math.floor(e.y-h),e.width=Math.ceil(e.width+1+h*2),e.height=Math.ceil(e.height+1+h*2))}return e},t.prototype.setPrevPaintRect=function(e){e?(this._prevPaintRect=this._prevPaintRect||new Te(0,0,0,0),this._prevPaintRect.copy(e)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(e){return this.animate("style",e)},t.prototype.updateDuringAnimation=function(e){e==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(e,i){e!=="style"?n.prototype.attrKV.call(this,e,i):this.style?this.setStyle(i):this.useStyle(i)},t.prototype.setStyle=function(e,i){return typeof e=="string"?this.style[e]=i:ft(this.style,e),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(e){e||this.markRedraw(),this.__dirty|=Bv,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&Bv)},t.prototype.styleUpdated=function(){this.__dirty&=~Bv},t.prototype.createStyle=function(e){return Jx(Hd,e)},t.prototype.useStyle=function(e){e[Z2]||(e=this.createStyle(e)),this.__inHover?this.__hoverStyle=e:this.style=e,this.dirtyStyle()},t.prototype.isStyleObject=function(e){return e[Z2]},t.prototype._innerSaveToNormal=function(e){n.prototype._innerSaveToNormal.call(this,e);var i=this._normalState;e.style&&!i.style&&(i.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(e,i,OI)},t.prototype._applyStateObj=function(e,i,r,o,s,a){n.prototype._applyStateObj.call(this,e,i,r,o,s,a);var l=!(i&&o),h;if(i&&i.style?s?o?h=i.style:(h=this._mergeStyle(this.createStyle(),r.style),this._mergeStyle(h,i.style)):(h=this._mergeStyle(this.createStyle(),o?this.style:r.style),this._mergeStyle(h,i.style)):l&&(h=r.style),h)if(s){var u=this.style;if(this.style=this.createStyle(l?{}:u),l)for(var d=yi(u),c=0;c<d.length;c++){var f=d[c];f in h&&(h[f]=h[f],this.style[f]=u[f])}for(var g=yi(h),c=0;c<g.length;c++){var f=g[c];this.style[f]=this.style[f]}this._transitionState(e,{style:h},a,this.getAnimationStyleProps())}else this.useStyle(h);for(var p=this.__inHover?wit:OI,c=0;c<p.length;c++){var f=p[c];i&&i[f]!=null?this[f]=i[f]:l&&r[f]!=null&&(this[f]=r[f])}},t.prototype._mergeStates=function(e){for(var i=n.prototype._mergeStates.call(this,e),r,o=0;o<e.length;o++){var s=e[o];s.style&&(r=r||{},this._mergeStyle(r,s.style))}return r&&(i.style=r),i},t.prototype._mergeStyle=function(e,i){return ft(e,i),e},t.prototype.getAnimationStyleProps=function(){return rS},t.initDefaultProps=function(){var e=t.prototype;e.type="displayable",e.invisible=!1,e.z=0,e.z2=0,e.zlevel=0,e.culling=!1,e.cursor="pointer",e.rectHover=!1,e.incremental=!1,e._rect=null,e.dirtyRectTolerance=0,e.__dirty=go|Bv}(),t}(eS),GT=new Te(0,0,0,0),$T=new Te(0,0,0,0);function xit(n,t,e){return GT.copy(n.getBoundingRect()),n.transform&&GT.applyTransform(n.transform),$T.width=t,$T.height=e,!GT.intersect($T)}var zr=Math.min,Nr=Math.max,jT=Math.sin,UT=Math.cos,Mu=Math.PI*2,tb=dp(),eb=dp(),ib=dp();function e9(n,t,e){if(n.length!==0){for(var i=n[0],r=i[0],o=i[0],s=i[1],a=i[1],l=1;l<n.length;l++)i=n[l],r=zr(r,i[0]),o=Nr(o,i[0]),s=zr(s,i[1]),a=Nr(a,i[1]);t[0]=r,t[1]=s,e[0]=o,e[1]=a}}function DI(n,t,e,i,r,o){r[0]=zr(n,e),r[1]=zr(t,i),o[0]=Nr(n,e),o[1]=Nr(t,i)}var II=[],HI=[];function Sit(n,t,e,i,r,o,s,a,l,h){var u=A8,d=Bn,c=u(n,e,r,s,II);l[0]=1/0,l[1]=1/0,h[0]=-1/0,h[1]=-1/0;for(var f=0;f<c;f++){var g=d(n,e,r,s,II[f]);l[0]=zr(g,l[0]),h[0]=Nr(g,h[0])}c=u(t,i,o,a,HI);for(var f=0;f<c;f++){var p=d(t,i,o,a,HI[f]);l[1]=zr(p,l[1]),h[1]=Nr(p,h[1])}l[0]=zr(n,l[0]),h[0]=Nr(n,h[0]),l[0]=zr(s,l[0]),h[0]=Nr(s,h[0]),l[1]=zr(t,l[1]),h[1]=Nr(t,h[1]),l[1]=zr(a,l[1]),h[1]=Nr(a,h[1])}function Ait(n,t,e,i,r,o,s,a){var l=M8,h=gr,u=Nr(zr(l(n,e,r),1),0),d=Nr(zr(l(t,i,o),1),0),c=h(n,e,r,u),f=h(t,i,o,d);s[0]=zr(n,r,c),s[1]=zr(t,o,f),a[0]=Nr(n,r,c),a[1]=Nr(t,o,f)}function Tit(n,t,e,i,r,o,s,a,l){var h=xf,u=Sf,d=Math.abs(r-o);if(d%Mu<1e-4&&d>1e-4){a[0]=n-e,a[1]=t-i,l[0]=n+e,l[1]=t+i;return}if(tb[0]=UT(r)*e+n,tb[1]=jT(r)*i+t,eb[0]=UT(o)*e+n,eb[1]=jT(o)*i+t,h(a,tb,eb),u(l,tb,eb),r=r%Mu,r<0&&(r=r+Mu),o=o%Mu,o<0&&(o=o+Mu),r>o&&!s?o+=Mu:r<o&&s&&(r+=Mu),s){var c=o;o=r,r=c}for(var f=0;f<o;f+=Math.PI/2)f>r&&(ib[0]=UT(f)*e+n,ib[1]=jT(f)*i+t,h(a,ib,a),u(l,ib,l))}var qe={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},Ru=[],Bu=[],ua=[],eh=[],da=[],ca=[],XT=Math.min,YT=Math.max,Pu=Math.cos,ku=Math.sin,el=Math.abs,J2=Math.PI,mh=J2*2,KT=typeof Float32Array<"u",Gp=[];function qT(n){var t=Math.round(n/J2*1e8)/1e8;return t%2*J2}function i9(n,t){var e=qT(n[0]);e<0&&(e+=mh);var i=e-n[0],r=n[1];r+=i,!t&&r-e>=mh?r=e+mh:t&&e-r>=mh?r=e-mh:!t&&e>r?r=e+(mh-qT(e-r)):t&&e<r&&(r=e-(mh-qT(r-e))),n[0]=e,n[1]=r}var Vl=function(){function n(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return n.prototype.increaseVersion=function(){this._version++},n.prototype.getVersion=function(){return this._version},n.prototype.setScale=function(t,e,i){i=i||0,i>0&&(this._ux=el(i/OC/t)||0,this._uy=el(i/OC/e)||0)},n.prototype.setDPR=function(t){this.dpr=t},n.prototype.setContext=function(t){this._ctx=t},n.prototype.getContext=function(){return this._ctx},n.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},n.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},n.prototype.moveTo=function(t,e){return this._drawPendingPt(),this.addData(qe.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},n.prototype.lineTo=function(t,e){var i=el(t-this._xi),r=el(e-this._yi),o=i>this._ux||r>this._uy;if(this.addData(qe.L,t,e),this._ctx&&o&&this._ctx.lineTo(t,e),o)this._xi=t,this._yi=e,this._pendingPtDist=0;else{var s=i*i+r*r;s>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=e,this._pendingPtDist=s)}return this},n.prototype.bezierCurveTo=function(t,e,i,r,o,s){return this._drawPendingPt(),this.addData(qe.C,t,e,i,r,o,s),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,o,s),this._xi=o,this._yi=s,this},n.prototype.quadraticCurveTo=function(t,e,i,r){return this._drawPendingPt(),this.addData(qe.Q,t,e,i,r),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this._xi=i,this._yi=r,this},n.prototype.arc=function(t,e,i,r,o,s){this._drawPendingPt(),Gp[0]=r,Gp[1]=o,i9(Gp,s),r=Gp[0],o=Gp[1];var a=o-r;return this.addData(qe.A,t,e,i,i,r,a,0,s?0:1),this._ctx&&this._ctx.arc(t,e,i,r,o,s),this._xi=Pu(o)*i+t,this._yi=ku(o)*i+e,this},n.prototype.arcTo=function(t,e,i,r,o){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,e,i,r,o),this},n.prototype.rect=function(t,e,i,r){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,e,i,r),this.addData(qe.R,t,e,i,r),this},n.prototype.closePath=function(){this._drawPendingPt(),this.addData(qe.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&t.closePath(),this._xi=e,this._yi=i,this},n.prototype.fill=function(t){t&&t.fill(),this.toStatic()},n.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},n.prototype.len=function(){return this._len},n.prototype.setData=function(t){var e=t.length;!(this.data&&this.data.length===e)&&KT&&(this.data=new Float32Array(e));for(var i=0;i<e;i++)this.data[i]=t[i];this._len=e},n.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,r=this._len,o=0;o<e;o++)i+=t[o].len();KT&&this.data instanceof Float32Array&&(this.data=new Float32Array(r+i));for(var o=0;o<e;o++)for(var s=t[o].data,a=0;a<s.length;a++)this.data[r++]=s[a];this._len=r},n.prototype.addData=function(t,e,i,r,o,s,a,l,h){if(this._saveData){var u=this.data;this._len+arguments.length>u.length&&(this._expandData(),u=this.data);for(var d=0;d<arguments.length;d++)u[this._len++]=arguments[d]}},n.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},n.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},n.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,KT&&this._len>11&&(this.data=new Float32Array(t)))}},n.prototype.getBoundingRect=function(){ua[0]=ua[1]=da[0]=da[1]=Number.MAX_VALUE,eh[0]=eh[1]=ca[0]=ca[1]=-Number.MAX_VALUE;var t=this.data,e=0,i=0,r=0,o=0,s;for(s=0;s<this._len;){var a=t[s++],l=s===1;switch(l&&(e=t[s],i=t[s+1],r=e,o=i),a){case qe.M:e=r=t[s++],i=o=t[s++],da[0]=r,da[1]=o,ca[0]=r,ca[1]=o;break;case qe.L:DI(e,i,t[s],t[s+1],da,ca),e=t[s++],i=t[s++];break;case qe.C:Sit(e,i,t[s++],t[s++],t[s++],t[s++],t[s],t[s+1],da,ca),e=t[s++],i=t[s++];break;case qe.Q:Ait(e,i,t[s++],t[s++],t[s],t[s+1],da,ca),e=t[s++],i=t[s++];break;case qe.A:var h=t[s++],u=t[s++],d=t[s++],c=t[s++],f=t[s++],g=t[s++]+f;s+=1;var p=!t[s++];l&&(r=Pu(f)*d+h,o=ku(f)*c+u),Tit(h,u,d,c,f,g,p,da,ca),e=Pu(g)*d+h,i=ku(g)*c+u;break;case qe.R:r=e=t[s++],o=i=t[s++];var v=t[s++],m=t[s++];DI(r,o,r+v,o+m,da,ca);break;case qe.Z:e=r,i=o;break}xf(ua,ua,da),Sf(eh,eh,ca)}return s===0&&(ua[0]=ua[1]=eh[0]=eh[1]=0),new Te(ua[0],ua[1],eh[0]-ua[0],eh[1]-ua[1])},n.prototype._calculateLength=function(){var t=this.data,e=this._len,i=this._ux,r=this._uy,o=0,s=0,a=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var h=this._pathSegLen,u=0,d=0,c=0;c<e;){var f=t[c++],g=c===1;g&&(o=t[c],s=t[c+1],a=o,l=s);var p=-1;switch(f){case qe.M:o=a=t[c++],s=l=t[c++];break;case qe.L:{var v=t[c++],m=t[c++],y=v-o,b=m-s;(el(y)>i||el(b)>r||c===e-1)&&(p=Math.sqrt(y*y+b*b),o=v,s=m);break}case qe.C:{var _=t[c++],w=t[c++],v=t[c++],m=t[c++],C=t[c++],x=t[c++];p=Ktt(o,s,_,w,v,m,C,x,10),o=C,s=x;break}case qe.Q:{var _=t[c++],w=t[c++],v=t[c++],m=t[c++];p=Ztt(o,s,_,w,v,m,10),o=v,s=m;break}case qe.A:var S=t[c++],A=t[c++],T=t[c++],M=t[c++],R=t[c++],E=t[c++],P=E+R;c+=1,g&&(a=Pu(R)*T+S,l=ku(R)*M+A),p=YT(T,M)*XT(mh,Math.abs(E)),o=Pu(P)*T+S,s=ku(P)*M+A;break;case qe.R:{a=o=t[c++],l=s=t[c++];var B=t[c++],k=t[c++];p=B*2+k*2;break}case qe.Z:{var y=a-o,b=l-s;p=Math.sqrt(y*y+b*b),o=a,s=l;break}}p>=0&&(h[d++]=p,u+=p)}return this._pathLen=u,u},n.prototype.rebuildPath=function(t,e){var i=this.data,r=this._ux,o=this._uy,s=this._len,a,l,h,u,d,c,f=e<1,g,p,v=0,m=0,y,b=0,_,w;if(!(f&&(this._pathSegLen||this._calculateLength(),g=this._pathSegLen,p=this._pathLen,y=e*p,!y)))t:for(var C=0;C<s;){var x=i[C++],S=C===1;switch(S&&(h=i[C],u=i[C+1],a=h,l=u),x!==qe.L&&b>0&&(t.lineTo(_,w),b=0),x){case qe.M:a=h=i[C++],l=u=i[C++],t.moveTo(h,u);break;case qe.L:{d=i[C++],c=i[C++];var A=el(d-h),T=el(c-u);if(A>r||T>o){if(f){var M=g[m++];if(v+M>y){var R=(y-v)/M;t.lineTo(h*(1-R)+d*R,u*(1-R)+c*R);break t}v+=M}t.lineTo(d,c),h=d,u=c,b=0}else{var E=A*A+T*T;E>b&&(_=d,w=c,b=E)}break}case qe.C:{var P=i[C++],B=i[C++],k=i[C++],L=i[C++],O=i[C++],D=i[C++];if(f){var M=g[m++];if(v+M>y){var R=(y-v)/M;Xh(h,P,k,O,R,Ru),Xh(u,B,L,D,R,Bu),t.bezierCurveTo(Ru[1],Bu[1],Ru[2],Bu[2],Ru[3],Bu[3]);break t}v+=M}t.bezierCurveTo(P,B,k,L,O,D),h=O,u=D;break}case qe.Q:{var P=i[C++],B=i[C++],k=i[C++],L=i[C++];if(f){var M=g[m++];if(v+M>y){var R=(y-v)/M;EC(h,P,k,R,Ru),EC(u,B,L,R,Bu),t.quadraticCurveTo(Ru[1],Bu[1],Ru[2],Bu[2]);break t}v+=M}t.quadraticCurveTo(P,B,k,L),h=k,u=L;break}case qe.A:var I=i[C++],H=i[C++],F=i[C++],G=i[C++],j=i[C++],W=i[C++],K=i[C++],J=!i[C++],q=F>G?F:G,X=el(F-G)>.001,it=j+W,Z=!1;if(f){var M=g[m++];v+M>y&&(it=j+W*(y-v)/M,Z=!0),v+=M}if(X&&t.ellipse?t.ellipse(I,H,F,G,K,j,it,J):t.arc(I,H,q,j,it,J),Z)break t;S&&(a=Pu(j)*F+I,l=ku(j)*G+H),h=Pu(it)*F+I,u=ku(it)*G+H;break;case qe.R:a=h=i[C],l=u=i[C+1],d=i[C++],c=i[C++];var et=i[C++],nt=i[C++];if(f){var M=g[m++];if(v+M>y){var z=y-v;t.moveTo(d,c),t.lineTo(d+XT(z,et),c),z-=et,z>0&&t.lineTo(d+et,c+XT(z,nt)),z-=nt,z>0&&t.lineTo(d+YT(et-z,0),c+nt),z-=et,z>0&&t.lineTo(d,c+YT(nt-z,0));break t}v+=M}t.rect(d,c,et,nt);break;case qe.Z:if(f){var M=g[m++];if(v+M>y){var R=(y-v)/M;t.lineTo(h*(1-R)+a*R,u*(1-R)+l*R);break t}v+=M}t.closePath(),h=a,u=l}}},n.prototype.clone=function(){var t=new n,e=this.data;return t.data=e.slice?e.slice():Array.prototype.slice.call(e),t._len=this._len,t},n.CMD=qe,n.initDefaultProps=function(){var t=n.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),n}();function Fc(n,t,e,i,r,o,s){if(r===0)return!1;var a=r,l=0,h=n;if(s>t+a&&s>i+a||s<t-a&&s<i-a||o>n+a&&o>e+a||o<n-a&&o<e-a)return!1;if(n!==e)l=(t-i)/(n-e),h=(n*i-e*t)/(n-e);else return Math.abs(o-n)<=a/2;var u=l*o-s+h,d=u*u/(l*l+1);return d<=a/2*a/2}function Mit(n,t,e,i,r,o,s,a,l,h,u){if(l===0)return!1;var d=l;if(u>t+d&&u>i+d&&u>o+d&&u>a+d||u<t-d&&u<i-d&&u<o-d&&u<a-d||h>n+d&&h>e+d&&h>r+d&&h>s+d||h<n-d&&h<e-d&&h<r-d&&h<s-d)return!1;var c=T8(n,t,e,i,r,o,s,a,h,u,null);return c<=d/2}function Rit(n,t,e,i,r,o,s,a,l){if(s===0)return!1;var h=s;if(l>t+h&&l>i+h&&l>o+h||l<t-h&&l<i-h&&l<o-h||a>n+h&&a>e+h&&a>r+h||a<n-h&&a<e-h&&a<r-h)return!1;var u=R8(n,t,e,i,r,o,a,l,null);return u<=h/2}var FI=Math.PI*2;function po(n){return n%=FI,n<0&&(n+=FI),n}var $p=Math.PI*2;function Bit(n,t,e,i,r,o,s,a,l){if(s===0)return!1;var h=s;a-=n,l-=t;var u=Math.sqrt(a*a+l*l);if(u-h>e||u+h<e)return!1;if(Math.abs(i-r)%$p<1e-4)return!0;if(o){var d=i;i=po(r),r=po(d)}else i=po(i),r=po(r);i>r&&(r+=$p);var c=Math.atan2(l,a);return c<0&&(c+=$p),c>=i&&c<=r||c+$p>=i&&c+$p<=r}function Eu(n,t,e,i,r,o){if(o>t&&o>i||o<t&&o<i||i===t)return 0;var s=(o-t)/(i-t),a=i<t?1:-1;(s===1||s===0)&&(a=i<t?.5:-.5);var l=s*(e-n)+n;return l===r?1/0:l>r?a:0}var ih=Vl.CMD,Lu=Math.PI*2,Pit=1e-4;function kit(n,t){return Math.abs(n-t)<Pit}var Sr=[-1,-1,-1],$o=[-1,-1];function Eit(){var n=$o[0];$o[0]=$o[1],$o[1]=n}function Lit(n,t,e,i,r,o,s,a,l,h){if(h>t&&h>i&&h>o&&h>a||h<t&&h<i&&h<o&&h<a)return 0;var u=kC(t,i,o,a,h,Sr);if(u===0)return 0;for(var d=0,c=-1,f=void 0,g=void 0,p=0;p<u;p++){var v=Sr[p],m=v===0||v===1?.5:1,y=Bn(n,e,r,s,v);y<l||(c<0&&(c=A8(t,i,o,a,$o),$o[1]<$o[0]&&c>1&&Eit(),f=Bn(t,i,o,a,$o[0]),c>1&&(g=Bn(t,i,o,a,$o[1]))),c===2?v<$o[0]?d+=f<t?m:-m:v<$o[1]?d+=g<f?m:-m:d+=a<g?m:-m:v<$o[0]?d+=f<t?m:-m:d+=a<f?m:-m)}return d}function Oit(n,t,e,i,r,o,s,a){if(a>t&&a>i&&a>o||a<t&&a<i&&a<o)return 0;var l=qtt(t,i,o,a,Sr);if(l===0)return 0;var h=M8(t,i,o);if(h>=0&&h<=1){for(var u=0,d=gr(t,i,o,h),c=0;c<l;c++){var f=Sr[c]===0||Sr[c]===1?.5:1,g=gr(n,e,r,Sr[c]);g<s||(Sr[c]<h?u+=d<t?f:-f:u+=o<d?f:-f)}return u}else{var f=Sr[0]===0||Sr[0]===1?.5:1,g=gr(n,e,r,Sr[0]);return g<s?0:o<t?f:-f}}function Dit(n,t,e,i,r,o,s,a){if(a-=t,a>e||a<-e)return 0;var l=Math.sqrt(e*e-a*a);Sr[0]=-l,Sr[1]=l;var h=Math.abs(i-r);if(h<1e-4)return 0;if(h>=Lu-1e-4){i=0,r=Lu;var u=o?1:-1;return s>=Sr[0]+n&&s<=Sr[1]+n?u:0}if(i>r){var d=i;i=r,r=d}i<0&&(i+=Lu,r+=Lu);for(var c=0,f=0;f<2;f++){var g=Sr[f];if(g+n>s){var p=Math.atan2(a,g),u=o?1:-1;p<0&&(p=Lu+p),(p>=i&&p<=r||p+Lu>=i&&p+Lu<=r)&&(p>Math.PI/2&&p<Math.PI*1.5&&(u=-u),c+=u)}}return c}function n9(n,t,e,i,r){for(var o=n.data,s=n.len(),a=0,l=0,h=0,u=0,d=0,c,f,g=0;g<s;){var p=o[g++],v=g===1;switch(p===ih.M&&g>1&&(e||(a+=Eu(l,h,u,d,i,r))),v&&(l=o[g],h=o[g+1],u=l,d=h),p){case ih.M:u=o[g++],d=o[g++],l=u,h=d;break;case ih.L:if(e){if(Fc(l,h,o[g],o[g+1],t,i,r))return!0}else a+=Eu(l,h,o[g],o[g+1],i,r)||0;l=o[g++],h=o[g++];break;case ih.C:if(e){if(Mit(l,h,o[g++],o[g++],o[g++],o[g++],o[g],o[g+1],t,i,r))return!0}else a+=Lit(l,h,o[g++],o[g++],o[g++],o[g++],o[g],o[g+1],i,r)||0;l=o[g++],h=o[g++];break;case ih.Q:if(e){if(Rit(l,h,o[g++],o[g++],o[g],o[g+1],t,i,r))return!0}else a+=Oit(l,h,o[g++],o[g++],o[g],o[g+1],i,r)||0;l=o[g++],h=o[g++];break;case ih.A:var m=o[g++],y=o[g++],b=o[g++],_=o[g++],w=o[g++],C=o[g++];g+=1;var x=!!(1-o[g++]);c=Math.cos(w)*b+m,f=Math.sin(w)*_+y,v?(u=c,d=f):a+=Eu(l,h,c,f,i,r);var S=(i-m)*_/b+m;if(e){if(Bit(m,y,_,w,w+C,x,t,S,r))return!0}else a+=Dit(m,y,_,w,w+C,x,S,r);l=Math.cos(w+C)*b+m,h=Math.sin(w+C)*_+y;break;case ih.R:u=l=o[g++],d=h=o[g++];var A=o[g++],T=o[g++];if(c=u+A,f=d+T,e){if(Fc(u,d,c,d,t,i,r)||Fc(c,d,c,f,t,i,r)||Fc(c,f,u,f,t,i,r)||Fc(u,f,u,d,t,i,r))return!0}else a+=Eu(c,d,c,f,i,r),a+=Eu(u,f,u,d,i,r);break;case ih.Z:if(e){if(Fc(l,h,u,d,t,i,r))return!0}else a+=Eu(l,h,u,d,i,r);l=u,h=d;break}}return!e&&!kit(h,d)&&(a+=Eu(l,h,u,d,i,r)||0),a!==0}function Iit(n,t,e){return n9(n,0,!1,t,e)}function Hit(n,t,e,i){return n9(n,t,!0,e,i)}var r9=Gt({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},Hd),Fit={style:Gt({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},rS.style)},ZT=$0.concat(["invisible","culling","z","z2","zlevel","parent"]),Ee=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.update=function(){var e=this;n.prototype.update.call(this);var i=this.style;if(i.decal){var r=this._decalEl=this._decalEl||new t;r.buildPath===t.prototype.buildPath&&(r.buildPath=function(l){e.buildPath(l,e.shape)}),r.silent=!0;var o=r.style;for(var s in i)o[s]!==i[s]&&(o[s]=i[s]);o.fill=i.fill?i.decal:null,o.decal=null,o.shadowColor=null,i.strokeFirst&&(o.stroke=null);for(var a=0;a<ZT.length;++a)r[ZT[a]]=this[ZT[a]];r.__dirty|=go}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(e){var i=yi(e);this.shape=this.getDefaultShape();var r=this.getDefaultStyle();r&&this.useStyle(r);for(var o=0;o<i.length;o++){var s=i[o],a=e[s];s==="style"?this.style?ft(this.style,a):this.useStyle(a):s==="shape"?ft(this.shape,a):n.prototype.attrKV.call(this,s,a)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var e=this.style.fill;if(e!=="none"){if(Pt(e)){var i=LC(e,0);return i>.5?X2:i>.2?_et:Y2}else if(e)return Y2}return X2},t.prototype.getInsideTextStroke=function(e){var i=this.style.fill;if(Pt(i)){var r=this.__zr,o=!!(r&&r.isDarkMode()),s=LC(e,0)<U2;if(o===s)return i}},t.prototype.buildPath=function(e,i,r){},t.prototype.pathUpdated=function(){this.__dirty&=~mf},t.prototype.getUpdatedPathProxy=function(e){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,e),this.path},t.prototype.createPathProxy=function(){this.path=new Vl(!1)},t.prototype.hasStroke=function(){var e=this.style,i=e.stroke;return!(i==null||i==="none"||!(e.lineWidth>0))},t.prototype.hasFill=function(){var e=this.style,i=e.fill;return i!=null&&i!=="none"},t.prototype.getBoundingRect=function(){var e=this._rect,i=this.style,r=!e;if(r){var o=!1;this.path||(o=!0,this.createPathProxy());var s=this.path;(o||this.__dirty&mf)&&(s.beginPath(),this.buildPath(s,this.shape,!1),this.pathUpdated()),e=s.getBoundingRect()}if(this._rect=e,this.hasStroke()&&this.path&&this.path.len()>0){var a=this._rectStroke||(this._rectStroke=e.clone());if(this.__dirty||r){a.copy(e);var l=i.strokeNoScale?this.getLineScale():1,h=i.lineWidth;if(!this.hasFill()){var u=this.strokeContainThreshold;h=Math.max(h,u??4)}l>1e-10&&(a.width+=h/l,a.height+=h/l,a.x-=h/l/2,a.y-=h/l/2)}return a}return e},t.prototype.contain=function(e,i){var r=this.transformCoordToLocal(e,i),o=this.getBoundingRect(),s=this.style;if(e=r[0],i=r[1],o.contain(e,i)){var a=this.path;if(this.hasStroke()){var l=s.lineWidth,h=s.strokeNoScale?this.getLineScale():1;if(h>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),Hit(a,l/h,e,i)))return!0}if(this.hasFill())return Iit(a,e,i)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=mf,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(e){return this.animate("shape",e)},t.prototype.updateDuringAnimation=function(e){e==="style"?this.dirtyStyle():e==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(e,i){e==="shape"?this.setShape(i):n.prototype.attrKV.call(this,e,i)},t.prototype.setShape=function(e,i){var r=this.shape;return r||(r=this.shape={}),typeof e=="string"?r[e]=i:ft(r,e),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&mf)},t.prototype.createStyle=function(e){return Jx(r9,e)},t.prototype._innerSaveToNormal=function(e){n.prototype._innerSaveToNormal.call(this,e);var i=this._normalState;e.shape&&!i.shape&&(i.shape=ft({},this.shape))},t.prototype._applyStateObj=function(e,i,r,o,s,a){n.prototype._applyStateObj.call(this,e,i,r,o,s,a);var l=!(i&&o),h;if(i&&i.shape?s?o?h=i.shape:(h=ft({},r.shape),ft(h,i.shape)):(h=ft({},o?this.shape:r.shape),ft(h,i.shape)):l&&(h=r.shape),h)if(s){this.shape=ft({},this.shape);for(var u={},d=yi(h),c=0;c<d.length;c++){var f=d[c];typeof h[f]=="object"?this.shape[f]=h[f]:u[f]=h[f]}this._transitionState(e,{shape:u},a)}else this.shape=h,this.dirtyShape()},t.prototype._mergeStates=function(e){for(var i=n.prototype._mergeStates.call(this,e),r,o=0;o<e.length;o++){var s=e[o];s.shape&&(r=r||{},this._mergeStyle(r,s.shape))}return r&&(i.shape=r),i},t.prototype.getAnimationStyleProps=function(){return Fit},t.prototype.isZeroArea=function(){return!1},t.extend=function(e){var i=function(o){ct(s,o);function s(a){var l=o.call(this,a)||this;return e.init&&e.init.call(l,a),l}return s.prototype.getDefaultStyle=function(){return ne(e.style)},s.prototype.getDefaultShape=function(){return ne(e.shape)},s}(t);for(var r in e)typeof e[r]=="function"&&(i.prototype[r]=e[r]);return i},t.initDefaultProps=function(){var e=t.prototype;e.type="path",e.strokeContainThreshold=5,e.segmentIgnoreThreshold=0,e.subPixelOptimize=!1,e.autoBatch=!1,e.__dirty=go|Bv|mf}(),t}(Sc),zit=Gt({strokeFirst:!0,font:Qd,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},r9),HC=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var e=this.style,i=e.stroke;return i!=null&&i!=="none"&&e.lineWidth>0},t.prototype.hasFill=function(){var e=this.style,i=e.fill;return i!=null&&i!=="none"},t.prototype.createStyle=function(e){return Jx(zit,e)},t.prototype.setBoundingRect=function(e){this._rect=e},t.prototype.getBoundingRect=function(){var e=this.style;if(!this._rect){var i=e.text;i!=null?i+="":i="";var r=ry(i,e.font,e.textAlign,e.textBaseline);if(r.x+=e.x||0,r.y+=e.y||0,this.hasStroke()){var o=e.lineWidth;r.x-=o/2,r.y-=o/2,r.width+=o,r.height+=o}this._rect=r}return this._rect},t.initDefaultProps=function(){var e=t.prototype;e.dirtyRectTolerance=10}(),t}(Sc);HC.prototype.type="tspan";var Nit=Gt({x:0,y:0},Hd),Wit={style:Gt({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},rS.style)};function Vit(n){return!!(n&&typeof n!="string"&&n.width&&n.height)}var du=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.createStyle=function(e){return Jx(Nit,e)},t.prototype._getSize=function(e){var i=this.style,r=i[e];if(r!=null)return r;var o=Vit(i.image)?i.image:this.__image;if(!o)return 0;var s=e==="width"?"height":"width",a=i[s];return a==null?o[e]:o[e]/o[s]*a},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return Wit},t.prototype.getBoundingRect=function(){var e=this.style;return this._rect||(this._rect=new Te(e.x||0,e.y||0,this.getWidth(),this.getHeight())),this._rect},t}(Sc);du.prototype.type="image";function Git(n,t){var e=t.x,i=t.y,r=t.width,o=t.height,s=t.r,a,l,h,u;r<0&&(e=e+r,r=-r),o<0&&(i=i+o,o=-o),typeof s=="number"?a=l=h=u=s:s instanceof Array?s.length===1?a=l=h=u=s[0]:s.length===2?(a=h=s[0],l=u=s[1]):s.length===3?(a=s[0],l=u=s[1],h=s[2]):(a=s[0],l=s[1],h=s[2],u=s[3]):a=l=h=u=0;var d;a+l>r&&(d=a+l,a*=r/d,l*=r/d),h+u>r&&(d=h+u,h*=r/d,u*=r/d),l+h>o&&(d=l+h,l*=o/d,h*=o/d),a+u>o&&(d=a+u,a*=o/d,u*=o/d),n.moveTo(e+a,i),n.lineTo(e+r-l,i),l!==0&&n.arc(e+r-l,i+l,l,-Math.PI/2,0),n.lineTo(e+r,i+o-h),h!==0&&n.arc(e+r-h,i+o-h,h,0,Math.PI/2),n.lineTo(e+u,i+o),u!==0&&n.arc(e+u,i+o-u,u,Math.PI/2,Math.PI),n.lineTo(e,i+a),a!==0&&n.arc(e+a,i+a,a,Math.PI,Math.PI*1.5)}var Tf=Math.round;function o9(n,t,e){if(t){var i=t.x1,r=t.x2,o=t.y1,s=t.y2;n.x1=i,n.x2=r,n.y1=o,n.y2=s;var a=e&&e.lineWidth;return a&&(Tf(i*2)===Tf(r*2)&&(n.x1=n.x2=bd(i,a,!0)),Tf(o*2)===Tf(s*2)&&(n.y1=n.y2=bd(o,a,!0))),n}}function s9(n,t,e){if(t){var i=t.x,r=t.y,o=t.width,s=t.height;n.x=i,n.y=r,n.width=o,n.height=s;var a=e&&e.lineWidth;return a&&(n.x=bd(i,a,!0),n.y=bd(r,a,!0),n.width=Math.max(bd(i+o,a,!1)-n.x,o===0?0:1),n.height=Math.max(bd(r+s,a,!1)-n.y,s===0?0:1)),n}}function bd(n,t,e){if(!t)return n;var i=Tf(n*2);return(i+Tf(t))%2===0?i/2:(i+(e?1:-1))/2}var $it=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0}return n}(),jit={},ci=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new $it},t.prototype.buildPath=function(e,i){var r,o,s,a;if(this.subPixelOptimize){var l=s9(jit,i,this.style);r=l.x,o=l.y,s=l.width,a=l.height,l.r=i.r,i=l}else r=i.x,o=i.y,s=i.width,a=i.height;i.r?Git(e,i):e.rect(r,o,s,a)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(Ee);ci.prototype.type="rect";var zI={fill:"#000"},NI=2,Uit={style:Gt({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},rS.style)},Vi=function(n){ct(t,n);function t(e){var i=n.call(this)||this;return i.type="text",i._children=[],i._defaultStyle=zI,i.attr(e),i}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){n.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var e=0;e<this._children.length;e++){var i=this._children[e];i.zlevel=this.zlevel,i.z=this.z,i.z2=this.z2,i.culling=this.culling,i.cursor=this.cursor,i.invisible=this.invisible}},t.prototype.updateTransform=function(){var e=this.innerTransformable;e?(e.updateTransform(),e.transform&&(this.transform=e.transform)):n.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(e){var i=this.innerTransformable;return i?i.getLocalTransform(e):n.prototype.getLocalTransform.call(this,e)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),n.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,Zit(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(e){n.prototype.addSelfToZr.call(this,e);for(var i=0;i<this._children.length;i++)this._children[i].__zr=e},t.prototype.removeSelfFromZr=function(e){n.prototype.removeSelfFromZr.call(this,e);for(var i=0;i<this._children.length;i++)this._children[i].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var e=new Te(0,0,0,0),i=this._children,r=[],o=null,s=0;s<i.length;s++){var a=i[s],l=a.getBoundingRect(),h=a.getLocalTransform(r);h?(e.copy(l),e.applyTransform(h),o=o||e.clone(),o.union(e)):(o=o||l.clone(),o.union(l))}this._rect=o||e}return this._rect},t.prototype.setDefaultTextStyle=function(e){this._defaultStyle=e||zI},t.prototype.setTextContent=function(e){},t.prototype._mergeStyle=function(e,i){if(!i)return e;var r=i.rich,o=e.rich||r&&{};return ft(e,i),r&&o?(this._mergeRich(o,r),e.rich=o):o&&(e.rich=o),e},t.prototype._mergeRich=function(e,i){for(var r=yi(i),o=0;o<r.length;o++){var s=r[o];e[s]=e[s]||{},ft(e[s],i[s])}},t.prototype.getAnimationStyleProps=function(){return Uit},t.prototype._getOrCreateChild=function(e){var i=this._children[this._childCursor];return(!i||!(i instanceof e))&&(i=new e),this._children[this._childCursor++]=i,i.__zr=this.__zr,i.parent=this,i},t.prototype._updatePlainTexts=function(){var e=this.style,i=e.font||Qd,r=e.padding,o=XI(e),s=pit(o,e),a=JT(e),l=!!e.backgroundColor,h=s.outerHeight,u=s.outerWidth,d=s.contentWidth,c=s.lines,f=s.lineHeight,g=this._defaultStyle;this.isTruncated=!!s.isTruncated;var p=e.x||0,v=e.y||0,m=e.align||g.align||"left",y=e.verticalAlign||g.verticalAlign||"top",b=p,_=yf(v,s.contentHeight,y);if(a||r){var w=kv(p,u,m),C=yf(v,h,y);a&&this._renderBackground(e,e,w,C,u,h)}_+=f/2,r&&(b=UI(p,m,r),y==="top"?_+=r[0]:y==="bottom"&&(_-=r[2]));for(var x=0,S=!1,A=jI("fill"in e?e.fill:(S=!0,g.fill)),T=$I("stroke"in e?e.stroke:!l&&(!g.autoStroke||S)?(x=NI,g.stroke):null),M=e.textShadowBlur>0,R=e.width!=null&&(e.overflow==="truncate"||e.overflow==="break"||e.overflow==="breakAll"),E=s.calculatedLineHeight,P=0;P<c.length;P++){var B=this._getOrCreateChild(HC),k=B.createStyle();B.useStyle(k),k.text=c[P],k.x=b,k.y=_,k.textAlign=m,k.textBaseline="middle",k.opacity=e.opacity,k.strokeFirst=!0,M&&(k.shadowBlur=e.textShadowBlur||0,k.shadowColor=e.textShadowColor||"transparent",k.shadowOffsetX=e.textShadowOffsetX||0,k.shadowOffsetY=e.textShadowOffsetY||0),k.stroke=T,k.fill=A,T&&(k.lineWidth=e.lineWidth||x,k.lineDash=e.lineDash,k.lineDashOffset=e.lineDashOffset||0),k.font=i,VI(k,e),_+=f,R&&B.setBoundingRect(new Te(kv(k.x,d,k.textAlign),yf(k.y,E,k.textBaseline),d,E))}},t.prototype._updateRichTexts=function(){var e=this.style,i=XI(e),r=yit(i,e),o=r.width,s=r.outerWidth,a=r.outerHeight,l=e.padding,h=e.x||0,u=e.y||0,d=this._defaultStyle,c=e.align||d.align,f=e.verticalAlign||d.verticalAlign;this.isTruncated=!!r.isTruncated;var g=kv(h,s,c),p=yf(u,a,f),v=g,m=p;l&&(v+=l[3],m+=l[0]);var y=v+o;JT(e)&&this._renderBackground(e,e,g,p,s,a);for(var b=!!e.backgroundColor,_=0;_<r.lines.length;_++){for(var w=r.lines[_],C=w.tokens,x=C.length,S=w.lineHeight,A=w.width,T=0,M=v,R=y,E=x-1,P=void 0;T<x&&(P=C[T],!P.align||P.align==="left");)this._placeToken(P,e,S,m,M,"left",b),A-=P.width,M+=P.width,T++;for(;E>=0&&(P=C[E],P.align==="right");)this._placeToken(P,e,S,m,R,"right",b),A-=P.width,R-=P.width,E--;for(M+=(o-(M-v)-(y-R)-A)/2;T<=E;)P=C[T],this._placeToken(P,e,S,m,M+P.width/2,"center",b),M+=P.width,T++;m+=S}},t.prototype._placeToken=function(e,i,r,o,s,a,l){var h=i.rich[e.styleName]||{};h.text=e.text;var u=e.verticalAlign,d=o+r/2;u==="top"?d=o+e.height/2:u==="bottom"&&(d=o+r-e.height/2);var c=!e.isLineHolder&&JT(h);c&&this._renderBackground(h,i,a==="right"?s-e.width:a==="center"?s-e.width/2:s,d-e.height/2,e.width,e.height);var f=!!h.backgroundColor,g=e.textPadding;g&&(s=UI(s,a,g),d-=e.height/2-g[0]-e.innerHeight/2);var p=this._getOrCreateChild(HC),v=p.createStyle();p.useStyle(v);var m=this._defaultStyle,y=!1,b=0,_=jI("fill"in h?h.fill:"fill"in i?i.fill:(y=!0,m.fill)),w=$I("stroke"in h?h.stroke:"stroke"in i?i.stroke:!f&&!l&&(!m.autoStroke||y)?(b=NI,m.stroke):null),C=h.textShadowBlur>0||i.textShadowBlur>0;v.text=e.text,v.x=s,v.y=d,C&&(v.shadowBlur=h.textShadowBlur||i.textShadowBlur||0,v.shadowColor=h.textShadowColor||i.textShadowColor||"transparent",v.shadowOffsetX=h.textShadowOffsetX||i.textShadowOffsetX||0,v.shadowOffsetY=h.textShadowOffsetY||i.textShadowOffsetY||0),v.textAlign=a,v.textBaseline="middle",v.font=e.font||Qd,v.opacity=e0(h.opacity,i.opacity,1),VI(v,h),w&&(v.lineWidth=e0(h.lineWidth,i.lineWidth,b),v.lineDash=ve(h.lineDash,i.lineDash),v.lineDashOffset=i.lineDashOffset||0,v.stroke=w),_&&(v.fill=_);var x=e.contentWidth,S=e.contentHeight;p.setBoundingRect(new Te(kv(v.x,x,v.textAlign),yf(v.y,S,v.textBaseline),x,S))},t.prototype._renderBackground=function(e,i,r,o,s,a){var l=e.backgroundColor,h=e.borderWidth,u=e.borderColor,d=l&&l.image,c=l&&!d,f=e.borderRadius,g=this,p,v;if(c||e.lineHeight||h&&u){p=this._getOrCreateChild(ci),p.useStyle(p.createStyle()),p.style.fill=null;var m=p.shape;m.x=r,m.y=o,m.width=s,m.height=a,m.r=f,p.dirtyShape()}if(c){var y=p.style;y.fill=l||null,y.fillOpacity=ve(e.fillOpacity,1)}else if(d){v=this._getOrCreateChild(du),v.onload=function(){g.dirtyStyle()};var b=v.style;b.image=l.image,b.x=r,b.y=o,b.width=s,b.height=a}if(h&&u){var y=p.style;y.lineWidth=h,y.stroke=u,y.strokeOpacity=ve(e.strokeOpacity,1),y.lineDash=e.borderDash,y.lineDashOffset=e.borderDashOffset||0,p.strokeContainThreshold=0,p.hasFill()&&p.hasStroke()&&(y.strokeFirst=!0,y.lineWidth*=2)}var _=(p||v).style;_.shadowBlur=e.shadowBlur||0,_.shadowColor=e.shadowColor||"transparent",_.shadowOffsetX=e.shadowOffsetX||0,_.shadowOffsetY=e.shadowOffsetY||0,_.opacity=e0(e.opacity,i.opacity,1)},t.makeFont=function(e){var i="";return qit(e)&&(i=[e.fontStyle,e.fontWeight,Kit(e.fontSize),e.fontFamily||"sans-serif"].join(" ")),i&&Ba(i)||e.textFont||e.font},t}(Sc),Xit={left:!0,right:1,center:1},Yit={top:1,bottom:1,middle:1},WI=["fontStyle","fontWeight","fontSize","fontFamily"];function Kit(n){return typeof n=="string"&&(n.indexOf("px")!==-1||n.indexOf("rem")!==-1||n.indexOf("em")!==-1)?n:isNaN(+n)?CE+"px":n+"px"}function VI(n,t){for(var e=0;e<WI.length;e++){var i=WI[e],r=t[i];r!=null&&(n[i]=r)}}function qit(n){return n.fontSize!=null||n.fontFamily||n.fontWeight}function Zit(n){return GI(n),N(n.rich,GI),n}function GI(n){if(n){n.font=Vi.makeFont(n);var t=n.align;t==="middle"&&(t="center"),n.align=t==null||Xit[t]?t:"left";var e=n.verticalAlign;e==="center"&&(e="middle"),n.verticalAlign=e==null||Yit[e]?e:"top";var i=n.padding;i&&(n.padding=TE(n.padding))}}function $I(n,t){return n==null||t<=0||n==="transparent"||n==="none"?null:n.image||n.colorStops?"#000":n}function jI(n){return n==null||n==="none"?null:n.image||n.colorStops?"#000":n}function UI(n,t,e){return t==="right"?n-e[1]:t==="center"?n+e[3]/2-e[1]/2:n+e[3]}function XI(n){var t=n.text;return t!=null&&(t+=""),t}function JT(n){return!!(n.backgroundColor||n.lineHeight||n.borderWidth&&n.borderColor)}var pe=Ke(),Jit=function(n,t,e,i){if(i){var r=pe(i);r.dataIndex=e,r.dataType=t,r.seriesIndex=n,r.ssrType="chart",i.type==="group"&&i.traverse(function(o){var s=pe(o);s.seriesIndex=n,s.dataIndex=e,s.dataType=t,s.ssrType="chart"})}},YI=1,KI={},a9=Ke(),DE=Ke(),IE=0,oS=1,sS=2,wo=["emphasis","blur","select"],X0=["normal","emphasis","blur","select"],ay=10,Qit=9,Fd="highlight",Y_="downplay",a0="select",K_="unselect",l0="toggleSelect";function zc(n){return n!=null&&n!=="none"}function aS(n,t,e){n.onHoverStateChange&&(n.hoverState||0)!==e&&n.onHoverStateChange(t),n.hoverState=e}function l9(n){aS(n,"emphasis",sS)}function h9(n){n.hoverState===sS&&aS(n,"normal",IE)}function HE(n){aS(n,"blur",oS)}function u9(n){n.hoverState===oS&&aS(n,"normal",IE)}function tnt(n){n.selected=!0}function ent(n){n.selected=!1}function qI(n,t,e){t(n,e)}function Zl(n,t,e){qI(n,t,e),n.isGroup&&n.traverse(function(i){qI(i,t,e)})}function ZI(n,t){switch(t){case"emphasis":n.hoverState=sS;break;case"normal":n.hoverState=IE;break;case"blur":n.hoverState=oS;break;case"select":n.selected=!0}}function int(n,t,e,i){for(var r=n.style,o={},s=0;s<t.length;s++){var a=t[s],l=r[a];o[a]=l??(i&&i[a])}for(var s=0;s<n.animators.length;s++){var h=n.animators[s];h.__fromStateTransition&&h.__fromStateTransition.indexOf(e)<0&&h.targetName==="style"&&h.saveTo(o,t)}return o}function nnt(n,t,e,i){var r=e&&_e(e,"select")>=0,o=!1;if(n instanceof Ee){var s=a9(n),a=r&&s.selectFill||s.normalFill,l=r&&s.selectStroke||s.normalStroke;if(zc(a)||zc(l)){i=i||{};var h=i.style||{};h.fill==="inherit"?(o=!0,i=ft({},i),h=ft({},h),h.fill=a):!zc(h.fill)&&zc(a)?(o=!0,i=ft({},i),h=ft({},h),h.fill=pI(a)):!zc(h.stroke)&&zc(l)&&(o||(i=ft({},i),h=ft({},h)),h.stroke=pI(l)),i.style=h}}if(i&&i.z2==null){o||(i=ft({},i));var u=n.z2EmphasisLift;i.z2=n.z2+(u??ay)}return i}function rnt(n,t,e){if(e&&e.z2==null){e=ft({},e);var i=n.z2SelectLift;e.z2=n.z2+(i??Qit)}return e}function ont(n,t,e){var i=_e(n.currentStates,t)>=0,r=n.style.opacity,o=i?null:int(n,["opacity"],t,{opacity:1});e=e||{};var s=e.style||{};return s.opacity==null&&(e=ft({},e),s=ft({opacity:i?r:o.opacity*.1},s),e.style=s),e}function QT(n,t){var e=this.states[n];if(this.style){if(n==="emphasis")return nnt(this,n,t,e);if(n==="blur")return ont(this,n,e);if(n==="select")return rnt(this,n,e)}return e}function Q2(n){n.stateProxy=QT;var t=n.getTextContent(),e=n.getTextGuideLine();t&&(t.stateProxy=QT),e&&(e.stateProxy=QT)}function JI(n,t){!g9(n,t)&&!n.__highByOuter&&Zl(n,l9)}function QI(n,t){!g9(n,t)&&!n.__highByOuter&&Zl(n,h9)}function bg(n,t){n.__highByOuter|=1<<(t||0),Zl(n,l9)}function _g(n,t){!(n.__highByOuter&=~(1<<(t||0)))&&Zl(n,h9)}function snt(n){Zl(n,HE)}function d9(n){Zl(n,u9)}function c9(n){Zl(n,tnt)}function f9(n){Zl(n,ent)}function g9(n,t){return n.__highDownSilentOnTouch&&t.zrByTouch}function p9(n){var t=n.getModel(),e=[],i=[];t.eachComponent(function(r,o){var s=DE(o),a=r==="series",l=a?n.getViewOfSeriesModel(o):n.getViewOfComponentModel(o);!a&&i.push(l),s.isBlured&&(l.group.traverse(function(h){u9(h)}),a&&e.push(o)),s.isBlured=!1}),N(i,function(r){r&&r.toggleBlurSeries&&r.toggleBlurSeries(e,!1,t)})}function tB(n,t,e,i){var r=i.getModel();e=e||"coordinateSystem";function o(h,u){for(var d=0;d<u.length;d++){var c=h.getItemGraphicEl(u[d]);c&&d9(c)}}if(n!=null&&!(!t||t==="none")){var s=r.getSeriesByIndex(n),a=s.coordinateSystem;a&&a.master&&(a=a.master);var l=[];r.eachSeries(function(h){var u=s===h,d=h.coordinateSystem;d&&d.master&&(d=d.master);var c=d&&a?d===a:u;if(!(e==="series"&&!u||e==="coordinateSystem"&&!c||t==="series"&&u)){var f=i.getViewOfSeriesModel(h);if(f.group.traverse(function(v){v.__highByOuter&&u&&t==="self"||HE(v)}),Yr(t))o(h.getData(),t);else if(Ht(t))for(var g=yi(t),p=0;p<g.length;p++)o(h.getData(g[p]),t[g[p]]);l.push(h),DE(h).isBlured=!0}}),r.eachComponent(function(h,u){if(h!=="series"){var d=i.getViewOfComponentModel(u);d&&d.toggleBlurSeries&&d.toggleBlurSeries(l,!0,r)}})}}function eB(n,t,e){if(!(n==null||t==null)){var i=e.getModel().getComponent(n,t);if(i){DE(i).isBlured=!0;var r=e.getViewOfComponentModel(i);!r||!r.focusBlurEnabled||r.group.traverse(function(o){HE(o)})}}}function ant(n,t,e){var i=n.seriesIndex,r=n.getData(t.dataType);if(r){var o=ec(r,t);o=(_t(o)?o[0]:o)||0;var s=r.getItemGraphicEl(o);if(!s)for(var a=r.count(),l=0;!s&&l<a;)s=r.getItemGraphicEl(l++);if(s){var h=pe(s);tB(i,h.focus,h.blurScope,e)}else{var u=n.get(["emphasis","focus"]),d=n.get(["emphasis","blurScope"]);u!=null&&tB(i,u,d,e)}}}function FE(n,t,e,i){var r={focusSelf:!1,dispatchers:null};if(n==null||n==="series"||t==null||e==null)return r;var o=i.getModel().getComponent(n,t);if(!o)return r;var s=i.getViewOfComponentModel(o);if(!s||!s.findHighDownDispatchers)return r;for(var a=s.findHighDownDispatchers(e),l,h=0;h<a.length;h++)if(pe(a[h]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:a}}function lnt(n,t,e){var i=pe(n),r=FE(i.componentMainType,i.componentIndex,i.componentHighDownName,e),o=r.dispatchers,s=r.focusSelf;o?(s&&eB(i.componentMainType,i.componentIndex,e),N(o,function(a){return JI(a,t)})):(tB(i.seriesIndex,i.focus,i.blurScope,e),i.focus==="self"&&eB(i.componentMainType,i.componentIndex,e),JI(n,t))}function hnt(n,t,e){p9(e);var i=pe(n),r=FE(i.componentMainType,i.componentIndex,i.componentHighDownName,e).dispatchers;r?N(r,function(o){return QI(o,t)}):QI(n,t)}function unt(n,t,e){if(nB(t)){var i=t.dataType,r=n.getData(i),o=ec(r,t);_t(o)||(o=[o]),n[t.type===l0?"toggleSelect":t.type===a0?"select":"unselect"](o,i)}}function tH(n){var t=n.getAllData();N(t,function(e){var i=e.data,r=e.type;i.eachItemGraphicEl(function(o,s){n.isSelected(s,r)?c9(o):f9(o)})})}function dnt(n){var t=[];return n.eachSeries(function(e){var i=e.getAllData();N(i,function(r){r.data;var o=r.type,s=e.getSelectedDataIndices();if(s.length>0){var a={dataIndex:s,seriesIndex:e.seriesIndex};o!=null&&(a.dataType=o),t.push(a)}})}),t}function FC(n,t,e){Mf(n,!0),Zl(n,Q2),iB(n,t,e)}function cnt(n){Mf(n,!1)}function ic(n,t,e,i){i?cnt(n):FC(n,t,e)}function iB(n,t,e){var i=pe(n);t!=null?(i.focus=t,i.blurScope=e):i.focus&&(i.focus=null)}var eH=["emphasis","blur","select"],fnt={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function zC(n,t,e,i){e=e||"itemStyle";for(var r=0;r<eH.length;r++){var o=eH[r],s=t.getModel([o,e]),a=n.ensureState(o);a.style=s[fnt[e]]()}}function Mf(n,t){var e=t===!1,i=n;n.highDownSilentOnTouch&&(i.__highDownSilentOnTouch=n.highDownSilentOnTouch),(!e||i.__highDownDispatcher)&&(i.__highByOuter=i.__highByOuter||0,i.__highDownDispatcher=!e)}function Y0(n){return!!(n&&n.__highDownDispatcher)}function gnt(n){var t=KI[n];return t==null&&YI<=32&&(t=KI[n]=YI++),t}function nB(n){var t=n.type;return t===a0||t===K_||t===l0}function iH(n){var t=n.type;return t===Fd||t===Y_}function pnt(n){var t=a9(n);t.normalFill=n.style.fill,t.normalStroke=n.style.stroke;var e=n.states.select||{};t.selectFill=e.style&&e.style.fill||null,t.selectStroke=e.style&&e.style.stroke||null}var Nc=Vl.CMD,vnt=[[],[],[]],nH=Math.sqrt,mnt=Math.atan2;function v9(n,t){if(t){var e=n.data,i=n.len(),r,o,s,a,l,h,u=Nc.M,d=Nc.C,c=Nc.L,f=Nc.R,g=Nc.A,p=Nc.Q;for(s=0,a=0;s<i;){switch(r=e[s++],a=s,o=0,r){case u:o=1;break;case c:o=1;break;case d:o=3;break;case p:o=2;break;case g:var v=t[4],m=t[5],y=nH(t[0]*t[0]+t[1]*t[1]),b=nH(t[2]*t[2]+t[3]*t[3]),_=mnt(-t[1]/b,t[0]/y);e[s]*=y,e[s++]+=v,e[s]*=b,e[s++]+=m,e[s++]*=y,e[s++]*=b,e[s++]+=_,e[s++]+=_,s+=2,a=s;break;case f:h[0]=e[s++],h[1]=e[s++],hs(h,h,t),e[a++]=h[0],e[a++]=h[1],h[0]+=e[s++],h[1]+=e[s++],hs(h,h,t),e[a++]=h[0],e[a++]=h[1]}for(l=0;l<o;l++){var w=vnt[l];w[0]=e[s++],w[1]=e[s++],hs(w,w,t),e[a++]=w[0],e[a++]=w[1]}}n.increaseVersion()}}var tM=Math.sqrt,nb=Math.sin,rb=Math.cos,jp=Math.PI;function rH(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function rB(n,t){return(n[0]*t[0]+n[1]*t[1])/(rH(n)*rH(t))}function oH(n,t){return(n[0]*t[1]<n[1]*t[0]?-1:1)*Math.acos(rB(n,t))}function sH(n,t,e,i,r,o,s,a,l,h,u){var d=l*(jp/180),c=rb(d)*(n-e)/2+nb(d)*(t-i)/2,f=-1*nb(d)*(n-e)/2+rb(d)*(t-i)/2,g=c*c/(s*s)+f*f/(a*a);g>1&&(s*=tM(g),a*=tM(g));var p=(r===o?-1:1)*tM((s*s*(a*a)-s*s*(f*f)-a*a*(c*c))/(s*s*(f*f)+a*a*(c*c)))||0,v=p*s*f/a,m=p*-a*c/s,y=(n+e)/2+rb(d)*v-nb(d)*m,b=(t+i)/2+nb(d)*v+rb(d)*m,_=oH([1,0],[(c-v)/s,(f-m)/a]),w=[(c-v)/s,(f-m)/a],C=[(-1*c-v)/s,(-1*f-m)/a],x=oH(w,C);if(rB(w,C)<=-1&&(x=jp),rB(w,C)>=1&&(x=0),x<0){var S=Math.round(x/jp*1e6)/1e6;x=jp*2+S%2*jp}u.addData(h,y,b,s,a,_,x,d,o)}var ynt=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,bnt=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function _nt(n){var t=new Vl;if(!n)return t;var e=0,i=0,r=e,o=i,s,a=Vl.CMD,l=n.match(ynt);if(!l)return t;for(var h=0;h<l.length;h++){for(var u=l[h],d=u.charAt(0),c=void 0,f=u.match(bnt)||[],g=f.length,p=0;p<g;p++)f[p]=parseFloat(f[p]);for(var v=0;v<g;){var m=void 0,y=void 0,b=void 0,_=void 0,w=void 0,C=void 0,x=void 0,S=e,A=i,T=void 0,M=void 0;switch(d){case"l":e+=f[v++],i+=f[v++],c=a.L,t.addData(c,e,i);break;case"L":e=f[v++],i=f[v++],c=a.L,t.addData(c,e,i);break;case"m":e+=f[v++],i+=f[v++],c=a.M,t.addData(c,e,i),r=e,o=i,d="l";break;case"M":e=f[v++],i=f[v++],c=a.M,t.addData(c,e,i),r=e,o=i,d="L";break;case"h":e+=f[v++],c=a.L,t.addData(c,e,i);break;case"H":e=f[v++],c=a.L,t.addData(c,e,i);break;case"v":i+=f[v++],c=a.L,t.addData(c,e,i);break;case"V":i=f[v++],c=a.L,t.addData(c,e,i);break;case"C":c=a.C,t.addData(c,f[v++],f[v++],f[v++],f[v++],f[v++],f[v++]),e=f[v-2],i=f[v-1];break;case"c":c=a.C,t.addData(c,f[v++]+e,f[v++]+i,f[v++]+e,f[v++]+i,f[v++]+e,f[v++]+i),e+=f[v-2],i+=f[v-1];break;case"S":m=e,y=i,T=t.len(),M=t.data,s===a.C&&(m+=e-M[T-4],y+=i-M[T-3]),c=a.C,S=f[v++],A=f[v++],e=f[v++],i=f[v++],t.addData(c,m,y,S,A,e,i);break;case"s":m=e,y=i,T=t.len(),M=t.data,s===a.C&&(m+=e-M[T-4],y+=i-M[T-3]),c=a.C,S=e+f[v++],A=i+f[v++],e+=f[v++],i+=f[v++],t.addData(c,m,y,S,A,e,i);break;case"Q":S=f[v++],A=f[v++],e=f[v++],i=f[v++],c=a.Q,t.addData(c,S,A,e,i);break;case"q":S=f[v++]+e,A=f[v++]+i,e+=f[v++],i+=f[v++],c=a.Q,t.addData(c,S,A,e,i);break;case"T":m=e,y=i,T=t.len(),M=t.data,s===a.Q&&(m+=e-M[T-4],y+=i-M[T-3]),e=f[v++],i=f[v++],c=a.Q,t.addData(c,m,y,e,i);break;case"t":m=e,y=i,T=t.len(),M=t.data,s===a.Q&&(m+=e-M[T-4],y+=i-M[T-3]),e+=f[v++],i+=f[v++],c=a.Q,t.addData(c,m,y,e,i);break;case"A":b=f[v++],_=f[v++],w=f[v++],C=f[v++],x=f[v++],S=e,A=i,e=f[v++],i=f[v++],c=a.A,sH(S,A,e,i,C,x,b,_,w,c,t);break;case"a":b=f[v++],_=f[v++],w=f[v++],C=f[v++],x=f[v++],S=e,A=i,e+=f[v++],i+=f[v++],c=a.A,sH(S,A,e,i,C,x,b,_,w,c,t);break}}(d==="z"||d==="Z")&&(c=a.Z,t.addData(c),e=r,i=o),s=c}return t.toStatic(),t}var m9=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.applyTransform=function(e){},t}(Ee);function y9(n){return n.setData!=null}function b9(n,t){var e=_nt(n),i=ft({},t);return i.buildPath=function(r){if(y9(r)){r.setData(e.data);var o=r.getContext();o&&r.rebuildPath(o,1)}else{var o=r;e.rebuildPath(o,1)}},i.applyTransform=function(r){v9(e,r),this.dirtyShape()},i}function Cnt(n,t){return new m9(b9(n,t))}function wnt(n,t){var e=b9(n,t),i=function(r){ct(o,r);function o(s){var a=r.call(this,s)||this;return a.applyTransform=e.applyTransform,a.buildPath=e.buildPath,a}return o}(m9);return i}function xnt(n,t){for(var e=[],i=n.length,r=0;r<i;r++){var o=n[r];e.push(o.getUpdatedPathProxy(!0))}var s=new Ee(t);return s.createPathProxy(),s.buildPath=function(a){if(y9(a)){a.appendPath(e);var l=a.getContext();l&&a.rebuildPath(l,1)}},s}function zE(n,t){t=t||{};var e=new Ee;return n.shape&&e.setShape(n.shape),e.setStyle(n.style),t.bakeTransform?v9(e.path,n.getComputedTransform()):t.toLocal?e.setLocalTransform(n.getComputedTransform()):e.copyTransform(n),e.buildPath=n.buildPath,e.applyTransform=e.applyTransform,e.z=n.z,e.z2=n.z2,e.zlevel=n.zlevel,e}var Snt=function(){function n(){this.cx=0,this.cy=0,this.r=0}return n}(),ly=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new Snt},t.prototype.buildPath=function(e,i){e.moveTo(i.cx+i.r,i.cy),e.arc(i.cx,i.cy,i.r,0,Math.PI*2)},t}(Ee);ly.prototype.type="circle";var Ant=function(){function n(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return n}(),NE=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new Ant},t.prototype.buildPath=function(e,i){var r=.5522848,o=i.cx,s=i.cy,a=i.rx,l=i.ry,h=a*r,u=l*r;e.moveTo(o-a,s),e.bezierCurveTo(o-a,s-u,o-h,s-l,o,s-l),e.bezierCurveTo(o+h,s-l,o+a,s-u,o+a,s),e.bezierCurveTo(o+a,s+u,o+h,s+l,o,s+l),e.bezierCurveTo(o-h,s+l,o-a,s+u,o-a,s),e.closePath()},t}(Ee);NE.prototype.type="ellipse";var _9=Math.PI,eM=_9*2,Ou=Math.sin,Wc=Math.cos,Tnt=Math.acos,or=Math.atan2,aH=Math.abs,h0=Math.sqrt,Lv=Math.max,fa=Math.min,As=1e-4;function Mnt(n,t,e,i,r,o,s,a){var l=e-n,h=i-t,u=s-r,d=a-o,c=d*l-u*h;if(!(c*c<As))return c=(u*(t-o)-d*(n-r))/c,[n+c*l,t+c*h]}function ob(n,t,e,i,r,o,s){var a=n-e,l=t-i,h=(s?o:-o)/h0(a*a+l*l),u=h*l,d=-h*a,c=n+u,f=t+d,g=e+u,p=i+d,v=(c+g)/2,m=(f+p)/2,y=g-c,b=p-f,_=y*y+b*b,w=r-o,C=c*p-g*f,x=(b<0?-1:1)*h0(Lv(0,w*w*_-C*C)),S=(C*b-y*x)/_,A=(-C*y-b*x)/_,T=(C*b+y*x)/_,M=(-C*y+b*x)/_,R=S-v,E=A-m,P=T-v,B=M-m;return R*R+E*E>P*P+B*B&&(S=T,A=M),{cx:S,cy:A,x0:-u,y0:-d,x1:S*(r/w-1),y1:A*(r/w-1)}}function Rnt(n){var t;if(_t(n)){var e=n.length;if(!e)return n;e===1?t=[n[0],n[0],0,0]:e===2?t=[n[0],n[0],n[1],n[1]]:e===3?t=n.concat(n[2]):t=n}else t=[n,n,n,n];return t}function Bnt(n,t){var e,i=Lv(t.r,0),r=Lv(t.r0||0,0),o=i>0,s=r>0;if(!(!o&&!s)){if(o||(i=r,r=0),r>i){var a=i;i=r,r=a}var l=t.startAngle,h=t.endAngle;if(!(isNaN(l)||isNaN(h))){var u=t.cx,d=t.cy,c=!!t.clockwise,f=aH(h-l),g=f>eM&&f%eM;if(g>As&&(f=g),!(i>As))n.moveTo(u,d);else if(f>eM-As)n.moveTo(u+i*Wc(l),d+i*Ou(l)),n.arc(u,d,i,l,h,!c),r>As&&(n.moveTo(u+r*Wc(h),d+r*Ou(h)),n.arc(u,d,r,h,l,c));else{var p=void 0,v=void 0,m=void 0,y=void 0,b=void 0,_=void 0,w=void 0,C=void 0,x=void 0,S=void 0,A=void 0,T=void 0,M=void 0,R=void 0,E=void 0,P=void 0,B=i*Wc(l),k=i*Ou(l),L=r*Wc(h),O=r*Ou(h),D=f>As;if(D){var I=t.cornerRadius;I&&(e=Rnt(I),p=e[0],v=e[1],m=e[2],y=e[3]);var H=aH(i-r)/2;if(b=fa(H,m),_=fa(H,y),w=fa(H,p),C=fa(H,v),A=x=Lv(b,_),T=S=Lv(w,C),(x>As||S>As)&&(M=i*Wc(h),R=i*Ou(h),E=r*Wc(l),P=r*Ou(l),f<_9)){var F=Mnt(B,k,E,P,M,R,L,O);if(F){var G=B-F[0],j=k-F[1],W=M-F[0],K=R-F[1],J=1/Ou(Tnt((G*W+j*K)/(h0(G*G+j*j)*h0(W*W+K*K)))/2),q=h0(F[0]*F[0]+F[1]*F[1]);A=fa(x,(i-q)/(J+1)),T=fa(S,(r-q)/(J-1))}}}if(!D)n.moveTo(u+B,d+k);else if(A>As){var X=fa(m,A),it=fa(y,A),Z=ob(E,P,B,k,i,X,c),et=ob(M,R,L,O,i,it,c);n.moveTo(u+Z.cx+Z.x0,d+Z.cy+Z.y0),A<x&&X===it?n.arc(u+Z.cx,d+Z.cy,A,or(Z.y0,Z.x0),or(et.y0,et.x0),!c):(X>0&&n.arc(u+Z.cx,d+Z.cy,X,or(Z.y0,Z.x0),or(Z.y1,Z.x1),!c),n.arc(u,d,i,or(Z.cy+Z.y1,Z.cx+Z.x1),or(et.cy+et.y1,et.cx+et.x1),!c),it>0&&n.arc(u+et.cx,d+et.cy,it,or(et.y1,et.x1),or(et.y0,et.x0),!c))}else n.moveTo(u+B,d+k),n.arc(u,d,i,l,h,!c);if(!(r>As)||!D)n.lineTo(u+L,d+O);else if(T>As){var X=fa(p,T),it=fa(v,T),Z=ob(L,O,M,R,r,-it,c),et=ob(B,k,E,P,r,-X,c);n.lineTo(u+Z.cx+Z.x0,d+Z.cy+Z.y0),T<S&&X===it?n.arc(u+Z.cx,d+Z.cy,T,or(Z.y0,Z.x0),or(et.y0,et.x0),!c):(it>0&&n.arc(u+Z.cx,d+Z.cy,it,or(Z.y0,Z.x0),or(Z.y1,Z.x1),!c),n.arc(u,d,r,or(Z.cy+Z.y1,Z.cx+Z.x1),or(et.cy+et.y1,et.cx+et.x1),c),X>0&&n.arc(u+et.cx,d+et.cy,X,or(et.y1,et.x1),or(et.y0,et.x0),!c))}else n.lineTo(u+L,d+O),n.arc(u,d,r,h,l,c)}n.closePath()}}}var Pnt=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return n}(),xo=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new Pnt},t.prototype.buildPath=function(e,i){Bnt(e,i)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(Ee);xo.prototype.type="sector";var knt=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return n}(),lS=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new knt},t.prototype.buildPath=function(e,i){var r=i.cx,o=i.cy,s=Math.PI*2;e.moveTo(r+i.r,o),e.arc(r,o,i.r,0,s,!1),e.moveTo(r+i.r0,o),e.arc(r,o,i.r0,0,s,!0)},t}(Ee);lS.prototype.type="ring";function Ent(n,t,e,i){var r=[],o=[],s=[],a=[],l,h,u,d;if(i){u=[1/0,1/0],d=[-1/0,-1/0];for(var c=0,f=n.length;c<f;c++)xf(u,u,n[c]),Sf(d,d,n[c]);xf(u,u,i[0]),Sf(d,d,i[1])}for(var c=0,f=n.length;c<f;c++){var g=n[c];if(e)l=n[c?c-1:f-1],h=n[(c+1)%f];else if(c===0||c===f-1){r.push(_tt(n[c]));continue}else l=n[c-1],h=n[c+1];Ctt(o,h,l),bT(o,o,t);var p=E2(g,l),v=E2(g,h),m=p+v;m!==0&&(p/=m,v/=m),bT(s,o,-p),bT(a,o,v);var y=QD([],g,s),b=QD([],g,a);i&&(Sf(y,y,u),xf(y,y,d),Sf(b,b,u),xf(b,b,d)),r.push(y),r.push(b)}return e&&r.push(r.shift()),r}function C9(n,t,e){var i=t.smooth,r=t.points;if(r&&r.length>=2){if(i){var o=Ent(r,i,e,t.smoothConstraint);n.moveTo(r[0][0],r[0][1]);for(var s=r.length,a=0;a<(e?s:s-1);a++){var l=o[a*2],h=o[a*2+1],u=r[(a+1)%s];n.bezierCurveTo(l[0],l[1],h[0],h[1],u[0],u[1])}}else{n.moveTo(r[0][0],r[0][1]);for(var a=1,d=r.length;a<d;a++)n.lineTo(r[a][0],r[a][1])}e&&n.closePath()}}var Lnt=function(){function n(){this.points=null,this.smooth=0,this.smoothConstraint=null}return n}(),Ac=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultShape=function(){return new Lnt},t.prototype.buildPath=function(e,i){C9(e,i,!0)},t}(Ee);Ac.prototype.type="polygon";var Ont=function(){function n(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return n}(),Tc=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Ont},t.prototype.buildPath=function(e,i){C9(e,i,!1)},t}(Ee);Tc.prototype.type="polyline";var Dnt={},Int=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}(),ns=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Int},t.prototype.buildPath=function(e,i){var r,o,s,a;if(this.subPixelOptimize){var l=o9(Dnt,i,this.style);r=l.x1,o=l.y1,s=l.x2,a=l.y2}else r=i.x1,o=i.y1,s=i.x2,a=i.y2;var h=i.percent;h!==0&&(e.moveTo(r,o),h<1&&(s=r*(1-h)+s*h,a=o*(1-h)+a*h),e.lineTo(s,a))},t.prototype.pointAt=function(e){var i=this.shape;return[i.x1*(1-e)+i.x2*e,i.y1*(1-e)+i.y2*e]},t}(Ee);ns.prototype.type="line";var Er=[],Hnt=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return n}();function lH(n,t,e){var i=n.cpx2,r=n.cpy2;return i!=null||r!=null?[(e?dI:Bn)(n.x1,n.cpx1,n.cpx2,n.x2,t),(e?dI:Bn)(n.y1,n.cpy1,n.cpy2,n.y2,t)]:[(e?cI:gr)(n.x1,n.cpx1,n.x2,t),(e?cI:gr)(n.y1,n.cpy1,n.y2,t)]}var WE=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Hnt},t.prototype.buildPath=function(e,i){var r=i.x1,o=i.y1,s=i.x2,a=i.y2,l=i.cpx1,h=i.cpy1,u=i.cpx2,d=i.cpy2,c=i.percent;c!==0&&(e.moveTo(r,o),u==null||d==null?(c<1&&(EC(r,l,s,c,Er),l=Er[1],s=Er[2],EC(o,h,a,c,Er),h=Er[1],a=Er[2]),e.quadraticCurveTo(l,h,s,a)):(c<1&&(Xh(r,l,u,s,c,Er),l=Er[1],u=Er[2],s=Er[3],Xh(o,h,d,a,c,Er),h=Er[1],d=Er[2],a=Er[3]),e.bezierCurveTo(l,h,u,d,s,a)))},t.prototype.pointAt=function(e){return lH(this.shape,e,!1)},t.prototype.tangentAt=function(e){var i=lH(this.shape,e,!0);return Stt(i,i)},t}(Ee);WE.prototype.type="bezier-curve";var Fnt=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),hS=function(n){ct(t,n);function t(e){return n.call(this,e)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Fnt},t.prototype.buildPath=function(e,i){var r=i.cx,o=i.cy,s=Math.max(i.r,0),a=i.startAngle,l=i.endAngle,h=i.clockwise,u=Math.cos(a),d=Math.sin(a);e.moveTo(u*s+r,d*s+o),e.arc(r,o,s,a,l,!h)},t}(Ee);hS.prototype.type="arc";var znt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type="compound",e}return t.prototype._updatePathDirty=function(){for(var e=this.shape.paths,i=this.shapeChanged(),r=0;r<e.length;r++)i=i||e[r].shapeChanged();i&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var e=this.shape.paths||[],i=this.getGlobalScale(),r=0;r<e.length;r++)e[r].path||e[r].createPathProxy(),e[r].path.setScale(i[0],i[1],e[r].segmentIgnoreThreshold)},t.prototype.buildPath=function(e,i){for(var r=i.paths||[],o=0;o<r.length;o++)r[o].buildPath(e,r[o].shape,!0)},t.prototype.afterBrush=function(){for(var e=this.shape.paths||[],i=0;i<e.length;i++)e[i].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Ee.prototype.getBoundingRect.call(this)},t}(Ee),w9=function(){function n(t){this.colorStops=t||[]}return n.prototype.addColorStop=function(t,e){this.colorStops.push({offset:t,color:e})},n}(),x9=function(n){ct(t,n);function t(e,i,r,o,s,a){var l=n.call(this,s)||this;return l.x=e??0,l.y=i??0,l.x2=r??1,l.y2=o??0,l.type="linear",l.global=a||!1,l}return t}(w9),Nnt=function(n){ct(t,n);function t(e,i,r,o,s){var a=n.call(this,o)||this;return a.x=e??.5,a.y=i??.5,a.r=r??.5,a.type="radial",a.global=s||!1,a}return t}(w9),Du=[0,0],Iu=[0,0],sb=new Vt,ab=new Vt,NC=function(){function n(t,e){this._corners=[],this._axes=[],this._origin=[0,0];for(var i=0;i<4;i++)this._corners[i]=new Vt;for(var i=0;i<2;i++)this._axes[i]=new Vt;t&&this.fromBoundingRect(t,e)}return n.prototype.fromBoundingRect=function(t,e){var i=this._corners,r=this._axes,o=t.x,s=t.y,a=o+t.width,l=s+t.height;if(i[0].set(o,s),i[1].set(a,s),i[2].set(a,l),i[3].set(o,l),e)for(var h=0;h<4;h++)i[h].transform(e);Vt.sub(r[0],i[1],i[0]),Vt.sub(r[1],i[3],i[0]),r[0].normalize(),r[1].normalize();for(var h=0;h<2;h++)this._origin[h]=r[h].dot(i[0])},n.prototype.intersect=function(t,e){var i=!0,r=!e;return sb.set(1/0,1/0),ab.set(0,0),!this._intersectCheckOneSide(this,t,sb,ab,r,1)&&(i=!1,r)||!this._intersectCheckOneSide(t,this,sb,ab,r,-1)&&(i=!1,r)||r||Vt.copy(e,i?sb:ab),i},n.prototype._intersectCheckOneSide=function(t,e,i,r,o,s){for(var a=!0,l=0;l<2;l++){var h=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,Du),this._getProjMinMaxOnAxis(l,e._corners,Iu),Du[1]<Iu[0]||Du[0]>Iu[1]){if(a=!1,o)return a;var u=Math.abs(Iu[0]-Du[1]),d=Math.abs(Du[0]-Iu[1]);Math.min(u,d)>r.len()&&(u<d?Vt.scale(r,h,-u*s):Vt.scale(r,h,d*s))}else if(i){var u=Math.abs(Iu[0]-Du[1]),d=Math.abs(Du[0]-Iu[1]);Math.min(u,d)<i.len()&&(u<d?Vt.scale(i,h,u*s):Vt.scale(i,h,-d*s))}}return a},n.prototype._getProjMinMaxOnAxis=function(t,e,i){for(var r=this._axes[t],o=this._origin,s=e[0].dot(r)+o[t],a=s,l=s,h=1;h<e.length;h++){var u=e[h].dot(r)+o[t];a=Math.min(u,a),l=Math.max(u,l)}i[0]=a,i[1]=l},n}(),Wnt=[],Vnt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.notClear=!0,e.incremental=!0,e._displayables=[],e._temporaryDisplayables=[],e._cursor=0,e}return t.prototype.traverse=function(e,i){e.call(i,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(e,i){i?this._temporaryDisplayables.push(e):this._displayables.push(e),this.markRedraw()},t.prototype.addDisplayables=function(e,i){i=i||!1;for(var r=0;r<e.length;r++)this.addDisplayable(e[r],i)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(e){for(var i=this._cursor;i<this._displayables.length;i++)e&&e(this._displayables[i]);for(var i=0;i<this._temporaryDisplayables.length;i++)e&&e(this._temporaryDisplayables[i])},t.prototype.update=function(){this.updateTransform();for(var e=this._cursor;e<this._displayables.length;e++){var i=this._displayables[e];i.parent=this,i.update(),i.parent=null}for(var e=0;e<this._temporaryDisplayables.length;e++){var i=this._temporaryDisplayables[e];i.parent=this,i.update(),i.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var e=new Te(1/0,1/0,-1/0,-1/0),i=0;i<this._displayables.length;i++){var r=this._displayables[i],o=r.getBoundingRect().clone();r.needLocalTransform()&&o.applyTransform(r.getLocalTransform(Wnt)),e.union(o)}this._rect=e}return this._rect},t.prototype.contain=function(e,i){var r=this.transformCoordToLocal(e,i),o=this.getBoundingRect();if(o.contain(r[0],r[1]))for(var s=0;s<this._displayables.length;s++){var a=this._displayables[s];if(a.contain(e,i))return!0}return!1},t}(Sc),S9=Ke();function uS(n,t,e,i,r){var o;if(t&&t.ecModel){var s=t.ecModel.getUpdatePayload();o=s&&s.animation}var a=t&&t.isAnimationEnabled(),l=n==="update";if(a){var h=void 0,u=void 0,d=void 0;i?(h=ve(i.duration,200),u=ve(i.easing,"cubicOut"),d=0):(h=t.getShallow(l?"animationDurationUpdate":"animationDuration"),u=t.getShallow(l?"animationEasingUpdate":"animationEasing"),d=t.getShallow(l?"animationDelayUpdate":"animationDelay")),o&&(o.duration!=null&&(h=o.duration),o.easing!=null&&(u=o.easing),o.delay!=null&&(d=o.delay)),jt(d)&&(d=d(e,r)),jt(h)&&(h=h(e));var c={duration:h||0,delay:d,easing:u};return c}else return null}function VE(n,t,e,i,r,o,s){var a=!1,l;jt(r)?(s=o,o=r,r=null):Ht(r)&&(o=r.cb,s=r.during,a=r.isFrom,l=r.removeOpt,r=r.dataIndex);var h=n==="leave";h||t.stopAnimation("leave");var u=uS(n,i,r,h?l||{}:null,i&&i.getAnimationDelayParams?i.getAnimationDelayParams(t,r):null);if(u&&u.duration>0){var d=u.duration,c=u.delay,f=u.easing,g={duration:d,delay:c||0,easing:f,done:o,force:!!o||!!s,setToFinal:!h,scope:n,during:s};a?t.animateFrom(e,g):t.animateTo(e,g)}else t.stopAnimation(),!a&&t.attr(e),s&&s(1),o&&o()}function En(n,t,e,i,r,o){VE("update",n,t,e,i,r,o)}function nr(n,t,e,i,r,o){VE("enter",n,t,e,i,r,o)}function Nf(n){if(!n.__zr)return!0;for(var t=0;t<n.animators.length;t++){var e=n.animators[t];if(e.scope==="leave")return!0}return!1}function WC(n,t,e,i,r,o){Nf(n)||VE("leave",n,t,e,i,r,o)}function hH(n,t,e,i){n.removeTextContent(),n.removeTextGuideLine(),WC(n,{style:{opacity:0}},t,e,i)}function VC(n,t,e){function i(){n.parent&&n.parent.remove(n)}n.isGroup?n.traverse(function(r){r.isGroup||hH(r,t,e,i)}):hH(n,t,e,i)}function dS(n){S9(n).oldStyle=n.style}function Gnt(n){return S9(n).oldStyle}var GC=Math.max,$C=Math.min,oB={};function $nt(n){return Ee.extend(n)}var jnt=wnt;function Unt(n,t){return jnt(n,t)}function ia(n,t){oB[n]=t}function Xnt(n){if(oB.hasOwnProperty(n))return oB[n]}function GE(n,t,e,i){var r=Cnt(n,t);return e&&(i==="center"&&(e=T9(e,r.getBoundingRect())),M9(r,e)),r}function A9(n,t,e){var i=new du({style:{image:n,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(r){if(e==="center"){var o={width:r.width,height:r.height};i.setStyle(T9(t,o))}}});return i}function T9(n,t){var e=t.width/t.height,i=n.height*e,r;i<=n.width?r=n.height:(i=n.width,r=i/e);var o=n.x+n.width/2,s=n.y+n.height/2;return{x:o-i/2,y:s-r/2,width:i,height:r}}var wl=xnt;function M9(n,t){if(n.applyTransform){var e=n.getBoundingRect(),i=e.calculateTransform(t);n.applyTransform(i)}}function K0(n,t){return o9(n,n,{lineWidth:t}),n}function Ynt(n){return s9(n.shape,n.shape,n.style),n}var Knt=bd;function cS(n,t){for(var e=RE([]);n&&n!==t;)Ff(e,n.getLocalTransform(),e),n=n.parent;return e}function Cg(n,t,e){return t&&!Yr(t)&&(t=ny.getLocalTransform(t)),e&&(t=tS([],t)),hs([],n,t)}function $E(n,t,e){var i=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),r=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),o=[n==="left"?-i:n==="right"?i:0,n==="top"?-r:n==="bottom"?r:0];return o=Cg(o,t,e),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"}function uH(n){return!n.isGroup}function qnt(n){return n.shape!=null}function jE(n,t,e){if(!n||!t)return;function i(s){var a={};return s.traverse(function(l){uH(l)&&l.anid&&(a[l.anid]=l)}),a}function r(s){var a={x:s.x,y:s.y,rotation:s.rotation};return qnt(s)&&(a.shape=ft({},s.shape)),a}var o=i(n);t.traverse(function(s){if(uH(s)&&s.anid){var a=o[s.anid];if(a){var l=r(s);s.attr(r(a)),En(s,l,e,pe(s).dataIndex)}}})}function R9(n,t){return St(n,function(e){var i=e[0];i=GC(i,t.x),i=$C(i,t.x+t.width);var r=e[1];return r=GC(r,t.y),r=$C(r,t.y+t.height),[i,r]})}function Znt(n,t){var e=GC(n.x,t.x),i=$C(n.x+n.width,t.x+t.width),r=GC(n.y,t.y),o=$C(n.y+n.height,t.y+t.height);if(i>=e&&o>=r)return{x:e,y:r,width:i-e,height:o-r}}function fS(n,t,e){var i=ft({rectHover:!0},t),r=i.style={strokeNoScale:!0};if(e=e||{x:-1,y:-1,width:2,height:2},n)return n.indexOf("image://")===0?(r.image=n.slice(8),Gt(r,e),new du(i)):GE(n.replace("path://",""),i,e,"center")}function Jnt(n,t,e,i,r){for(var o=0,s=r[r.length-1];o<r.length;o++){var a=r[o];if(B9(n,t,e,i,a[0],a[1],s[0],s[1]))return!0;s=a}}function B9(n,t,e,i,r,o,s,a){var l=e-n,h=i-t,u=s-r,d=a-o,c=iM(u,d,l,h);if(Qnt(c))return!1;var f=n-r,g=t-o,p=iM(f,g,l,h)/c;if(p<0||p>1)return!1;var v=iM(f,g,u,d)/c;return!(v<0||v>1)}function iM(n,t,e,i){return n*i-e*t}function Qnt(n){return n<=1e-6&&n>=-1e-6}function hy(n){var t=n.itemTooltipOption,e=n.componentModel,i=n.itemName,r=Pt(t)?{formatter:t}:t,o=e.mainType,s=e.componentIndex,a={componentType:o,name:i,$vars:["name"]};a[o+"Index"]=s;var l=n.formatterParamsExtra;l&&N(yi(l),function(u){tc(a,u)||(a[u]=l[u],a.$vars.push(u))});var h=pe(n.el);h.componentMainType=o,h.componentIndex=s,h.tooltipConfig={name:i,option:Gt({content:i,encodeHTMLContent:!0,formatterParams:a},r)}}function dH(n,t){var e;n.isGroup&&(e=t(n)),e||n.traverse(t)}function gS(n,t){if(n)if(_t(n))for(var e=0;e<n.length;e++)dH(n[e],t);else dH(n,t)}ia("circle",ly);ia("ellipse",NE);ia("sector",xo);ia("ring",lS);ia("polygon",Ac);ia("polyline",Tc);ia("rect",ci);ia("line",ns);ia("bezierCurve",WE);ia("arc",hS);const UE=Object.freeze(Object.defineProperty({__proto__:null,Arc:hS,BezierCurve:WE,BoundingRect:Te,Circle:ly,CompoundPath:znt,Ellipse:NE,Group:bi,Image:du,IncrementalDisplayable:Vnt,Line:ns,LinearGradient:x9,OrientedBoundingRect:NC,Path:Ee,Point:Vt,Polygon:Ac,Polyline:Tc,RadialGradient:Nnt,Rect:ci,Ring:lS,Sector:xo,Text:Vi,applyTransform:Cg,clipPointsByRect:R9,clipRectByRect:Znt,createIcon:fS,extendPath:Unt,extendShape:$nt,getShapeClass:Xnt,getTransform:cS,groupTransition:jE,initProps:nr,isElementRemoved:Nf,lineLineIntersect:B9,linePolygonIntersect:Jnt,makeImage:A9,makePath:GE,mergePath:wl,registerShape:ia,removeElement:WC,removeElementWithFadeOut:VC,resizePath:M9,setTooltipConfig:hy,subPixelOptimize:Knt,subPixelOptimizeLine:K0,subPixelOptimizeRect:Ynt,transformDirection:$E,traverseElements:gS,updateProps:En},Symbol.toStringTag,{value:"Module"}));var pS={};function P9(n,t){for(var e=0;e<wo.length;e++){var i=wo[e],r=t[i],o=n.ensureState(i);o.style=o.style||{},o.style.text=r}var s=n.currentStates.slice();n.clearStates(!0),n.setStyle({text:t.normal}),n.useStates(s,!0)}function sB(n,t,e){var i=n.labelFetcher,r=n.labelDataIndex,o=n.labelDimIndex,s=t.normal,a;i&&(a=i.getFormattedLabel(r,"normal",null,o,s&&s.get("formatter"),e!=null?{interpolatedValue:e}:null)),a==null&&(a=jt(n.defaultText)?n.defaultText(r,n,e):n.defaultText);for(var l={normal:a},h=0;h<wo.length;h++){var u=wo[h],d=t[u];l[u]=ve(i?i.getFormattedLabel(r,u,null,o,d&&d.get("formatter")):null,a)}return l}function cp(n,t,e,i){e=e||pS;for(var r=n instanceof Vi,o=!1,s=0;s<X0.length;s++){var a=t[X0[s]];if(a&&a.getShallow("show")){o=!0;break}}var l=r?n:n.getTextContent();if(o){r||(l||(l=new Vi,n.setTextContent(l)),n.stateProxy&&(l.stateProxy=n.stateProxy));var h=sB(e,t),u=t.normal,d=!!u.getShallow("show"),c=So(u,i&&i.normal,e,!1,!r);c.text=h.normal,r||n.setTextConfig(cH(u,e,!1));for(var s=0;s<wo.length;s++){var f=wo[s],a=t[f];if(a){var g=l.ensureState(f),p=!!ve(a.getShallow("show"),d);if(p!==d&&(g.ignore=!p),g.style=So(a,i&&i[f],e,!0,!r),g.style.text=h[f],!r){var v=n.ensureState(f);v.textConfig=cH(a,e,!0)}}}l.silent=!!u.getShallow("silent"),l.style.x!=null&&(c.x=l.style.x),l.style.y!=null&&(c.y=l.style.y),l.ignore=!d,l.useStyle(c),l.dirty(),e.enableTextSetter&&(gp(l).setLabelText=function(m){var y=sB(e,t,m);P9(l,y)})}else l&&(l.ignore=!0);n.dirty()}function fp(n,t){t=t||"label";for(var e={normal:n.getModel(t)},i=0;i<wo.length;i++){var r=wo[i];e[r]=n.getModel([r,t])}return e}function So(n,t,e,i,r){var o={};return trt(o,n,e,i,r),t&&ft(o,t),o}function cH(n,t,e){t=t||{};var i={},r,o=n.getShallow("rotate"),s=ve(n.getShallow("distance"),e?null:5),a=n.getShallow("offset");return r=n.getShallow("position")||(e?null:"inside"),r==="outside"&&(r=t.defaultOutsidePosition||"top"),r!=null&&(i.position=r),a!=null&&(i.offset=a),o!=null&&(o*=Math.PI/180,i.rotation=o),s!=null&&(i.distance=s),i.outsideFill=n.get("color")==="inherit"?t.inheritColor||null:"auto",i}function trt(n,t,e,i,r){e=e||pS;var o=t.ecModel,s=o&&o.option.textStyle,a=ert(t),l;if(a){l={};for(var h in a)if(a.hasOwnProperty(h)){var u=t.getModel(["rich",h]);vH(l[h]={},u,s,e,i,r,!1,!0)}}l&&(n.rich=l);var d=t.get("overflow");d&&(n.overflow=d);var c=t.get("minMargin");c!=null&&(n.margin=c),vH(n,t,s,e,i,r,!0,!1)}function ert(n){for(var t;n&&n!==n.ecModel;){var e=(n.option||pS).rich;if(e){t=t||{};for(var i=yi(e),r=0;r<i.length;r++){var o=i[r];t[o]=1}}n=n.parentModel}return t}var fH=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],gH=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],pH=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function vH(n,t,e,i,r,o,s,a){e=!r&&e||pS;var l=i&&i.inheritColor,h=t.getShallow("color"),u=t.getShallow("textBorderColor"),d=ve(t.getShallow("opacity"),e.opacity);(h==="inherit"||h==="auto")&&(l?h=l:h=null),(u==="inherit"||u==="auto")&&(l?u=l:u=null),o||(h=h||e.color,u=u||e.textBorderColor),h!=null&&(n.fill=h),u!=null&&(n.stroke=u);var c=ve(t.getShallow("textBorderWidth"),e.textBorderWidth);c!=null&&(n.lineWidth=c);var f=ve(t.getShallow("textBorderType"),e.textBorderType);f!=null&&(n.lineDash=f);var g=ve(t.getShallow("textBorderDashOffset"),e.textBorderDashOffset);g!=null&&(n.lineDashOffset=g),!r&&d==null&&!a&&(d=i&&i.defaultOpacity),d!=null&&(n.opacity=d),!r&&!o&&n.fill==null&&i.inheritColor&&(n.fill=i.inheritColor);for(var p=0;p<fH.length;p++){var v=fH[p],m=ve(t.getShallow(v),e[v]);m!=null&&(n[v]=m)}for(var p=0;p<gH.length;p++){var v=gH[p],m=t.getShallow(v);m!=null&&(n[v]=m)}if(n.verticalAlign==null){var y=t.getShallow("baseline");y!=null&&(n.verticalAlign=y)}if(!s||!i.disableBox){for(var p=0;p<pH.length;p++){var v=pH[p],m=t.getShallow(v);m!=null&&(n[v]=m)}var b=t.getShallow("borderType");b!=null&&(n.borderDash=b),(n.backgroundColor==="auto"||n.backgroundColor==="inherit")&&l&&(n.backgroundColor=l),(n.borderColor==="auto"||n.borderColor==="inherit")&&l&&(n.borderColor=l)}}function k9(n,t){var e=t&&t.getModel("textStyle");return Ba([n.fontStyle||e&&e.getShallow("fontStyle")||"",n.fontWeight||e&&e.getShallow("fontWeight")||"",(n.fontSize||e&&e.getShallow("fontSize")||12)+"px",n.fontFamily||e&&e.getShallow("fontFamily")||"sans-serif"].join(" "))}var gp=Ke();function irt(n,t,e,i){if(n){var r=gp(n);r.prevValue=r.value,r.value=e;var o=t.normal;r.valueAnimation=o.get("valueAnimation"),r.valueAnimation&&(r.precision=o.get("precision"),r.defaultInterpolatedText=i,r.statesModels=t)}}function nrt(n,t,e,i,r){var o=gp(n);if(!o.valueAnimation||o.prevValue===o.value)return;var s=o.defaultInterpolatedText,a=ve(o.interpolatedValue,o.prevValue),l=o.value;function h(u){var d=Y8(e,o.precision,a,l,u);o.interpolatedValue=u===1?null:d;var c=sB({labelDataIndex:t,labelFetcher:r,defaultText:s?s(d):d+""},o.statesModels,d);P9(n,c)}n.percent=0,(o.prevValue==null?nr:En)(n,{percent:1},i,t,null,h)}var rrt=["textStyle","color"],nM=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],rM=new Vi,ort=function(){function n(){}return n.prototype.getTextColor=function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(rrt):null)},n.prototype.getFont=function(){return k9({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},n.prototype.getTextRect=function(t){for(var e={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},i=0;i<nM.length;i++)e[nM[i]]=this.getShallow(nM[i]);return rM.useStyle(e),rM.update(),rM.getBoundingRect()},n}(),E9=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],srt=yg(E9),art=function(){function n(){}return n.prototype.getLineStyle=function(t){return srt(this,t)},n}(),L9=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],lrt=yg(L9),hrt=function(){function n(){}return n.prototype.getItemStyle=function(t,e){return lrt(this,t,e)},n}(),ui=function(){function n(t,e,i){this.parentModel=e,this.ecModel=i,this.option=t}return n.prototype.init=function(t,e,i){},n.prototype.mergeOption=function(t,e){we(this.option,t,!0)},n.prototype.get=function(t,e){return t==null?this.option:this._doGet(this.parsePath(t),!e&&this.parentModel)},n.prototype.getShallow=function(t,e){var i=this.option,r=i==null?i:i[t];if(r==null&&!e){var o=this.parentModel;o&&(r=o.getShallow(t))}return r},n.prototype.getModel=function(t,e){var i=t!=null,r=i?this.parsePath(t):null,o=i?this._doGet(r):this.option;return e=e||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(r)),new n(o,e,this.ecModel)},n.prototype.isEmpty=function(){return this.option==null},n.prototype.restoreData=function(){},n.prototype.clone=function(){var t=this.constructor;return new t(ne(this.option))},n.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},n.prototype.resolveParentPath=function(t){return t},n.prototype.isAnimationEnabled=function(){if(!ie.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},n.prototype._doGet=function(t,e){var i=this.option;if(!t)return i;for(var r=0;r<t.length&&!(t[r]&&(i=i&&typeof i=="object"?i[t[r]]:null,i==null));r++);return i==null&&e&&(i=e._doGet(this.resolveParentPath(t),e.parentModel)),i},n}();OE(ui);sit(ui);ea(ui,art);ea(ui,hrt);ea(ui,dit);ea(ui,ort);var urt=Math.round(Math.random()*10);function uy(n){return[n||"",urt++].join("_")}function drt(n){var t={};n.registerSubTypeDefaulter=function(e,i){var r=Pa(e);t[r.main]=i},n.determineSubType=function(e,i){var r=i.type;if(!r){var o=Pa(e).main;n.hasSubTypes(e)&&t[o]&&(r=t[o](i))}return r}}function crt(n,t){n.topologicalTravel=function(o,s,a,l){if(!o.length)return;var h=e(s),u=h.graph,d=h.noEntryList,c={};for(N(o,function(y){c[y]=!0});d.length;){var f=d.pop(),g=u[f],p=!!c[f];p&&(a.call(l,f,g.originalDeps.slice()),delete c[f]),N(g.successor,p?m:v)}N(c,function(){var y="";throw new Error(y)});function v(y){u[y].entryCount--,u[y].entryCount===0&&d.push(y)}function m(y){c[y]=!0,v(y)}};function e(o){var s={},a=[];return N(o,function(l){var h=i(s,l),u=h.originalDeps=t(l),d=r(u,o);h.entryCount=d.length,h.entryCount===0&&a.push(l),N(d,function(c){_e(h.predecessor,c)<0&&h.predecessor.push(c);var f=i(s,c);_e(f.successor,c)<0&&f.successor.push(l)})}),{graph:s,noEntryList:a}}function i(o,s){return o[s]||(o[s]={predecessor:[],successor:[]}),o[s]}function r(o,s){var a=[];return N(o,function(l){_e(s,l)>=0&&a.push(l)}),a}}function vS(n,t){return we(we({},n,!0),t,!0)}const frt={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},grt={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:"",custom:"",chart:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var jC="ZH",XE="EN",Wf=XE,q_={},YE={},O9=ie.domSupported?function(){var n=(document.documentElement.lang||navigator.language||navigator.browserLanguage||Wf).toUpperCase();return n.indexOf(jC)>-1?jC:Wf}():Wf;function D9(n,t){n=n.toUpperCase(),YE[n]=new ui(t),q_[n]=t}function prt(n){if(Pt(n)){var t=q_[n.toUpperCase()]||{};return n===jC||n===XE?ne(t):we(ne(t),ne(q_[Wf]),!1)}else return we(ne(n),ne(q_[Wf]),!1)}function vrt(n){return YE[n]}function mrt(){return YE[Wf]}D9(XE,frt);D9(jC,grt);var KE=1e3,qE=KE*60,u0=qE*60,ts=u0*24,mH=ts*365,Ov={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},lb="{yyyy}-{MM}-{dd}",yH={year:"{yyyy}",month:"{yyyy}-{MM}",day:lb,hour:lb+" "+Ov.hour,minute:lb+" "+Ov.minute,second:lb+" "+Ov.second,millisecond:Ov.none},oM=["year","month","day","hour","minute","second","millisecond"],I9=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function nh(n,t){return n+="","0000".substr(0,t-n.length)+n}function Vf(n){switch(n){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return n}}function yrt(n){return n===Vf(n)}function brt(n){switch(n){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function mS(n,t,e,i){var r=Wl(n),o=r[ZE(e)](),s=r[Gf(e)]()+1,a=Math.floor((s-1)/3)+1,l=r[yS(e)](),h=r["get"+(e?"UTC":"")+"Day"](),u=r[q0(e)](),d=(u-1)%12+1,c=r[bS(e)](),f=r[_S(e)](),g=r[CS(e)](),p=u>=12?"pm":"am",v=p.toUpperCase(),m=i instanceof ui?i:vrt(i||O9)||mrt(),y=m.getModel("time"),b=y.get("month"),_=y.get("monthAbbr"),w=y.get("dayOfWeek"),C=y.get("dayOfWeekAbbr");return(t||"").replace(/{a}/g,p+"").replace(/{A}/g,v+"").replace(/{yyyy}/g,o+"").replace(/{yy}/g,nh(o%100+"",2)).replace(/{Q}/g,a+"").replace(/{MMMM}/g,b[s-1]).replace(/{MMM}/g,_[s-1]).replace(/{MM}/g,nh(s,2)).replace(/{M}/g,s+"").replace(/{dd}/g,nh(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,w[h]).replace(/{ee}/g,C[h]).replace(/{e}/g,h+"").replace(/{HH}/g,nh(u,2)).replace(/{H}/g,u+"").replace(/{hh}/g,nh(d+"",2)).replace(/{h}/g,d+"").replace(/{mm}/g,nh(c,2)).replace(/{m}/g,c+"").replace(/{ss}/g,nh(f,2)).replace(/{s}/g,f+"").replace(/{SSS}/g,nh(g,3)).replace(/{S}/g,g+"")}function _rt(n,t,e,i,r){var o=null;if(Pt(e))o=e;else if(jt(e))o=e(n.value,t,{level:n.level});else{var s=ft({},Ov);if(n.level>0)for(var a=0;a<oM.length;++a)s[oM[a]]="{primary|"+s[oM[a]]+"}";var l=e?e.inherit===!1?e:Gt(e,s):s,h=H9(n.value,r);if(l[h])o=l[h];else if(l.inherit){for(var u=I9.indexOf(h),a=u-1;a>=0;--a)if(l[h]){o=l[h];break}o=o||s.none}if(_t(o)){var d=n.level==null?0:n.level>=0?n.level:o.length+n.level;d=Math.min(d,o.length-1),o=o[d]}}return mS(new Date(n.value),o,r,i)}function H9(n,t){var e=Wl(n),i=e[Gf(t)]()+1,r=e[yS(t)](),o=e[q0(t)](),s=e[bS(t)](),a=e[_S(t)](),l=e[CS(t)](),h=l===0,u=h&&a===0,d=u&&s===0,c=d&&o===0,f=c&&r===1,g=f&&i===1;return g?"year":f?"month":c?"day":d?"hour":u?"minute":h?"second":"millisecond"}function bH(n,t,e){var i=di(n)?Wl(n):n;switch(t=t||H9(n,e),t){case"year":return i[ZE(e)]();case"half-year":return i[Gf(e)]()>=6?1:0;case"quarter":return Math.floor((i[Gf(e)]()+1)/4);case"month":return i[Gf(e)]();case"day":return i[yS(e)]();case"half-day":return i[q0(e)]()/24;case"hour":return i[q0(e)]();case"minute":return i[bS(e)]();case"second":return i[_S(e)]();case"millisecond":return i[CS(e)]()}}function ZE(n){return n?"getUTCFullYear":"getFullYear"}function Gf(n){return n?"getUTCMonth":"getMonth"}function yS(n){return n?"getUTCDate":"getDate"}function q0(n){return n?"getUTCHours":"getHours"}function bS(n){return n?"getUTCMinutes":"getMinutes"}function _S(n){return n?"getUTCSeconds":"getSeconds"}function CS(n){return n?"getUTCMilliseconds":"getMilliseconds"}function Crt(n){return n?"setUTCFullYear":"setFullYear"}function F9(n){return n?"setUTCMonth":"setMonth"}function z9(n){return n?"setUTCDate":"setDate"}function N9(n){return n?"setUTCHours":"setHours"}function W9(n){return n?"setUTCMinutes":"setMinutes"}function V9(n){return n?"setUTCSeconds":"setSeconds"}function G9(n){return n?"setUTCMilliseconds":"setMilliseconds"}function $9(n){if(!zet(n))return Pt(n)?n:"-";var t=(n+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function j9(n,t){return n=(n||"").toLowerCase().replace(/-(.)/g,function(e,i){return i.toUpperCase()}),t&&n&&(n=n.charAt(0).toUpperCase()+n.slice(1)),n}var dy=TE;function aB(n,t,e){var i="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function r(u){return u&&Ba(u)?u:"-"}function o(u){return!!(u!=null&&!isNaN(u)&&isFinite(u))}var s=t==="time",a=n instanceof Date;if(s||a){var l=s?Wl(n):n;if(isNaN(+l)){if(a)return"-"}else return mS(l,i,e)}if(t==="ordinal")return P2(n)?r(n):di(n)&&o(n)?n+"":"-";var h=IC(n);return o(h)?$9(h):P2(n)?r(n):typeof n=="boolean"?n+"":"-"}var _H=["a","b","c","d","e","f","g"],sM=function(n,t){return"{"+n+(t??"")+"}"};function U9(n,t,e){_t(t)||(t=[t]);var i=t.length;if(!i)return"";for(var r=t[0].$vars||[],o=0;o<r.length;o++){var s=_H[o];n=n.replace(sM(s),sM(s,0))}for(var a=0;a<i;a++)for(var l=0;l<r.length;l++){var h=t[a][r[l]];n=n.replace(sM(_H[l],a),e?Hr(h):h)}return n}function wrt(n,t){var e=Pt(n)?{color:n,extraCssText:t}:n||{},i=e.color,r=e.type;t=e.extraCssText;var o=e.renderMode||"html";if(!i)return"";if(o==="html")return r==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Hr(i)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Hr(i)+";"+(t||"")+'"></span>';var s=e.markerId||"markerX";return{renderMode:o,content:"{"+s+"|}  ",style:r==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:i}:{width:10,height:10,borderRadius:5,backgroundColor:i}}}function nc(n,t){return t=t||"transparent",Pt(n)?n:Ht(n)&&n.colorStops&&(n.colorStops[0]||{}).color||t}function UC(n,t){if(t==="_blank"||t==="blank"){var e=window.open();e.opener=null,e.location.href=n}else window.open(n,t)}var Z_=N,xrt=["left","right","top","bottom","width","height"],hb=[["width","left","right"],["height","top","bottom"]];function JE(n,t,e,i,r){var o=0,s=0;i==null&&(i=1/0),r==null&&(r=1/0);var a=0;t.eachChild(function(l,h){var u=l.getBoundingRect(),d=t.childAt(h+1),c=d&&d.getBoundingRect(),f,g;if(n==="horizontal"){var p=u.width+(c?-c.x+u.x:0);f=o+p,f>i||l.newline?(o=0,f=p,s+=a+e,a=u.height):a=Math.max(a,u.height)}else{var v=u.height+(c?-c.y+u.y:0);g=s+v,g>r||l.newline?(o+=a+e,s=0,g=v,a=u.width):a=Math.max(a,u.width)}l.newline||(l.x=o,l.y=s,l.markRedraw(),n==="horizontal"?o=f+e:s=g+e)})}var $f=JE;he(JE,"vertical");he(JE,"horizontal");function Srt(n,t,e){var i=t.width,r=t.height,o=Jt(n.left,i),s=Jt(n.top,r),a=Jt(n.right,i),l=Jt(n.bottom,r);return(isNaN(o)||isNaN(parseFloat(n.left)))&&(o=0),(isNaN(a)||isNaN(parseFloat(n.right)))&&(a=i),(isNaN(s)||isNaN(parseFloat(n.top)))&&(s=0),(isNaN(l)||isNaN(parseFloat(n.bottom)))&&(l=r),e=dy(e||0),{width:Math.max(a-o-e[1]-e[3],0),height:Math.max(l-s-e[0]-e[2],0)}}function Na(n,t,e){e=dy(e||0);var i=t.width,r=t.height,o=Jt(n.left,i),s=Jt(n.top,r),a=Jt(n.right,i),l=Jt(n.bottom,r),h=Jt(n.width,i),u=Jt(n.height,r),d=e[2]+e[0],c=e[1]+e[3],f=n.aspect;switch(isNaN(h)&&(h=i-a-c-o),isNaN(u)&&(u=r-l-d-s),f!=null&&(isNaN(h)&&isNaN(u)&&(f>i/r?h=i*.8:u=r*.8),isNaN(h)&&(h=f*u),isNaN(u)&&(u=h/f)),isNaN(o)&&(o=i-a-h-c),isNaN(s)&&(s=r-l-u-d),n.left||n.right){case"center":o=i/2-h/2-e[3];break;case"right":o=i-h-c;break}switch(n.top||n.bottom){case"middle":case"center":s=r/2-u/2-e[0];break;case"bottom":s=r-u-d;break}o=o||0,s=s||0,isNaN(h)&&(h=i-c-o-(a||0)),isNaN(u)&&(u=r-d-s-(l||0));var g=new Te(o+e[3],s+e[0],h,u);return g.margin=e,g}function X9(n,t,e,i,r,o){o=o||n,o.x=n.x,o.y=n.y;var s;if(s=n.getBoundingRect(),n.needLocalTransform()){var a=n.getLocalTransform();s=s.clone(),s.applyTransform(a)}var l=Na(Gt({width:s.width,height:s.height},t),e,i),h=l.x-s.x,u=l.y-s.y;return o.x+=h,o.y+=u,o===n&&n.markRedraw(),!0}function Z0(n){var t=n.layoutMode||n.constructor.layoutMode;return Ht(t)?t:t?{type:t}:null}function wg(n,t,e){var i=e&&e.ignoreSize;!_t(i)&&(i=[i,i]);var r=s(hb[0],0),o=s(hb[1],1);h(hb[0],n,r),h(hb[1],n,o);function s(u,d){var c={},f=0,g={},p=0,v=2;if(Z_(u,function(b){g[b]=n[b]}),Z_(u,function(b){a(t,b)&&(c[b]=g[b]=t[b]),l(c,b)&&f++,l(g,b)&&p++}),i[d])return l(t,u[1])?g[u[2]]=null:l(t,u[2])&&(g[u[1]]=null),g;if(p===v||!f)return g;if(f>=v)return c;for(var m=0;m<u.length;m++){var y=u[m];if(!a(c,y)&&a(n,y)){c[y]=n[y];break}}return c}function a(u,d){return u.hasOwnProperty(d)}function l(u,d){return u[d]!=null&&u[d]!=="auto"}function h(u,d,c){Z_(u,function(f){d[f]=c[f]})}}function cy(n){return Art({},n)}function Art(n,t){return t&&n&&Z_(xrt,function(e){t.hasOwnProperty(e)&&(n[e]=t[e])}),n}var Trt=Ke(),$e=function(n){ct(t,n);function t(e,i,r){var o=n.call(this,e,i,r)||this;return o.uid=uy("ec_cpt_model"),o}return t.prototype.init=function(e,i,r){this.mergeDefaultAndTheme(e,r)},t.prototype.mergeDefaultAndTheme=function(e,i){var r=Z0(this),o=r?cy(e):{},s=i.getTheme();we(e,s.get(this.mainType)),we(e,this.getDefaultOption()),r&&wg(e,o,r)},t.prototype.mergeOption=function(e,i){we(this.option,e,!0);var r=Z0(this);r&&wg(this.option,e,r)},t.prototype.optionUpdated=function(e,i){},t.prototype.getDefaultOption=function(){var e=this.constructor;if(!nit(e))return e.defaultOption;var i=Trt(this);if(!i.defaultOption){for(var r=[],o=e;o;){var s=o.prototype.defaultOption;s&&r.push(s),o=o.superClass}for(var a={},l=r.length-1;l>=0;l--)a=we(a,r[l],!0);i.defaultOption=a}return i.defaultOption},t.prototype.getReferringComponents=function(e,i){var r=e+"Index",o=e+"Id";return sy(this.ecModel,e,{index:this.get(r,!0),id:this.get(o,!0)},i)},t.prototype.getBoxLayoutParams=function(){var e=this;return{left:e.get("left"),top:e.get("top"),right:e.get("right"),bottom:e.get("bottom"),width:e.get("width"),height:e.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(e){this.option.zlevel=e},t.protoInitialize=function(){var e=t.prototype;e.type="component",e.id="",e.name="",e.mainType="",e.subType="",e.componentIndex=0}(),t}(ui);q8($e,ui);iS($e);drt($e);crt($e,Mrt);function Mrt(n){var t=[];return N($e.getClassesByMainType(n),function(e){t=t.concat(e.dependencies||e.prototype.dependencies||[])}),t=St(t,function(e){return Pa(e).main}),n!=="dataset"&&_e(t,"dataset")<=0&&t.unshift("dataset"),t}var Y9="";typeof navigator<"u"&&(Y9=navigator.platform||"");var Vc="rgba(0, 0, 0, 0.2)";const Rrt={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:Vc,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:Vc,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:Vc,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:Vc,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:Vc,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:Vc,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:Y9.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var K9=$t(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),bs="original",qr="arrayRows",na="objectRows",ja="keyedColumns",Vh="typedArray",q9="unknown",Ol="column",pp="row",$n={Must:1,Might:2,Not:3},Z9=Ke();function Brt(n){Z9(n).datasetMap=$t()}function Prt(n,t,e){var i={},r=QE(t);if(!r||!n)return i;var o=[],s=[],a=t.ecModel,l=Z9(a).datasetMap,h=r.uid+"_"+e.seriesLayoutBy,u,d;n=n.slice(),N(n,function(p,v){var m=Ht(p)?p:n[v]={name:p};m.type==="ordinal"&&u==null&&(u=v,d=g(m)),i[m.name]=[]});var c=l.get(h)||l.set(h,{categoryWayDim:d,valueWayDim:0});N(n,function(p,v){var m=p.name,y=g(p);if(u==null){var b=c.valueWayDim;f(i[m],b,y),f(s,b,y),c.valueWayDim+=y}else if(u===v)f(i[m],0,y),f(o,0,y);else{var b=c.categoryWayDim;f(i[m],b,y),f(s,b,y),c.categoryWayDim+=y}});function f(p,v,m){for(var y=0;y<m;y++)p.push(v+y)}function g(p){var v=p.dimsDef;return v?v.length:1}return o.length&&(i.itemName=o),s.length&&(i.seriesName=s),i}function krt(n,t,e){var i={},r=QE(n);if(!r)return i;var o=t.sourceFormat,s=t.dimensionsDefine,a;(o===na||o===ja)&&N(s,function(u,d){(Ht(u)?u.name:u)==="name"&&(a=d)});var l=function(){for(var u={},d={},c=[],f=0,g=Math.min(5,e);f<g;f++){var p=Q9(t.data,o,t.seriesLayoutBy,s,t.startIndex,f);c.push(p);var v=p===$n.Not;if(v&&u.v==null&&f!==a&&(u.v=f),(u.n==null||u.n===u.v||!v&&c[u.n]===$n.Not)&&(u.n=f),m(u)&&c[u.n]!==$n.Not)return u;v||(p===$n.Might&&d.v==null&&f!==a&&(d.v=f),(d.n==null||d.n===d.v)&&(d.n=f))}function m(y){return y.v!=null&&y.n!=null}return m(u)?u:m(d)?d:null}();if(l){i.value=[l.v];var h=a??l.n;i.itemName=[h],i.seriesName=[h]}return i}function QE(n){var t=n.get("data",!0);if(!t)return sy(n.ecModel,"dataset",{index:n.get("datasetIndex",!0),id:n.get("datasetId",!0)},Qn).models[0]}function Ert(n){return!n.get("transform",!0)&&!n.get("fromTransformResult",!0)?[]:sy(n.ecModel,"dataset",{index:n.get("fromDatasetIndex",!0),id:n.get("fromDatasetId",!0)},Qn).models}function J9(n,t){return Q9(n.data,n.sourceFormat,n.seriesLayoutBy,n.dimensionsDefine,n.startIndex,t)}function Q9(n,t,e,i,r,o){var s,a=5;if(Kr(n))return $n.Not;var l,h;if(i){var u=i[o];Ht(u)?(l=u.name,h=u.type):Pt(u)&&(l=u)}if(h!=null)return h==="ordinal"?$n.Must:$n.Not;if(t===qr){var d=n;if(e===pp){for(var c=d[o],f=0;f<(c||[]).length&&f<a;f++)if((s=_(c[r+f]))!=null)return s}else for(var f=0;f<d.length&&f<a;f++){var g=d[r+f];if(g&&(s=_(g[o]))!=null)return s}}else if(t===na){var p=n;if(!l)return $n.Not;for(var f=0;f<p.length&&f<a;f++){var v=p[f];if(v&&(s=_(v[l]))!=null)return s}}else if(t===ja){var m=n;if(!l)return $n.Not;var c=m[l];if(!c||Kr(c))return $n.Not;for(var f=0;f<c.length&&f<a;f++)if((s=_(c[f]))!=null)return s}else if(t===bs)for(var y=n,f=0;f<y.length&&f<a;f++){var v=y[f],b=oy(v);if(!_t(b))return $n.Not;if((s=_(b[o]))!=null)return s}function _(w){var C=Pt(w);if(w!=null&&Number.isFinite(Number(w))&&w!=="")return C?$n.Might:$n.Not;if(C&&w!=="-")return $n.Must}return $n.Not}var lB=$t();function Lrt(n,t){ps(lB.get(n)==null&&t),lB.set(n,t)}function Ort(n,t,e){var i=lB.get(t);if(!i)return e;var r=i(n);return r?e.concat(r):e}var CH=Ke(),Drt=Ke(),tL=function(){function n(){}return n.prototype.getColorFromPalette=function(t,e,i){var r=Ni(this.get("color",!0)),o=this.get("colorLayer",!0);return t$(this,CH,r,o,t,e,i)},n.prototype.clearColorPalette=function(){Frt(this,CH)},n}();function Irt(n,t,e,i){var r=Ni(n.get(["aria","decal","decals"]));return t$(n,Drt,r,null,t,e,i)}function Hrt(n,t){for(var e=n.length,i=0;i<e;i++)if(n[i].length>t)return n[i];return n[e-1]}function t$(n,t,e,i,r,o,s){o=o||n;var a=t(o),l=a.paletteIdx||0,h=a.paletteNameMap=a.paletteNameMap||{};if(h.hasOwnProperty(r))return h[r];var u=s==null||!i?e:Hrt(i,s);if(u=u||e,!(!u||!u.length)){var d=u[l];return r&&(h[r]=d),a.paletteIdx=(l+1)%u.length,d}}function Frt(n,t){t(n).paletteIdx=0,t(n).paletteNameMap={}}var ub,Up,wH,xH="\0_ec_inner",zrt=1,eL=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.init=function(e,i,r,o,s,a){o=o||{},this.option=null,this._theme=new ui(o),this._locale=new ui(s),this._optionManager=a},t.prototype.setOption=function(e,i,r){var o=TH(i);this._optionManager.setOption(e,r,o),this._resetOption(null,o)},t.prototype.resetOption=function(e,i){return this._resetOption(e,TH(i))},t.prototype._resetOption=function(e,i){var r=!1,o=this._optionManager;if(!e||e==="recreate"){var s=o.mountOption(e==="recreate");!this.option||e==="recreate"?wH(this,s):(this.restoreData(),this._mergeOption(s,i)),r=!0}if((e==="timeline"||e==="media")&&this.restoreData(),!e||e==="recreate"||e==="timeline"){var a=o.getTimelineOption(this);a&&(r=!0,this._mergeOption(a,i))}if(!e||e==="recreate"||e==="media"){var l=o.getMediaOption(this);l.length&&N(l,function(h){r=!0,this._mergeOption(h,i)},this)}return r},t.prototype.mergeOption=function(e){this._mergeOption(e,null)},t.prototype._mergeOption=function(e,i){var r=this.option,o=this._componentsMap,s=this._componentsCount,a=[],l=$t(),h=i&&i.replaceMergeMainTypeMap;Brt(this),N(e,function(d,c){d!=null&&($e.hasClass(c)?c&&(a.push(c),l.set(c,!0)):r[c]=r[c]==null?ne(d):we(r[c],d,!0))}),h&&h.each(function(d,c){$e.hasClass(c)&&!l.get(c)&&(a.push(c),l.set(c,!0))}),$e.topologicalTravel(a,$e.getAllClassMainTypes(),u,this);function u(d){var c=Ort(this,d,Ni(e[d])),f=o.get(d),g=f?h&&h.get(d)?"replaceMerge":"normalMerge":"replaceAll",p=Wet(f,c,g);Ket(p,d,$e),r[d]=null,o.set(d,null),s.set(d,0);var v=[],m=[],y=0,b;N(p,function(_,w){var C=_.existing,x=_.newOption;if(!x)C&&(C.mergeOption({},this),C.optionUpdated({},!1));else{var S=d==="series",A=$e.getClass(d,_.keyInfo.subType,!S);if(!A)return;if(d==="tooltip"){if(b)return;b=!0}if(C&&C.constructor===A)C.name=_.keyInfo.name,C.mergeOption(x,this),C.optionUpdated(x,!1);else{var T=ft({componentIndex:w},_.keyInfo);C=new A(x,this,this,T),ft(C,T),_.brandNew&&(C.__requireNewView=!0),C.init(x,this,this),C.optionUpdated(null,!0)}}C?(v.push(C.option),m.push(C),y++):(v.push(void 0),m.push(void 0))},this),r[d]=v,o.set(d,m),s.set(d,y),d==="series"&&ub(this)}this._seriesIndices||ub(this)},t.prototype.getOption=function(){var e=ne(this.option);return N(e,function(i,r){if($e.hasClass(r)){for(var o=Ni(i),s=o.length,a=!1,l=s-1;l>=0;l--)o[l]&&!U0(o[l])?a=!0:(o[l]=null,!a&&s--);o.length=s,e[r]=o}}),delete e[xH],e},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(e){this._payload=e},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(e,i){var r=this._componentsMap.get(e);if(r){var o=r[i||0];if(o)return o;if(i==null){for(var s=0;s<r.length;s++)if(r[s])return r[s]}}},t.prototype.queryComponents=function(e){var i=e.mainType;if(!i)return[];var r=e.index,o=e.id,s=e.name,a=this._componentsMap.get(i);if(!a||!a.length)return[];var l;return r!=null?(l=[],N(Ni(r),function(h){a[h]&&l.push(a[h])})):o!=null?l=SH("id",o,a):s!=null?l=SH("name",s,a):l=Ti(a,function(h){return!!h}),AH(l,e)},t.prototype.findComponents=function(e){var i=e.query,r=e.mainType,o=a(i),s=o?this.queryComponents(o):Ti(this._componentsMap.get(r),function(h){return!!h});return l(AH(s,e));function a(h){var u=r+"Index",d=r+"Id",c=r+"Name";return h&&(h[u]!=null||h[d]!=null||h[c]!=null)?{mainType:r,index:h[u],id:h[d],name:h[c]}:null}function l(h){return e.filter?Ti(h,e.filter):h}},t.prototype.eachComponent=function(e,i,r){var o=this._componentsMap;if(jt(e)){var s=i,a=e;o.each(function(d,c){for(var f=0;d&&f<d.length;f++){var g=d[f];g&&a.call(s,c,g,g.componentIndex)}})}else for(var l=Pt(e)?o.get(e):Ht(e)?this.findComponents(e):null,h=0;l&&h<l.length;h++){var u=l[h];u&&i.call(r,u,u.componentIndex)}},t.prototype.getSeriesByName=function(e){var i=_o(e,null);return Ti(this._componentsMap.get("series"),function(r){return!!r&&i!=null&&r.name===i})},t.prototype.getSeriesByIndex=function(e){return this._componentsMap.get("series")[e]},t.prototype.getSeriesByType=function(e){return Ti(this._componentsMap.get("series"),function(i){return!!i&&i.subType===e})},t.prototype.getSeries=function(){return Ti(this._componentsMap.get("series"),function(e){return!!e})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(e,i){Up(this),N(this._seriesIndices,function(r){var o=this._componentsMap.get("series")[r];e.call(i,o,r)},this)},t.prototype.eachRawSeries=function(e,i){N(this._componentsMap.get("series"),function(r){r&&e.call(i,r,r.componentIndex)})},t.prototype.eachSeriesByType=function(e,i,r){Up(this),N(this._seriesIndices,function(o){var s=this._componentsMap.get("series")[o];s.subType===e&&i.call(r,s,o)},this)},t.prototype.eachRawSeriesByType=function(e,i,r){return N(this.getSeriesByType(e),i,r)},t.prototype.isSeriesFiltered=function(e){return Up(this),this._seriesIndicesMap.get(e.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(e,i){Up(this);var r=[];N(this._seriesIndices,function(o){var s=this._componentsMap.get("series")[o];e.call(i,s,o)&&r.push(o)},this),this._seriesIndices=r,this._seriesIndicesMap=$t(r)},t.prototype.restoreData=function(e){ub(this);var i=this._componentsMap,r=[];i.each(function(o,s){$e.hasClass(s)&&r.push(s)}),$e.topologicalTravel(r,$e.getAllClassMainTypes(),function(o){N(i.get(o),function(s){s&&(o!=="series"||!Nrt(s,e))&&s.restoreData()})})},t.internalField=function(){ub=function(e){var i=e._seriesIndices=[];N(e._componentsMap.get("series"),function(r){r&&i.push(r.componentIndex)}),e._seriesIndicesMap=$t(i)},Up=function(e){},wH=function(e,i){e.option={},e.option[xH]=zrt,e._componentsMap=$t({series:[]}),e._componentsCount=$t();var r=i.aria;Ht(r)&&r.enabled==null&&(r.enabled=!0),Wrt(i,e._theme.option),we(i,Rrt,!1),e._mergeOption(i,null)}}(),t}(ui);function Nrt(n,t){if(t){var e=t.seriesIndex,i=t.seriesId,r=t.seriesName;return e!=null&&n.componentIndex!==e||i!=null&&n.id!==i||r!=null&&n.name!==r}}function Wrt(n,t){var e=n.color&&!n.colorLayer;N(t,function(i,r){r==="colorLayer"&&e||$e.hasClass(r)||(typeof i=="object"?n[r]=n[r]?we(n[r],i,!1):ne(i):n[r]==null&&(n[r]=i))})}function SH(n,t,e){if(_t(t)){var i=$t();return N(t,function(o){if(o!=null){var s=_o(o,null);s!=null&&i.set(o,!0)}}),Ti(e,function(o){return o&&i.get(o[n])})}else{var r=_o(t,null);return Ti(e,function(o){return o&&r!=null&&o[n]===r})}}function AH(n,t){return t.hasOwnProperty("subType")?Ti(n,function(e){return e&&e.subType===t.subType}):n}function TH(n){var t=$t();return n&&N(Ni(n.replaceMerge),function(e){t.set(e,!0)}),{replaceMergeMainTypeMap:t}}ea(eL,tL);var Vrt=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],e$=function(){function n(t){N(Vrt,function(e){this[e]=zt(t[e],t)},this)}return n}(),aM={},iL=function(){function n(){this._coordinateSystems=[]}return n.prototype.create=function(t,e){var i=[];N(aM,function(r,o){var s=r.create(t,e);i=i.concat(s||[])}),this._coordinateSystems=i},n.prototype.update=function(t,e){N(this._coordinateSystems,function(i){i.update&&i.update(t,e)})},n.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},n.register=function(t,e){aM[t]=e},n.get=function(t){return aM[t]},n}(),Grt=/^(min|max)?(.+)$/,$rt=function(){function n(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return n.prototype.setOption=function(t,e,i){t&&(N(Ni(t.series),function(s){s&&s.data&&Kr(s.data)&&k2(s.data)}),N(Ni(t.dataset),function(s){s&&s.source&&Kr(s.source)&&k2(s.source)})),t=ne(t);var r=this._optionBackup,o=jrt(t,e,!r);this._newBaseOption=o.baseOption,r?(o.timelineOptions.length&&(r.timelineOptions=o.timelineOptions),o.mediaList.length&&(r.mediaList=o.mediaList),o.mediaDefault&&(r.mediaDefault=o.mediaDefault)):this._optionBackup=o},n.prototype.mountOption=function(t){var e=this._optionBackup;return this._timelineOptions=e.timelineOptions,this._mediaList=e.mediaList,this._mediaDefault=e.mediaDefault,this._currentMediaIndices=[],ne(t?e.baseOption:this._newBaseOption)},n.prototype.getTimelineOption=function(t){var e,i=this._timelineOptions;if(i.length){var r=t.getComponent("timeline");r&&(e=ne(i[r.getCurrentIndex()]))}return e},n.prototype.getMediaOption=function(t){var e=this._api.getWidth(),i=this._api.getHeight(),r=this._mediaList,o=this._mediaDefault,s=[],a=[];if(!r.length&&!o)return a;for(var l=0,h=r.length;l<h;l++)Urt(r[l].query,e,i)&&s.push(l);return!s.length&&o&&(s=[-1]),s.length&&!Yrt(s,this._currentMediaIndices)&&(a=St(s,function(u){return ne(u===-1?o.option:r[u].option)})),this._currentMediaIndices=s,a},n}();function jrt(n,t,e){var i=[],r,o,s=n.baseOption,a=n.timeline,l=n.options,h=n.media,u=!!n.media,d=!!(l||a||s&&s.timeline);s?(o=s,o.timeline||(o.timeline=a)):((d||u)&&(n.options=n.media=null),o=n),u&&_t(h)&&N(h,function(f){f&&f.option&&(f.query?i.push(f):r||(r=f))}),c(o),N(l,function(f){return c(f)}),N(i,function(f){return c(f.option)});function c(f){N(t,function(g){g(f,e)})}return{baseOption:o,timelineOptions:l||[],mediaDefault:r,mediaList:i}}function Urt(n,t,e){var i={width:t,height:e,aspectratio:t/e},r=!0;return N(n,function(o,s){var a=s.match(Grt);if(!(!a||!a[1]||!a[2])){var l=a[1],h=a[2].toLowerCase();Xrt(i[h],o,l)||(r=!1)}}),r}function Xrt(n,t,e){return e==="min"?n>=t:e==="max"?n<=t:n===t}function Yrt(n,t){return n.join(",")===t.join(",")}var Cs=N,J0=Ht,MH=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function lM(n){var t=n&&n.itemStyle;if(t)for(var e=0,i=MH.length;e<i;e++){var r=MH[e],o=t.normal,s=t.emphasis;o&&o[r]&&(n[r]=n[r]||{},n[r].normal?we(n[r].normal,o[r]):n[r].normal=o[r],o[r]=null),s&&s[r]&&(n[r]=n[r]||{},n[r].emphasis?we(n[r].emphasis,s[r]):n[r].emphasis=s[r],s[r]=null)}}function pr(n,t,e){if(n&&n[t]&&(n[t].normal||n[t].emphasis)){var i=n[t].normal,r=n[t].emphasis;i&&(e?(n[t].normal=n[t].emphasis=null,Gt(n[t],i)):n[t]=i),r&&(n.emphasis=n.emphasis||{},n.emphasis[t]=r,r.focus&&(n.emphasis.focus=r.focus),r.blurScope&&(n.emphasis.blurScope=r.blurScope))}}function Dv(n){pr(n,"itemStyle"),pr(n,"lineStyle"),pr(n,"areaStyle"),pr(n,"label"),pr(n,"labelLine"),pr(n,"upperLabel"),pr(n,"edgeLabel")}function ln(n,t){var e=J0(n)&&n[t],i=J0(e)&&e.textStyle;if(i)for(var r=0,o=kI.length;r<o;r++){var s=kI[r];i.hasOwnProperty(s)&&(e[s]=i[s])}}function zo(n){n&&(Dv(n),ln(n,"label"),n.emphasis&&ln(n.emphasis,"label"))}function Krt(n){if(J0(n)){lM(n),Dv(n),ln(n,"label"),ln(n,"upperLabel"),ln(n,"edgeLabel"),n.emphasis&&(ln(n.emphasis,"label"),ln(n.emphasis,"upperLabel"),ln(n.emphasis,"edgeLabel"));var t=n.markPoint;t&&(lM(t),zo(t));var e=n.markLine;e&&(lM(e),zo(e));var i=n.markArea;i&&zo(i);var r=n.data;if(n.type==="graph"){r=r||n.nodes;var o=n.links||n.edges;if(o&&!Kr(o))for(var s=0;s<o.length;s++)zo(o[s]);N(n.categories,function(h){Dv(h)})}if(r&&!Kr(r))for(var s=0;s<r.length;s++)zo(r[s]);if(t=n.markPoint,t&&t.data)for(var a=t.data,s=0;s<a.length;s++)zo(a[s]);if(e=n.markLine,e&&e.data)for(var l=e.data,s=0;s<l.length;s++)_t(l[s])?(zo(l[s][0]),zo(l[s][1])):zo(l[s]);n.type==="gauge"?(ln(n,"axisLabel"),ln(n,"title"),ln(n,"detail")):n.type==="treemap"?(pr(n.breadcrumb,"itemStyle"),N(n.levels,function(h){Dv(h)})):n.type==="tree"&&Dv(n.leaves)}}function il(n){return _t(n)?n:n?[n]:[]}function RH(n){return(_t(n)?n[0]:n)||{}}function qrt(n,t){Cs(il(n.series),function(i){J0(i)&&Krt(i)});var e=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&e.push("valueAxis","categoryAxis","logAxis","timeAxis"),Cs(e,function(i){Cs(il(n[i]),function(r){r&&(ln(r,"axisLabel"),ln(r.axisPointer,"label"))})}),Cs(il(n.parallel),function(i){var r=i&&i.parallelAxisDefault;ln(r,"axisLabel"),ln(r&&r.axisPointer,"label")}),Cs(il(n.calendar),function(i){pr(i,"itemStyle"),ln(i,"dayLabel"),ln(i,"monthLabel"),ln(i,"yearLabel")}),Cs(il(n.radar),function(i){ln(i,"name"),i.name&&i.axisName==null&&(i.axisName=i.name,delete i.name),i.nameGap!=null&&i.axisNameGap==null&&(i.axisNameGap=i.nameGap,delete i.nameGap)}),Cs(il(n.geo),function(i){J0(i)&&(zo(i),Cs(il(i.regions),function(r){zo(r)}))}),Cs(il(n.timeline),function(i){zo(i),pr(i,"label"),pr(i,"itemStyle"),pr(i,"controlStyle",!0);var r=i.data;_t(r)&&N(r,function(o){Ht(o)&&(pr(o,"label"),pr(o,"itemStyle"))})}),Cs(il(n.toolbox),function(i){pr(i,"iconStyle"),Cs(i.feature,function(r){pr(r,"iconStyle")})}),ln(RH(n.axisPointer),"label"),ln(RH(n.tooltip).axisPointer,"label")}function Zrt(n,t){for(var e=t.split(","),i=n,r=0;r<e.length&&(i=i&&i[e[r]],i!=null);r++);return i}function Jrt(n,t,e,i){for(var r=t.split(","),o=n,s,a=0;a<r.length-1;a++)s=r[a],o[s]==null&&(o[s]={}),o=o[s];o[r[a]]==null&&(o[r[a]]=e)}function BH(n){n&&N(Qrt,function(t){t[0]in n&&!(t[1]in n)&&(n[t[1]]=n[t[0]])})}var Qrt=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],tot=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],hM=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function Xp(n){var t=n&&n.itemStyle;if(t)for(var e=0;e<hM.length;e++){var i=hM[e][1],r=hM[e][0];t[i]!=null&&(t[r]=t[i])}}function PH(n){n&&n.alignTo==="edge"&&n.margin!=null&&n.edgeDistance==null&&(n.edgeDistance=n.margin)}function kH(n){n&&n.downplay&&!n.blur&&(n.blur=n.downplay)}function eot(n){n&&n.focusNodeAdjacency!=null&&(n.emphasis=n.emphasis||{},n.emphasis.focus==null&&(n.emphasis.focus="adjacency"))}function i$(n,t){if(n)for(var e=0;e<n.length;e++)t(n[e]),n[e]&&i$(n[e].children,t)}function n$(n,t){qrt(n,t),n.series=Ni(n.series),N(n.series,function(e){if(Ht(e)){var i=e.type;if(i==="line")e.clipOverflow!=null&&(e.clip=e.clipOverflow);else if(i==="pie"||i==="gauge"){e.clockWise!=null&&(e.clockwise=e.clockWise),PH(e.label);var r=e.data;if(r&&!Kr(r))for(var o=0;o<r.length;o++)PH(r[o]);e.hoverOffset!=null&&(e.emphasis=e.emphasis||{},(e.emphasis.scaleSize=null)&&(e.emphasis.scaleSize=e.hoverOffset))}else if(i==="gauge"){var s=Zrt(e,"pointer.color");s!=null&&Jrt(e,"itemStyle.color",s)}else if(i==="bar"){Xp(e),Xp(e.backgroundStyle),Xp(e.emphasis);var r=e.data;if(r&&!Kr(r))for(var o=0;o<r.length;o++)typeof r[o]=="object"&&(Xp(r[o]),Xp(r[o]&&r[o].emphasis))}else if(i==="sunburst"){var a=e.highlightPolicy;a&&(e.emphasis=e.emphasis||{},e.emphasis.focus||(e.emphasis.focus=a)),kH(e),i$(e.data,kH)}else i==="graph"||i==="sankey"?eot(e):i==="map"&&(e.mapType&&!e.map&&(e.map=e.mapType),e.mapLocation&&Gt(e,e.mapLocation));e.hoverAnimation!=null&&(e.emphasis=e.emphasis||{},e.emphasis&&e.emphasis.scale==null&&(e.emphasis.scale=e.hoverAnimation)),BH(e)}}),n.dataRange&&(n.visualMap=n.dataRange),N(tot,function(e){var i=n[e];i&&(_t(i)||(i=[i]),N(i,function(r){BH(r)}))})}function iot(n){var t=$t();n.eachSeries(function(e){var i=e.get("stack");if(i){var r=t.get(i)||t.set(i,[]),o=e.getData(),s={stackResultDimension:o.getCalculationInfo("stackResultDimension"),stackedOverDimension:o.getCalculationInfo("stackedOverDimension"),stackedDimension:o.getCalculationInfo("stackedDimension"),stackedByDimension:o.getCalculationInfo("stackedByDimension"),isStackedByIndex:o.getCalculationInfo("isStackedByIndex"),data:o,seriesModel:e};if(!s.stackedDimension||!(s.isStackedByIndex||s.stackedByDimension))return;r.length&&o.setCalculationInfo("stackedOnSeries",r[r.length-1].seriesModel),r.push(s)}}),t.each(not)}function not(n){N(n,function(t,e){var i=[],r=[NaN,NaN],o=[t.stackResultDimension,t.stackedOverDimension],s=t.data,a=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";s.modify(o,function(h,u,d){var c=s.get(t.stackedDimension,d);if(isNaN(c))return r;var f,g;a?g=s.getRawIndex(d):f=s.get(t.stackedByDimension,d);for(var p=NaN,v=e-1;v>=0;v--){var m=n[v];if(a||(g=m.data.rawIndexOf(m.stackedByDimension,f)),g>=0){var y=m.data.getByRawIndex(m.stackResultDimension,g);if(l==="all"||l==="positive"&&y>0||l==="negative"&&y<0||l==="samesign"&&c>=0&&y>0||l==="samesign"&&c<=0&&y<0){c=Iet(c,y),p=y;break}}}return i[0]=c,i[1]=p,i})})}var wS=function(){function n(t){this.data=t.data||(t.sourceFormat===ja?{}:[]),this.sourceFormat=t.sourceFormat||q9,this.seriesLayoutBy=t.seriesLayoutBy||Ol,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var e=this.dimensionsDefine=t.dimensionsDefine;if(e)for(var i=0;i<e.length;i++){var r=e[i];r.type==null&&J9(this,i)===$n.Must&&(r.type="ordinal")}}return n}();function nL(n){return n instanceof wS}function hB(n,t,e){e=e||o$(n);var i=t.seriesLayoutBy,r=oot(n,e,i,t.sourceHeader,t.dimensions),o=new wS({data:n,sourceFormat:e,seriesLayoutBy:i,dimensionsDefine:r.dimensionsDefine,startIndex:r.startIndex,dimensionsDetectedCount:r.dimensionsDetectedCount,metaRawOption:ne(t)});return o}function r$(n){return new wS({data:n,sourceFormat:Kr(n)?Vh:bs})}function rot(n){return new wS({data:n.data,sourceFormat:n.sourceFormat,seriesLayoutBy:n.seriesLayoutBy,dimensionsDefine:ne(n.dimensionsDefine),startIndex:n.startIndex,dimensionsDetectedCount:n.dimensionsDetectedCount})}function o$(n){var t=q9;if(Kr(n))t=Vh;else if(_t(n)){n.length===0&&(t=qr);for(var e=0,i=n.length;e<i;e++){var r=n[e];if(r!=null){if(_t(r)||Kr(r)){t=qr;break}else if(Ht(r)){t=na;break}}}}else if(Ht(n)){for(var o in n)if(tc(n,o)&&Yr(n[o])){t=ja;break}}return t}function oot(n,t,e,i,r){var o,s;if(!n)return{dimensionsDefine:EH(r),startIndex:s,dimensionsDetectedCount:o};if(t===qr){var a=n;i==="auto"||i==null?LH(function(h){h!=null&&h!=="-"&&(Pt(h)?s==null&&(s=1):s=0)},e,a,10):s=di(i)?i:i?1:0,!r&&s===1&&(r=[],LH(function(h,u){r[u]=h!=null?h+"":""},e,a,1/0)),o=r?r.length:e===pp?a.length:a[0]?a[0].length:null}else if(t===na)r||(r=sot(n));else if(t===ja)r||(r=[],N(n,function(h,u){r.push(u)}));else if(t===bs){var l=oy(n[0]);o=_t(l)&&l.length||1}return{startIndex:s,dimensionsDefine:EH(r),dimensionsDetectedCount:o}}function sot(n){for(var t=0,e;t<n.length&&!(e=n[t++]););if(e)return yi(e)}function EH(n){if(n){var t=$t();return St(n,function(e,i){e=Ht(e)?e:{name:e};var r={name:e.name,displayName:e.displayName,type:e.type};if(r.name==null)return r;r.name+="",r.displayName==null&&(r.displayName=r.name);var o=t.get(r.name);return o?r.name+="-"+o.count++:t.set(r.name,{count:1}),r})}}function LH(n,t,e,i){if(t===pp)for(var r=0;r<e.length&&r<i;r++)n(e[r]?e[r][0]:null,r);else for(var o=e[0]||[],r=0;r<o.length&&r<i;r++)n(o[r],r)}function s$(n){var t=n.sourceFormat;return t===na||t===ja}var Hu,Fu,zu,OH,DH,a$=function(){function n(t,e){var i=nL(t)?t:r$(t);this._source=i;var r=this._data=i.data;i.sourceFormat===Vh&&(this._offset=0,this._dimSize=e,this._data=r),DH(this,r,i)}return n.prototype.getSource=function(){return this._source},n.prototype.count=function(){return 0},n.prototype.getItem=function(t,e){},n.prototype.appendData=function(t){},n.prototype.clean=function(){},n.protoInitialize=function(){var t=n.prototype;t.pure=!1,t.persistent=!0}(),n.internalField=function(){var t;DH=function(s,a,l){var h=l.sourceFormat,u=l.seriesLayoutBy,d=l.startIndex,c=l.dimensionsDefine,f=OH[rL(h,u)];if(ft(s,f),h===Vh)s.getItem=e,s.count=r,s.fillStorage=i;else{var g=l$(h,u);s.getItem=zt(g,null,a,d,c);var p=h$(h,u);s.count=zt(p,null,a,d,c)}};var e=function(s,a){s=s-this._offset,a=a||[];for(var l=this._data,h=this._dimSize,u=h*s,d=0;d<h;d++)a[d]=l[u+d];return a},i=function(s,a,l,h){for(var u=this._data,d=this._dimSize,c=0;c<d;c++){for(var f=h[c],g=f[0]==null?1/0:f[0],p=f[1]==null?-1/0:f[1],v=a-s,m=l[c],y=0;y<v;y++){var b=u[y*d+c];m[s+y]=b,b<g&&(g=b),b>p&&(p=b)}f[0]=g,f[1]=p}},r=function(){return this._data?this._data.length/this._dimSize:0};OH=(t={},t[qr+"_"+Ol]={pure:!0,appendData:o},t[qr+"_"+pp]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[na]={pure:!0,appendData:o},t[ja]={pure:!0,appendData:function(s){var a=this._data;N(s,function(l,h){for(var u=a[h]||(a[h]=[]),d=0;d<(l||[]).length;d++)u.push(l[d])})}},t[bs]={appendData:o},t[Vh]={persistent:!1,pure:!0,appendData:function(s){this._data=s},clean:function(){this._offset+=this.count(),this._data=null}},t);function o(s){for(var a=0;a<s.length;a++)this._data.push(s[a])}}(),n}(),IH=function(n,t,e,i){return n[i]},aot=(Hu={},Hu[qr+"_"+Ol]=function(n,t,e,i){return n[i+t]},Hu[qr+"_"+pp]=function(n,t,e,i,r){i+=t;for(var o=r||[],s=n,a=0;a<s.length;a++){var l=s[a];o[a]=l?l[i]:null}return o},Hu[na]=IH,Hu[ja]=function(n,t,e,i,r){for(var o=r||[],s=0;s<e.length;s++){var a=e[s].name,l=n[a];o[s]=l?l[i]:null}return o},Hu[bs]=IH,Hu);function l$(n,t){var e=aot[rL(n,t)];return e}var HH=function(n,t,e){return n.length},lot=(Fu={},Fu[qr+"_"+Ol]=function(n,t,e){return Math.max(0,n.length-t)},Fu[qr+"_"+pp]=function(n,t,e){var i=n[0];return i?Math.max(0,i.length-t):0},Fu[na]=HH,Fu[ja]=function(n,t,e){var i=e[0].name,r=n[i];return r?r.length:0},Fu[bs]=HH,Fu);function h$(n,t){var e=lot[rL(n,t)];return e}var uM=function(n,t,e){return n[t]},hot=(zu={},zu[qr]=uM,zu[na]=function(n,t,e){return n[e]},zu[ja]=uM,zu[bs]=function(n,t,e){var i=oy(n);return i instanceof Array?i[t]:i},zu[Vh]=uM,zu);function u$(n){var t=hot[n];return t}function rL(n,t){return n===qr?n+"_"+t:n}function xg(n,t,e){if(n){var i=n.getRawDataItem(t);if(i!=null){var r=n.getStore(),o=r.getSource().sourceFormat;if(e!=null){var s=n.getDimensionIndex(e),a=r.getDimensionProperty(s);return u$(o)(i,s,a)}else{var l=i;return o===bs&&(l=oy(i)),l}}}}var uot=/\{@(.+?)\}/g,dot=function(){function n(){}return n.prototype.getDataParams=function(t,e){var i=this.getData(e),r=this.getRawValue(t,e),o=i.getRawIndex(t),s=i.getName(t),a=i.getRawDataItem(t),l=i.getItemVisual(t,"style"),h=l&&l[i.getItemVisual(t,"drawType")||"fill"],u=l&&l.stroke,d=this.mainType,c=d==="series",f=i.userOutput&&i.userOutput.get();return{componentType:d,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:c?this.subType:null,seriesIndex:this.seriesIndex,seriesId:c?this.id:null,seriesName:c?this.name:null,name:s,dataIndex:o,data:a,dataType:e,value:r,color:h,borderColor:u,dimensionNames:f?f.fullDimensions:null,encode:f?f.encode:null,$vars:["seriesName","name","value"]}},n.prototype.getFormattedLabel=function(t,e,i,r,o,s){e=e||"normal";var a=this.getData(i),l=this.getDataParams(t,i);if(s&&(l.value=s.interpolatedValue),r!=null&&_t(l.value)&&(l.value=l.value[r]),!o){var h=a.getItemModel(t);o=h.get(e==="normal"?["label","formatter"]:[e,"label","formatter"])}if(jt(o))return l.status=e,l.dimensionIndex=r,o(l);if(Pt(o)){var u=U9(o,l);return u.replace(uot,function(d,c){var f=c.length,g=c;g.charAt(0)==="["&&g.charAt(f-1)==="]"&&(g=+g.slice(1,f-1));var p=xg(a,t,g);if(s&&_t(s.interpolatedValue)){var v=a.getDimensionIndex(g);v>=0&&(p=s.interpolatedValue[v])}return p!=null?p+"":""})}},n.prototype.getRawValue=function(t,e){return xg(this.getData(e),t)},n.prototype.formatTooltip=function(t,e,i){},n}();function FH(n){var t,e;return Ht(n)?n.type&&(e=n):t=n,{text:t,frag:e}}function d0(n){return new cot(n)}var cot=function(){function n(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return n.prototype.perform=function(t){var e=this._upstream,i=t&&t.skip;if(this._dirty&&e){var r=this.context;r.data=r.outputData=e.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var o;this._plan&&!i&&(o=this._plan(this.context));var s=u(this._modBy),a=this._modDataCount||0,l=u(t&&t.modBy),h=t&&t.modDataCount||0;(s!==l||a!==h)&&(o="reset");function u(y){return!(y>=1)&&(y=1),y}var d;(this._dirty||o==="reset")&&(this._dirty=!1,d=this._doReset(i)),this._modBy=l,this._modDataCount=h;var c=t&&t.step;if(e?this._dueEnd=e._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var f=this._dueIndex,g=Math.min(c!=null?this._dueIndex+c:1/0,this._dueEnd);if(!i&&(d||f<g)){var p=this._progress;if(_t(p))for(var v=0;v<p.length;v++)this._doProgress(p[v],f,g,l,h);else this._doProgress(p,f,g,l,h)}this._dueIndex=g;var m=this._settedOutputEnd!=null?this._settedOutputEnd:g;this._outputDueEnd=m}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},n.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},n.prototype._doProgress=function(t,e,i,r,o){zH.reset(e,i,r,o),this._callingProgress=t,this._callingProgress({start:e,end:i,count:i-e,next:zH.next},this.context)},n.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var e,i;!t&&this._reset&&(e=this._reset(this.context),e&&e.progress&&(i=e.forceFirstProgress,e=e.progress),_t(e)&&!e.length&&(e=null)),this._progress=e,this._modBy=this._modDataCount=null;var r=this._downstream;return r&&r.dirty(),i},n.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},n.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},n.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},n.prototype.getUpstream=function(){return this._upstream},n.prototype.getDownstream=function(){return this._downstream},n.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},n}(),zH=function(){var n,t,e,i,r,o={reset:function(l,h,u,d){t=l,n=h,e=u,i=d,r=Math.ceil(i/e),o.next=e>1&&i>0?a:s}};return o;function s(){return t<n?t++:null}function a(){var l=t%r*e+Math.ceil(t/r),h=t>=n?null:l<i?l:t;return t++,h}}();function J_(n,t){var e=t&&t.type;return e==="ordinal"?n:(e==="time"&&!di(n)&&n!=null&&n!=="-"&&(n=+Wl(n)),n==null||n===""?NaN:Number(n))}$t({number:function(n){return parseFloat(n)},time:function(n){return+Wl(n)},trim:function(n){return Pt(n)?Ba(n):n}});var fot=function(){function n(t,e){var i=t==="desc";this._resultLT=i?1:-1,e==null&&(e=i?"min":"max"),this._incomparable=e==="min"?-1/0:1/0}return n.prototype.evaluate=function(t,e){var i=di(t)?t:IC(t),r=di(e)?e:IC(e),o=isNaN(i),s=isNaN(r);if(o&&(i=this._incomparable),s&&(r=this._incomparable),o&&s){var a=Pt(t),l=Pt(e);a&&(i=l?t:0),l&&(r=a?e:0)}return i<r?this._resultLT:i>r?-this._resultLT:0},n}(),got=function(){function n(){}return n.prototype.getRawData=function(){throw new Error("not supported")},n.prototype.getRawDataItem=function(t){throw new Error("not supported")},n.prototype.cloneRawData=function(){},n.prototype.getDimensionInfo=function(t){},n.prototype.cloneAllDimensionInfo=function(){},n.prototype.count=function(){},n.prototype.retrieveValue=function(t,e){},n.prototype.retrieveValueFromItem=function(t,e){},n.prototype.convertValue=function(t,e){return J_(t,e)},n}();function pot(n,t){var e=new got,i=n.data,r=e.sourceFormat=n.sourceFormat,o=n.startIndex,s="";n.seriesLayoutBy!==Ol&&Fr(s);var a=[],l={},h=n.dimensionsDefine;if(h)N(h,function(p,v){var m=p.name,y={index:v,name:m,displayName:p.displayName};if(a.push(y),m!=null){var b="";tc(l,m)&&Fr(b),l[m]=y}});else for(var u=0;u<n.dimensionsDetectedCount;u++)a.push({index:u});var d=l$(r,Ol);t.__isBuiltIn&&(e.getRawDataItem=function(p){return d(i,o,a,p)},e.getRawData=zt(vot,null,n)),e.cloneRawData=zt(mot,null,n);var c=h$(r,Ol);e.count=zt(c,null,i,o,a);var f=u$(r);e.retrieveValue=function(p,v){var m=d(i,o,a,p);return g(m,v)};var g=e.retrieveValueFromItem=function(p,v){if(p!=null){var m=a[v];if(m)return f(p,v,m.name)}};return e.getDimensionInfo=zt(yot,null,a,l),e.cloneAllDimensionInfo=zt(bot,null,a),e}function vot(n){var t=n.sourceFormat;if(!oL(t)){var e="";Fr(e)}return n.data}function mot(n){var t=n.sourceFormat,e=n.data;if(!oL(t)){var i="";Fr(i)}if(t===qr){for(var r=[],o=0,s=e.length;o<s;o++)r.push(e[o].slice());return r}else if(t===na){for(var r=[],o=0,s=e.length;o<s;o++)r.push(ft({},e[o]));return r}}function yot(n,t,e){if(e!=null){if(di(e)||!isNaN(e)&&!tc(t,e))return n[e];if(tc(t,e))return t[e]}}function bot(n){return ne(n)}var d$=$t();function _ot(n){n=ne(n);var t=n.type,e="";t||Fr(e);var i=t.split(":");i.length!==2&&Fr(e);var r=!1;i[0]==="echarts"&&(t=i[1],r=!0),n.__isBuiltIn=r,d$.set(t,n)}function Cot(n,t,e){var i=Ni(n),r=i.length,o="";r||Fr(o);for(var s=0,a=r;s<a;s++){var l=i[s];t=wot(l,t),s!==a-1&&(t.length=Math.max(t.length,1))}return t}function wot(n,t,e,i){var r="";t.length||Fr(r),Ht(n)||Fr(r);var o=n.type,s=d$.get(o);s||Fr(r);var a=St(t,function(h){return pot(h,s)}),l=Ni(s.transform({upstream:a[0],upstreamList:a,config:ne(n.config)}));return St(l,function(h,u){var d="";Ht(h)||Fr(d),h.data||Fr(d);var c=o$(h.data);oL(c)||Fr(d);var f,g=t[0];if(g&&u===0&&!h.dimensions){var p=g.startIndex;p&&(h.data=g.data.slice(0,p).concat(h.data)),f={seriesLayoutBy:Ol,sourceHeader:p,dimensions:g.metaRawOption.dimensions}}else f={seriesLayoutBy:Ol,sourceHeader:0,dimensions:h.dimensions};return hB(h.data,f,null)})}function oL(n){return n===qr||n===na}var xS="undefined",xot=typeof Uint32Array===xS?Array:Uint32Array,Sot=typeof Uint16Array===xS?Array:Uint16Array,c$=typeof Int32Array===xS?Array:Int32Array,NH=typeof Float64Array===xS?Array:Float64Array,f$={float:NH,int:c$,ordinal:Array,number:Array,time:NH},dM;function Gc(n){return n>65535?xot:Sot}function $c(){return[1/0,-1/0]}function Aot(n){var t=n.constructor;return t===Array?n.slice():new t(n)}function WH(n,t,e,i,r){var o=f$[e||"float"];if(r){var s=n[t],a=s&&s.length;if(a!==i){for(var l=new o(i),h=0;h<a;h++)l[h]=s[h];n[t]=l}}else n[t]=new o(i)}var uB=function(){function n(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=$t()}return n.prototype.initData=function(t,e,i){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var r=t.getSource(),o=this.defaultDimValueGetter=dM[r.sourceFormat];this._dimValueGetter=i||o,this._rawExtent=[],s$(r),this._dimensions=St(e,function(s){return{type:s.type,property:s.property}}),this._initDataFromProvider(0,t.count())},n.prototype.getProvider=function(){return this._provider},n.prototype.getSource=function(){return this._provider.getSource()},n.prototype.ensureCalculationDimension=function(t,e){var i=this._calcDimNameToIdx,r=this._dimensions,o=i.get(t);if(o!=null){if(r[o].type===e)return o}else o=r.length;return r[o]={type:e},i.set(t,o),this._chunks[o]=new f$[e||"float"](this._rawCount),this._rawExtent[o]=$c(),o},n.prototype.collectOrdinalMeta=function(t,e){var i=this._chunks[t],r=this._dimensions[t],o=this._rawExtent,s=r.ordinalOffset||0,a=i.length;s===0&&(o[t]=$c());for(var l=o[t],h=s;h<a;h++){var u=i[h]=e.parseAndCollect(i[h]);isNaN(u)||(l[0]=Math.min(u,l[0]),l[1]=Math.max(u,l[1]))}r.ordinalMeta=e,r.ordinalOffset=a,r.type="ordinal"},n.prototype.getOrdinalMeta=function(t){var e=this._dimensions[t],i=e.ordinalMeta;return i},n.prototype.getDimensionProperty=function(t){var e=this._dimensions[t];return e&&e.property},n.prototype.appendData=function(t){var e=this._provider,i=this.count();e.appendData(t);var r=e.count();return e.persistent||(r+=i),i<r&&this._initDataFromProvider(i,r,!0),[i,r]},n.prototype.appendValues=function(t,e){for(var i=this._chunks,r=this._dimensions,o=r.length,s=this._rawExtent,a=this.count(),l=a+Math.max(t.length,e||0),h=0;h<o;h++){var u=r[h];WH(i,h,u.type,l,!0)}for(var d=[],c=a;c<l;c++)for(var f=c-a,g=0;g<o;g++){var u=r[g],p=dM.arrayRows.call(this,t[f]||d,u.property,f,g);i[g][c]=p;var v=s[g];p<v[0]&&(v[0]=p),p>v[1]&&(v[1]=p)}return this._rawCount=this._count=l,{start:a,end:l}},n.prototype._initDataFromProvider=function(t,e,i){for(var r=this._provider,o=this._chunks,s=this._dimensions,a=s.length,l=this._rawExtent,h=St(s,function(y){return y.property}),u=0;u<a;u++){var d=s[u];l[u]||(l[u]=$c()),WH(o,u,d.type,e,i)}if(r.fillStorage)r.fillStorage(t,e,o,l);else for(var c=[],f=t;f<e;f++){c=r.getItem(f,c);for(var g=0;g<a;g++){var p=o[g],v=this._dimValueGetter(c,h[g],f,g);p[f]=v;var m=l[g];v<m[0]&&(m[0]=v),v>m[1]&&(m[1]=v)}}!r.persistent&&r.clean&&r.clean(),this._rawCount=this._count=e,this._extent=[]},n.prototype.count=function(){return this._count},n.prototype.get=function(t,e){if(!(e>=0&&e<this._count))return NaN;var i=this._chunks[t];return i?i[this.getRawIndex(e)]:NaN},n.prototype.getValues=function(t,e){var i=[],r=[];if(e==null){e=t,t=[];for(var o=0;o<this._dimensions.length;o++)r.push(o)}else r=t;for(var o=0,s=r.length;o<s;o++)i.push(this.get(r[o],e));return i},n.prototype.getByRawIndex=function(t,e){if(!(e>=0&&e<this._rawCount))return NaN;var i=this._chunks[t];return i?i[e]:NaN},n.prototype.getSum=function(t){var e=this._chunks[t],i=0;if(e)for(var r=0,o=this.count();r<o;r++){var s=this.get(t,r);isNaN(s)||(i+=s)}return i},n.prototype.getMedian=function(t){var e=[];this.each([t],function(o){isNaN(o)||e.push(o)});var i=e.sort(function(o,s){return o-s}),r=this.count();return r===0?0:r%2===1?i[(r-1)/2]:(i[r/2]+i[r/2-1])/2},n.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var e=this._indices,i=e[t];if(i!=null&&i<this._count&&i===t)return t;for(var r=0,o=this._count-1;r<=o;){var s=(r+o)/2|0;if(e[s]<t)r=s+1;else if(e[s]>t)o=s-1;else return s}return-1},n.prototype.indicesOfNearest=function(t,e,i){var r=this._chunks,o=r[t],s=[];if(!o)return s;i==null&&(i=1/0);for(var a=1/0,l=-1,h=0,u=0,d=this.count();u<d;u++){var c=this.getRawIndex(u),f=e-o[c],g=Math.abs(f);g<=i&&((g<a||g===a&&f>=0&&l<0)&&(a=g,l=f,h=0),f===l&&(s[h++]=u))}return s.length=h,s},n.prototype.getIndices=function(){var t,e=this._indices;if(e){var i=e.constructor,r=this._count;if(i===Array){t=new i(r);for(var o=0;o<r;o++)t[o]=e[o]}else t=new i(e.buffer,0,r)}else{var i=Gc(this._rawCount);t=new i(this.count());for(var o=0;o<t.length;o++)t[o]=o}return t},n.prototype.filter=function(t,e){if(!this._count)return this;for(var i=this.clone(),r=i.count(),o=Gc(i._rawCount),s=new o(r),a=[],l=t.length,h=0,u=t[0],d=i._chunks,c=0;c<r;c++){var f=void 0,g=i.getRawIndex(c);if(l===0)f=e(c);else if(l===1){var p=d[u][g];f=e(p,c)}else{for(var v=0;v<l;v++)a[v]=d[t[v]][g];a[v]=c,f=e.apply(null,a)}f&&(s[h++]=g)}return h<r&&(i._indices=s),i._count=h,i._extent=[],i._updateGetRawIdx(),i},n.prototype.selectRange=function(t){var e=this.clone(),i=e._count;if(!i)return this;var r=yi(t),o=r.length;if(!o)return this;var s=e.count(),a=Gc(e._rawCount),l=new a(s),h=0,u=r[0],d=t[u][0],c=t[u][1],f=e._chunks,g=!1;if(!e._indices){var p=0;if(o===1){for(var v=f[r[0]],m=0;m<i;m++){var y=v[m];(y>=d&&y<=c||isNaN(y))&&(l[h++]=p),p++}g=!0}else if(o===2){for(var v=f[r[0]],b=f[r[1]],_=t[r[1]][0],w=t[r[1]][1],m=0;m<i;m++){var y=v[m],C=b[m];(y>=d&&y<=c||isNaN(y))&&(C>=_&&C<=w||isNaN(C))&&(l[h++]=p),p++}g=!0}}if(!g)if(o===1)for(var m=0;m<s;m++){var x=e.getRawIndex(m),y=f[r[0]][x];(y>=d&&y<=c||isNaN(y))&&(l[h++]=x)}else for(var m=0;m<s;m++){for(var S=!0,x=e.getRawIndex(m),A=0;A<o;A++){var T=r[A],y=f[T][x];(y<t[T][0]||y>t[T][1])&&(S=!1)}S&&(l[h++]=e.getRawIndex(m))}return h<s&&(e._indices=l),e._count=h,e._extent=[],e._updateGetRawIdx(),e},n.prototype.map=function(t,e){var i=this.clone(t);return this._updateDims(i,t,e),i},n.prototype.modify=function(t,e){this._updateDims(this,t,e)},n.prototype._updateDims=function(t,e,i){for(var r=t._chunks,o=[],s=e.length,a=t.count(),l=[],h=t._rawExtent,u=0;u<e.length;u++)h[e[u]]=$c();for(var d=0;d<a;d++){for(var c=t.getRawIndex(d),f=0;f<s;f++)l[f]=r[e[f]][c];l[s]=d;var g=i&&i.apply(null,l);if(g!=null){typeof g!="object"&&(o[0]=g,g=o);for(var u=0;u<g.length;u++){var p=e[u],v=g[u],m=h[p],y=r[p];y&&(y[c]=v),v<m[0]&&(m[0]=v),v>m[1]&&(m[1]=v)}}}},n.prototype.lttbDownSample=function(t,e){var i=this.clone([t],!0),r=i._chunks,o=r[t],s=this.count(),a=0,l=Math.floor(1/e),h=this.getRawIndex(0),u,d,c,f=new(Gc(this._rawCount))(Math.min((Math.ceil(s/l)+2)*2,s));f[a++]=h;for(var g=1;g<s-1;g+=l){for(var p=Math.min(g+l,s-1),v=Math.min(g+l*2,s),m=(v+p)/2,y=0,b=p;b<v;b++){var _=this.getRawIndex(b),w=o[_];isNaN(w)||(y+=w)}y/=v-p;var C=g,x=Math.min(g+l,s),S=g-1,A=o[h];u=-1,c=C;for(var T=-1,M=0,b=C;b<x;b++){var _=this.getRawIndex(b),w=o[_];if(isNaN(w)){M++,T<0&&(T=_);continue}d=Math.abs((S-m)*(w-A)-(S-b)*(y-A)),d>u&&(u=d,c=_)}M>0&&M<x-C&&(f[a++]=Math.min(T,c),c=Math.max(T,c)),f[a++]=c,h=c}return f[a++]=this.getRawIndex(s-1),i._count=a,i._indices=f,i.getRawIndex=this._getRawIdx,i},n.prototype.minmaxDownSample=function(t,e){for(var i=this.clone([t],!0),r=i._chunks,o=Math.floor(1/e),s=r[t],a=this.count(),l=new(Gc(this._rawCount))(Math.ceil(a/o)*2),h=0,u=0;u<a;u+=o){var d=u,c=s[this.getRawIndex(d)],f=u,g=s[this.getRawIndex(f)],p=o;u+o>a&&(p=a-u);for(var v=0;v<p;v++){var m=this.getRawIndex(u+v),y=s[m];y<c&&(c=y,d=u+v),y>g&&(g=y,f=u+v)}var b=this.getRawIndex(d),_=this.getRawIndex(f);d<f?(l[h++]=b,l[h++]=_):(l[h++]=_,l[h++]=b)}return i._count=h,i._indices=l,i._updateGetRawIdx(),i},n.prototype.downSample=function(t,e,i,r){for(var o=this.clone([t],!0),s=o._chunks,a=[],l=Math.floor(1/e),h=s[t],u=this.count(),d=o._rawExtent[t]=$c(),c=new(Gc(this._rawCount))(Math.ceil(u/l)),f=0,g=0;g<u;g+=l){l>u-g&&(l=u-g,a.length=l);for(var p=0;p<l;p++){var v=this.getRawIndex(g+p);a[p]=h[v]}var m=i(a),y=this.getRawIndex(Math.min(g+r(a,m)||0,u-1));h[y]=m,m<d[0]&&(d[0]=m),m>d[1]&&(d[1]=m),c[f++]=y}return o._count=f,o._indices=c,o._updateGetRawIdx(),o},n.prototype.each=function(t,e){if(this._count)for(var i=t.length,r=this._chunks,o=0,s=this.count();o<s;o++){var a=this.getRawIndex(o);switch(i){case 0:e(o);break;case 1:e(r[t[0]][a],o);break;case 2:e(r[t[0]][a],r[t[1]][a],o);break;default:for(var l=0,h=[];l<i;l++)h[l]=r[t[l]][a];h[l]=o,e.apply(null,h)}}},n.prototype.getDataExtent=function(t){var e=this._chunks[t],i=$c();if(!e)return i;var r=this.count(),o=!this._indices,s;if(o)return this._rawExtent[t].slice();if(s=this._extent[t],s)return s.slice();s=i;for(var a=s[0],l=s[1],h=0;h<r;h++){var u=this.getRawIndex(h),d=e[u];d<a&&(a=d),d>l&&(l=d)}return s=[a,l],this._extent[t]=s,s},n.prototype.getRawDataItem=function(t){var e=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(e);for(var i=[],r=this._chunks,o=0;o<r.length;o++)i.push(r[o][e]);return i},n.prototype.clone=function(t,e){var i=new n,r=this._chunks,o=t&&Uh(t,function(a,l){return a[l]=!0,a},{});if(o)for(var s=0;s<r.length;s++)i._chunks[s]=o[s]?Aot(r[s]):r[s];else i._chunks=r;return this._copyCommonProps(i),e||(i._indices=this._cloneIndices()),i._updateGetRawIdx(),i},n.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=ne(this._extent),t._rawExtent=ne(this._rawExtent)},n.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,e=void 0;if(t===Array){var i=this._indices.length;e=new t(i);for(var r=0;r<i;r++)e[r]=this._indices[r]}else e=new t(this._indices);return e}return null},n.prototype._getRawIdxIdentity=function(t){return t},n.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},n.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},n.internalField=function(){function t(e,i,r,o){return J_(e[o],this._dimensions[o])}dM={arrayRows:t,objectRows:function(e,i,r,o){return J_(e[i],this._dimensions[o])},keyedColumns:t,original:function(e,i,r,o){var s=e&&(e.value==null?e:e.value);return J_(s instanceof Array?s[o]:s,this._dimensions[o])},typedArray:function(e,i,r,o){return e[o]}}}(),n}(),Tot=function(){function n(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return n.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},n.prototype._setLocalSource=function(t,e){this._sourceList=t,this._upstreamSignList=e,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},n.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},n.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},n.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,e=this._getUpstreamSourceManagers(),i=!!e.length,r,o;if(db(t)){var s=t,a=void 0,l=void 0,h=void 0;if(i){var u=e[0];u.prepareSource(),h=u.getSource(),a=h.data,l=h.sourceFormat,o=[u._getVersionSign()]}else a=s.get("data",!0),l=Kr(a)?Vh:bs,o=[];var d=this._getSourceMetaRawOption()||{},c=h&&h.metaRawOption||{},f=ve(d.seriesLayoutBy,c.seriesLayoutBy)||null,g=ve(d.sourceHeader,c.sourceHeader),p=ve(d.dimensions,c.dimensions),v=f!==c.seriesLayoutBy||!!g!=!!c.sourceHeader||p;r=v?[hB(a,{seriesLayoutBy:f,sourceHeader:g,dimensions:p},l)]:[]}else{var m=t;if(i){var y=this._applyTransform(e);r=y.sourceList,o=y.upstreamSignList}else{var b=m.get("source",!0);r=[hB(b,this._getSourceMetaRawOption(),null)],o=[]}}this._setLocalSource(r,o)},n.prototype._applyTransform=function(t){var e=this._sourceHost,i=e.get("transform",!0),r=e.get("fromTransformResult",!0);if(r!=null){var o="";t.length!==1&&VH(o)}var s,a=[],l=[];return N(t,function(h){h.prepareSource();var u=h.getSource(r||0),d="";r!=null&&!u&&VH(d),a.push(u),l.push(h._getVersionSign())}),i?s=Cot(i,a,{datasetIndex:e.componentIndex}):r!=null&&(s=[rot(a[0])]),{sourceList:s,upstreamSignList:l}},n.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),e=0;e<t.length;e++){var i=t[e];if(i._isDirty()||this._upstreamSignList[e]!==i._getVersionSign())return!0}},n.prototype.getSource=function(t){t=t||0;var e=this._sourceList[t];if(!e){var i=this._getUpstreamSourceManagers();return i[0]&&i[0].getSource(t)}return e},n.prototype.getSharedDataStore=function(t){var e=t.makeStoreSchema();return this._innerGetDataStore(e.dimensions,t.source,e.hash)},n.prototype._innerGetDataStore=function(t,e,i){var r=0,o=this._storeList,s=o[r];s||(s=o[r]={});var a=s[i];if(!a){var l=this._getUpstreamSourceManagers()[0];db(this._sourceHost)&&l?a=l._innerGetDataStore(t,e,i):(a=new uB,a.initData(new a$(e,t.length),t)),s[i]=a}return a},n.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(db(t)){var e=QE(t);return e?[e.getSourceManager()]:[]}else return St(Ert(t),function(i){return i.getSourceManager()})},n.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,e,i,r;if(db(t))e=t.get("seriesLayoutBy",!0),i=t.get("sourceHeader",!0),r=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var o=t;e=o.get("seriesLayoutBy",!0),i=o.get("sourceHeader",!0),r=o.get("dimensions",!0)}return{seriesLayoutBy:e,sourceHeader:i,dimensions:r}},n}();function db(n){return n.mainType==="series"}function VH(n){throw new Error(n)}var Mot="line-height:1";function g$(n){var t=n.lineHeight;return t==null?Mot:"line-height:"+Hr(t+"")+"px"}function p$(n,t){var e=n.color||"#6e7079",i=n.fontSize||12,r=n.fontWeight||"400",o=n.color||"#464646",s=n.fontSize||14,a=n.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+Hr(i+"")+"px;color:"+Hr(e)+";font-weight:"+Hr(r+""),valueStyle:"font-size:"+Hr(s+"")+"px;color:"+Hr(o)+";font-weight:"+Hr(a+"")}:{nameStyle:{fontSize:i,fill:e,fontWeight:r},valueStyle:{fontSize:s,fill:o,fontWeight:a}}}var Rot=[0,10,20,30],Bot=["",`
`,`

`,`


`];function Sg(n,t){return t.type=n,t}function dB(n){return n.type==="section"}function v$(n){return dB(n)?Pot:kot}function m$(n){if(dB(n)){var t=0,e=n.blocks.length,i=e>1||e>0&&!n.noHeader;return N(n.blocks,function(r){var o=m$(r);o>=t&&(t=o+ +(i&&(!o||dB(r)&&!r.noHeader)))}),t}return 0}function Pot(n,t,e,i){var r=t.noHeader,o=Eot(m$(t)),s=[],a=t.blocks||[];ps(!a||_t(a)),a=a||[];var l=n.orderMode;if(t.sortBlocks&&l){a=a.slice();var h={valueAsc:"asc",valueDesc:"desc"};if(tc(h,l)){var u=new fot(h[l],null);a.sort(function(p,v){return u.evaluate(p.sortParam,v.sortParam)})}else l==="seriesDesc"&&a.reverse()}N(a,function(p,v){var m=t.valueFormatter,y=v$(p)(m?ft(ft({},n),{valueFormatter:m}):n,p,v>0?o.html:0,i);y!=null&&s.push(y)});var d=n.renderMode==="richText"?s.join(o.richText):cB(i,s.join(""),r?e:o.html);if(r)return d;var c=aB(t.header,"ordinal",n.useUTC),f=p$(i,n.renderMode).nameStyle,g=g$(i);return n.renderMode==="richText"?y$(n,c,f)+o.richText+d:cB(i,'<div style="'+f+";"+g+';">'+Hr(c)+"</div>"+d,e)}function kot(n,t,e,i){var r=n.renderMode,o=t.noName,s=t.noValue,a=!t.markerType,l=t.name,h=n.useUTC,u=t.valueFormatter||n.valueFormatter||function(_){return _=_t(_)?_:[_],St(_,function(w,C){return aB(w,_t(f)?f[C]:f,h)})};if(!(o&&s)){var d=a?"":n.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",r),c=o?"":aB(l,"ordinal",h),f=t.valueType,g=s?[]:u(t.value,t.dataIndex),p=!a||!o,v=!a&&o,m=p$(i,r),y=m.nameStyle,b=m.valueStyle;return r==="richText"?(a?"":d)+(o?"":y$(n,c,y))+(s?"":Dot(n,g,p,v,b)):cB(i,(a?"":d)+(o?"":Lot(c,!a,y))+(s?"":Oot(g,p,v,b)),e)}}function GH(n,t,e,i,r,o){if(n){var s=v$(n),a={useUTC:r,renderMode:e,orderMode:i,markupStyleCreator:t,valueFormatter:n.valueFormatter};return s(a,n,0,o)}}function Eot(n){return{html:Rot[n],richText:Bot[n]}}function cB(n,t,e){var i='<div style="clear:both"></div>',r="margin: "+e+"px 0 0",o=g$(n);return'<div style="'+r+";"+o+';">'+t+i+"</div>"}function Lot(n,t,e){var i=t?"margin-left:2px":"";return'<span style="'+e+";"+i+'">'+Hr(n)+"</span>"}function Oot(n,t,e,i){var r=e?"10px":"20px",o=t?"float:right;margin-left:"+r:"";return n=_t(n)?n:[n],'<span style="'+o+";"+i+'">'+St(n,function(s){return Hr(s)}).join("&nbsp;&nbsp;")+"</span>"}function y$(n,t,e){return n.markupStyleCreator.wrapRichTextStyle(t,e)}function Dot(n,t,e,i,r){var o=[r],s=i?10:20;return e&&o.push({padding:[0,0,0,s],align:"right"}),n.markupStyleCreator.wrapRichTextStyle(_t(t)?t.join("  "):t,o)}function Iot(n,t){var e=n.getData().getItemVisual(t,"style"),i=e[n.visualDrawType];return nc(i)}function b$(n,t){var e=n.get("padding");return e??(t==="richText"?[8,10]:10)}var cM=function(){function n(){this.richTextStyles={},this._nextStyleNameId=V8()}return n.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},n.prototype.makeTooltipMarker=function(t,e,i){var r=i==="richText"?this._generateStyleName():null,o=wrt({color:e,type:t,renderMode:i,markerId:r});return Pt(o)?o:(this.richTextStyles[r]=o.style,o.content)},n.prototype.wrapRichTextStyle=function(t,e){var i={};_t(e)?N(e,function(o){return ft(i,o)}):ft(i,e);var r=this._generateStyleName();return this.richTextStyles[r]=i,"{"+r+"|"+t+"}"},n}();function Hot(n){var t=n.series,e=n.dataIndex,i=n.multipleSeries,r=t.getData(),o=r.mapDimensionsAll("defaultedTooltip"),s=o.length,a=t.getRawValue(e),l=_t(a),h=Iot(t,e),u,d,c,f;if(s>1||l&&!s){var g=Fot(a,t,e,o,h);u=g.inlineValues,d=g.inlineValueTypes,c=g.blocks,f=g.inlineValues[0]}else if(s){var p=r.getDimensionInfo(o[0]);f=u=xg(r,e,o[0]),d=p.type}else f=u=l?a[0]:a;var v=EE(t),m=v&&t.name||"",y=r.getName(e),b=i?m:y;return Sg("section",{header:m,noHeader:i||!v,sortParam:f,blocks:[Sg("nameValue",{markerType:"item",markerColor:h,name:b,noName:!Ba(b),value:u,valueType:d,dataIndex:e})].concat(c||[])})}function Fot(n,t,e,i,r){var o=t.getData(),s=Uh(n,function(d,c,f){var g=o.getDimensionInfo(f);return d=d||g&&g.tooltip!==!1&&g.displayName!=null},!1),a=[],l=[],h=[];i.length?N(i,function(d){u(xg(o,e,d),d)}):N(n,u);function u(d,c){var f=o.getDimensionInfo(c);!f||f.otherDims.tooltip===!1||(s?h.push(Sg("nameValue",{markerType:"subItem",markerColor:r,name:f.displayName,value:d,valueType:f.type})):(a.push(d),l.push(f.type)))}return{inlineValues:a,inlineValueTypes:l,blocks:h}}var rh=Ke();function cb(n,t){return n.getName(t)||n.getId(t)}var Q_="__universalTransitionEnabled",Ao=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._selectedDataIndicesMap={},e}return t.prototype.init=function(e,i,r){this.seriesIndex=this.componentIndex,this.dataTask=d0({count:Not,reset:Wot}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(e,r);var o=rh(this).sourceManager=new Tot(this);o.prepareSource();var s=this.getInitialData(e,r);jH(s,this),this.dataTask.context.data=s,rh(this).dataBeforeProcessed=s,$H(this),this._initSelectedMapFromData(s)},t.prototype.mergeDefaultAndTheme=function(e,i){var r=Z0(this),o=r?cy(e):{},s=this.subType;$e.hasClass(s)&&(s+="Series"),we(e,i.getTheme().get(this.subType)),we(e,this.getDefaultOption()),K2(e,"label",["show"]),this.fillDataTextStyle(e.data),r&&wg(e,o,r)},t.prototype.mergeOption=function(e,i){e=we(this.option,e,!0),this.fillDataTextStyle(e.data);var r=Z0(this);r&&wg(this.option,e,r);var o=rh(this).sourceManager;o.dirty(),o.prepareSource();var s=this.getInitialData(e,i);jH(s,this),this.dataTask.dirty(),this.dataTask.context.data=s,rh(this).dataBeforeProcessed=s,$H(this),this._initSelectedMapFromData(s)},t.prototype.fillDataTextStyle=function(e){if(e&&!Kr(e))for(var i=["show"],r=0;r<e.length;r++)e[r]&&e[r].label&&K2(e[r],"label",i)},t.prototype.getInitialData=function(e,i){},t.prototype.appendData=function(e){var i=this.getRawData();i.appendData(e.data)},t.prototype.getData=function(e){var i=fB(this);if(i){var r=i.context.data;return e==null||!r.getLinkedData?r:r.getLinkedData(e)}else return rh(this).data},t.prototype.getAllData=function(){var e=this.getData();return e&&e.getLinkedDataAll?e.getLinkedDataAll():[{data:e}]},t.prototype.setData=function(e){var i=fB(this);if(i){var r=i.context;r.outputData=e,i!==this.dataTask&&(r.data=e)}rh(this).data=e},t.prototype.getEncode=function(){var e=this.get("encode",!0);if(e)return $t(e)},t.prototype.getSourceManager=function(){return rh(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return rh(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var e=this.get("colorBy");return e||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var e=this.coordinateSystem;return e&&e.getBaseAxis&&e.getBaseAxis()},t.prototype.formatTooltip=function(e,i,r){return Hot({series:this,dataIndex:e,multipleSeries:i})},t.prototype.isAnimationEnabled=function(){var e=this.ecModel;if(ie.node&&!(e&&e.ssr))return!1;var i=this.getShallow("animation");return i&&this.getData().count()>this.getShallow("animationThreshold")&&(i=!1),!!i},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(e,i,r){var o=this.ecModel,s=tL.prototype.getColorFromPalette.call(this,e,i,r);return s||(s=o.getColorFromPalette(e,i,r)),s},t.prototype.coordDimToDataDim=function(e){return this.getRawData().mapDimensionsAll(e)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(e,i){this._innerSelect(this.getData(i),e)},t.prototype.unselect=function(e,i){var r=this.option.selectedMap;if(r){var o=this.option.selectedMode,s=this.getData(i);if(o==="series"||r==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var a=0;a<e.length;a++){var l=e[a],h=cb(s,l);r[h]=!1,this._selectedDataIndicesMap[h]=-1}}},t.prototype.toggleSelect=function(e,i){for(var r=[],o=0;o<e.length;o++)r[0]=e[o],this.isSelected(e[o],i)?this.unselect(r,i):this.select(r,i)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var e=this._selectedDataIndicesMap,i=yi(e),r=[],o=0;o<i.length;o++){var s=e[i[o]];s>=0&&r.push(s)}return r},t.prototype.isSelected=function(e,i){var r=this.option.selectedMap;if(!r)return!1;var o=this.getData(i);return(r==="all"||r[cb(o,e)])&&!o.getItemModel(e).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[Q_])return!0;var e=this.option.universalTransition;return e?e===!0?!0:e&&e.enabled:!1},t.prototype._innerSelect=function(e,i){var r,o,s=this.option,a=s.selectedMode,l=i.length;if(!(!a||!l)){if(a==="series")s.selectedMap="all";else if(a==="multiple"){Ht(s.selectedMap)||(s.selectedMap={});for(var h=s.selectedMap,u=0;u<l;u++){var d=i[u],c=cb(e,d);h[c]=!0,this._selectedDataIndicesMap[c]=e.getRawIndex(d)}}else if(a==="single"||a===!0){var f=i[l-1],c=cb(e,f);s.selectedMap=(r={},r[c]=!0,r),this._selectedDataIndicesMap=(o={},o[c]=e.getRawIndex(f),o)}}},t.prototype._initSelectedMapFromData=function(e){if(!this.option.selectedMap){var i=[];e.hasItemOption&&e.each(function(r){var o=e.getRawDataItem(r);o&&o.selected&&i.push(r)}),i.length>0&&this._innerSelect(e,i)}},t.registerClass=function(e){return $e.registerClass(e)},t.protoInitialize=function(){var e=t.prototype;e.type="series.__base__",e.seriesIndex=0,e.ignoreStyleOnData=!1,e.hasSymbolVisual=!1,e.defaultSymbol="circle",e.visualStyleAccessPath="itemStyle",e.visualDrawType="fill"}(),t}($e);ea(Ao,dot);ea(Ao,tL);q8(Ao,$e);function $H(n){var t=n.name;EE(n)||(n.name=zot(n)||t)}function zot(n){var t=n.getRawData(),e=t.mapDimensionsAll("seriesName"),i=[];return N(e,function(r){var o=t.getDimensionInfo(r);o.displayName&&i.push(o.displayName)}),i.join(" ")}function Not(n){return n.model.getRawData().count()}function Wot(n){var t=n.model;return t.setData(t.getRawData().cloneShallow()),Vot}function Vot(n,t){t.outputData&&n.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function jH(n,t){N(p8(n.CHANGABLE_METHODS,n.DOWNSAMPLE_METHODS),function(e){n.wrapMethod(e,he(Got,t))})}function Got(n,t){var e=fB(n);return e&&e.setOutputEnd((t||this).count()),t}function fB(n){var t=(n.ecModel||{}).scheduler,e=t&&t.getPipeline(n.uid);if(e){var i=e.currentTask;if(i){var r=i.agentStubMap;r&&(i=r.get(n.uid))}return i}}var Zr=function(){function n(){this.group=new bi,this.uid=uy("viewComponent")}return n.prototype.init=function(t,e){},n.prototype.render=function(t,e,i,r){},n.prototype.dispose=function(t,e){},n.prototype.updateView=function(t,e,i,r){},n.prototype.updateLayout=function(t,e,i,r){},n.prototype.updateVisual=function(t,e,i,r){},n.prototype.toggleBlurSeries=function(t,e,i){},n.prototype.eachRendered=function(t){var e=this.group;e&&e.traverse(t)},n}();OE(Zr);iS(Zr);function sL(){var n=Ke();return function(t){var e=n(t),i=t.pipelineContext,r=!!e.large,o=!!e.progressiveRender,s=e.large=!!(i&&i.large),a=e.progressiveRender=!!(i&&i.progressiveRender);return(r!==s||o!==a)&&"reset"}}var _$=Ke(),$ot=sL(),Ur=function(){function n(){this.group=new bi,this.uid=uy("viewChart"),this.renderTask=d0({plan:jot,reset:Uot}),this.renderTask.context={view:this}}return n.prototype.init=function(t,e){},n.prototype.render=function(t,e,i,r){},n.prototype.highlight=function(t,e,i,r){var o=t.getData(r&&r.dataType);o&&XH(o,r,"emphasis")},n.prototype.downplay=function(t,e,i,r){var o=t.getData(r&&r.dataType);o&&XH(o,r,"normal")},n.prototype.remove=function(t,e){this.group.removeAll()},n.prototype.dispose=function(t,e){},n.prototype.updateView=function(t,e,i,r){this.render(t,e,i,r)},n.prototype.updateLayout=function(t,e,i,r){this.render(t,e,i,r)},n.prototype.updateVisual=function(t,e,i,r){this.render(t,e,i,r)},n.prototype.eachRendered=function(t){gS(this.group,t)},n.markUpdateMethod=function(t,e){_$(t).updateMethod=e},n.protoInitialize=function(){var t=n.prototype;t.type="chart"}(),n}();function UH(n,t,e){n&&Y0(n)&&(t==="emphasis"?bg:_g)(n,e)}function XH(n,t,e){var i=ec(n,t),r=t&&t.highlightKey!=null?gnt(t.highlightKey):null;i!=null?N(Ni(i),function(o){UH(n.getItemGraphicEl(o),e,r)}):n.eachItemGraphicEl(function(o){UH(o,e,r)})}OE(Ur);iS(Ur);function jot(n){return $ot(n.model)}function Uot(n){var t=n.model,e=n.ecModel,i=n.api,r=n.payload,o=t.pipelineContext.progressiveRender,s=n.view,a=r&&_$(r).updateMethod,l=o?"incrementalPrepareRender":a&&s[a]?a:"render";return l!=="render"&&s[l](t,e,i,r),Xot[l]}var Xot={incrementalPrepareRender:{progress:function(n,t){t.view.incrementalRender(n,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(n,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},XC="\0__throttleOriginMethod",YH="\0__throttleRate",KH="\0__throttleType";function aL(n,t,e){var i,r=0,o=0,s=null,a,l,h,u;t=t||0;function d(){o=new Date().getTime(),s=null,n.apply(l,h||[])}var c=function(){for(var f=[],g=0;g<arguments.length;g++)f[g]=arguments[g];i=new Date().getTime(),l=this,h=f;var p=u||t,v=u||e;u=null,a=i-(v?r:o)-p,clearTimeout(s),v?s=setTimeout(d,p):a>=0?d():s=setTimeout(d,-a),r=i};return c.clear=function(){s&&(clearTimeout(s),s=null)},c.debounceNextCall=function(f){u=f},c}function SS(n,t,e,i){var r=n[t];if(r){var o=r[XC]||r,s=r[KH],a=r[YH];if(a!==e||s!==i){if(e==null||!i)return n[t]=o;r=n[t]=aL(o,e,i==="debounce"),r[XC]=o,r[KH]=i,r[YH]=e}return r}}function YC(n,t){var e=n[t];e&&e[XC]&&(e.clear&&e.clear(),n[t]=e[XC])}var qH=Ke(),ZH={itemStyle:yg(L9,!0),lineStyle:yg(E9,!0)},Yot={lineStyle:"stroke",itemStyle:"fill"};function C$(n,t){var e=n.visualStyleMapper||ZH[t];return e||ZH.itemStyle}function w$(n,t){var e=n.visualDrawType||Yot[t];return e||"fill"}var Kot={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){var e=n.getData(),i=n.visualStyleAccessPath||"itemStyle",r=n.getModel(i),o=C$(n,i),s=o(r),a=r.getShallow("decal");a&&(e.setVisual("decal",a),a.dirty=!0);var l=w$(n,i),h=s[l],u=jt(h)?h:null,d=s.fill==="auto"||s.stroke==="auto";if(!s[l]||u||d){var c=n.getColorFromPalette(n.name,null,t.getSeriesCount());s[l]||(s[l]=c,e.setVisual("colorFromPalette",!0)),s.fill=s.fill==="auto"||jt(s.fill)?c:s.fill,s.stroke=s.stroke==="auto"||jt(s.stroke)?c:s.stroke}if(e.setVisual("style",s),e.setVisual("drawType",l),!t.isSeriesFiltered(n)&&u)return e.setVisual("colorFromPalette",!1),{dataEach:function(f,g){var p=n.getDataParams(g),v=ft({},s);v[l]=u(p),f.setItemVisual(g,"style",v)}}}},Yp=new ui,qot={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){if(!(n.ignoreStyleOnData||t.isSeriesFiltered(n))){var e=n.getData(),i=n.visualStyleAccessPath||"itemStyle",r=C$(n,i),o=e.getVisual("drawType");return{dataEach:e.hasItemOption?function(s,a){var l=s.getRawDataItem(a);if(l&&l[i]){Yp.option=l[i];var h=r(Yp),u=s.ensureUniqueItemVisual(a,"style");ft(u,h),Yp.option.decal&&(s.setItemVisual(a,"decal",Yp.option.decal),Yp.option.decal.dirty=!0),o in h&&s.setItemVisual(a,"colorFromPalette",!1)}}:null}}}},Zot={performRawSeries:!0,overallReset:function(n){var t=$t();n.eachSeries(function(e){var i=e.getColorBy();if(!e.isColorBySeries()){var r=e.type+"-"+i,o=t.get(r);o||(o={},t.set(r,o)),qH(e).scope=o}}),n.eachSeries(function(e){if(!(e.isColorBySeries()||n.isSeriesFiltered(e))){var i=e.getRawData(),r={},o=e.getData(),s=qH(e).scope,a=e.visualStyleAccessPath||"itemStyle",l=w$(e,a);o.each(function(h){var u=o.getRawIndex(h);r[u]=h}),i.each(function(h){var u=r[h],d=o.getItemVisual(u,"colorFromPalette");if(d){var c=o.ensureUniqueItemVisual(u,"style"),f=i.getName(h)||h+"",g=i.count();c[l]=e.getColorFromPalette(f,s,g)}})}})}},fb=Math.PI;function Jot(n,t){t=t||{},Gt(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var e=new bi,i=new ci({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});e.add(i);var r=new Vi({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),o=new ci({style:{fill:"none"},textContent:r,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});e.add(o);var s;return t.showSpinner&&(s=new hS({shape:{startAngle:-fb/2,endAngle:-fb/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),s.animateShape(!0).when(1e3,{endAngle:fb*3/2}).start("circularInOut"),s.animateShape(!0).when(1e3,{startAngle:fb*3/2}).delay(300).start("circularInOut"),e.add(s)),e.resize=function(){var a=r.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,h=(n.getWidth()-l*2-(t.showSpinner&&a?10:0)-a)/2-(t.showSpinner&&a?0:5+a/2)+(t.showSpinner?0:a/2)+(a?0:l),u=n.getHeight()/2;t.showSpinner&&s.setShape({cx:h,cy:u}),o.setShape({x:h-l,y:u-l,width:l*2,height:l*2}),i.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()})},e.resize(),e}var x$=function(){function n(t,e,i,r){this._stageTaskMap=$t(),this.ecInstance=t,this.api=e,i=this._dataProcessorHandlers=i.slice(),r=this._visualHandlers=r.slice(),this._allHandlers=i.concat(r)}return n.prototype.restoreData=function(t,e){t.restoreData(e),this._stageTaskMap.each(function(i){var r=i.overallTask;r&&r.dirty()})},n.prototype.getPerformArgs=function(t,e){if(t.__pipeline){var i=this._pipelineMap.get(t.__pipeline.id),r=i.context,o=!e&&i.progressiveEnabled&&(!r||r.progressiveRender)&&t.__idxInPipeline>i.blockIndex,s=o?i.step:null,a=r&&r.modDataCount,l=a!=null?Math.ceil(a/s):null;return{step:s,modBy:l,modDataCount:a}}},n.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},n.prototype.updateStreamModes=function(t,e){var i=this._pipelineMap.get(t.uid),r=t.getData(),o=r.count(),s=i.progressiveEnabled&&e.incrementalPrepareRender&&o>=i.threshold,a=t.get("large")&&o>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?o:null;t.pipelineContext=i.context={progressiveRender:s,modDataCount:l,large:a}},n.prototype.restorePipelines=function(t){var e=this,i=e._pipelineMap=$t();t.eachSeries(function(r){var o=r.getProgressive(),s=r.uid;i.set(s,{id:s,head:null,tail:null,threshold:r.getProgressiveThreshold(),progressiveEnabled:o&&!(r.preventIncremental&&r.preventIncremental()),blockIndex:-1,step:Math.round(o||700),count:0}),e._pipe(r,r.dataTask)})},n.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,e=this.api.getModel(),i=this.api;N(this._allHandlers,function(r){var o=t.get(r.uid)||t.set(r.uid,{}),s="";ps(!(r.reset&&r.overallReset),s),r.reset&&this._createSeriesStageTask(r,o,e,i),r.overallReset&&this._createOverallStageTask(r,o,e,i)},this)},n.prototype.prepareView=function(t,e,i,r){var o=t.renderTask,s=o.context;s.model=e,s.ecModel=i,s.api=r,o.__block=!t.incrementalPrepareRender,this._pipe(e,o)},n.prototype.performDataProcessorTasks=function(t,e){this._performStageTasks(this._dataProcessorHandlers,t,e,{block:!0})},n.prototype.performVisualTasks=function(t,e,i){this._performStageTasks(this._visualHandlers,t,e,i)},n.prototype._performStageTasks=function(t,e,i,r){r=r||{};var o=!1,s=this;N(t,function(l,h){if(!(r.visualType&&r.visualType!==l.visualType)){var u=s._stageTaskMap.get(l.uid),d=u.seriesTaskMap,c=u.overallTask;if(c){var f,g=c.agentStubMap;g.each(function(v){a(r,v)&&(v.dirty(),f=!0)}),f&&c.dirty(),s.updatePayload(c,i);var p=s.getPerformArgs(c,r.block);g.each(function(v){v.perform(p)}),c.perform(p)&&(o=!0)}else d&&d.each(function(v,m){a(r,v)&&v.dirty();var y=s.getPerformArgs(v,r.block);y.skip=!l.performRawSeries&&e.isSeriesFiltered(v.context.model),s.updatePayload(v,i),v.perform(y)&&(o=!0)})}});function a(l,h){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(h.__pipeline.id))}this.unfinished=o||this.unfinished},n.prototype.performSeriesTasks=function(t){var e;t.eachSeries(function(i){e=i.dataTask.perform()||e}),this.unfinished=e||this.unfinished},n.prototype.plan=function(){this._pipelineMap.each(function(t){var e=t.tail;do{if(e.__block){t.blockIndex=e.__idxInPipeline;break}e=e.getUpstream()}while(e)})},n.prototype.updatePayload=function(t,e){e!=="remain"&&(t.context.payload=e)},n.prototype._createSeriesStageTask=function(t,e,i,r){var o=this,s=e.seriesTaskMap,a=e.seriesTaskMap=$t(),l=t.seriesType,h=t.getTargetSeries;t.createOnAllSeries?i.eachRawSeries(u):l?i.eachRawSeriesByType(l,u):h&&h(i,r).each(u);function u(d){var c=d.uid,f=a.set(c,s&&s.get(c)||d0({plan:nst,reset:rst,count:sst}));f.context={model:d,ecModel:i,api:r,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:o},o._pipe(d,f)}},n.prototype._createOverallStageTask=function(t,e,i,r){var o=this,s=e.overallTask=e.overallTask||d0({reset:Qot});s.context={ecModel:i,api:r,overallReset:t.overallReset,scheduler:o};var a=s.agentStubMap,l=s.agentStubMap=$t(),h=t.seriesType,u=t.getTargetSeries,d=!0,c=!1,f="";ps(!t.createOnAllSeries,f),h?i.eachRawSeriesByType(h,g):u?u(i,r).each(g):(d=!1,N(i.getSeries(),g));function g(p){var v=p.uid,m=l.set(v,a&&a.get(v)||(c=!0,d0({reset:tst,onDirty:ist})));m.context={model:p,overallProgress:d},m.agent=s,m.__block=d,o._pipe(p,m)}c&&s.dirty()},n.prototype._pipe=function(t,e){var i=t.uid,r=this._pipelineMap.get(i);!r.head&&(r.head=e),r.tail&&r.tail.pipe(e),r.tail=e,e.__idxInPipeline=r.count++,e.__pipeline=r},n.wrapStageHandler=function(t,e){return jt(t)&&(t={overallReset:t,seriesType:ast(t)}),t.uid=uy("stageHandler"),e&&(t.visualType=e),t},n}();function Qot(n){n.overallReset(n.ecModel,n.api,n.payload)}function tst(n){return n.overallProgress&&est}function est(){this.agent.dirty(),this.getDownstream().dirty()}function ist(){this.agent&&this.agent.dirty()}function nst(n){return n.plan?n.plan(n.model,n.ecModel,n.api,n.payload):null}function rst(n){n.useClearVisual&&n.data.clearAllVisual();var t=n.resetDefines=Ni(n.reset(n.model,n.ecModel,n.api,n.payload));return t.length>1?St(t,function(e,i){return S$(i)}):ost}var ost=S$(0);function S$(n){return function(t,e){var i=e.data,r=e.resetDefines[n];if(r&&r.dataEach)for(var o=t.start;o<t.end;o++)r.dataEach(i,o);else r&&r.progress&&r.progress(t,i)}}function sst(n){return n.data.count()}function ast(n){KC=null;try{n(Q0,A$)}catch{}return KC}var Q0={},A$={},KC;T$(Q0,eL);T$(A$,e$);Q0.eachSeriesByType=Q0.eachRawSeriesByType=function(n){KC=n};Q0.eachComponent=function(n){n.mainType==="series"&&n.subType&&(KC=n.subType)};function T$(n,t){for(var e in t.prototype)n[e]=ir}var JH=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const lst={color:JH,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],JH]};var lr="#B9B8CE",QH="#100C2A",gb=function(){return{axisLine:{lineStyle:{color:lr}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},tF=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],M$={darkMode:!0,color:tF,backgroundColor:QH,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:lr},pageTextStyle:{color:lr}},textStyle:{color:lr},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:lr}},dataZoom:{borderColor:"#71708A",textStyle:{color:lr},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:lr}},timeline:{lineStyle:{color:lr},label:{color:lr},controlStyle:{color:lr,borderColor:lr}},calendar:{itemStyle:{color:QH},dayLabel:{color:lr},monthLabel:{color:lr},yearLabel:{color:lr}},timeAxis:gb(),logAxis:gb(),valueAxis:gb(),categoryAxis:gb(),line:{symbol:"circle"},graph:{color:tF},gauge:{title:{color:lr},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:lr},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};M$.categoryAxis.splitLine.show=!1;var hst=function(){function n(){}return n.prototype.normalizeQuery=function(t){var e={},i={},r={};if(Pt(t)){var o=Pa(t);e.mainType=o.main||null,e.subType=o.sub||null}else{var s=["Index","Name","Id"],a={name:1,dataIndex:1,dataType:1};N(t,function(l,h){for(var u=!1,d=0;d<s.length;d++){var c=s[d],f=h.lastIndexOf(c);if(f>0&&f===h.length-c.length){var g=h.slice(0,f);g!=="data"&&(e.mainType=g,e[c.toLowerCase()]=l,u=!0)}}a.hasOwnProperty(h)&&(i[h]=l,u=!0),u||(r[h]=l)})}return{cptQuery:e,dataQuery:i,otherQuery:r}},n.prototype.filter=function(t,e){var i=this.eventInfo;if(!i)return!0;var r=i.targetEl,o=i.packedEvent,s=i.model,a=i.view;if(!s||!a)return!0;var l=e.cptQuery,h=e.dataQuery;return u(l,s,"mainType")&&u(l,s,"subType")&&u(l,s,"index","componentIndex")&&u(l,s,"name")&&u(l,s,"id")&&u(h,o,"name")&&u(h,o,"dataIndex")&&u(h,o,"dataType")&&(!a.filterForExposedEvent||a.filterForExposedEvent(t,e.otherQuery,r,o));function u(d,c,f,g){return d[f]==null||c[g||f]===d[f]}},n.prototype.afterTrigger=function(){this.eventInfo=null},n}(),gB=["symbol","symbolSize","symbolRotate","symbolOffset"],eF=gB.concat(["symbolKeepAspect"]),ust={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){var e=n.getData();if(n.legendIcon&&e.setVisual("legendIcon",n.legendIcon),!n.hasSymbolVisual)return;for(var i={},r={},o=!1,s=0;s<gB.length;s++){var a=gB[s],l=n.get(a);jt(l)?(o=!0,r[a]=l):i[a]=l}if(i.symbol=i.symbol||n.defaultSymbol,e.setVisual(ft({legendIcon:n.legendIcon||i.symbol,symbolKeepAspect:n.get("symbolKeepAspect")},i)),t.isSeriesFiltered(n))return;var h=yi(r);function u(d,c){for(var f=n.getRawValue(c),g=n.getDataParams(c),p=0;p<h.length;p++){var v=h[p];d.setItemVisual(c,v,r[v](f,g))}}return{dataEach:o?u:null}}},dst={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,t){if(!n.hasSymbolVisual||t.isSeriesFiltered(n))return;var e=n.getData();function i(r,o){for(var s=r.getItemModel(o),a=0;a<eF.length;a++){var l=eF[a],h=s.getShallow(l,!0);h!=null&&r.setItemVisual(o,l,h)}}return{dataEach:e.hasItemOption?i:null}}};function cst(n,t,e){switch(e){case"color":var i=n.getItemVisual(t,"style");return i[n.getVisual("drawType")];case"opacity":return n.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getItemVisual(t,e)}}function fst(n,t){switch(t){case"color":var e=n.getVisual("style");return e[n.getVisual("drawType")];case"opacity":return n.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getVisual(t)}}function gst(n,t){function e(i,r){var o=[];return i.eachComponent({mainType:"series",subType:n,query:r},function(s){o.push(s.seriesIndex)}),o}N([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(i){t(i[0],function(r,o,s){r=ft({},r),s.dispatchAction(ft(r,{type:i[1],seriesIndex:e(o,r)}))})})}function jc(n,t,e,i,r){var o=n+t;e.isSilent(o)||i.eachComponent({mainType:"series",subType:"pie"},function(s){for(var a=s.seriesIndex,l=s.option.selectedMap,h=r.selected,u=0;u<h.length;u++)if(h[u].seriesIndex===a){var d=s.getData(),c=ec(d,r.fromActionPayload);e.trigger(o,{type:o,seriesId:s.id,name:_t(c)?d.getName(c[0]):d.getName(c),selected:Pt(l)?l:ft({},l)})}})}function pst(n,t,e){n.on("selectchanged",function(i){var r=e.getModel();i.isFromClick?(jc("map","selectchanged",t,r,i),jc("pie","selectchanged",t,r,i)):i.fromAction==="select"?(jc("map","selected",t,r,i),jc("pie","selected",t,r,i)):i.fromAction==="unselect"&&(jc("map","unselected",t,r,i),jc("pie","unselected",t,r,i))})}function Iv(n,t,e){for(var i;n&&!(t(n)&&(i=n,e));)n=n.__hostTarget||n.parent;return i}var vst=Math.round(Math.random()*9),mst=typeof Object.defineProperty=="function",yst=function(){function n(){this._id="__ec_inner_"+vst++}return n.prototype.get=function(t){return this._guard(t)[this._id]},n.prototype.set=function(t,e){var i=this._guard(t);return mst?Object.defineProperty(i,this._id,{value:e,enumerable:!1,configurable:!0}):i[this._id]=e,this},n.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},n.prototype.has=function(t){return!!this._guard(t)[this._id]},n.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},n}(),bst=Ee.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,t){var e=t.cx,i=t.cy,r=t.width/2,o=t.height/2;n.moveTo(e,i-o),n.lineTo(e+r,i+o),n.lineTo(e-r,i+o),n.closePath()}}),_st=Ee.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,t){var e=t.cx,i=t.cy,r=t.width/2,o=t.height/2;n.moveTo(e,i-o),n.lineTo(e+r,i),n.lineTo(e,i+o),n.lineTo(e-r,i),n.closePath()}}),Cst=Ee.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,t){var e=t.x,i=t.y,r=t.width/5*3,o=Math.max(r,t.height),s=r/2,a=s*s/(o-s),l=i-o+s+a,h=Math.asin(a/s),u=Math.cos(h)*s,d=Math.sin(h),c=Math.cos(h),f=s*.6,g=s*.7;n.moveTo(e-u,l+a),n.arc(e,l,s,Math.PI-h,Math.PI*2+h),n.bezierCurveTo(e+u-d*f,l+a+c*f,e,i-g,e,i),n.bezierCurveTo(e,i-g,e-u+d*f,l+a+c*f,e-u,l+a),n.closePath()}}),wst=Ee.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,t){var e=t.height,i=t.width,r=t.x,o=t.y,s=i/3*2;n.moveTo(r,o),n.lineTo(r+s,o+e),n.lineTo(r,o+e/4*3),n.lineTo(r-s,o+e),n.lineTo(r,o),n.closePath()}}),xst={line:ns,rect:ci,roundRect:ci,square:ci,circle:ly,diamond:_st,pin:Cst,arrow:wst,triangle:bst},Sst={line:function(n,t,e,i,r){r.x1=n,r.y1=t+i/2,r.x2=n+e,r.y2=t+i/2},rect:function(n,t,e,i,r){r.x=n,r.y=t,r.width=e,r.height=i},roundRect:function(n,t,e,i,r){r.x=n,r.y=t,r.width=e,r.height=i,r.r=Math.min(e,i)/4},square:function(n,t,e,i,r){var o=Math.min(e,i);r.x=n,r.y=t,r.width=o,r.height=o},circle:function(n,t,e,i,r){r.cx=n+e/2,r.cy=t+i/2,r.r=Math.min(e,i)/2},diamond:function(n,t,e,i,r){r.cx=n+e/2,r.cy=t+i/2,r.width=e,r.height=i},pin:function(n,t,e,i,r){r.x=n+e/2,r.y=t+i/2,r.width=e,r.height=i},arrow:function(n,t,e,i,r){r.x=n+e/2,r.y=t+i/2,r.width=e,r.height=i},triangle:function(n,t,e,i,r){r.cx=n+e/2,r.cy=t+i/2,r.width=e,r.height=i}},qC={};N(xst,function(n,t){qC[t]=new n});var Ast=Ee.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(n,t,e){var i=DC(n,t,e),r=this.shape;return r&&r.symbolType==="pin"&&t.position==="inside"&&(i.y=e.y+e.height*.4),i},buildPath:function(n,t,e){var i=t.symbolType;if(i!=="none"){var r=qC[i];r||(i="rect",r=qC[i]),Sst[i](t.x,t.y,t.width,t.height,r.shape),r.buildPath(n,r.shape,e)}}});function Tst(n,t){if(this.type!=="image"){var e=this.style;this.__isEmptyBrush?(e.stroke=n,e.fill=t||"#fff",e.lineWidth=2):this.shape.symbolType==="line"?e.stroke=n:e.fill=n,this.markRedraw()}}function Kh(n,t,e,i,r,o,s){var a=n.indexOf("empty")===0;a&&(n=n.substr(5,1).toLowerCase()+n.substr(6));var l;return n.indexOf("image://")===0?l=A9(n.slice(8),new Te(t,e,i,r),s?"center":"cover"):n.indexOf("path://")===0?l=GE(n.slice(7),{},new Te(t,e,i,r),s?"center":"cover"):l=new Ast({shape:{symbolType:n,x:t,y:e,width:i,height:r}}),l.__isEmptyBrush=a,l.setColor=Tst,o&&l.setColor(o),l}function Mst(n){return _t(n)||(n=[+n,+n]),[n[0]||0,n[1]||0]}function R$(n,t){if(n!=null)return _t(n)||(n=[n,n]),[Jt(n[0],t[0])||0,Jt(ve(n[1],n[0]),t[1])||0]}function _d(n){return isFinite(n)}function Rst(n,t,e){var i=t.x==null?0:t.x,r=t.x2==null?1:t.x2,o=t.y==null?0:t.y,s=t.y2==null?0:t.y2;t.global||(i=i*e.width+e.x,r=r*e.width+e.x,o=o*e.height+e.y,s=s*e.height+e.y),i=_d(i)?i:0,r=_d(r)?r:1,o=_d(o)?o:0,s=_d(s)?s:0;var a=n.createLinearGradient(i,o,r,s);return a}function Bst(n,t,e){var i=e.width,r=e.height,o=Math.min(i,r),s=t.x==null?.5:t.x,a=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(s=s*i+e.x,a=a*r+e.y,l=l*o),s=_d(s)?s:.5,a=_d(a)?a:.5,l=l>=0&&_d(l)?l:.5;var h=n.createRadialGradient(s,a,0,s,a,l);return h}function pB(n,t,e){for(var i=t.type==="radial"?Bst(n,t,e):Rst(n,t,e),r=t.colorStops,o=0;o<r.length;o++)i.addColorStop(r[o].offset,r[o].color);return i}function Pst(n,t){if(n===t||!n&&!t)return!1;if(!n||!t||n.length!==t.length)return!0;for(var e=0;e<n.length;e++)if(n[e]!==t[e])return!0;return!1}function pb(n){return parseInt(n,10)}function vb(n,t,e){var i=["width","height"][t],r=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],s=["paddingRight","paddingBottom"][t];if(e[i]!=null&&e[i]!=="auto")return parseFloat(e[i]);var a=document.defaultView.getComputedStyle(n);return(n[r]||pb(a[i])||pb(n.style[i]))-(pb(a[o])||0)-(pb(a[s])||0)|0}function kst(n,t){return!n||n==="solid"||!(t>0)?null:n==="dashed"?[4*t,2*t]:n==="dotted"?[t]:di(n)?[n]:_t(n)?n:null}function B$(n){var t=n.style,e=t.lineDash&&t.lineWidth>0&&kst(t.lineDash,t.lineWidth),i=t.lineDashOffset;if(e){var r=t.strokeNoScale&&n.getLineScale?n.getLineScale():1;r&&r!==1&&(e=St(e,function(o){return o/r}),i/=r)}return[e,i]}var Est=new Vl(!0);function ZC(n){var t=n.stroke;return!(t==null||t==="none"||!(n.lineWidth>0))}function iF(n){return typeof n=="string"&&n!=="none"}function JC(n){var t=n.fill;return t!=null&&t!=="none"}function nF(n,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var e=n.globalAlpha;n.globalAlpha=t.fillOpacity*t.opacity,n.fill(),n.globalAlpha=e}else n.fill()}function rF(n,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var e=n.globalAlpha;n.globalAlpha=t.strokeOpacity*t.opacity,n.stroke(),n.globalAlpha=e}else n.stroke()}function vB(n,t,e){var i=Z8(t.image,t.__image,e);if(nS(i)){var r=n.createPattern(i,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&r&&r.setTransform){var o=new DOMMatrix;o.translateSelf(t.x||0,t.y||0),o.rotateSelf(0,0,(t.rotation||0)*btt),o.scaleSelf(t.scaleX||1,t.scaleY||1),r.setTransform(o)}return r}}function Lst(n,t,e,i){var r,o=ZC(e),s=JC(e),a=e.strokePercent,l=a<1,h=!t.path;(!t.silent||l)&&h&&t.createPathProxy();var u=t.path||Est,d=t.__dirty;if(!i){var c=e.fill,f=e.stroke,g=s&&!!c.colorStops,p=o&&!!f.colorStops,v=s&&!!c.image,m=o&&!!f.image,y=void 0,b=void 0,_=void 0,w=void 0,C=void 0;(g||p)&&(C=t.getBoundingRect()),g&&(y=d?pB(n,c,C):t.__canvasFillGradient,t.__canvasFillGradient=y),p&&(b=d?pB(n,f,C):t.__canvasStrokeGradient,t.__canvasStrokeGradient=b),v&&(_=d||!t.__canvasFillPattern?vB(n,c,t):t.__canvasFillPattern,t.__canvasFillPattern=_),m&&(w=d||!t.__canvasStrokePattern?vB(n,f,t):t.__canvasStrokePattern,t.__canvasStrokePattern=_),g?n.fillStyle=y:v&&(_?n.fillStyle=_:s=!1),p?n.strokeStyle=b:m&&(w?n.strokeStyle=w:o=!1)}var x=t.getGlobalScale();u.setScale(x[0],x[1],t.segmentIgnoreThreshold);var S,A;n.setLineDash&&e.lineDash&&(r=B$(t),S=r[0],A=r[1]);var T=!0;(h||d&mf)&&(u.setDPR(n.dpr),l?u.setContext(null):(u.setContext(n),T=!1),u.reset(),t.buildPath(u,t.shape,i),u.toStatic(),t.pathUpdated()),T&&u.rebuildPath(n,l?a:1),S&&(n.setLineDash(S),n.lineDashOffset=A),i||(e.strokeFirst?(o&&rF(n,e),s&&nF(n,e)):(s&&nF(n,e),o&&rF(n,e))),S&&n.setLineDash([])}function Ost(n,t,e){var i=t.__image=Z8(e.image,t.__image,t,t.onload);if(!(!i||!nS(i))){var r=e.x||0,o=e.y||0,s=t.getWidth(),a=t.getHeight(),l=i.width/i.height;if(s==null&&a!=null?s=a*l:a==null&&s!=null?a=s/l:s==null&&a==null&&(s=i.width,a=i.height),e.sWidth&&e.sHeight){var h=e.sx||0,u=e.sy||0;n.drawImage(i,h,u,e.sWidth,e.sHeight,r,o,s,a)}else if(e.sx&&e.sy){var h=e.sx,u=e.sy,d=s-h,c=a-u;n.drawImage(i,h,u,d,c,r,o,s,a)}else n.drawImage(i,r,o,s,a)}}function Dst(n,t,e){var i,r=e.text;if(r!=null&&(r+=""),r){n.font=e.font||Qd,n.textAlign=e.textAlign,n.textBaseline=e.textBaseline;var o=void 0,s=void 0;n.setLineDash&&e.lineDash&&(i=B$(t),o=i[0],s=i[1]),o&&(n.setLineDash(o),n.lineDashOffset=s),e.strokeFirst?(ZC(e)&&n.strokeText(r,e.x,e.y),JC(e)&&n.fillText(r,e.x,e.y)):(JC(e)&&n.fillText(r,e.x,e.y),ZC(e)&&n.strokeText(r,e.x,e.y)),o&&n.setLineDash([])}}var oF=["shadowBlur","shadowOffsetX","shadowOffsetY"],sF=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function P$(n,t,e,i,r){var o=!1;if(!i&&(e=e||{},t===e))return!1;if(i||t.opacity!==e.opacity){Wr(n,r),o=!0;var s=Math.max(Math.min(t.opacity,1),0);n.globalAlpha=isNaN(s)?Hd.opacity:s}(i||t.blend!==e.blend)&&(o||(Wr(n,r),o=!0),n.globalCompositeOperation=t.blend||Hd.blend);for(var a=0;a<oF.length;a++){var l=oF[a];(i||t[l]!==e[l])&&(o||(Wr(n,r),o=!0),n[l]=n.dpr*(t[l]||0))}return(i||t.shadowColor!==e.shadowColor)&&(o||(Wr(n,r),o=!0),n.shadowColor=t.shadowColor||Hd.shadowColor),o}function aF(n,t,e,i,r){var o=tm(t,r.inHover),s=i?null:e&&tm(e,r.inHover)||{};if(o===s)return!1;var a=P$(n,o,s,i,r);if((i||o.fill!==s.fill)&&(a||(Wr(n,r),a=!0),iF(o.fill)&&(n.fillStyle=o.fill)),(i||o.stroke!==s.stroke)&&(a||(Wr(n,r),a=!0),iF(o.stroke)&&(n.strokeStyle=o.stroke)),(i||o.opacity!==s.opacity)&&(a||(Wr(n,r),a=!0),n.globalAlpha=o.opacity==null?1:o.opacity),t.hasStroke()){var l=o.lineWidth,h=l/(o.strokeNoScale&&t.getLineScale?t.getLineScale():1);n.lineWidth!==h&&(a||(Wr(n,r),a=!0),n.lineWidth=h)}for(var u=0;u<sF.length;u++){var d=sF[u],c=d[0];(i||o[c]!==s[c])&&(a||(Wr(n,r),a=!0),n[c]=o[c]||d[1])}return a}function Ist(n,t,e,i,r){return P$(n,tm(t,r.inHover),e&&tm(e,r.inHover),i,r)}function k$(n,t){var e=t.transform,i=n.dpr||1;e?n.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):n.setTransform(i,0,0,i,0,0)}function Hst(n,t,e){for(var i=!1,r=0;r<n.length;r++){var o=n[r];i=i||o.isZeroArea(),k$(t,o),t.beginPath(),o.buildPath(t,o.shape),t.clip()}e.allClipped=i}function Fst(n,t){return n&&t?n[0]!==t[0]||n[1]!==t[1]||n[2]!==t[2]||n[3]!==t[3]||n[4]!==t[4]||n[5]!==t[5]:!(!n&&!t)}var lF=1,hF=2,uF=3,dF=4;function zst(n){var t=JC(n),e=ZC(n);return!(n.lineDash||!(+t^+e)||t&&typeof n.fill!="string"||e&&typeof n.stroke!="string"||n.strokePercent<1||n.strokeOpacity<1||n.fillOpacity<1)}function Wr(n,t){t.batchFill&&n.fill(),t.batchStroke&&n.stroke(),t.batchFill="",t.batchStroke=""}function tm(n,t){return t&&n.__hoverStyle||n.style}function E$(n,t){Cd(n,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Cd(n,t,e,i){var r=t.transform;if(!t.shouldBePainted(e.viewWidth,e.viewHeight,!1,!1)){t.__dirty&=~go,t.__isRendered=!1;return}var o=t.__clipPaths,s=e.prevElClipPaths,a=!1,l=!1;if((!s||Pst(o,s))&&(s&&s.length&&(Wr(n,e),n.restore(),l=a=!0,e.prevElClipPaths=null,e.allClipped=!1,e.prevEl=null),o&&o.length&&(Wr(n,e),n.save(),Hst(o,n,e),a=!0),e.prevElClipPaths=o),e.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var h=e.prevEl;h||(l=a=!0);var u=t instanceof Ee&&t.autoBatch&&zst(t.style);a||Fst(r,h.transform)?(Wr(n,e),k$(n,t)):u||Wr(n,e);var d=tm(t,e.inHover);t instanceof Ee?(e.lastDrawType!==lF&&(l=!0,e.lastDrawType=lF),aF(n,t,h,l,e),(!u||!e.batchFill&&!e.batchStroke)&&n.beginPath(),Lst(n,t,d,u),u&&(e.batchFill=d.fill||"",e.batchStroke=d.stroke||"")):t instanceof HC?(e.lastDrawType!==uF&&(l=!0,e.lastDrawType=uF),aF(n,t,h,l,e),Dst(n,t,d)):t instanceof du?(e.lastDrawType!==hF&&(l=!0,e.lastDrawType=hF),Ist(n,t,h,l,e),Ost(n,t,d)):t.getTemporalDisplayables&&(e.lastDrawType!==dF&&(l=!0,e.lastDrawType=dF),Nst(n,t,e)),u&&i&&Wr(n,e),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),e.prevEl=t,t.__dirty=0,t.__isRendered=!0}function Nst(n,t,e){var i=t.getDisplayables(),r=t.getTemporalDisplayables();n.save();var o={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:e.viewWidth,viewHeight:e.viewHeight,inHover:e.inHover},s,a;for(s=t.getCursor(),a=i.length;s<a;s++){var l=i[s];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Cd(n,l,o,s===a-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),o.prevEl=l}for(var h=0,u=r.length;h<u;h++){var l=r[h];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Cd(n,l,o,h===u-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),o.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,n.restore()}var fM=new yst,cF=new iy(100),fF=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function QC(n,t){if(n==="none")return null;var e=t.getDevicePixelRatio(),i=t.getZr(),r=i.painter.type==="svg";n.dirty&&fM.delete(n);var o=fM.get(n);if(o)return o;var s=Gt(n,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});s.backgroundColor==="none"&&(s.backgroundColor=null);var a={repeat:"repeat"};return l(a),a.rotation=s.rotation,a.scaleX=a.scaleY=r?1:1/e,fM.set(n,a),n.dirty=!1,a;function l(h){for(var u=[e],d=!0,c=0;c<fF.length;++c){var f=s[fF[c]];if(f!=null&&!_t(f)&&!Pt(f)&&!di(f)&&typeof f!="boolean"){d=!1;break}u.push(f)}var g;if(d){g=u.join(",")+(r?"-svg":"");var p=cF.get(g);p&&(r?h.svgElement=p:h.image=p)}var v=O$(s.dashArrayX),m=Wst(s.dashArrayY),y=L$(s.symbol),b=Vst(v),_=D$(m),w=!r&&up.createCanvas(),C=r&&{tag:"g",attrs:{},key:"dcl",children:[]},x=A(),S;w&&(w.width=x.width*e,w.height=x.height*e,S=w.getContext("2d")),T(),d&&cF.put(g,w||C),h.image=w,h.svgElement=C,h.svgWidth=x.width,h.svgHeight=x.height;function A(){for(var M=1,R=0,E=b.length;R<E;++R)M=BI(M,b[R]);for(var P=1,R=0,E=y.length;R<E;++R)P=BI(P,y[R].length);M*=P;var B=_*b.length*y.length;return{width:Math.max(1,Math.min(M,s.maxTileWidth)),height:Math.max(1,Math.min(B,s.maxTileHeight))}}function T(){S&&(S.clearRect(0,0,w.width,w.height),s.backgroundColor&&(S.fillStyle=s.backgroundColor,S.fillRect(0,0,w.width,w.height)));for(var M=0,R=0;R<m.length;++R)M+=m[R];if(M<=0)return;for(var E=-_,P=0,B=0,k=0;E<x.height;){if(P%2===0){for(var L=B/2%y.length,O=0,D=0,I=0;O<x.width*2;){for(var H=0,R=0;R<v[k].length;++R)H+=v[k][R];if(H<=0)break;if(D%2===0){var F=(1-s.symbolSize)*.5,G=O+v[k][D]*F,j=E+m[P]*F,W=v[k][D]*s.symbolSize,K=m[P]*s.symbolSize,J=I/2%y[L].length;q(G,j,W,K,y[L][J])}O+=v[k][D],++I,++D,D===v[k].length&&(D=0)}++k,k===v.length&&(k=0)}E+=m[P],++B,++P,P===m.length&&(P=0)}function q(X,it,Z,et,nt){var z=r?1:e,V=Kh(nt,X*z,it*z,Z*z,et*z,s.color,s.symbolKeepAspect);if(r){var $=i.painter.renderOneToVNode(V);$&&C.children.push($)}else E$(S,V)}}}}function L$(n){if(!n||n.length===0)return[["rect"]];if(Pt(n))return[[n]];for(var t=!0,e=0;e<n.length;++e)if(!Pt(n[e])){t=!1;break}if(t)return L$([n]);for(var i=[],e=0;e<n.length;++e)Pt(n[e])?i.push([n[e]]):i.push(n[e]);return i}function O$(n){if(!n||n.length===0)return[[0,0]];if(di(n)){var t=Math.ceil(n);return[[t,t]]}for(var e=!0,i=0;i<n.length;++i)if(!di(n[i])){e=!1;break}if(e)return O$([n]);for(var r=[],i=0;i<n.length;++i)if(di(n[i])){var t=Math.ceil(n[i]);r.push([t,t])}else{var t=St(n[i],function(a){return Math.ceil(a)});t.length%2===1?r.push(t.concat(t)):r.push(t)}return r}function Wst(n){if(!n||typeof n=="object"&&n.length===0)return[0,0];if(di(n)){var t=Math.ceil(n);return[t,t]}var e=St(n,function(i){return Math.ceil(i)});return n.length%2?e.concat(e):e}function Vst(n){return St(n,function(t){return D$(t)})}function D$(n){for(var t=0,e=0;e<n.length;++e)t+=n[e];return n.length%2===1?t*2:t}function Gst(n,t){n.eachRawSeries(function(e){if(!n.isSeriesFiltered(e)){var i=e.getData();i.hasItemVisual()&&i.each(function(s){var a=i.getItemVisual(s,"decal");if(a){var l=i.ensureUniqueItemVisual(s,"style");l.decal=QC(a,t)}});var r=i.getVisual("decal");if(r){var o=i.getVisual("style");o.decal=QC(r,t)}}})}var Rs=new ys,I$={};function $st(n,t){I$[n]=t}function jst(n){return I$[n]}var Ust=1,Xst=800,Yst=900,Kst=1e3,qst=2e3,Zst=5e3,H$=1e3,Jst=1100,lL=2e3,F$=3e3,Qst=4e3,AS=4500,tat=4600,eat=5e3,iat=6e3,z$=7e3,nat={PROCESSOR:{FILTER:Kst,SERIES_FILTER:Xst,STATISTIC:Zst},VISUAL:{LAYOUT:H$,PROGRESSIVE_LAYOUT:Jst,GLOBAL:lL,CHART:F$,POST_CHART_LAYOUT:tat,COMPONENT:Qst,BRUSH:eat,CHART_ITEM:AS,ARIA:iat,DECAL:z$}},sr="__flagInMainProcess",Lr="__pendingUpdate",gM="__needsUpdateStatus",gF=/^[a-zA-Z0-9_]+$/,pM="__connectUpdateStatus",pF=0,rat=1,oat=2;function N$(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.isDisposed()){this.id;return}return V$(this,n,t)}}function W$(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return V$(this,n,t)}}function V$(n,t,e){return e[0]=e[0]&&e[0].toLowerCase(),ys.prototype[t].apply(n,e)}var G$=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(ys),$$=G$.prototype;$$.on=W$("on");$$.off=W$("off");var Uc,vM,mb,oh,mM,yM,bM,Kp,qp,vF,mF,_M,yF,yb,bF,j$,Po,_F,U$=function(n){ct(t,n);function t(e,i,r){var o=n.call(this,new hst)||this;o._chartsViews=[],o._chartsMap={},o._componentsViews=[],o._componentsMap={},o._pendingActions=[],r=r||{},Pt(i)&&(i=X$[i]),o._dom=e;var s="canvas",a="auto",l=!1;r.ssr;var h=o._zr=TI(e,{renderer:r.renderer||s,devicePixelRatio:r.devicePixelRatio,width:r.width,height:r.height,ssr:r.ssr,useDirtyRect:ve(r.useDirtyRect,l),useCoarsePointer:ve(r.useCoarsePointer,a),pointerSize:r.pointerSize});o._ssr=r.ssr,o._throttledZrFlush=aL(zt(h.flush,h),17),i=ne(i),i&&n$(i,!0),o._theme=i,o._locale=prt(r.locale||O9),o._coordSysMgr=new iL;var u=o._api=bF(o);function d(c,f){return c.__prio-f.__prio}return V_(ew,d),V_(mB,d),o._scheduler=new x$(o,u,mB,ew),o._messageCenter=new G$,o._initEvents(),o.resize=zt(o.resize,o),h.animation.on("frame",o._onframe,o),vF(h,o),mF(h,o),k2(o),o}return t.prototype._onframe=function(){if(!this._disposed){_F(this);var e=this._scheduler;if(this[Lr]){var i=this[Lr].silent;this[sr]=!0;try{Uc(this),oh.update.call(this,null,this[Lr].updateParams)}catch(l){throw this[sr]=!1,this[Lr]=null,l}this._zr.flush(),this[sr]=!1,this[Lr]=null,Kp.call(this,i),qp.call(this,i)}else if(e.unfinished){var r=Ust,o=this._model,s=this._api;e.unfinished=!1;do{var a=+new Date;e.performSeriesTasks(o),e.performDataProcessorTasks(o),yM(this,o),e.performVisualTasks(o),yb(this,this._model,s,"remain",{}),r-=+new Date-a}while(r>0&&e.unfinished);e.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(e,i,r){if(!this[sr]){if(this._disposed){this.id;return}var o,s,a;if(Ht(i)&&(r=i.lazyUpdate,o=i.silent,s=i.replaceMerge,a=i.transition,i=i.notMerge),this[sr]=!0,!this._model||i){var l=new $rt(this._api),h=this._theme,u=this._model=new eL;u.scheduler=this._scheduler,u.ssr=this._ssr,u.init(null,null,null,h,this._locale,l)}this._model.setOption(e,{replaceMerge:s},yB);var d={seriesTransition:a,optionChanged:!0};if(r)this[Lr]={silent:o,updateParams:d},this[sr]=!1,this.getZr().wakeUp();else{try{Uc(this),oh.update.call(this,null,d)}catch(c){throw this[Lr]=null,this[sr]=!1,c}this._ssr||this._zr.flush(),this[Lr]=null,this[sr]=!1,Kp.call(this,o),qp.call(this,o)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||ie.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(e){return this.renderToCanvas(e)},t.prototype.renderToCanvas=function(e){e=e||{};var i=this._zr.painter;return i.getRenderedCanvas({backgroundColor:e.backgroundColor||this._model.get("backgroundColor"),pixelRatio:e.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(e){e=e||{};var i=this._zr.painter;return i.renderToString({useViewBox:e.useViewBox})},t.prototype.getSvgDataURL=function(){if(ie.svgSupported){var e=this._zr,i=e.storage.getDisplayList();return N(i,function(r){r.stopAnimation(null,!0)}),e.painter.toDataURL()}},t.prototype.getDataURL=function(e){if(this._disposed){this.id;return}e=e||{};var i=e.excludeComponents,r=this._model,o=[],s=this;N(i,function(l){r.eachComponent({mainType:l},function(h){var u=s._componentsMap[h.__viewId];u.group.ignore||(o.push(u),u.group.ignore=!0)})});var a=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(e).toDataURL("image/"+(e&&e.type||"png"));return N(o,function(l){l.group.ignore=!1}),a},t.prototype.getConnectedDataURL=function(e){if(this._disposed){this.id;return}var i=e.type==="svg",r=this.group,o=Math.min,s=Math.max,a=1/0;if(CF[r]){var l=a,h=a,u=-a,d=-a,c=[],f=e&&e.pixelRatio||this.getDevicePixelRatio();N(f0,function(b,_){if(b.group===r){var w=i?b.getZr().painter.getSvgDom().innerHTML:b.renderToCanvas(ne(e)),C=b.getDom().getBoundingClientRect();l=o(C.left,l),h=o(C.top,h),u=s(C.right,u),d=s(C.bottom,d),c.push({dom:w,left:C.left,top:C.top})}}),l*=f,h*=f,u*=f,d*=f;var g=u-l,p=d-h,v=up.createCanvas(),m=TI(v,{renderer:i?"svg":"canvas"});if(m.resize({width:g,height:p}),i){var y="";return N(c,function(b){var _=b.left-l,w=b.top-h;y+='<g transform="translate('+_+","+w+')">'+b.dom+"</g>"}),m.painter.getSvgRoot().innerHTML=y,e.connectedBackgroundColor&&m.painter.setBackgroundColor(e.connectedBackgroundColor),m.refreshImmediately(),m.painter.toDataURL()}else return e.connectedBackgroundColor&&m.add(new ci({shape:{x:0,y:0,width:g,height:p},style:{fill:e.connectedBackgroundColor}})),N(c,function(b){var _=new du({style:{x:b.left*f-l,y:b.top*f-h,image:b.dom}});m.add(_)}),m.refreshImmediately(),v.toDataURL("image/"+(e&&e.type||"png"))}else return this.getDataURL(e)},t.prototype.convertToPixel=function(e,i){return mM(this,"convertToPixel",e,i)},t.prototype.convertFromPixel=function(e,i){return mM(this,"convertFromPixel",e,i)},t.prototype.containPixel=function(e,i){if(this._disposed){this.id;return}var r=this._model,o,s=s0(r,e);return N(s,function(a,l){l.indexOf("Models")>=0&&N(a,function(h){var u=h.coordinateSystem;if(u&&u.containPoint)o=o||!!u.containPoint(i);else if(l==="seriesModels"){var d=this._chartsMap[h.__viewId];d&&d.containPoint&&(o=o||d.containPoint(i,h))}},this)},this),!!o},t.prototype.getVisual=function(e,i){var r=this._model,o=s0(r,e,{defaultMainType:"series"}),s=o.seriesModel,a=s.getData(),l=o.hasOwnProperty("dataIndexInside")?o.dataIndexInside:o.hasOwnProperty("dataIndex")?a.indexOfRawIndex(o.dataIndex):null;return l!=null?cst(a,l,i):fst(a,i)},t.prototype.getViewOfComponentModel=function(e){return this._componentsMap[e.__viewId]},t.prototype.getViewOfSeriesModel=function(e){return this._chartsMap[e.__viewId]},t.prototype._initEvents=function(){var e=this;N(sat,function(i){var r=function(o){var s=e.getModel(),a=o.target,l,h=i==="globalout";if(h?l={}:a&&Iv(a,function(g){var p=pe(g);if(p&&p.dataIndex!=null){var v=p.dataModel||s.getSeriesByIndex(p.seriesIndex);return l=v&&v.getDataParams(p.dataIndex,p.dataType,a)||{},!0}else if(p.eventData)return l=ft({},p.eventData),!0},!0),l){var u=l.componentType,d=l.componentIndex;(u==="markLine"||u==="markPoint"||u==="markArea")&&(u="series",d=l.seriesIndex);var c=u&&d!=null&&s.getComponent(u,d),f=c&&e[c.mainType==="series"?"_chartsMap":"_componentsMap"][c.__viewId];l.event=o,l.type=i,e._$eventProcessor.eventInfo={targetEl:a,packedEvent:l,model:c,view:f},e.trigger(i,l)}};r.zrEventfulCallAtLast=!0,e._zr.on(i,r,e)}),N(c0,function(i,r){e._messageCenter.on(r,function(o){this.trigger(r,o)},e)}),N(["selectchanged"],function(i){e._messageCenter.on(i,function(r){this.trigger(i,r)},e)}),pst(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var e=this.getDom();e&&X8(this.getDom(),uL,"");var i=this,r=i._api,o=i._model;N(i._componentsViews,function(s){s.dispose(o,r)}),N(i._chartsViews,function(s){s.dispose(o,r)}),i._zr.dispose(),i._dom=i._model=i._chartsMap=i._componentsMap=i._chartsViews=i._componentsViews=i._scheduler=i._api=i._zr=i._throttledZrFlush=i._theme=i._coordSysMgr=i._messageCenter=null,delete f0[i.id]},t.prototype.resize=function(e){if(!this[sr]){if(this._disposed){this.id;return}this._zr.resize(e);var i=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!i){var r=i.resetOption("media"),o=e&&e.silent;this[Lr]&&(o==null&&(o=this[Lr].silent),r=!0,this[Lr]=null),this[sr]=!0;try{r&&Uc(this),oh.update.call(this,{type:"resize",animation:ft({duration:0},e&&e.animation)})}catch(s){throw this[sr]=!1,s}this[sr]=!1,Kp.call(this,o),qp.call(this,o)}}},t.prototype.showLoading=function(e,i){if(this._disposed){this.id;return}if(Ht(e)&&(i=e,e=""),e=e||"default",this.hideLoading(),!!bB[e]){var r=bB[e](this._api,i),o=this._zr;this._loadingFX=r,o.add(r)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(e){var i=ft({},e);return i.type=c0[e.type],i},t.prototype.dispatchAction=function(e,i){if(this._disposed){this.id;return}if(Ht(i)||(i={silent:!!i}),!!tw[e.type]&&this._model){if(this[sr]){this._pendingActions.push(e);return}var r=i.silent;bM.call(this,e,r);var o=i.flush;o?this._zr.flush():o!==!1&&ie.browser.weChat&&this._throttledZrFlush(),Kp.call(this,r),qp.call(this,r)}},t.prototype.updateLabelLayout=function(){Rs.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(e){if(this._disposed){this.id;return}var i=e.seriesIndex,r=this.getModel(),o=r.getSeriesByIndex(i);o.appendData(e),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){Uc=function(d){var c=d._scheduler;c.restorePipelines(d._model),c.prepareStageTasks(),vM(d,!0),vM(d,!1),c.plan()},vM=function(d,c){for(var f=d._model,g=d._scheduler,p=c?d._componentsViews:d._chartsViews,v=c?d._componentsMap:d._chartsMap,m=d._zr,y=d._api,b=0;b<p.length;b++)p[b].__alive=!1;c?f.eachComponent(function(C,x){C!=="series"&&_(x)}):f.eachSeries(_);function _(C){var x=C.__requireNewView;C.__requireNewView=!1;var S="_ec_"+C.id+"_"+C.type,A=!x&&v[S];if(!A){var T=Pa(C.type),M=c?Zr.getClass(T.main,T.sub):Ur.getClass(T.sub);A=new M,A.init(f,y),v[S]=A,p.push(A),m.add(A.group)}C.__viewId=A.__id=S,A.__alive=!0,A.__model=C,A.group.__ecComponentInfo={mainType:C.mainType,index:C.componentIndex},!c&&g.prepareView(A,C,f,y)}for(var b=0;b<p.length;){var w=p[b];w.__alive?b++:(!c&&w.renderTask.dispose(),m.remove(w.group),w.dispose(f,y),p.splice(b,1),v[w.__id]===w&&delete v[w.__id],w.__id=w.group.__ecComponentInfo=null)}},mb=function(d,c,f,g,p){var v=d._model;if(v.setUpdatePayload(f),!g){N([].concat(d._componentsViews).concat(d._chartsViews),w);return}var m={};m[g+"Id"]=f[g+"Id"],m[g+"Index"]=f[g+"Index"],m[g+"Name"]=f[g+"Name"];var y={mainType:g,query:m};p&&(y.subType=p);var b=f.excludeSeriesId,_;b!=null&&(_=$t(),N(Ni(b),function(C){var x=_o(C,null);x!=null&&_.set(x,!0)})),v&&v.eachComponent(y,function(C){var x=_&&_.get(C.id)!=null;if(!x)if(iH(f))if(C instanceof Ao)f.type===Fd&&!f.notBlur&&!C.get(["emphasis","disabled"])&&ant(C,f,d._api);else{var S=FE(C.mainType,C.componentIndex,f.name,d._api),A=S.focusSelf,T=S.dispatchers;f.type===Fd&&A&&!f.notBlur&&eB(C.mainType,C.componentIndex,d._api),T&&N(T,function(M){f.type===Fd?bg(M):_g(M)})}else nB(f)&&C instanceof Ao&&(unt(C,f,d._api),tH(C),Po(d))},d),v&&v.eachComponent(y,function(C){var x=_&&_.get(C.id)!=null;x||w(d[g==="series"?"_chartsMap":"_componentsMap"][C.__viewId])},d);function w(C){C&&C.__alive&&C[c]&&C[c](C.__model,v,d._api,f)}},oh={prepareAndUpdate:function(d){Uc(this),oh.update.call(this,d,{optionChanged:d.newOption!=null})},update:function(d,c){var f=this._model,g=this._api,p=this._zr,v=this._coordSysMgr,m=this._scheduler;if(f){f.setUpdatePayload(d),m.restoreData(f,d),m.performSeriesTasks(f),v.create(f,g),m.performDataProcessorTasks(f,d),yM(this,f),v.update(f,g),e(f),m.performVisualTasks(f,d),_M(this,f,g,d,c);var y=f.get("backgroundColor")||"transparent",b=f.get("darkMode");p.setBackgroundColor(y),b!=null&&b!=="auto"&&p.setDarkMode(b),Rs.trigger("afterupdate",f,g)}},updateTransform:function(d){var c=this,f=this._model,g=this._api;if(f){f.setUpdatePayload(d);var p=[];f.eachComponent(function(m,y){if(m!=="series"){var b=c.getViewOfComponentModel(y);if(b&&b.__alive)if(b.updateTransform){var _=b.updateTransform(y,f,g,d);_&&_.update&&p.push(b)}else p.push(b)}});var v=$t();f.eachSeries(function(m){var y=c._chartsMap[m.__viewId];if(y.updateTransform){var b=y.updateTransform(m,f,g,d);b&&b.update&&v.set(m.uid,1)}else v.set(m.uid,1)}),e(f),this._scheduler.performVisualTasks(f,d,{setDirty:!0,dirtyMap:v}),yb(this,f,g,d,{},v),Rs.trigger("afterupdate",f,g)}},updateView:function(d){var c=this._model;c&&(c.setUpdatePayload(d),Ur.markUpdateMethod(d,"updateView"),e(c),this._scheduler.performVisualTasks(c,d,{setDirty:!0}),_M(this,c,this._api,d,{}),Rs.trigger("afterupdate",c,this._api))},updateVisual:function(d){var c=this,f=this._model;f&&(f.setUpdatePayload(d),f.eachSeries(function(g){g.getData().clearAllVisual()}),Ur.markUpdateMethod(d,"updateVisual"),e(f),this._scheduler.performVisualTasks(f,d,{visualType:"visual",setDirty:!0}),f.eachComponent(function(g,p){if(g!=="series"){var v=c.getViewOfComponentModel(p);v&&v.__alive&&v.updateVisual(p,f,c._api,d)}}),f.eachSeries(function(g){var p=c._chartsMap[g.__viewId];p.updateVisual(g,f,c._api,d)}),Rs.trigger("afterupdate",f,this._api))},updateLayout:function(d){oh.update.call(this,d)}},mM=function(d,c,f,g){if(d._disposed){d.id;return}for(var p=d._model,v=d._coordSysMgr.getCoordinateSystems(),m,y=s0(p,f),b=0;b<v.length;b++){var _=v[b];if(_[c]&&(m=_[c](p,y,g))!=null)return m}},yM=function(d,c){var f=d._chartsMap,g=d._scheduler;c.eachSeries(function(p){g.updateStreamModes(p,f[p.__viewId])})},bM=function(d,c){var f=this,g=this.getModel(),p=d.type,v=d.escapeConnect,m=tw[p],y=m.actionInfo,b=(y.update||"update").split(":"),_=b.pop(),w=b[0]!=null&&Pa(b[0]);this[sr]=!0;var C=[d],x=!1;d.batch&&(x=!0,C=St(d.batch,function(P){return P=Gt(ft({},P),d),P.batch=null,P}));var S=[],A,T=nB(d),M=iH(d);if(M&&p9(this._api),N(C,function(P){if(A=m.action(P,f._model,f._api),A=A||ft({},P),A.type=y.event||A.type,S.push(A),M){var B=LE(d),k=B.queryOptionMap,L=B.mainTypeSpecified,O=L?k.keys()[0]:"series";mb(f,_,P,O),Po(f)}else T?(mb(f,_,P,"series"),Po(f)):w&&mb(f,_,P,w.main,w.sub)}),_!=="none"&&!M&&!T&&!w)try{this[Lr]?(Uc(this),oh.update.call(this,d),this[Lr]=null):oh[_].call(this,d)}catch(P){throw this[sr]=!1,P}if(x?A={type:y.event||p,escapeConnect:v,batch:S}:A=S[0],this[sr]=!1,!c){var R=this._messageCenter;if(R.trigger(A.type,A),T){var E={type:"selectchanged",escapeConnect:v,selected:dnt(g),isFromClick:d.isFromClick||!1,fromAction:d.type,fromActionPayload:d};R.trigger(E.type,E)}}},Kp=function(d){for(var c=this._pendingActions;c.length;){var f=c.shift();bM.call(this,f,d)}},qp=function(d){!d&&this.trigger("updated")},vF=function(d,c){d.on("rendered",function(f){c.trigger("rendered",f),d.animation.isFinished()&&!c[Lr]&&!c._scheduler.unfinished&&!c._pendingActions.length&&c.trigger("finished")})},mF=function(d,c){d.on("mouseover",function(f){var g=f.target,p=Iv(g,Y0);p&&(lnt(p,f,c._api),Po(c))}).on("mouseout",function(f){var g=f.target,p=Iv(g,Y0);p&&(hnt(p,f,c._api),Po(c))}).on("click",function(f){var g=f.target,p=Iv(g,function(y){return pe(y).dataIndex!=null},!0);if(p){var v=p.selected?"unselect":"select",m=pe(p);c._api.dispatchAction({type:v,dataType:m.dataType,dataIndexInside:m.dataIndex,seriesIndex:m.seriesIndex,isFromClick:!0})}})};function e(d){d.clearColorPalette(),d.eachSeries(function(c){c.clearColorPalette()})}function i(d){var c=[],f=[],g=!1;if(d.eachComponent(function(y,b){var _=b.get("zlevel")||0,w=b.get("z")||0,C=b.getZLevelKey();g=g||!!C,(y==="series"?f:c).push({zlevel:_,z:w,idx:b.componentIndex,type:y,key:C})}),g){var p=c.concat(f),v,m;V_(p,function(y,b){return y.zlevel===b.zlevel?y.z-b.z:y.zlevel-b.zlevel}),N(p,function(y){var b=d.getComponent(y.type,y.idx),_=y.zlevel,w=y.key;v!=null&&(_=Math.max(v,_)),w?(_===v&&w!==m&&_++,m=w):m&&(_===v&&_++,m=""),v=_,b.setZLevel(_)})}}_M=function(d,c,f,g,p){i(c),yF(d,c,f,g,p),N(d._chartsViews,function(v){v.__alive=!1}),yb(d,c,f,g,p),N(d._chartsViews,function(v){v.__alive||v.remove(c,f)})},yF=function(d,c,f,g,p,v){N(v||d._componentsViews,function(m){var y=m.__model;h(y,m),m.render(y,c,f,g),a(y,m),u(y,m)})},yb=function(d,c,f,g,p,v){var m=d._scheduler;p=ft(p||{},{updatedSeries:c.getSeries()}),Rs.trigger("series:beforeupdate",c,f,p);var y=!1;c.eachSeries(function(b){var _=d._chartsMap[b.__viewId];_.__alive=!0;var w=_.renderTask;m.updatePayload(w,g),h(b,_),v&&v.get(b.uid)&&w.dirty(),w.perform(m.getPerformArgs(w))&&(y=!0),_.group.silent=!!b.get("silent"),s(b,_),tH(b)}),m.unfinished=y||m.unfinished,Rs.trigger("series:layoutlabels",c,f,p),Rs.trigger("series:transition",c,f,p),c.eachSeries(function(b){var _=d._chartsMap[b.__viewId];a(b,_),u(b,_)}),o(d,c),Rs.trigger("series:afterupdate",c,f,p)},Po=function(d){d[gM]=!0,d.getZr().wakeUp()},_F=function(d){d[gM]&&(d.getZr().storage.traverse(function(c){Nf(c)||r(c)}),d[gM]=!1)};function r(d){for(var c=[],f=d.currentStates,g=0;g<f.length;g++){var p=f[g];p==="emphasis"||p==="blur"||p==="select"||c.push(p)}d.selected&&d.states.select&&c.push("select"),d.hoverState===sS&&d.states.emphasis?c.push("emphasis"):d.hoverState===oS&&d.states.blur&&c.push("blur"),d.useStates(c)}function o(d,c){var f=d._zr,g=f.storage,p=0;g.traverse(function(v){v.isGroup||p++}),p>c.get("hoverLayerThreshold")&&!ie.node&&!ie.worker&&c.eachSeries(function(v){if(!v.preventUsingHoverLayer){var m=d._chartsMap[v.__viewId];m.__alive&&m.eachRendered(function(y){y.states.emphasis&&(y.states.emphasis.hoverLayer=!0)})}})}function s(d,c){var f=d.get("blendMode")||null;c.eachRendered(function(g){g.isGroup||(g.style.blend=f)})}function a(d,c){if(!d.preventAutoZ){var f=d.get("z")||0,g=d.get("zlevel")||0;c.eachRendered(function(p){return l(p,f,g,-1/0),!0})}}function l(d,c,f,g){var p=d.getTextContent(),v=d.getTextGuideLine(),m=d.isGroup;if(m)for(var y=d.childrenRef(),b=0;b<y.length;b++)g=Math.max(l(y[b],c,f,g),g);else d.z=c,d.zlevel=f,g=Math.max(d.z2,g);if(p&&(p.z=c,p.zlevel=f,isFinite(g)&&(p.z2=g+2)),v){var _=d.textGuideLineConfig;v.z=c,v.zlevel=f,isFinite(g)&&(v.z2=g+(_&&_.showAbove?1:-1))}return g}function h(d,c){c.eachRendered(function(f){if(!Nf(f)){var g=f.getTextContent(),p=f.getTextGuideLine();f.stateTransition&&(f.stateTransition=null),g&&g.stateTransition&&(g.stateTransition=null),p&&p.stateTransition&&(p.stateTransition=null),f.hasState()?(f.prevStates=f.currentStates,f.clearStates()):f.prevStates&&(f.prevStates=null)}})}function u(d,c){var f=d.getModel("stateAnimation"),g=d.isAnimationEnabled(),p=f.get("duration"),v=p>0?{duration:p,delay:f.get("delay"),easing:f.get("easing")}:null;c.eachRendered(function(m){if(m.states&&m.states.emphasis){if(Nf(m))return;if(m instanceof Ee&&pnt(m),m.__dirty){var y=m.prevStates;y&&m.useStates(y)}if(g){m.stateTransition=v;var b=m.getTextContent(),_=m.getTextGuideLine();b&&(b.stateTransition=v),_&&(_.stateTransition=v)}m.__dirty&&r(m)}})}bF=function(d){return new(function(c){ct(f,c);function f(){return c!==null&&c.apply(this,arguments)||this}return f.prototype.getCoordinateSystems=function(){return d._coordSysMgr.getCoordinateSystems()},f.prototype.getComponentByElement=function(g){for(;g;){var p=g.__ecComponentInfo;if(p!=null)return d._model.getComponent(p.mainType,p.index);g=g.parent}},f.prototype.enterEmphasis=function(g,p){bg(g,p),Po(d)},f.prototype.leaveEmphasis=function(g,p){_g(g,p),Po(d)},f.prototype.enterBlur=function(g){snt(g),Po(d)},f.prototype.leaveBlur=function(g){d9(g),Po(d)},f.prototype.enterSelect=function(g){c9(g),Po(d)},f.prototype.leaveSelect=function(g){f9(g),Po(d)},f.prototype.getModel=function(){return d.getModel()},f.prototype.getViewOfComponentModel=function(g){return d.getViewOfComponentModel(g)},f.prototype.getViewOfSeriesModel=function(g){return d.getViewOfSeriesModel(g)},f}(e$))(d)},j$=function(d){function c(f,g){for(var p=0;p<f.length;p++){var v=f[p];v[pM]=g}}N(c0,function(f,g){d._messageCenter.on(g,function(p){if(CF[d.group]&&d[pM]!==pF){if(p&&p.escapeConnect)return;var v=d.makeActionFromEvent(p),m=[];N(f0,function(y){y!==d&&y.group===d.group&&m.push(y)}),c(m,pF),N(m,function(y){y[pM]!==rat&&y.dispatchAction(v)}),c(m,oat)}})})}}(),t}(ys),hL=U$.prototype;hL.on=N$("on");hL.off=N$("off");hL.one=function(n,t,e){var i=this;function r(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];t&&t.apply&&t.apply(this,o),i.off(n,r)}this.on.call(this,n,r,e)};var sat=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var tw={},c0={},mB=[],yB=[],ew=[],X$={},bB={},f0={},CF={},aat=+new Date-0,uL="_echarts_instance_";function f7t(n,t,e){{var i=lat(n);if(i)return i}var r=new U$(n,t,e);return r.id="ec_"+aat++,f0[r.id]=r,X8(n,uL,r.id),j$(r),Rs.trigger("afterinit",r),r}function lat(n){return f0[Qet(n,uL)]}function Y$(n,t){X$[n]=t}function K$(n){_e(yB,n)<0&&yB.push(n)}function q$(n,t){cL(mB,n,t,qst)}function hat(n){dL("afterinit",n)}function uat(n){dL("afterupdate",n)}function dL(n,t){Rs.on(n,t)}function Ua(n,t,e){jt(t)&&(e=t,t="");var i=Ht(n)?n.type:[n,n={event:t}][0];n.event=(n.event||i).toLowerCase(),t=n.event,!c0[t]&&(ps(gF.test(i)&&gF.test(t)),tw[i]||(tw[i]={action:e,actionInfo:n}),c0[t]=i)}function dat(n,t){iL.register(n,t)}function cat(n,t){cL(ew,n,t,H$,"layout")}function Mc(n,t){cL(ew,n,t,F$,"visual")}var wF=[];function cL(n,t,e,i,r){if((jt(t)||Ht(t))&&(e=t,t=i),!(_e(wF,e)>=0)){wF.push(e);var o=x$.wrapStageHandler(e,r);o.__prio=t,o.__raw=e,n.push(o)}}function Z$(n,t){bB[n]=t}function fat(n,t,e){var i=jst("registerMap");i&&i(n,t,e)}var gat=_ot;Mc(lL,Kot);Mc(AS,qot);Mc(AS,Zot);Mc(lL,ust);Mc(AS,dst);Mc(z$,Gst);K$(n$);q$(Yst,iot);Z$("default",Jot);Ua({type:Fd,event:Fd,update:Fd},ir);Ua({type:Y_,event:Y_,update:Y_},ir);Ua({type:a0,event:a0,update:a0},ir);Ua({type:K_,event:K_,update:K_},ir);Ua({type:l0,event:l0,update:l0},ir);Y$("light",lst);Y$("dark",M$);function Zp(n){return n==null?0:n.length||1}function xF(n){return n}var rc=function(){function n(t,e,i,r,o,s){this._old=t,this._new=e,this._oldKeyGetter=i||xF,this._newKeyGetter=r||xF,this.context=o,this._diffModeMultiple=s==="multiple"}return n.prototype.add=function(t){return this._add=t,this},n.prototype.update=function(t){return this._update=t,this},n.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},n.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},n.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},n.prototype.remove=function(t){return this._remove=t,this},n.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},n.prototype._executeOneToOne=function(){var t=this._old,e=this._new,i={},r=new Array(t.length),o=new Array(e.length);this._initIndexMap(t,null,r,"_oldKeyGetter"),this._initIndexMap(e,i,o,"_newKeyGetter");for(var s=0;s<t.length;s++){var a=r[s],l=i[a],h=Zp(l);if(h>1){var u=l.shift();l.length===1&&(i[a]=l[0]),this._update&&this._update(u,s)}else h===1?(i[a]=null,this._update&&this._update(l,s)):this._remove&&this._remove(s)}this._performRestAdd(o,i)},n.prototype._executeMultiple=function(){var t=this._old,e=this._new,i={},r={},o=[],s=[];this._initIndexMap(t,i,o,"_oldKeyGetter"),this._initIndexMap(e,r,s,"_newKeyGetter");for(var a=0;a<o.length;a++){var l=o[a],h=i[l],u=r[l],d=Zp(h),c=Zp(u);if(d>1&&c===1)this._updateManyToOne&&this._updateManyToOne(u,h),r[l]=null;else if(d===1&&c>1)this._updateOneToMany&&this._updateOneToMany(u,h),r[l]=null;else if(d===1&&c===1)this._update&&this._update(u,h),r[l]=null;else if(d>1&&c>1)this._updateManyToMany&&this._updateManyToMany(u,h),r[l]=null;else if(d>1)for(var f=0;f<d;f++)this._remove&&this._remove(h[f]);else this._remove&&this._remove(h)}this._performRestAdd(s,r)},n.prototype._performRestAdd=function(t,e){for(var i=0;i<t.length;i++){var r=t[i],o=e[r],s=Zp(o);if(s>1)for(var a=0;a<s;a++)this._add&&this._add(o[a]);else s===1&&this._add&&this._add(o);e[r]=null}},n.prototype._initIndexMap=function(t,e,i,r){for(var o=this._diffModeMultiple,s=0;s<t.length;s++){var a="_ec_"+this[r](t[s],s);if(o||(i[s]=a),!!e){var l=e[a],h=Zp(l);h===0?(e[a]=s,o&&i.push(a)):h===1?e[a]=[l,s]:l.push(s)}}},n}(),pat=function(){function n(t,e){this._encode=t,this._schema=e}return n.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},n.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},n}();function vat(n,t){var e={},i=e.encode={},r=$t(),o=[],s=[],a={};N(n.dimensions,function(c){var f=n.getDimensionInfo(c),g=f.coordDim;if(g){var p=f.coordDimIndex;CM(i,g)[p]=c,f.isExtraCoord||(r.set(g,1),yat(f.type)&&(o[0]=c),CM(a,g)[p]=n.getDimensionIndex(f.name)),f.defaultTooltip&&s.push(c)}K9.each(function(v,m){var y=CM(i,m),b=f.otherDims[m];b!=null&&b!==!1&&(y[b]=f.name)})});var l=[],h={};r.each(function(c,f){var g=i[f];h[f]=g[0],l=l.concat(g)}),e.dataDimsOnCoord=l,e.dataDimIndicesOnCoord=St(l,function(c){return n.getDimensionInfo(c).storeDimIndex}),e.encodeFirstDimNotExtra=h;var u=i.label;u&&u.length&&(o=u.slice());var d=i.tooltip;return d&&d.length?s=d.slice():s.length||(s=o.slice()),i.defaultedLabel=o,i.defaultedTooltip=s,e.userOutput=new pat(a,t),e}function CM(n,t){return n.hasOwnProperty(t)||(n[t]=[]),n[t]}function mat(n){return n==="category"?"ordinal":n==="time"?"time":"float"}function yat(n){return!(n==="ordinal"||n==="time")}var tC=function(){function n(t){this.otherDims={},t!=null&&ft(this,t)}return n}(),bat=Ke(),_at={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},J$=function(){function n(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return n.prototype.isDimensionOmitted=function(){return this._dimOmitted},n.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=e7(this.source)))},n.prototype.getSourceDimensionIndex=function(t){return ve(this._dimNameMap.get(t),-1)},n.prototype.getSourceDimension=function(t){var e=this.source.dimensionsDefine;if(e)return e[t]},n.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,e=s$(this.source),i=!i7(t),r="",o=[],s=0,a=0;s<t;s++){var l=void 0,h=void 0,u=void 0,d=this.dimensions[a];if(d&&d.storeDimIndex===s)l=e?d.name:null,h=d.type,u=d.ordinalMeta,a++;else{var c=this.getSourceDimension(s);c&&(l=e?c.name:null,h=c.type)}o.push({property:l,type:h,ordinalMeta:u}),e&&l!=null&&(!d||!d.isCalculationCoord)&&(r+=i?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),r+="$",r+=_at[h]||"f",u&&(r+=u.uid),r+="$"}var f=this.source,g=[f.seriesLayoutBy,f.startIndex,r].join("$$");return{dimensions:o,hash:g}},n.prototype.makeOutputDimensionNames=function(){for(var t=[],e=0,i=0;e<this._fullDimCount;e++){var r=void 0,o=this.dimensions[i];if(o&&o.storeDimIndex===e)o.isCalculationCoord||(r=o.name),i++;else{var s=this.getSourceDimension(e);s&&(r=s.name)}t.push(r)}return t},n.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},n}();function Q$(n){return n instanceof J$}function t7(n){for(var t=$t(),e=0;e<(n||[]).length;e++){var i=n[e],r=Ht(i)?i.name:i;r!=null&&t.get(r)==null&&t.set(r,e)}return t}function e7(n){var t=bat(n);return t.dimNameMap||(t.dimNameMap=t7(n.dimensionsDefine))}function i7(n){return n>30}var Jp=Ht,sh=St,Cat=typeof Int32Array>"u"?Array:Int32Array,wat="e\0\0",SF=-1,xat=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],Sat=["_approximateExtent"],AF,bb,Qp,tv,wM,ev,xM,fL=function(){function n(t,e){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var i,r=!1;Q$(t)?(i=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(r=!0,i=t),i=i||["x","y"];for(var o={},s=[],a={},l=!1,h={},u=0;u<i.length;u++){var d=i[u],c=Pt(d)?new tC({name:d}):d instanceof tC?d:new tC(d),f=c.name;c.type=c.type||"float",c.coordDim||(c.coordDim=f,c.coordDimIndex=0);var g=c.otherDims=c.otherDims||{};s.push(f),o[f]=c,h[f]!=null&&(l=!0),c.createInvertedIndices&&(a[f]=[]),g.itemName===0&&(this._nameDimIdx=u),g.itemId===0&&(this._idDimIdx=u),r&&(c.storeDimIndex=u)}if(this.dimensions=s,this._dimInfos=o,this._initGetDimensionInfo(l),this.hostModel=e,this._invertedIndicesMap=a,this._dimOmitted){var p=this._dimIdxToName=$t();N(s,function(v){p.set(o[v].storeDimIndex,v)})}}return n.prototype.getDimension=function(t){var e=this._recognizeDimIndex(t);if(e==null)return t;if(e=t,!this._dimOmitted)return this.dimensions[e];var i=this._dimIdxToName.get(e);if(i!=null)return i;var r=this._schema.getSourceDimension(e);if(r)return r.name},n.prototype.getDimensionIndex=function(t){var e=this._recognizeDimIndex(t);if(e!=null)return e;if(t==null)return-1;var i=this._getDimInfo(t);return i?i.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},n.prototype._recognizeDimIndex=function(t){if(di(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},n.prototype._getStoreDimIndex=function(t){var e=this.getDimensionIndex(t);return e},n.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},n.prototype._initGetDimensionInfo=function(t){var e=this._dimInfos;this._getDimInfo=t?function(i){return e.hasOwnProperty(i)?e[i]:void 0}:function(i){return e[i]}},n.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},n.prototype.mapDimension=function(t,e){var i=this._dimSummary;if(e==null)return i.encodeFirstDimNotExtra[t];var r=i.encode[t];return r?r[e]:null},n.prototype.mapDimensionsAll=function(t){var e=this._dimSummary,i=e.encode[t];return(i||[]).slice()},n.prototype.getStore=function(){return this._store},n.prototype.initData=function(t,e,i){var r=this,o;if(t instanceof uB&&(o=t),!o){var s=this.dimensions,a=nL(t)||Yr(t)?new a$(t,s.length):t;o=new uB;var l=sh(s,function(h){return{type:r._dimInfos[h].type,property:h}});o.initData(a,l,i)}this._store=o,this._nameList=(e||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,o.count()),this._dimSummary=vat(this,this._schema),this.userOutput=this._dimSummary.userOutput},n.prototype.appendData=function(t){var e=this._store.appendData(t);this._doInit(e[0],e[1])},n.prototype.appendValues=function(t,e){var i=this._store.appendValues(t,e&&e.length),r=i.start,o=i.end,s=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),e)for(var a=r;a<o;a++){var l=a-r;this._nameList[a]=e[l],s&&xM(this,a)}},n.prototype._updateOrdinalMeta=function(){for(var t=this._store,e=this.dimensions,i=0;i<e.length;i++){var r=this._dimInfos[e[i]];r.ordinalMeta&&t.collectOrdinalMeta(r.storeDimIndex,r.ordinalMeta)}},n.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==Vh&&!t.fillStorage},n.prototype._doInit=function(t,e){if(!(t>=e)){var i=this._store,r=i.getProvider();this._updateOrdinalMeta();var o=this._nameList,s=this._idList,a=r.getSource().sourceFormat,l=a===bs;if(l&&!r.pure)for(var h=[],u=t;u<e;u++){var d=r.getItem(u,h);if(!this.hasItemOption&&Net(d)&&(this.hasItemOption=!0),d){var c=d.name;o[u]==null&&c!=null&&(o[u]=_o(c,null));var f=d.id;s[u]==null&&f!=null&&(s[u]=_o(f,null))}}if(this._shouldMakeIdFromName())for(var u=t;u<e;u++)xM(this,u);AF(this)}},n.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},n.prototype.setApproximateExtent=function(t,e){e=this.getDimension(e),this._approximateExtent[e]=t.slice()},n.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},n.prototype.setCalculationInfo=function(t,e){Jp(t)?ft(this._calculationInfo,t):this._calculationInfo[t]=e},n.prototype.getName=function(t){var e=this.getRawIndex(t),i=this._nameList[e];return i==null&&this._nameDimIdx!=null&&(i=Qp(this,this._nameDimIdx,e)),i==null&&(i=""),i},n.prototype._getCategory=function(t,e){var i=this._store.get(t,e),r=this._store.getOrdinalMeta(t);return r?r.categories[i]:i},n.prototype.getId=function(t){return bb(this,this.getRawIndex(t))},n.prototype.count=function(){return this._store.count()},n.prototype.get=function(t,e){var i=this._store,r=this._dimInfos[t];if(r)return i.get(r.storeDimIndex,e)},n.prototype.getByRawIndex=function(t,e){var i=this._store,r=this._dimInfos[t];if(r)return i.getByRawIndex(r.storeDimIndex,e)},n.prototype.getIndices=function(){return this._store.getIndices()},n.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},n.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},n.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},n.prototype.getValues=function(t,e){var i=this,r=this._store;return _t(t)?r.getValues(sh(t,function(o){return i._getStoreDimIndex(o)}),e):r.getValues(t)},n.prototype.hasValue=function(t){for(var e=this._dimSummary.dataDimIndicesOnCoord,i=0,r=e.length;i<r;i++)if(isNaN(this._store.get(e[i],t)))return!1;return!0},n.prototype.indexOfName=function(t){for(var e=0,i=this._store.count();e<i;e++)if(this.getName(e)===t)return e;return-1},n.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},n.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},n.prototype.rawIndexOf=function(t,e){var i=t&&this._invertedIndicesMap[t],r=i&&i[e];return r==null||isNaN(r)?SF:r},n.prototype.indicesOfNearest=function(t,e,i){return this._store.indicesOfNearest(this._getStoreDimIndex(t),e,i)},n.prototype.each=function(t,e,i){jt(t)&&(i=e,e=t,t=[]);var r=i||this,o=sh(tv(t),this._getStoreDimIndex,this);this._store.each(o,r?zt(e,r):e)},n.prototype.filterSelf=function(t,e,i){jt(t)&&(i=e,e=t,t=[]);var r=i||this,o=sh(tv(t),this._getStoreDimIndex,this);return this._store=this._store.filter(o,r?zt(e,r):e),this},n.prototype.selectRange=function(t){var e=this,i={},r=yi(t);return N(r,function(o){var s=e._getStoreDimIndex(o);i[s]=t[o]}),this._store=this._store.selectRange(i),this},n.prototype.mapArray=function(t,e,i){jt(t)&&(i=e,e=t,t=[]),i=i||this;var r=[];return this.each(t,function(){r.push(e&&e.apply(this,arguments))},i),r},n.prototype.map=function(t,e,i,r){var o=i||r||this,s=sh(tv(t),this._getStoreDimIndex,this),a=ev(this);return a._store=this._store.map(s,o?zt(e,o):e),a},n.prototype.modify=function(t,e,i,r){var o=i||r||this,s=sh(tv(t),this._getStoreDimIndex,this);this._store.modify(s,o?zt(e,o):e)},n.prototype.downSample=function(t,e,i,r){var o=ev(this);return o._store=this._store.downSample(this._getStoreDimIndex(t),e,i,r),o},n.prototype.minmaxDownSample=function(t,e){var i=ev(this);return i._store=this._store.minmaxDownSample(this._getStoreDimIndex(t),e),i},n.prototype.lttbDownSample=function(t,e){var i=ev(this);return i._store=this._store.lttbDownSample(this._getStoreDimIndex(t),e),i},n.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},n.prototype.getItemModel=function(t){var e=this.hostModel,i=this.getRawDataItem(t);return new ui(i,e,e&&e.ecModel)},n.prototype.diff=function(t){var e=this;return new rc(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(i){return bb(t,i)},function(i){return bb(e,i)})},n.prototype.getVisual=function(t){var e=this._visual;return e&&e[t]},n.prototype.setVisual=function(t,e){this._visual=this._visual||{},Jp(t)?ft(this._visual,t):this._visual[t]=e},n.prototype.getItemVisual=function(t,e){var i=this._itemVisuals[t],r=i&&i[e];return r??this.getVisual(e)},n.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},n.prototype.ensureUniqueItemVisual=function(t,e){var i=this._itemVisuals,r=i[t];r||(r=i[t]={});var o=r[e];return o==null&&(o=this.getVisual(e),_t(o)?o=o.slice():Jp(o)&&(o=ft({},o)),r[e]=o),o},n.prototype.setItemVisual=function(t,e,i){var r=this._itemVisuals[t]||{};this._itemVisuals[t]=r,Jp(e)?ft(r,e):r[e]=i},n.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},n.prototype.setLayout=function(t,e){Jp(t)?ft(this._layout,t):this._layout[t]=e},n.prototype.getLayout=function(t){return this._layout[t]},n.prototype.getItemLayout=function(t){return this._itemLayouts[t]},n.prototype.setItemLayout=function(t,e,i){this._itemLayouts[t]=i?ft(this._itemLayouts[t]||{},e):e},n.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},n.prototype.setItemGraphicEl=function(t,e){var i=this.hostModel&&this.hostModel.seriesIndex;Jit(i,this.dataType,t,e),this._graphicEls[t]=e},n.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},n.prototype.eachItemGraphicEl=function(t,e){N(this._graphicEls,function(i,r){i&&t&&t.call(e,i,r)})},n.prototype.cloneShallow=function(t){return t||(t=new n(this._schema?this._schema:sh(this.dimensions,this._getDimInfo,this),this.hostModel)),wM(t,this),t._store=this._store,t},n.prototype.wrapMethod=function(t,e){var i=this[t];jt(i)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var r=i.apply(this,arguments);return e.apply(this,[r].concat(AE(arguments)))})},n.internalField=function(){AF=function(t){var e=t._invertedIndicesMap;N(e,function(i,r){var o=t._dimInfos[r],s=o.ordinalMeta,a=t._store;if(s){i=e[r]=new Cat(s.categories.length);for(var l=0;l<i.length;l++)i[l]=SF;for(var l=0;l<a.count();l++)i[a.get(o.storeDimIndex,l)]=l}})},Qp=function(t,e,i){return _o(t._getCategory(e,i),null)},bb=function(t,e){var i=t._idList[e];return i==null&&t._idDimIdx!=null&&(i=Qp(t,t._idDimIdx,e)),i==null&&(i=wat+e),i},tv=function(t){return _t(t)||(t=t!=null?[t]:[]),t},ev=function(t){var e=new n(t._schema?t._schema:sh(t.dimensions,t._getDimInfo,t),t.hostModel);return wM(e,t),e},wM=function(t,e){N(xat.concat(e.__wrappedMethods||[]),function(i){e.hasOwnProperty(i)&&(t[i]=e[i])}),t.__wrappedMethods=e.__wrappedMethods,N(Sat,function(i){t[i]=ne(e[i])}),t._calculationInfo=ft({},e._calculationInfo)},xM=function(t,e){var i=t._nameList,r=t._idList,o=t._nameDimIdx,s=t._idDimIdx,a=i[e],l=r[e];if(a==null&&o!=null&&(i[e]=a=Qp(t,o,e)),l==null&&s!=null&&(r[e]=l=Qp(t,s,e)),l==null&&a!=null){var h=t._nameRepeatCount,u=h[a]=(h[a]||0)+1;l=a,u>1&&(l+="__ec__"+u),r[e]=l}}}(),n}();function gL(n,t){nL(n)||(n=r$(n)),t=t||{};var e=t.coordDimensions||[],i=t.dimensionsDefine||n.dimensionsDefine||[],r=$t(),o=[],s=Tat(n,e,i,t.dimensionsCount),a=t.canOmitUnusedDimensions&&i7(s),l=i===n.dimensionsDefine,h=l?e7(n):t7(i),u=t.encodeDefine;!u&&t.encodeDefaulter&&(u=t.encodeDefaulter(n,s));for(var d=$t(u),c=new c$(s),f=0;f<c.length;f++)c[f]=-1;function g(A){var T=c[A];if(T<0){var M=i[A],R=Ht(M)?M:{name:M},E=new tC,P=R.name;P!=null&&h.get(P)!=null&&(E.name=E.displayName=P),R.type!=null&&(E.type=R.type),R.displayName!=null&&(E.displayName=R.displayName);var B=o.length;return c[A]=B,E.storeDimIndex=A,o.push(E),E}return o[T]}if(!a)for(var f=0;f<s;f++)g(f);d.each(function(A,T){var M=Ni(A).slice();if(M.length===1&&!Pt(M[0])&&M[0]<0){d.set(T,!1);return}var R=d.set(T,[]);N(M,function(E,P){var B=Pt(E)?h.get(E):E;B!=null&&B<s&&(R[P]=B,v(g(B),T,P))})});var p=0;N(e,function(A){var T,M,R,E;if(Pt(A))T=A,E={};else{E=A,T=E.name;var P=E.ordinalMeta;E.ordinalMeta=null,E=ft({},E),E.ordinalMeta=P,M=E.dimsDef,R=E.otherDims,E.name=E.coordDim=E.coordDimIndex=E.dimsDef=E.otherDims=null}var B=d.get(T);if(B!==!1){if(B=Ni(B),!B.length)for(var k=0;k<(M&&M.length||1);k++){for(;p<s&&g(p).coordDim!=null;)p++;p<s&&B.push(p++)}N(B,function(L,O){var D=g(L);if(l&&E.type!=null&&(D.type=E.type),v(Gt(D,E),T,O),D.name==null&&M){var I=M[O];!Ht(I)&&(I={name:I}),D.name=D.displayName=I.name,D.defaultTooltip=I.defaultTooltip}R&&Gt(D.otherDims,R)})}});function v(A,T,M){K9.get(T)!=null?A.otherDims[T]=M:(A.coordDim=T,A.coordDimIndex=M,r.set(T,!0))}var m=t.generateCoord,y=t.generateCoordCount,b=y!=null;y=m?y||1:0;var _=m||"value";function w(A){A.name==null&&(A.name=A.coordDim)}if(a)N(o,function(A){w(A)}),o.sort(function(A,T){return A.storeDimIndex-T.storeDimIndex});else for(var C=0;C<s;C++){var x=g(C),S=x.coordDim;S==null&&(x.coordDim=Mat(_,r,b),x.coordDimIndex=0,(!m||y<=0)&&(x.isExtraCoord=!0),y--),w(x),x.type==null&&(J9(n,C)===$n.Must||x.isExtraCoord&&(x.otherDims.itemName!=null||x.otherDims.seriesName!=null))&&(x.type="ordinal")}return Aat(o),new J$({source:n,dimensions:o,fullDimensionCount:s,dimensionOmitted:a})}function Aat(n){for(var t=$t(),e=0;e<n.length;e++){var i=n[e],r=i.name,o=t.get(r)||0;o>0&&(i.name=r+(o-1)),o++,t.set(r,o)}}function Tat(n,t,e,i){var r=Math.max(n.dimensionsDetectedCount||1,t.length,e.length,i||0);return N(t,function(o){var s;Ht(o)&&(s=o.dimsDef)&&(r=Math.max(r,s.length))}),r}function Mat(n,t,e){if(e||t.hasKey(n)){for(var i=0;t.hasKey(n+i);)i++;n+=i}return t.set(n,!0),n}var Rat=function(){function n(t){this.coordSysDims=[],this.axisMap=$t(),this.categoryAxisMap=$t(),this.coordSysName=t}return n}();function Bat(n){var t=n.get("coordinateSystem"),e=new Rat(t),i=Pat[t];if(i)return i(n,e,e.axisMap,e.categoryAxisMap),e}var Pat={cartesian2d:function(n,t,e,i){var r=n.getReferringComponents("xAxis",Qn).models[0],o=n.getReferringComponents("yAxis",Qn).models[0];t.coordSysDims=["x","y"],e.set("x",r),e.set("y",o),Xc(r)&&(i.set("x",r),t.firstCategoryDimIndex=0),Xc(o)&&(i.set("y",o),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(n,t,e,i){var r=n.getReferringComponents("singleAxis",Qn).models[0];t.coordSysDims=["single"],e.set("single",r),Xc(r)&&(i.set("single",r),t.firstCategoryDimIndex=0)},polar:function(n,t,e,i){var r=n.getReferringComponents("polar",Qn).models[0],o=r.findAxisModel("radiusAxis"),s=r.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],e.set("radius",o),e.set("angle",s),Xc(o)&&(i.set("radius",o),t.firstCategoryDimIndex=0),Xc(s)&&(i.set("angle",s),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(n,t,e,i){t.coordSysDims=["lng","lat"]},parallel:function(n,t,e,i){var r=n.ecModel,o=r.getComponent("parallel",n.get("parallelIndex")),s=t.coordSysDims=o.dimensions.slice();N(o.parallelAxisIndex,function(a,l){var h=r.getComponent("parallelAxis",a),u=s[l];e.set(u,h),Xc(h)&&(i.set(u,h),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function Xc(n){return n.get("type")==="category"}function kat(n,t,e){e=e||{};var i=e.byIndex,r=e.stackedCoordDimension,o,s,a;Eat(t)?o=t:(s=t.schema,o=s.dimensions,a=t.store);var l=!!(n&&n.get("stack")),h,u,d,c;if(N(o,function(y,b){Pt(y)&&(o[b]=y={name:y}),l&&!y.isExtraCoord&&(!i&&!h&&y.ordinalMeta&&(h=y),!u&&y.type!=="ordinal"&&y.type!=="time"&&(!r||r===y.coordDim)&&(u=y))}),u&&!i&&!h&&(i=!0),u){d="__\0ecstackresult_"+n.id,c="__\0ecstackedover_"+n.id,h&&(h.createInvertedIndices=!0);var f=u.coordDim,g=u.type,p=0;N(o,function(y){y.coordDim===f&&p++});var v={name:d,coordDim:f,coordDimIndex:p,type:g,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:o.length},m={name:c,coordDim:c,coordDimIndex:p+1,type:g,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:o.length+1};s?(a&&(v.storeDimIndex=a.ensureCalculationDimension(c,g),m.storeDimIndex=a.ensureCalculationDimension(d,g)),s.appendCalculationDimension(v),s.appendCalculationDimension(m)):(o.push(v),o.push(m))}return{stackedDimension:u&&u.name,stackedByDimension:h&&h.name,isStackedByIndex:i,stackedOverDimension:c,stackResultDimension:d}}function Eat(n){return!Q$(n.schema)}function oc(n,t){return!!t&&t===n.getCalculationInfo("stackedDimension")}function Lat(n,t){return oc(n,t)?n.getCalculationInfo("stackResultDimension"):t}function Oat(n,t){var e=n.get("coordinateSystem"),i=iL.get(e),r;return t&&t.coordSysDims&&(r=St(t.coordSysDims,function(o){var s={name:o},a=t.axisMap.get(o);if(a){var l=a.get("type");s.type=mat(l)}return s})),r||(r=i&&(i.getDimensionsInfo?i.getDimensionsInfo():i.dimensions.slice())||["x","y"]),r}function Dat(n,t,e){var i,r;return e&&N(n,function(o,s){var a=o.coordDim,l=e.categoryAxisMap.get(a);l&&(i==null&&(i=s),o.ordinalMeta=l.getOrdinalMeta(),t&&(o.createInvertedIndices=!0)),o.otherDims.itemName!=null&&(r=!0)}),!r&&i!=null&&(n[i].otherDims.itemName=0),i}function pL(n,t,e){e=e||{};var i=t.getSourceManager(),r,o=!1;r=i.getSource(),o=r.sourceFormat===bs;var s=Bat(t),a=Oat(t,s),l=e.useEncodeDefaulter,h=jt(l)?l:l?he(Prt,a,t):null,u={coordDimensions:a,generateCoord:e.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:h,canOmitUnusedDimensions:!o},d=gL(r,u),c=Dat(d.dimensions,e.createInvertedIndices,s),f=o?null:i.getSharedDataStore(d),g=kat(t,{schema:d,store:f}),p=new fL(d,t);p.setCalculationInfo(g);var v=c!=null&&Iat(r)?function(m,y,b,_){return _===c?b:this.defaultDimValueGetter(m,y,b,_)}:null;return p.hasItemOption=!1,p.initData(o?r:f,null,v),p}function Iat(n){if(n.sourceFormat===bs){var t=Hat(n.data||[]);return!_t(oy(t))}}function Hat(n){for(var t=0;t<n.length&&n[t]==null;)t++;return n[t]}var Xa=function(){function n(t){this._setting=t||{},this._extent=[1/0,-1/0]}return n.prototype.getSetting=function(t){return this._setting[t]},n.prototype.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1])},n.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e))},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.setExtent=function(t,e){var i=this._extent;isNaN(t)||(i[0]=t),isNaN(e)||(i[1]=e)},n.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},n.prototype.isBlank=function(){return this._isBlank},n.prototype.setBlank=function(t){this._isBlank=t},n}();iS(Xa);var Fat=0,_B=function(){function n(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++Fat}return n.createByAxisModel=function(t){var e=t.option,i=e.data,r=i&&St(i,zat);return new n({categories:r,needCollect:!r,deduplication:e.dedplication!==!1})},n.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},n.prototype.parseAndCollect=function(t){var e,i=this._needCollect;if(!Pt(t)&&!i)return t;if(i&&!this._deduplication)return e=this.categories.length,this.categories[e]=t,e;var r=this._getOrCreateMap();return e=r.get(t),e==null&&(i?(e=this.categories.length,this.categories[e]=t,r.set(t,e)):e=NaN),e},n.prototype._getOrCreateMap=function(){return this._map||(this._map=$t(this.categories))},n}();function zat(n){return Ht(n)&&n.value!=null?n.value:n+""}function CB(n){return n.type==="interval"||n.type==="log"}function Nat(n,t,e,i){var r={},o=n[1]-n[0],s=r.interval=W8(o/t);e!=null&&s<e&&(s=r.interval=e),i!=null&&s>i&&(s=r.interval=i);var a=r.intervalPrecision=n7(s),l=r.niceTickExtent=[xn(Math.ceil(n[0]/s)*s,a),xn(Math.floor(n[1]/s)*s,a)];return Wat(l,n),r}function SM(n){var t=Math.pow(10,kE(n)),e=n/t;return e?e===2?e=3:e===3?e=5:e*=2:e=1,xn(e*t)}function n7(n){return Tl(n)+2}function TF(n,t,e){n[t]=Math.max(Math.min(n[t],e[1]),e[0])}function Wat(n,t){!isFinite(n[0])&&(n[0]=t[0]),!isFinite(n[1])&&(n[1]=t[1]),TF(n,0,t),TF(n,1,t),n[0]>n[1]&&(n[0]=n[1])}function TS(n,t){return n>=t[0]&&n<=t[1]}function MS(n,t){return t[1]===t[0]?.5:(n-t[0])/(t[1]-t[0])}function RS(n,t){return n*(t[1]-t[0])+t[0]}var vL=function(n){ct(t,n);function t(e){var i=n.call(this,e)||this;i.type="ordinal";var r=i.getSetting("ordinalMeta");return r||(r=new _B({})),_t(r)&&(r=new _B({categories:St(r,function(o){return Ht(o)?o.value:o})})),i._ordinalMeta=r,i._extent=i.getSetting("extent")||[0,r.categories.length-1],i}return t.prototype.parse=function(e){return e==null?NaN:Pt(e)?this._ordinalMeta.getOrdinal(e):Math.round(e)},t.prototype.contain=function(e){return e=this.parse(e),TS(e,this._extent)&&this._ordinalMeta.categories[e]!=null},t.prototype.normalize=function(e){return e=this._getTickNumber(this.parse(e)),MS(e,this._extent)},t.prototype.scale=function(e){return e=Math.round(RS(e,this._extent)),this.getRawOrdinalNumber(e)},t.prototype.getTicks=function(){for(var e=[],i=this._extent,r=i[0];r<=i[1];)e.push({value:r}),r++;return e},t.prototype.getMinorTicks=function(e){},t.prototype.setSortInfo=function(e){if(e==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var i=e.ordinalNumbers,r=this._ordinalNumbersByTick=[],o=this._ticksByOrdinalNumber=[],s=0,a=this._ordinalMeta.categories.length,l=Math.min(a,i.length);s<l;++s){var h=i[s];r[s]=h,o[h]=s}for(var u=0;s<a;++s){for(;o[u]!=null;)u++;r.push(u),o[u]=s}},t.prototype._getTickNumber=function(e){var i=this._ticksByOrdinalNumber;return i&&e>=0&&e<i.length?i[e]:e},t.prototype.getRawOrdinalNumber=function(e){var i=this._ordinalNumbersByTick;return i&&e>=0&&e<i.length?i[e]:e},t.prototype.getLabel=function(e){if(!this.isBlank()){var i=this.getRawOrdinalNumber(e.value),r=this._ordinalMeta.categories[i];return r==null?"":r+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(e,i){this.unionExtent(e.getApproximateExtent(i))},t.prototype.isInExtentRange=function(e){return e=this._getTickNumber(e),this._extent[0]<=e&&this._extent[1]>=e},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(Xa);Xa.registerClass(vL);var Nu=xn,vp=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type="interval",e._interval=0,e._intervalPrecision=2,e}return t.prototype.parse=function(e){return e},t.prototype.contain=function(e){return TS(e,this._extent)},t.prototype.normalize=function(e){return MS(e,this._extent)},t.prototype.scale=function(e){return RS(e,this._extent)},t.prototype.setExtent=function(e,i){var r=this._extent;isNaN(e)||(r[0]=parseFloat(e)),isNaN(i)||(r[1]=parseFloat(i))},t.prototype.unionExtent=function(e){var i=this._extent;e[0]<i[0]&&(i[0]=e[0]),e[1]>i[1]&&(i[1]=e[1]),this.setExtent(i[0],i[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(e){this._interval=e,this._niceExtent=this._extent.slice(),this._intervalPrecision=n7(e)},t.prototype.getTicks=function(e){var i=this._interval,r=this._extent,o=this._niceExtent,s=this._intervalPrecision,a=[];if(!i)return a;var l=1e4;r[0]<o[0]&&(e?a.push({value:Nu(o[0]-i,s)}):a.push({value:r[0]}));for(var h=o[0];h<=o[1]&&(a.push({value:h}),h=Nu(h+i,s),h!==a[a.length-1].value);)if(a.length>l)return[];var u=a.length?a[a.length-1].value:o[1];return r[1]>u&&(e?a.push({value:Nu(u+i,s)}):a.push({value:r[1]})),a},t.prototype.getMinorTicks=function(e){for(var i=this.getTicks(!0),r=[],o=this.getExtent(),s=1;s<i.length;s++){for(var a=i[s],l=i[s-1],h=0,u=[],d=a.value-l.value,c=d/e;h<e-1;){var f=Nu(l.value+(h+1)*c);f>o[0]&&f<o[1]&&u.push(f),h++}r.push(u)}return r},t.prototype.getLabel=function(e,i){if(e==null)return"";var r=i&&i.precision;r==null?r=Tl(e.value)||0:r==="auto"&&(r=this._intervalPrecision);var o=Nu(e.value,r,!0);return $9(o)},t.prototype.calcNiceTicks=function(e,i,r){e=e||5;var o=this._extent,s=o[1]-o[0];if(isFinite(s)){s<0&&(s=-s,o.reverse());var a=Nat(o,e,i,r);this._intervalPrecision=a.intervalPrecision,this._interval=a.interval,this._niceExtent=a.niceTickExtent}},t.prototype.calcNiceExtent=function(e){var i=this._extent;if(i[0]===i[1])if(i[0]!==0){var r=Math.abs(i[0]);e.fixMax||(i[1]+=r/2),i[0]-=r/2}else i[1]=1;var o=i[1]-i[0];isFinite(o)||(i[0]=0,i[1]=1),this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval);var s=this._interval;e.fixMin||(i[0]=Nu(Math.floor(i[0]/s)*s)),e.fixMax||(i[1]=Nu(Math.ceil(i[1]/s)*s))},t.prototype.setNiceExtent=function(e,i){this._niceExtent=[e,i]},t.type="interval",t}(Xa);Xa.registerClass(vp);var r7=typeof Float32Array<"u",Vat=r7?Float32Array:Array;function Ml(n){return _t(n)?r7?new Float32Array(n):n:new Vat(n)}var Gat="__ec_stack_";function o7(n){return n.get("stack")||Gat+n.seriesIndex}function mL(n){return n.dim+n.index}function s7(n,t){var e=[];return t.eachSeriesByType(n,function(i){l7(i)&&e.push(i)}),e}function $at(n){var t={};N(n,function(l){var h=l.coordinateSystem,u=h.getBaseAxis();if(!(u.type!=="time"&&u.type!=="value"))for(var d=l.getData(),c=u.dim+"_"+u.index,f=d.getDimensionIndex(d.mapDimension(u.dim)),g=d.getStore(),p=0,v=g.count();p<v;++p){var m=g.get(f,p);t[c]?t[c].push(m):t[c]=[m]}});var e={};for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];if(r){r.sort(function(l,h){return l-h});for(var o=null,s=1;s<r.length;++s){var a=r[s]-r[s-1];a>0&&(o=o===null?a:Math.min(o,a))}e[i]=o}}return e}function a7(n){var t=$at(n),e=[];return N(n,function(i){var r=i.coordinateSystem,o=r.getBaseAxis(),s=o.getExtent(),a;if(o.type==="category")a=o.getBandWidth();else if(o.type==="value"||o.type==="time"){var l=o.dim+"_"+o.index,h=t[l],u=Math.abs(s[1]-s[0]),d=o.scale.getExtent(),c=Math.abs(d[1]-d[0]);a=h?u/c*h:u}else{var f=i.getData();a=Math.abs(s[1]-s[0])/f.count()}var g=Jt(i.get("barWidth"),a),p=Jt(i.get("barMaxWidth"),a),v=Jt(i.get("barMinWidth")||(h7(i)?.5:1),a),m=i.get("barGap"),y=i.get("barCategoryGap");e.push({bandWidth:a,barWidth:g,barMaxWidth:p,barMinWidth:v,barGap:m,barCategoryGap:y,axisKey:mL(o),stackId:o7(i)})}),jat(e)}function jat(n){var t={};N(n,function(i,r){var o=i.axisKey,s=i.bandWidth,a=t[o]||{bandWidth:s,remainedWidth:s,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=a.stacks;t[o]=a;var h=i.stackId;l[h]||a.autoWidthCount++,l[h]=l[h]||{width:0,maxWidth:0};var u=i.barWidth;u&&!l[h].width&&(l[h].width=u,u=Math.min(a.remainedWidth,u),a.remainedWidth-=u);var d=i.barMaxWidth;d&&(l[h].maxWidth=d);var c=i.barMinWidth;c&&(l[h].minWidth=c);var f=i.barGap;f!=null&&(a.gap=f);var g=i.barCategoryGap;g!=null&&(a.categoryGap=g)});var e={};return N(t,function(i,r){e[r]={};var o=i.stacks,s=i.bandWidth,a=i.categoryGap;if(a==null){var l=yi(o).length;a=Math.max(35-l*4,15)+"%"}var h=Jt(a,s),u=Jt(i.gap,1),d=i.remainedWidth,c=i.autoWidthCount,f=(d-h)/(c+(c-1)*u);f=Math.max(f,0),N(o,function(m){var y=m.maxWidth,b=m.minWidth;if(m.width){var _=m.width;y&&(_=Math.min(_,y)),b&&(_=Math.max(_,b)),m.width=_,d-=_+u*_,c--}else{var _=f;y&&y<_&&(_=Math.min(y,d)),b&&b>_&&(_=b),_!==f&&(m.width=_,d-=_+u*_,c--)}}),f=(d-h)/(c+(c-1)*u),f=Math.max(f,0);var g=0,p;N(o,function(m,y){m.width||(m.width=f),p=m,g+=m.width*(1+u)}),p&&(g-=p.width*u);var v=-g/2;N(o,function(m,y){e[r][y]=e[r][y]||{bandWidth:s,offset:v,width:m.width},v+=m.width*(1+u)})}),e}function Uat(n,t,e){if(n&&t){var i=n[mL(t)];return i}}function Xat(n,t){var e=s7(n,t),i=a7(e);N(e,function(r){var o=r.getData(),s=r.coordinateSystem,a=s.getBaseAxis(),l=o7(r),h=i[mL(a)][l],u=h.offset,d=h.width;o.setLayout({bandWidth:h.bandWidth,offset:u,size:d})})}function Yat(n){return{seriesType:n,plan:sL(),reset:function(t){if(l7(t)){var e=t.getData(),i=t.coordinateSystem,r=i.getBaseAxis(),o=i.getOtherAxis(r),s=e.getDimensionIndex(e.mapDimension(o.dim)),a=e.getDimensionIndex(e.mapDimension(r.dim)),l=t.get("showBackground",!0),h=e.mapDimension(o.dim),u=e.getCalculationInfo("stackResultDimension"),d=oc(e,h)&&!!e.getCalculationInfo("stackedOnSeries"),c=o.isHorizontal(),f=Kat(r,o),g=h7(t),p=t.get("barMinHeight")||0,v=u&&e.getDimensionIndex(u),m=e.getLayout("size"),y=e.getLayout("offset");return{progress:function(b,_){for(var w=b.count,C=g&&Ml(w*3),x=g&&l&&Ml(w*3),S=g&&Ml(w),A=i.master.getRect(),T=c?A.width:A.height,M,R=_.getStore(),E=0;(M=b.next())!=null;){var P=R.get(d?v:s,M),B=R.get(a,M),k=f,L=void 0;d&&(L=+P-R.get(s,M));var O=void 0,D=void 0,I=void 0,H=void 0;if(c){var F=i.dataToPoint([P,B]);if(d){var G=i.dataToPoint([L,B]);k=G[0]}O=k,D=F[1]+y,I=F[0]-k,H=m,Math.abs(I)<p&&(I=(I<0?-1:1)*p)}else{var F=i.dataToPoint([B,P]);if(d){var G=i.dataToPoint([B,L]);k=G[1]}O=F[0]+y,D=k,I=m,H=F[1]-k,Math.abs(H)<p&&(H=(H<=0?-1:1)*p)}g?(C[E]=O,C[E+1]=D,C[E+2]=c?I:H,x&&(x[E]=c?A.x:O,x[E+1]=c?D:A.y,x[E+2]=T),S[M]=M):_.setItemLayout(M,{x:O,y:D,width:I,height:H}),E+=3}g&&_.setLayout({largePoints:C,largeDataIndices:S,largeBackgroundPoints:x,valueAxisHorizontal:c})}}}}}}function l7(n){return n.coordinateSystem&&n.coordinateSystem.type==="cartesian2d"}function h7(n){return n.pipelineContext&&n.pipelineContext.large}function Kat(n,t){var e=t.model.get("startValue");return e||(e=0),t.toGlobalCoord(t.dataToCoord(t.type==="log"?e>0?e:1:e))}var qat=function(n,t,e,i){for(;e<i;){var r=e+i>>>1;n[r][1]<t?e=r+1:i=r}return e},u7=function(n){ct(t,n);function t(e){var i=n.call(this,e)||this;return i.type="time",i}return t.prototype.getLabel=function(e){var i=this.getSetting("useUTC");return mS(e.value,yH[brt(Vf(this._minLevelUnit))]||yH.second,i,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(e,i,r){var o=this.getSetting("useUTC"),s=this.getSetting("locale");return _rt(e,i,r,s,o)},t.prototype.getTicks=function(){var e=this._interval,i=this._extent,r=[];if(!e)return r;r.push({value:i[0],level:0});var o=this.getSetting("useUTC"),s=nlt(this._minLevelUnit,this._approxInterval,o,i);return r=r.concat(s),r.push({value:i[1],level:0}),r},t.prototype.calcNiceExtent=function(e){var i=this._extent;if(i[0]===i[1]&&(i[0]-=ts,i[1]+=ts),i[1]===-1/0&&i[0]===1/0){var r=new Date;i[1]=+new Date(r.getFullYear(),r.getMonth(),r.getDate()),i[0]=i[1]-ts}this.calcNiceTicks(e.splitNumber,e.minInterval,e.maxInterval)},t.prototype.calcNiceTicks=function(e,i,r){e=e||10;var o=this._extent,s=o[1]-o[0];this._approxInterval=s/e,i!=null&&this._approxInterval<i&&(this._approxInterval=i),r!=null&&this._approxInterval>r&&(this._approxInterval=r);var a=_b.length,l=Math.min(qat(_b,this._approxInterval,0,a),a-1);this._interval=_b[l][1],this._minLevelUnit=_b[Math.max(l-1,0)][0]},t.prototype.parse=function(e){return di(e)?e:+Wl(e)},t.prototype.contain=function(e){return TS(this.parse(e),this._extent)},t.prototype.normalize=function(e){return MS(this.parse(e),this._extent)},t.prototype.scale=function(e){return RS(e,this._extent)},t.type="time",t}(vp),_b=[["second",KE],["minute",qE],["hour",u0],["quarter-day",u0*6],["half-day",u0*12],["day",ts*1.2],["half-week",ts*3.5],["week",ts*7],["month",ts*31],["quarter",ts*95],["half-year",mH/2],["year",mH]];function Zat(n,t,e,i){var r=Wl(t),o=Wl(e),s=function(g){return bH(r,g,i)===bH(o,g,i)},a=function(){return s("year")},l=function(){return a()&&s("month")},h=function(){return l()&&s("day")},u=function(){return h()&&s("hour")},d=function(){return u()&&s("minute")},c=function(){return d()&&s("second")},f=function(){return c()&&s("millisecond")};switch(n){case"year":return a();case"month":return l();case"day":return h();case"hour":return u();case"minute":return d();case"second":return c();case"millisecond":return f()}}function Jat(n,t){return n/=ts,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}function Qat(n){var t=30*ts;return n/=t,n>6?6:n>3?3:n>2?2:1}function tlt(n){return n/=u0,n>12?12:n>6?6:n>3.5?4:n>2?2:1}function MF(n,t){return n/=t?qE:KE,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}function elt(n){return W8(n)}function ilt(n,t,e){var i=new Date(n);switch(Vf(t)){case"year":case"month":i[F9(e)](0);case"day":i[z9(e)](1);case"hour":i[N9(e)](0);case"minute":i[W9(e)](0);case"second":i[V9(e)](0),i[G9(e)](0)}return i.getTime()}function nlt(n,t,e,i){var r=1e4,o=I9,s=0;function a(T,M,R,E,P,B,k){for(var L=new Date(M),O=M,D=L[E]();O<R&&O<=i[1];)k.push({value:O}),D+=T,L[P](D),O=L.getTime();k.push({value:O,notAdd:!0})}function l(T,M,R){var E=[],P=!M.length;if(!Zat(Vf(T),i[0],i[1],e)){P&&(M=[{value:ilt(new Date(i[0]),T,e)},{value:i[1]}]);for(var B=0;B<M.length-1;B++){var k=M[B].value,L=M[B+1].value;if(k!==L){var O=void 0,D=void 0,I=void 0,H=!1;switch(T){case"year":O=Math.max(1,Math.round(t/ts/365)),D=ZE(e),I=Crt(e);break;case"half-year":case"quarter":case"month":O=Qat(t),D=Gf(e),I=F9(e);break;case"week":case"half-week":case"day":O=Jat(t),D=yS(e),I=z9(e),H=!0;break;case"half-day":case"quarter-day":case"hour":O=tlt(t),D=q0(e),I=N9(e);break;case"minute":O=MF(t,!0),D=bS(e),I=W9(e);break;case"second":O=MF(t,!1),D=_S(e),I=V9(e);break;case"millisecond":O=elt(t),D=CS(e),I=G9(e);break}a(O,k,L,D,I,H,E),T==="year"&&R.length>1&&B===0&&R.unshift({value:R[0].value-O})}}for(var B=0;B<E.length;B++)R.push(E[B]);return E}}for(var h=[],u=[],d=0,c=0,f=0;f<o.length&&s++<r;++f){var g=Vf(o[f]);if(yrt(o[f])){l(o[f],h[h.length-1]||[],u);var p=o[f+1]?Vf(o[f+1]):null;if(g!==p){if(u.length){c=d,u.sort(function(T,M){return T.value-M.value});for(var v=[],m=0;m<u.length;++m){var y=u[m].value;(m===0||u[m-1].value!==y)&&(v.push(u[m]),y>=i[0]&&y<=i[1]&&d++)}var b=(i[1]-i[0])/t;if(d>b*1.5&&c>b/1.5||(h.push(v),d>b||n===o[f]))break}u=[]}}}for(var _=Ti(St(h,function(T){return Ti(T,function(M){return M.value>=i[0]&&M.value<=i[1]&&!M.notAdd})}),function(T){return T.length>0}),w=[],C=_.length-1,f=0;f<_.length;++f)for(var x=_[f],S=0;S<x.length;++S)w.push({value:x[S].value,level:C-f});w.sort(function(T,M){return T.value-M.value});for(var A=[],f=0;f<w.length;++f)(f===0||w[f].value!==w[f-1].value)&&A.push(w[f]);return A}Xa.registerClass(u7);var RF=Xa.prototype,g0=vp.prototype,rlt=xn,olt=Math.floor,slt=Math.ceil,Cb=Math.pow,ws=Math.log,yL=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type="log",e.base=10,e._originalScale=new vp,e._interval=0,e}return t.prototype.getTicks=function(e){var i=this._originalScale,r=this._extent,o=i.getExtent(),s=g0.getTicks.call(this,e);return St(s,function(a){var l=a.value,h=xn(Cb(this.base,l));return h=l===r[0]&&this._fixMin?wb(h,o[0]):h,h=l===r[1]&&this._fixMax?wb(h,o[1]):h,{value:h}},this)},t.prototype.setExtent=function(e,i){var r=ws(this.base);e=ws(Math.max(0,e))/r,i=ws(Math.max(0,i))/r,g0.setExtent.call(this,e,i)},t.prototype.getExtent=function(){var e=this.base,i=RF.getExtent.call(this);i[0]=Cb(e,i[0]),i[1]=Cb(e,i[1]);var r=this._originalScale,o=r.getExtent();return this._fixMin&&(i[0]=wb(i[0],o[0])),this._fixMax&&(i[1]=wb(i[1],o[1])),i},t.prototype.unionExtent=function(e){this._originalScale.unionExtent(e);var i=this.base;e[0]=ws(e[0])/ws(i),e[1]=ws(e[1])/ws(i),RF.unionExtent.call(this,e)},t.prototype.unionExtentFromData=function(e,i){this.unionExtent(e.getApproximateExtent(i))},t.prototype.calcNiceTicks=function(e){e=e||10;var i=this._extent,r=i[1]-i[0];if(!(r===1/0||r<=0)){var o=Fet(r),s=e/r*o;for(s<=.5&&(o*=10);!isNaN(o)&&Math.abs(o)<1&&Math.abs(o)>0;)o*=10;var a=[xn(slt(i[0]/o)*o),xn(olt(i[1]/o)*o)];this._interval=o,this._niceExtent=a}},t.prototype.calcNiceExtent=function(e){g0.calcNiceExtent.call(this,e),this._fixMin=e.fixMin,this._fixMax=e.fixMax},t.prototype.parse=function(e){return e},t.prototype.contain=function(e){return e=ws(e)/ws(this.base),TS(e,this._extent)},t.prototype.normalize=function(e){return e=ws(e)/ws(this.base),MS(e,this._extent)},t.prototype.scale=function(e){return e=RS(e,this._extent),Cb(this.base,e)},t.type="log",t}(Xa),d7=yL.prototype;d7.getMinorTicks=g0.getMinorTicks;d7.getLabel=g0.getLabel;function wb(n,t){return rlt(n,Tl(t))}Xa.registerClass(yL);var alt=function(){function n(t,e,i){this._prepareParams(t,e,i)}return n.prototype._prepareParams=function(t,e,i){i[1]<i[0]&&(i=[NaN,NaN]),this._dataMin=i[0],this._dataMax=i[1];var r=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&e.getNeedCrossZero&&e.getNeedCrossZero();var o=e.get("min",!0);o==null&&(o=e.get("startValue",!0));var s=this._modelMinRaw=o;jt(s)?this._modelMinNum=xb(t,s({min:i[0],max:i[1]})):s!=="dataMin"&&(this._modelMinNum=xb(t,s));var a=this._modelMaxRaw=e.get("max",!0);if(jt(a)?this._modelMaxNum=xb(t,a({min:i[0],max:i[1]})):a!=="dataMax"&&(this._modelMaxNum=xb(t,a)),r)this._axisDataLen=e.getCategories().length;else{var l=e.get("boundaryGap"),h=_t(l)?l:[l||0,l||0];typeof h[0]=="boolean"||typeof h[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[Yh(h[0],1),Yh(h[1],1)]}},n.prototype.calculate=function(){var t=this._isOrdinal,e=this._dataMin,i=this._dataMax,r=this._axisDataLen,o=this._boundaryGapInner,s=t?null:i-e||Math.abs(e),a=this._modelMinRaw==="dataMin"?e:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?i:this._modelMaxNum,h=a!=null,u=l!=null;a==null&&(a=t?r?0:NaN:e-o[0]*s),l==null&&(l=t?r?r-1:NaN:i+o[1]*s),(a==null||!isFinite(a))&&(a=NaN),(l==null||!isFinite(l))&&(l=NaN);var d=RC(a)||RC(l)||t&&!r;this._needCrossZero&&(a>0&&l>0&&!h&&(a=0),a<0&&l<0&&!u&&(l=0));var c=this._determinedMin,f=this._determinedMax;return c!=null&&(a=c,h=!0),f!=null&&(l=f,u=!0),{min:a,max:l,minFixed:h,maxFixed:u,isBlank:d}},n.prototype.modifyDataMinMax=function(t,e){this[hlt[t]]=e},n.prototype.setDeterminedMinMax=function(t,e){var i=llt[t];this[i]=e},n.prototype.freeze=function(){this.frozen=!0},n}(),llt={min:"_determinedMin",max:"_determinedMax"},hlt={min:"_dataMin",max:"_dataMax"};function c7(n,t,e){var i=n.rawExtentInfo;return i||(i=new alt(n,t,e),n.rawExtentInfo=i,i)}function xb(n,t){return t==null?null:RC(t)?NaN:n.parse(t)}function f7(n,t){var e=n.type,i=c7(n,t,n.getExtent()).calculate();n.setBlank(i.isBlank);var r=i.min,o=i.max,s=t.ecModel;if(s&&e==="time"){var a=s7("bar",s),l=!1;if(N(a,function(d){l=l||d.getBaseAxis()===t.axis}),l){var h=a7(a),u=ult(r,o,t,h);r=u.min,o=u.max}}return{extent:[r,o],fixMin:i.minFixed,fixMax:i.maxFixed}}function ult(n,t,e,i){var r=e.axis.getExtent(),o=Math.abs(r[1]-r[0]),s=Uat(i,e.axis);if(s===void 0)return{min:n,max:t};var a=1/0;N(s,function(f){a=Math.min(f.offset,a)});var l=-1/0;N(s,function(f){l=Math.max(f.offset+f.width,l)}),a=Math.abs(a),l=Math.abs(l);var h=a+l,u=t-n,d=1-(a+l)/o,c=u/d-u;return t+=c*(l/h),n-=c*(a/h),{min:n,max:t}}function iw(n,t){var e=t,i=f7(n,e),r=i.extent,o=e.get("splitNumber");n instanceof yL&&(n.base=e.get("logBase"));var s=n.type,a=e.get("interval"),l=s==="interval"||s==="time";n.setExtent(r[0],r[1]),n.calcNiceExtent({splitNumber:o,fixMin:i.fixMin,fixMax:i.fixMax,minInterval:l?e.get("minInterval"):null,maxInterval:l?e.get("maxInterval"):null}),a!=null&&n.setInterval&&n.setInterval(a)}function g7(n,t){if(t=t||n.get("type"),t)switch(t){case"category":return new vL({ordinalMeta:n.getOrdinalMeta?n.getOrdinalMeta():n.getCategories(),extent:[1/0,-1/0]});case"time":return new u7({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new(Xa.getClass(t)||vp)}}function dlt(n){var t=n.scale.getExtent(),e=t[0],i=t[1];return!(e>0&&i>0||e<0&&i<0)}function mp(n){var t=n.getLabelModel().get("formatter"),e=n.type==="category"?n.scale.getExtent()[0]:null;return n.scale.type==="time"?function(i){return function(r,o){return n.scale.getFormattedLabel(r,o,i)}}(t):Pt(t)?function(i){return function(r){var o=n.scale.getLabel(r),s=i.replace("{value}",o??"");return s}}(t):jt(t)?function(i){return function(r,o){return e!=null&&(o=r.value-e),i(bL(n,r),o,r.level!=null?{level:r.level}:null)}}(t):function(i){return n.scale.getLabel(i)}}function bL(n,t){return n.type==="category"?n.scale.getLabel(t):t.value}function clt(n){var t=n.model,e=n.scale;if(!(!t.get(["axisLabel","show"])||e.isBlank())){var i,r,o=e.getExtent();e instanceof vL?r=e.count():(i=e.getTicks(),r=i.length);var s=n.getLabelModel(),a=mp(n),l,h=1;r>40&&(h=Math.ceil(r/40));for(var u=0;u<r;u+=h){var d=i?i[u]:{value:o[0]+u},c=a(d,u),f=s.getTextRect(c),g=flt(f,s.get("rotate")||0);l?l.union(g):l=g}return l}}function flt(n,t){var e=t*Math.PI/180,i=n.width,r=n.height,o=i*Math.abs(Math.cos(e))+Math.abs(r*Math.sin(e)),s=i*Math.abs(Math.sin(e))+Math.abs(r*Math.cos(e)),a=new Te(n.x,n.y,o,s);return a}function _L(n){var t=n.get("interval");return t??"auto"}function p7(n){return n.type==="category"&&_L(n.getLabelModel())===0}function nw(n,t){var e={};return N(n.mapDimensionsAll(t),function(i){e[Lat(n,i)]=!0}),yi(e)}function glt(n,t,e){t&&N(nw(t,e),function(i){var r=t.getApproximateExtent(i);r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1])})}var v7=function(){function n(){}return n.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},n.prototype.getCoordSysModel=function(){},n}(),BF=[],plt={registerPreprocessor:K$,registerProcessor:q$,registerPostInit:hat,registerPostUpdate:uat,registerUpdateLifecycle:dL,registerAction:Ua,registerCoordinateSystem:dat,registerLayout:cat,registerVisual:Mc,registerTransform:gat,registerLoading:Z$,registerMap:fat,registerImpl:$st,PRIORITY:nat,ComponentModel:$e,ComponentView:Zr,SeriesModel:Ao,ChartView:Ur,registerComponentModel:function(n){$e.registerClass(n)},registerComponentView:function(n){Zr.registerClass(n)},registerSeriesModel:function(n){Ao.registerClass(n)},registerChartView:function(n){Ur.registerClass(n)},registerSubTypeDefaulter:function(n,t){$e.registerSubTypeDefaulter(n,t)},registerPainter:function(n,t){Eet(n,t)}};function Xs(n){if(_t(n)){N(n,function(t){Xs(t)});return}_e(BF,n)>=0||(BF.push(n),jt(n)&&(n={install:n}),n.install(plt))}var em=Ke();function m7(n,t){var e=St(t,function(i){return n.scale.parse(i)});return n.type==="time"&&e.length>0&&(e.sort(),e.unshift(e[0]),e.push(e[e.length-1])),e}function vlt(n){var t=n.getLabelModel().get("customValues");if(t){var e=mp(n),i=n.scale.getExtent(),r=m7(n,t),o=Ti(r,function(s){return s>=i[0]&&s<=i[1]});return{labels:St(o,function(s){var a={value:s};return{formattedLabel:e(a),rawLabel:n.scale.getLabel(a),tickValue:s}})}}return n.type==="category"?ylt(n):_lt(n)}function mlt(n,t){var e=n.getTickModel().get("customValues");if(e){var i=n.scale.getExtent(),r=m7(n,e);return{ticks:Ti(r,function(o){return o>=i[0]&&o<=i[1]})}}return n.type==="category"?blt(n,t):{ticks:St(n.scale.getTicks(),function(o){return o.value})}}function ylt(n){var t=n.getLabelModel(),e=y7(n,t);return!t.get("show")||n.scale.isBlank()?{labels:[],labelCategoryInterval:e.labelCategoryInterval}:e}function y7(n,t){var e=b7(n,"labels"),i=_L(t),r=_7(e,i);if(r)return r;var o,s;return jt(i)?o=x7(n,i):(s=i==="auto"?Clt(n):i,o=w7(n,s)),C7(e,i,{labels:o,labelCategoryInterval:s})}function blt(n,t){var e=b7(n,"ticks"),i=_L(t),r=_7(e,i);if(r)return r;var o,s;if((!t.get("show")||n.scale.isBlank())&&(o=[]),jt(i))o=x7(n,i,!0);else if(i==="auto"){var a=y7(n,n.getLabelModel());s=a.labelCategoryInterval,o=St(a.labels,function(l){return l.tickValue})}else s=i,o=w7(n,s,!0);return C7(e,i,{ticks:o,tickCategoryInterval:s})}function _lt(n){var t=n.scale.getTicks(),e=mp(n);return{labels:St(t,function(i,r){return{level:i.level,formattedLabel:e(i,r),rawLabel:n.scale.getLabel(i),tickValue:i.value}})}}function b7(n,t){return em(n)[t]||(em(n)[t]=[])}function _7(n,t){for(var e=0;e<n.length;e++)if(n[e].key===t)return n[e].value}function C7(n,t,e){return n.push({key:t,value:e}),e}function Clt(n){var t=em(n).autoInterval;return t??(em(n).autoInterval=n.calculateCategoryInterval())}function wlt(n){var t=xlt(n),e=mp(n),i=(t.axisRotate-t.labelRotate)/180*Math.PI,r=n.scale,o=r.getExtent(),s=r.count();if(o[1]-o[0]<1)return 0;var a=1;s>40&&(a=Math.max(1,Math.floor(s/40)));for(var l=o[0],h=n.dataToCoord(l+1)-n.dataToCoord(l),u=Math.abs(h*Math.cos(i)),d=Math.abs(h*Math.sin(i)),c=0,f=0;l<=o[1];l+=a){var g=0,p=0,v=ry(e({value:l}),t.font,"center","top");g=v.width*1.3,p=v.height*1.3,c=Math.max(c,g,7),f=Math.max(f,p,7)}var m=c/u,y=f/d;isNaN(m)&&(m=1/0),isNaN(y)&&(y=1/0);var b=Math.max(0,Math.floor(Math.min(m,y))),_=em(n.model),w=n.getExtent(),C=_.lastAutoInterval,x=_.lastTickCount;return C!=null&&x!=null&&Math.abs(C-b)<=1&&Math.abs(x-s)<=1&&C>b&&_.axisExtent0===w[0]&&_.axisExtent1===w[1]?b=C:(_.lastTickCount=s,_.lastAutoInterval=b,_.axisExtent0=w[0],_.axisExtent1=w[1]),b}function xlt(n){var t=n.getLabelModel();return{axisRotate:n.getRotate?n.getRotate():n.isHorizontal&&!n.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function w7(n,t,e){var i=mp(n),r=n.scale,o=r.getExtent(),s=n.getLabelModel(),a=[],l=Math.max((t||0)+1,1),h=o[0],u=r.count();h!==0&&l>1&&u/l>2&&(h=Math.round(Math.ceil(h/l)*l));var d=p7(n),c=s.get("showMinLabel")||d,f=s.get("showMaxLabel")||d;c&&h!==o[0]&&p(o[0]);for(var g=h;g<=o[1];g+=l)p(g);f&&g-l!==o[1]&&p(o[1]);function p(v){var m={value:v};a.push(e?v:{formattedLabel:i(m),rawLabel:r.getLabel(m),tickValue:v})}return a}function x7(n,t,e){var i=n.scale,r=mp(n),o=[];return N(i.getTicks(),function(s){var a=i.getLabel(s),l=s.value;t(s.value,a)&&o.push(e?l:{formattedLabel:r(s),rawLabel:a,tickValue:l})}),o}var PF=[0,1],Rc=function(){function n(t,e,i){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=e,this._extent=i||[0,0]}return n.prototype.contain=function(t){var e=this._extent,i=Math.min(e[0],e[1]),r=Math.max(e[0],e[1]);return t>=i&&t<=r},n.prototype.containData=function(t){return this.scale.contain(t)},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.getPixelPrecision=function(t){return z8(t||this.scale.getExtent(),this._extent)},n.prototype.setExtent=function(t,e){var i=this._extent;i[0]=t,i[1]=e},n.prototype.dataToCoord=function(t,e){var i=this._extent,r=this.scale;return t=r.normalize(t),this.onBand&&r.type==="ordinal"&&(i=i.slice(),kF(i,r.count())),Ui(t,PF,i,e)},n.prototype.coordToData=function(t,e){var i=this._extent,r=this.scale;this.onBand&&r.type==="ordinal"&&(i=i.slice(),kF(i,r.count()));var o=Ui(t,i,PF,e);return this.scale.scale(o)},n.prototype.pointToData=function(t,e){},n.prototype.getTicksCoords=function(t){t=t||{};var e=t.tickModel||this.getTickModel(),i=mlt(this,e),r=i.ticks,o=St(r,function(a){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(a):a),tickValue:a}},this),s=e.get("alignWithLabel");return Slt(this,o,s,t.clamp),o},n.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),e=t.get("splitNumber");e>0&&e<100||(e=5);var i=this.scale.getMinorTicks(e),r=St(i,function(o){return St(o,function(s){return{coord:this.dataToCoord(s),tickValue:s}},this)},this);return r},n.prototype.getViewLabels=function(){return vlt(this).labels},n.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},n.prototype.getTickModel=function(){return this.model.getModel("axisTick")},n.prototype.getBandWidth=function(){var t=this._extent,e=this.scale.getExtent(),i=e[1]-e[0]+(this.onBand?1:0);i===0&&(i=1);var r=Math.abs(t[1]-t[0]);return Math.abs(r)/i},n.prototype.calculateCategoryInterval=function(){return wlt(this)},n}();function kF(n,t){var e=n[1]-n[0],i=t,r=e/i/2;n[0]+=r,n[1]-=r}function Slt(n,t,e,i){var r=t.length;if(!n.onBand||e||!r)return;var o=n.getExtent(),s,a;if(r===1)t[0].coord=o[0],s=t[1]={coord:o[1],tickValue:t[0].tickValue};else{var l=t[r-1].tickValue-t[0].tickValue,h=(t[r-1].coord-t[0].coord)/l;N(t,function(f){f.coord-=h/2});var u=n.scale.getExtent();a=1+u[1]-t[r-1].tickValue,s={coord:t[r-1].coord+h*a,tickValue:u[1]+1},t.push(s)}var d=o[0]>o[1];c(t[0].coord,o[0])&&(i?t[0].coord=o[0]:t.shift()),i&&c(o[0],t[0].coord)&&t.unshift({coord:o[0]}),c(o[1],s.coord)&&(i?s.coord=o[1]:t.pop()),i&&c(s.coord,o[1])&&t.push({coord:o[1]});function c(f,g){return f=xn(f),g=xn(g),d?f>g:f<g}}var iv=Math.PI*2,Wu=Vl.CMD,Alt=["top","right","bottom","left"];function Tlt(n,t,e,i,r){var o=e.width,s=e.height;switch(n){case"top":i.set(e.x+o/2,e.y-t),r.set(0,-1);break;case"bottom":i.set(e.x+o/2,e.y+s+t),r.set(0,1);break;case"left":i.set(e.x-t,e.y+s/2),r.set(-1,0);break;case"right":i.set(e.x+o+t,e.y+s/2),r.set(1,0);break}}function Mlt(n,t,e,i,r,o,s,a,l){s-=n,a-=t;var h=Math.sqrt(s*s+a*a);s/=h,a/=h;var u=s*e+n,d=a*e+t;if(Math.abs(i-r)%iv<1e-4)return l[0]=u,l[1]=d,h-e;if(o){var c=i;i=po(r),r=po(c)}else i=po(i),r=po(r);i>r&&(r+=iv);var f=Math.atan2(a,s);if(f<0&&(f+=iv),f>=i&&f<=r||f+iv>=i&&f+iv<=r)return l[0]=u,l[1]=d,h-e;var g=e*Math.cos(i)+n,p=e*Math.sin(i)+t,v=e*Math.cos(r)+n,m=e*Math.sin(r)+t,y=(g-s)*(g-s)+(p-a)*(p-a),b=(v-s)*(v-s)+(m-a)*(m-a);return y<b?(l[0]=g,l[1]=p,Math.sqrt(y)):(l[0]=v,l[1]=m,Math.sqrt(b))}function rw(n,t,e,i,r,o,s,a){var l=r-n,h=o-t,u=e-n,d=i-t,c=Math.sqrt(u*u+d*d);u/=c,d/=c;var f=l*u+h*d,g=f/c;a&&(g=Math.min(Math.max(g,0),1)),g*=c;var p=s[0]=n+g*u,v=s[1]=t+g*d;return Math.sqrt((p-r)*(p-r)+(v-o)*(v-o))}function S7(n,t,e,i,r,o,s){e<0&&(n=n+e,e=-e),i<0&&(t=t+i,i=-i);var a=n+e,l=t+i,h=s[0]=Math.min(Math.max(r,n),a),u=s[1]=Math.min(Math.max(o,t),l);return Math.sqrt((h-r)*(h-r)+(u-o)*(u-o))}var Es=[];function Rlt(n,t,e){var i=S7(t.x,t.y,t.width,t.height,n.x,n.y,Es);return e.set(Es[0],Es[1]),i}function Blt(n,t,e){for(var i=0,r=0,o=0,s=0,a,l,h=1/0,u=t.data,d=n.x,c=n.y,f=0;f<u.length;){var g=u[f++];f===1&&(i=u[f],r=u[f+1],o=i,s=r);var p=h;switch(g){case Wu.M:o=u[f++],s=u[f++],i=o,r=s;break;case Wu.L:p=rw(i,r,u[f],u[f+1],d,c,Es,!0),i=u[f++],r=u[f++];break;case Wu.C:p=T8(i,r,u[f++],u[f++],u[f++],u[f++],u[f],u[f+1],d,c,Es),i=u[f++],r=u[f++];break;case Wu.Q:p=R8(i,r,u[f++],u[f++],u[f],u[f+1],d,c,Es),i=u[f++],r=u[f++];break;case Wu.A:var v=u[f++],m=u[f++],y=u[f++],b=u[f++],_=u[f++],w=u[f++];f+=1;var C=!!(1-u[f++]);a=Math.cos(_)*y+v,l=Math.sin(_)*b+m,f<=1&&(o=a,s=l);var x=(d-v)*b/y+v;p=Mlt(v,m,b,_,_+w,C,x,c,Es),i=Math.cos(_+w)*y+v,r=Math.sin(_+w)*b+m;break;case Wu.R:o=i=u[f++],s=r=u[f++];var S=u[f++],A=u[f++];p=S7(o,s,S,A,d,c,Es);break;case Wu.Z:p=rw(i,r,o,s,d,c,Es,!0),i=o,r=s;break}p<h&&(h=p,e.set(Es[0],Es[1]))}return h}var Ns=new Vt,ri=new Vt,Xi=new Vt,ka=new Vt,Sa=new Vt;function EF(n,t){if(n){var e=n.getTextGuideLine(),i=n.getTextContent();if(i&&e){var r=n.textGuideLineConfig||{},o=[[0,0],[0,0],[0,0]],s=r.candidates||Alt,a=i.getBoundingRect().clone();a.applyTransform(i.getComputedTransform());var l=1/0,h=r.anchor,u=n.getComputedTransform(),d=u&&tS([],u),c=t.get("length2")||0;h&&Xi.copy(h);for(var f=0;f<s.length;f++){var g=s[f];Tlt(g,0,a,Ns,ka),Vt.scaleAndAdd(ri,Ns,ka,c),ri.transform(d);var p=n.getBoundingRect(),v=h?h.distance(ri):n instanceof Ee?Blt(ri,n.path,Xi):Rlt(ri,p,Xi);v<l&&(l=v,ri.transform(u),Xi.transform(u),Xi.toArray(o[0]),ri.toArray(o[1]),Ns.toArray(o[2]))}A7(o,t.get("minTurnAngle")),e.setShape({points:o})}}}var ow=[],Ar=new Vt;function A7(n,t){if(t<=180&&t>0){t=t/180*Math.PI,Ns.fromArray(n[0]),ri.fromArray(n[1]),Xi.fromArray(n[2]),Vt.sub(ka,Ns,ri),Vt.sub(Sa,Xi,ri);var e=ka.len(),i=Sa.len();if(!(e<.001||i<.001)){ka.scale(1/e),Sa.scale(1/i);var r=ka.dot(Sa),o=Math.cos(t);if(o<r){var s=rw(ri.x,ri.y,Xi.x,Xi.y,Ns.x,Ns.y,ow,!1);Ar.fromArray(ow),Ar.scaleAndAdd(Sa,s/Math.tan(Math.PI-t));var a=Xi.x!==ri.x?(Ar.x-ri.x)/(Xi.x-ri.x):(Ar.y-ri.y)/(Xi.y-ri.y);if(isNaN(a))return;a<0?Vt.copy(Ar,ri):a>1&&Vt.copy(Ar,Xi),Ar.toArray(n[1])}}}}function Plt(n,t,e){if(e<=180&&e>0){e=e/180*Math.PI,Ns.fromArray(n[0]),ri.fromArray(n[1]),Xi.fromArray(n[2]),Vt.sub(ka,ri,Ns),Vt.sub(Sa,Xi,ri);var i=ka.len(),r=Sa.len();if(!(i<.001||r<.001)){ka.scale(1/i),Sa.scale(1/r);var o=ka.dot(t),s=Math.cos(e);if(o<s){var a=rw(ri.x,ri.y,Xi.x,Xi.y,Ns.x,Ns.y,ow,!1);Ar.fromArray(ow);var l=Math.PI/2,h=Math.acos(Sa.dot(t)),u=l+h-e;if(u>=l)Vt.copy(Ar,Xi);else{Ar.scaleAndAdd(Sa,a/Math.tan(Math.PI/2-u));var d=Xi.x!==ri.x?(Ar.x-ri.x)/(Xi.x-ri.x):(Ar.y-ri.y)/(Xi.y-ri.y);if(isNaN(d))return;d<0?Vt.copy(Ar,ri):d>1&&Vt.copy(Ar,Xi)}Ar.toArray(n[1])}}}}function AM(n,t,e,i){var r=e==="normal",o=r?n:n.ensureState(e);o.ignore=t;var s=i.get("smooth");s&&s===!0&&(s=.3),o.shape=o.shape||{},s>0&&(o.shape.smooth=s);var a=i.getModel("lineStyle").getLineStyle();r?n.useStyle(a):o.style=a}function klt(n,t){var e=t.smooth,i=t.points;if(i)if(n.moveTo(i[0][0],i[0][1]),e>0&&i.length>=3){var r=L2(i[0],i[1]),o=L2(i[1],i[2]);if(!r||!o){n.lineTo(i[1][0],i[1][1]),n.lineTo(i[2][0],i[2][1]);return}var s=Math.min(r,o)*e,a=W_([],i[1],i[0],s/r),l=W_([],i[1],i[2],s/o),h=W_([],a,l,.5);n.bezierCurveTo(a[0],a[1],a[0],a[1],h[0],h[1]),n.bezierCurveTo(l[0],l[1],l[0],l[1],i[2][0],i[2][1])}else for(var u=1;u<i.length;u++)n.lineTo(i[u][0],i[u][1])}function T7(n,t,e){var i=n.getTextGuideLine(),r=n.getTextContent();if(!r){i&&n.removeTextGuideLine();return}for(var o=t.normal,s=o.get("show"),a=r.ignore,l=0;l<X0.length;l++){var h=X0[l],u=t[h],d=h==="normal";if(u){var c=u.get("show"),f=d?a:ve(r.states[h]&&r.states[h].ignore,a);if(f||!ve(c,s)){var g=d?i:i&&i.states[h];g&&(g.ignore=!0),i&&AM(i,!0,h,u);continue}i||(i=new Tc,n.setTextGuideLine(i),!d&&(a||!s)&&AM(i,!0,"normal",t.normal),n.stateProxy&&(i.stateProxy=n.stateProxy)),AM(i,!1,h,u)}}if(i){Gt(i.style,e),i.style.fill=null;var p=o.get("showAbove"),v=n.textGuideLineConfig=n.textGuideLineConfig||{};v.showAbove=p||!1,i.buildPath=klt}}function M7(n,t){t=t||"labelLine";for(var e={normal:n.getModel(t)},i=0;i<wo.length;i++){var r=wo[i];e[r]=n.getModel([r,t])}return e}function R7(n){for(var t=[],e=0;e<n.length;e++){var i=n[e];if(!i.defaultAttr.ignore){var r=i.label,o=r.getComputedTransform(),s=r.getBoundingRect(),a=!o||o[1]<1e-5&&o[2]<1e-5,l=r.style.margin||0,h=s.clone();h.applyTransform(o),h.x-=l/2,h.y-=l/2,h.width+=l,h.height+=l;var u=a?new NC(s,o):null;t.push({label:r,labelLine:i.labelLine,rect:h,localRect:s,obb:u,priority:i.priority,defaultAttr:i.defaultAttr,layoutOption:i.computedLayoutOption,axisAligned:a,transform:o})}}return t}function B7(n,t,e,i,r,o){var s=n.length;if(s<2)return;n.sort(function(C,x){return C.rect[t]-x.rect[t]});for(var a=0,l,h=!1,u=0;u<s;u++){var d=n[u],c=d.rect;l=c[t]-a,l<0&&(c[t]-=l,d.label[t]-=l,h=!0),a=c[t]+c[e]}var f=n[0],g=n[s-1],p,v;m(),p<0&&_(-p,.8),v<0&&_(v,.8),m(),y(p,v,1),y(v,p,-1),m(),p<0&&w(-p),v<0&&w(v);function m(){p=f.rect[t]-i,v=r-g.rect[t]-g.rect[e]}function y(C,x,S){if(C<0){var A=Math.min(x,-C);if(A>0){b(A*S,0,s);var T=A+C;T<0&&_(-T*S,1)}else _(-C*S,1)}}function b(C,x,S){C!==0&&(h=!0);for(var A=x;A<S;A++){var T=n[A],M=T.rect;M[t]+=C,T.label[t]+=C}}function _(C,x){for(var S=[],A=0,T=1;T<s;T++){var M=n[T-1].rect,R=Math.max(n[T].rect[t]-M[t]-M[e],0);S.push(R),A+=R}if(A){var E=Math.min(Math.abs(C)/A,x);if(C>0)for(var T=0;T<s-1;T++){var P=S[T]*E;b(P,0,T+1)}else for(var T=s-1;T>0;T--){var P=S[T-1]*E;b(-P,T,s)}}}function w(C){var x=C<0?-1:1;C=Math.abs(C);for(var S=Math.ceil(C/(s-1)),A=0;A<s-1;A++)if(x>0?b(S,0,A+1):b(-S,s-A-1,s),C-=S,C<=0)return}return h}function Elt(n,t,e,i){return B7(n,"x","width",t,e)}function P7(n,t,e,i){return B7(n,"y","height",t,e)}function k7(n){var t=[];n.sort(function(p,v){return v.priority-p.priority});var e=new Te(0,0,0,0);function i(p){if(!p.ignore){var v=p.ensureState("emphasis");v.ignore==null&&(v.ignore=!1)}p.ignore=!0}for(var r=0;r<n.length;r++){var o=n[r],s=o.axisAligned,a=o.localRect,l=o.transform,h=o.label,u=o.labelLine;e.copy(o.rect),e.width-=.1,e.height-=.1,e.x+=.05,e.y+=.05;for(var d=o.obb,c=!1,f=0;f<t.length;f++){var g=t[f];if(e.intersect(g.rect)){if(s&&g.axisAligned){c=!0;break}if(g.obb||(g.obb=new NC(g.localRect,g.transform)),d||(d=new NC(a,l)),d.intersect(g.obb)){c=!0;break}}}c?(i(h),u&&i(u)):(h.attr("ignore",o.defaultAttr.ignore),u&&u.attr("ignore",o.defaultAttr.labelGuideIgnore),t.push(o))}}function Llt(n){if(n){for(var t=[],e=0;e<n.length;e++)t.push(n[e].slice());return t}}function Olt(n,t){var e=n.label,i=t&&t.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:e.style.align,verticalAlign:e.style.verticalAlign,labelLinePoints:Llt(i&&i.shape.points)}}var LF=["align","verticalAlign","width","height","fontSize"],Cr=new ny,TM=Ke(),Dlt=Ke();function Sb(n,t,e){for(var i=0;i<e.length;i++){var r=e[i];t[r]!=null&&(n[r]=t[r])}}var Ab=["x","y","rotation"],Ilt=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(t,e,i,r,o){var s=r.style,a=r.__hostTarget,l=a.textConfig||{},h=r.getComputedTransform(),u=r.getBoundingRect().plain();Te.applyTransform(u,u,h),h?Cr.setLocalTransform(h):(Cr.x=Cr.y=Cr.rotation=Cr.originX=Cr.originY=0,Cr.scaleX=Cr.scaleY=1),Cr.rotation=po(Cr.rotation);var d=r.__hostTarget,c;if(d){c=d.getBoundingRect().plain();var f=d.getComputedTransform();Te.applyTransform(c,c,f)}var g=c&&d.getTextGuideLine();this._labelList.push({label:r,labelLine:g,seriesModel:i,dataIndex:t,dataType:e,layoutOption:o,computedLayoutOption:null,rect:u,hostRect:c,priority:c?c.width*c.height:0,defaultAttr:{ignore:r.ignore,labelGuideIgnore:g&&g.ignore,x:Cr.x,y:Cr.y,scaleX:Cr.scaleX,scaleY:Cr.scaleY,rotation:Cr.rotation,style:{x:s.x,y:s.y,align:s.align,verticalAlign:s.verticalAlign,width:s.width,height:s.height,fontSize:s.fontSize},cursor:r.cursor,attachedPos:l.position,attachedRot:l.rotation}})},n.prototype.addLabelsOfSeries=function(t){var e=this;this._chartViewList.push(t);var i=t.__model,r=i.get("labelLayout");(jt(r)||yi(r).length)&&t.group.traverse(function(o){if(o.ignore)return!0;var s=o.getTextContent(),a=pe(o);s&&!s.disableLabelLayout&&e._addLabel(a.dataIndex,a.dataType,i,s,r)})},n.prototype.updateLayoutConfig=function(t){var e=t.getWidth(),i=t.getHeight();function r(b,_){return function(){EF(b,_)}}for(var o=0;o<this._labelList.length;o++){var s=this._labelList[o],a=s.label,l=a.__hostTarget,h=s.defaultAttr,u=void 0;jt(s.layoutOption)?u=s.layoutOption(Olt(s,l)):u=s.layoutOption,u=u||{},s.computedLayoutOption=u;var d=Math.PI/180;l&&l.setTextConfig({local:!1,position:u.x!=null||u.y!=null?null:h.attachedPos,rotation:u.rotate!=null?u.rotate*d:h.attachedRot,offset:[u.dx||0,u.dy||0]});var c=!1;if(u.x!=null?(a.x=Jt(u.x,e),a.setStyle("x",0),c=!0):(a.x=h.x,a.setStyle("x",h.style.x)),u.y!=null?(a.y=Jt(u.y,i),a.setStyle("y",0),c=!0):(a.y=h.y,a.setStyle("y",h.style.y)),u.labelLinePoints){var f=l.getTextGuideLine();f&&(f.setShape({points:u.labelLinePoints}),c=!1)}var g=TM(a);g.needsUpdateLabelLine=c,a.rotation=u.rotate!=null?u.rotate*d:h.rotation,a.scaleX=h.scaleX,a.scaleY=h.scaleY;for(var p=0;p<LF.length;p++){var v=LF[p];a.setStyle(v,u[v]!=null?u[v]:h.style[v])}if(u.draggable){if(a.draggable=!0,a.cursor="move",l){var m=s.seriesModel;if(s.dataIndex!=null){var y=s.seriesModel.getData(s.dataType);m=y.getItemModel(s.dataIndex)}a.on("drag",r(l,m.getModel("labelLine")))}}else a.off("drag"),a.cursor=h.cursor}},n.prototype.layout=function(t){var e=t.getWidth(),i=t.getHeight(),r=R7(this._labelList),o=Ti(r,function(l){return l.layoutOption.moveOverlap==="shiftX"}),s=Ti(r,function(l){return l.layoutOption.moveOverlap==="shiftY"});Elt(o,0,e),P7(s,0,i);var a=Ti(r,function(l){return l.layoutOption.hideOverlap});k7(a)},n.prototype.processLabelsOverall=function(){var t=this;N(this._chartViewList,function(e){var i=e.__model,r=e.ignoreLabelLineUpdate,o=i.isAnimationEnabled();e.group.traverse(function(s){if(s.ignore&&!s.forceLabelAnimation)return!0;var a=!r,l=s.getTextContent();!a&&l&&(a=TM(l).needsUpdateLabelLine),a&&t._updateLabelLine(s,i),o&&t._animateLabels(s,i)})})},n.prototype._updateLabelLine=function(t,e){var i=t.getTextContent(),r=pe(t),o=r.dataIndex;if(i&&o!=null){var s=e.getData(r.dataType),a=s.getItemModel(o),l={},h=s.getItemVisual(o,"style");if(h){var u=s.getVisual("drawType");l.stroke=h[u]}var d=a.getModel("labelLine");T7(t,M7(a),l),EF(t,d)}},n.prototype._animateLabels=function(t,e){var i=t.getTextContent(),r=t.getTextGuideLine();if(i&&(t.forceLabelAnimation||!i.ignore&&!i.invisible&&!t.disableLabelAnimation&&!Nf(t))){var o=TM(i),s=o.oldLayout,a=pe(t),l=a.dataIndex,h={x:i.x,y:i.y,rotation:i.rotation},u=e.getData(a.dataType);if(s){i.attr(s);var c=t.prevStates;c&&(_e(c,"select")>=0&&i.attr(o.oldLayoutSelect),_e(c,"emphasis")>=0&&i.attr(o.oldLayoutEmphasis)),En(i,h,e,l)}else if(i.attr(h),!gp(i).valueAnimation){var d=ve(i.style.opacity,1);i.style.opacity=0,nr(i,{style:{opacity:d}},e,l)}if(o.oldLayout=h,i.states.select){var f=o.oldLayoutSelect={};Sb(f,h,Ab),Sb(f,i.states.select,Ab)}if(i.states.emphasis){var g=o.oldLayoutEmphasis={};Sb(g,h,Ab),Sb(g,i.states.emphasis,Ab)}nrt(i,l,u,e,e)}if(r&&!r.ignore&&!r.invisible){var o=Dlt(r),s=o.oldLayout,p={points:r.shape.points};s?(r.attr({shape:s}),En(r,{shape:p},e)):(r.setShape(p),r.style.strokePercent=0,nr(r,{style:{strokePercent:1}},e)),o.oldLayout=p}},n}(),MM=Ke();function g7t(n){n.registerUpdateLifecycle("series:beforeupdate",function(t,e,i){var r=MM(e).labelManager;r||(r=MM(e).labelManager=new Ilt),r.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(t,e,i){var r=MM(e).labelManager;i.updatedSeries.forEach(function(o){r.addLabelsOfSeries(e.getViewOfSeriesModel(o))}),r.updateLayoutConfig(e),r.layout(e),r.processLabelsOverall()})}var Hlt=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}($e),wB=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",Qn).models[0]},t.type="cartesian2dAxis",t}($e);ea(wB,v7);var E7={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},Flt=we({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},E7),CL=we({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},E7),zlt=we({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},CL),Nlt=Gt({logBase:10},CL);const Wlt={category:Flt,value:CL,time:zlt,log:Nlt};var Vlt={value:1,category:1,time:1,log:1};function sw(n,t,e,i){N(Vlt,function(r,o){var s=we(we({},Wlt[o],!0),i,!0),a=function(l){ct(h,l);function h(){var u=l!==null&&l.apply(this,arguments)||this;return u.type=t+"Axis."+o,u}return h.prototype.mergeDefaultAndTheme=function(u,d){var c=Z0(this),f=c?cy(u):{},g=d.getTheme();we(u,g.get(o+"Axis")),we(u,this.getDefaultOption()),u.type=OF(u),c&&wg(u,f,c)},h.prototype.optionUpdated=function(){var u=this.option;u.type==="category"&&(this.__ordinalMeta=_B.createByAxisModel(this))},h.prototype.getCategories=function(u){var d=this.option;if(d.type==="category")return u?d.data:this.__ordinalMeta.categories},h.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},h.type=t+"Axis."+o,h.defaultOption=s,h}(e);n.registerComponentModel(a)}),n.registerSubTypeDefaulter(t+"Axis",OF)}function OF(n){return n.type||(n.data?"category":"value")}var Glt=function(){function n(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return n.prototype.getAxis=function(t){return this._axes[t]},n.prototype.getAxes=function(){return St(this._dimList,function(t){return this._axes[t]},this)},n.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),Ti(this.getAxes(),function(e){return e.scale.type===t})},n.prototype.addAxis=function(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e)},n}(),xB=["x","y"];function DF(n){return n.type==="interval"||n.type==="time"}var $lt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type="cartesian2d",e.dimensions=xB,e}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var e=this.getAxis("x").scale,i=this.getAxis("y").scale;if(!(!DF(e)||!DF(i))){var r=e.getExtent(),o=i.getExtent(),s=this.dataToPoint([r[0],o[0]]),a=this.dataToPoint([r[1],o[1]]),l=r[1]-r[0],h=o[1]-o[0];if(!(!l||!h)){var u=(a[0]-s[0])/l,d=(a[1]-s[1])/h,c=s[0]-r[0]*u,f=s[1]-o[0]*d,g=this._transform=[u,0,0,d,c,f];this._invTransform=tS([],g)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(e){var i=this.getAxis("x"),r=this.getAxis("y");return i.contain(i.toLocalCoord(e[0]))&&r.contain(r.toLocalCoord(e[1]))},t.prototype.containData=function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])},t.prototype.containZone=function(e,i){var r=this.dataToPoint(e),o=this.dataToPoint(i),s=this.getArea(),a=new Te(r[0],r[1],o[0]-r[0],o[1]-r[1]);return s.intersect(a)},t.prototype.dataToPoint=function(e,i,r){r=r||[];var o=e[0],s=e[1];if(this._transform&&o!=null&&isFinite(o)&&s!=null&&isFinite(s))return hs(r,e,this._transform);var a=this.getAxis("x"),l=this.getAxis("y");return r[0]=a.toGlobalCoord(a.dataToCoord(o,i)),r[1]=l.toGlobalCoord(l.dataToCoord(s,i)),r},t.prototype.clampData=function(e,i){var r=this.getAxis("x").scale,o=this.getAxis("y").scale,s=r.getExtent(),a=o.getExtent(),l=r.parse(e[0]),h=o.parse(e[1]);return i=i||[],i[0]=Math.min(Math.max(Math.min(s[0],s[1]),l),Math.max(s[0],s[1])),i[1]=Math.min(Math.max(Math.min(a[0],a[1]),h),Math.max(a[0],a[1])),i},t.prototype.pointToData=function(e,i){var r=[];if(this._invTransform)return hs(r,e,this._invTransform);var o=this.getAxis("x"),s=this.getAxis("y");return r[0]=o.coordToData(o.toLocalCoord(e[0]),i),r[1]=s.coordToData(s.toLocalCoord(e[1]),i),r},t.prototype.getOtherAxis=function(e){return this.getAxis(e.dim==="x"?"y":"x")},t.prototype.getArea=function(e){e=e||0;var i=this.getAxis("x").getGlobalExtent(),r=this.getAxis("y").getGlobalExtent(),o=Math.min(i[0],i[1])-e,s=Math.min(r[0],r[1])-e,a=Math.max(i[0],i[1])-o+e,l=Math.max(r[0],r[1])-s+e;return new Te(o,s,a,l)},t}(Glt),jlt=function(n){ct(t,n);function t(e,i,r,o,s){var a=n.call(this,e,i,r)||this;return a.index=0,a.type=o||"value",a.position=s||"bottom",a}return t.prototype.isHorizontal=function(){var e=this.position;return e==="top"||e==="bottom"},t.prototype.getGlobalExtent=function(e){var i=this.getExtent();return i[0]=this.toGlobalCoord(i[0]),i[1]=this.toGlobalCoord(i[1]),e&&i[0]>i[1]&&i.reverse(),i},t.prototype.pointToData=function(e,i){return this.coordToData(this.toLocalCoord(e[this.dim==="x"?0:1]),i)},t.prototype.setCategorySortInfo=function(e){if(this.type!=="category")return!1;this.model.option.categorySortInfo=e,this.scale.setSortInfo(e)},t}(Rc);function SB(n,t,e){e=e||{};var i=n.coordinateSystem,r=t.axis,o={},s=r.getAxesOnZeroOf()[0],a=r.position,l=s?"onZero":a,h=r.dim,u=i.getRect(),d=[u.x,u.x+u.width,u.y,u.y+u.height],c={left:0,right:1,top:0,bottom:1,onZero:2},f=t.get("offset")||0,g=h==="x"?[d[2]-f,d[3]+f]:[d[0]-f,d[1]+f];if(s){var p=s.toGlobalCoord(s.dataToCoord(0));g[c.onZero]=Math.max(Math.min(p,g[1]),g[0])}o.position=[h==="y"?g[c[l]]:d[0],h==="x"?g[c[l]]:d[3]],o.rotation=Math.PI/2*(h==="x"?0:1);var v={top:-1,bottom:1,left:-1,right:1};o.labelDirection=o.tickDirection=o.nameDirection=v[a],o.labelOffset=s?g[c[a]]-g[c.onZero]:0,t.get(["axisTick","inside"])&&(o.tickDirection=-o.tickDirection),pg(e.labelInside,t.get(["axisLabel","inside"]))&&(o.labelDirection=-o.labelDirection);var m=t.get(["axisLabel","rotate"]);return o.labelRotate=l==="top"?-m:m,o.z2=1,o}function IF(n){return n.get("coordinateSystem")==="cartesian2d"}function HF(n){var t={xAxisModel:null,yAxisModel:null};return N(t,function(e,i){var r=i.replace(/Model$/,""),o=n.getReferringComponents(r,Qn).models[0];t[i]=o}),t}var RM=Math.log;function Ult(n,t,e){var i=vp.prototype,r=i.getTicks.call(e),o=i.getTicks.call(e,!0),s=r.length-1,a=i.getInterval.call(e),l=f7(n,t),h=l.extent,u=l.fixMin,d=l.fixMax;if(n.type==="log"){var c=RM(n.base);h=[RM(h[0])/c,RM(h[1])/c]}n.setExtent(h[0],h[1]),n.calcNiceExtent({splitNumber:s,fixMin:u,fixMax:d});var f=i.getExtent.call(n);u&&(h[0]=f[0]),d&&(h[1]=f[1]);var g=i.getInterval.call(n),p=h[0],v=h[1];if(u&&d)g=(v-p)/s;else if(u)for(v=h[0]+g*s;v<h[1]&&isFinite(v)&&isFinite(h[1]);)g=SM(g),v=h[0]+g*s;else if(d)for(p=h[1]-g*s;p>h[0]&&isFinite(p)&&isFinite(h[0]);)g=SM(g),p=h[1]-g*s;else{var m=n.getTicks().length-1;m>s&&(g=SM(g));var y=g*s;v=Math.ceil(h[1]/g)*g,p=xn(v-y),p<0&&h[0]>=0?(p=0,v=xn(y)):v>0&&h[1]<=0&&(v=0,p=-xn(y))}var b=(r[0].value-o[0].value)/a,_=(r[s].value-o[s].value)/a;i.setExtent.call(n,p+g*b,v+g*_),i.setInterval.call(n,g),(b||_)&&i.setNiceExtent.call(n,p+g,v-g)}var Xlt=function(){function n(t,e,i){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=xB,this._initCartesian(t,e,i),this.model=t}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(t,e){var i=this._axesMap;this._updateScale(t,this.model);function r(s){var a,l=yi(s),h=l.length;if(h){for(var u=[],d=h-1;d>=0;d--){var c=+l[d],f=s[c],g=f.model,p=f.scale;CB(p)&&g.get("alignTicks")&&g.get("interval")==null?u.push(f):(iw(p,g),CB(p)&&(a=f))}u.length&&(a||(a=u.pop(),iw(a.scale,a.model)),N(u,function(v){Ult(v.scale,v.model,a.scale)}))}}r(i.x),r(i.y);var o={};N(i.x,function(s){FF(i,"y",s,o)}),N(i.y,function(s){FF(i,"x",s,o)}),this.resize(this.model,e)},n.prototype.resize=function(t,e,i){var r=t.getBoxLayoutParams(),o=!i&&t.get("containLabel"),s=Na(r,{width:e.getWidth(),height:e.getHeight()});this._rect=s;var a=this._axesList;l(),o&&(N(a,function(h){if(!h.model.get(["axisLabel","inside"])){var u=clt(h);if(u){var d=h.isHorizontal()?"height":"width",c=h.model.get(["axisLabel","margin"]);s[d]-=u[d]+c,h.position==="top"?s.y+=u.height+c:h.position==="left"&&(s.x+=u.width+c)}}}),l()),N(this._coordsList,function(h){h.calcAffineTransform()});function l(){N(a,function(h){var u=h.isHorizontal(),d=u?[0,s.width]:[0,s.height],c=h.inverse?1:0;h.setExtent(d[c],d[1-c]),Ylt(h,u?s.x:s.y)})}},n.prototype.getAxis=function(t,e){var i=this._axesMap[t];if(i!=null)return i[e||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(t,e){if(t!=null&&e!=null){var i="x"+t+"y"+e;return this._coordsMap[i]}Ht(t)&&(e=t.yAxisIndex,t=t.xAxisIndex);for(var r=0,o=this._coordsList;r<o.length;r++)if(o[r].getAxis("x").index===t||o[r].getAxis("y").index===e)return o[r]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(t,e,i){var r=this._findConvertTarget(e);return r.cartesian?r.cartesian.dataToPoint(i):r.axis?r.axis.toGlobalCoord(r.axis.dataToCoord(i)):null},n.prototype.convertFromPixel=function(t,e,i){var r=this._findConvertTarget(e);return r.cartesian?r.cartesian.pointToData(i):r.axis?r.axis.coordToData(r.axis.toLocalCoord(i)):null},n.prototype._findConvertTarget=function(t){var e=t.seriesModel,i=t.xAxisModel||e&&e.getReferringComponents("xAxis",Qn).models[0],r=t.yAxisModel||e&&e.getReferringComponents("yAxis",Qn).models[0],o=t.gridModel,s=this._coordsList,a,l;if(e)a=e.coordinateSystem,_e(s,a)<0&&(a=null);else if(i&&r)a=this.getCartesian(i.componentIndex,r.componentIndex);else if(i)l=this.getAxis("x",i.componentIndex);else if(r)l=this.getAxis("y",r.componentIndex);else if(o){var h=o.coordinateSystem;h===this&&(a=this._coordsList[0])}return{cartesian:a,axis:l}},n.prototype.containPoint=function(t){var e=this._coordsList[0];if(e)return e.containPoint(t)},n.prototype._initCartesian=function(t,e,i){var r=this,o=this,s={left:!1,right:!1,top:!1,bottom:!1},a={x:{},y:{}},l={x:0,y:0};if(e.eachComponent("xAxis",h("x"),this),e.eachComponent("yAxis",h("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=a,N(a.x,function(u,d){N(a.y,function(c,f){var g="x"+d+"y"+f,p=new $lt(g);p.master=r,p.model=t,r._coordsMap[g]=p,r._coordsList.push(p),p.addAxis(u),p.addAxis(c)})});function h(u){return function(d,c){if(BM(d,t)){var f=d.get("position");u==="x"?f!=="top"&&f!=="bottom"&&(f=s.bottom?"top":"bottom"):f!=="left"&&f!=="right"&&(f=s.left?"right":"left"),s[f]=!0;var g=new jlt(u,g7(d),[0,0],d.get("type"),f),p=g.type==="category";g.onBand=p&&d.get("boundaryGap"),g.inverse=d.get("inverse"),d.axis=g,g.model=d,g.grid=o,g.index=c,o._axesList.push(g),a[u][c]=g,l[u]++}}}},n.prototype._updateScale=function(t,e){N(this._axesList,function(r){if(r.scale.setExtent(1/0,-1/0),r.type==="category"){var o=r.model.get("categorySortInfo");r.scale.setSortInfo(o)}}),t.eachSeries(function(r){if(IF(r)){var o=HF(r),s=o.xAxisModel,a=o.yAxisModel;if(!BM(s,e)||!BM(a,e))return;var l=this.getCartesian(s.componentIndex,a.componentIndex),h=r.getData(),u=l.getAxis("x"),d=l.getAxis("y");i(h,u),i(h,d)}},this);function i(r,o){N(nw(r,o.dim),function(s){o.scale.unionExtentFromData(r,s)})}},n.prototype.getTooltipAxes=function(t){var e=[],i=[];return N(this.getCartesians(),function(r){var o=t!=null&&t!=="auto"?r.getAxis(t):r.getBaseAxis(),s=r.getOtherAxis(o);_e(e,o)<0&&e.push(o),_e(i,s)<0&&i.push(s)}),{baseAxes:e,otherAxes:i}},n.create=function(t,e){var i=[];return t.eachComponent("grid",function(r,o){var s=new n(r,t,e);s.name="grid_"+o,s.resize(r,e,!0),r.coordinateSystem=s,i.push(s)}),t.eachSeries(function(r){if(IF(r)){var o=HF(r),s=o.xAxisModel,a=o.yAxisModel,l=s.getCoordSysModel(),h=l.coordinateSystem;r.coordinateSystem=h.getCartesian(s.componentIndex,a.componentIndex)}}),i},n.dimensions=xB,n}();function BM(n,t){return n.getCoordSysModel()===t}function FF(n,t,e,i){e.getAxesOnZeroOf=function(){return o?[o]:[]};var r=n[t],o,s=e.model,a=s.get(["axisLine","onZero"]),l=s.get(["axisLine","onZeroAxisIndex"]);if(!a)return;if(l!=null)zF(r[l])&&(o=r[l]);else for(var h in r)if(r.hasOwnProperty(h)&&zF(r[h])&&!i[u(r[h])]){o=r[h];break}o&&(i[u(o)]=!0);function u(d){return d.dim+"_"+d.index}}function zF(n){return n&&n.type!=="category"&&n.type!=="time"&&dlt(n)}function Ylt(n,t){var e=n.getExtent(),i=e[0]+e[1];n.toGlobalCoord=n.dim==="x"?function(r){return r+t}:function(r){return i-r+t},n.toLocalCoord=n.dim==="x"?function(r){return r-t}:function(r){return i-r+t}}var kh=Math.PI,ds=function(){function n(t,e){this.group=new bi,this.opt=e,this.axisModel=t,Gt(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var i=new bi({x:e.position[0],y:e.position[1],rotation:e.rotation});i.updateTransform(),this._transformGroup=i}return n.prototype.hasBuilder=function(t){return!!NF[t]},n.prototype.add=function(t){NF[t](this.opt,this.axisModel,this.group,this._transformGroup)},n.prototype.getGroup=function(){return this.group},n.innerTextLayout=function(t,e,i){var r=N8(e-t),o,s;return j0(r)?(s=i>0?"top":"bottom",o="center"):j0(r-kh)?(s=i>0?"bottom":"top",o="center"):(s="middle",r>0&&r<kh?o=i>0?"right":"left":o=i>0?"left":"right"),{rotation:r,textAlign:o,textVerticalAlign:s}},n.makeAxisEventDataBase=function(t){var e={componentType:t.mainType,componentIndex:t.componentIndex};return e[t.mainType+"Index"]=t.componentIndex,e},n.isLabelSilent=function(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show)},n}(),NF={axisLine:function(n,t,e,i){var r=t.get(["axisLine","show"]);if(r==="auto"&&n.handleAutoShown&&(r=n.handleAutoShown("axisLine")),!!r){var o=t.axis.getExtent(),s=i.transform,a=[o[0],0],l=[o[1],0],h=a[0]>l[0];s&&(hs(a,a,s),hs(l,l,s));var u=ft({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),d=new ns({shape:{x1:a[0],y1:a[1],x2:l[0],y2:l[1]},style:u,strokeContainThreshold:n.strokeContainThreshold||5,silent:!0,z2:1});K0(d.shape,d.style.lineWidth),d.anid="line",e.add(d);var c=t.get(["axisLine","symbol"]);if(c!=null){var f=t.get(["axisLine","symbolSize"]);Pt(c)&&(c=[c,c]),(Pt(f)||di(f))&&(f=[f,f]);var g=R$(t.get(["axisLine","symbolOffset"])||0,f),p=f[0],v=f[1];N([{rotate:n.rotation+Math.PI/2,offset:g[0],r:0},{rotate:n.rotation-Math.PI/2,offset:g[1],r:Math.sqrt((a[0]-l[0])*(a[0]-l[0])+(a[1]-l[1])*(a[1]-l[1]))}],function(m,y){if(c[y]!=="none"&&c[y]!=null){var b=Kh(c[y],-p/2,-v/2,p,v,u.stroke,!0),_=m.r+m.offset,w=h?l:a;b.attr({rotation:m.rotate,x:w[0]+_*Math.cos(n.rotation),y:w[1]-_*Math.sin(n.rotation),silent:!0,z2:11}),e.add(b)}})}}},axisTickLabel:function(n,t,e,i){var r=Zlt(e,i,t,n),o=Qlt(e,i,t,n);if(qlt(t,o,r),Jlt(e,i,t,n.tickDirection),t.get(["axisLabel","hideOverlap"])){var s=R7(St(o,function(a){return{label:a,priority:a.z2,defaultAttr:{ignore:a.ignore}}}));k7(s)}},axisName:function(n,t,e,i){var r=pg(n.axisName,t.get("name"));if(r){var o=t.get("nameLocation"),s=n.nameDirection,a=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,h=t.axis.getExtent(),u=h[0]>h[1]?-1:1,d=[o==="start"?h[0]-u*l:o==="end"?h[1]+u*l:(h[0]+h[1])/2,VF(o)?n.labelOffset+s*l:0],c,f=t.get("nameRotate");f!=null&&(f=f*kh/180);var g;VF(o)?c=ds.innerTextLayout(n.rotation,f??n.rotation,s):(c=Klt(n.rotation,o,f||0,h),g=n.axisNameAvailableWidth,g!=null&&(g=Math.abs(g/Math.sin(c.rotation)),!isFinite(g)&&(g=null)));var p=a.getFont(),v=t.get("nameTruncate",!0)||{},m=v.ellipsis,y=pg(n.nameTruncateMaxWidth,v.maxWidth,g),b=new Vi({x:d[0],y:d[1],rotation:c.rotation,silent:ds.isLabelSilent(t),style:So(a,{text:r,font:p,overflow:"truncate",width:y,ellipsis:m,fill:a.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:a.get("align")||c.textAlign,verticalAlign:a.get("verticalAlign")||c.textVerticalAlign}),z2:1});if(hy({el:b,componentModel:t,itemName:r}),b.__fullText=r,b.anid="name",t.get("triggerEvent")){var _=ds.makeAxisEventDataBase(t);_.targetType="axisName",_.name=r,pe(b).eventData=_}i.add(b),b.updateTransform(),e.add(b),b.decomposeTransform()}}};function Klt(n,t,e,i){var r=N8(e-n),o,s,a=i[0]>i[1],l=t==="start"&&!a||t!=="start"&&a;return j0(r-kh/2)?(s=l?"bottom":"top",o="center"):j0(r-kh*1.5)?(s=l?"top":"bottom",o="center"):(s="middle",r<kh*1.5&&r>kh/2?o=l?"left":"right":o=l?"right":"left"),{rotation:r,textAlign:o,textVerticalAlign:s}}function qlt(n,t,e){if(!p7(n.axis)){var i=n.get(["axisLabel","showMinLabel"]),r=n.get(["axisLabel","showMaxLabel"]);t=t||[],e=e||[];var o=t[0],s=t[1],a=t[t.length-1],l=t[t.length-2],h=e[0],u=e[1],d=e[e.length-1],c=e[e.length-2];i===!1?(ko(o),ko(h)):WF(o,s)&&(i?(ko(s),ko(u)):(ko(o),ko(h))),r===!1?(ko(a),ko(d)):WF(l,a)&&(r?(ko(l),ko(c)):(ko(a),ko(d)))}}function ko(n){n&&(n.ignore=!0)}function WF(n,t){var e=n&&n.getBoundingRect().clone(),i=t&&t.getBoundingRect().clone();if(!(!e||!i)){var r=RE([]);return Qx(r,r,-n.rotation),e.applyTransform(Ff([],r,n.getLocalTransform())),i.applyTransform(Ff([],r,t.getLocalTransform())),e.intersect(i)}}function VF(n){return n==="middle"||n==="center"}function L7(n,t,e,i,r){for(var o=[],s=[],a=[],l=0;l<n.length;l++){var h=n[l].coord;s[0]=h,s[1]=0,a[0]=h,a[1]=e,t&&(hs(s,s,t),hs(a,a,t));var u=new ns({shape:{x1:s[0],y1:s[1],x2:a[0],y2:a[1]},style:i,z2:2,autoBatch:!0,silent:!0});K0(u.shape,u.style.lineWidth),u.anid=r+"_"+n[l].tickValue,o.push(u)}return o}function Zlt(n,t,e,i){var r=e.axis,o=e.getModel("axisTick"),s=o.get("show");if(s==="auto"&&i.handleAutoShown&&(s=i.handleAutoShown("axisTick")),!(!s||r.scale.isBlank())){for(var a=o.getModel("lineStyle"),l=i.tickDirection*o.get("length"),h=r.getTicksCoords(),u=L7(h,t.transform,l,Gt(a.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}),"ticks"),d=0;d<u.length;d++)n.add(u[d]);return u}}function Jlt(n,t,e,i){var r=e.axis,o=e.getModel("minorTick");if(!(!o.get("show")||r.scale.isBlank())){var s=r.getMinorTicksCoords();if(s.length)for(var a=o.getModel("lineStyle"),l=i*o.get("length"),h=Gt(a.getLineStyle(),Gt(e.getModel("axisTick").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})),u=0;u<s.length;u++)for(var d=L7(s[u],t.transform,l,h,"minorticks_"+u),c=0;c<d.length;c++)n.add(d[c])}}function Qlt(n,t,e,i){var r=e.axis,o=pg(i.axisLabelShow,e.get(["axisLabel","show"]));if(!(!o||r.scale.isBlank())){var s=e.getModel("axisLabel"),a=s.get("margin"),l=r.getViewLabels(),h=(pg(i.labelRotate,s.get("rotate"))||0)*kh/180,u=ds.innerTextLayout(i.rotation,h,i.labelDirection),d=e.getCategories&&e.getCategories(!0),c=[],f=ds.isLabelSilent(e),g=e.get("triggerEvent");return N(l,function(p,v){var m=r.scale.type==="ordinal"?r.scale.getRawOrdinalNumber(p.tickValue):p.tickValue,y=p.formattedLabel,b=p.rawLabel,_=s;if(d&&d[m]){var w=d[m];Ht(w)&&w.textStyle&&(_=new ui(w.textStyle,s,e.ecModel))}var C=_.getTextColor()||e.get(["axisLine","lineStyle","color"]),x=r.dataToCoord(m),S=_.getShallow("align",!0)||u.textAlign,A=ve(_.getShallow("alignMinLabel",!0),S),T=ve(_.getShallow("alignMaxLabel",!0),S),M=_.getShallow("verticalAlign",!0)||_.getShallow("baseline",!0)||u.textVerticalAlign,R=ve(_.getShallow("verticalAlignMinLabel",!0),M),E=ve(_.getShallow("verticalAlignMaxLabel",!0),M),P=new Vi({x,y:i.labelOffset+i.labelDirection*a,rotation:u.rotation,silent:f,z2:10+(p.level||0),style:So(_,{text:y,align:v===0?A:v===l.length-1?T:S,verticalAlign:v===0?R:v===l.length-1?E:M,fill:jt(C)?C(r.type==="category"?b:r.type==="value"?m+"":m,v):C})});if(P.anid="label_"+m,hy({el:P,componentModel:e,itemName:y,formatterParamsExtra:{isTruncated:function(){return P.isTruncated},value:b,tickIndex:v}}),g){var B=ds.makeAxisEventDataBase(e);B.targetType="axisLabel",B.value=b,B.tickIndex=v,r.type==="category"&&(B.dataIndex=m),pe(P).eventData=B}t.add(P),P.updateTransform(),c.push(P),n.add(P),P.decomposeTransform()}),c}}function tht(n,t){var e={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return eht(e,n,t),e.seriesInvolved&&nht(e,n),e}function eht(n,t,e){var i=t.getComponent("tooltip"),r=t.getComponent("axisPointer"),o=r.get("link",!0)||[],s=[];N(e.getCoordinateSystems(),function(a){if(!a.axisPointerEnabled)return;var l=im(a.model),h=n.coordSysAxesInfo[l]={};n.coordSysMap[l]=a;var u=a.model,d=u.getModel("tooltip",i);if(N(a.getAxes(),he(p,!1,null)),a.getTooltipAxes&&i&&d.get("show")){var c=d.get("trigger")==="axis",f=d.get(["axisPointer","type"])==="cross",g=a.getTooltipAxes(d.get(["axisPointer","axis"]));(c||f)&&N(g.baseAxes,he(p,f?"cross":!0,c)),f&&N(g.otherAxes,he(p,"cross",!1))}function p(v,m,y){var b=y.model.getModel("axisPointer",r),_=b.get("show");if(!(!_||_==="auto"&&!v&&!AB(b))){m==null&&(m=b.get("triggerTooltip")),b=v?iht(y,d,r,t,v,m):b;var w=b.get("snap"),C=b.get("triggerEmphasis"),x=im(y.model),S=m||w||y.type==="category",A=n.axesInfo[x]={key:x,axis:y,coordSys:a,axisPointerModel:b,triggerTooltip:m,triggerEmphasis:C,involveSeries:S,snap:w,useHandle:AB(b),seriesModels:[],linkGroup:null};h[x]=A,n.seriesInvolved=n.seriesInvolved||S;var T=rht(o,y);if(T!=null){var M=s[T]||(s[T]={axesInfo:{}});M.axesInfo[x]=A,M.mapper=o[T].mapper,A.linkGroup=M}}}})}function iht(n,t,e,i,r,o){var s=t.getModel("axisPointer"),a=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};N(a,function(c){l[c]=ne(s.get(c))}),l.snap=n.type!=="category"&&!!o,s.get("type")==="cross"&&(l.type="line");var h=l.label||(l.label={});if(h.show==null&&(h.show=!1),r==="cross"){var u=s.get(["label","show"]);if(h.show=u??!0,!o){var d=l.lineStyle=s.get("crossStyle");d&&Gt(h,d.textStyle)}}return n.model.getModel("axisPointer",new ui(l,e,i))}function nht(n,t){t.eachSeries(function(e){var i=e.coordinateSystem,r=e.get(["tooltip","trigger"],!0),o=e.get(["tooltip","show"],!0);!i||r==="none"||r===!1||r==="item"||o===!1||e.get(["axisPointer","show"],!0)===!1||N(n.coordSysAxesInfo[im(i.model)],function(s){var a=s.axis;i.getAxis(a.dim)===a&&(s.seriesModels.push(e),s.seriesDataCount==null&&(s.seriesDataCount=0),s.seriesDataCount+=e.getData().count())})})}function rht(n,t){for(var e=t.model,i=t.dim,r=0;r<n.length;r++){var o=n[r]||{};if(PM(o[i+"AxisId"],e.id)||PM(o[i+"AxisIndex"],e.componentIndex)||PM(o[i+"AxisName"],e.name))return r}}function PM(n,t){return n==="all"||_t(n)&&_e(n,t)>=0||n===t}function oht(n){var t=wL(n);if(t){var e=t.axisPointerModel,i=t.axis.scale,r=e.option,o=e.get("status"),s=e.get("value");s!=null&&(s=i.parse(s));var a=AB(e);o==null&&(r.status=a?"show":"hide");var l=i.getExtent().slice();l[0]>l[1]&&l.reverse(),(s==null||s>l[1])&&(s=l[1]),s<l[0]&&(s=l[0]),r.value=s,a&&(r.status=t.axis.scale.isBlank()?"hide":"show")}}function wL(n){var t=(n.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[im(n)]}function sht(n){var t=wL(n);return t&&t.axisPointerModel}function AB(n){return!!n.get(["handle","show"])}function im(n){return n.type+"||"+n.id}var GF={},fy=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,i,r,o){this.axisPointerClass&&oht(e),n.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(e,r,!0)},t.prototype.updateAxisPointer=function(e,i,r,o){this._doUpdateAxisPointerClass(e,r,!1)},t.prototype.remove=function(e,i){var r=this._axisPointer;r&&r.remove(i)},t.prototype.dispose=function(e,i){this._disposeAxisPointer(i),n.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(e,i,r){var o=t.getAxisPointerClass(this.axisPointerClass);if(o){var s=sht(e);s?(this._axisPointer||(this._axisPointer=new o)).render(e,s,i,r):this._disposeAxisPointer(i)}},t.prototype._disposeAxisPointer=function(e){this._axisPointer&&this._axisPointer.dispose(e),this._axisPointer=null},t.registerAxisPointerClass=function(e,i){GF[e]=i},t.getAxisPointerClass=function(e){return e&&GF[e]},t.type="axis",t}(Zr),TB=Ke();function aht(n,t,e,i){var r=e.axis;if(!r.scale.isBlank()){var o=e.getModel("splitArea"),s=o.getModel("areaStyle"),a=s.get("color"),l=i.coordinateSystem.getRect(),h=r.getTicksCoords({tickModel:o,clamp:!0});if(h.length){var u=a.length,d=TB(n).splitAreaColors,c=$t(),f=0;if(d)for(var g=0;g<h.length;g++){var p=d.get(h[g].tickValue);if(p!=null){f=(p+(u-1)*g)%u;break}}var v=r.toGlobalCoord(h[0].coord),m=s.getAreaStyle();a=_t(a)?a:[a];for(var g=1;g<h.length;g++){var y=r.toGlobalCoord(h[g].coord),b=void 0,_=void 0,w=void 0,C=void 0;r.isHorizontal()?(b=v,_=l.y,w=y-b,C=l.height,v=b+w):(b=l.x,_=v,w=l.width,C=y-_,v=_+C);var x=h[g-1].tickValue;x!=null&&c.set(x,f),t.add(new ci({anid:x!=null?"area_"+x:null,shape:{x:b,y:_,width:w,height:C},style:Gt({fill:a[f]},m),autoBatch:!0,silent:!0})),f=(f+1)%u}TB(n).splitAreaColors=c}}}function lht(n){TB(n).splitAreaColors=null}var hht=["axisLine","axisTickLabel","axisName"],uht=["splitArea","splitLine","minorSplitLine"],O7=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.axisPointerClass="CartesianAxisPointer",e}return t.prototype.render=function(e,i,r,o){this.group.removeAll();var s=this._axisGroup;if(this._axisGroup=new bi,this.group.add(this._axisGroup),!!e.get("show")){var a=e.getCoordSysModel(),l=SB(a,e),h=new ds(e,ft({handleAutoShown:function(d){for(var c=a.coordinateSystem.getCartesians(),f=0;f<c.length;f++)if(CB(c[f].getOtherAxis(e.axis).scale))return!0;return!1}},l));N(hht,h.add,h),this._axisGroup.add(h.getGroup()),N(uht,function(d){e.get([d,"show"])&&dht[d](this,this._axisGroup,e,a)},this);var u=o&&o.type==="changeAxisOrder"&&o.isInitSort;u||jE(s,this._axisGroup,e),n.prototype.render.call(this,e,i,r,o)}},t.prototype.remove=function(){lht(this)},t.type="cartesianAxis",t}(fy),dht={splitLine:function(n,t,e,i){var r=e.axis;if(!r.scale.isBlank()){var o=e.getModel("splitLine"),s=o.getModel("lineStyle"),a=s.get("color"),l=o.get("showMinLine")!==!1,h=o.get("showMaxLine")!==!1;a=_t(a)?a:[a];for(var u=i.coordinateSystem.getRect(),d=r.isHorizontal(),c=0,f=r.getTicksCoords({tickModel:o}),g=[],p=[],v=s.getLineStyle(),m=0;m<f.length;m++){var y=r.toGlobalCoord(f[m].coord);if(!(m===0&&!l||m===f.length-1&&!h)){var b=f[m].tickValue;d?(g[0]=y,g[1]=u.y,p[0]=y,p[1]=u.y+u.height):(g[0]=u.x,g[1]=y,p[0]=u.x+u.width,p[1]=y);var _=c++%a.length,w=new ns({anid:b!=null?"line_"+b:null,autoBatch:!0,shape:{x1:g[0],y1:g[1],x2:p[0],y2:p[1]},style:Gt({stroke:a[_]},v),silent:!0});K0(w.shape,v.lineWidth),t.add(w)}}}},minorSplitLine:function(n,t,e,i){var r=e.axis,o=e.getModel("minorSplitLine"),s=o.getModel("lineStyle"),a=i.coordinateSystem.getRect(),l=r.isHorizontal(),h=r.getMinorTicksCoords();if(h.length)for(var u=[],d=[],c=s.getLineStyle(),f=0;f<h.length;f++)for(var g=0;g<h[f].length;g++){var p=r.toGlobalCoord(h[f][g].coord);l?(u[0]=p,u[1]=a.y,d[0]=p,d[1]=a.y+a.height):(u[0]=a.x,u[1]=p,d[0]=a.x+a.width,d[1]=p);var v=new ns({anid:"minor_line_"+h[f][g].tickValue,autoBatch:!0,shape:{x1:u[0],y1:u[1],x2:d[0],y2:d[1]},style:c,silent:!0});K0(v.shape,c.lineWidth),t.add(v)}},splitArea:function(n,t,e,i){aht(n,t,e,i)}},D7=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="xAxis",t}(O7),cht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=D7.type,e}return t.type="yAxis",t}(O7),fht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type="grid",e}return t.prototype.render=function(e,i){this.group.removeAll(),e.get("show")&&this.group.add(new ci({shape:e.coordinateSystem.getRect(),style:Gt({fill:e.get("backgroundColor")},e.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(Zr),$F={offset:0};function ght(n){n.registerComponentView(fht),n.registerComponentModel(Hlt),n.registerCoordinateSystem("cartesian2d",Xlt),sw(n,"x",wB,$F),sw(n,"y",wB,$F),n.registerComponentView(D7),n.registerComponentView(cht),n.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}var ud=Ke(),jF=ne,kM=zt,I7=function(){function n(){this._dragging=!1,this.animationThreshold=15}return n.prototype.render=function(t,e,i,r){var o=e.get("value"),s=e.get("status");if(this._axisModel=t,this._axisPointerModel=e,this._api=i,!(!r&&this._lastValue===o&&this._lastStatus===s)){this._lastValue=o,this._lastStatus=s;var a=this._group,l=this._handle;if(!s||s==="hide"){a&&a.hide(),l&&l.hide();return}a&&a.show(),l&&l.show();var h={};this.makeElOption(h,o,t,e,i);var u=h.graphicKey;u!==this._lastGraphicKey&&this.clear(i),this._lastGraphicKey=u;var d=this._moveAnimation=this.determineAnimation(t,e);if(!a)a=this._group=new bi,this.createPointerEl(a,h,t,e),this.createLabelEl(a,h,t,e),i.getZr().add(a);else{var c=he(UF,e,d);this.updatePointerEl(a,h,c),this.updateLabelEl(a,h,c,e)}YF(a,e,!0),this._renderHandle(o)}},n.prototype.remove=function(t){this.clear(t)},n.prototype.dispose=function(t){this.clear(t)},n.prototype.determineAnimation=function(t,e){var i=e.get("animation"),r=t.axis,o=r.type==="category",s=e.get("snap");if(!s&&!o)return!1;if(i==="auto"||i==null){var a=this.animationThreshold;if(o&&r.getBandWidth()>a)return!0;if(s){var l=wL(t).seriesDataCount,h=r.getExtent();return Math.abs(h[0]-h[1])/l>a}return!1}return i===!0},n.prototype.makeElOption=function(t,e,i,r,o){},n.prototype.createPointerEl=function(t,e,i,r){var o=e.pointer;if(o){var s=ud(t).pointerEl=new UE[o.type](jF(e.pointer));t.add(s)}},n.prototype.createLabelEl=function(t,e,i,r){if(e.label){var o=ud(t).labelEl=new Vi(jF(e.label));t.add(o),XF(o,r)}},n.prototype.updatePointerEl=function(t,e,i){var r=ud(t).pointerEl;r&&e.pointer&&(r.setStyle(e.pointer.style),i(r,{shape:e.pointer.shape}))},n.prototype.updateLabelEl=function(t,e,i,r){var o=ud(t).labelEl;o&&(o.setStyle(e.label.style),i(o,{x:e.label.x,y:e.label.y}),XF(o,r))},n.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var e=this._axisPointerModel,i=this._api.getZr(),r=this._handle,o=e.getModel("handle"),s=e.get("status");if(!o.get("show")||!s||s==="hide"){r&&i.remove(r),this._handle=null;return}var a;this._handle||(a=!0,r=this._handle=fS(o.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(h){vg(h.event)},onmousedown:kM(this._onHandleDragMove,this,0,0),drift:kM(this._onHandleDragMove,this),ondragend:kM(this._onHandleDragEnd,this)}),i.add(r)),YF(r,e,!1),r.setStyle(o.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=o.get("size");_t(l)||(l=[l,l]),r.scaleX=l[0]/2,r.scaleY=l[1]/2,SS(this,"_doDispatchAxisPointer",o.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,a)}},n.prototype._moveHandleToValue=function(t,e){UF(this._axisPointerModel,!e&&this._moveAnimation,this._handle,EM(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},n.prototype._onHandleDragMove=function(t,e){var i=this._handle;if(i){this._dragging=!0;var r=this.updateHandleTransform(EM(i),[t,e],this._axisModel,this._axisPointerModel);this._payloadInfo=r,i.stopAnimation(),i.attr(EM(r)),ud(i).lastProp=null,this._doDispatchAxisPointer()}},n.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var e=this._payloadInfo,i=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:e.cursorPoint[0],y:e.cursorPoint[1],tooltipOption:e.tooltipOption,axesInfo:[{axisDim:i.axis.dim,axisIndex:i.componentIndex}]})}},n.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var e=this._axisPointerModel.get("value");this._moveHandleToValue(e),this._api.dispatchAction({type:"hideTip"})}},n.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var e=t.getZr(),i=this._group,r=this._handle;e&&i&&(this._lastGraphicKey=null,i&&e.remove(i),r&&e.remove(r),this._group=null,this._handle=null,this._payloadInfo=null),YC(this,"_doDispatchAxisPointer")},n.prototype.doClear=function(){},n.prototype.buildLabel=function(t,e,i){return i=i||0,{x:t[i],y:t[1-i],width:e[i],height:e[1-i]}},n}();function UF(n,t,e,i){H7(ud(e).lastProp,i)||(ud(e).lastProp=i,t?En(e,i,n):(e.stopAnimation(),e.attr(i)))}function H7(n,t){if(Ht(n)&&Ht(t)){var e=!0;return N(t,function(i,r){e=e&&H7(n[r],i)}),!!e}else return n===t}function XF(n,t){n[t.get(["label","show"])?"show":"hide"]()}function EM(n){return{x:n.x||0,y:n.y||0,rotation:n.rotation||0}}function YF(n,t,e){var i=t.get("z"),r=t.get("zlevel");n&&n.traverse(function(o){o.type!=="group"&&(i!=null&&(o.z=i),r!=null&&(o.zlevel=r),o.silent=e)})}function F7(n){var t=n.get("type"),e=n.getModel(t+"Style"),i;return t==="line"?(i=e.getLineStyle(),i.fill=null):t==="shadow"&&(i=e.getAreaStyle(),i.stroke=null),i}function z7(n,t,e,i,r){var o=e.get("value"),s=N7(o,t.axis,t.ecModel,e.get("seriesDataIndices"),{precision:e.get(["label","precision"]),formatter:e.get(["label","formatter"])}),a=e.getModel("label"),l=dy(a.get("padding")||0),h=a.getFont(),u=ry(s,h),d=r.position,c=u.width+l[1]+l[3],f=u.height+l[0]+l[2],g=r.align;g==="right"&&(d[0]-=c),g==="center"&&(d[0]-=c/2);var p=r.verticalAlign;p==="bottom"&&(d[1]-=f),p==="middle"&&(d[1]-=f/2),pht(d,c,f,i);var v=a.get("backgroundColor");(!v||v==="auto")&&(v=t.get(["axisLine","lineStyle","color"])),n.label={x:d[0],y:d[1],style:So(a,{text:s,font:h,fill:a.getTextColor(),padding:l,backgroundColor:v}),z2:10}}function pht(n,t,e,i){var r=i.getWidth(),o=i.getHeight();n[0]=Math.min(n[0]+t,r)-t,n[1]=Math.min(n[1]+e,o)-e,n[0]=Math.max(n[0],0),n[1]=Math.max(n[1],0)}function N7(n,t,e,i,r){n=t.scale.parse(n);var o=t.scale.getLabel({value:n},{precision:r.precision}),s=r.formatter;if(s){var a={value:bL(t,{value:n}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};N(i,function(l){var h=e.getSeriesByIndex(l.seriesIndex),u=l.dataIndexInside,d=h&&h.getDataParams(u);d&&a.seriesData.push(d)}),Pt(s)?o=s.replace("{value}",o):jt(s)&&(o=s(a))}return o}function W7(n,t,e){var i=Nh();return Qx(i,i,e.rotation),mg(i,i,e.position),Cg([n.dataToCoord(t),(e.labelOffset||0)+(e.labelDirection||1)*(e.labelMargin||0)],i)}function vht(n,t,e,i,r,o){var s=ds.innerTextLayout(e.rotation,0,e.labelDirection);e.labelMargin=r.get(["label","margin"]),z7(t,i,r,o,{position:W7(i.axis,n,e),align:s.textAlign,verticalAlign:s.textVerticalAlign})}function V7(n,t,e){return e=e||0,{x1:n[e],y1:n[1-e],x2:t[e],y2:t[1-e]}}function mht(n,t,e){return e=e||0,{x:n[e],y:n[1-e],width:t[e],height:t[1-e]}}function KF(n,t,e,i,r,o){return{cx:n,cy:t,r0:e,r:i,startAngle:r,endAngle:o,clockwise:!0}}var yht=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.makeElOption=function(e,i,r,o,s){var a=r.axis,l=a.grid,h=o.get("type"),u=qF(l,a).getOtherAxis(a).getGlobalExtent(),d=a.toGlobalCoord(a.dataToCoord(i,!0));if(h&&h!=="none"){var c=F7(o),f=bht[h](a,d,u);f.style=c,e.graphicKey=f.type,e.pointer=f}var g=SB(l.model,r);vht(i,e,g,r,o,s)},t.prototype.getHandleTransform=function(e,i,r){var o=SB(i.axis.grid.model,i,{labelInside:!1});o.labelMargin=r.get(["handle","margin"]);var s=W7(i.axis,e,o);return{x:s[0],y:s[1],rotation:o.rotation+(o.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(e,i,r,o){var s=r.axis,a=s.grid,l=s.getGlobalExtent(!0),h=qF(a,s).getOtherAxis(s).getGlobalExtent(),u=s.dim==="x"?0:1,d=[e.x,e.y];d[u]+=i[u],d[u]=Math.min(l[1],d[u]),d[u]=Math.max(l[0],d[u]);var c=(h[1]+h[0])/2,f=[c,c];f[u]=d[u];var g=[{verticalAlign:"middle"},{align:"center"}];return{x:d[0],y:d[1],rotation:e.rotation,cursorPoint:f,tooltipOption:g[u]}},t}(I7);function qF(n,t){var e={};return e[t.dim+"AxisIndex"]=t.index,n.getCartesian(e)}var bht={line:function(n,t,e){var i=V7([t,e[0]],[t,e[1]],ZF(n));return{type:"Line",subPixelOptimize:!0,shape:i}},shadow:function(n,t,e){var i=Math.max(1,n.getBandWidth()),r=e[1]-e[0];return{type:"Rect",shape:mht([t-i/2,e[0]],[i,r],ZF(n))}}};function ZF(n){return n.dim==="x"?0:1}var _ht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}($e),Rl=Ke(),Cht=N;function G7(n,t,e){if(!ie.node){var i=t.getZr();Rl(i).records||(Rl(i).records={}),wht(i,t);var r=Rl(i).records[n]||(Rl(i).records[n]={});r.handler=e}}function wht(n,t){if(Rl(n).initialized)return;Rl(n).initialized=!0,e("click",he(JF,"click")),e("mousemove",he(JF,"mousemove")),e("globalout",Sht);function e(i,r){n.on(i,function(o){var s=Aht(t);Cht(Rl(n).records,function(a){a&&r(a,o,s.dispatchAction)}),xht(s.pendings,t)})}}function xht(n,t){var e=n.showTip.length,i=n.hideTip.length,r;e?r=n.showTip[e-1]:i&&(r=n.hideTip[i-1]),r&&(r.dispatchAction=null,t.dispatchAction(r))}function Sht(n,t,e){n.handler("leave",null,e)}function JF(n,t,e,i){t.handler(n,e,i)}function Aht(n){var t={showTip:[],hideTip:[]},e=function(i){var r=t[i.type];r?r.push(i):(i.dispatchAction=e,n.dispatchAction(i))};return{dispatchAction:e,pendings:t}}function MB(n,t){if(!ie.node){var e=t.getZr(),i=(Rl(e).records||{})[n];i&&(Rl(e).records[n]=null)}}var Tht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,i,r){var o=i.getComponent("tooltip"),s=e.get("triggerOn")||o&&o.get("triggerOn")||"mousemove|click";G7("axisPointer",r,function(a,l,h){s!=="none"&&(a==="leave"||s.indexOf(a)>=0)&&h({type:"updateAxisPointer",currTrigger:a,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(e,i){MB("axisPointer",i)},t.prototype.dispose=function(e,i){MB("axisPointer",i)},t.type="axisPointer",t}(Zr);function $7(n,t){var e=[],i=n.seriesIndex,r;if(i==null||!(r=t.getSeriesByIndex(i)))return{point:[]};var o=r.getData(),s=ec(o,n);if(s==null||s<0||_t(s))return{point:[]};var a=o.getItemGraphicEl(s),l=r.coordinateSystem;if(r.getTooltipPosition)e=r.getTooltipPosition(s)||[];else if(l&&l.dataToPoint)if(n.isStacked){var h=l.getBaseAxis(),u=l.getOtherAxis(h),d=u.dim,c=h.dim,f=d==="x"||d==="radius"?1:0,g=o.mapDimension(c),p=[];p[f]=o.get(g,s),p[1-f]=o.get(o.getCalculationInfo("stackResultDimension"),s),e=l.dataToPoint(p)||[]}else e=l.dataToPoint(o.getValues(St(l.dimensions,function(m){return o.mapDimension(m)}),s))||[];else if(a){var v=a.getBoundingRect().clone();v.applyTransform(a.transform),e=[v.x+v.width/2,v.y+v.height/2]}return{point:e,el:a}}var QF=Ke();function Mht(n,t,e){var i=n.currTrigger,r=[n.x,n.y],o=n,s=n.dispatchAction||zt(e.dispatchAction,e),a=t.getComponent("axisPointer").coordSysAxesInfo;if(a){eC(r)&&(r=$7({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},t).point);var l=eC(r),h=o.axesInfo,u=a.axesInfo,d=i==="leave"||eC(r),c={},f={},g={list:[],map:{}},p={showPointer:he(Bht,f),showTooltip:he(Pht,g)};N(a.coordSysMap,function(m,y){var b=l||m.containPoint(r);N(a.coordSysAxesInfo[y],function(_,w){var C=_.axis,x=Oht(h,_);if(!d&&b&&(!h||x)){var S=x&&x.value;S==null&&!l&&(S=C.pointToData(r)),S!=null&&tz(_,S,p,!1,c)}})});var v={};return N(u,function(m,y){var b=m.linkGroup;b&&!f[y]&&N(b.axesInfo,function(_,w){var C=f[w];if(_!==m&&C){var x=C.value;b.mapper&&(x=m.axis.scale.parse(b.mapper(x,ez(_),ez(m)))),v[m.key]=x}})}),N(v,function(m,y){tz(u[y],m,p,!0,c)}),kht(f,u,c),Eht(g,r,n,s),Lht(u,s,e),c}}function tz(n,t,e,i,r){var o=n.axis;if(!(o.scale.isBlank()||!o.containData(t))){if(!n.involveSeries){e.showPointer(n,t);return}var s=Rht(t,n),a=s.payloadBatch,l=s.snapToValue;a[0]&&r.seriesIndex==null&&ft(r,a[0]),!i&&n.snap&&o.containData(l)&&l!=null&&(t=l),e.showPointer(n,t,a),e.showTooltip(n,s,l)}}function Rht(n,t){var e=t.axis,i=e.dim,r=n,o=[],s=Number.MAX_VALUE,a=-1;return N(t.seriesModels,function(l,h){var u=l.getData().mapDimensionsAll(i),d,c;if(l.getAxisTooltipData){var f=l.getAxisTooltipData(u,n,e);c=f.dataIndices,d=f.nestestValue}else{if(c=l.getData().indicesOfNearest(u[0],n,e.type==="category"?.5:null),!c.length)return;d=l.getData().get(u[0],c[0])}if(!(d==null||!isFinite(d))){var g=n-d,p=Math.abs(g);p<=s&&((p<s||g>=0&&a<0)&&(s=p,a=g,r=d,o.length=0),N(c,function(v){o.push({seriesIndex:l.seriesIndex,dataIndexInside:v,dataIndex:l.getData().getRawIndex(v)})}))}}),{payloadBatch:o,snapToValue:r}}function Bht(n,t,e,i){n[t.key]={value:e,payloadBatch:i}}function Pht(n,t,e,i){var r=e.payloadBatch,o=t.axis,s=o.model,a=t.axisPointerModel;if(!(!t.triggerTooltip||!r.length)){var l=t.coordSys.model,h=im(l),u=n.map[h];u||(u=n.map[h]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},n.list.push(u)),u.dataByAxis.push({axisDim:o.dim,axisIndex:s.componentIndex,axisType:s.type,axisId:s.id,value:i,valueLabelOpt:{precision:a.get(["label","precision"]),formatter:a.get(["label","formatter"])},seriesDataIndices:r.slice()})}}function kht(n,t,e){var i=e.axesInfo=[];N(t,function(r,o){var s=r.axisPointerModel.option,a=n[o];a?(!r.useHandle&&(s.status="show"),s.value=a.value,s.seriesDataIndices=(a.payloadBatch||[]).slice()):!r.useHandle&&(s.status="hide"),s.status==="show"&&i.push({axisDim:r.axis.dim,axisIndex:r.axis.model.componentIndex,value:s.value})})}function Eht(n,t,e,i){if(eC(t)||!n.list.length){i({type:"hideTip"});return}var r=((n.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};i({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:e.tooltipOption,position:e.position,dataIndexInside:r.dataIndexInside,dataIndex:r.dataIndex,seriesIndex:r.seriesIndex,dataByCoordSys:n.list})}function Lht(n,t,e){var i=e.getZr(),r="axisPointerLastHighlights",o=QF(i)[r]||{},s=QF(i)[r]={};N(n,function(h,u){var d=h.axisPointerModel.option;d.status==="show"&&h.triggerEmphasis&&N(d.seriesDataIndices,function(c){var f=c.seriesIndex+" | "+c.dataIndex;s[f]=c})});var a=[],l=[];N(o,function(h,u){!s[u]&&l.push(h)}),N(s,function(h,u){!o[u]&&a.push(h)}),l.length&&e.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),a.length&&e.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:a})}function Oht(n,t){for(var e=0;e<(n||[]).length;e++){var i=n[e];if(t.axis.dim===i.axisDim&&t.axis.model.componentIndex===i.axisIndex)return i}}function ez(n){var t=n.axis.model,e={},i=e.axisDim=n.axis.dim;return e.axisIndex=e[i+"AxisIndex"]=t.componentIndex,e.axisName=e[i+"AxisName"]=t.name,e.axisId=e[i+"AxisId"]=t.id,e}function eC(n){return!n||n[0]==null||isNaN(n[0])||n[1]==null||isNaN(n[1])}function xL(n){fy.registerAxisPointerClass("CartesianAxisPointer",yht),n.registerComponentModel(_ht),n.registerComponentView(Tht),n.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var e=t.axisPointer.link;e&&!_t(e)&&(t.axisPointer.link=[e])}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,function(t,e){t.getComponent("axisPointer").coordSysAxesInfo=tht(t,e)}),n.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},Mht)}function p7t(n){Xs(ght),Xs(xL)}var Dht=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.makeElOption=function(e,i,r,o,s){var a=r.axis;a.dim==="angle"&&(this.animationThreshold=Math.PI/18);var l=a.polar,h=l.getOtherAxis(a),u=h.getExtent(),d=a.dataToCoord(i),c=o.get("type");if(c&&c!=="none"){var f=F7(o),g=Hht[c](a,l,d,u);g.style=f,e.graphicKey=g.type,e.pointer=g}var p=o.get(["label","margin"]),v=Iht(i,r,o,l,p);z7(e,r,o,s,v)},t}(I7);function Iht(n,t,e,i,r){var o=t.axis,s=o.dataToCoord(n),a=i.getAngleAxis().getExtent()[0];a=a/180*Math.PI;var l=i.getRadiusAxis().getExtent(),h,u,d;if(o.dim==="radius"){var c=Nh();Qx(c,c,a),mg(c,c,[i.cx,i.cy]),h=Cg([s,-r],c);var f=t.getModel("axisLabel").get("rotate")||0,g=ds.innerTextLayout(a,f*Math.PI/180,-1);u=g.textAlign,d=g.textVerticalAlign}else{var p=l[1];h=i.coordToPoint([p+r,s]);var v=i.cx,m=i.cy;u=Math.abs(h[0]-v)/p<.3?"center":h[0]>v?"left":"right",d=Math.abs(h[1]-m)/p<.3?"middle":h[1]>m?"top":"bottom"}return{position:h,align:u,verticalAlign:d}}var Hht={line:function(n,t,e,i){return n.dim==="angle"?{type:"Line",shape:V7(t.coordToPoint([i[0],e]),t.coordToPoint([i[1],e]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r:e}}},shadow:function(n,t,e,i){var r=Math.max(1,n.getBandWidth()),o=Math.PI/180;return n.dim==="angle"?{type:"Sector",shape:KF(t.cx,t.cy,i[0],i[1],(-e-r/2)*o,(-e+r/2)*o)}:{type:"Sector",shape:KF(t.cx,t.cy,e-r/2,e+r/2,0,Math.PI*2)}}},Fht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.findAxisModel=function(e){var i,r=this.ecModel;return r.eachComponent(e,function(o){o.getCoordSysModel()===this&&(i=o)},this),i},t.type="polar",t.dependencies=["radiusAxis","angleAxis"],t.defaultOption={z:0,center:["50%","50%"],radius:"80%"},t}($e),SL=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",Qn).models[0]},t.type="polarAxis",t}($e);ea(SL,v7);var zht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="angleAxis",t}(SL),Nht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="radiusAxis",t}(SL),AL=function(n){ct(t,n);function t(e,i){return n.call(this,"radius",e,i)||this}return t.prototype.pointToData=function(e,i){return this.polar.pointToData(e,i)[this.dim==="radius"?0:1]},t}(Rc);AL.prototype.dataToRadius=Rc.prototype.dataToCoord;AL.prototype.radiusToData=Rc.prototype.coordToData;var Wht=Ke(),TL=function(n){ct(t,n);function t(e,i){return n.call(this,"angle",e,i||[0,360])||this}return t.prototype.pointToData=function(e,i){return this.polar.pointToData(e,i)[this.dim==="radius"?0:1]},t.prototype.calculateCategoryInterval=function(){var e=this,i=e.getLabelModel(),r=e.scale,o=r.getExtent(),s=r.count();if(o[1]-o[0]<1)return 0;var a=o[0],l=e.dataToCoord(a+1)-e.dataToCoord(a),h=Math.abs(l),u=ry(a==null?"":a+"",i.getFont(),"center","top"),d=Math.max(u.height,7),c=d/h;isNaN(c)&&(c=1/0);var f=Math.max(0,Math.floor(c)),g=Wht(e.model),p=g.lastAutoInterval,v=g.lastTickCount;return p!=null&&v!=null&&Math.abs(p-f)<=1&&Math.abs(v-s)<=1&&p>f?f=p:(g.lastTickCount=s,g.lastAutoInterval=f),f},t}(Rc);TL.prototype.dataToAngle=Rc.prototype.dataToCoord;TL.prototype.angleToData=Rc.prototype.coordToData;var j7=["radius","angle"],Vht=function(){function n(t){this.dimensions=j7,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new AL,this._angleAxis=new TL,this.axisPointerEnabled=!0,this.name=t||"",this._radiusAxis.polar=this._angleAxis.polar=this}return n.prototype.containPoint=function(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1])},n.prototype.containData=function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},n.prototype.getAxis=function(t){var e="_"+t+"Axis";return this[e]},n.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},n.prototype.getAxesByScale=function(t){var e=[],i=this._angleAxis,r=this._radiusAxis;return i.scale.type===t&&e.push(i),r.scale.type===t&&e.push(r),e},n.prototype.getAngleAxis=function(){return this._angleAxis},n.prototype.getRadiusAxis=function(){return this._radiusAxis},n.prototype.getOtherAxis=function(t){var e=this._angleAxis;return t===e?this._radiusAxis:e},n.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},n.prototype.getTooltipAxes=function(t){var e=t!=null&&t!=="auto"?this.getAxis(t):this.getBaseAxis();return{baseAxes:[e],otherAxes:[this.getOtherAxis(e)]}},n.prototype.dataToPoint=function(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)])},n.prototype.pointToData=function(t,e){var i=this.pointToCoord(t);return[this._radiusAxis.radiusToData(i[0],e),this._angleAxis.angleToData(i[1],e)]},n.prototype.pointToCoord=function(t){var e=t[0]-this.cx,i=t[1]-this.cy,r=this.getAngleAxis(),o=r.getExtent(),s=Math.min(o[0],o[1]),a=Math.max(o[0],o[1]);r.inverse?s=a-360:a=s+360;var l=Math.sqrt(e*e+i*i);e/=l,i/=l;for(var h=Math.atan2(-i,e)/Math.PI*180,u=h<s?1:-1;h<s||h>a;)h+=u*360;return[l,h]},n.prototype.coordToPoint=function(t){var e=t[0],i=t[1]/180*Math.PI,r=Math.cos(i)*e+this.cx,o=-Math.sin(i)*e+this.cy;return[r,o]},n.prototype.getArea=function(){var t=this.getAngleAxis(),e=this.getRadiusAxis(),i=e.getExtent().slice();i[0]>i[1]&&i.reverse();var r=t.getExtent(),o=Math.PI/180,s=1e-4;return{cx:this.cx,cy:this.cy,r0:i[0],r:i[1],startAngle:-r[0]*o,endAngle:-r[1]*o,clockwise:t.inverse,contain:function(a,l){var h=a-this.cx,u=l-this.cy,d=h*h+u*u,c=this.r,f=this.r0;return c!==f&&d-s<=c*c&&d+s>=f*f}}},n.prototype.convertToPixel=function(t,e,i){var r=iz(e);return r===this?this.dataToPoint(i):null},n.prototype.convertFromPixel=function(t,e,i){var r=iz(e);return r===this?this.pointToData(i):null},n}();function iz(n){var t=n.seriesModel,e=n.polarModel;return e&&e.coordinateSystem||t&&t.coordinateSystem}function Ght(n,t,e){var i=t.get("center"),r=e.getWidth(),o=e.getHeight();n.cx=Jt(i[0],r),n.cy=Jt(i[1],o);var s=n.getRadiusAxis(),a=Math.min(r,o)/2,l=t.get("radius");l==null?l=[0,"100%"]:_t(l)||(l=[0,l]);var h=[Jt(l[0],a),Jt(l[1],a)];s.inverse?s.setExtent(h[1],h[0]):s.setExtent(h[0],h[1])}function $ht(n,t){var e=this,i=e.getAngleAxis(),r=e.getRadiusAxis();if(i.scale.setExtent(1/0,-1/0),r.scale.setExtent(1/0,-1/0),n.eachSeries(function(a){if(a.coordinateSystem===e){var l=a.getData();N(nw(l,"radius"),function(h){r.scale.unionExtentFromData(l,h)}),N(nw(l,"angle"),function(h){i.scale.unionExtentFromData(l,h)})}}),iw(i.scale,i.model),iw(r.scale,r.model),i.type==="category"&&!i.onBand){var o=i.getExtent(),s=360/i.scale.count();i.inverse?o[1]+=s:o[1]-=s,i.setExtent(o[0],o[1])}}function jht(n){return n.mainType==="angleAxis"}function nz(n,t){var e;if(n.type=t.get("type"),n.scale=g7(t),n.onBand=t.get("boundaryGap")&&n.type==="category",n.inverse=t.get("inverse"),jht(t)){n.inverse=n.inverse!==t.get("clockwise");var i=t.get("startAngle"),r=(e=t.get("endAngle"))!==null&&e!==void 0?e:i+(n.inverse?-360:360);n.setExtent(i,r)}t.axis=n,n.model=t}var Uht={dimensions:j7,create:function(n,t){var e=[];return n.eachComponent("polar",function(i,r){var o=new Vht(r+"");o.update=$ht;var s=o.getRadiusAxis(),a=o.getAngleAxis(),l=i.findAxisModel("radiusAxis"),h=i.findAxisModel("angleAxis");nz(s,l),nz(a,h),Ght(o,i,t),e.push(o),i.coordinateSystem=o,o.model=i}),n.eachSeries(function(i){if(i.get("coordinateSystem")==="polar"){var r=i.getReferringComponents("polar",Qn).models[0];i.coordinateSystem=r.coordinateSystem}}),e}},Xht=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function Tb(n,t,e){t[1]>t[0]&&(t=t.slice().reverse());var i=n.coordToPoint([t[0],e]),r=n.coordToPoint([t[1],e]);return{x1:i[0],y1:i[1],x2:r[0],y2:r[1]}}function Mb(n){var t=n.getRadiusAxis();return t.inverse?0:1}function rz(n){var t=n[0],e=n[n.length-1];t&&e&&Math.abs(Math.abs(t.coord-e.coord)-360)<1e-4&&n.pop()}var Yht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.axisPointerClass="PolarAxisPointer",e}return t.prototype.render=function(e,i){if(this.group.removeAll(),!!e.get("show")){var r=e.axis,o=r.polar,s=o.getRadiusAxis().getExtent(),a=r.getTicksCoords(),l=r.getMinorTicksCoords(),h=St(r.getViewLabels(),function(u){u=ne(u);var d=r.scale,c=d.type==="ordinal"?d.getRawOrdinalNumber(u.tickValue):u.tickValue;return u.coord=r.dataToCoord(c),u});rz(h),rz(a),N(Xht,function(u){e.get([u,"show"])&&(!r.scale.isBlank()||u==="axisLine")&&Kht[u](this.group,e,o,a,l,s,h)},this)}},t.type="angleAxis",t}(fy),Kht={axisLine:function(n,t,e,i,r,o){var s=t.getModel(["axisLine","lineStyle"]),a=e.getAngleAxis(),l=Math.PI/180,h=a.getExtent(),u=Mb(e),d=u?0:1,c,f=Math.abs(h[1]-h[0])===360?"Circle":"Arc";o[d]===0?c=new UE[f]({shape:{cx:e.cx,cy:e.cy,r:o[u],startAngle:-h[0]*l,endAngle:-h[1]*l,clockwise:a.inverse},style:s.getLineStyle(),z2:1,silent:!0}):c=new lS({shape:{cx:e.cx,cy:e.cy,r:o[u],r0:o[d]},style:s.getLineStyle(),z2:1,silent:!0}),c.style.fill=null,n.add(c)},axisTick:function(n,t,e,i,r,o){var s=t.getModel("axisTick"),a=(s.get("inside")?-1:1)*s.get("length"),l=o[Mb(e)],h=St(i,function(u){return new ns({shape:Tb(e,[l,l+a],u.coord)})});n.add(wl(h,{style:Gt(s.getModel("lineStyle").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})}))},minorTick:function(n,t,e,i,r,o){if(r.length){for(var s=t.getModel("axisTick"),a=t.getModel("minorTick"),l=(s.get("inside")?-1:1)*a.get("length"),h=o[Mb(e)],u=[],d=0;d<r.length;d++)for(var c=0;c<r[d].length;c++)u.push(new ns({shape:Tb(e,[h,h+l],r[d][c].coord)}));n.add(wl(u,{style:Gt(a.getModel("lineStyle").getLineStyle(),Gt(s.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(n,t,e,i,r,o,s){var a=t.getCategories(!0),l=t.getModel("axisLabel"),h=l.get("margin"),u=t.get("triggerEvent");N(s,function(d,c){var f=l,g=d.tickValue,p=o[Mb(e)],v=e.coordToPoint([p+h,d.coord]),m=e.cx,y=e.cy,b=Math.abs(v[0]-m)/p<.3?"center":v[0]>m?"left":"right",_=Math.abs(v[1]-y)/p<.3?"middle":v[1]>y?"top":"bottom";if(a&&a[g]){var w=a[g];Ht(w)&&w.textStyle&&(f=new ui(w.textStyle,l,l.ecModel))}var C=new Vi({silent:ds.isLabelSilent(t),style:So(f,{x:v[0],y:v[1],fill:f.getTextColor()||t.get(["axisLine","lineStyle","color"]),text:d.formattedLabel,align:b,verticalAlign:_})});if(n.add(C),u){var x=ds.makeAxisEventDataBase(t);x.targetType="axisLabel",x.value=d.rawLabel,pe(C).eventData=x}},this)},splitLine:function(n,t,e,i,r,o){var s=t.getModel("splitLine"),a=s.getModel("lineStyle"),l=a.get("color"),h=0;l=l instanceof Array?l:[l];for(var u=[],d=0;d<i.length;d++){var c=h++%l.length;u[c]=u[c]||[],u[c].push(new ns({shape:Tb(e,o,i[d].coord)}))}for(var d=0;d<u.length;d++)n.add(wl(u[d],{style:Gt({stroke:l[d%l.length]},a.getLineStyle()),silent:!0,z:t.get("z")}))},minorSplitLine:function(n,t,e,i,r,o){if(r.length){for(var s=t.getModel("minorSplitLine"),a=s.getModel("lineStyle"),l=[],h=0;h<r.length;h++)for(var u=0;u<r[h].length;u++)l.push(new ns({shape:Tb(e,o,r[h][u].coord)}));n.add(wl(l,{style:a.getLineStyle(),silent:!0,z:t.get("z")}))}},splitArea:function(n,t,e,i,r,o){if(i.length){var s=t.getModel("splitArea"),a=s.getModel("areaStyle"),l=a.get("color"),h=0;l=l instanceof Array?l:[l];for(var u=[],d=Math.PI/180,c=-i[0].coord*d,f=Math.min(o[0],o[1]),g=Math.max(o[0],o[1]),p=t.get("clockwise"),v=1,m=i.length;v<=m;v++){var y=v===m?i[0].coord:i[v].coord,b=h++%l.length;u[b]=u[b]||[],u[b].push(new xo({shape:{cx:e.cx,cy:e.cy,r0:f,r:g,startAngle:c,endAngle:-y*d,clockwise:p},silent:!0})),c=-y*d}for(var v=0;v<u.length;v++)n.add(wl(u[v],{style:Gt({fill:l[v%l.length]},a.getAreaStyle()),silent:!0}))}}},qht=["axisLine","axisTickLabel","axisName"],Zht=["splitLine","splitArea","minorSplitLine"],Jht=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.axisPointerClass="PolarAxisPointer",e}return t.prototype.render=function(e,i){if(this.group.removeAll(),!!e.get("show")){var r=this._axisGroup,o=this._axisGroup=new bi;this.group.add(o);var s=e.axis,a=s.polar,l=a.getAngleAxis(),h=s.getTicksCoords(),u=s.getMinorTicksCoords(),d=l.getExtent()[0],c=s.getExtent(),f=tut(a,e,d),g=new ds(e,f);N(qht,g.add,g),o.add(g.getGroup()),jE(r,o,e),N(Zht,function(p){e.get([p,"show"])&&!s.scale.isBlank()&&Qht[p](this.group,e,a,d,c,h,u)},this)}},t.type="radiusAxis",t}(fy),Qht={splitLine:function(n,t,e,i,r,o){var s=t.getModel("splitLine"),a=s.getModel("lineStyle"),l=a.get("color"),h=0,u=e.getAngleAxis(),d=Math.PI/180,c=u.getExtent(),f=Math.abs(c[1]-c[0])===360?"Circle":"Arc";l=l instanceof Array?l:[l];for(var g=[],p=0;p<o.length;p++){var v=h++%l.length;g[v]=g[v]||[],g[v].push(new UE[f]({shape:{cx:e.cx,cy:e.cy,r:Math.max(o[p].coord,0),startAngle:-c[0]*d,endAngle:-c[1]*d,clockwise:u.inverse}}))}for(var p=0;p<g.length;p++)n.add(wl(g[p],{style:Gt({stroke:l[p%l.length],fill:null},a.getLineStyle()),silent:!0}))},minorSplitLine:function(n,t,e,i,r,o,s){if(s.length){for(var a=t.getModel("minorSplitLine"),l=a.getModel("lineStyle"),h=[],u=0;u<s.length;u++)for(var d=0;d<s[u].length;d++)h.push(new ly({shape:{cx:e.cx,cy:e.cy,r:s[u][d].coord}}));n.add(wl(h,{style:Gt({fill:null},l.getLineStyle()),silent:!0}))}},splitArea:function(n,t,e,i,r,o){if(o.length){var s=t.getModel("splitArea"),a=s.getModel("areaStyle"),l=a.get("color"),h=0;l=l instanceof Array?l:[l];for(var u=[],d=o[0].coord,c=1;c<o.length;c++){var f=h++%l.length;u[f]=u[f]||[],u[f].push(new xo({shape:{cx:e.cx,cy:e.cy,r0:d,r:o[c].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),d=o[c].coord}for(var c=0;c<u.length;c++)n.add(wl(u[c],{style:Gt({fill:l[c%l.length]},a.getAreaStyle()),silent:!0}))}}};function tut(n,t,e){return{position:[n.cx,n.cy],rotation:e/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}function U7(n){return n.get("stack")||"__ec_stack_"+n.seriesIndex}function X7(n,t){return t.dim+n.model.componentIndex}function eut(n,t,e){var i={},r=iut(Ti(t.getSeriesByType(n),function(o){return!t.isSeriesFiltered(o)&&o.coordinateSystem&&o.coordinateSystem.type==="polar"}));t.eachSeriesByType(n,function(o){if(o.coordinateSystem.type==="polar"){var s=o.getData(),a=o.coordinateSystem,l=a.getBaseAxis(),h=X7(a,l),u=U7(o),d=r[h][u],c=d.offset,f=d.width,g=a.getOtherAxis(l),p=o.coordinateSystem.cx,v=o.coordinateSystem.cy,m=o.get("barMinHeight")||0,y=o.get("barMinAngle")||0;i[u]=i[u]||[];for(var b=s.mapDimension(g.dim),_=s.mapDimension(l.dim),w=oc(s,b),C=l.dim!=="radius"||!o.get("roundCap",!0),x=g.model,S=x.get("startValue"),A=g.dataToCoord(S||0),T=0,M=s.count();T<M;T++){var R=s.get(b,T),E=s.get(_,T),P=R>=0?"p":"n",B=A;w&&(i[u][E]||(i[u][E]={p:A,n:A}),B=i[u][E][P]);var k=void 0,L=void 0,O=void 0,D=void 0;if(g.dim==="radius"){var I=g.dataToCoord(R)-A,H=l.dataToCoord(E);Math.abs(I)<m&&(I=(I<0?-1:1)*m),k=B,L=B+I,O=H-c,D=O-f,w&&(i[u][E][P]=L)}else{var F=g.dataToCoord(R,C)-A,G=l.dataToCoord(E);Math.abs(F)<y&&(F=(F<0?-1:1)*y),k=G+c,L=k+f,O=B,D=B+F,w&&(i[u][E][P]=D)}s.setItemLayout(T,{cx:p,cy:v,r0:k,r:L,startAngle:-O*Math.PI/180,endAngle:-D*Math.PI/180,clockwise:O>=D})}}})}function iut(n){var t={};N(n,function(i,r){var o=i.getData(),s=i.coordinateSystem,a=s.getBaseAxis(),l=X7(s,a),h=a.getExtent(),u=a.type==="category"?a.getBandWidth():Math.abs(h[1]-h[0])/o.count(),d=t[l]||{bandWidth:u,remainedWidth:u,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},c=d.stacks;t[l]=d;var f=U7(i);c[f]||d.autoWidthCount++,c[f]=c[f]||{width:0,maxWidth:0};var g=Jt(i.get("barWidth"),u),p=Jt(i.get("barMaxWidth"),u),v=i.get("barGap"),m=i.get("barCategoryGap");g&&!c[f].width&&(g=Math.min(d.remainedWidth,g),c[f].width=g,d.remainedWidth-=g),p&&(c[f].maxWidth=p),v!=null&&(d.gap=v),m!=null&&(d.categoryGap=m)});var e={};return N(t,function(i,r){e[r]={};var o=i.stacks,s=i.bandWidth,a=Jt(i.categoryGap,s),l=Jt(i.gap,1),h=i.remainedWidth,u=i.autoWidthCount,d=(h-a)/(u+(u-1)*l);d=Math.max(d,0),N(o,function(p,v){var m=p.maxWidth;m&&m<d&&(m=Math.min(m,h),p.width&&(m=Math.min(m,p.width)),h-=m,p.width=m,u--)}),d=(h-a)/(u+(u-1)*l),d=Math.max(d,0);var c=0,f;N(o,function(p,v){p.width||(p.width=d),f=p,c+=p.width*(1+l)}),f&&(c-=f.width*l);var g=-c/2;N(o,function(p,v){e[r][v]=e[r][v]||{offset:g,width:p.width},g+=p.width*(1+l)})}),e}var nut={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},rut={splitNumber:5},out=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="polar",t}(Zr);function v7t(n){Xs(xL),fy.registerAxisPointerClass("PolarAxisPointer",Dht),n.registerCoordinateSystem("polar",Uht),n.registerComponentModel(Fht),n.registerComponentView(out),sw(n,"angle",zht,nut),sw(n,"radius",Nht,rut),n.registerComponentView(Yht),n.registerComponentView(Jht),n.registerLayout(he(eut,"bar"))}var oz="\0_ec_interaction_mutex";function sut(n,t,e){var i=ML(n);i[t]=e}function aut(n,t,e){var i=ML(n),r=i[t];r===e&&(i[t]=null)}function sz(n,t){return!!ML(n)[t]}function ML(n){return n[oz]||(n[oz]={})}Ua({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},ir);var Y7=function(n){ct(t,n);function t(e){var i=n.call(this)||this;i._zr=e;var r=zt(i._mousedownHandler,i),o=zt(i._mousemoveHandler,i),s=zt(i._mouseupHandler,i),a=zt(i._mousewheelHandler,i),l=zt(i._pinchHandler,i);return i.enable=function(h,u){this.disable(),this._opt=Gt(ne(u)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),h==null&&(h=!0),(h===!0||h==="move"||h==="pan")&&(e.on("mousedown",r),e.on("mousemove",o),e.on("mouseup",s)),(h===!0||h==="scale"||h==="zoom")&&(e.on("mousewheel",a),e.on("pinch",l))},i.disable=function(){e.off("mousedown",r),e.off("mousemove",o),e.off("mouseup",s),e.off("mousewheel",a),e.off("pinch",l)},i}return t.prototype.isDragging=function(){return this._dragging},t.prototype.isPinching=function(){return this._pinching},t.prototype.setPointerChecker=function(e){this.pointerChecker=e},t.prototype.dispose=function(){this.disable()},t.prototype._mousedownHandler=function(e){if(!nI(e)){for(var i=e.target;i;){if(i.draggable)return;i=i.__hostTarget||i.parent}var r=e.offsetX,o=e.offsetY;this.pointerChecker&&this.pointerChecker(e,r,o)&&(this._x=r,this._y=o,this._dragging=!0)}},t.prototype._mousemoveHandler=function(e){if(!(!this._dragging||!iC("moveOnMouseMove",e,this._opt)||e.gestureEvent==="pinch"||sz(this._zr,"globalPan"))){var i=e.offsetX,r=e.offsetY,o=this._x,s=this._y,a=i-o,l=r-s;this._x=i,this._y=r,this._opt.preventDefaultMouseMove&&vg(e.event),K7(this,"pan","moveOnMouseMove",e,{dx:a,dy:l,oldX:o,oldY:s,newX:i,newY:r,isAvailableBehavior:null})}},t.prototype._mouseupHandler=function(e){nI(e)||(this._dragging=!1)},t.prototype._mousewheelHandler=function(e){var i=iC("zoomOnMouseWheel",e,this._opt),r=iC("moveOnMouseWheel",e,this._opt),o=e.wheelDelta,s=Math.abs(o),a=e.offsetX,l=e.offsetY;if(!(o===0||!i&&!r)){if(i){var h=s>3?1.4:s>1?1.2:1.1,u=o>0?h:1/h;LM(this,"zoom","zoomOnMouseWheel",e,{scale:u,originX:a,originY:l,isAvailableBehavior:null})}if(r){var d=Math.abs(o),c=(o>0?1:-1)*(d>3?.4:d>1?.15:.05);LM(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:c,originX:a,originY:l,isAvailableBehavior:null})}}},t.prototype._pinchHandler=function(e){if(!sz(this._zr,"globalPan")){var i=e.pinchScale>1?1.1:1/1.1;LM(this,"zoom",null,e,{scale:i,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})}},t}(ys);function LM(n,t,e,i,r){n.pointerChecker&&n.pointerChecker(i,r.originX,r.originY)&&(vg(i.event),K7(n,t,e,i,r))}function K7(n,t,e,i,r){r.isAvailableBehavior=zt(iC,null,e,i),n.trigger(t,r)}function iC(n,t,e){var i=e[n];return!n||i&&(!Pt(i)||t.event[i+"Key"])}var lut={axisPointer:1,tooltip:1,brush:1};function hut(n,t,e){var i=t.getComponentByElement(n.topTarget),r=i&&i.coordinateSystem;return i&&i!==e&&!lut.hasOwnProperty(i.mainType)&&r&&r.model!==e}function gy(n,t,e,i,r,o){n=n||0;var s=e[1]-e[0];if(r!=null&&(r=Yc(r,[0,s])),o!=null&&(o=Math.max(o,r??0)),i==="all"){var a=Math.abs(t[1]-t[0]);a=Yc(a,[0,s]),r=o=Yc(a,[r,o]),i=0}t[0]=Yc(t[0],e),t[1]=Yc(t[1],e);var l=OM(t,i);t[i]+=n;var h=r||0,u=e.slice();l.sign<0?u[0]+=h:u[1]-=h,t[i]=Yc(t[i],u);var d;return d=OM(t,i),r!=null&&(d.sign!==l.sign||d.span<r)&&(t[1-i]=t[i]+l.sign*r),d=OM(t,i),o!=null&&d.span>o&&(t[1-i]=t[i]+d.sign*o),t}function OM(n,t){var e=n[t]-n[1-t];return{span:Math.abs(e),sign:e>0?-1:e<0?1:t?-1:1}}function Yc(n,t){return Math.min(t[1]!=null?t[1]:1/0,Math.max(t[0]!=null?t[0]:-1/0,n))}var sc=!0,nm=Math.min,Ag=Math.max,uut=Math.pow,dut=1e4,cut=6,fut=6,az="globalPan",gut={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},put={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},lz={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},vut=0,mut=function(n){ct(t,n);function t(e){var i=n.call(this)||this;return i._track=[],i._covers=[],i._handlers={},i._zr=e,i.group=new bi,i._uid="brushController_"+vut++,N(Sut,function(r,o){this._handlers[o]=zt(r,this)},i),i}return t.prototype.enableBrush=function(e){return this._brushType&&this._doDisableBrush(),e.brushType&&this._doEnableBrush(e),this},t.prototype._doEnableBrush=function(e){var i=this._zr;this._enableGlobalPan||sut(i,az,this._uid),N(this._handlers,function(r,o){i.on(o,r)}),this._brushType=e.brushType,this._brushOption=we(ne(lz),e,!0)},t.prototype._doDisableBrush=function(){var e=this._zr;aut(e,az,this._uid),N(this._handlers,function(i,r){e.off(r,i)}),this._brushType=this._brushOption=null},t.prototype.setPanels=function(e){if(e&&e.length){var i=this._panels={};N(e,function(r){i[r.panelId]=ne(r)})}else this._panels=null;return this},t.prototype.mount=function(e){e=e||{},this._enableGlobalPan=e.enableGlobalPan;var i=this.group;return this._zr.add(i),i.attr({x:e.x||0,y:e.y||0,rotation:e.rotation||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1}),this._transform=i.getLocalTransform(),this},t.prototype.updateCovers=function(e){e=St(e,function(c){return we(ne(lz),c,!0)});var i="\0-brush-index-",r=this._covers,o=this._covers=[],s=this,a=this._creatingCover;return new rc(r,e,h,l).add(u).update(u).remove(d).execute(),this;function l(c,f){return(c.id!=null?c.id:i+f)+"-"+c.brushType}function h(c,f){return l(c.__brushOption,f)}function u(c,f){var g=e[c];if(f!=null&&r[f]===a)o[c]=r[f];else{var p=o[c]=f!=null?(r[f].__brushOption=g,r[f]):Z7(s,q7(s,g));RL(s,p)}}function d(c){r[c]!==a&&s.group.remove(r[c])}},t.prototype.unmount=function(){return this.enableBrush(!1),RB(this),this._zr.remove(this.group),this},t.prototype.dispose=function(){this.unmount(),this.off()},t}(ys);function q7(n,t){var e=BS[t.brushType].createCover(n,t);return e.__brushOption=t,Q7(e,t),n.group.add(e),e}function Z7(n,t){var e=BL(t);return e.endCreating&&(e.endCreating(n,t),Q7(t,t.__brushOption)),t}function J7(n,t){var e=t.__brushOption;BL(t).updateCoverShape(n,t,e.range,e)}function Q7(n,t){var e=t.z;e==null&&(e=dut),n.traverse(function(i){i.z=e,i.z2=e})}function RL(n,t){BL(t).updateCommon(n,t),J7(n,t)}function BL(n){return BS[n.__brushOption.brushType]}function PL(n,t,e){var i=n._panels;if(!i)return sc;var r,o=n._transform;return N(i,function(s){s.isTargetByCursor(t,e,o)&&(r=s)}),r}function tj(n,t){var e=n._panels;if(!e)return sc;var i=t.__brushOption.panelId;return i!=null?e[i]:sc}function RB(n){var t=n._covers,e=t.length;return N(t,function(i){n.group.remove(i)},n),t.length=0,!!e}function ac(n,t){var e=St(n._covers,function(i){var r=i.__brushOption,o=ne(r.range);return{brushType:r.brushType,panelId:r.panelId,range:o}});n.trigger("brush",{areas:e,isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function yut(n){var t=n._track;if(!t.length)return!1;var e=t[t.length-1],i=t[0],r=e[0]-i[0],o=e[1]-i[1],s=uut(r*r+o*o,.5);return s>cut}function ej(n){var t=n.length-1;return t<0&&(t=0),[n[0],n[t]]}function ij(n,t,e,i){var r=new bi;return r.add(new ci({name:"main",style:kL(e),silent:!0,draggable:!0,cursor:"move",drift:he(hz,n,t,r,["n","s","w","e"]),ondragend:he(ac,t,{isEnd:!0})})),N(i,function(o){r.add(new ci({name:o.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:he(hz,n,t,r,o),ondragend:he(ac,t,{isEnd:!0})}))}),r}function nj(n,t,e,i){var r=i.brushStyle.lineWidth||0,o=Ag(r,fut),s=e[0][0],a=e[1][0],l=s-r/2,h=a-r/2,u=e[0][1],d=e[1][1],c=u-o+r/2,f=d-o+r/2,g=u-s,p=d-a,v=g+r,m=p+r;nl(n,t,"main",s,a,g,p),i.transformable&&(nl(n,t,"w",l,h,o,m),nl(n,t,"e",c,h,o,m),nl(n,t,"n",l,h,v,o),nl(n,t,"s",l,f,v,o),nl(n,t,"nw",l,h,o,o),nl(n,t,"ne",c,h,o,o),nl(n,t,"sw",l,f,o,o),nl(n,t,"se",c,f,o,o))}function BB(n,t){var e=t.__brushOption,i=e.transformable,r=t.childAt(0);r.useStyle(kL(e)),r.attr({silent:!i,cursor:i?"move":"default"}),N([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(o){var s=t.childOfName(o.join("")),a=o.length===1?PB(n,o[0]):_ut(n,o);s&&s.attr({silent:!i,invisible:!i,cursor:i?put[a]+"-resize":null})})}function nl(n,t,e,i,r,o,s){var a=t.childOfName(e);a&&a.setShape(wut(EL(n,t,[[i,r],[i+o,r+s]])))}function kL(n){return Gt({strokeNoScale:!0},n.brushStyle)}function rj(n,t,e,i){var r=[nm(n,e),nm(t,i)],o=[Ag(n,e),Ag(t,i)];return[[r[0],o[0]],[r[1],o[1]]]}function but(n){return cS(n.group)}function PB(n,t){var e={w:"left",e:"right",n:"top",s:"bottom"},i={left:"w",right:"e",top:"n",bottom:"s"},r=$E(e[t],but(n));return i[r]}function _ut(n,t){var e=[PB(n,t[0]),PB(n,t[1])];return(e[0]==="e"||e[0]==="w")&&e.reverse(),e.join("")}function hz(n,t,e,i,r,o){var s=e.__brushOption,a=n.toRectRange(s.range),l=oj(t,r,o);N(i,function(h){var u=gut[h];a[u[0]][u[1]]+=l[u[0]]}),s.range=n.fromRectRange(rj(a[0][0],a[1][0],a[0][1],a[1][1])),RL(t,e),ac(t,{isEnd:!1})}function Cut(n,t,e,i){var r=t.__brushOption.range,o=oj(n,e,i);N(r,function(s){s[0]+=o[0],s[1]+=o[1]}),RL(n,t),ac(n,{isEnd:!1})}function oj(n,t,e){var i=n.group,r=i.transformCoordToLocal(t,e),o=i.transformCoordToLocal(0,0);return[r[0]-o[0],r[1]-o[1]]}function EL(n,t,e){var i=tj(n,t);return i&&i!==sc?i.clipPath(e,n._transform):ne(e)}function wut(n){var t=nm(n[0][0],n[1][0]),e=nm(n[0][1],n[1][1]),i=Ag(n[0][0],n[1][0]),r=Ag(n[0][1],n[1][1]);return{x:t,y:e,width:i-t,height:r-e}}function xut(n,t,e){if(!(!n._brushType||Aut(n,t.offsetX,t.offsetY))){var i=n._zr,r=n._covers,o=PL(n,t,e);if(!n._dragging)for(var s=0;s<r.length;s++){var a=r[s].__brushOption;if(o&&(o===sc||a.panelId===o.panelId)&&BS[a.brushType].contain(r[s],e[0],e[1]))return}o&&i.setCursorStyle("crosshair")}}function kB(n){var t=n.event;t.preventDefault&&t.preventDefault()}function EB(n,t,e){return n.childOfName("main").contain(t,e)}function sj(n,t,e,i){var r=n._creatingCover,o=n._creatingPanel,s=n._brushOption,a;if(n._track.push(e.slice()),yut(n)||r){if(o&&!r){s.brushMode==="single"&&RB(n);var l=ne(s);l.brushType=uz(l.brushType,o),l.panelId=o===sc?null:o.panelId,r=n._creatingCover=q7(n,l),n._covers.push(r)}if(r){var h=BS[uz(n._brushType,o)],u=r.__brushOption;u.range=h.getCreatingRange(EL(n,r,n._track)),i&&(Z7(n,r),h.updateCommon(n,r)),J7(n,r),a={isEnd:i}}}else i&&s.brushMode==="single"&&s.removeOnClick&&PL(n,t,e)&&RB(n)&&(a={isEnd:i,removeOnClick:!0});return a}function uz(n,t){return n==="auto"?t.defaultBrushType:n}var Sut={mousedown:function(n){if(this._dragging)dz(this,n);else if(!n.target||!n.target.draggable){kB(n);var t=this.group.transformCoordToLocal(n.offsetX,n.offsetY);this._creatingCover=null;var e=this._creatingPanel=PL(this,n,t);e&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(n){var t=n.offsetX,e=n.offsetY,i=this.group.transformCoordToLocal(t,e);if(xut(this,n,i),this._dragging){kB(n);var r=sj(this,n,i,!1);r&&ac(this,r)}},mouseup:function(n){dz(this,n)}};function dz(n,t){if(n._dragging){kB(t);var e=t.offsetX,i=t.offsetY,r=n.group.transformCoordToLocal(e,i),o=sj(n,t,r,!0);n._dragging=!1,n._track=[],n._creatingCover=null,o&&ac(n,o)}}function Aut(n,t,e){var i=n._zr;return t<0||t>i.getWidth()||e<0||e>i.getHeight()}var BS={lineX:cz(0),lineY:cz(1),rect:{createCover:function(n,t){function e(i){return i}return ij({toRectRange:e,fromRectRange:e},n,t,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(n){var t=ej(n);return rj(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(n,t,e,i){nj(n,t,e,i)},updateCommon:BB,contain:EB},polygon:{createCover:function(n,t){var e=new bi;return e.add(new Tc({name:"main",style:kL(t),silent:!0})),e},getCreatingRange:function(n){return n},endCreating:function(n,t){t.remove(t.childAt(0)),t.add(new Ac({name:"main",draggable:!0,drift:he(Cut,n,t),ondragend:he(ac,n,{isEnd:!0})}))},updateCoverShape:function(n,t,e,i){t.childAt(0).setShape({points:EL(n,t,e)})},updateCommon:BB,contain:EB}};function cz(n){return{createCover:function(t,e){return ij({toRectRange:function(i){var r=[i,[0,100]];return n&&r.reverse(),r},fromRectRange:function(i){return i[n]}},t,e,[[["w"],["e"]],[["n"],["s"]]][n])},getCreatingRange:function(t){var e=ej(t),i=nm(e[0][n],e[1][n]),r=Ag(e[0][n],e[1][n]);return[i,r]},updateCoverShape:function(t,e,i,r){var o,s=tj(t,e);if(s!==sc&&s.getLinearBrushOtherExtent)o=s.getLinearBrushOtherExtent(n);else{var a=t._zr;o=[0,[a.getWidth(),a.getHeight()][1-n]]}var l=[i,o];n&&l.reverse(),nj(t,e,l,r)},updateCommon:BB,contain:EB}}function Tut(n){return n=LL(n),function(t){return R9(t,n)}}function Mut(n,t){return n=LL(n),function(e){var i=t??e,r=i?n.width:n.height,o=i?n.x:n.y;return[o,o+(r||0)]}}function Rut(n,t,e){var i=LL(n);return function(r,o){return i.contain(o[0],o[1])&&!hut(r,t,e)}}function LL(n){return Te.create(n)}var fz=["x","y","radius","angle","single"],But=["cartesian2d","polar","singleAxis"];function Put(n){var t=n.get("coordinateSystem");return _e(But,t)>=0}function Eh(n){return n+"Axis"}function kut(n,t){var e=$t(),i=[],r=$t();n.eachComponent({mainType:"dataZoom",query:t},function(u){r.get(u.uid)||a(u)});var o;do o=!1,n.eachComponent("dataZoom",s);while(o);function s(u){!r.get(u.uid)&&l(u)&&(a(u),o=!0)}function a(u){r.set(u.uid,!0),i.push(u),h(u)}function l(u){var d=!1;return u.eachTargetAxis(function(c,f){var g=e.get(c);g&&g[f]&&(d=!0)}),d}function h(u){u.eachTargetAxis(function(d,c){(e.get(d)||e.set(d,[]))[c]=!0})}return i}function aj(n){var t=n.ecModel,e={infoList:[],infoMap:$t()};return n.eachTargetAxis(function(i,r){var o=t.getComponent(Eh(i),r);if(o){var s=o.getCoordSysModel();if(s){var a=s.uid,l=e.infoMap.get(a);l||(l={model:s,axisModels:[]},e.infoList.push(l),e.infoMap.set(a,l)),l.axisModels.push(o)}}}),e}var DM=function(){function n(){this.indexList=[],this.indexMap=[]}return n.prototype.add=function(t){this.indexMap[t]||(this.indexList.push(t),this.indexMap[t]=!0)},n}(),rm=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e._autoThrottle=!0,e._noTarget=!0,e._rangePropMode=["percent","percent"],e}return t.prototype.init=function(e,i,r){var o=gz(e);this.settledOption=o,this.mergeDefaultAndTheme(e,r),this._doInit(o)},t.prototype.mergeOption=function(e){var i=gz(e);we(this.option,e,!0),we(this.settledOption,i,!0),this._doInit(i)},t.prototype._doInit=function(e){var i=this.option;this._setDefaultThrottle(e),this._updateRangeUse(e);var r=this.settledOption;N([["start","startValue"],["end","endValue"]],function(o,s){this._rangePropMode[s]==="value"&&(i[o[0]]=r[o[0]]=null)},this),this._resetTarget()},t.prototype._resetTarget=function(){var e=this.get("orient",!0),i=this._targetAxisInfoMap=$t(),r=this._fillSpecifiedTargetAxis(i);r?this._orient=e||this._makeAutoOrientByTargetAxis():(this._orient=e||"horizontal",this._fillAutoTargetAxisByOrient(i,this._orient)),this._noTarget=!0,i.each(function(o){o.indexList.length&&(this._noTarget=!1)},this)},t.prototype._fillSpecifiedTargetAxis=function(e){var i=!1;return N(fz,function(r){var o=this.getReferringComponents(Eh(r),Jet);if(o.specified){i=!0;var s=new DM;N(o.models,function(a){s.add(a.componentIndex)}),e.set(r,s)}},this),i},t.prototype._fillAutoTargetAxisByOrient=function(e,i){var r=this.ecModel,o=!0;if(o){var s=i==="vertical"?"y":"x",a=r.findComponents({mainType:s+"Axis"});l(a,s)}if(o){var a=r.findComponents({mainType:"singleAxis",filter:function(u){return u.get("orient",!0)===i}});l(a,"single")}function l(h,u){var d=h[0];if(d){var c=new DM;if(c.add(d.componentIndex),e.set(u,c),o=!1,u==="x"||u==="y"){var f=d.getReferringComponents("grid",Qn).models[0];f&&N(h,function(g){d.componentIndex!==g.componentIndex&&f===g.getReferringComponents("grid",Qn).models[0]&&c.add(g.componentIndex)})}}}o&&N(fz,function(h){if(o){var u=r.findComponents({mainType:Eh(h),filter:function(c){return c.get("type",!0)==="category"}});if(u[0]){var d=new DM;d.add(u[0].componentIndex),e.set(h,d),o=!1}}},this)},t.prototype._makeAutoOrientByTargetAxis=function(){var e;return this.eachTargetAxis(function(i){!e&&(e=i)},this),e==="y"?"vertical":"horizontal"},t.prototype._setDefaultThrottle=function(e){if(e.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var i=this.ecModel.option;this.option.throttle=i.animation&&i.animationDurationUpdate>0?100:20}},t.prototype._updateRangeUse=function(e){var i=this._rangePropMode,r=this.get("rangeMode");N([["start","startValue"],["end","endValue"]],function(o,s){var a=e[o[0]]!=null,l=e[o[1]]!=null;a&&!l?i[s]="percent":!a&&l?i[s]="value":r?i[s]=r[s]:a&&(i[s]="percent")})},t.prototype.noTarget=function(){return this._noTarget},t.prototype.getFirstTargetAxisModel=function(){var e;return this.eachTargetAxis(function(i,r){e==null&&(e=this.ecModel.getComponent(Eh(i),r))},this),e},t.prototype.eachTargetAxis=function(e,i){this._targetAxisInfoMap.each(function(r,o){N(r.indexList,function(s){e.call(i,o,s)})})},t.prototype.getAxisProxy=function(e,i){var r=this.getAxisModel(e,i);if(r)return r.__dzAxisProxy},t.prototype.getAxisModel=function(e,i){var r=this._targetAxisInfoMap.get(e);if(r&&r.indexMap[i])return this.ecModel.getComponent(Eh(e),i)},t.prototype.setRawRange=function(e){var i=this.option,r=this.settledOption;N([["start","startValue"],["end","endValue"]],function(o){(e[o[0]]!=null||e[o[1]]!=null)&&(i[o[0]]=r[o[0]]=e[o[0]],i[o[1]]=r[o[1]]=e[o[1]])},this),this._updateRangeUse(e)},t.prototype.setCalculatedRange=function(e){var i=this.option;N(["start","startValue","end","endValue"],function(r){i[r]=e[r]})},t.prototype.getPercentRange=function(){var e=this.findRepresentativeAxisProxy();if(e)return e.getDataPercentWindow()},t.prototype.getValueRange=function(e,i){if(e==null&&i==null){var r=this.findRepresentativeAxisProxy();if(r)return r.getDataValueWindow()}else return this.getAxisProxy(e,i).getDataValueWindow()},t.prototype.findRepresentativeAxisProxy=function(e){if(e)return e.__dzAxisProxy;for(var i,r=this._targetAxisInfoMap.keys(),o=0;o<r.length;o++)for(var s=r[o],a=this._targetAxisInfoMap.get(s),l=0;l<a.indexList.length;l++){var h=this.getAxisProxy(s,a.indexList[l]);if(h.hostedBy(this))return h;i||(i=h)}return i},t.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},t.prototype.getOrient=function(){return this._orient},t.type="dataZoom",t.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],t.defaultOption={z:4,filterMode:"filter",start:0,end:100},t}($e);function gz(n){var t={};return N(["start","end","startValue","endValue","throttle"],function(e){n.hasOwnProperty(e)&&(t[e]=n[e])}),t}var Eut=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="dataZoom.select",t}(rm),OL=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,i,r,o){this.dataZoomModel=e,this.ecModel=i,this.api=r},t.type="dataZoom",t}(Zr),Lut=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="dataZoom.select",t}(OL),bf=N,pz=Ev,Out=function(){function n(t,e,i,r){this._dimName=t,this._axisIndex=e,this.ecModel=r,this._dataZoomModel=i}return n.prototype.hostedBy=function(t){return this._dataZoomModel===t},n.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},n.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},n.prototype.getTargetSeriesModels=function(){var t=[];return this.ecModel.eachSeries(function(e){if(Put(e)){var i=Eh(this._dimName),r=e.getReferringComponents(i,Qn).models[0];r&&this._axisIndex===r.componentIndex&&t.push(e)}},this),t},n.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},n.prototype.getMinMaxSpan=function(){return ne(this._minMaxSpan)},n.prototype.calculateDataWindow=function(t){var e=this._dataExtent,i=this.getAxisModel(),r=i.axis.scale,o=this._dataZoomModel.getRangePropMode(),s=[0,100],a=[],l=[],h;bf(["start","end"],function(c,f){var g=t[c],p=t[c+"Value"];o[f]==="percent"?(g==null&&(g=s[f]),p=r.parse(Ui(g,s,e))):(h=!0,p=p==null?e[f]:r.parse(p),g=Ui(p,e,s)),l[f]=p==null||isNaN(p)?e[f]:p,a[f]=g==null||isNaN(g)?s[f]:g}),pz(l),pz(a);var u=this._minMaxSpan;h?d(l,a,e,s,!1):d(a,l,s,e,!0);function d(c,f,g,p,v){var m=v?"Span":"ValueSpan";gy(0,c,g,"all",u["min"+m],u["max"+m]);for(var y=0;y<2;y++)f[y]=Ui(c[y],g,p,!0),v&&(f[y]=r.parse(f[y]))}return{valueWindow:l,percentWindow:a}},n.prototype.reset=function(t){if(t===this._dataZoomModel){var e=this.getTargetSeriesModels();this._dataExtent=Dut(this,this._dimName,e),this._updateMinMaxSpan();var i=this.calculateDataWindow(t.settledOption);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,this._setAxisModel()}},n.prototype.filterData=function(t,e){if(t!==this._dataZoomModel)return;var i=this._dimName,r=this.getTargetSeriesModels(),o=t.get("filterMode"),s=this._valueWindow;if(o==="none")return;bf(r,function(l){var h=l.getData(),u=h.mapDimensionsAll(i);if(u.length){if(o==="weakFilter"){var d=h.getStore(),c=St(u,function(f){return h.getDimensionIndex(f)},h);h.filterSelf(function(f){for(var g,p,v,m=0;m<u.length;m++){var y=d.get(c[m],f),b=!isNaN(y),_=y<s[0],w=y>s[1];if(b&&!_&&!w)return!0;b&&(v=!0),_&&(g=!0),w&&(p=!0)}return v&&g&&p})}else bf(u,function(f){if(o==="empty")l.setData(h=h.map(f,function(p){return a(p)?p:NaN}));else{var g={};g[f]=s,h.selectRange(g)}});bf(u,function(f){h.setApproximateExtent(s,f)})}});function a(l){return l>=s[0]&&l<=s[1]}},n.prototype._updateMinMaxSpan=function(){var t=this._minMaxSpan={},e=this._dataZoomModel,i=this._dataExtent;bf(["min","max"],function(r){var o=e.get(r+"Span"),s=e.get(r+"ValueSpan");s!=null&&(s=this.getAxisModel().axis.scale.parse(s)),s!=null?o=Ui(i[0]+s,i,[0,100],!0):o!=null&&(s=Ui(o,[0,100],i,!0)-i[0]),t[r+"Span"]=o,t[r+"ValueSpan"]=s},this)},n.prototype._setAxisModel=function(){var t=this.getAxisModel(),e=this._percentWindow,i=this._valueWindow;if(e){var r=z8(i,[0,500]);r=Math.min(r,20);var o=t.axis.scale.rawExtentInfo;e[0]!==0&&o.setDeterminedMinMax("min",+i[0].toFixed(r)),e[1]!==100&&o.setDeterminedMinMax("max",+i[1].toFixed(r)),o.freeze()}},n}();function Dut(n,t,e){var i=[1/0,-1/0];bf(e,function(s){glt(i,s.getData(),t)});var r=n.getAxisModel(),o=c7(r.axis.scale,r,i).calculate();return[o.min,o.max]}var Iut={getTargetSeries:function(n){function t(r){n.eachComponent("dataZoom",function(o){o.eachTargetAxis(function(s,a){var l=n.getComponent(Eh(s),a);r(s,a,l,o)})})}t(function(r,o,s,a){s.__dzAxisProxy=null});var e=[];t(function(r,o,s,a){s.__dzAxisProxy||(s.__dzAxisProxy=new Out(r,o,a,n),e.push(s.__dzAxisProxy))});var i=$t();return N(e,function(r){N(r.getTargetSeriesModels(),function(o){i.set(o.uid,o)})}),i},overallReset:function(n,t){n.eachComponent("dataZoom",function(e){e.eachTargetAxis(function(i,r){e.getAxisProxy(i,r).reset(e)}),e.eachTargetAxis(function(i,r){e.getAxisProxy(i,r).filterData(e,t)})}),n.eachComponent("dataZoom",function(e){var i=e.findRepresentativeAxisProxy();if(i){var r=i.getDataPercentWindow(),o=i.getDataValueWindow();e.setCalculatedRange({start:r[0],end:r[1],startValue:o[0],endValue:o[1]})}})}};function Hut(n){n.registerAction("dataZoom",function(t,e){var i=kut(e,t);N(i,function(r){r.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})})})}var vz=!1;function DL(n){vz||(vz=!0,n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,Iut),Hut(n),n.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function Fut(n){n.registerComponentModel(Eut),n.registerComponentView(Lut),DL(n)}var Os=function(){function n(){}return n}(),lj={};function nv(n,t){lj[n]=t}function hj(n){return lj[n]}var zut=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.optionUpdated=function(){n.prototype.optionUpdated.apply(this,arguments);var e=this.ecModel;N(this.option.feature,function(i,r){var o=hj(r);o&&(o.getDefaultOption&&(o.defaultOption=o.getDefaultOption(e)),we(i,o.defaultOption))})},t.type="toolbox",t.layoutMode={type:"box",ignoreSize:!0},t.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},t}($e);function Nut(n,t,e){var i=t.getBoxLayoutParams(),r=t.get("padding"),o={width:e.getWidth(),height:e.getHeight()},s=Na(i,o,r);$f(t.get("orient"),n,t.get("itemGap"),s.width,s.height),X9(n,i,o,r)}function uj(n,t){var e=dy(t.get("padding")),i=t.getItemStyle(["color","opacity"]);return i.fill=t.get("backgroundColor"),n=new ci({shape:{x:n.x-e[3],y:n.y-e[0],width:n.width+e[1]+e[3],height:n.height+e[0]+e[2],r:t.get("borderRadius")},style:i,silent:!0,z2:-1}),n}var Wut=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,o){var s=this.group;if(s.removeAll(),!e.get("show"))return;var a=+e.get("itemSize"),l=e.get("orient")==="vertical",h=e.get("feature")||{},u=this._features||(this._features={}),d=[];N(h,function(g,p){d.push(p)}),new rc(this._featureNames||[],d).add(c).update(c).remove(he(c,null)).execute(),this._featureNames=d;function c(g,p){var v=d[g],m=d[p],y=h[v],b=new ui(y,e,e.ecModel),_;if(o&&o.newTitle!=null&&o.featureName===v&&(y.title=o.newTitle),v&&!m){if(Vut(v))_={onclick:b.option.onclick,featureName:v};else{var w=hj(v);if(!w)return;_=new w}u[v]=_}else if(_=u[m],!_)return;_.uid=uy("toolbox-feature"),_.model=b,_.ecModel=i,_.api=r;var C=_ instanceof Os;if(!v&&m){C&&_.dispose&&_.dispose(i,r);return}if(!b.get("show")||C&&_.unusable){C&&_.remove&&_.remove(i,r);return}f(b,_,v),b.setIconStatus=function(x,S){var A=this.option,T=this.iconPaths;A.iconStatus=A.iconStatus||{},A.iconStatus[x]=S,T[x]&&(S==="emphasis"?bg:_g)(T[x])},_ instanceof Os&&_.render&&_.render(b,i,r,o)}function f(g,p,v){var m=g.getModel("iconStyle"),y=g.getModel(["emphasis","iconStyle"]),b=p instanceof Os&&p.getIcons?p.getIcons():g.get("icon"),_=g.get("title")||{},w,C;Pt(b)?(w={},w[v]=b):w=b,Pt(_)?(C={},C[v]=_):C=_;var x=g.iconPaths={};N(w,function(S,A){var T=fS(S,{},{x:-a/2,y:-a/2,width:a,height:a});T.setStyle(m.getItemStyle());var M=T.ensureState("emphasis");M.style=y.getItemStyle();var R=new Vi({style:{text:C[A],align:y.get("textAlign"),borderRadius:y.get("textBorderRadius"),padding:y.get("textPadding"),fill:null,font:k9({fontStyle:y.get("textFontStyle"),fontFamily:y.get("textFontFamily"),fontSize:y.get("textFontSize"),fontWeight:y.get("textFontWeight")},i)},ignore:!0});T.setTextContent(R),hy({el:T,componentModel:e,itemName:A,formatterParamsExtra:{title:C[A]}}),T.__title=C[A],T.on("mouseover",function(){var E=y.getItemStyle(),P=l?e.get("right")==null&&e.get("left")!=="right"?"right":"left":e.get("bottom")==null&&e.get("top")!=="bottom"?"bottom":"top";R.setStyle({fill:y.get("textFill")||E.fill||E.stroke||"#000",backgroundColor:y.get("textBackgroundColor")}),T.setTextConfig({position:y.get("textPosition")||P}),R.ignore=!e.get("showTitle"),r.enterEmphasis(this)}).on("mouseout",function(){g.get(["iconStatus",A])!=="emphasis"&&r.leaveEmphasis(this),R.hide()}),(g.get(["iconStatus",A])==="emphasis"?bg:_g)(T),s.add(T),T.on("click",zt(p.onclick,p,i,r,A)),x[A]=T})}Nut(s,e,r),s.add(uj(s.getBoundingRect(),e)),l||s.eachChild(function(g){var p=g.__title,v=g.ensureState("emphasis"),m=v.textConfig||(v.textConfig={}),y=g.getTextContent(),b=y&&y.ensureState("emphasis");if(b&&!jt(b)&&p){var _=b.style||(b.style={}),w=ry(p,Vi.makeFont(_)),C=g.x+s.x,x=g.y+s.y+a,S=!1;x+w.height>r.getHeight()&&(m.position="top",S=!0);var A=S?-5-w.height:a+10;C+w.width/2>r.getWidth()?(m.position=["100%",A],_.align="right"):C-w.width/2<0&&(m.position=[0,A],_.align="left")}})},t.prototype.updateView=function(e,i,r,o){N(this._features,function(s){s instanceof Os&&s.updateView&&s.updateView(s.model,i,r,o)})},t.prototype.remove=function(e,i){N(this._features,function(r){r instanceof Os&&r.remove&&r.remove(e,i)}),this.group.removeAll()},t.prototype.dispose=function(e,i){N(this._features,function(r){r instanceof Os&&r.dispose&&r.dispose(e,i)})},t.type="toolbox",t}(Zr);function Vut(n){return n.indexOf("my")===0}var Gut=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.onclick=function(e,i){var r=this.model,o=r.get("name")||e.get("title.0.text")||"echarts",s=i.getZr().painter.getType()==="svg",a=s?"svg":r.get("type",!0)||"png",l=i.getConnectedDataURL({type:a,backgroundColor:r.get("backgroundColor",!0)||e.get("backgroundColor")||"#fff",connectedBackgroundColor:r.get("connectedBackgroundColor"),excludeComponents:r.get("excludeComponents"),pixelRatio:r.get("pixelRatio")}),h=ie.browser;if(typeof MouseEvent=="function"&&(h.newEdge||!h.ie&&!h.edge)){var u=document.createElement("a");u.download=o+"."+a,u.target="_blank",u.href=l;var d=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});u.dispatchEvent(d)}else if(window.navigator.msSaveOrOpenBlob||s){var c=l.split(","),f=c[0].indexOf("base64")>-1,g=s?decodeURIComponent(c[1]):c[1];f&&(g=window.atob(g));var p=o+"."+a;if(window.navigator.msSaveOrOpenBlob){for(var v=g.length,m=new Uint8Array(v);v--;)m[v]=g.charCodeAt(v);var y=new Blob([m]);window.navigator.msSaveOrOpenBlob(y,p)}else{var b=document.createElement("iframe");document.body.appendChild(b);var _=b.contentWindow,w=_.document;w.open("image/svg+xml","replace"),w.write(g),w.close(),_.focus(),w.execCommand("SaveAs",!0,p),document.body.removeChild(b)}}else{var C=r.get("lang"),x='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(C&&C[0]||"")+'" /></body>',S=window.open();S.document.write(x),S.document.title=o}},t.getDefaultOption=function(e){var i={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:e.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:e.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return i},t}(Os),mz="__ec_magicType_stack__",$ut=[["line","bar"],["stack"]],jut=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.getIcons=function(){var e=this.model,i=e.get("icon"),r={};return N(e.get("type"),function(o){i[o]&&(r[o]=i[o])}),r},t.getDefaultOption=function(e){var i={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:e.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return i},t.prototype.onclick=function(e,i,r){var o=this.model,s=o.get(["seriesIndex",r]);if(yz[r]){var a={series:[]},l=function(d){var c=d.subType,f=d.id,g=yz[r](c,f,d,o);g&&(Gt(g,d.option),a.series.push(g));var p=d.coordinateSystem;if(p&&p.type==="cartesian2d"&&(r==="line"||r==="bar")){var v=p.getAxesByScale("ordinal")[0];if(v){var m=v.dim,y=m+"Axis",b=d.getReferringComponents(y,Qn).models[0],_=b.componentIndex;a[y]=a[y]||[];for(var w=0;w<=_;w++)a[y][_]=a[y][_]||{};a[y][_].boundaryGap=r==="bar"}}};N($ut,function(d){_e(d,r)>=0&&N(d,function(c){o.setIconStatus(c,"normal")})}),o.setIconStatus(r,"emphasis"),e.eachComponent({mainType:"series",query:s==null?null:{seriesIndex:s}},l);var h,u=r;r==="stack"&&(h=we({stack:o.option.title.tiled,tiled:o.option.title.stack},o.option.title),o.get(["iconStatus",r])!=="emphasis"&&(u="tiled")),i.dispatchAction({type:"changeMagicType",currentType:u,newOption:a,newTitle:h,featureName:"magicType"})}},t}(Os),yz={line:function(n,t,e,i){if(n==="bar")return we({id:t,type:"line",data:e.get("data"),stack:e.get("stack"),markPoint:e.get("markPoint"),markLine:e.get("markLine")},i.get(["option","line"])||{},!0)},bar:function(n,t,e,i){if(n==="line")return we({id:t,type:"bar",data:e.get("data"),stack:e.get("stack"),markPoint:e.get("markPoint"),markLine:e.get("markLine")},i.get(["option","bar"])||{},!0)},stack:function(n,t,e,i){var r=e.get("stack")===mz;if(n==="line"||n==="bar")return i.setIconStatus("stack",r?"normal":"emphasis"),we({id:t,stack:r?"":mz},i.get(["option","stack"])||{},!0)}};Ua({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(n,t){t.mergeOption(n.newOption)});var PS=new Array(60).join("-"),Tg="	";function Uut(n){var t={},e=[],i=[];return n.eachRawSeries(function(r){var o=r.coordinateSystem;if(o&&(o.type==="cartesian2d"||o.type==="polar")){var s=o.getBaseAxis();if(s.type==="category"){var a=s.dim+"_"+s.index;t[a]||(t[a]={categoryAxis:s,valueAxis:o.getOtherAxis(s),series:[]},i.push({axisDim:s.dim,axisIndex:s.index})),t[a].series.push(r)}else e.push(r)}else e.push(r)}),{seriesGroupByCategoryAxis:t,other:e,meta:i}}function Xut(n){var t=[];return N(n,function(e,i){var r=e.categoryAxis,o=e.valueAxis,s=o.dim,a=[" "].concat(St(e.series,function(f){return f.name})),l=[r.model.getCategories()];N(e.series,function(f){var g=f.getRawData();l.push(f.getRawData().mapArray(g.mapDimension(s),function(p){return p}))});for(var h=[a.join(Tg)],u=0;u<l[0].length;u++){for(var d=[],c=0;c<l.length;c++)d.push(l[c][u]);h.push(d.join(Tg))}t.push(h.join(`
`))}),t.join(`

`+PS+`

`)}function Yut(n){return St(n,function(t){var e=t.getRawData(),i=[t.name],r=[];return e.each(e.dimensions,function(){for(var o=arguments.length,s=arguments[o-1],a=e.getName(s),l=0;l<o-1;l++)r[l]=arguments[l];i.push((a?a+Tg:"")+r.join(Tg))}),i.join(`
`)}).join(`

`+PS+`

`)}function Kut(n){var t=Uut(n);return{value:Ti([Xut(t.seriesGroupByCategoryAxis),Yut(t.other)],function(e){return!!e.replace(/[\n\t\s]/g,"")}).join(`

`+PS+`

`),meta:t.meta}}function aw(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function qut(n){var t=n.slice(0,n.indexOf(`
`));if(t.indexOf(Tg)>=0)return!0}var LB=new RegExp("["+Tg+"]+","g");function Zut(n){for(var t=n.split(/\n+/g),e=aw(t.shift()).split(LB),i=[],r=St(e,function(l){return{name:l,data:[]}}),o=0;o<t.length;o++){var s=aw(t[o]).split(LB);i.push(s.shift());for(var a=0;a<s.length;a++)r[a]&&(r[a].data[o]=s[a])}return{series:r,categories:i}}function Jut(n){for(var t=n.split(/\n+/g),e=aw(t.shift()),i=[],r=0;r<t.length;r++){var o=aw(t[r]);if(o){var s=o.split(LB),a="",l=void 0,h=!1;isNaN(s[0])?(h=!0,a=s[0],s=s.slice(1),i[r]={name:a,value:[]},l=i[r].value):l=i[r]=[];for(var u=0;u<s.length;u++)l.push(+s[u]);l.length===1&&(h?i[r].value=l[0]:i[r]=l[0])}}return{name:e,data:i}}function Qut(n,t){var e=n.split(new RegExp(`
*`+PS+`
*`,"g")),i={series:[]};return N(e,function(r,o){if(qut(r)){var s=Zut(r),a=t[o],l=a.axisDim+"Axis";a&&(i[l]=i[l]||[],i[l][a.axisIndex]={data:s.categories},i.series=i.series.concat(s.series))}else{var s=Jut(r);i.series.push(s)}}),i}var tdt=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.onclick=function(e,i){setTimeout(function(){i.dispatchAction({type:"hideTip"})});var r=i.getDom(),o=this.model;this._dom&&r.removeChild(this._dom);var s=document.createElement("div");s.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",s.style.backgroundColor=o.get("backgroundColor")||"#fff";var a=document.createElement("h4"),l=o.get("lang")||[];a.innerHTML=l[0]||o.get("title"),a.style.cssText="margin:10px 20px",a.style.color=o.get("textColor");var h=document.createElement("div"),u=document.createElement("textarea");h.style.cssText="overflow:auto";var d=o.get("optionToContent"),c=o.get("contentToOption"),f=Kut(e);if(jt(d)){var g=d(i.getOption());Pt(g)?h.innerHTML=g:gg(g)&&h.appendChild(g)}else{u.readOnly=o.get("readOnly");var p=u.style;p.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",p.color=o.get("textColor"),p.borderColor=o.get("textareaBorderColor"),p.backgroundColor=o.get("textareaColor"),u.value=f.value,h.appendChild(u)}var v=f.meta,m=document.createElement("div");m.style.cssText="position:absolute;bottom:5px;left:0;right:0";var y="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",b=document.createElement("div"),_=document.createElement("div");y+=";background-color:"+o.get("buttonColor"),y+=";color:"+o.get("buttonTextColor");var w=this;function C(){r.removeChild(s),w._dom=null}H2(b,"click",C),H2(_,"click",function(){if(c==null&&d!=null||c!=null&&d==null){C();return}var x;try{jt(c)?x=c(h,i.getOption()):x=Qut(u.value,v)}catch(S){throw C(),new Error("Data view format error "+S)}x&&i.dispatchAction({type:"changeDataView",newOption:x}),C()}),b.innerHTML=l[1],_.innerHTML=l[2],_.style.cssText=b.style.cssText=y,!o.get("readOnly")&&m.appendChild(_),m.appendChild(b),s.appendChild(a),s.appendChild(h),s.appendChild(m),h.style.height=r.clientHeight-80+"px",r.appendChild(s),this._dom=s},t.prototype.remove=function(e,i){this._dom&&i.getDom().removeChild(this._dom)},t.prototype.dispose=function(e,i){this.remove(e,i)},t.getDefaultOption=function(e){var i={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:e.getLocaleModel().get(["toolbox","dataView","title"]),lang:e.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return i},t}(Os);function edt(n,t){return St(n,function(e,i){var r=t&&t[i];if(Ht(r)&&!_t(r)){var o=Ht(e)&&!_t(e);o||(e={value:e});var s=r.name!=null&&e.name==null;return e=Gt(e,r),s&&delete e.name,e}else return e})}Ua({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(n,t){var e=[];N(n.newOption.series,function(i){var r=t.getSeriesByName(i.name)[0];if(!r)e.push(ft({type:"scatter"},i));else{var o=r.get("data");e.push({name:i.name,data:edt(i.data,o)})}}),t.mergeOption(Gt({series:e},n.newOption))});var dj=N,cj=Ke();function idt(n,t){var e=IL(n);dj(t,function(i,r){for(var o=e.length-1;o>=0;o--){var s=e[o];if(s[r])break}if(o<0){var a=n.queryComponents({mainType:"dataZoom",subType:"select",id:r})[0];if(a){var l=a.getPercentRange();e[0][r]={dataZoomId:r,start:l[0],end:l[1]}}}}),e.push(t)}function ndt(n){var t=IL(n),e=t[t.length-1];t.length>1&&t.pop();var i={};return dj(e,function(r,o){for(var s=t.length-1;s>=0;s--)if(r=t[s][o],r){i[o]=r;break}}),i}function rdt(n){cj(n).snapshots=null}function odt(n){return IL(n).length}function IL(n){var t=cj(n);return t.snapshots||(t.snapshots=[{}]),t.snapshots}var sdt=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.onclick=function(e,i){rdt(e),i.dispatchAction({type:"restore",from:this.uid})},t.getDefaultOption=function(e){var i={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:e.getLocaleModel().get(["toolbox","restore","title"])};return i},t}(Os);Ua({type:"restore",event:"restore",update:"prepareAndUpdate"},function(n,t){t.resetOption("recreate")});var adt=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],fj=function(){function n(t,e,i){var r=this;this._targetInfoList=[];var o=bz(e,t);N(ldt,function(s,a){(!i||!i.include||_e(i.include,a)>=0)&&s(o,r._targetInfoList)})}return n.prototype.setOutputRanges=function(t,e){return this.matchOutputRanges(t,e,function(i,r,o){if((i.coordRanges||(i.coordRanges=[])).push(r),!i.coordRange){i.coordRange=r;var s=IM[i.brushType](0,o,r);i.__rangeOffset={offset:xz[i.brushType](s.values,i.range,[1,1]),xyMinMax:s.xyMinMax}}}),t},n.prototype.matchOutputRanges=function(t,e,i){N(t,function(r){var o=this.findTargetInfo(r,e);o&&o!==!0&&N(o.coordSyses,function(s){var a=IM[r.brushType](1,s,r.range,!0);i(r,a.values,s,e)})},this)},n.prototype.setInputRanges=function(t,e){N(t,function(i){var r=this.findTargetInfo(i,e);if(i.range=i.range||[],r&&r!==!0){i.panelId=r.panelId;var o=IM[i.brushType](0,r.coordSys,i.coordRange),s=i.__rangeOffset;i.range=s?xz[i.brushType](o.values,s.offset,hdt(o.xyMinMax,s.xyMinMax)):o.values}},this)},n.prototype.makePanelOpts=function(t,e){return St(this._targetInfoList,function(i){var r=i.getPanelRect();return{panelId:i.panelId,defaultBrushType:e?e(i):null,clipPath:Tut(r),isTargetByCursor:Rut(r,t,i.coordSysModel),getLinearBrushOtherExtent:Mut(r)}})},n.prototype.controlSeries=function(t,e,i){var r=this.findTargetInfo(t,i);return r===!0||r&&_e(r.coordSyses,e.coordinateSystem)>=0},n.prototype.findTargetInfo=function(t,e){for(var i=this._targetInfoList,r=bz(e,t),o=0;o<i.length;o++){var s=i[o],a=t.panelId;if(a){if(s.panelId===a)return s}else for(var l=0;l<_z.length;l++)if(_z[l](r,s))return s}return!0},n}();function OB(n){return n[0]>n[1]&&n.reverse(),n}function bz(n,t){return s0(n,t,{includeMainTypes:adt})}var ldt={grid:function(n,t){var e=n.xAxisModels,i=n.yAxisModels,r=n.gridModels,o=$t(),s={},a={};!e&&!i&&!r||(N(e,function(l){var h=l.axis.grid.model;o.set(h.id,h),s[h.id]=!0}),N(i,function(l){var h=l.axis.grid.model;o.set(h.id,h),a[h.id]=!0}),N(r,function(l){o.set(l.id,l),s[l.id]=!0,a[l.id]=!0}),o.each(function(l){var h=l.coordinateSystem,u=[];N(h.getCartesians(),function(d,c){(_e(e,d.getAxis("x").model)>=0||_e(i,d.getAxis("y").model)>=0)&&u.push(d)}),t.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:u[0],coordSyses:u,getPanelRect:Cz.grid,xAxisDeclared:s[l.id],yAxisDeclared:a[l.id]})}))},geo:function(n,t){N(n.geoModels,function(e){var i=e.coordinateSystem;t.push({panelId:"geo--"+e.id,geoModel:e,coordSysModel:e,coordSys:i,coordSyses:[i],getPanelRect:Cz.geo})})}},_z=[function(n,t){var e=n.xAxisModel,i=n.yAxisModel,r=n.gridModel;return!r&&e&&(r=e.axis.grid.model),!r&&i&&(r=i.axis.grid.model),r&&r===t.gridModel},function(n,t){var e=n.geoModel;return e&&e===t.geoModel}],Cz={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,t=n.getBoundingRect().clone();return t.applyTransform(cS(n)),t}},IM={lineX:he(wz,0),lineY:he(wz,1),rect:function(n,t,e,i){var r=n?t.pointToData([e[0][0],e[1][0]],i):t.dataToPoint([e[0][0],e[1][0]],i),o=n?t.pointToData([e[0][1],e[1][1]],i):t.dataToPoint([e[0][1],e[1][1]],i),s=[OB([r[0],o[0]]),OB([r[1],o[1]])];return{values:s,xyMinMax:s}},polygon:function(n,t,e,i){var r=[[1/0,-1/0],[1/0,-1/0]],o=St(e,function(s){var a=n?t.pointToData(s,i):t.dataToPoint(s,i);return r[0][0]=Math.min(r[0][0],a[0]),r[1][0]=Math.min(r[1][0],a[1]),r[0][1]=Math.max(r[0][1],a[0]),r[1][1]=Math.max(r[1][1],a[1]),a});return{values:o,xyMinMax:r}}};function wz(n,t,e,i){var r=e.getAxis(["x","y"][n]),o=OB(St([0,1],function(a){return t?r.coordToData(r.toLocalCoord(i[a]),!0):r.toGlobalCoord(r.dataToCoord(i[a]))})),s=[];return s[n]=o,s[1-n]=[NaN,NaN],{values:o,xyMinMax:s}}var xz={lineX:he(Sz,0),lineY:he(Sz,1),rect:function(n,t,e){return[[n[0][0]-e[0]*t[0][0],n[0][1]-e[0]*t[0][1]],[n[1][0]-e[1]*t[1][0],n[1][1]-e[1]*t[1][1]]]},polygon:function(n,t,e){return St(n,function(i,r){return[i[0]-e[0]*t[r][0],i[1]-e[1]*t[r][1]]})}};function Sz(n,t,e,i){return[t[0]-i[n]*e[0],t[1]-i[n]*e[1]]}function hdt(n,t){var e=Az(n),i=Az(t),r=[e[0]/i[0],e[1]/i[1]];return isNaN(r[0])&&(r[0]=1),isNaN(r[1])&&(r[1]=1),r}function Az(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}var DB=N,udt=Yet("toolbox-dataZoom_"),ddt=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,o){this._brushController||(this._brushController=new mut(r.getZr()),this._brushController.on("brush",zt(this._onBrush,this)).mount()),gdt(e,i,this,o,r),fdt(e,i)},t.prototype.onclick=function(e,i,r){cdt[r].call(this)},t.prototype.remove=function(e,i){this._brushController&&this._brushController.unmount()},t.prototype.dispose=function(e,i){this._brushController&&this._brushController.dispose()},t.prototype._onBrush=function(e){var i=e.areas;if(!e.isEnd||!i.length)return;var r={},o=this.ecModel;this._brushController.updateCovers([]);var s=new fj(HL(this.model),o,{include:["grid"]});s.matchOutputRanges(i,o,function(h,u,d){if(d.type==="cartesian2d"){var c=h.brushType;c==="rect"?(a("x",d,u[0]),a("y",d,u[1])):a({lineX:"x",lineY:"y"}[c],d,u)}}),idt(o,r),this._dispatchZoomAction(r);function a(h,u,d){var c=u.getAxis(h),f=c.model,g=l(h,f,o),p=g.findRepresentativeAxisProxy(f).getMinMaxSpan();(p.minValueSpan!=null||p.maxValueSpan!=null)&&(d=gy(0,d.slice(),c.scale.getExtent(),0,p.minValueSpan,p.maxValueSpan)),g&&(r[g.id]={dataZoomId:g.id,startValue:d[0],endValue:d[1]})}function l(h,u,d){var c;return d.eachComponent({mainType:"dataZoom",subType:"select"},function(f){var g=f.getAxisModel(h,u.componentIndex);g&&(c=f)}),c}},t.prototype._dispatchZoomAction=function(e){var i=[];DB(e,function(r,o){i.push(ne(r))}),i.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:i})},t.getDefaultOption=function(e){var i={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:e.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return i},t}(Os),cdt={zoom:function(){var n=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:n})},back:function(){this._dispatchZoomAction(ndt(this.ecModel))}};function HL(n){var t={xAxisIndex:n.get("xAxisIndex",!0),yAxisIndex:n.get("yAxisIndex",!0),xAxisId:n.get("xAxisId",!0),yAxisId:n.get("yAxisId",!0)};return t.xAxisIndex==null&&t.xAxisId==null&&(t.xAxisIndex="all"),t.yAxisIndex==null&&t.yAxisId==null&&(t.yAxisIndex="all"),t}function fdt(n,t){n.setIconStatus("back",odt(t)>1?"emphasis":"normal")}function gdt(n,t,e,i,r){var o=e._isZoomActive;i&&i.type==="takeGlobalCursor"&&(o=i.key==="dataZoomSelect"?i.dataZoomSelectActive:!1),e._isZoomActive=o,n.setIconStatus("zoom",o?"emphasis":"normal");var s=new fj(HL(n),t,{include:["grid"]}),a=s.makePanelOpts(r,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});e._brushController.setPanels(a).enableBrush(o&&a.length?{brushType:"auto",brushStyle:n.getModel("brushStyle").getItemStyle()}:!1)}Lrt("dataZoom",function(n){var t=n.getComponent("toolbox",0),e=["feature","dataZoom"];if(!t||t.get(e)==null)return;var i=t.getModel(e),r=[],o=HL(i),s=s0(n,o);DB(s.xAxisModels,function(l){return a(l,"xAxis","xAxisIndex")}),DB(s.yAxisModels,function(l){return a(l,"yAxis","yAxisIndex")});function a(l,h,u){var d=l.componentIndex,c={type:"select",$fromToolbox:!0,filterMode:i.get("filterMode",!0)||"filter",id:udt+h+d};c[u]=d,r.push(c)}return r});function m7t(n){n.registerComponentModel(zut),n.registerComponentView(Wut),nv("saveAsImage",Gut),nv("magicType",jut),nv("dataView",tdt),nv("dataZoom",ddt),nv("restore",sdt),Xs(Fut)}var pdt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}($e);function gj(n){var t=n.get("confine");return t!=null?!!t:n.get("renderMode")==="richText"}function pj(n){if(ie.domSupported){for(var t=document.documentElement.style,e=0,i=n.length;e<i;e++)if(n[e]in t)return n[e]}}var vj=pj(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),vdt=pj(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function mj(n,t){if(!n)return t;t=j9(t,!0);var e=n.indexOf(t);return n=e===-1?t:"-"+n.slice(0,e)+"-"+t,n.toLowerCase()}function mdt(n,t){var e=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return e?e[t]:null}var ydt=mj(vdt,"transition"),FL=mj(vj,"transform"),bdt="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(ie.transform3dSupported?"will-change:transform;":"");function _dt(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function Cdt(n,t,e){if(!Pt(e)||e==="inside")return"";var i=n.get("backgroundColor"),r=n.get("borderWidth");t=nc(t);var o=_dt(e),s=Math.max(Math.round(r)*1.5,6),a="",l=FL+":",h;_e(["left","right"],o)>-1?(a+="top:50%",l+="translateY(-50%) rotate("+(h=o==="left"?-225:-45)+"deg)"):(a+="left:50%",l+="translateX(-50%) rotate("+(h=o==="top"?225:45)+"deg)");var u=h*Math.PI/180,d=s+r,c=d*Math.abs(Math.cos(u))+d*Math.abs(Math.sin(u)),f=Math.round(((c-Math.SQRT2*r)/2+Math.SQRT2*r-(c-d)/2)*100)/100;a+=";"+o+":-"+f+"px";var g=t+" solid "+r+"px;",p=["position:absolute;width:"+s+"px;height:"+s+"px;z-index:-1;",a+";"+l+";","border-bottom:"+g,"border-right:"+g,"background-color:"+i+";"];return'<div style="'+p.join("")+'"></div>'}function wdt(n,t){var e="cubic-bezier(0.23,1,0.32,1)",i=" "+n/2+"s "+e,r="opacity"+i+",visibility"+i;return t||(i=" "+n+"s "+e,r+=ie.transformSupported?","+FL+i:",left"+i+",top"+i),ydt+":"+r}function Tz(n,t,e){var i=n.toFixed(0)+"px",r=t.toFixed(0)+"px";if(!ie.transformSupported)return e?"top:"+r+";left:"+i+";":[["top",r],["left",i]];var o=ie.transform3dSupported,s="translate"+(o?"3d":"")+"("+i+","+r+(o?",0":"")+")";return e?"top:0;left:0;"+FL+":"+s+";":[["top",0],["left",0],[vj,s]]}function xdt(n){var t=[],e=n.get("fontSize"),i=n.getTextColor();i&&t.push("color:"+i),t.push("font:"+n.getFont());var r=ve(n.get("lineHeight"),Math.round(e*3/2));e&&t.push("line-height:"+r+"px");var o=n.get("textShadowColor"),s=n.get("textShadowBlur")||0,a=n.get("textShadowOffsetX")||0,l=n.get("textShadowOffsetY")||0;return o&&s&&t.push("text-shadow:"+a+"px "+l+"px "+s+"px "+o),N(["decoration","align"],function(h){var u=n.get(h);u&&t.push("text-"+h+":"+u)}),t.join(";")}function Sdt(n,t,e){var i=[],r=n.get("transitionDuration"),o=n.get("backgroundColor"),s=n.get("shadowBlur"),a=n.get("shadowColor"),l=n.get("shadowOffsetX"),h=n.get("shadowOffsetY"),u=n.getModel("textStyle"),d=b$(n,"html"),c=l+"px "+h+"px "+s+"px "+a;return i.push("box-shadow:"+c),t&&r&&i.push(wdt(r,e)),o&&i.push("background-color:"+o),N(["width","color","radius"],function(f){var g="border-"+f,p=j9(g),v=n.get(p);v!=null&&i.push(g+":"+v+(f==="color"?"":"px"))}),i.push(xdt(u)),d!=null&&i.push("padding:"+dy(d).join("px ")+"px"),i.join(";")+";"}function Mz(n,t,e,i,r){var o=t&&t.painter;if(e){var s=o&&o.getViewportRoot();s&&Rtt(n,s,e,i,r)}else{n[0]=i,n[1]=r;var a=o&&o.getViewportRootOffset();a&&(n[0]+=a.offsetLeft,n[1]+=a.offsetTop)}n[2]=n[0]/t.getWidth(),n[3]=n[1]/t.getHeight()}var Adt=function(){function n(t,e){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,ie.wxa)return null;var i=document.createElement("div");i.domBelongToZr=!0,this.el=i;var r=this._zr=t.getZr(),o=e.appendTo,s=o&&(Pt(o)?document.querySelector(o):gg(o)?o:jt(o)&&o(t.getDom()));Mz(this._styleCoord,r,s,t.getWidth()/2,t.getHeight()/2),(s||t.getDom()).appendChild(i),this._api=t,this._container=s;var a=this;i.onmouseenter=function(){a._enterable&&(clearTimeout(a._hideTimeout),a._show=!0),a._inContent=!0},i.onmousemove=function(l){if(l=l||window.event,!a._enterable){var h=r.handler,u=r.painter.getViewportRoot();Fo(u,l,!0),h.dispatch("mousemove",l)}},i.onmouseleave=function(){a._inContent=!1,a._enterable&&a._show&&a.hideLater(a._hideDelay)}}return n.prototype.update=function(t){if(!this._container){var e=this._api.getDom(),i=mdt(e,"position"),r=e.style;r.position!=="absolute"&&i!=="absolute"&&(r.position="relative")}var o=t.get("alwaysShowContent");o&&this._moveIfResized(),this._alwaysShowContent=o,this.el.className=t.get("className")||""},n.prototype.show=function(t,e){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var i=this.el,r=i.style,o=this._styleCoord;i.innerHTML?r.cssText=bdt+Sdt(t,!this._firstShow,this._longHide)+Tz(o[0],o[1],!0)+("border-color:"+nc(e)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):r.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(t,e,i,r,o){var s=this.el;if(t==null){s.innerHTML="";return}var a="";if(Pt(o)&&i.get("trigger")==="item"&&!gj(i)&&(a=Cdt(i,r,o)),Pt(t))s.innerHTML=t+a;else if(t){s.innerHTML="",_t(t)||(t=[t]);for(var l=0;l<t.length;l++)gg(t[l])&&t[l].parentNode!==s&&s.appendChild(t[l]);if(a&&s.childNodes.length){var h=document.createElement("div");h.innerHTML=a,s.appendChild(h)}}},n.prototype.setEnterable=function(t){this._enterable=t},n.prototype.getSize=function(){var t=this.el;return t?[t.offsetWidth,t.offsetHeight]:[0,0]},n.prototype.moveTo=function(t,e){if(this.el){var i=this._styleCoord;if(Mz(i,this._zr,this._container,t,e),i[0]!=null&&i[1]!=null){var r=this.el.style,o=Tz(i[0],i[1]);N(o,function(s){r[s[0]]=s[1]})}}},n.prototype._moveIfResized=function(){var t=this._styleCoord[2],e=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),e*this._zr.getHeight())},n.prototype.hide=function(){var t=this,e=this.el.style;e.visibility="hidden",e.opacity="0",ie.transform3dSupported&&(e.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},n.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(zt(this.hide,this),t)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var t=this.el.parentNode;t&&t.removeChild(this.el),this.el=this._container=null},n}(),Tdt=function(){function n(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),Bz(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return n.prototype.update=function(t){var e=t.get("alwaysShowContent");e&&this._moveIfResized(),this._alwaysShowContent=e},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(t,e,i,r,o){var s=this;Ht(t)&&Fr(""),this.el&&this._zr.remove(this.el);var a=i.getModel("textStyle");this.el=new Vi({style:{rich:e.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:r,textShadowColor:a.get("textShadowColor"),fill:i.get(["textStyle","color"]),padding:b$(i,"richText"),verticalAlign:"top",align:"left"},z:i.get("z")}),N(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(h){s.el.style[h]=i.get(h)}),N(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(h){s.el.style[h]=a.get(h)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},n.prototype.setEnterable=function(t){this._enterable=t},n.prototype.getSize=function(){var t=this.el,e=this.el.getBoundingRect(),i=Rz(t.style);return[e.width+i.left+i.right,e.height+i.top+i.bottom]},n.prototype.moveTo=function(t,e){var i=this.el;if(i){var r=this._styleCoord;Bz(r,this._zr,t,e),t=r[0],e=r[1];var o=i.style,s=yh(o.borderWidth||0),a=Rz(o);i.x=t+s+a.left,i.y=e+s+a.top,i.markRedraw()}},n.prototype._moveIfResized=function(){var t=this._styleCoord[2],e=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),e*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(zt(this.hide,this),t)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function yh(n){return Math.max(0,n)}function Rz(n){var t=yh(n.shadowBlur||0),e=yh(n.shadowOffsetX||0),i=yh(n.shadowOffsetY||0);return{left:yh(t-e),right:yh(t+e),top:yh(t-i),bottom:yh(t+i)}}function Bz(n,t,e,i){n[0]=e,n[1]=i,n[2]=n[0]/t.getWidth(),n[3]=n[1]/t.getHeight()}var Mdt=new ci({shape:{x:-1,y:-1,width:2,height:2}}),Rdt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.init=function(e,i){if(!(ie.node||!i.getDom())){var r=e.getComponent("tooltip"),o=this._renderMode=tit(r.get("renderMode"));this._tooltipContent=o==="richText"?new Tdt(i):new Adt(i,{appendTo:r.get("appendToBody",!0)?"body":r.get("appendTo",!0)})}},t.prototype.render=function(e,i,r){if(!(ie.node||!r.getDom())){this.group.removeAll(),this._tooltipModel=e,this._ecModel=i,this._api=r;var o=this._tooltipContent;o.update(e),o.setEnterable(e.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&e.get("transitionDuration")?SS(this,"_updatePosition",50,"fixRate"):YC(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var e=this._tooltipModel,i=e.get("triggerOn");G7("itemTooltip",this._api,zt(function(r,o,s){i!=="none"&&(i.indexOf(r)>=0?this._tryShow(o,s):r==="leave"&&this._hide(s))},this))},t.prototype._keepShow=function(){var e=this._tooltipModel,i=this._ecModel,r=this._api,o=e.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&o!=="none"&&o!=="click"){var s=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!r.isDisposed()&&s.manuallyShowTip(e,i,r,{x:s._lastX,y:s._lastY,dataByCoordSys:s._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(e,i,r,o){if(!(o.from===this.uid||ie.node||!r.getDom())){var s=Pz(o,r);this._ticket="";var a=o.dataByCoordSys,l=Edt(o,i,r);if(l){var h=l.el.getBoundingRect().clone();h.applyTransform(l.el.transform),this._tryShow({offsetX:h.x+h.width/2,offsetY:h.y+h.height/2,target:l.el,position:o.position,positionDefault:"bottom"},s)}else if(o.tooltip&&o.x!=null&&o.y!=null){var u=Mdt;u.x=o.x,u.y=o.y,u.update(),pe(u).tooltipConfig={name:null,option:o.tooltip},this._tryShow({offsetX:o.x,offsetY:o.y,target:u},s)}else if(a)this._tryShow({offsetX:o.x,offsetY:o.y,position:o.position,dataByCoordSys:a,tooltipOption:o.tooltipOption},s);else if(o.seriesIndex!=null){if(this._manuallyAxisShowTip(e,i,r,o))return;var d=$7(o,i),c=d.point[0],f=d.point[1];c!=null&&f!=null&&this._tryShow({offsetX:c,offsetY:f,target:d.el,position:o.position,positionDefault:"bottom"},s)}else o.x!=null&&o.y!=null&&(r.dispatchAction({type:"updateAxisPointer",x:o.x,y:o.y}),this._tryShow({offsetX:o.x,offsetY:o.y,position:o.position,target:r.getZr().findHover(o.x,o.y).target},s))}},t.prototype.manuallyHideTip=function(e,i,r,o){var s=this._tooltipContent;this._tooltipModel&&s.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,o.from!==this.uid&&this._hide(Pz(o,r))},t.prototype._manuallyAxisShowTip=function(e,i,r,o){var s=o.seriesIndex,a=o.dataIndex,l=i.getComponent("axisPointer").coordSysAxesInfo;if(!(s==null||a==null||l==null)){var h=i.getSeriesByIndex(s);if(h){var u=h.getData(),d=rv([u.getItemModel(a),h,(h.coordinateSystem||{}).model],this._tooltipModel);if(d.get("trigger")==="axis")return r.dispatchAction({type:"updateAxisPointer",seriesIndex:s,dataIndex:a,position:o.position}),!0}}},t.prototype._tryShow=function(e,i){var r=e.target,o=this._tooltipModel;if(o){this._lastX=e.offsetX,this._lastY=e.offsetY;var s=e.dataByCoordSys;if(s&&s.length)this._showAxisTooltip(s,e);else if(r){var a=pe(r);if(a.ssrType==="legend")return;this._lastDataByCoordSys=null;var l,h;Iv(r,function(u){if(pe(u).dataIndex!=null)return l=u,!0;if(pe(u).tooltipConfig!=null)return h=u,!0},!0),l?this._showSeriesItemTooltip(e,l,i):h?this._showComponentItemTooltip(e,h,i):this._hide(i)}else this._lastDataByCoordSys=null,this._hide(i)}},t.prototype._showOrMove=function(e,i){var r=e.get("showDelay");i=zt(i,this),clearTimeout(this._showTimout),r>0?this._showTimout=setTimeout(i,r):i()},t.prototype._showAxisTooltip=function(e,i){var r=this._ecModel,o=this._tooltipModel,s=[i.offsetX,i.offsetY],a=rv([i.tooltipOption],o),l=this._renderMode,h=[],u=Sg("section",{blocks:[],noHeader:!0}),d=[],c=new cM;N(e,function(y){N(y.dataByAxis,function(b){var _=r.getComponent(b.axisDim+"Axis",b.axisIndex),w=b.value;if(!(!_||w==null)){var C=N7(w,_.axis,r,b.seriesDataIndices,b.valueLabelOpt),x=Sg("section",{header:C,noHeader:!Ba(C),sortBlocks:!0,blocks:[]});u.blocks.push(x),N(b.seriesDataIndices,function(S){var A=r.getSeriesByIndex(S.seriesIndex),T=S.dataIndexInside,M=A.getDataParams(T);if(!(M.dataIndex<0)){M.axisDim=b.axisDim,M.axisIndex=b.axisIndex,M.axisType=b.axisType,M.axisId=b.axisId,M.axisValue=bL(_.axis,{value:w}),M.axisValueLabel=C,M.marker=c.makeTooltipMarker("item",nc(M.color),l);var R=FH(A.formatTooltip(T,!0,null)),E=R.frag;if(E){var P=rv([A],o).get("valueFormatter");x.blocks.push(P?ft({valueFormatter:P},E):E)}R.text&&d.push(R.text),h.push(M)}})}})}),u.blocks.reverse(),d.reverse();var f=i.position,g=a.get("order"),p=GH(u,c,l,g,r.get("useUTC"),a.get("textStyle"));p&&d.unshift(p);var v=l==="richText"?`

`:"<br/>",m=d.join(v);this._showOrMove(a,function(){this._updateContentNotChangedOnAxis(e,h)?this._updatePosition(a,f,s[0],s[1],this._tooltipContent,h):this._showTooltipContent(a,m,h,Math.random()+"",s[0],s[1],f,null,c)})},t.prototype._showSeriesItemTooltip=function(e,i,r){var o=this._ecModel,s=pe(i),a=s.seriesIndex,l=o.getSeriesByIndex(a),h=s.dataModel||l,u=s.dataIndex,d=s.dataType,c=h.getData(d),f=this._renderMode,g=e.positionDefault,p=rv([c.getItemModel(u),h,l&&(l.coordinateSystem||{}).model],this._tooltipModel,g?{position:g}:null),v=p.get("trigger");if(!(v!=null&&v!=="item")){var m=h.getDataParams(u,d),y=new cM;m.marker=y.makeTooltipMarker("item",nc(m.color),f);var b=FH(h.formatTooltip(u,!1,d)),_=p.get("order"),w=p.get("valueFormatter"),C=b.frag,x=C?GH(w?ft({valueFormatter:w},C):C,y,f,_,o.get("useUTC"),p.get("textStyle")):b.text,S="item_"+h.name+"_"+u;this._showOrMove(p,function(){this._showTooltipContent(p,x,m,S,e.offsetX,e.offsetY,e.position,e.target,y)}),r({type:"showTip",dataIndexInside:u,dataIndex:c.getRawIndex(u),seriesIndex:a,from:this.uid})}},t.prototype._showComponentItemTooltip=function(e,i,r){var o=this._renderMode==="html",s=pe(i),a=s.tooltipConfig,l=a.option||{},h=l.encodeHTMLContent;if(Pt(l)){var u=l;l={content:u,formatter:u},h=!0}h&&o&&l.content&&(l=ne(l),l.content=Hr(l.content));var d=[l],c=this._ecModel.getComponent(s.componentMainType,s.componentIndex);c&&d.push(c),d.push({formatter:l.content});var f=e.positionDefault,g=rv(d,this._tooltipModel,f?{position:f}:null),p=g.get("content"),v=Math.random()+"",m=new cM;this._showOrMove(g,function(){var y=ne(g.get("formatterParams")||{});this._showTooltipContent(g,p,y,v,e.offsetX,e.offsetY,e.position,i,m)}),r({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(e,i,r,o,s,a,l,h,u){if(this._ticket="",!(!e.get("showContent")||!e.get("show"))){var d=this._tooltipContent;d.setEnterable(e.get("enterable"));var c=e.get("formatter");l=l||e.get("position");var f=i,g=this._getNearestPoint([s,a],r,e.get("trigger"),e.get("borderColor")),p=g.color;if(c)if(Pt(c)){var v=e.ecModel.get("useUTC"),m=_t(r)?r[0]:r,y=m&&m.axisType&&m.axisType.indexOf("time")>=0;f=c,y&&(f=mS(m.axisValue,f,v)),f=U9(f,r,!0)}else if(jt(c)){var b=zt(function(_,w){_===this._ticket&&(d.setContent(w,u,e,p,l),this._updatePosition(e,l,s,a,d,r,h))},this);this._ticket=o,f=c(r,o,b)}else f=c;d.setContent(f,u,e,p,l),d.show(e,p),this._updatePosition(e,l,s,a,d,r,h)}},t.prototype._getNearestPoint=function(e,i,r,o){if(r==="axis"||_t(i))return{color:o||(this._renderMode==="html"?"#fff":"none")};if(!_t(i))return{color:o||i.color||i.borderColor}},t.prototype._updatePosition=function(e,i,r,o,s,a,l){var h=this._api.getWidth(),u=this._api.getHeight();i=i||e.get("position");var d=s.getSize(),c=e.get("align"),f=e.get("verticalAlign"),g=l&&l.getBoundingRect().clone();if(l&&g.applyTransform(l.transform),jt(i)&&(i=i([r,o],a,s.el,g,{viewSize:[h,u],contentSize:d.slice()})),_t(i))r=Jt(i[0],h),o=Jt(i[1],u);else if(Ht(i)){var p=i;p.width=d[0],p.height=d[1];var v=Na(p,{width:h,height:u});r=v.x,o=v.y,c=null,f=null}else if(Pt(i)&&l){var m=kdt(i,g,d,e.get("borderWidth"));r=m[0],o=m[1]}else{var m=Bdt(r,o,s,h,u,c?null:20,f?null:20);r=m[0],o=m[1]}if(c&&(r-=kz(c)?d[0]/2:c==="right"?d[0]:0),f&&(o-=kz(f)?d[1]/2:f==="bottom"?d[1]:0),gj(e)){var m=Pdt(r,o,s,h,u);r=m[0],o=m[1]}s.moveTo(r,o)},t.prototype._updateContentNotChangedOnAxis=function(e,i){var r=this._lastDataByCoordSys,o=this._cbParamsList,s=!!r&&r.length===e.length;return s&&N(r,function(a,l){var h=a.dataByAxis||[],u=e[l]||{},d=u.dataByAxis||[];s=s&&h.length===d.length,s&&N(h,function(c,f){var g=d[f]||{},p=c.seriesDataIndices||[],v=g.seriesDataIndices||[];s=s&&c.value===g.value&&c.axisType===g.axisType&&c.axisId===g.axisId&&p.length===v.length,s&&N(p,function(m,y){var b=v[y];s=s&&m.seriesIndex===b.seriesIndex&&m.dataIndex===b.dataIndex}),o&&N(c.seriesDataIndices,function(m){var y=m.seriesIndex,b=i[y],_=o[y];b&&_&&_.data!==b.data&&(s=!1)})})}),this._lastDataByCoordSys=e,this._cbParamsList=i,!!s},t.prototype._hide=function(e){this._lastDataByCoordSys=null,e({type:"hideTip",from:this.uid})},t.prototype.dispose=function(e,i){ie.node||!i.getDom()||(YC(this,"_updatePosition"),this._tooltipContent.dispose(),MB("itemTooltip",i))},t.type="tooltip",t}(Zr);function rv(n,t,e){var i=t.ecModel,r;e?(r=new ui(e,i,i),r=new ui(t.option,r,i)):r=t;for(var o=n.length-1;o>=0;o--){var s=n[o];s&&(s instanceof ui&&(s=s.get("tooltip",!0)),Pt(s)&&(s={formatter:s}),s&&(r=new ui(s,r,i)))}return r}function Pz(n,t){return n.dispatchAction||zt(t.dispatchAction,t)}function Bdt(n,t,e,i,r,o,s){var a=e.getSize(),l=a[0],h=a[1];return o!=null&&(n+l+o+2>i?n-=l+o:n+=o),s!=null&&(t+h+s>r?t-=h+s:t+=s),[n,t]}function Pdt(n,t,e,i,r){var o=e.getSize(),s=o[0],a=o[1];return n=Math.min(n+s,i)-s,t=Math.min(t+a,r)-a,n=Math.max(n,0),t=Math.max(t,0),[n,t]}function kdt(n,t,e,i){var r=e[0],o=e[1],s=Math.ceil(Math.SQRT2*i)+8,a=0,l=0,h=t.width,u=t.height;switch(n){case"inside":a=t.x+h/2-r/2,l=t.y+u/2-o/2;break;case"top":a=t.x+h/2-r/2,l=t.y-o-s;break;case"bottom":a=t.x+h/2-r/2,l=t.y+u+s;break;case"left":a=t.x-r-s,l=t.y+u/2-o/2;break;case"right":a=t.x+h+s,l=t.y+u/2-o/2}return[a,l]}function kz(n){return n==="center"||n==="middle"}function Edt(n,t,e){var i=LE(n).queryOptionMap,r=i.keys()[0];if(!(!r||r==="series")){var o=sy(t,r,i.get(r),{useDefault:!1,enableAll:!1,enableNone:!1}),s=o.models[0];if(s){var a=e.getViewOfComponentModel(s),l;if(a.group.traverse(function(h){var u=pe(h).tooltipConfig;if(u&&u.name===n.name)return l=h,!0}),l)return{componentMainType:r,componentIndex:s.componentIndex,el:l}}}}function y7t(n){Xs(xL),n.registerComponentModel(pdt),n.registerComponentView(Rdt),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},ir),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},ir)}var om=N,Ldt=Ht,lw=-1,zL=function(){function n(t){var e=t.mappingMethod,i=t.type,r=this.option=ne(t);this.type=i,this.mappingMethod=e,this._normalizeData=Idt[e];var o=n.visualHandlers[i];this.applyVisual=o.applyVisual,this.getColorMapper=o.getColorMapper,this._normalizedToVisual=o._normalizedToVisual[e],e==="piecewise"?(HM(r),Odt(r)):e==="category"?r.categories?Ddt(r):HM(r,!0):(ps(e!=="linear"||r.dataExtent),HM(r))}return n.prototype.mapValueToVisual=function(t){var e=this._normalizeData(t);return this._normalizedToVisual(e,t)},n.prototype.getNormalizer=function(){return zt(this._normalizeData,this)},n.listVisualTypes=function(){return yi(n.visualHandlers)},n.isValidType=function(t){return n.visualHandlers.hasOwnProperty(t)},n.eachVisual=function(t,e,i){Ht(t)?N(t,e,i):e.call(i,t)},n.mapVisual=function(t,e,i){var r,o=_t(t)?[]:Ht(t)?{}:(r=!0,null);return n.eachVisual(t,function(s,a){var l=e.call(i,s,a);r?o=l:o[a]=l}),o},n.retrieveVisuals=function(t){var e={},i;return t&&om(n.visualHandlers,function(r,o){t.hasOwnProperty(o)&&(e[o]=t[o],i=!0)}),i?e:null},n.prepareVisualTypes=function(t){if(_t(t))t=t.slice();else if(Ldt(t)){var e=[];om(t,function(i,r){e.push(r)}),t=e}else return[];return t.sort(function(i,r){return r==="color"&&i!=="color"&&i.indexOf("color")===0?1:-1}),t},n.dependsOn=function(t,e){return e==="color"?!!(t&&t.indexOf(e)===0):t===e},n.findPieceIndex=function(t,e,i){for(var r,o=1/0,s=0,a=e.length;s<a;s++){var l=e[s].value;if(l!=null){if(l===t||Pt(l)&&l===t+"")return s;i&&c(l,s)}}for(var s=0,a=e.length;s<a;s++){var h=e[s],u=h.interval,d=h.close;if(u){if(u[0]===-1/0){if(Bb(d[1],t,u[1]))return s}else if(u[1]===1/0){if(Bb(d[0],u[0],t))return s}else if(Bb(d[0],u[0],t)&&Bb(d[1],t,u[1]))return s;i&&c(u[0],s),i&&c(u[1],s)}}if(i)return t===1/0?e.length-1:t===-1/0?0:r;function c(f,g){var p=Math.abs(f-t);p<o&&(o=p,r=g)}},n.visualHandlers={color:{applyVisual:ov("color"),getColorMapper:function(){var t=this.option;return zt(t.mappingMethod==="category"?function(e,i){return!i&&(e=this._normalizeData(e)),Hv.call(this,e)}:function(e,i,r){var o=!!r;return!i&&(e=this._normalizeData(e)),r=BT(e,t.parsedVisual,r),o?r:Ll(r,"rgba")},this)},_normalizedToVisual:{linear:function(t){return Ll(BT(t,this.option.parsedVisual),"rgba")},category:Hv,piecewise:function(t,e){var i=HB.call(this,e);return i==null&&(i=Ll(BT(t,this.option.parsedVisual),"rgba")),i},fixed:Ku}},colorHue:Rb(function(t,e){return r0(t,e)}),colorSaturation:Rb(function(t,e){return r0(t,null,e)}),colorLightness:Rb(function(t,e){return r0(t,null,null,e)}),colorAlpha:Rb(function(t,e){return E8(t,e)}),decal:{applyVisual:ov("decal"),_normalizedToVisual:{linear:null,category:Hv,piecewise:null,fixed:null}},opacity:{applyVisual:ov("opacity"),_normalizedToVisual:IB([0,1])},liftZ:{applyVisual:ov("liftZ"),_normalizedToVisual:{linear:Ku,category:Ku,piecewise:Ku,fixed:Ku}},symbol:{applyVisual:function(t,e,i){var r=this.mapValueToVisual(t);i("symbol",r)},_normalizedToVisual:{linear:Ez,category:Hv,piecewise:function(t,e){var i=HB.call(this,e);return i==null&&(i=Ez.call(this,t)),i},fixed:Ku}},symbolSize:{applyVisual:ov("symbolSize"),_normalizedToVisual:IB([0,1])}},n}();function Odt(n){var t=n.pieceList;n.hasSpecialVisual=!1,N(t,function(e,i){e.originIndex=i,e.visual!=null&&(n.hasSpecialVisual=!0)})}function Ddt(n){var t=n.categories,e=n.categoryMap={},i=n.visual;if(om(t,function(s,a){e[s]=a}),!_t(i)){var r=[];Ht(i)?om(i,function(s,a){var l=e[a];r[l??lw]=s}):r[lw]=i,i=yj(n,r)}for(var o=t.length-1;o>=0;o--)i[o]==null&&(delete e[t[o]],t.pop())}function HM(n,t){var e=n.visual,i=[];Ht(e)?om(e,function(o){i.push(o)}):e!=null&&i.push(e);var r={color:1,symbol:1};!t&&i.length===1&&!r.hasOwnProperty(n.type)&&(i[1]=i[0]),yj(n,i)}function Rb(n){return{applyVisual:function(t,e,i){var r=this.mapValueToVisual(t);i("color",n(e("color"),r))},_normalizedToVisual:IB([0,1])}}function Ez(n){var t=this.option.visual;return t[Math.round(Ui(n,[0,1],[0,t.length-1],!0))]||{}}function ov(n){return function(t,e,i){i(n,this.mapValueToVisual(t))}}function Hv(n){var t=this.option.visual;return t[this.option.loop&&n!==lw?n%t.length:n]}function Ku(){return this.option.visual[0]}function IB(n){return{linear:function(t){return Ui(t,n,this.option.visual,!0)},category:Hv,piecewise:function(t,e){var i=HB.call(this,e);return i==null&&(i=Ui(t,n,this.option.visual,!0)),i},fixed:Ku}}function HB(n){var t=this.option,e=t.pieceList;if(t.hasSpecialVisual){var i=zL.findPieceIndex(n,e),r=e[i];if(r&&r.visual)return r.visual[this.type]}}function yj(n,t){return n.visual=t,n.type==="color"&&(n.parsedVisual=St(t,function(e){var i=us(e);return i||[0,0,0,1]})),t}var Idt={linear:function(n){return Ui(n,this.option.dataExtent,[0,1],!0)},piecewise:function(n){var t=this.option.pieceList,e=zL.findPieceIndex(n,t,!0);if(e!=null)return Ui(e,[0,t.length-1],[0,1],!0)},category:function(n){var t=this.option.categories?this.option.categoryMap[n]:n;return t??lw},fixed:ir};function Bb(n,t,e){return n?t<=e:t<e}var Hdt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.layoutMode={type:"box",ignoreSize:!0},e}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}($e),Fdt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,i,r){if(this.group.removeAll(),!!e.get("show")){var o=this.group,s=e.getModel("textStyle"),a=e.getModel("subtextStyle"),l=e.get("textAlign"),h=ve(e.get("textBaseline"),e.get("textVerticalAlign")),u=new Vi({style:So(s,{text:e.get("text"),fill:s.getTextColor()},{disableBox:!0}),z2:10}),d=u.getBoundingRect(),c=e.get("subtext"),f=new Vi({style:So(a,{text:c,fill:a.getTextColor(),y:d.height+e.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),g=e.get("link"),p=e.get("sublink"),v=e.get("triggerEvent",!0);u.silent=!g&&!v,f.silent=!p&&!v,g&&u.on("click",function(){UC(g,"_"+e.get("target"))}),p&&f.on("click",function(){UC(p,"_"+e.get("subtarget"))}),pe(u).eventData=pe(f).eventData=v?{componentType:"title",componentIndex:e.componentIndex}:null,o.add(u),c&&o.add(f);var m=o.getBoundingRect(),y=e.getBoxLayoutParams();y.width=m.width,y.height=m.height;var b=Na(y,{width:r.getWidth(),height:r.getHeight()},e.get("padding"));l||(l=e.get("left")||e.get("right"),l==="middle"&&(l="center"),l==="right"?b.x+=b.width:l==="center"&&(b.x+=b.width/2)),h||(h=e.get("top")||e.get("bottom"),h==="center"&&(h="middle"),h==="bottom"?b.y+=b.height:h==="middle"&&(b.y+=b.height/2),h=h||"top"),o.x=b.x,o.y=b.y,o.markRedraw();var _={align:l,verticalAlign:h};u.setStyle(_),f.setStyle(_),m=o.getBoundingRect();var w=b.margin,C=e.getItemStyle(["color","opacity"]);C.fill=e.get("backgroundColor");var x=new ci({shape:{x:m.x-w[3],y:m.y-w[0],width:m.width+w[1]+w[3],height:m.height+w[0]+w[2],r:e.get("borderRadius")},style:C,subPixelOptimize:!0,silent:!0});o.add(x)}},t.type="title",t}(Zr);function b7t(n){n.registerComponentModel(Hdt),n.registerComponentView(Fdt)}function NL(n,t){var e=n.mapDimensionsAll("defaultedLabel"),i=e.length;if(i===1){var r=xg(n,t,e[0]);return r!=null?r+"":null}else if(i){for(var o=[],s=0;s<e.length;s++)o.push(xg(n,t,e[s]));return o.join(" ")}}function bj(n,t){var e=n.mapDimensionsAll("defaultedLabel");if(!_t(t))return t+"";for(var i=[],r=0;r<e.length;r++){var o=n.getDimensionIndex(e[r]);o>=0&&i.push(t[o])}return i.join(" ")}var WL=function(n){ct(t,n);function t(e,i,r,o){var s=n.call(this)||this;return s.updateData(e,i,r,o),s}return t.prototype._createSymbol=function(e,i,r,o,s){this.removeAll();var a=Kh(e,-1,-1,2,2,null,s);a.attr({z2:100,culling:!0,scaleX:o[0]/2,scaleY:o[1]/2}),a.drift=zdt,this._symbolType=e,this.add(a)},t.prototype.stopSymbolAnimation=function(e){this.childAt(0).stopAnimation(null,e)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){bg(this.childAt(0))},t.prototype.downplay=function(){_g(this.childAt(0))},t.prototype.setZ=function(e,i){var r=this.childAt(0);r.zlevel=e,r.z=i},t.prototype.setDraggable=function(e,i){var r=this.childAt(0);r.draggable=e,r.cursor=!i&&e?"move":r.cursor},t.prototype.updateData=function(e,i,r,o){this.silent=!1;var s=e.getItemVisual(i,"symbol")||"circle",a=e.hostModel,l=t.getSymbolSize(e,i),h=s!==this._symbolType,u=o&&o.disableAnimation;if(h){var d=e.getItemVisual(i,"symbolKeepAspect");this._createSymbol(s,e,i,l,d)}else{var c=this.childAt(0);c.silent=!1;var f={scaleX:l[0]/2,scaleY:l[1]/2};u?c.attr(f):En(c,f,a,i),dS(c)}if(this._updateCommon(e,i,l,r,o),h){var c=this.childAt(0);if(!u){var f={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:c.style.opacity}};c.scaleX=c.scaleY=0,c.style.opacity=0,nr(c,f,a,i)}}u&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(e,i,r,o,s){var a=this.childAt(0),l=e.hostModel,h,u,d,c,f,g,p,v,m;if(o&&(h=o.emphasisItemStyle,u=o.blurItemStyle,d=o.selectItemStyle,c=o.focus,f=o.blurScope,p=o.labelStatesModels,v=o.hoverScale,m=o.cursorStyle,g=o.emphasisDisabled),!o||e.hasItemOption){var y=o&&o.itemModel?o.itemModel:e.getItemModel(i),b=y.getModel("emphasis");h=b.getModel("itemStyle").getItemStyle(),d=y.getModel(["select","itemStyle"]).getItemStyle(),u=y.getModel(["blur","itemStyle"]).getItemStyle(),c=b.get("focus"),f=b.get("blurScope"),g=b.get("disabled"),p=fp(y),v=b.getShallow("scale"),m=y.getShallow("cursor")}var _=e.getItemVisual(i,"symbolRotate");a.attr("rotation",(_||0)*Math.PI/180||0);var w=R$(e.getItemVisual(i,"symbolOffset"),r);w&&(a.x=w[0],a.y=w[1]),m&&a.attr("cursor",m);var C=e.getItemVisual(i,"style"),x=C.fill;if(a instanceof du){var S=a.style;a.useStyle(ft({image:S.image,x:S.x,y:S.y,width:S.width,height:S.height},C))}else a.__isEmptyBrush?a.useStyle(ft({},C)):a.useStyle(C),a.style.decal=null,a.setColor(x,s&&s.symbolInnerColor),a.style.strokeNoScale=!0;var A=e.getItemVisual(i,"liftZ"),T=this._z2;A!=null?T==null&&(this._z2=a.z2,a.z2+=A):T!=null&&(a.z2=T,this._z2=null);var M=s&&s.useNameLabel;cp(a,p,{labelFetcher:l,labelDataIndex:i,defaultText:R,inheritColor:x,defaultOpacity:C.opacity});function R(B){return M?e.getName(B):NL(e,B)}this._sizeX=r[0]/2,this._sizeY=r[1]/2;var E=a.ensureState("emphasis");E.style=h,a.ensureState("select").style=d,a.ensureState("blur").style=u;var P=v==null||v===!0?Math.max(1.1,3/this._sizeY):isFinite(v)&&v>0?+v:1;E.scaleX=this._sizeX*P,E.scaleY=this._sizeY*P,this.setSymbolScale(1),ic(this,c,f,g)},t.prototype.setSymbolScale=function(e){this.scaleX=this.scaleY=e},t.prototype.fadeOut=function(e,i,r){var o=this.childAt(0),s=pe(this).dataIndex,a=r&&r.animation;if(this.silent=o.silent=!0,r&&r.fadeLabel){var l=o.getTextContent();l&&WC(l,{style:{opacity:0}},i,{dataIndex:s,removeOpt:a,cb:function(){o.removeTextContent()}})}else o.removeTextContent();WC(o,{style:{opacity:0},scaleX:0,scaleY:0},i,{dataIndex:s,cb:e,removeOpt:a})},t.getSymbolSize=function(e,i){return Mst(e.getItemVisual(i,"symbolSize"))},t}(bi);function zdt(n,t){this.parent.drift(n,t)}function FM(n,t,e,i){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(i.isIgnore&&i.isIgnore(e))&&!(i.clipShape&&!i.clipShape.contain(t[0],t[1]))&&n.getItemVisual(e,"symbol")!=="none"}function Lz(n){return n!=null&&!Ht(n)&&(n={isIgnore:n}),n||{}}function Oz(n){var t=n.hostModel,e=t.getModel("emphasis");return{emphasisItemStyle:e.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:e.get("focus"),blurScope:e.get("blurScope"),emphasisDisabled:e.get("disabled"),hoverScale:e.get("scale"),labelStatesModels:fp(t),cursorStyle:t.get("cursor")}}var Ndt=function(){function n(t){this.group=new bi,this._SymbolCtor=t||WL}return n.prototype.updateData=function(t,e){this._progressiveEls=null,e=Lz(e);var i=this.group,r=t.hostModel,o=this._data,s=this._SymbolCtor,a=e.disableAnimation,l=Oz(t),h={disableAnimation:a},u=e.getSymbolPoint||function(d){return t.getItemLayout(d)};o||i.removeAll(),t.diff(o).add(function(d){var c=u(d);if(FM(t,c,d,e)){var f=new s(t,d,l,h);f.setPosition(c),t.setItemGraphicEl(d,f),i.add(f)}}).update(function(d,c){var f=o.getItemGraphicEl(c),g=u(d);if(!FM(t,g,d,e)){i.remove(f);return}var p=t.getItemVisual(d,"symbol")||"circle",v=f&&f.getSymbolType&&f.getSymbolType();if(!f||v&&v!==p)i.remove(f),f=new s(t,d,l,h),f.setPosition(g);else{f.updateData(t,d,l,h);var m={x:g[0],y:g[1]};a?f.attr(m):En(f,m,r)}i.add(f),t.setItemGraphicEl(d,f)}).remove(function(d){var c=o.getItemGraphicEl(d);c&&c.fadeOut(function(){i.remove(c)},r)}).execute(),this._getSymbolPoint=u,this._data=t},n.prototype.updateLayout=function(){var t=this,e=this._data;e&&e.eachItemGraphicEl(function(i,r){var o=t._getSymbolPoint(r);i.setPosition(o),i.markRedraw()})},n.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=Oz(t),this._data=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(t,e,i){this._progressiveEls=[],i=Lz(i);function r(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var o=t.start;o<t.end;o++){var s=e.getItemLayout(o);if(FM(e,s,o,i)){var a=new this._SymbolCtor(e,o,this._seriesScope);a.traverse(r),a.setPosition(s),this.group.add(a),e.setItemGraphicEl(o,a),this._progressiveEls.push(a)}}},n.prototype.eachRendered=function(t){gS(this._progressiveEls||this.group,t)},n.prototype.remove=function(t){var e=this.group,i=this._data;i&&t?i.eachItemGraphicEl(function(r){r.fadeOut(function(){e.remove(r)},i.hostModel)}):e.removeAll()},n}();function VL(n,t){return n.type===t}var Wdt=function(n,t){if(t==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},FB=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.layoutMode={type:"box",ignoreSize:!0},e}return t.prototype.init=function(e,i,r){this.mergeDefaultAndTheme(e,r),e.selected=e.selected||{},this._updateSelector(e)},t.prototype.mergeOption=function(e,i){n.prototype.mergeOption.call(this,e,i),this._updateSelector(e)},t.prototype._updateSelector=function(e){var i=e.selector,r=this.ecModel;i===!0&&(i=e.selector=["all","inverse"]),_t(i)&&N(i,function(o,s){Pt(o)&&(o={type:o}),i[s]=we(o,Wdt(r,o.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var e=this._data;if(e[0]&&this.get("selectedMode")==="single"){for(var i=!1,r=0;r<e.length;r++){var o=e[r].get("name");if(this.isSelected(o)){this.select(o),i=!0;break}}!i&&this.select(e[0].get("name"))}},t.prototype._updateData=function(e){var i=[],r=[];e.eachRawSeries(function(l){var h=l.name;r.push(h);var u;if(l.legendVisualProvider){var d=l.legendVisualProvider,c=d.getAllNames();e.isSeriesFiltered(l)||(r=r.concat(c)),c.length?i=i.concat(c):u=!0}else u=!0;u&&EE(l)&&i.push(l.name)}),this._availableNames=r;var o=this.get("data")||i,s=$t(),a=St(o,function(l){return(Pt(l)||di(l))&&(l={name:l}),s.get(l.name)?null:(s.set(l.name,!0),new ui(l,this,this.ecModel))},this);this._data=Ti(a,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(e){var i=this.option.selected,r=this.get("selectedMode");if(r==="single"){var o=this._data;N(o,function(s){i[s.get("name")]=!1})}i[e]=!0},t.prototype.unSelect=function(e){this.get("selectedMode")!=="single"&&(this.option.selected[e]=!1)},t.prototype.toggleSelected=function(e){var i=this.option.selected;i.hasOwnProperty(e)||(i[e]=!0),this[i[e]?"unSelect":"select"](e)},t.prototype.allSelect=function(){var e=this._data,i=this.option.selected;N(e,function(r){i[r.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var e=this._data,i=this.option.selected;N(e,function(r){var o=r.get("name",!0);i.hasOwnProperty(o)||(i[o]=!0),i[o]=!i[o]})},t.prototype.isSelected=function(e){var i=this.option.selected;return!(i.hasOwnProperty(e)&&!i[e])&&_e(this._availableNames,e)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}($e),Kc=he,zB=N,Pb=bi,_j=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.newlineDisabled=!1,e}return t.prototype.init=function(){this.group.add(this._contentGroup=new Pb),this.group.add(this._selectorGroup=new Pb),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(e,i,r){var o=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!e.get("show",!0)){var s=e.get("align"),a=e.get("orient");(!s||s==="auto")&&(s=e.get("left")==="right"&&a==="vertical"?"right":"left");var l=e.get("selector",!0),h=e.get("selectorPosition",!0);l&&(!h||h==="auto")&&(h=a==="horizontal"?"end":"start"),this.renderInner(s,e,i,r,l,a,h);var u=e.getBoxLayoutParams(),d={width:r.getWidth(),height:r.getHeight()},c=e.get("padding"),f=Na(u,d,c),g=this.layoutInner(e,s,f,o,l,h),p=Na(Gt({width:g.width,height:g.height},u),d,c);this.group.x=p.x-g.x,this.group.y=p.y-g.y,this.group.markRedraw(),this.group.add(this._backgroundEl=uj(g,e))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(e,i,r,o,s,a,l){var h=this.getContentGroup(),u=$t(),d=i.get("selectedMode"),c=[];r.eachRawSeries(function(f){!f.get("legendHoverLink")&&c.push(f.id)}),zB(i.getData(),function(f,g){var p=f.get("name");if(!this.newlineDisabled&&(p===""||p===`
`)){var v=new Pb;v.newline=!0,h.add(v);return}var m=r.getSeriesByName(p)[0];if(!u.get(p))if(m){var y=m.getData(),b=y.getVisual("legendLineStyle")||{},_=y.getVisual("legendIcon"),w=y.getVisual("style"),C=this._createItem(m,p,g,f,i,e,b,w,_,d,o);C.on("click",Kc(Dz,p,null,o,c)).on("mouseover",Kc(NB,m.name,null,o,c)).on("mouseout",Kc(WB,m.name,null,o,c)),r.ssr&&C.eachChild(function(x){var S=pe(x);S.seriesIndex=m.seriesIndex,S.dataIndex=g,S.ssrType="legend"}),u.set(p,!0)}else r.eachRawSeries(function(x){if(!u.get(p)&&x.legendVisualProvider){var S=x.legendVisualProvider;if(!S.containName(p))return;var A=S.indexOfName(p),T=S.getItemVisual(A,"style"),M=S.getItemVisual(A,"legendIcon"),R=us(T.fill);R&&R[3]===0&&(R[3]=.2,T=ft(ft({},T),{fill:Ll(R,"rgba")}));var E=this._createItem(x,p,g,f,i,e,{},T,M,d,o);E.on("click",Kc(Dz,null,p,o,c)).on("mouseover",Kc(NB,null,p,o,c)).on("mouseout",Kc(WB,null,p,o,c)),r.ssr&&E.eachChild(function(P){var B=pe(P);B.seriesIndex=x.seriesIndex,B.dataIndex=g,B.ssrType="legend"}),u.set(p,!0)}},this)},this),s&&this._createSelector(s,i,o,a,l)},t.prototype._createSelector=function(e,i,r,o,s){var a=this.getSelectorGroup();zB(e,function(h){var u=h.type,d=new Vi({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){r.dispatchAction({type:u==="all"?"legendAllSelect":"legendInverseSelect",legendId:i.id})}});a.add(d);var c=i.getModel("selectorLabel"),f=i.getModel(["emphasis","selectorLabel"]);cp(d,{normal:c,emphasis:f},{defaultText:h.title}),FC(d)})},t.prototype._createItem=function(e,i,r,o,s,a,l,h,u,d,c){var f=e.visualDrawType,g=s.get("itemWidth"),p=s.get("itemHeight"),v=s.isSelected(i),m=o.get("symbolRotate"),y=o.get("symbolKeepAspect"),b=o.get("icon");u=b||u||"roundRect";var _=Vdt(u,o,l,h,f,v,c),w=new Pb,C=o.getModel("textStyle");if(jt(e.getLegendIcon)&&(!b||b==="inherit"))w.add(e.getLegendIcon({itemWidth:g,itemHeight:p,icon:u,iconRotate:m,itemStyle:_.itemStyle,lineStyle:_.lineStyle,symbolKeepAspect:y}));else{var x=b==="inherit"&&e.getData().getVisual("symbol")?m==="inherit"?e.getData().getVisual("symbolRotate"):m:0;w.add(Gdt({itemWidth:g,itemHeight:p,icon:u,iconRotate:x,itemStyle:_.itemStyle,symbolKeepAspect:y}))}var S=a==="left"?g+5:-5,A=a,T=s.get("formatter"),M=i;Pt(T)&&T?M=T.replace("{name}",i??""):jt(T)&&(M=T(i));var R=v?C.getTextColor():o.get("inactiveColor");w.add(new Vi({style:So(C,{text:M,x:S,y:p/2,fill:R,align:A,verticalAlign:"middle"},{inheritColor:R})}));var E=new ci({shape:w.getBoundingRect(),style:{fill:"transparent"}}),P=o.getModel("tooltip");return P.get("show")&&hy({el:E,componentModel:s,itemName:i,itemTooltipOption:P.option}),w.add(E),w.eachChild(function(B){B.silent=!0}),E.silent=!d,this.getContentGroup().add(w),FC(w),w.__legendDataIndex=r,w},t.prototype.layoutInner=function(e,i,r,o,s,a){var l=this.getContentGroup(),h=this.getSelectorGroup();$f(e.get("orient"),l,e.get("itemGap"),r.width,r.height);var u=l.getBoundingRect(),d=[-u.x,-u.y];if(h.markRedraw(),l.markRedraw(),s){$f("horizontal",h,e.get("selectorItemGap",!0));var c=h.getBoundingRect(),f=[-c.x,-c.y],g=e.get("selectorButtonGap",!0),p=e.getOrient().index,v=p===0?"width":"height",m=p===0?"height":"width",y=p===0?"y":"x";a==="end"?f[p]+=u[v]+g:d[p]+=c[v]+g,f[1-p]+=u[m]/2-c[m]/2,h.x=f[0],h.y=f[1],l.x=d[0],l.y=d[1];var b={x:0,y:0};return b[v]=u[v]+g+c[v],b[m]=Math.max(u[m],c[m]),b[y]=Math.min(0,c[y]+f[1-p]),b}else return l.x=d[0],l.y=d[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(Zr);function Vdt(n,t,e,i,r,o,s){function a(v,m){v.lineWidth==="auto"&&(v.lineWidth=m.lineWidth>0?2:0),zB(v,function(y,b){v[b]==="inherit"&&(v[b]=m[b])})}var l=t.getModel("itemStyle"),h=l.getItemStyle(),u=n.lastIndexOf("empty",0)===0?"fill":"stroke",d=l.getShallow("decal");h.decal=!d||d==="inherit"?i.decal:QC(d,s),h.fill==="inherit"&&(h.fill=i[r]),h.stroke==="inherit"&&(h.stroke=i[u]),h.opacity==="inherit"&&(h.opacity=(r==="fill"?i:e).opacity),a(h,i);var c=t.getModel("lineStyle"),f=c.getLineStyle();if(a(f,e),h.fill==="auto"&&(h.fill=i.fill),h.stroke==="auto"&&(h.stroke=i.fill),f.stroke==="auto"&&(f.stroke=i.fill),!o){var g=t.get("inactiveBorderWidth"),p=h[u];h.lineWidth=g==="auto"?i.lineWidth>0&&p?2:0:h.lineWidth,h.fill=t.get("inactiveColor"),h.stroke=t.get("inactiveBorderColor"),f.stroke=c.get("inactiveColor"),f.lineWidth=c.get("inactiveWidth")}return{itemStyle:h,lineStyle:f}}function Gdt(n){var t=n.icon||"roundRect",e=Kh(t,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return e.setStyle(n.itemStyle),e.rotation=(n.iconRotate||0)*Math.PI/180,e.setOrigin([n.itemWidth/2,n.itemHeight/2]),t.indexOf("empty")>-1&&(e.style.stroke=e.style.fill,e.style.fill="#fff",e.style.lineWidth=2),e}function Dz(n,t,e,i){WB(n,t,e,i),e.dispatchAction({type:"legendToggleSelect",name:n??t}),NB(n,t,e,i)}function Cj(n){for(var t=n.getZr().storage.getDisplayList(),e,i=0,r=t.length;i<r&&!(e=t[i].states.emphasis);)i++;return e&&e.hoverLayer}function NB(n,t,e,i){Cj(e)||e.dispatchAction({type:"highlight",seriesName:n,name:t,excludeSeriesId:i})}function WB(n,t,e,i){Cj(e)||e.dispatchAction({type:"downplay",seriesName:n,name:t,excludeSeriesId:i})}function $dt(n){var t=n.findComponents({mainType:"legend"});t&&t.length&&n.filterSeries(function(e){for(var i=0;i<t.length;i++)if(!t[i].isSelected(e.name))return!1;return!0})}function sv(n,t,e){var i=n==="allSelect"||n==="inverseSelect",r={},o=[];e.eachComponent({mainType:"legend",query:t},function(a){i?a[n]():a[n](t.name),Iz(a,r),o.push(a.componentIndex)});var s={};return e.eachComponent("legend",function(a){N(r,function(l,h){a[l?"select":"unSelect"](h)}),Iz(a,s)}),i?{selected:s,legendIndex:o}:{name:t.name,selected:s}}function Iz(n,t){var e=t||{};return N(n.getData(),function(i){var r=i.get("name");if(!(r===`
`||r==="")){var o=n.isSelected(r);tc(e,r)?e[r]=e[r]&&o:e[r]=o}}),e}function jdt(n){n.registerAction("legendToggleSelect","legendselectchanged",he(sv,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",he(sv,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",he(sv,"inverseSelect")),n.registerAction("legendSelect","legendselected",he(sv,"select")),n.registerAction("legendUnSelect","legendunselected",he(sv,"unSelect"))}function wj(n){n.registerComponentModel(FB),n.registerComponentView(_j),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,$dt),n.registerSubTypeDefaulter("legend",function(){return"plain"}),jdt(n)}var Udt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.setScrollDataIndex=function(e){this.option.scrollDataIndex=e},t.prototype.init=function(e,i,r){var o=cy(e);n.prototype.init.call(this,e,i,r),Hz(this,e,o)},t.prototype.mergeOption=function(e,i){n.prototype.mergeOption.call(this,e,i),Hz(this,this.option,e)},t.type="legend.scroll",t.defaultOption=vS(FB.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(FB);function Hz(n,t,e){var i=n.getOrient(),r=[1,1];r[i.index]=0,wg(t,e,{type:"box",ignoreSize:!!r})}var Fz=bi,zM=["width","height"],NM=["x","y"],Xdt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.newlineDisabled=!0,e._currentIndex=0,e}return t.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new Fz),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new Fz)},t.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(e,i,r,o,s,a,l){var h=this;n.prototype.renderInner.call(this,e,i,r,o,s,a,l);var u=this._controllerGroup,d=i.get("pageIconSize",!0),c=_t(d)?d:[d,d];g("pagePrev",0);var f=i.getModel("pageTextStyle");u.add(new Vi({name:"pageText",style:{text:"xx/xx",fill:f.getTextColor(),font:f.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),g("pageNext",1);function g(p,v){var m=p+"DataIndex",y=fS(i.get("pageIcons",!0)[i.getOrient().name][v],{onclick:zt(h._pageGo,h,m,i,o)},{x:-c[0]/2,y:-c[1]/2,width:c[0],height:c[1]});y.name=p,u.add(y)}},t.prototype.layoutInner=function(e,i,r,o,s,a){var l=this.getSelectorGroup(),h=e.getOrient().index,u=zM[h],d=NM[h],c=zM[1-h],f=NM[1-h];s&&$f("horizontal",l,e.get("selectorItemGap",!0));var g=e.get("selectorButtonGap",!0),p=l.getBoundingRect(),v=[-p.x,-p.y],m=ne(r);s&&(m[u]=r[u]-p[u]-g);var y=this._layoutContentAndController(e,o,m,h,u,c,f,d);if(s){if(a==="end")v[h]+=y[u]+g;else{var b=p[u]+g;v[h]-=b,y[d]-=b}y[u]+=p[u]+g,v[1-h]+=y[f]+y[c]/2-p[c]/2,y[c]=Math.max(y[c],p[c]),y[f]=Math.min(y[f],p[f]+v[1-h]),l.x=v[0],l.y=v[1],l.markRedraw()}return y},t.prototype._layoutContentAndController=function(e,i,r,o,s,a,l,h){var u=this.getContentGroup(),d=this._containerGroup,c=this._controllerGroup;$f(e.get("orient"),u,e.get("itemGap"),o?r.width:null,o?null:r.height),$f("horizontal",c,e.get("pageButtonItemGap",!0));var f=u.getBoundingRect(),g=c.getBoundingRect(),p=this._showController=f[s]>r[s],v=[-f.x,-f.y];i||(v[o]=u[h]);var m=[0,0],y=[-g.x,-g.y],b=ve(e.get("pageButtonGap",!0),e.get("itemGap",!0));if(p){var _=e.get("pageButtonPosition",!0);_==="end"?y[o]+=r[s]-g[s]:m[o]+=g[s]+b}y[1-o]+=f[a]/2-g[a]/2,u.setPosition(v),d.setPosition(m),c.setPosition(y);var w={x:0,y:0};if(w[s]=p?r[s]:f[s],w[a]=Math.max(f[a],g[a]),w[l]=Math.min(0,g[l]+y[1-o]),d.__rectSize=r[s],p){var C={x:0,y:0};C[s]=Math.max(r[s]-g[s]-b,0),C[a]=w[a],d.setClipPath(new ci({shape:C})),d.__rectSize=C[s]}else c.eachChild(function(S){S.attr({invisible:!0,silent:!0})});var x=this._getPageInfo(e);return x.pageIndex!=null&&En(u,{x:x.contentPosition[0],y:x.contentPosition[1]},p?e:null),this._updatePageInfoView(e,x),w},t.prototype._pageGo=function(e,i,r){var o=this._getPageInfo(i)[e];o!=null&&r.dispatchAction({type:"legendScroll",scrollDataIndex:o,legendId:i.id})},t.prototype._updatePageInfoView=function(e,i){var r=this._controllerGroup;N(["pagePrev","pageNext"],function(u){var d=u+"DataIndex",c=i[d]!=null,f=r.childOfName(u);f&&(f.setStyle("fill",c?e.get("pageIconColor",!0):e.get("pageIconInactiveColor",!0)),f.cursor=c?"pointer":"default")});var o=r.childOfName("pageText"),s=e.get("pageFormatter"),a=i.pageIndex,l=a!=null?a+1:0,h=i.pageCount;o&&s&&o.setStyle("text",Pt(s)?s.replace("{current}",l==null?"":l+"").replace("{total}",h==null?"":h+""):s({current:l,total:h}))},t.prototype._getPageInfo=function(e){var i=e.get("scrollDataIndex",!0),r=this.getContentGroup(),o=this._containerGroup.__rectSize,s=e.getOrient().index,a=zM[s],l=NM[s],h=this._findTargetItemIndex(i),u=r.children(),d=u[h],c=u.length,f=c?1:0,g={contentPosition:[r.x,r.y],pageCount:f,pageIndex:f-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!d)return g;var p=_(d);g.contentPosition[s]=-p.s;for(var v=h+1,m=p,y=p,b=null;v<=c;++v)b=_(u[v]),(!b&&y.e>m.s+o||b&&!w(b,m.s))&&(y.i>m.i?m=y:m=b,m&&(g.pageNextDataIndex==null&&(g.pageNextDataIndex=m.i),++g.pageCount)),y=b;for(var v=h-1,m=p,y=p,b=null;v>=-1;--v)b=_(u[v]),(!b||!w(y,b.s))&&m.i<y.i&&(y=m,g.pagePrevDataIndex==null&&(g.pagePrevDataIndex=m.i),++g.pageCount,++g.pageIndex),m=b;return g;function _(C){if(C){var x=C.getBoundingRect(),S=x[l]+C[l];return{s:S,e:S+x[a],i:C.__legendDataIndex}}}function w(C,x){return C.e>=x&&C.s<=x+o}},t.prototype._findTargetItemIndex=function(e){if(!this._showController)return 0;var i,r=this.getContentGroup(),o;return r.eachChild(function(s,a){var l=s.__legendDataIndex;o==null&&l!=null&&(o=a),l===e&&(i=a)}),i??o},t.type="legend.scroll",t}(_j);function Ydt(n){n.registerAction("legendScroll","legendscroll",function(t,e){var i=t.scrollDataIndex;i!=null&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},function(r){r.setScrollDataIndex(i)})})}function Kdt(n){Xs(wj),n.registerComponentModel(Udt),n.registerComponentView(Xdt),Ydt(n)}function _7t(n){Xs(wj),Xs(Kdt)}var qdt=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="dataZoom.inside",t.defaultOption=vS(rm.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(rm),GL=Ke();function Zdt(n,t,e){GL(n).coordSysRecordMap.each(function(i){var r=i.dataZoomInfoMap.get(t.uid);r&&(r.getRange=e)})}function Jdt(n,t){for(var e=GL(n).coordSysRecordMap,i=e.keys(),r=0;r<i.length;r++){var o=i[r],s=e.get(o),a=s.dataZoomInfoMap;if(a){var l=t.uid,h=a.get(l);h&&(a.removeKey(l),a.keys().length||xj(e,s))}}}function xj(n,t){if(t){n.removeKey(t.model.uid);var e=t.controller;e&&e.dispose()}}function Qdt(n,t){var e={model:t,containsPoint:he(ect,t),dispatchAction:he(tct,n),dataZoomInfoMap:null,controller:null},i=e.controller=new Y7(n.getZr());return N(["pan","zoom","scrollMove"],function(r){i.on(r,function(o){var s=[];e.dataZoomInfoMap.each(function(a){if(o.isAvailableBehavior(a.model.option)){var l=(a.getRange||{})[r],h=l&&l(a.dzReferCoordSysInfo,e.model.mainType,e.controller,o);!a.model.get("disabled",!0)&&h&&s.push({dataZoomId:a.model.id,start:h[0],end:h[1]})}}),s.length&&e.dispatchAction(s)})}),e}function tct(n,t){n.isDisposed()||n.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function ect(n,t,e,i){return n.coordinateSystem.containPoint([e,i])}function ict(n){var t,e="type_",i={type_true:2,type_move:1,type_false:0,type_undefined:-1},r=!0;return n.each(function(o){var s=o.model,a=s.get("disabled",!0)?!1:s.get("zoomLock",!0)?"move":!0;i[e+a]>i[e+t]&&(t=a),r=r&&s.get("preventDefaultMouseMove",!0)}),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!r}}}function nct(n){n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,function(t,e){var i=GL(e),r=i.coordSysRecordMap||(i.coordSysRecordMap=$t());r.each(function(o){o.dataZoomInfoMap=null}),t.eachComponent({mainType:"dataZoom",subType:"inside"},function(o){var s=aj(o);N(s.infoList,function(a){var l=a.model.uid,h=r.get(l)||r.set(l,Qdt(e,a.model)),u=h.dataZoomInfoMap||(h.dataZoomInfoMap=$t());u.set(o.uid,{dzReferCoordSysInfo:a,model:o,getRange:null})})}),r.each(function(o){var s=o.controller,a,l=o.dataZoomInfoMap;if(l){var h=l.keys()[0];h!=null&&(a=l.get(h))}if(!a){xj(r,o);return}var u=ict(l);s.enable(u.controlType,u.opt),s.setPointerChecker(o.containsPoint),SS(o,"dispatchAction",a.model.get("throttle",!0),"fixRate")})})}var rct=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type="dataZoom.inside",e}return t.prototype.render=function(e,i,r){if(n.prototype.render.apply(this,arguments),e.noTarget()){this._clear();return}this.range=e.getPercentRange(),Zdt(r,e,{pan:zt(WM.pan,this),zoom:zt(WM.zoom,this),scrollMove:zt(WM.scrollMove,this)})},t.prototype.dispose=function(){this._clear(),n.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){Jdt(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(OL),WM={zoom:function(n,t,e,i){var r=this.range,o=r.slice(),s=n.axisModels[0];if(s){var a=VM[t](null,[i.originX,i.originY],s,e,n),l=(a.signal>0?a.pixelStart+a.pixelLength-a.pixel:a.pixel-a.pixelStart)/a.pixelLength*(o[1]-o[0])+o[0],h=Math.max(1/i.scale,0);o[0]=(o[0]-l)*h+l,o[1]=(o[1]-l)*h+l;var u=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(gy(0,o,[0,100],0,u.minSpan,u.maxSpan),this.range=o,r[0]!==o[0]||r[1]!==o[1])return o}},pan:zz(function(n,t,e,i,r,o){var s=VM[i]([o.oldX,o.oldY],[o.newX,o.newY],t,r,e);return s.signal*(n[1]-n[0])*s.pixel/s.pixelLength}),scrollMove:zz(function(n,t,e,i,r,o){var s=VM[i]([0,0],[o.scrollDelta,o.scrollDelta],t,r,e);return s.signal*(n[1]-n[0])*o.scrollDelta})};function zz(n){return function(t,e,i,r){var o=this.range,s=o.slice(),a=t.axisModels[0];if(a){var l=n(s,a,t,e,i,r);if(gy(l,s,[0,100],"all"),this.range=s,o[0]!==s[0]||o[1]!==s[1])return s}}}var VM={grid:function(n,t,e,i,r){var o=e.axis,s={},a=r.model.coordinateSystem.getRect();return n=n||[0,0],o.dim==="x"?(s.pixel=t[0]-n[0],s.pixelLength=a.width,s.pixelStart=a.x,s.signal=o.inverse?1:-1):(s.pixel=t[1]-n[1],s.pixelLength=a.height,s.pixelStart=a.y,s.signal=o.inverse?-1:1),s},polar:function(n,t,e,i,r){var o=e.axis,s={},a=r.model.coordinateSystem,l=a.getRadiusAxis().getExtent(),h=a.getAngleAxis().getExtent();return n=n?a.pointToCoord(n):[0,0],t=a.pointToCoord(t),e.mainType==="radiusAxis"?(s.pixel=t[0]-n[0],s.pixelLength=l[1]-l[0],s.pixelStart=l[0],s.signal=o.inverse?1:-1):(s.pixel=t[1]-n[1],s.pixelLength=h[1]-h[0],s.pixelStart=h[0],s.signal=o.inverse?-1:1),s},singleAxis:function(n,t,e,i,r){var o=e.axis,s=r.model.coordinateSystem.getRect(),a={};return n=n||[0,0],o.orient==="horizontal"?(a.pixel=t[0]-n[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=o.inverse?1:-1):(a.pixel=t[1]-n[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=o.inverse?-1:1),a}};function oct(n){DL(n),n.registerComponentModel(qdt),n.registerComponentView(rct),nct(n)}var sct=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=vS(rm.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),t}(rm),av=ci,Nz=7,act=1,GM=30,lct=7,lv="horizontal",Wz="vertical",hct=5,uct=["line","bar","candlestick","scatter"],dct={easing:"cubicOut",duration:100,delay:0},cct=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e._displayables={},e}return t.prototype.init=function(e,i){this.api=i,this._onBrush=zt(this._onBrush,this),this._onBrushEnd=zt(this._onBrushEnd,this)},t.prototype.render=function(e,i,r,o){if(n.prototype.render.apply(this,arguments),SS(this,"_dispatchZoomAction",e.get("throttle"),"fixRate"),this._orient=e.getOrient(),e.get("show")===!1){this.group.removeAll();return}if(e.noTarget()){this._clear(),this.group.removeAll();return}(!o||o.type!=="dataZoom"||o.from!==this.uid)&&this._buildView(),this._updateView()},t.prototype.dispose=function(){this._clear(),n.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){YC(this,"_dispatchZoomAction");var e=this.api.getZr();e.off("mousemove",this._onBrush),e.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var e=this.group;e.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var i=this._displayables.sliderGroup=new bi;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),e.add(i),this._positionGroup()},t.prototype._resetLocation=function(){var e=this.dataZoomModel,i=this.api,r=e.get("brushSelect"),o=r?lct:0,s=this._findCoordRect(),a={width:i.getWidth(),height:i.getHeight()},l=this._orient===lv?{right:a.width-s.x-s.width,top:a.height-GM-Nz-o,width:s.width,height:GM}:{right:Nz,top:s.y,width:GM,height:s.height},h=cy(e.option);N(["right","top","width","height"],function(d){h[d]==="ph"&&(h[d]=l[d])});var u=Na(h,a);this._location={x:u.x,y:u.y},this._size=[u.width,u.height],this._orient===Wz&&this._size.reverse()},t.prototype._positionGroup=function(){var e=this.group,i=this._location,r=this._orient,o=this.dataZoomModel.getFirstTargetAxisModel(),s=o&&o.get("inverse"),a=this._displayables.sliderGroup,l=(this._dataShadowInfo||{}).otherAxisInverse;a.attr(r===lv&&!s?{scaleY:l?1:-1,scaleX:1}:r===lv&&s?{scaleY:l?1:-1,scaleX:-1}:r===Wz&&!s?{scaleY:l?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:l?-1:1,scaleX:-1,rotation:Math.PI/2});var h=e.getBoundingRect([a]);e.x=i.x-h.x,e.y=i.y-h.y,e.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var e=this.dataZoomModel,i=this._size,r=this._displayables.sliderGroup,o=e.get("brushSelect");r.add(new av({silent:!0,shape:{x:0,y:0,width:i[0],height:i[1]},style:{fill:e.get("backgroundColor")},z2:-40}));var s=new av({shape:{x:0,y:0,width:i[0],height:i[1]},style:{fill:"transparent"},z2:0,onclick:zt(this._onClickPanel,this)}),a=this.api.getZr();o?(s.on("mousedown",this._onBrushStart,this),s.cursor="crosshair",a.on("mousemove",this._onBrush),a.on("mouseup",this._onBrushEnd)):(a.off("mousemove",this._onBrush),a.off("mouseup",this._onBrushEnd)),r.add(s)},t.prototype._renderDataShadow=function(){var e=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!e)return;var i=this._size,r=this._shadowSize||[],o=e.series,s=o.getRawData(),a=o.getShadowDim&&o.getShadowDim(),l=a&&s.getDimensionInfo(a)?o.getShadowDim():e.otherDim;if(l==null)return;var h=this._shadowPolygonPts,u=this._shadowPolylinePts;if(s!==this._shadowData||l!==this._shadowDim||i[0]!==r[0]||i[1]!==r[1]){var d=s.getDataExtent(l),c=(d[1]-d[0])*.3;d=[d[0]-c,d[1]+c];var f=[0,i[1]],g=[0,i[0]],p=[[i[0],0],[0,0]],v=[],m=g[1]/(s.count()-1),y=0,b=Math.round(s.count()/i[0]),_;s.each([l],function(A,T){if(b>0&&T%b){y+=m;return}var M=A==null||isNaN(A)||A==="",R=M?0:Ui(A,d,f,!0);M&&!_&&T?(p.push([p[p.length-1][0],0]),v.push([v[v.length-1][0],0])):!M&&_&&(p.push([y,0]),v.push([y,0])),p.push([y,R]),v.push([y,R]),y+=m,_=M}),h=this._shadowPolygonPts=p,u=this._shadowPolylinePts=v}this._shadowData=s,this._shadowDim=l,this._shadowSize=[i[0],i[1]];var w=this.dataZoomModel;function C(A){var T=w.getModel(A?"selectedDataBackground":"dataBackground"),M=new bi,R=new Ac({shape:{points:h},segmentIgnoreThreshold:1,style:T.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),E=new Tc({shape:{points:u},segmentIgnoreThreshold:1,style:T.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return M.add(R),M.add(E),M}for(var x=0;x<3;x++){var S=C(x===1);this._displayables.sliderGroup.add(S),this._displayables.dataShadowSegs.push(S)}},t.prototype._prepareDataShadowInfo=function(){var e=this.dataZoomModel,i=e.get("showDataShadow");if(i!==!1){var r,o=this.ecModel;return e.eachTargetAxis(function(s,a){var l=e.getAxisProxy(s,a).getTargetSeriesModels();N(l,function(h){if(!r&&!(i!==!0&&_e(uct,h.get("type"))<0)){var u=o.getComponent(Eh(s),a).axis,d=fct(s),c,f=h.coordinateSystem;d!=null&&f.getOtherAxis&&(c=f.getOtherAxis(u).inverse),d=h.getData().mapDimension(d),r={thisAxis:u,series:h,thisDim:s,otherDim:d,otherAxisInverse:c}}},this)},this),r}},t.prototype._renderHandle=function(){var e=this.group,i=this._displayables,r=i.handles=[null,null],o=i.handleLabels=[null,null],s=this._displayables.sliderGroup,a=this._size,l=this.dataZoomModel,h=this.api,u=l.get("borderRadius")||0,d=l.get("brushSelect"),c=i.filler=new av({silent:d,style:{fill:l.get("fillerColor")},textConfig:{position:"inside"}});s.add(c),s.add(new av({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:a[0],height:a[1],r:u},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:act,fill:"rgba(0,0,0,0)"}})),N([0,1],function(b){var _=l.get("handleIcon");!qC[_]&&_.indexOf("path://")<0&&_.indexOf("image://")<0&&(_="path://"+_);var w=Kh(_,-1,0,2,2,null,!0);w.attr({cursor:Vz(this._orient),draggable:!0,drift:zt(this._onDragMove,this,b),ondragend:zt(this._onDragEnd,this),onmouseover:zt(this._showDataInfo,this,!0),onmouseout:zt(this._showDataInfo,this,!1),z2:5});var C=w.getBoundingRect(),x=l.get("handleSize");this._handleHeight=Jt(x,this._size[1]),this._handleWidth=C.width/C.height*this._handleHeight,w.setStyle(l.getModel("handleStyle").getItemStyle()),w.style.strokeNoScale=!0,w.rectHover=!0,w.ensureState("emphasis").style=l.getModel(["emphasis","handleStyle"]).getItemStyle(),FC(w);var S=l.get("handleColor");S!=null&&(w.style.fill=S),s.add(r[b]=w);var A=l.getModel("textStyle"),T=l.get("handleLabel")||{},M=T.show||!1;e.add(o[b]=new Vi({silent:!0,invisible:!M,style:So(A,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:A.getTextColor(),font:A.getFont()}),z2:10}))},this);var f=c;if(d){var g=Jt(l.get("moveHandleSize"),a[1]),p=i.moveHandle=new ci({style:l.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:a[1]-.5,height:g}}),v=g*.8,m=i.moveHandleIcon=Kh(l.get("moveHandleIcon"),-v/2,-v/2,v,v,"#fff",!0);m.silent=!0,m.y=a[1]+g/2-.5,p.ensureState("emphasis").style=l.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var y=Math.min(a[1]/2,Math.max(g,10));f=i.moveZone=new ci({invisible:!0,shape:{y:a[1]-y,height:g+y}}),f.on("mouseover",function(){h.enterEmphasis(p)}).on("mouseout",function(){h.leaveEmphasis(p)}),s.add(p),s.add(m),s.add(f)}f.attr({draggable:!0,cursor:Vz(this._orient),drift:zt(this._onDragMove,this,"all"),ondragstart:zt(this._showDataInfo,this,!0),ondragend:zt(this._onDragEnd,this),onmouseover:zt(this._showDataInfo,this,!0),onmouseout:zt(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var e=this._range=this.dataZoomModel.getPercentRange(),i=this._getViewExtent();this._handleEnds=[Ui(e[0],[0,100],i,!0),Ui(e[1],[0,100],i,!0)]},t.prototype._updateInterval=function(e,i){var r=this.dataZoomModel,o=this._handleEnds,s=this._getViewExtent(),a=r.findRepresentativeAxisProxy().getMinMaxSpan(),l=[0,100];gy(i,o,s,r.get("zoomLock")?"all":e,a.minSpan!=null?Ui(a.minSpan,l,s,!0):null,a.maxSpan!=null?Ui(a.maxSpan,l,s,!0):null);var h=this._range,u=this._range=Ev([Ui(o[0],s,l,!0),Ui(o[1],s,l,!0)]);return!h||h[0]!==u[0]||h[1]!==u[1]},t.prototype._updateView=function(e){var i=this._displayables,r=this._handleEnds,o=Ev(r.slice()),s=this._size;N([0,1],function(f){var g=i.handles[f],p=this._handleHeight;g.attr({scaleX:p/2,scaleY:p/2,x:r[f]+(f?-1:1),y:s[1]/2-p/2})},this),i.filler.setShape({x:o[0],y:0,width:o[1]-o[0],height:s[1]});var a={x:o[0],width:o[1]-o[0]};i.moveHandle&&(i.moveHandle.setShape(a),i.moveZone.setShape(a),i.moveZone.getBoundingRect(),i.moveHandleIcon&&i.moveHandleIcon.attr("x",a.x+a.width/2));for(var l=i.dataShadowSegs,h=[0,o[0],o[1],s[0]],u=0;u<l.length;u++){var d=l[u],c=d.getClipPath();c||(c=new ci,d.setClipPath(c)),c.setShape({x:h[u],y:0,width:h[u+1]-h[u],height:s[1]})}this._updateDataInfo(e)},t.prototype._updateDataInfo=function(e){var i=this.dataZoomModel,r=this._displayables,o=r.handleLabels,s=this._orient,a=["",""];if(i.get("showDetail")){var l=i.findRepresentativeAxisProxy();if(l){var h=l.getAxisModel().axis,u=this._range,d=e?l.calculateDataWindow({start:u[0],end:u[1]}).valueWindow:l.getDataValueWindow();a=[this._formatLabel(d[0],h),this._formatLabel(d[1],h)]}}var c=Ev(this._handleEnds.slice());f.call(this,0),f.call(this,1);function f(g){var p=cS(r.handles[g].parent,this.group),v=$E(g===0?"right":"left",p),m=this._handleWidth/2+hct,y=Cg([c[g]+(g===0?-m:m),this._size[1]/2],p);o[g].setStyle({x:y[0],y:y[1],verticalAlign:s===lv?"middle":v,align:s===lv?v:"center",text:a[g]})}},t.prototype._formatLabel=function(e,i){var r=this.dataZoomModel,o=r.get("labelFormatter"),s=r.get("labelPrecision");(s==null||s==="auto")&&(s=i.getPixelPrecision());var a=e==null||isNaN(e)?"":i.type==="category"||i.type==="time"?i.scale.getLabel({value:Math.round(e)}):e.toFixed(Math.min(s,20));return jt(o)?o(e,a):Pt(o)?o.replace("{value}",a):a},t.prototype._showDataInfo=function(e){var i=this.dataZoomModel.get("handleLabel")||{},r=i.show||!1,o=this.dataZoomModel.getModel(["emphasis","handleLabel"]),s=o.get("show")||!1,a=e||this._dragging?s:r,l=this._displayables,h=l.handleLabels;h[0].attr("invisible",!a),h[1].attr("invisible",!a),l.moveHandle&&this.api[a?"enterEmphasis":"leaveEmphasis"](l.moveHandle,1)},t.prototype._onDragMove=function(e,i,r,o){this._dragging=!0,vg(o.event);var s=this._displayables.sliderGroup.getLocalTransform(),a=Cg([i,r],s,!0),l=this._updateInterval(e,a[0]),h=this.dataZoomModel.get("realtime");this._updateView(!h),l&&h&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var e=this.dataZoomModel.get("realtime");!e&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(e){var i=this._size,r=this._displayables.sliderGroup.transformCoordToLocal(e.offsetX,e.offsetY);if(!(r[0]<0||r[0]>i[0]||r[1]<0||r[1]>i[1])){var o=this._handleEnds,s=(o[0]+o[1])/2,a=this._updateInterval("all",r[0]-s);this._updateView(),a&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(e){var i=e.offsetX,r=e.offsetY;this._brushStart=new Vt(i,r),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(e){if(this._brushing){var i=this._displayables.brushRect;if(this._brushing=!1,!!i){i.attr("ignore",!0);var r=i.shape,o=+new Date;if(!(o-this._brushStartTime<200&&Math.abs(r.width)<5)){var s=this._getViewExtent(),a=[0,100];this._range=Ev([Ui(r.x,s,a,!0),Ui(r.x+r.width,s,a,!0)]),this._handleEnds=[r.x,r.x+r.width],this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(e){this._brushing&&(vg(e.event),this._updateBrushRect(e.offsetX,e.offsetY))},t.prototype._updateBrushRect=function(e,i){var r=this._displayables,o=this.dataZoomModel,s=r.brushRect;s||(s=r.brushRect=new av({silent:!0,style:o.getModel("brushStyle").getItemStyle()}),r.sliderGroup.add(s)),s.attr("ignore",!1);var a=this._brushStart,l=this._displayables.sliderGroup,h=l.transformCoordToLocal(e,i),u=l.transformCoordToLocal(a.x,a.y),d=this._size;h[0]=Math.max(Math.min(d[0],h[0]),0),s.setShape({x:u[0],y:0,width:h[0]-u[0],height:d[1]})},t.prototype._dispatchZoomAction=function(e){var i=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:e?dct:null,start:i[0],end:i[1]})},t.prototype._findCoordRect=function(){var e,i=aj(this.dataZoomModel).infoList;if(!e&&i.length){var r=i[0].model.coordinateSystem;e=r.getRect&&r.getRect()}if(!e){var o=this.api.getWidth(),s=this.api.getHeight();e={x:o*.2,y:s*.2,width:o*.6,height:s*.6}}return e},t.type="dataZoom.slider",t}(OL);function fct(n){var t={x:"y",y:"x",radius:"angle",angle:"radius"};return t[n]}function Vz(n){return n==="vertical"?"ns-resize":"ew-resize"}function gct(n){n.registerComponentModel(sct),n.registerComponentView(cct),DL(n)}function C7t(n){Xs(oct),Xs(gct)}var pct=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.hasSymbolVisual=!0,e}return t.prototype.getInitialData=function(e){return pL(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(e){var i=new bi,r=Kh("line",0,e.itemHeight/2,e.itemWidth,0,e.lineStyle.stroke,!1);i.add(r),r.setStyle(e.lineStyle);var o=this.getData().getVisual("symbol"),s=this.getData().getVisual("symbolRotate"),a=o==="none"?"circle":o,l=e.itemHeight*.8,h=Kh(a,(e.itemWidth-l)/2,(e.itemHeight-l)/2,l,l,e.itemStyle.fill);i.add(h),h.setStyle(e.itemStyle);var u=e.iconRotate==="inherit"?s:e.iconRotate||0;return h.rotation=u*Math.PI/180,h.setOrigin([e.itemWidth/2,e.itemHeight/2]),a.indexOf("empty")>-1&&(h.style.stroke=h.style.fill,h.style.fill="#fff",h.style.lineWidth=2),i},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(Ao);function Sj(n,t,e){var i=n.getBaseAxis(),r=n.getOtherAxis(i),o=vct(r,e),s=i.dim,a=r.dim,l=t.mapDimension(a),h=t.mapDimension(s),u=a==="x"||a==="radius"?1:0,d=St(n.dimensions,function(g){return t.mapDimension(g)}),c=!1,f=t.getCalculationInfo("stackResultDimension");return oc(t,d[0])&&(c=!0,d[0]=f),oc(t,d[1])&&(c=!0,d[1]=f),{dataDimsForPoint:d,valueStart:o,valueAxisDim:a,baseAxisDim:s,stacked:!!c,valueDim:l,baseDim:h,baseDataOffset:u,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function vct(n,t){var e=0,i=n.scale.getExtent();return t==="start"?e=i[0]:t==="end"?e=i[1]:di(t)&&!isNaN(t)?e=t:i[0]>0?e=i[0]:i[1]<0&&(e=i[1]),e}function Aj(n,t,e,i){var r=NaN;n.stacked&&(r=e.get(e.getCalculationInfo("stackedOverDimension"),i)),isNaN(r)&&(r=n.valueStart);var o=n.baseDataOffset,s=[];return s[o]=e.get(n.baseDim,i),s[1-o]=r,t.dataToPoint(s)}function mct(n,t){var e=[];return t.diff(n).add(function(i){e.push({cmd:"+",idx:i})}).update(function(i,r){e.push({cmd:"=",idx:r,idx1:i})}).remove(function(i){e.push({cmd:"-",idx:i})}).execute(),e}function yct(n,t,e,i,r,o,s,a){for(var l=mct(n,t),h=[],u=[],d=[],c=[],f=[],g=[],p=[],v=Sj(r,t,s),m=n.getLayout("points")||[],y=t.getLayout("points")||[],b=0;b<l.length;b++){var _=l[b],w=!0,C=void 0,x=void 0;switch(_.cmd){case"=":C=_.idx*2,x=_.idx1*2;var S=m[C],A=m[C+1],T=y[x],M=y[x+1];(isNaN(S)||isNaN(A))&&(S=T,A=M),h.push(S,A),u.push(T,M),d.push(e[C],e[C+1]),c.push(i[x],i[x+1]),p.push(t.getRawIndex(_.idx1));break;case"+":var R=_.idx,E=v.dataDimsForPoint,P=r.dataToPoint([t.get(E[0],R),t.get(E[1],R)]);x=R*2,h.push(P[0],P[1]),u.push(y[x],y[x+1]);var B=Aj(v,r,t,R);d.push(B[0],B[1]),c.push(i[x],i[x+1]),p.push(t.getRawIndex(R));break;case"-":w=!1}w&&(f.push(_),g.push(g.length))}g.sort(function(W,K){return p[W]-p[K]});for(var k=h.length,L=Ml(k),O=Ml(k),D=Ml(k),I=Ml(k),H=[],b=0;b<g.length;b++){var F=g[b],G=b*2,j=F*2;L[G]=h[j],L[G+1]=h[j+1],O[G]=u[j],O[G+1]=u[j+1],D[G]=d[j],D[G+1]=d[j+1],I[G]=c[j],I[G+1]=c[j+1],H[b]=f[F]}return{current:L,next:O,stackedOnCurrent:D,stackedOnNext:I,status:H}}var ah=Math.min,lh=Math.max;function zd(n,t){return isNaN(n)||isNaN(t)}function VB(n,t,e,i,r,o,s,a,l){for(var h,u,d,c,f,g,p=e,v=0;v<i;v++){var m=t[p*2],y=t[p*2+1];if(p>=r||p<0)break;if(zd(m,y)){if(l){p+=o;continue}break}if(p===e)n[o>0?"moveTo":"lineTo"](m,y),d=m,c=y;else{var b=m-h,_=y-u;if(b*b+_*_<.5){p+=o;continue}if(s>0){for(var w=p+o,C=t[w*2],x=t[w*2+1];C===m&&x===y&&v<i;)v++,w+=o,p+=o,C=t[w*2],x=t[w*2+1],m=t[p*2],y=t[p*2+1],b=m-h,_=y-u;var S=v+1;if(l)for(;zd(C,x)&&S<i;)S++,w+=o,C=t[w*2],x=t[w*2+1];var A=.5,T=0,M=0,R=void 0,E=void 0;if(S>=i||zd(C,x))f=m,g=y;else{T=C-h,M=x-u;var P=m-h,B=C-m,k=y-u,L=x-y,O=void 0,D=void 0;if(a==="x"){O=Math.abs(P),D=Math.abs(B);var I=T>0?1:-1;f=m-I*O*s,g=y,R=m+I*D*s,E=y}else if(a==="y"){O=Math.abs(k),D=Math.abs(L);var H=M>0?1:-1;f=m,g=y-H*O*s,R=m,E=y+H*D*s}else O=Math.sqrt(P*P+k*k),D=Math.sqrt(B*B+L*L),A=D/(D+O),f=m-T*s*(1-A),g=y-M*s*(1-A),R=m+T*s*A,E=y+M*s*A,R=ah(R,lh(C,m)),E=ah(E,lh(x,y)),R=lh(R,ah(C,m)),E=lh(E,ah(x,y)),T=R-m,M=E-y,f=m-T*O/D,g=y-M*O/D,f=ah(f,lh(h,m)),g=ah(g,lh(u,y)),f=lh(f,ah(h,m)),g=lh(g,ah(u,y)),T=m-f,M=y-g,R=m+T*D/O,E=y+M*D/O}n.bezierCurveTo(d,c,f,g,m,y),d=R,c=E}else n.lineTo(m,y)}h=m,u=y,p+=o}return v}var Tj=function(){function n(){this.smooth=0,this.smoothConstraint=!0}return n}(),bct=function(n){ct(t,n);function t(e){var i=n.call(this,e)||this;return i.type="ec-polyline",i}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Tj},t.prototype.buildPath=function(e,i){var r=i.points,o=0,s=r.length/2;if(i.connectNulls){for(;s>0&&zd(r[s*2-2],r[s*2-1]);s--);for(;o<s&&zd(r[o*2],r[o*2+1]);o++);}for(;o<s;)o+=VB(e,r,o,s,s,1,i.smooth,i.smoothMonotone,i.connectNulls)+1},t.prototype.getPointOn=function(e,i){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var r=this.path,o=r.data,s=Vl.CMD,a,l,h=i==="x",u=[],d=0;d<o.length;){var c=o[d++],f=void 0,g=void 0,p=void 0,v=void 0,m=void 0,y=void 0,b=void 0;switch(c){case s.M:a=o[d++],l=o[d++];break;case s.L:if(f=o[d++],g=o[d++],b=h?(e-a)/(f-a):(e-l)/(g-l),b<=1&&b>=0){var _=h?(g-l)*b+l:(f-a)*b+a;return h?[e,_]:[_,e]}a=f,l=g;break;case s.C:f=o[d++],g=o[d++],p=o[d++],v=o[d++],m=o[d++],y=o[d++];var w=h?kC(a,f,p,m,e,u):kC(l,g,v,y,e,u);if(w>0)for(var C=0;C<w;C++){var x=u[C];if(x<=1&&x>=0){var _=h?Bn(l,g,v,y,x):Bn(a,f,p,m,x);return h?[e,_]:[_,e]}}a=m,l=y;break}}},t}(Ee),_ct=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(Tj),Cct=function(n){ct(t,n);function t(e){var i=n.call(this,e)||this;return i.type="ec-polygon",i}return t.prototype.getDefaultShape=function(){return new _ct},t.prototype.buildPath=function(e,i){var r=i.points,o=i.stackedOnPoints,s=0,a=r.length/2,l=i.smoothMonotone;if(i.connectNulls){for(;a>0&&zd(r[a*2-2],r[a*2-1]);a--);for(;s<a&&zd(r[s*2],r[s*2+1]);s++);}for(;s<a;){var h=VB(e,r,s,a,a,1,i.smooth,l,i.connectNulls);VB(e,o,s+h-1,h,a,-1,i.stackedOnSmooth,l,i.connectNulls),s+=h+1,e.closePath()}},t}(Ee);function Mj(n,t,e,i,r){var o=n.getArea(),s=o.x,a=o.y,l=o.width,h=o.height,u=e.get(["lineStyle","width"])||0;s-=u/2,a-=u/2,l+=u,h+=u,l=Math.ceil(l),s!==Math.floor(s)&&(s=Math.floor(s),l++);var d=new ci({shape:{x:s,y:a,width:l,height:h}});if(t){var c=n.getBaseAxis(),f=c.isHorizontal(),g=c.inverse;f?(g&&(d.shape.x+=l),d.shape.width=0):(g||(d.shape.y+=h),d.shape.height=0);var p=jt(r)?function(v){r(v,d)}:null;nr(d,{shape:{width:l,height:h,x:s,y:a}},e,null,i,p)}return d}function Rj(n,t,e){var i=n.getArea(),r=xn(i.r0,1),o=xn(i.r,1),s=new xo({shape:{cx:xn(n.cx,1),cy:xn(n.cy,1),r0:r,r:o,startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}});if(t){var a=n.getBaseAxis().dim==="angle";a?s.shape.endAngle=i.startAngle:s.shape.r=r,nr(s,{shape:{endAngle:i.endAngle,r:o}},e)}return s}function wct(n,t,e,i,r){if(n){if(n.type==="polar")return Rj(n,t,e);if(n.type==="cartesian2d")return Mj(n,t,e,i,r)}else return null;return null}function Gz(n,t){if(n.length===t.length){for(var e=0;e<n.length;e++)if(n[e]!==t[e])return;return!0}}function $z(n){for(var t=1/0,e=1/0,i=-1/0,r=-1/0,o=0;o<n.length;){var s=n[o++],a=n[o++];isNaN(s)||(t=Math.min(s,t),i=Math.max(s,i)),isNaN(a)||(e=Math.min(a,e),r=Math.max(a,r))}return[[t,e],[i,r]]}function jz(n,t){var e=$z(n),i=e[0],r=e[1],o=$z(t),s=o[0],a=o[1];return Math.max(Math.abs(i[0]-s[0]),Math.abs(i[1]-s[1]),Math.abs(r[0]-a[0]),Math.abs(r[1]-a[1]))}function Uz(n){return di(n)?n:n?.5:0}function xct(n,t,e){if(!e.valueDim)return[];for(var i=t.count(),r=Ml(i*2),o=0;o<i;o++){var s=Aj(e,n,t,o);r[o*2]=s[0],r[o*2+1]=s[1]}return r}function hh(n,t,e,i,r){var o=e.getBaseAxis(),s=o.dim==="x"||o.dim==="radius"?0:1,a=[],l=0,h=[],u=[],d=[],c=[];if(r){for(l=0;l<n.length;l+=2){var f=t||n;!isNaN(f[l])&&!isNaN(f[l+1])&&c.push(n[l],n[l+1])}n=c}for(l=0;l<n.length-2;l+=2)switch(d[0]=n[l+2],d[1]=n[l+3],u[0]=n[l],u[1]=n[l+1],a.push(u[0],u[1]),i){case"end":h[s]=d[s],h[1-s]=u[1-s],a.push(h[0],h[1]);break;case"middle":var g=(u[s]+d[s])/2,p=[];h[s]=p[s]=g,h[1-s]=u[1-s],p[1-s]=d[1-s],a.push(h[0],h[1]),a.push(p[0],p[1]);break;default:h[s]=u[s],h[1-s]=d[1-s],a.push(h[0],h[1])}return a.push(n[l++],n[l++]),a}function Sct(n,t){var e=[],i=n.length,r,o;function s(u,d,c){var f=u.coord,g=(c-f)/(d.coord-f),p=net(g,[u.color,d.color]);return{coord:c,color:p}}for(var a=0;a<i;a++){var l=n[a],h=l.coord;if(h<0)r=l;else if(h>t){o?e.push(s(o,l,t)):r&&e.push(s(r,l,0),s(r,l,t));break}else r&&(e.push(s(r,l,0)),r=null),e.push(l),o=l}return e}function Act(n,t,e){var i=n.getVisual("visualMeta");if(!(!i||!i.length||!n.count())&&t.type==="cartesian2d"){for(var r,o,s=i.length-1;s>=0;s--){var a=n.getDimensionInfo(i[s].dimension);if(r=a&&a.coordDim,r==="x"||r==="y"){o=i[s];break}}if(o){var l=t.getAxis(r),h=St(o.stops,function(b){return{coord:l.toGlobalCoord(l.dataToCoord(b.value)),color:b.color}}),u=h.length,d=o.outerColors.slice();u&&h[0].coord>h[u-1].coord&&(h.reverse(),d.reverse());var c=Sct(h,r==="x"?e.getWidth():e.getHeight()),f=c.length;if(!f&&u)return h[0].coord<0?d[1]?d[1]:h[u-1].color:d[0]?d[0]:h[0].color;var g=10,p=c[0].coord-g,v=c[f-1].coord+g,m=v-p;if(m<.001)return"transparent";N(c,function(b){b.offset=(b.coord-p)/m}),c.push({offset:f?c[f-1].offset:.5,color:d[1]||"transparent"}),c.unshift({offset:f?c[0].offset:.5,color:d[0]||"transparent"});var y=new x9(0,0,0,0,c,!0);return y[r]=p,y[r+"2"]=v,y}}}function Tct(n,t,e){var i=n.get("showAllSymbol"),r=i==="auto";if(!(i&&!r)){var o=e.getAxesByScale("ordinal")[0];if(o&&!(r&&Mct(o,t))){var s=t.mapDimension(o.dim),a={};return N(o.getViewLabels(),function(l){var h=o.scale.getRawOrdinalNumber(l.tickValue);a[h]=1}),function(l){return!a.hasOwnProperty(t.get(s,l))}}}}function Mct(n,t){var e=n.getExtent(),i=Math.abs(e[1]-e[0])/n.scale.count();isNaN(i)&&(i=0);for(var r=t.count(),o=Math.max(1,Math.round(r/5)),s=0;s<r;s+=o)if(WL.getSymbolSize(t,s)[n.isHorizontal()?1:0]*1.5>i)return!1;return!0}function Rct(n,t){return isNaN(n)||isNaN(t)}function Bct(n){for(var t=n.length/2;t>0&&Rct(n[t*2-2],n[t*2-1]);t--);return t-1}function Xz(n,t){return[n[t*2],n[t*2+1]]}function Pct(n,t,e){for(var i=n.length/2,r=e==="x"?0:1,o,s,a=0,l=-1,h=0;h<i;h++)if(s=n[h*2+r],!(isNaN(s)||isNaN(n[h*2+1-r]))){if(h===0){o=s;continue}if(o<=t&&s>=t||o>=t&&s<=t){l=h;break}a=h,o=s}return{range:[a,l],t:(t-o)/(s-o)}}function Bj(n){if(n.get(["endLabel","show"]))return!0;for(var t=0;t<wo.length;t++)if(n.get([wo[t],"endLabel","show"]))return!0;return!1}function $M(n,t,e,i){if(VL(t,"cartesian2d")){var r=i.getModel("endLabel"),o=r.get("valueAnimation"),s=i.getData(),a={lastFrameIndex:0},l=Bj(i)?function(f,g){n._endLabelOnDuring(f,g,s,a,o,r,t)}:null,h=t.getBaseAxis().isHorizontal(),u=Mj(t,e,i,function(){var f=n._endLabel;f&&e&&a.originalX!=null&&f.attr({x:a.originalX,y:a.originalY})},l);if(!i.get("clip",!0)){var d=u.shape,c=Math.max(d.width,d.height);h?(d.y-=c,d.height+=c*2):(d.x-=c,d.width+=c*2)}return l&&l(1,u),u}else return Rj(t,e,i)}function kct(n,t){var e=t.getBaseAxis(),i=e.isHorizontal(),r=e.inverse,o=i?r?"right":"left":"center",s=i?"middle":r?"top":"bottom";return{normal:{align:n.get("align")||o,verticalAlign:n.get("verticalAlign")||s}}}var Ect=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.init=function(){var e=new bi,i=new Ndt;this.group.add(i.group),this._symbolDraw=i,this._lineGroup=e,this._changePolyState=zt(this._changePolyState,this)},t.prototype.render=function(e,i,r){var o=e.coordinateSystem,s=this.group,a=e.getData(),l=e.getModel("lineStyle"),h=e.getModel("areaStyle"),u=a.getLayout("points")||[],d=o.type==="polar",c=this._coordSys,f=this._symbolDraw,g=this._polyline,p=this._polygon,v=this._lineGroup,m=!i.ssr&&e.get("animation"),y=!h.isEmpty(),b=h.get("origin"),_=Sj(o,a,b),w=y&&xct(o,a,_),C=e.get("showSymbol"),x=e.get("connectNulls"),S=C&&!d&&Tct(e,a,o),A=this._data;A&&A.eachItemGraphicEl(function(W,K){W.__temp&&(s.remove(W),A.setItemGraphicEl(K,null))}),C||f.remove(),s.add(v);var T=d?!1:e.get("step"),M;o&&o.getArea&&e.get("clip",!0)&&(M=o.getArea(),M.width!=null?(M.x-=.1,M.y-=.1,M.width+=.2,M.height+=.2):M.r0&&(M.r0-=.5,M.r+=.5)),this._clipShapeForSymbol=M;var R=Act(a,o,r)||a.getVisual("style")[a.getVisual("drawType")];if(!(g&&c.type===o.type&&T===this._step))C&&f.updateData(a,{isIgnore:S,clipShape:M,disableAnimation:!0,getSymbolPoint:function(W){return[u[W*2],u[W*2+1]]}}),m&&this._initSymbolLabelAnimation(a,o,M),T&&(w&&(w=hh(w,u,o,T,x)),u=hh(u,null,o,T,x)),g=this._newPolyline(u),y?p=this._newPolygon(u,w):p&&(v.remove(p),p=this._polygon=null),d||this._initOrUpdateEndLabel(e,o,nc(R)),v.setClipPath($M(this,o,!0,e));else{y&&!p?p=this._newPolygon(u,w):p&&!y&&(v.remove(p),p=this._polygon=null),d||this._initOrUpdateEndLabel(e,o,nc(R));var E=v.getClipPath();if(E){var P=$M(this,o,!1,e);nr(E,{shape:P.shape},e)}else v.setClipPath($M(this,o,!0,e));C&&f.updateData(a,{isIgnore:S,clipShape:M,disableAnimation:!0,getSymbolPoint:function(W){return[u[W*2],u[W*2+1]]}}),(!Gz(this._stackedOnPoints,w)||!Gz(this._points,u))&&(m?this._doUpdateAnimation(a,w,o,r,T,b,x):(T&&(w&&(w=hh(w,u,o,T,x)),u=hh(u,null,o,T,x)),g.setShape({points:u}),p&&p.setShape({points:u,stackedOnPoints:w})))}var B=e.getModel("emphasis"),k=B.get("focus"),L=B.get("blurScope"),O=B.get("disabled");if(g.useStyle(Gt(l.getLineStyle(),{fill:"none",stroke:R,lineJoin:"bevel"})),zC(g,e,"lineStyle"),g.style.lineWidth>0&&e.get(["emphasis","lineStyle","width"])==="bolder"){var D=g.getState("emphasis").style;D.lineWidth=+g.style.lineWidth+1}pe(g).seriesIndex=e.seriesIndex,ic(g,k,L,O);var I=Uz(e.get("smooth")),H=e.get("smoothMonotone");if(g.setShape({smooth:I,smoothMonotone:H,connectNulls:x}),p){var F=a.getCalculationInfo("stackedOnSeries"),G=0;p.useStyle(Gt(h.getAreaStyle(),{fill:R,opacity:.7,lineJoin:"bevel",decal:a.getVisual("style").decal})),F&&(G=Uz(F.get("smooth"))),p.setShape({smooth:I,stackedOnSmooth:G,smoothMonotone:H,connectNulls:x}),zC(p,e,"areaStyle"),pe(p).seriesIndex=e.seriesIndex,ic(p,k,L,O)}var j=this._changePolyState;a.eachItemGraphicEl(function(W){W&&(W.onHoverStateChange=j)}),this._polyline.onHoverStateChange=j,this._data=a,this._coordSys=o,this._stackedOnPoints=w,this._points=u,this._step=T,this._valueOrigin=b,e.get("triggerLineEvent")&&(this.packEventData(e,g),p&&this.packEventData(e,p))},t.prototype.packEventData=function(e,i){pe(i).eventData={componentType:"series",componentSubType:"line",componentIndex:e.componentIndex,seriesIndex:e.seriesIndex,seriesName:e.name,seriesType:"line"}},t.prototype.highlight=function(e,i,r,o){var s=e.getData(),a=ec(s,o);if(this._changePolyState("emphasis"),!(a instanceof Array)&&a!=null&&a>=0){var l=s.getLayout("points"),h=s.getItemGraphicEl(a);if(!h){var u=l[a*2],d=l[a*2+1];if(isNaN(u)||isNaN(d)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(u,d))return;var c=e.get("zlevel")||0,f=e.get("z")||0;h=new WL(s,a),h.x=u,h.y=d,h.setZ(c,f);var g=h.getSymbolPath().getTextContent();g&&(g.zlevel=c,g.z=f,g.z2=this._polyline.z2+1),h.__temp=!0,s.setItemGraphicEl(a,h),h.stopSymbolAnimation(!0),this.group.add(h)}h.highlight()}else Ur.prototype.highlight.call(this,e,i,r,o)},t.prototype.downplay=function(e,i,r,o){var s=e.getData(),a=ec(s,o);if(this._changePolyState("normal"),a!=null&&a>=0){var l=s.getItemGraphicEl(a);l&&(l.__temp?(s.setItemGraphicEl(a,null),this.group.remove(l)):l.downplay())}else Ur.prototype.downplay.call(this,e,i,r,o)},t.prototype._changePolyState=function(e){var i=this._polygon;ZI(this._polyline,e),i&&ZI(i,e)},t.prototype._newPolyline=function(e){var i=this._polyline;return i&&this._lineGroup.remove(i),i=new bct({shape:{points:e},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(i),this._polyline=i,i},t.prototype._newPolygon=function(e,i){var r=this._polygon;return r&&this._lineGroup.remove(r),r=new Cct({shape:{points:e,stackedOnPoints:i},segmentIgnoreThreshold:2}),this._lineGroup.add(r),this._polygon=r,r},t.prototype._initSymbolLabelAnimation=function(e,i,r){var o,s,a=i.getBaseAxis(),l=a.inverse;i.type==="cartesian2d"?(o=a.isHorizontal(),s=!1):i.type==="polar"&&(o=a.dim==="angle",s=!0);var h=e.hostModel,u=h.get("animationDuration");jt(u)&&(u=u(null));var d=h.get("animationDelay")||0,c=jt(d)?d(null):d;e.eachItemGraphicEl(function(f,g){var p=f;if(p){var v=[f.x,f.y],m=void 0,y=void 0,b=void 0;if(r)if(s){var _=r,w=i.pointToCoord(v);o?(m=_.startAngle,y=_.endAngle,b=-w[1]/180*Math.PI):(m=_.r0,y=_.r,b=w[0])}else{var C=r;o?(m=C.x,y=C.x+C.width,b=f.x):(m=C.y+C.height,y=C.y,b=f.y)}var x=y===m?0:(b-m)/(y-m);l&&(x=1-x);var S=jt(d)?d(g):u*x+c,A=p.getSymbolPath(),T=A.getTextContent();p.attr({scaleX:0,scaleY:0}),p.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:S}),T&&T.animateFrom({style:{opacity:0}},{duration:300,delay:S}),A.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(e,i,r){var o=e.getModel("endLabel");if(Bj(e)){var s=e.getData(),a=this._polyline,l=s.getLayout("points");if(!l){a.removeTextContent(),this._endLabel=null;return}var h=this._endLabel;h||(h=this._endLabel=new Vi({z2:200}),h.ignoreClip=!0,a.setTextContent(this._endLabel),a.disableLabelAnimation=!0);var u=Bct(l);u>=0&&(cp(a,fp(e,"endLabel"),{inheritColor:r,labelFetcher:e,labelDataIndex:u,defaultText:function(d,c,f){return f!=null?bj(s,f):NL(s,d)},enableTextSetter:!0},kct(o,i)),a.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(e,i,r,o,s,a,l){var h=this._endLabel,u=this._polyline;if(h){e<1&&o.originalX==null&&(o.originalX=h.x,o.originalY=h.y);var d=r.getLayout("points"),c=r.hostModel,f=c.get("connectNulls"),g=a.get("precision"),p=a.get("distance")||0,v=l.getBaseAxis(),m=v.isHorizontal(),y=v.inverse,b=i.shape,_=y?m?b.x:b.y+b.height:m?b.x+b.width:b.y,w=(m?p:0)*(y?-1:1),C=(m?0:-p)*(y?-1:1),x=m?"x":"y",S=Pct(d,_,x),A=S.range,T=A[1]-A[0],M=void 0;if(T>=1){if(T>1&&!f){var R=Xz(d,A[0]);h.attr({x:R[0]+w,y:R[1]+C}),s&&(M=c.getRawValue(A[0]))}else{var R=u.getPointOn(_,x);R&&h.attr({x:R[0]+w,y:R[1]+C});var E=c.getRawValue(A[0]),P=c.getRawValue(A[1]);s&&(M=Y8(r,g,E,P,S.t))}o.lastFrameIndex=A[0]}else{var B=e===1||o.lastFrameIndex>0?A[0]:0,R=Xz(d,B);s&&(M=c.getRawValue(B)),h.attr({x:R[0]+w,y:R[1]+C})}if(s){var k=gp(h);typeof k.setLabelText=="function"&&k.setLabelText(M)}}},t.prototype._doUpdateAnimation=function(e,i,r,o,s,a,l){var h=this._polyline,u=this._polygon,d=e.hostModel,c=yct(this._data,e,this._stackedOnPoints,i,this._coordSys,r,this._valueOrigin),f=c.current,g=c.stackedOnCurrent,p=c.next,v=c.stackedOnNext;if(s&&(g=hh(c.stackedOnCurrent,c.current,r,s,l),f=hh(c.current,null,r,s,l),v=hh(c.stackedOnNext,c.next,r,s,l),p=hh(c.next,null,r,s,l)),jz(f,p)>3e3||u&&jz(g,v)>3e3){h.stopAnimation(),h.setShape({points:p}),u&&(u.stopAnimation(),u.setShape({points:p,stackedOnPoints:v}));return}h.shape.__points=c.current,h.shape.points=f;var m={shape:{points:p}};c.current!==f&&(m.shape.__points=c.next),h.stopAnimation(),En(h,m,d),u&&(u.setShape({points:f,stackedOnPoints:g}),u.stopAnimation(),En(u,{shape:{stackedOnPoints:v}},d),h.shape.points!==u.shape.points&&(u.shape.points=h.shape.points));for(var y=[],b=c.status,_=0;_<b.length;_++){var w=b[_].cmd;if(w==="="){var C=e.getItemGraphicEl(b[_].idx1);C&&y.push({el:C,ptIdx:_})}}h.animators&&h.animators.length&&h.animators[0].during(function(){u&&u.dirtyShape();for(var x=h.shape.__points,S=0;S<y.length;S++){var A=y[S].el,T=y[S].ptIdx*2;A.x=x[T],A.y=x[T+1],A.markRedraw()}})},t.prototype.remove=function(e){var i=this.group,r=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),r&&r.eachItemGraphicEl(function(o,s){o.__temp&&(i.remove(o),r.setItemGraphicEl(s,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(Ur);function Lct(n,t){return{seriesType:n,plan:sL(),reset:function(e){var i=e.getData(),r=e.coordinateSystem;if(e.pipelineContext,!!r){var o=St(r.dimensions,function(d){return i.mapDimension(d)}).slice(0,2),s=o.length,a=i.getCalculationInfo("stackResultDimension");oc(i,o[0])&&(o[0]=a),oc(i,o[1])&&(o[1]=a);var l=i.getStore(),h=i.getDimensionIndex(o[0]),u=i.getDimensionIndex(o[1]);return s&&{progress:function(d,c){for(var f=d.end-d.start,g=Ml(f*s),p=[],v=[],m=d.start,y=0;m<d.end;m++){var b=void 0;if(s===1){var _=l.get(h,m);b=r.dataToPoint(_,null,v)}else p[0]=l.get(h,m),p[1]=l.get(u,m),b=r.dataToPoint(p,null,v);g[y++]=b[0],g[y++]=b[1]}c.setLayout("points",g)}}}}}}var Oct={average:function(n){for(var t=0,e=0,i=0;i<n.length;i++)isNaN(n[i])||(t+=n[i],e++);return e===0?NaN:t/e},sum:function(n){for(var t=0,e=0;e<n.length;e++)t+=n[e]||0;return t},max:function(n){for(var t=-1/0,e=0;e<n.length;e++)n[e]>t&&(t=n[e]);return isFinite(t)?t:NaN},min:function(n){for(var t=1/0,e=0;e<n.length;e++)n[e]<t&&(t=n[e]);return isFinite(t)?t:NaN},nearest:function(n){return n[0]}},Dct=function(n){return Math.round(n.length/2)};function Pj(n){return{seriesType:n,reset:function(t,e,i){var r=t.getData(),o=t.get("sampling"),s=t.coordinateSystem,a=r.count();if(a>10&&s.type==="cartesian2d"&&o){var l=s.getBaseAxis(),h=s.getOtherAxis(l),u=l.getExtent(),d=i.getDevicePixelRatio(),c=Math.abs(u[1]-u[0])*(d||1),f=Math.round(a/c);if(isFinite(f)&&f>1){o==="lttb"?t.setData(r.lttbDownSample(r.mapDimension(h.dim),1/f)):o==="minmax"&&t.setData(r.minmaxDownSample(r.mapDimension(h.dim),1/f));var g=void 0;Pt(o)?g=Oct[o]:jt(o)&&(g=o),g&&t.setData(r.downSample(r.mapDimension(h.dim),1/f,g,Dct))}}}}}function w7t(n){n.registerChartView(Ect),n.registerSeriesModel(pct),n.registerLayout(Lct("line")),n.registerVisual({seriesType:"line",reset:function(t){var e=t.getData(),i=t.getModel("lineStyle").getLineStyle();i&&!i.stroke&&(i.stroke=e.getVisual("style").fill),e.setVisual("legendLineStyle",i)}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,Pj("line"))}var GB=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.getInitialData=function(e,i){return pL(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(e,i,r){var o=this.coordinateSystem;if(o&&o.clampData){var s=o.clampData(e),a=o.dataToPoint(s);if(r)N(o.getAxes(),function(c,f){if(c.type==="category"&&i!=null){var g=c.getTicksCoords(),p=c.getTickModel().get("alignWithLabel"),v=s[f],m=i[f]==="x1"||i[f]==="y1";if(m&&!p&&(v+=1),g.length<2)return;if(g.length===2){a[f]=c.toGlobalCoord(c.getExtent()[m?1:0]);return}for(var y=void 0,b=void 0,_=1,w=0;w<g.length;w++){var C=g[w].coord,x=w===g.length-1?g[w-1].tickValue+_:g[w].tickValue;if(x===v){b=C;break}else if(x<v)y=C;else if(y!=null&&x>v){b=(C+y)/2;break}w===1&&(_=x-g[0].tickValue)}b==null&&(y?y&&(b=g[g.length-1].coord):b=g[0].coord),a[f]=c.toGlobalCoord(b)}});else{var l=this.getData(),h=l.getLayout("offset"),u=l.getLayout("size"),d=o.getBaseAxis().isHorizontal()?0:1;a[d]+=h+u/2}return a}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(Ao);Ao.registerClass(GB);var Ict=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.getInitialData=function(){return pL(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var e=this.get("progressiveThreshold"),i=this.get("largeThreshold");return i>e&&(e=i),e},t.prototype.brushSelector=function(e,i,r){return r.rect(i.getItemLayout(e))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=vS(GB.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(GB),Hct=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),Yz=function(n){ct(t,n);function t(e){var i=n.call(this,e)||this;return i.type="sausage",i}return t.prototype.getDefaultShape=function(){return new Hct},t.prototype.buildPath=function(e,i){var r=i.cx,o=i.cy,s=Math.max(i.r0||0,0),a=Math.max(i.r,0),l=(a-s)*.5,h=s+l,u=i.startAngle,d=i.endAngle,c=i.clockwise,f=Math.PI*2,g=c?d-u<f:u-d<f;g||(u=d-(c?f:-f));var p=Math.cos(u),v=Math.sin(u),m=Math.cos(d),y=Math.sin(d);g?(e.moveTo(p*s+r,v*s+o),e.arc(p*h+r,v*h+o,l,-Math.PI+u,u,!c)):e.moveTo(p*a+r,v*a+o),e.arc(r,o,a,u,d,!c),e.arc(m*h+r,y*h+o,l,d-Math.PI*2,d-Math.PI,!c),s!==0&&e.arc(r,o,s,d,u,c)},t}(Ee);function Fct(n,t){t=t||{};var e=t.isRoundCap;return function(i,r,o){var s=r.position;if(!s||s instanceof Array)return DC(i,r,o);var a=n(s),l=r.distance!=null?r.distance:5,h=this.shape,u=h.cx,d=h.cy,c=h.r,f=h.r0,g=(c+f)/2,p=h.startAngle,v=h.endAngle,m=(p+v)/2,y=e?Math.abs(c-f)/2:0,b=Math.cos,_=Math.sin,w=u+c*b(p),C=d+c*_(p),x="left",S="top";switch(a){case"startArc":w=u+(f-l)*b(m),C=d+(f-l)*_(m),x="center",S="top";break;case"insideStartArc":w=u+(f+l)*b(m),C=d+(f+l)*_(m),x="center",S="bottom";break;case"startAngle":w=u+g*b(p)+kb(p,l+y,!1),C=d+g*_(p)+Eb(p,l+y,!1),x="right",S="middle";break;case"insideStartAngle":w=u+g*b(p)+kb(p,-l+y,!1),C=d+g*_(p)+Eb(p,-l+y,!1),x="left",S="middle";break;case"middle":w=u+g*b(m),C=d+g*_(m),x="center",S="middle";break;case"endArc":w=u+(c+l)*b(m),C=d+(c+l)*_(m),x="center",S="bottom";break;case"insideEndArc":w=u+(c-l)*b(m),C=d+(c-l)*_(m),x="center",S="top";break;case"endAngle":w=u+g*b(v)+kb(v,l+y,!0),C=d+g*_(v)+Eb(v,l+y,!0),x="left",S="middle";break;case"insideEndAngle":w=u+g*b(v)+kb(v,-l+y,!0),C=d+g*_(v)+Eb(v,-l+y,!0),x="right",S="middle";break;default:return DC(i,r,o)}return i=i||{},i.x=w,i.y=C,i.align=x,i.verticalAlign=S,i}}function zct(n,t,e,i){if(di(i)){n.setTextConfig({rotation:i});return}else if(_t(t)){n.setTextConfig({rotation:0});return}var r=n.shape,o=r.clockwise?r.startAngle:r.endAngle,s=r.clockwise?r.endAngle:r.startAngle,a=(o+s)/2,l,h=e(t);switch(h){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=a;break;case"startAngle":case"insideStartAngle":l=o;break;case"endAngle":case"insideEndAngle":l=s;break;default:n.setTextConfig({rotation:0});return}var u=Math.PI*1.5-l;h==="middle"&&u>Math.PI/2&&u<Math.PI*1.5&&(u-=Math.PI),n.setTextConfig({rotation:u})}function kb(n,t,e){return t*Math.sin(n)*(e?-1:1)}function Eb(n,t,e){return t*Math.cos(n)*(e?1:-1)}function wd(n,t,e){var i=n.get("borderRadius");if(i==null)return e?{cornerRadius:0}:null;_t(i)||(i=[i,i,i,i]);var r=Math.abs(t.r||0-t.r0||0);return{cornerRadius:St(i,function(o){return Yh(o,r)})}}var jM=Math.max,UM=Math.min;function Nct(n,t){var e=n.getArea&&n.getArea();if(VL(n,"cartesian2d")){var i=n.getBaseAxis();if(i.type!=="category"||!i.onBand){var r=t.getLayout("bandWidth");i.isHorizontal()?(e.x-=r,e.width+=r*2):(e.y-=r,e.height+=r*2)}}return e}var Wct=function(n){ct(t,n);function t(){var e=n.call(this)||this;return e.type=t.type,e._isFirstFrame=!0,e}return t.prototype.render=function(e,i,r,o){this._model=e,this._removeOnRenderedListener(r),this._updateDrawMode(e);var s=e.get("coordinateSystem");(s==="cartesian2d"||s==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(e,i,r):this._renderNormal(e,i,r,o))},t.prototype.incrementalPrepareRender=function(e){this._clear(),this._updateDrawMode(e),this._updateLargeClip(e)},t.prototype.incrementalRender=function(e,i){this._progressiveEls=[],this._incrementalRenderLarge(e,i)},t.prototype.eachRendered=function(e){gS(this._progressiveEls||this.group,e)},t.prototype._updateDrawMode=function(e){var i=e.pipelineContext.large;(this._isLargeDraw==null||i!==this._isLargeDraw)&&(this._isLargeDraw=i,this._clear())},t.prototype._renderNormal=function(e,i,r,o){var s=this.group,a=e.getData(),l=this._data,h=e.coordinateSystem,u=h.getBaseAxis(),d;h.type==="cartesian2d"?d=u.isHorizontal():h.type==="polar"&&(d=u.dim==="angle");var c=e.isAnimationEnabled()?e:null,f=Vct(e,h);f&&this._enableRealtimeSort(f,a,r);var g=e.get("clip",!0)||f,p=Nct(h,a);s.removeClipPath();var v=e.get("roundCap",!0),m=e.get("showBackground",!0),y=e.getModel("backgroundStyle"),b=y.get("borderRadius")||0,_=[],w=this._backgroundEls,C=o&&o.isInitSort,x=o&&o.type==="changeAxisOrder";function S(M){var R=Lb[h.type](a,M),E=Kct(h,d,R);return E.useStyle(y.getItemStyle()),h.type==="cartesian2d"?E.setShape("r",b):E.setShape("cornerRadius",b),_[M]=E,E}a.diff(l).add(function(M){var R=a.getItemModel(M),E=Lb[h.type](a,M,R);if(m&&S(M),!(!a.hasValue(M)||!Qz[h.type](E))){var P=!1;g&&(P=Kz[h.type](p,E));var B=qz[h.type](e,a,M,E,d,c,u.model,!1,v);f&&(B.forceLabelAnimation=!0),t3(B,a,M,R,E,e,d,h.type==="polar"),C?B.attr({shape:E}):f?Zz(f,c,B,E,M,d,!1,!1):nr(B,{shape:E},e,M),a.setItemGraphicEl(M,B),s.add(B),B.ignore=P}}).update(function(M,R){var E=a.getItemModel(M),P=Lb[h.type](a,M,E);if(m){var B=void 0;w.length===0?B=S(R):(B=w[R],B.useStyle(y.getItemStyle()),h.type==="cartesian2d"?B.setShape("r",b):B.setShape("cornerRadius",b),_[M]=B);var k=Lb[h.type](a,M),L=Ej(d,k,h);En(B,{shape:L},c,M)}var O=l.getItemGraphicEl(R);if(!a.hasValue(M)||!Qz[h.type](P)){s.remove(O);return}var D=!1;if(g&&(D=Kz[h.type](p,P),D&&s.remove(O)),O?dS(O):O=qz[h.type](e,a,M,P,d,c,u.model,!!O,v),f&&(O.forceLabelAnimation=!0),x){var I=O.getTextContent();if(I){var H=gp(I);H.prevValue!=null&&(H.prevValue=H.value)}}else t3(O,a,M,E,P,e,d,h.type==="polar");C?O.attr({shape:P}):f?Zz(f,c,O,P,M,d,!0,x):En(O,{shape:P},e,M,null),a.setItemGraphicEl(M,O),O.ignore=D,s.add(O)}).remove(function(M){var R=l.getItemGraphicEl(M);R&&VC(R,e,M)}).execute();var A=this._backgroundGroup||(this._backgroundGroup=new bi);A.removeAll();for(var T=0;T<_.length;++T)A.add(_[T]);s.add(A),this._backgroundEls=_,this._data=a},t.prototype._renderLarge=function(e,i,r){this._clear(),i3(e,this.group),this._updateLargeClip(e)},t.prototype._incrementalRenderLarge=function(e,i){this._removeBackground(),i3(i,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(e){var i=e.get("clip",!0)&&wct(e.coordinateSystem,!1,e),r=this.group;i?r.setClipPath(i):r.removeClipPath()},t.prototype._enableRealtimeSort=function(e,i,r){var o=this;if(i.count()){var s=e.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(i,e,r),this._isFirstFrame=!1;else{var a=function(l){var h=i.getItemGraphicEl(l),u=h&&h.shape;return u&&Math.abs(s.isHorizontal()?u.height:u.width)||0};this._onRendered=function(){o._updateSortWithinSameData(i,a,s,r)},r.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(e,i,r){var o=[];return e.each(e.mapDimension(i.dim),function(s,a){var l=r(a);l=l??NaN,o.push({dataIndex:a,mappedValue:l,ordinalNumber:s})}),o.sort(function(s,a){return a.mappedValue-s.mappedValue}),{ordinalNumbers:St(o,function(s){return s.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(e,i,r){for(var o=r.scale,s=e.mapDimension(r.dim),a=Number.MAX_VALUE,l=0,h=o.getOrdinalMeta().categories.length;l<h;++l){var u=e.rawIndexOf(s,o.getRawOrdinalNumber(l)),d=u<0?Number.MIN_VALUE:i(e.indexOfRawIndex(u));if(d>a)return!0;a=d}return!1},t.prototype._isOrderDifferentInView=function(e,i){for(var r=i.scale,o=r.getExtent(),s=Math.max(0,o[0]),a=Math.min(o[1],r.getOrdinalMeta().categories.length-1);s<=a;++s)if(e.ordinalNumbers[s]!==r.getRawOrdinalNumber(s))return!0},t.prototype._updateSortWithinSameData=function(e,i,r,o){if(this._isOrderChangedWithinSameData(e,i,r)){var s=this._dataSort(e,r,i);this._isOrderDifferentInView(s,r)&&(this._removeOnRenderedListener(o),o.dispatchAction({type:"changeAxisOrder",componentType:r.dim+"Axis",axisId:r.index,sortInfo:s}))}},t.prototype._dispatchInitSort=function(e,i,r){var o=i.baseAxis,s=this._dataSort(e,o,function(a){return e.get(e.mapDimension(i.otherAxis.dim),a)});r.dispatchAction({type:"changeAxisOrder",componentType:o.dim+"Axis",isInitSort:!0,axisId:o.index,sortInfo:s})},t.prototype.remove=function(e,i){this._clear(this._model),this._removeOnRenderedListener(i)},t.prototype.dispose=function(e,i){this._removeOnRenderedListener(i)},t.prototype._removeOnRenderedListener=function(e){this._onRendered&&(e.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(e){var i=this.group,r=this._data;e&&e.isAnimationEnabled()&&r&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],r.eachItemGraphicEl(function(o){VC(o,e,pe(o).dataIndex)})):i.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(Ur),Kz={cartesian2d:function(n,t){var e=t.width<0?-1:1,i=t.height<0?-1:1;e<0&&(t.x+=t.width,t.width=-t.width),i<0&&(t.y+=t.height,t.height=-t.height);var r=n.x+n.width,o=n.y+n.height,s=jM(t.x,n.x),a=UM(t.x+t.width,r),l=jM(t.y,n.y),h=UM(t.y+t.height,o),u=a<s,d=h<l;return t.x=u&&s>r?a:s,t.y=d&&l>o?h:l,t.width=u?0:a-s,t.height=d?0:h-l,e<0&&(t.x+=t.width,t.width=-t.width),i<0&&(t.y+=t.height,t.height=-t.height),u||d},polar:function(n,t){var e=t.r0<=t.r?1:-1;if(e<0){var i=t.r;t.r=t.r0,t.r0=i}var r=UM(t.r,n.r),o=jM(t.r0,n.r0);t.r=r,t.r0=o;var s=r-o<0;if(e<0){var i=t.r;t.r=t.r0,t.r0=i}return s}},qz={cartesian2d:function(n,t,e,i,r,o,s,a,l){var h=new ci({shape:ft({},i),z2:1});if(h.__dataIndex=e,h.name="item",o){var u=h.shape,d=r?"height":"width";u[d]=0}return h},polar:function(n,t,e,i,r,o,s,a,l){var h=!r&&l?Yz:xo,u=new h({shape:i,z2:1});u.name="item";var d=kj(r);if(u.calculateTextPosition=Fct(d,{isRoundCap:h===Yz}),o){var c=u.shape,f=r?"r":"endAngle",g={};c[f]=r?i.r0:i.startAngle,g[f]=i[f],(a?En:nr)(u,{shape:g},o)}return u}};function Vct(n,t){var e=n.get("realtimeSort",!0),i=t.getBaseAxis();if(e&&i.type==="category"&&t.type==="cartesian2d")return{baseAxis:i,otherAxis:t.getOtherAxis(i)}}function Zz(n,t,e,i,r,o,s,a){var l,h;o?(h={x:i.x,width:i.width},l={y:i.y,height:i.height}):(h={y:i.y,height:i.height},l={x:i.x,width:i.width}),a||(s?En:nr)(e,{shape:l},t,r,null);var u=t?n.baseAxis.model:null;(s?En:nr)(e,{shape:h},u,r)}function Jz(n,t){for(var e=0;e<t.length;e++)if(!isFinite(n[t[e]]))return!0;return!1}var Gct=["x","y","width","height"],$ct=["cx","cy","r","startAngle","endAngle"],Qz={cartesian2d:function(n){return!Jz(n,Gct)},polar:function(n){return!Jz(n,$ct)}},Lb={cartesian2d:function(n,t,e){var i=n.getItemLayout(t),r=e?Uct(e,i):0,o=i.width>0?1:-1,s=i.height>0?1:-1;return{x:i.x+o*r/2,y:i.y+s*r/2,width:i.width-o*r,height:i.height-s*r}},polar:function(n,t,e){var i=n.getItemLayout(t);return{cx:i.cx,cy:i.cy,r0:i.r0,r:i.r,startAngle:i.startAngle,endAngle:i.endAngle,clockwise:i.clockwise}}};function jct(n){return n.startAngle!=null&&n.endAngle!=null&&n.startAngle===n.endAngle}function kj(n){return function(t){var e=t?"Arc":"Angle";return function(i){switch(i){case"start":case"insideStart":case"end":case"insideEnd":return i+e;default:return i}}}(n)}function t3(n,t,e,i,r,o,s,a){var l=t.getItemVisual(e,"style");if(a){if(!o.get("roundCap")){var u=n.shape,d=wd(i.getModel("itemStyle"),u,!0);ft(u,d),n.setShape(u)}}else{var h=i.get(["itemStyle","borderRadius"])||0;n.setShape("r",h)}n.useStyle(l);var c=i.getShallow("cursor");c&&n.attr("cursor",c);var f=a?s?r.r>=r.r0?"endArc":"startArc":r.endAngle>=r.startAngle?"endAngle":"startAngle":s?r.height>=0?"bottom":"top":r.width>=0?"right":"left",g=fp(i);cp(n,g,{labelFetcher:o,labelDataIndex:e,defaultText:NL(o.getData(),e),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:f});var p=n.getTextContent();if(a&&p){var v=i.get(["label","position"]);n.textConfig.inside=v==="middle"?!0:null,zct(n,v==="outside"?f:v,kj(s),i.get(["label","rotate"]))}irt(p,g,o.getRawValue(e),function(y){return bj(t,y)});var m=i.getModel(["emphasis"]);ic(n,m.get("focus"),m.get("blurScope"),m.get("disabled")),zC(n,i),jct(r)&&(n.style.fill="none",n.style.stroke="none",N(n.states,function(y){y.style&&(y.style.fill=y.style.stroke="none")}))}function Uct(n,t){var e=n.get(["itemStyle","borderColor"]);if(!e||e==="none")return 0;var i=n.get(["itemStyle","borderWidth"])||0,r=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),o=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(i,r,o)}var Xct=function(){function n(){}return n}(),e3=function(n){ct(t,n);function t(e){var i=n.call(this,e)||this;return i.type="largeBar",i}return t.prototype.getDefaultShape=function(){return new Xct},t.prototype.buildPath=function(e,i){for(var r=i.points,o=this.baseDimIdx,s=1-this.baseDimIdx,a=[],l=[],h=this.barWidth,u=0;u<r.length;u+=3)l[o]=h,l[s]=r[u+2],a[o]=r[u+o],a[s]=r[u+s],e.rect(a[0],a[1],l[0],l[1])},t}(Ee);function i3(n,t,e,i){var r=n.getData(),o=r.getLayout("valueAxisHorizontal")?1:0,s=r.getLayout("largeDataIndices"),a=r.getLayout("size"),l=n.getModel("backgroundStyle"),h=r.getLayout("largeBackgroundPoints");if(h){var u=new e3({shape:{points:h},incremental:!!i,silent:!0,z2:0});u.baseDimIdx=o,u.largeDataIndices=s,u.barWidth=a,u.useStyle(l.getItemStyle()),t.add(u),e&&e.push(u)}var d=new e3({shape:{points:r.getLayout("largePoints")},incremental:!!i,ignoreCoarsePointer:!0,z2:1});d.baseDimIdx=o,d.largeDataIndices=s,d.barWidth=a,t.add(d),d.useStyle(r.getVisual("style")),d.style.stroke=null,pe(d).seriesIndex=n.seriesIndex,n.get("silent")||(d.on("mousedown",n3),d.on("mousemove",n3)),e&&e.push(d)}var n3=aL(function(n){var t=this,e=Yct(t,n.offsetX,n.offsetY);pe(t).dataIndex=e>=0?e:null},30,!1);function Yct(n,t,e){for(var i=n.baseDimIdx,r=1-i,o=n.shape.points,s=n.largeDataIndices,a=[],l=[],h=n.barWidth,u=0,d=o.length/3;u<d;u++){var c=u*3;if(l[i]=h,l[r]=o[c+2],a[i]=o[c+i],a[r]=o[c+r],l[r]<0&&(a[r]+=l[r],l[r]=-l[r]),t>=a[0]&&t<=a[0]+l[0]&&e>=a[1]&&e<=a[1]+l[1])return s[u]}return-1}function Ej(n,t,e){if(VL(e,"cartesian2d")){var i=t,r=e.getArea();return{x:n?i.x:r.x,y:n?r.y:i.y,width:n?i.width:r.width,height:n?r.height:i.height}}else{var r=e.getArea(),o=t;return{cx:r.cx,cy:r.cy,r0:n?r.r0:o.r0,r:n?r.r:o.r,startAngle:n?o.startAngle:0,endAngle:n?o.endAngle:Math.PI*2}}}function Kct(n,t,e){var i=n.type==="polar"?xo:ci;return new i({shape:Ej(t,e,n),silent:!0,z2:0})}function x7t(n){n.registerChartView(Wct),n.registerSeriesModel(Ict),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,he(Xat,"bar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,Yat("bar")),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,Pj("bar")),n.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,e){var i=t.componentType||"series";e.eachComponent({mainType:i,query:t},function(r){t.sortInfo&&r.axis.setCategorySortInfo(t.sortInfo)})})}var r3=Math.PI*2,Ob=Math.PI/180;function Lj(n,t){return Na(n.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function Oj(n,t){var e=Lj(n,t),i=n.get("center"),r=n.get("radius");_t(r)||(r=[0,r]);var o=Jt(e.width,t.getWidth()),s=Jt(e.height,t.getHeight()),a=Math.min(o,s),l=Jt(r[0],a/2),h=Jt(r[1],a/2),u,d,c=n.coordinateSystem;if(c){var f=c.dataToPoint(i);u=f[0]||0,d=f[1]||0}else _t(i)||(i=[i,i]),u=Jt(i[0],o)+e.x,d=Jt(i[1],s)+e.y;return{cx:u,cy:d,r0:l,r:h}}function qct(n,t,e){t.eachSeriesByType(n,function(i){var r=i.getData(),o=r.mapDimension("value"),s=Lj(i,e),a=Oj(i,e),l=a.cx,h=a.cy,u=a.r,d=a.r0,c=-i.get("startAngle")*Ob,f=i.get("endAngle"),g=i.get("padAngle")*Ob;f=f==="auto"?c-r3:-f*Ob;var p=i.get("minAngle")*Ob,v=p+g,m=0;r.each(o,function(L){!isNaN(L)&&m++});var y=r.getSum(o),b=Math.PI/(y||m)*2,_=i.get("clockwise"),w=i.get("roseType"),C=i.get("stillShowZeroSum"),x=r.getDataExtent(o);x[0]=0;var S=_?1:-1,A=[c,f],T=S*g/2;i9(A,!_),c=A[0],f=A[1];var M=Dj(i);M.startAngle=c,M.endAngle=f,M.clockwise=_;var R=Math.abs(f-c),E=R,P=0,B=c;if(r.setLayout({viewRect:s,r:u}),r.each(o,function(L,O){var D;if(isNaN(L)){r.setItemLayout(O,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:_,cx:l,cy:h,r0:d,r:w?NaN:u});return}w!=="area"?D=y===0&&C?b:L*b:D=R/m,D<v?(D=v,E-=v):P+=L;var I=B+S*D,H=0,F=0;g>D?(H=B+S*D/2,F=H):(H=B+T,F=I-T),r.setItemLayout(O,{angle:D,startAngle:H,endAngle:F,clockwise:_,cx:l,cy:h,r0:d,r:w?Ui(L,x,[d,u]):u}),B=I}),E<r3&&m)if(E<=.001){var k=R/m;r.each(o,function(L,O){if(!isNaN(L)){var D=r.getItemLayout(O);D.angle=k;var I=0,H=0;k<g?(I=c+S*(O+1/2)*k,H=I):(I=c+S*O*k+T,H=c+S*(O+1)*k-T),D.startAngle=I,D.endAngle=H}})}else b=E/P,B=c,r.each(o,function(L,O){if(!isNaN(L)){var D=r.getItemLayout(O),I=D.angle===v?v:L*b,H=0,F=0;I<g?(H=B+S*I/2,F=H):(H=B+T,F=B+S*I-T),D.startAngle=H,D.endAngle=F,B+=S*I}})})}var Dj=Ke();function Ij(n){return{seriesType:n,reset:function(t,e){var i=e.findComponents({mainType:"legend"});if(!(!i||!i.length)){var r=t.getData();r.filterSelf(function(o){for(var s=r.getName(o),a=0;a<i.length;a++)if(!i[a].isSelected(s))return!1;return!0})}}}}var Zct=Math.PI/180;function o3(n,t,e,i,r,o,s,a,l,h){if(n.length<2)return;function u(p){for(var v=p.rB,m=v*v,y=0;y<p.list.length;y++){var b=p.list[y],_=Math.abs(b.label.y-e),w=i+b.len,C=w*w,x=Math.sqrt(Math.abs((1-_*_/m)*C)),S=t+(x+b.len2)*r,A=S-b.label.x,T=b.targetTextWidth-A*r;Hj(b,T,!0),b.label.x=S}}function d(p){for(var v={list:[],maxY:0},m={list:[],maxY:0},y=0;y<p.length;y++)if(p[y].labelAlignTo==="none"){var b=p[y],_=b.label.y>e?m:v,w=Math.abs(b.label.y-e);if(w>=_.maxY){var C=b.label.x-t-b.len2*r,x=i+b.len,S=Math.abs(C)<x?Math.sqrt(w*w/(1-C*C/x/x)):x;_.rB=S,_.maxY=w}_.list.push(b)}u(v),u(m)}for(var c=n.length,f=0;f<c;f++)if(n[f].position==="outer"&&n[f].labelAlignTo==="labelLine"){var g=n[f].label.x-h;n[f].linePoints[1][0]+=g,n[f].label.x=h}P7(n,l,l+s)&&d(n)}function Jct(n,t,e,i,r,o,s,a){for(var l=[],h=[],u=Number.MAX_VALUE,d=-Number.MAX_VALUE,c=0;c<n.length;c++){var f=n[c].label;XM(n[c])||(f.x<t?(u=Math.min(u,f.x),l.push(n[c])):(d=Math.max(d,f.x),h.push(n[c])))}for(var c=0;c<n.length;c++){var g=n[c];if(!XM(g)&&g.linePoints){if(g.labelStyleWidth!=null)continue;var f=g.label,p=g.linePoints,v=void 0;g.labelAlignTo==="edge"?f.x<t?v=p[2][0]-g.labelDistance-s-g.edgeDistance:v=s+r-g.edgeDistance-p[2][0]-g.labelDistance:g.labelAlignTo==="labelLine"?f.x<t?v=u-s-g.bleedMargin:v=s+r-d-g.bleedMargin:f.x<t?v=f.x-s-g.bleedMargin:v=s+r-f.x-g.bleedMargin,g.targetTextWidth=v,Hj(g,v)}}o3(h,t,e,i,1,r,o,s,a,d),o3(l,t,e,i,-1,r,o,s,a,u);for(var c=0;c<n.length;c++){var g=n[c];if(!XM(g)&&g.linePoints){var f=g.label,p=g.linePoints,m=g.labelAlignTo==="edge",y=f.style.padding,b=y?y[1]+y[3]:0,_=f.style.backgroundColor?0:b,w=g.rect.width+_,C=p[1][0]-p[2][0];m?f.x<t?p[2][0]=s+g.edgeDistance+w+g.labelDistance:p[2][0]=s+r-g.edgeDistance-w-g.labelDistance:(f.x<t?p[2][0]=f.x+g.labelDistance:p[2][0]=f.x-g.labelDistance,p[1][0]=p[2][0]+C),p[1][1]=p[2][1]=f.y}}}function Hj(n,t,e){if(e===void 0&&(e=!1),n.labelStyleWidth==null){var i=n.label,r=i.style,o=n.rect,s=r.backgroundColor,a=r.padding,l=a?a[1]+a[3]:0,h=r.overflow,u=o.width+(s?0:l);if(t<u||e){var d=o.height;if(h&&h.match("break")){i.setStyle("backgroundColor",null),i.setStyle("width",t-l);var c=i.getBoundingRect();i.setStyle("width",Math.ceil(c.width)),i.setStyle("backgroundColor",s)}else{var f=t-l,g=t<u?f:e?f>n.unconstrainedWidth?null:f:null;i.setStyle("width",g)}var p=i.getBoundingRect();o.width=p.width;var v=(i.style.margin||0)+2.1;o.height=p.height+v,o.y-=(o.height-d)/2}}}function XM(n){return n.position==="center"}function Qct(n){var t=n.getData(),e=[],i,r,o=!1,s=(n.get("minShowLabelAngle")||0)*Zct,a=t.getLayout("viewRect"),l=t.getLayout("r"),h=a.width,u=a.x,d=a.y,c=a.height;function f(C){C.ignore=!0}function g(C){if(!C.ignore)return!0;for(var x in C.states)if(C.states[x].ignore===!1)return!0;return!1}t.each(function(C){var x=t.getItemGraphicEl(C),S=x.shape,A=x.getTextContent(),T=x.getTextGuideLine(),M=t.getItemModel(C),R=M.getModel("label"),E=R.get("position")||M.get(["emphasis","label","position"]),P=R.get("distanceToLabelLine"),B=R.get("alignTo"),k=Jt(R.get("edgeDistance"),h),L=R.get("bleedMargin"),O=M.getModel("labelLine"),D=O.get("length");D=Jt(D,h);var I=O.get("length2");if(I=Jt(I,h),Math.abs(S.endAngle-S.startAngle)<s){N(A.states,f),A.ignore=!0,T&&(N(T.states,f),T.ignore=!0);return}if(g(A)){var H=(S.startAngle+S.endAngle)/2,F=Math.cos(H),G=Math.sin(H),j,W,K,J;i=S.cx,r=S.cy;var q=E==="inside"||E==="inner";if(E==="center")j=S.cx,W=S.cy,J="center";else{var X=(q?(S.r+S.r0)/2*F:S.r*F)+i,it=(q?(S.r+S.r0)/2*G:S.r*G)+r;if(j=X+F*3,W=it+G*3,!q){var Z=X+F*(D+l-S.r),et=it+G*(D+l-S.r),nt=Z+(F<0?-1:1)*I,z=et;B==="edge"?j=F<0?u+k:u+h-k:j=nt+(F<0?-P:P),W=z,K=[[X,it],[Z,et],[nt,z]]}J=q?"center":B==="edge"?F>0?"right":"left":F>0?"left":"right"}var V=Math.PI,$=0,U=R.get("rotate");if(di(U))$=U*(V/180);else if(E==="center")$=0;else if(U==="radial"||U===!0){var Q=F<0?-H+V:-H;$=Q}else if(U==="tangential"&&E!=="outside"&&E!=="outer"){var rt=Math.atan2(F,G);rt<0&&(rt=V*2+rt);var st=G>0;st&&(rt=V+rt),$=rt-V}if(o=!!$,A.x=j,A.y=W,A.rotation=$,A.setStyle({verticalAlign:"middle"}),q){A.setStyle({align:J});var gt=A.states.select;gt&&(gt.x+=A.x,gt.y+=A.y)}else{var at=A.getBoundingRect().clone();at.applyTransform(A.getComputedTransform());var ht=(A.style.margin||0)+2.1;at.y-=ht/2,at.height+=ht,e.push({label:A,labelLine:T,position:E,len:D,len2:I,minTurnAngle:O.get("minTurnAngle"),maxSurfaceAngle:O.get("maxSurfaceAngle"),surfaceNormal:new Vt(F,G),linePoints:K,textAlign:J,labelDistance:P,labelAlignTo:B,edgeDistance:k,bleedMargin:L,rect:at,unconstrainedWidth:at.width,labelStyleWidth:A.style.width})}x.setTextConfig({inside:q})}}),!o&&n.get("avoidLabelOverlap")&&Jct(e,i,r,l,h,c,u,d);for(var p=0;p<e.length;p++){var v=e[p],m=v.label,y=v.labelLine,b=isNaN(m.x)||isNaN(m.y);if(m){m.setStyle({align:v.textAlign}),b&&(N(m.states,f),m.ignore=!0);var _=m.states.select;_&&(_.x+=m.x,_.y+=m.y)}if(y){var w=v.linePoints;b||!w?(N(y.states,f),y.ignore=!0):(A7(w,v.minTurnAngle),Plt(w,v.surfaceNormal,v.maxSurfaceAngle),y.setShape({points:w}),m.__hostTarget.textGuideLineConfig={anchor:new Vt(w[0][0],w[0][1])})}}}var tft=function(n){ct(t,n);function t(e,i,r){var o=n.call(this)||this;o.z2=2;var s=new Vi;return o.setTextContent(s),o.updateData(e,i,r,!0),o}return t.prototype.updateData=function(e,i,r,o){var s=this,a=e.hostModel,l=e.getItemModel(i),h=l.getModel("emphasis"),u=e.getItemLayout(i),d=ft(wd(l.getModel("itemStyle"),u,!0),u);if(isNaN(d.startAngle)){s.setShape(d);return}if(o){s.setShape(d);var c=a.getShallow("animationType");a.ecModel.ssr?(nr(s,{scaleX:0,scaleY:0},a,{dataIndex:i,isFrom:!0}),s.originX=d.cx,s.originY=d.cy):c==="scale"?(s.shape.r=u.r0,nr(s,{shape:{r:u.r}},a,i)):r!=null?(s.setShape({startAngle:r,endAngle:r}),nr(s,{shape:{startAngle:u.startAngle,endAngle:u.endAngle}},a,i)):(s.shape.endAngle=u.startAngle,En(s,{shape:{endAngle:u.endAngle}},a,i))}else dS(s),En(s,{shape:d},a,i);s.useStyle(e.getItemVisual(i,"style")),zC(s,l);var f=(u.startAngle+u.endAngle)/2,g=a.get("selectedOffset"),p=Math.cos(f)*g,v=Math.sin(f)*g,m=l.getShallow("cursor");m&&s.attr("cursor",m),this._updateLabel(a,e,i),s.ensureState("emphasis").shape=ft({r:u.r+(h.get("scale")&&h.get("scaleSize")||0)},wd(h.getModel("itemStyle"),u)),ft(s.ensureState("select"),{x:p,y:v,shape:wd(l.getModel(["select","itemStyle"]),u)}),ft(s.ensureState("blur"),{shape:wd(l.getModel(["blur","itemStyle"]),u)});var y=s.getTextGuideLine(),b=s.getTextContent();y&&ft(y.ensureState("select"),{x:p,y:v}),ft(b.ensureState("select"),{x:p,y:v}),ic(this,h.get("focus"),h.get("blurScope"),h.get("disabled"))},t.prototype._updateLabel=function(e,i,r){var o=this,s=i.getItemModel(r),a=s.getModel("labelLine"),l=i.getItemVisual(r,"style"),h=l&&l.fill,u=l&&l.opacity;cp(o,fp(s),{labelFetcher:i.hostModel,labelDataIndex:r,inheritColor:h,defaultOpacity:u,defaultText:e.getFormattedLabel(r,"normal")||i.getName(r)});var d=o.getTextContent();o.setTextConfig({position:null,rotation:null}),d.attr({z2:10});var c=e.get(["label","position"]);if(c!=="outside"&&c!=="outer")o.removeTextGuideLine();else{var f=this.getTextGuideLine();f||(f=new Tc,this.setTextGuideLine(f)),T7(this,M7(s),{stroke:h,opacity:e0(a.get(["lineStyle","opacity"]),u,1)})}},t}(xo),eft=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.ignoreLabelLineUpdate=!0,e}return t.prototype.render=function(e,i,r,o){var s=e.getData(),a=this._data,l=this.group,h;if(!a&&s.count()>0){for(var u=s.getItemLayout(0),d=1;isNaN(u&&u.startAngle)&&d<s.count();++d)u=s.getItemLayout(d);u&&(h=u.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),s.count()===0&&e.get("showEmptyCircle")){var c=Dj(e),f=new xo({shape:ft(Oj(e,r),c)});f.useStyle(e.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=f,l.add(f)}s.diff(a).add(function(g){var p=new tft(s,g,h);s.setItemGraphicEl(g,p),l.add(p)}).update(function(g,p){var v=a.getItemGraphicEl(p);v.updateData(s,g,h),v.off("click"),l.add(v),s.setItemGraphicEl(g,v)}).remove(function(g){var p=a.getItemGraphicEl(g);VC(p,e,g)}).execute(),Qct(e),e.get("animationTypeUpdate")!=="expansion"&&(this._data=s)},t.prototype.dispose=function(){},t.prototype.containPoint=function(e,i){var r=i.getData(),o=r.getItemLayout(0);if(o){var s=e[0]-o.cx,a=e[1]-o.cy,l=Math.sqrt(s*s+a*a);return l<=o.r&&l>=o.r0}},t.type="pie",t}(Ur);function ift(n,t,e){t=_t(t)&&{coordDimensions:t}||ft({encodeDefine:n.getEncode()},t);var i=n.getSource(),r=gL(i,t).dimensions,o=new fL(r,n);return o.initData(i,e),o}var nft=function(){function n(t,e){this._getDataWithEncodedVisual=t,this._getRawData=e}return n.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},n.prototype.containName=function(t){var e=this._getRawData();return e.indexOfName(t)>=0},n.prototype.indexOfName=function(t){var e=this._getDataWithEncodedVisual();return e.indexOfName(t)},n.prototype.getItemVisual=function(t,e){var i=this._getDataWithEncodedVisual();return i.getItemVisual(t,e)},n}(),rft=Ke(),oft=function(n){ct(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t.prototype.init=function(e){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new nft(zt(this.getData,this),zt(this.getRawData,this)),this._defaultLabelLine(e)},t.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return ift(this,{coordDimensions:["value"],encodeDefaulter:he(krt,this)})},t.prototype.getDataParams=function(e){var i=this.getData(),r=rft(i),o=r.seats;if(!o){var s=[];i.each(i.mapDimension("value"),function(l){s.push(l)}),o=r.seats=Det(s,i.hostModel.get("percentPrecision"))}var a=n.prototype.getDataParams.call(this,e);return a.percent=o[e]||0,a.$vars.push("percent"),a},t.prototype._defaultLabelLine=function(e){K2(e,"labelLine",["show"]);var i=e.labelLine,r=e.emphasis.labelLine;i.show=i.show&&e.label.show,r.show=r.show&&e.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(Ao);function sft(n){return{seriesType:n,reset:function(t,e){var i=t.getData();i.filterSelf(function(r){var o=i.mapDimension("value"),s=i.get(o,r);return!(di(s)&&!isNaN(s)&&s<0)})}}}function S7t(n){n.registerChartView(eft),n.registerSeriesModel(oft),gst("pie",n.registerAction),n.registerLayout(he(qct,"pie")),n.registerProcessor(Ij("pie")),n.registerProcessor(sft("pie"))}var cs=Ke();function aft(n){var t=n.mainData,e=n.datas;e||(e={main:t},n.datasAttr={main:"data"}),n.datas=n.mainData=null,Fj(t,e,n),N(e,function(i){N(t.TRANSFERABLE_METHODS,function(r){i.wrapMethod(r,he(lft,n))})}),t.wrapMethod("cloneShallow",he(uft,n)),N(t.CHANGABLE_METHODS,function(i){t.wrapMethod(i,he(hft,n))}),ps(e[t.dataType]===t)}function lft(n,t){if(fft(this)){var e=ft({},cs(this).datas);e[this.dataType]=t,Fj(t,e,n)}else $L(t,this.dataType,cs(this).mainData,n);return t}function hft(n,t){return n.struct&&n.struct.update(),t}function uft(n,t){return N(cs(t).datas,function(e,i){e!==t&&$L(e.cloneShallow(),i,t,n)}),t}function dft(n){var t=cs(this).mainData;return n==null||t==null?t:cs(t).datas[n]}function cft(){var n=cs(this).mainData;return n==null?[{data:n}]:St(yi(cs(n).datas),function(t){return{type:t,data:cs(n).datas[t]}})}function fft(n){return cs(n).mainData===n}function Fj(n,t,e){cs(n).datas={},N(t,function(i,r){$L(i,r,n,e)})}function $L(n,t,e,i){cs(e).datas[t]=n,cs(n).mainData=e,n.dataType=t,i.struct&&(n[i.structAttr]=i.struct,i.struct[i.datasAttr[t]]=n),n.getLinkedData=dft,n.getLinkedDataAll=cft}var gft=function(){function n(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return n.prototype.isRemoved=function(){return this.dataIndex<0},n.prototype.eachNode=function(t,e,i){jt(t)&&(i=e,e=t,t=null),t=t||{},Pt(t)&&(t={order:t});var r=t.order||"preorder",o=this[t.attr||"children"],s;r==="preorder"&&(s=e.call(i,this));for(var a=0;!s&&a<o.length;a++)o[a].eachNode(t,e,i);r==="postorder"&&e.call(i,this)},n.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var r=this.children[i];r.updateDepthAndHeight(t+1),r.height>e&&(e=r.height)}this.height=e+1},n.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,i=this.children,r=i.length;e<r;e++){var o=i[e].getNodeById(t);if(o)return o}},n.prototype.contains=function(t){if(t===this)return!0;for(var e=0,i=this.children,r=i.length;e<r;e++){var o=i[e].contains(t);if(o)return o}},n.prototype.getAncestors=function(t){for(var e=[],i=t?this:this.parentNode;i;)e.push(i),i=i.parentNode;return e.reverse(),e},n.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},n.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(e){t.push(e.dataIndex)}),t},n.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},n.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},n.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},n.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostTree,i=e.data.getItemModel(this.dataIndex);return i.getModel(t)}},n.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},n.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},n.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},n.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},n.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},n.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},n.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},n.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},n}(),zj=function(){function n(t){this.type="tree",this._nodes=[],this.hostModel=t}return n.prototype.eachNode=function(t,e,i){this.root.eachNode(t,e,i)},n.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},n.prototype.getNodeById=function(t){return this.root.getNodeById(t)},n.prototype.update=function(){for(var t=this.data,e=this._nodes,i=0,r=e.length;i<r;i++)e[i].dataIndex=-1;for(var i=0,r=t.count();i<r;i++)e[t.getRawIndex(i)].dataIndex=i},n.prototype.clearLayouts=function(){this.data.clearItemLayouts()},n.createTree=function(t,e,i){var r=new n(e),o=[],s=1;a(t);function a(u,d){var c=u.value;s=Math.max(s,_t(c)?c.length:1),o.push(u);var f=new gft(_o(u.name,""),r);d?pft(f,d):r.root=f,r._nodes.push(f);var g=u.children;if(g)for(var p=0;p<g.length;p++)a(g[p],f)}r.root.updateDepthAndHeight(0);var l=gL(o,{coordDimensions:["value"],dimensionsCount:s}).dimensions,h=new fL(l,e);return h.initData(o),i&&i(h),aft({mainData:h,struct:r,structAttr:"tree"}),r.update(),r},n}();function pft(n,t){var e=t.children;n.parentNode!==t&&(e.push(n),n.parentNode=t)}function sm(n,t,e){if(n&&_e(t,n.type)>=0){var i=e.getData().tree.root,r=n.targetNode;if(Pt(r)&&(r=i.getNodeById(r)),r&&i.contains(r))return{node:r};var o=n.targetNodeId;if(o!=null&&(r=i.getNodeById(o)))return{node:r}}}function Nj(n){for(var t=[];n;)n=n.parentNode,n&&t.push(n);return t.reverse()}function jL(n,t){var e=Nj(n);return _e(e,t)>=0}function UL(n,t){for(var e=[];n;){var i=n.dataIndex;e.push({name:n.name,dataIndex:i,value:t.getRawValue(i)}),n=n.parentNode}return e.reverse(),e}var s3=["treemapZoomToNode","treemapRender","treemapMove"];function vft(n){for(var t=0;t<s3.length;t++)n.registerAction({type:s3[t],update:"updateView"},ir);n.registerAction({type:"treemapRootToNode",update:"updateView"},function(e,i){i.eachComponent({mainType:"series",subType:"treemap",query:e},r);function r(o,s){var a=["treemapZoomToNode","treemapRootToNode"],l=sm(e,a,o);if(l){var h=o.getViewRoot();h&&(e.direction=jL(h,l.node)?"rollUp":"drillDown"),o.resetViewRoot(l.node)}}})}function Wj(n){var t=n.getData(),e=t.tree,i={};e.eachNode(function(r){for(var o=r;o&&o.depth>1;)o=o.parentNode;var s=Irt(n.ecModel,o.name||o.dataIndex+"",i);r.setVisual("decal",s)})}var mft=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.preventUsingHoverLayer=!0,e}return t.prototype.getInitialData=function(e,i){var r={name:e.name,children:e.data};Vj(r);var o=e.levels||[],s=this.designatedVisualItemStyle={},a=new ui({itemStyle:s},this,i);o=e.levels=yft(o,i);var l=St(o||[],function(d){return new ui(d,a,i)},this),h=zj.createTree(r,this,u);function u(d){d.wrapMethod("getItemModel",function(c,f){var g=h.getNodeByDataIndex(f),p=g?l[g.depth]:null;return c.parentModel=p||a,c})}return h.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.formatTooltip=function(e,i,r){var o=this.getData(),s=this.getRawValue(e),a=o.getName(e);return Sg("nameValue",{name:a,value:s})},t.prototype.getDataParams=function(e){var i=n.prototype.getDataParams.apply(this,arguments),r=this.getData().tree.getNodeByDataIndex(e);return i.treeAncestors=UL(r,this),i.treePathInfo=i.treeAncestors,i},t.prototype.setLayoutInfo=function(e){this.layoutInfo=this.layoutInfo||{},ft(this.layoutInfo,e)},t.prototype.mapIdToIndex=function(e){var i=this._idIndexMap;i||(i=this._idIndexMap=$t(),this._idIndexMapCount=0);var r=i.get(e);return r==null&&i.set(e,r=this._idIndexMapCount++),r},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var i=this.getRawData().tree.root;(!e||e!==i&&!i.contains(e))&&(this._viewRoot=i)},t.prototype.enableAriaDecal=function(){Wj(this)},t.type="series.treemap",t.layoutMode="box",t.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"",zoomToNodeRatio:.32*.32,scaleLimit:null,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},t}(Ao);function Vj(n){var t=0;N(n.children,function(i){Vj(i);var r=i.value;_t(r)&&(r=r[0]),t+=r});var e=n.value;_t(e)&&(e=e[0]),(e==null||isNaN(e))&&(e=t),e<0&&(e=0),_t(n.value)?n.value[0]=e:n.value=e}function yft(n,t){var e=Ni(t.get("color")),i=Ni(t.get(["aria","decal","decals"]));if(e){n=n||[];var r,o;N(n,function(a){var l=new ui(a),h=l.get("color"),u=l.get("decal");(l.get(["itemStyle","color"])||h&&h!=="none")&&(r=!0),(l.get(["itemStyle","decal"])||u&&u!=="none")&&(o=!0)});var s=n[0]||(n[0]={});return r||(s.color=e.slice()),!o&&i&&(s.decal=i.slice()),n}}var bft=8,a3=8,YM=5,_ft=function(){function n(t){this.group=new bi,t.add(this.group)}return n.prototype.render=function(t,e,i,r){var o=t.getModel("breadcrumb"),s=this.group;if(s.removeAll(),!(!o.get("show")||!i)){var a=o.getModel("itemStyle"),l=o.getModel("emphasis"),h=a.getModel("textStyle"),u=l.getModel(["itemStyle","textStyle"]),d={pos:{left:o.get("left"),right:o.get("right"),top:o.get("top"),bottom:o.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:o.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(i,d,h),this._renderContent(t,d,a,l,h,u,r),X9(s,d.pos,d.box)}},n.prototype._prepare=function(t,e,i){for(var r=t;r;r=r.parentNode){var o=_o(r.getModel().get("name"),""),s=i.getTextRect(o),a=Math.max(s.width+bft*2,e.emptyItemWidth);e.totalWidth+=a+a3,e.renderList.push({node:r,text:o,width:a})}},n.prototype._renderContent=function(t,e,i,r,o,s,a){for(var l=0,h=e.emptyItemWidth,u=t.get(["breadcrumb","height"]),d=Srt(e.pos,e.box),c=e.totalWidth,f=e.renderList,g=r.getModel("itemStyle").getItemStyle(),p=f.length-1;p>=0;p--){var v=f[p],m=v.node,y=v.width,b=v.text;c>d.width&&(c-=y-h,y=h,b=null);var _=new Ac({shape:{points:Cft(l,0,y,u,p===f.length-1,p===0)},style:Gt(i.getItemStyle(),{lineJoin:"bevel"}),textContent:new Vi({style:So(o,{text:b})}),textConfig:{position:"inside"},z2:ay*1e4,onclick:he(a,m)});_.disableLabelAnimation=!0,_.getTextContent().ensureState("emphasis").style=So(s,{text:b}),_.ensureState("emphasis").style=g,ic(_,r.get("focus"),r.get("blurScope"),r.get("disabled")),this.group.add(_),wft(_,t,m),l+=y+a3}},n.prototype.remove=function(){this.group.removeAll()},n}();function Cft(n,t,e,i,r,o){var s=[[r?n:n-YM,t],[n+e,t],[n+e,t+i],[r?n:n-YM,t+i]];return!o&&s.splice(2,0,[n+e+YM,t+i/2]),!r&&s.push([n,t+i/2]),s}function wft(n,t,e){pe(n).eventData={componentType:"series",componentSubType:"treemap",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:e&&e.dataIndex,name:e&&e.name},treePathInfo:e&&UL(e,t)}}var xft=function(){function n(){this._storage=[],this._elExistsMap={}}return n.prototype.add=function(t,e,i,r,o){return this._elExistsMap[t.id]?!1:(this._elExistsMap[t.id]=!0,this._storage.push({el:t,target:e,duration:i,delay:r,easing:o}),!0)},n.prototype.finished=function(t){return this._finishedCallback=t,this},n.prototype.start=function(){for(var t=this,e=this._storage.length,i=function(){e--,e<=0&&(t._storage.length=0,t._elExistsMap={},t._finishedCallback&&t._finishedCallback())},r=0,o=this._storage.length;r<o;r++){var s=this._storage[r];s.el.animateTo(s.target,{duration:s.duration,delay:s.delay,easing:s.easing,setToFinal:!0,done:i,aborted:i})}return this},n}();function Sft(){return new xft}var $B=bi,l3=ci,h3=3,u3="label",d3="upperLabel",Aft=ay*10,Tft=ay*2,Mft=ay*3,qu=yg([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),c3=function(n){var t=qu(n);return t.stroke=t.fill=t.lineWidth=null,t},hw=Ke(),Rft=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e._state="ready",e._storage=hv(),e}return t.prototype.render=function(e,i,r,o){var s=i.findComponents({mainType:"series",subType:"treemap",query:o});if(!(_e(s,e)<0)){this.seriesModel=e,this.api=r,this.ecModel=i;var a=["treemapZoomToNode","treemapRootToNode"],l=sm(o,a,e),h=o&&o.type,u=e.layoutInfo,d=!this._oldTree,c=this._storage,f=h==="treemapRootToNode"&&l&&c?{rootNodeGroup:c.nodeGroup[l.node.getRawIndex()],direction:o.direction}:null,g=this._giveContainerGroup(u),p=e.get("animation"),v=this._doRender(g,e,f);p&&!d&&(!h||h==="treemapZoomToNode"||h==="treemapRootToNode")?this._doAnimation(g,v,e,f):v.renderFinally(),this._resetController(r),this._renderBreadcrumb(e,r,l)}},t.prototype._giveContainerGroup=function(e){var i=this._containerGroup;return i||(i=this._containerGroup=new $B,this._initEvents(i),this.group.add(i)),i.x=e.x,i.y=e.y,i},t.prototype._doRender=function(e,i,r){var o=i.getData().tree,s=this._oldTree,a=hv(),l=hv(),h=this._storage,u=[];function d(y,b,_,w){return Bft(i,l,h,r,a,u,y,b,_,w)}p(o.root?[o.root]:[],s&&s.root?[s.root]:[],e,o===s||!s,0);var c=v(h);if(this._oldTree=o,this._storage=l,this._controllerHost){var f=this.seriesModel.layoutInfo,g=o.root.getLayout();g.width===f.width&&g.height===f.height&&(this._controllerHost.zoom=1)}return{lastsForAnimation:a,willDeleteEls:c,renderFinally:m};function p(y,b,_,w,C){w?(b=y,N(y,function(A,T){!A.isRemoved()&&S(T,T)})):new rc(b,y,x,x).add(S).update(S).remove(he(S,null)).execute();function x(A){return A.getId()}function S(A,T){var M=A!=null?y[A]:null,R=T!=null?b[T]:null,E=d(M,R,_,C);E&&p(M&&M.viewChildren||[],R&&R.viewChildren||[],E,w,C+1)}}function v(y){var b=hv();return y&&N(y,function(_,w){var C=b[w];N(_,function(x){x&&(C.push(x),hw(x).willDelete=!0)})}),b}function m(){N(c,function(y){N(y,function(b){b.parent&&b.parent.remove(b)})}),N(u,function(y){y.invisible=!0,y.dirty()})}},t.prototype._doAnimation=function(e,i,r,o){var s=r.get("animationDurationUpdate"),a=r.get("animationEasing"),l=(jt(s)?0:s)||0,h=(jt(a)?null:a)||"cubicOut",u=Sft();N(i.willDeleteEls,function(d,c){N(d,function(f,g){if(!f.invisible){var p=f.parent,v,m=hw(p);if(o&&o.direction==="drillDown")v=p===o.rootNodeGroup?{shape:{x:0,y:0,width:m.nodeWidth,height:m.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var y=0,b=0;m.willDelete||(y=m.nodeWidth/2,b=m.nodeHeight/2),v=c==="nodeGroup"?{x:y,y:b,style:{opacity:0}}:{shape:{x:y,y:b,width:0,height:0},style:{opacity:0}}}v&&u.add(f,v,l,0,h)}})}),N(this._storage,function(d,c){N(d,function(f,g){var p=i.lastsForAnimation[c][g],v={};p&&(f instanceof bi?p.oldX!=null&&(v.x=f.x,v.y=f.y,f.x=p.oldX,f.y=p.oldY):(p.oldShape&&(v.shape=ft({},f.shape),f.setShape(p.oldShape)),p.fadein?(f.setStyle("opacity",0),v.style={opacity:1}):f.style.opacity!==1&&(v.style={opacity:1})),u.add(f,v,l,0,h))})},this),this._state="animating",u.finished(zt(function(){this._state="ready",i.renderFinally()},this)).start()},t.prototype._resetController=function(e){var i=this._controller,r=this._controllerHost;r||(this._controllerHost={target:this.group},r=this._controllerHost),i||(i=this._controller=new Y7(e.getZr()),i.enable(this.seriesModel.get("roam")),r.zoomLimit=this.seriesModel.get("scaleLimit"),r.zoom=this.seriesModel.get("zoom"),i.on("pan",zt(this._onPan,this)),i.on("zoom",zt(this._onZoom,this)));var o=new Te(0,0,e.getWidth(),e.getHeight());i.setPointerChecker(function(s,a,l){return o.contain(a,l)})},t.prototype._clearController=function(){var e=this._controller;this._controllerHost=null,e&&(e.dispose(),e=null)},t.prototype._onPan=function(e){if(this._state!=="animating"&&(Math.abs(e.dx)>h3||Math.abs(e.dy)>h3)){var i=this.seriesModel.getData().tree.root;if(!i)return;var r=i.getLayout();if(!r)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:r.x+e.dx,y:r.y+e.dy,width:r.width,height:r.height}})}},t.prototype._onZoom=function(e){var i=e.originX,r=e.originY,o=e.scale;if(this._state!=="animating"){var s=this.seriesModel.getData().tree.root;if(!s)return;var a=s.getLayout();if(!a)return;var l=new Te(a.x,a.y,a.width,a.height),h=null,u=this._controllerHost;h=u.zoomLimit;var d=u.zoom=u.zoom||1;if(d*=o,h){var c=h.min||0,f=h.max||1/0;d=Math.max(Math.min(f,d),c)}var g=d/u.zoom;u.zoom=d;var p=this.seriesModel.layoutInfo;i-=p.x,r-=p.y;var v=Nh();mg(v,v,[-i,-r]),y8(v,v,[g,g]),mg(v,v,[i,r]),l.applyTransform(v),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:l.x,y:l.y,width:l.width,height:l.height}})}},t.prototype._initEvents=function(e){var i=this;e.on("click",function(r){if(i._state==="ready"){var o=i.seriesModel.get("nodeClick",!0);if(o){var s=i.findTarget(r.offsetX,r.offsetY);if(s){var a=s.node;if(a.getLayout().isLeafRoot)i._rootToNode(s);else if(o==="zoomToNode")i._zoomToNode(s);else if(o==="link"){var l=a.hostTree.data.getItemModel(a.dataIndex),h=l.get("link",!0),u=l.get("target",!0)||"blank";h&&UC(h,u)}}}}},this)},t.prototype._renderBreadcrumb=function(e,i,r){var o=this;r||(r=e.get("leafDepth",!0)!=null?{node:e.getViewRoot()}:this.findTarget(i.getWidth()/2,i.getHeight()/2),r||(r={node:e.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new _ft(this.group))).render(e,i,r.node,function(s){o._state!=="animating"&&(jL(e.getViewRoot(),s)?o._rootToNode({node:s}):o._zoomToNode({node:s}))})},t.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=hv(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},t.prototype.dispose=function(){this._clearController()},t.prototype._zoomToNode=function(e){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},t.prototype._rootToNode=function(e){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:e.node})},t.prototype.findTarget=function(e,i){var r,o=this.seriesModel.getViewRoot();return o.eachNode({attr:"viewChildren",order:"preorder"},function(s){var a=this._storage.background[s.getRawIndex()];if(a){var l=a.transformCoordToLocal(e,i),h=a.shape;if(h.x<=l[0]&&l[0]<=h.x+h.width&&h.y<=l[1]&&l[1]<=h.y+h.height)r={node:s,offsetX:l[0],offsetY:l[1]};else return!1}},this),r},t.type="treemap",t}(Ur);function hv(){return{nodeGroup:[],background:[],content:[]}}function Bft(n,t,e,i,r,o,s,a,l,h){if(!s)return;var u=s.getLayout(),d=n.getData(),c=s.getModel();if(d.setItemGraphicEl(s.dataIndex,null),!u||!u.isInView)return;var f=u.width,g=u.height,p=u.borderWidth,v=u.invisible,m=s.getRawIndex(),y=a&&a.getRawIndex(),b=s.viewChildren,_=u.upperHeight,w=b&&b.length,C=c.getModel("itemStyle"),x=c.getModel(["emphasis","itemStyle"]),S=c.getModel(["blur","itemStyle"]),A=c.getModel(["select","itemStyle"]),T=C.get("borderRadius")||0,M=W("nodeGroup",$B);if(!M)return;if(l.add(M),M.x=u.x||0,M.y=u.y||0,M.markRedraw(),hw(M).nodeWidth=f,hw(M).nodeHeight=g,u.isAboveViewRoot)return M;var R=W("background",l3,h,Tft);R&&I(M,R,w&&u.upperLabelHeight);var E=c.getModel("emphasis"),P=E.get("focus"),B=E.get("blurScope"),k=E.get("disabled"),L=P==="ancestor"?s.getAncestorsIndices():P==="descendant"?s.getDescendantIndices():P;if(w)Y0(M)&&Mf(M,!1),R&&(Mf(R,!k),d.setItemGraphicEl(s.dataIndex,R),iB(R,L,B));else{var O=W("content",l3,h,Mft);O&&H(M,O),R.disableMorphing=!0,R&&Y0(R)&&Mf(R,!1),Mf(M,!k),d.setItemGraphicEl(s.dataIndex,M);var D=c.getShallow("cursor");D&&O.attr("cursor",D),iB(M,L,B)}return M;function I(q,X,it){var Z=pe(X);if(Z.dataIndex=s.dataIndex,Z.seriesIndex=n.seriesIndex,X.setShape({x:0,y:0,width:f,height:g,r:T}),v)F(X);else{X.invisible=!1;var et=s.getVisual("style"),nt=et.stroke,z=c3(C);z.fill=nt;var V=qu(x);V.fill=x.get("borderColor");var $=qu(S);$.fill=S.get("borderColor");var U=qu(A);if(U.fill=A.get("borderColor"),it){var Q=f-2*p;G(X,nt,et.opacity,{x:p,y:0,width:Q,height:_})}else X.removeTextContent();X.setStyle(z),X.ensureState("emphasis").style=V,X.ensureState("blur").style=$,X.ensureState("select").style=U,Q2(X)}q.add(X)}function H(q,X){var it=pe(X);it.dataIndex=s.dataIndex,it.seriesIndex=n.seriesIndex;var Z=Math.max(f-2*p,0),et=Math.max(g-2*p,0);if(X.culling=!0,X.setShape({x:p,y:p,width:Z,height:et,r:T}),v)F(X);else{X.invisible=!1;var nt=s.getVisual("style"),z=nt.fill,V=c3(C);V.fill=z,V.decal=nt.decal;var $=qu(x),U=qu(S),Q=qu(A);G(X,z,nt.opacity,null),X.setStyle(V),X.ensureState("emphasis").style=$,X.ensureState("blur").style=U,X.ensureState("select").style=Q,Q2(X)}q.add(X)}function F(q){!q.invisible&&o.push(q)}function G(q,X,it,Z){var et=c.getModel(Z?d3:u3),nt=_o(c.get("name"),null),z=et.getShallow("show");cp(q,fp(c,Z?d3:u3),{defaultText:z?nt:null,inheritColor:X,defaultOpacity:it,labelFetcher:n,labelDataIndex:s.dataIndex});var V=q.getTextContent();if(V){var $=V.style,U=TE($.padding||0);Z&&(q.setTextConfig({layoutRect:Z}),V.disableLabelLayout=!0),V.beforeUpdate=function(){var rt=Math.max((Z?Z.width:q.shape.width)-U[1]-U[3],0),st=Math.max((Z?Z.height:q.shape.height)-U[0]-U[2],0);($.width!==rt||$.height!==st)&&V.setStyle({width:rt,height:st})},$.truncateMinChar=2,$.lineOverflow="truncate",j($,Z,u);var Q=V.getState("emphasis");j(Q?Q.style:null,Z,u)}}function j(q,X,it){var Z=q?q.text:null;if(!X&&it.isLeafRoot&&Z!=null){var et=n.get("drillDownIcon",!0);q.text=et?et+" "+Z:Z}}function W(q,X,it,Z){var et=y!=null&&e[q][y],nt=r[q];return et?(e[q][y]=null,K(nt,et)):v||(et=new X,et instanceof Sc&&(et.z2=Pft(it,Z)),J(nt,et)),t[q][m]=et}function K(q,X){var it=q[m]={};X instanceof $B?(it.oldX=X.x,it.oldY=X.y):it.oldShape=ft({},X.shape)}function J(q,X){var it=q[m]={},Z=s.parentNode,et=X instanceof bi;if(Z&&(!i||i.direction==="drillDown")){var nt=0,z=0,V=r.background[Z.getRawIndex()];!i&&V&&V.oldShape&&(nt=V.oldShape.width,z=V.oldShape.height),et?(it.oldX=0,it.oldY=z):it.oldShape={x:nt,y:z,width:0,height:0}}it.fadein=!et}}function Pft(n,t){return n*Aft+t}var kft="itemStyle",Gj=Ke();const Eft={seriesType:"treemap",reset:function(n){var t=n.getData().tree,e=t.root;e.isRemoved()||$j(e,{},n.getViewRoot().getAncestors(),n)}};function $j(n,t,e,i){var r=n.getModel(),o=n.getLayout(),s=n.hostTree.data;if(!(!o||o.invisible||!o.isInView)){var a=r.getModel(kft),l=Lft(a,t,i),h=s.ensureUniqueItemVisual(n.dataIndex,"style"),u=a.get("borderColor"),d=a.get("borderColorSaturation"),c;d!=null&&(c=f3(l),u=Oft(d,c)),h.stroke=u;var f=n.viewChildren;if(!f||!f.length)c=f3(l),h.fill=c;else{var g=Dft(n,r,o,a,l,f);N(f,function(p,v){if(p.depth>=e.length||p===e[p.depth]){var m=Ift(r,l,p,v,g,i);$j(p,m,e,i)}})}}}function Lft(n,t,e){var i=ft({},t),r=e.designatedVisualItemStyle;return N(["color","colorAlpha","colorSaturation"],function(o){r[o]=t[o];var s=n.get(o);r[o]=null,s!=null&&(i[o]=s)}),i}function f3(n){var t=KM(n,"color");if(t){var e=KM(n,"colorAlpha"),i=KM(n,"colorSaturation");return i&&(t=r0(t,null,null,i)),e&&(t=E8(t,e)),t}}function Oft(n,t){return t!=null?r0(t,null,null,n):null}function KM(n,t){var e=n[t];if(e!=null&&e!=="none")return e}function Dft(n,t,e,i,r,o){if(!(!o||!o.length)){var s=qM(t,"color")||r.color!=null&&r.color!=="none"&&(qM(t,"colorAlpha")||qM(t,"colorSaturation"));if(s){var a=t.get("visualMin"),l=t.get("visualMax"),h=e.dataExtent.slice();a!=null&&a<h[0]&&(h[0]=a),l!=null&&l>h[1]&&(h[1]=l);var u=t.get("colorMappingBy"),d={type:s.name,dataExtent:h,visual:s.range};d.type==="color"&&(u==="index"||u==="id")?(d.mappingMethod="category",d.loop=!0):d.mappingMethod="linear";var c=new zL(d);return Gj(c).drColorMappingBy=u,c}}}function qM(n,t){var e=n.get(t);return _t(e)&&e.length?{name:t,range:e}:null}function Ift(n,t,e,i,r,o){var s=ft({},t);if(r){var a=r.type,l=a==="color"&&Gj(r).drColorMappingBy,h=l==="index"?i:l==="id"?o.mapIdToIndex(e.getId()):e.getValue(n.get("visualDimension"));s[a]=r.mapValueToVisual(h)}return s}var am=Math.max,uw=Math.min,g3=pg,XL=N,jj=["itemStyle","borderWidth"],Hft=["itemStyle","gapWidth"],Fft=["upperLabel","show"],zft=["upperLabel","height"];const Nft={seriesType:"treemap",reset:function(n,t,e,i){var r=e.getWidth(),o=e.getHeight(),s=n.option,a=Na(n.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),l=s.size||[],h=Jt(g3(a.width,l[0]),r),u=Jt(g3(a.height,l[1]),o),d=i&&i.type,c=["treemapZoomToNode","treemapRootToNode"],f=sm(i,c,n),g=d==="treemapRender"||d==="treemapMove"?i.rootRect:null,p=n.getViewRoot(),v=Nj(p);if(d!=="treemapMove"){var m=d==="treemapZoomToNode"?Uft(n,f,p,h,u):g?[g.width,g.height]:[h,u],y=s.sort;y&&y!=="asc"&&y!=="desc"&&(y="desc");var b={squareRatio:s.squareRatio,sort:y,leafDepth:s.leafDepth};p.hostTree.clearLayouts();var _={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};p.setLayout(_),Uj(p,b,!1,0),_=p.getLayout(),XL(v,function(C,x){var S=(v[x+1]||p).getValue();C.setLayout(ft({dataExtent:[S,S],borderWidth:0,upperHeight:0},_))})}var w=n.getData().tree.root;w.setLayout(Xft(a,g,f),!0),n.setLayoutInfo(a),Xj(w,new Te(-a.x,-a.y,r,o),v,p,0)}};function Uj(n,t,e,i){var r,o;if(!n.isRemoved()){var s=n.getLayout();r=s.width,o=s.height;var a=n.getModel(),l=a.get(jj),h=a.get(Hft)/2,u=Yj(a),d=Math.max(l,u),c=l-h,f=d-h;n.setLayout({borderWidth:l,upperHeight:d,upperLabelHeight:u},!0),r=am(r-2*c,0),o=am(o-c-f,0);var g=r*o,p=Wft(n,a,g,t,e,i);if(p.length){var v={x:c,y:f,width:r,height:o},m=uw(r,o),y=1/0,b=[];b.area=0;for(var _=0,w=p.length;_<w;){var C=p[_];b.push(C),b.area+=C.getLayout().area;var x=jft(b,m,t.squareRatio);x<=y?(_++,y=x):(b.area-=b.pop().getLayout().area,p3(b,m,v,h,!1),m=uw(v.width,v.height),b.length=b.area=0,y=1/0)}if(b.length&&p3(b,m,v,h,!0),!e){var S=a.get("childrenVisibleMin");S!=null&&g<S&&(e=!0)}for(var _=0,w=p.length;_<w;_++)Uj(p[_],t,e,i+1)}}}function Wft(n,t,e,i,r,o){var s=n.children||[],a=i.sort;a!=="asc"&&a!=="desc"&&(a=null);var l=i.leafDepth!=null&&i.leafDepth<=o;if(r&&!l)return n.viewChildren=[];s=Ti(s,function(f){return!f.isRemoved()}),Gft(s,a);var h=$ft(t,s,a);if(h.sum===0)return n.viewChildren=[];if(h.sum=Vft(t,e,h.sum,a,s),h.sum===0)return n.viewChildren=[];for(var u=0,d=s.length;u<d;u++){var c=s[u].getValue()/h.sum*e;s[u].setLayout({area:c})}return l&&(s.length&&n.setLayout({isLeafRoot:!0},!0),s.length=0),n.viewChildren=s,n.setLayout({dataExtent:h.dataExtent},!0),s}function Vft(n,t,e,i,r){if(!i)return e;for(var o=n.get("visibleMin"),s=r.length,a=s,l=s-1;l>=0;l--){var h=r[i==="asc"?s-l-1:l].getValue();h/e*t<o&&(a=l,e-=h)}return i==="asc"?r.splice(0,s-a):r.splice(a,s-a),e}function Gft(n,t){return t&&n.sort(function(e,i){var r=t==="asc"?e.getValue()-i.getValue():i.getValue()-e.getValue();return r===0?t==="asc"?e.dataIndex-i.dataIndex:i.dataIndex-e.dataIndex:r}),n}function $ft(n,t,e){for(var i=0,r=0,o=t.length;r<o;r++)i+=t[r].getValue();var s=n.get("visualDimension"),a;return!t||!t.length?a=[NaN,NaN]:s==="value"&&e?(a=[t[t.length-1].getValue(),t[0].getValue()],e==="asc"&&a.reverse()):(a=[1/0,-1/0],XL(t,function(l){var h=l.getValue(s);h<a[0]&&(a[0]=h),h>a[1]&&(a[1]=h)})),{sum:i,dataExtent:a}}function jft(n,t,e){for(var i=0,r=1/0,o=0,s=void 0,a=n.length;o<a;o++)s=n[o].getLayout().area,s&&(s<r&&(r=s),s>i&&(i=s));var l=n.area*n.area,h=t*t*e;return l?am(h*i/l,l/(h*r)):1/0}function p3(n,t,e,i,r){var o=t===e.width?0:1,s=1-o,a=["x","y"],l=["width","height"],h=e[a[o]],u=t?n.area/t:0;(r||u>e[l[s]])&&(u=e[l[s]]);for(var d=0,c=n.length;d<c;d++){var f=n[d],g={},p=u?f.getLayout().area/u:0,v=g[l[s]]=am(u-2*i,0),m=e[a[o]]+e[l[o]]-h,y=d===c-1||m<p?m:p,b=g[l[o]]=am(y-2*i,0);g[a[s]]=e[a[s]]+uw(i,v/2),g[a[o]]=h+uw(i,b/2),h+=y,f.setLayout(g,!0)}e[a[s]]+=u,e[l[s]]-=u}function Uft(n,t,e,i,r){var o=(t||{}).node,s=[i,r];if(!o||o===e)return s;for(var a,l=i*r,h=l*n.option.zoomToNodeRatio;a=o.parentNode;){for(var u=0,d=a.children,c=0,f=d.length;c<f;c++)u+=d[c].getValue();var g=o.getValue();if(g===0)return s;h*=u/g;var p=a.getModel(),v=p.get(jj),m=Math.max(v,Yj(p));h+=4*v*v+(3*v+m)*Math.pow(h,.5),h>RI&&(h=RI),o=a}h<l&&(h=l);var y=Math.pow(h/l,.5);return[i*y,r*y]}function Xft(n,t,e){if(t)return{x:t.x,y:t.y};var i={x:0,y:0};if(!e)return i;var r=e.node,o=r.getLayout();if(!o)return i;for(var s=[o.width/2,o.height/2],a=r;a;){var l=a.getLayout();s[0]+=l.x,s[1]+=l.y,a=a.parentNode}return{x:n.width/2-s[0],y:n.height/2-s[1]}}function Xj(n,t,e,i,r){var o=n.getLayout(),s=e[r],a=s&&s===n;if(!(s&&!a||r===e.length&&n!==i)){n.setLayout({isInView:!0,invisible:!a&&!t.intersect(o),isAboveViewRoot:a},!0);var l=new Te(t.x-o.x,t.y-o.y,t.width,t.height);XL(n.viewChildren||[],function(h){Xj(h,l,e,i,r+1)})}}function Yj(n){return n.get(Fft)?n.get(zft):0}function A7t(n){n.registerSeriesModel(mft),n.registerChartView(Rft),n.registerVisual(Eft),n.registerLayout(Nft),vft(n)}var Yft=2,Kft=4,v3=function(n){ct(t,n);function t(e,i,r,o){var s=n.call(this)||this;s.z2=Yft,s.textConfig={inside:!0},pe(s).seriesIndex=i.seriesIndex;var a=new Vi({z2:Kft,silent:e.getModel().get(["label","silent"])});return s.setTextContent(a),s.updateData(!0,e,i,r,o),s}return t.prototype.updateData=function(e,i,r,o,s){this.node=i,i.piece=this,r=r||this._seriesModel,o=o||this._ecModel;var a=this;pe(a).dataIndex=i.dataIndex;var l=i.getModel(),h=l.getModel("emphasis"),u=i.getLayout(),d=ft({},u);d.label=null;var c=i.getVisual("style");c.lineJoin="bevel";var f=i.getVisual("decal");f&&(c.decal=QC(f,s));var g=wd(l.getModel("itemStyle"),d,!0);ft(d,g),N(wo,function(y){var b=a.ensureState(y),_=l.getModel([y,"itemStyle"]);b.style=_.getItemStyle();var w=wd(_,d);w&&(b.shape=w)}),e?(a.setShape(d),a.shape.r=u.r0,nr(a,{shape:{r:u.r}},r,i.dataIndex)):(En(a,{shape:d},r),dS(a)),a.useStyle(c),this._updateLabel(r);var p=l.getShallow("cursor");p&&a.attr("cursor",p),this._seriesModel=r||this._seriesModel,this._ecModel=o||this._ecModel;var v=h.get("focus"),m=v==="relative"?p8(i.getAncestorsIndices(),i.getDescendantIndices()):v==="ancestor"?i.getAncestorsIndices():v==="descendant"?i.getDescendantIndices():v;ic(this,m,h.get("blurScope"),h.get("disabled"))},t.prototype._updateLabel=function(e){var i=this,r=this.node.getModel(),o=r.getModel("label"),s=this.node.getLayout(),a=s.endAngle-s.startAngle,l=(s.startAngle+s.endAngle)/2,h=Math.cos(l),u=Math.sin(l),d=this,c=d.getTextContent(),f=this.node.dataIndex,g=o.get("minAngle")/180*Math.PI,p=o.get("show")&&!(g!=null&&Math.abs(a)<g);c.ignore=!p,N(X0,function(m){var y=m==="normal"?r.getModel("label"):r.getModel([m,"label"]),b=m==="normal",_=b?c:c.ensureState(m),w=e.getFormattedLabel(f,m);b&&(w=w||i.node.name),_.style=So(y,{},null,m!=="normal",!0),w&&(_.style.text=w);var C=y.get("show");C!=null&&!b&&(_.ignore=!C);var x=v(y,"position"),S=b?d:d.states[m],A=S.style.fill;S.textConfig={outsideFill:y.get("color")==="inherit"?A:null,inside:x!=="outside"};var T,M=v(y,"distance")||0,R=v(y,"align"),E=v(y,"rotate"),P=Math.PI*.5,B=Math.PI*1.5,k=po(E==="tangential"?Math.PI/2-l:l),L=k>P&&!j0(k-P)&&k<B;x==="outside"?(T=s.r+M,R=L?"right":"left"):!R||R==="center"?(a===2*Math.PI&&s.r0===0?T=0:T=(s.r+s.r0)/2,R="center"):R==="left"?(T=s.r0+M,R=L?"right":"left"):R==="right"&&(T=s.r-M,R=L?"left":"right"),_.style.align=R,_.style.verticalAlign=v(y,"verticalAlign")||"middle",_.x=T*h+s.cx,_.y=T*u+s.cy;var O=0;E==="radial"?O=po(-l)+(L?Math.PI:0):E==="tangential"?O=po(Math.PI/2-l)+(L?Math.PI:0):di(E)&&(O=E*Math.PI/180),_.rotation=po(O)});function v(m,y){var b=m.get(y);return b??o.get(y)}c.dirtyStyle()},t}(xo),jB="sunburstRootToNode",m3="sunburstHighlight",qft="sunburstUnhighlight";function Zft(n){n.registerAction({type:jB,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},i);function i(r,o){var s=sm(t,[jB],r);if(s){var a=r.getViewRoot();a&&(t.direction=jL(a,s.node)?"rollUp":"drillDown"),r.resetViewRoot(s.node)}}}),n.registerAction({type:m3,update:"none"},function(t,e,i){t=ft({},t),e.eachComponent({mainType:"series",subType:"sunburst",query:t},r);function r(o){var s=sm(t,[m3],o);s&&(t.dataIndex=s.node.dataIndex)}i.dispatchAction(ft(t,{type:"highlight"}))}),n.registerAction({type:qft,update:"updateView"},function(t,e,i){t=ft({},t),i.dispatchAction(ft(t,{type:"downplay"}))})}var Jft=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,i,r,o){var s=this;this.seriesModel=e,this.api=r,this.ecModel=i;var a=e.getData(),l=a.tree.root,h=e.getViewRoot(),u=this.group,d=e.get("renderLabelForZeroData"),c=[];h.eachNode(function(y){c.push(y)});var f=this._oldChildren||[];g(c,f),m(l,h),this._initEvents(),this._oldChildren=c;function g(y,b){if(y.length===0&&b.length===0)return;new rc(b,y,_,_).add(w).update(w).remove(he(w,null)).execute();function _(C){return C.getId()}function w(C,x){var S=C==null?null:y[C],A=x==null?null:b[x];p(S,A)}}function p(y,b){if(!d&&y&&!y.getValue()&&(y=null),y!==l&&b!==l){if(b&&b.piece)y?(b.piece.updateData(!1,y,e,i,r),a.setItemGraphicEl(y.dataIndex,b.piece)):v(b);else if(y){var _=new v3(y,e,i,r);u.add(_),a.setItemGraphicEl(y.dataIndex,_)}}}function v(y){y&&y.piece&&(u.remove(y.piece),y.piece=null)}function m(y,b){b.depth>0?(s.virtualPiece?s.virtualPiece.updateData(!1,y,e,i,r):(s.virtualPiece=new v3(y,e,i,r),u.add(s.virtualPiece)),b.piece.off("click"),s.virtualPiece.on("click",function(_){s._rootToNode(b.parentNode)})):s.virtualPiece&&(u.remove(s.virtualPiece),s.virtualPiece=null)}},t.prototype._initEvents=function(){var e=this;this.group.off("click"),this.group.on("click",function(i){var r=!1,o=e.seriesModel.getViewRoot();o.eachNode(function(s){if(!r&&s.piece&&s.piece===i.target){var a=s.getModel().get("nodeClick");if(a==="rootToNode")e._rootToNode(s);else if(a==="link"){var l=s.getModel(),h=l.get("link");if(h){var u=l.get("target",!0)||"_blank";UC(h,u)}}r=!0}})})},t.prototype._rootToNode=function(e){e!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:jB,from:this.uid,seriesId:this.seriesModel.id,targetNode:e})},t.prototype.containPoint=function(e,i){var r=i.getData(),o=r.getItemLayout(0);if(o){var s=e[0]-o.cx,a=e[1]-o.cy,l=Math.sqrt(s*s+a*a);return l<=o.r&&l>=o.r0}},t.type="sunburst",t}(Ur),Qft=function(n){ct(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=t.type,e.ignoreStyleOnData=!0,e}return t.prototype.getInitialData=function(e,i){var r={name:e.name,children:e.data};Kj(r);var o=this._levelModels=St(e.levels||[],function(l){return new ui(l,this,i)},this),s=zj.createTree(r,this,a);function a(l){l.wrapMethod("getItemModel",function(h,u){var d=s.getNodeByDataIndex(u),c=o[d.depth];return c&&(h.parentModel=c),h})}return s.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(e){var i=n.prototype.getDataParams.apply(this,arguments),r=this.getData().tree.getNodeByDataIndex(e);return i.treePathInfo=UL(r,this),i},t.prototype.getLevelModel=function(e){return this._levelModels&&this._levelModels[e.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var i=this.getRawData().tree.root;(!e||e!==i&&!i.contains(e))&&(this._viewRoot=i)},t.prototype.enableAriaDecal=function(){Wj(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}(Ao);function Kj(n){var t=0;N(n.children,function(i){Kj(i);var r=i.value;_t(r)&&(r=r[0]),t+=r});var e=n.value;_t(e)&&(e=e[0]),(e==null||isNaN(e))&&(e=t),e<0&&(e=0),_t(n.value)?n.value[0]=e:n.value=e}var y3=Math.PI/180;function tgt(n,t,e){t.eachSeriesByType(n,function(i){var r=i.get("center"),o=i.get("radius");_t(o)||(o=[0,o]),_t(r)||(r=[r,r]);var s=e.getWidth(),a=e.getHeight(),l=Math.min(s,a),h=Jt(r[0],s),u=Jt(r[1],a),d=Jt(o[0],l/2),c=Jt(o[1],l/2),f=-i.get("startAngle")*y3,g=i.get("minAngle")*y3,p=i.getData().tree.root,v=i.getViewRoot(),m=v.depth,y=i.get("sort");y!=null&&qj(v,y);var b=0;N(v.children,function(k){!isNaN(k.getValue())&&b++});var _=v.getValue(),w=Math.PI/(_||b)*2,C=v.depth>0,x=v.height-(C?-1:1),S=(c-d)/(x||1),A=i.get("clockwise"),T=i.get("stillShowZeroSum"),M=A?1:-1,R=function(k,L){if(k){var O=L;if(k!==p){var D=k.getValue(),I=_===0&&T?w:D*w;I<g&&(I=g),O=L+M*I;var H=k.depth-m-(C?-1:1),F=d+S*H,G=d+S*(H+1),j=i.getLevelModel(k);if(j){var W=j.get("r0",!0),K=j.get("r",!0),J=j.get("radius",!0);J!=null&&(W=J[0],K=J[1]),W!=null&&(F=Jt(W,l/2)),K!=null&&(G=Jt(K,l/2))}k.setLayout({angle:I,startAngle:L,endAngle:O,clockwise:A,cx:h,cy:u,r0:F,r:G})}if(k.children&&k.children.length){var q=0;N(k.children,function(X){q+=R(X,L+q)})}return O-L}};if(C){var E=d,P=d+S,B=Math.PI*2;p.setLayout({angle:B,startAngle:f,endAngle:f+B,clockwise:A,cx:h,cy:u,r0:E,r:P})}R(v,f)})}function qj(n,t){var e=n.children||[];n.children=egt(e,t),e.length&&N(n.children,function(i){qj(i,t)})}function egt(n,t){if(jt(t)){var e=St(n,function(r,o){var s=r.getValue();return{params:{depth:r.depth,height:r.height,dataIndex:r.dataIndex,getValue:function(){return s}},index:o}});return e.sort(function(r,o){return t(r.params,o.params)}),St(e,function(r){return n[r.index]})}else{var i=t==="asc";return n.sort(function(r,o){var s=(r.getValue()-o.getValue())*(i?1:-1);return s===0?(r.dataIndex-o.dataIndex)*(i?-1:1):s})}}function igt(n){var t={};function e(i,r,o){for(var s=i;s&&s.depth>1;)s=s.parentNode;var a=r.getColorFromPalette(s.name||s.dataIndex+"",t);return i.depth>1&&Pt(a)&&(a=N2(a,(i.depth-1)/(o-1)*.5)),a}n.eachSeriesByType("sunburst",function(i){var r=i.getData(),o=r.tree;o.eachNode(function(s){var a=s.getModel(),l=a.getModel("itemStyle").getItemStyle();l.fill||(l.fill=e(s,i,o.root.height));var h=r.ensureUniqueItemVisual(s.dataIndex,"style");ft(h,l)})})}function T7t(n){n.registerChartView(Jft),n.registerSeriesModel(Qft),n.registerLayout(he(tgt,"sunburst")),n.registerProcessor(he(Ij,"sunburst")),n.registerVisual(igt),Zft(n)}function b3(n,t,e){var i=up.createCanvas(),r=t.getWidth(),o=t.getHeight(),s=i.style;return s&&(s.position="absolute",s.left="0",s.top="0",s.width=r+"px",s.height=o+"px",i.setAttribute("data-zr-dom-id",n)),i.width=r*e,i.height=o*e,i}var ZM=function(n){ct(t,n);function t(e,i,r){var o=n.call(this)||this;o.motionBlur=!1,o.lastFrameAlpha=.7,o.dpr=1,o.virtual=!1,o.config={},o.incremental=!1,o.zlevel=0,o.maxRepaintRectCount=5,o.__dirty=!0,o.__firstTimePaint=!0,o.__used=!1,o.__drawIndex=0,o.__startIndex=0,o.__endIndex=0,o.__prevStartIndex=null,o.__prevEndIndex=null;var s;r=r||OC,typeof e=="string"?s=b3(e,i,r):Ht(e)&&(s=e,e=s.id),o.id=e,o.dom=s;var a=s.style;return a&&(v8(s),s.onselectstart=function(){return!1},a.padding="0",a.margin="0",a.borderWidth="0"),o.painter=i,o.dpr=r,o}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var e=this.dpr;this.domBack=b3("back-"+this.id,this.painter,e),this.ctxBack=this.domBack.getContext("2d"),e!==1&&this.ctxBack.scale(e,e)},t.prototype.createRepaintRects=function(e,i,r,o){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var s=[],a=this.maxRepaintRectCount,l=!1,h=new Te(0,0,0,0);function u(y){if(!(!y.isFinite()||y.isZero()))if(s.length===0){var b=new Te(0,0,0,0);b.copy(y),s.push(b)}else{for(var _=!1,w=1/0,C=0,x=0;x<s.length;++x){var S=s[x];if(S.intersect(y)){var A=new Te(0,0,0,0);A.copy(S),A.union(y),s[x]=A,_=!0;break}else if(l){h.copy(y),h.union(S);var T=y.width*y.height,M=S.width*S.height,R=h.width*h.height,E=R-T-M;E<w&&(w=E,C=x)}}if(l&&(s[C].union(y),_=!0),!_){var b=new Te(0,0,0,0);b.copy(y),s.push(b)}l||(l=s.length>=a)}}for(var d=this.__startIndex;d<this.__endIndex;++d){var c=e[d];if(c){var f=c.shouldBePainted(r,o,!0,!0),g=c.__isRendered&&(c.__dirty&go||!f)?c.getPrevPaintRect():null;g&&u(g);var p=f&&(c.__dirty&go||!c.__isRendered)?c.getPaintRect():null;p&&u(p)}}for(var d=this.__prevStartIndex;d<this.__prevEndIndex;++d){var c=i[d],f=c&&c.shouldBePainted(r,o,!0,!0);if(c&&(!f||!c.__zr)&&c.__isRendered){var g=c.getPrevPaintRect();g&&u(g)}}var v;do{v=!1;for(var d=0;d<s.length;){if(s[d].isZero()){s.splice(d,1);continue}for(var m=d+1;m<s.length;)s[d].intersect(s[m])?(v=!0,s[d].union(s[m]),s.splice(m,1)):m++;d++}}while(v);return this._paintRects=s,s},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(e,i){var r=this.dpr,o=this.dom,s=o.style,a=this.domBack;s&&(s.width=e+"px",s.height=i+"px"),o.width=e*r,o.height=i*r,a&&(a.width=e*r,a.height=i*r,r!==1&&this.ctxBack.scale(r,r))},t.prototype.clear=function(e,i,r){var o=this.dom,s=this.ctx,a=o.width,l=o.height;i=i||this.clearColor;var h=this.motionBlur&&!e,u=this.lastFrameAlpha,d=this.dpr,c=this;h&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(o,0,0,a/d,l/d));var f=this.domBack;function g(p,v,m,y){if(s.clearRect(p,v,m,y),i&&i!=="transparent"){var b=void 0;if(Zx(i)){var _=i.global||i.__width===m&&i.__height===y;b=_&&i.__canvasGradient||pB(s,i,{x:0,y:0,width:m,height:y}),i.__canvasGradient=b,i.__width=m,i.__height=y}else ptt(i)&&(i.scaleX=i.scaleX||d,i.scaleY=i.scaleY||d,b=vB(s,i,{dirty:function(){c.setUnpainted(),c.painter.refresh()}}));s.save(),s.fillStyle=b||i,s.fillRect(p,v,m,y),s.restore()}h&&(s.save(),s.globalAlpha=u,s.drawImage(f,p,v,m,y),s.restore())}!r||h?g(0,0,a,l):r.length&&N(r,function(p){g(p.x*d,p.y*d,p.width*d,p.height*d)})},t}(ys),_3=1e5,Vu=314159,Db=.01,ngt=.001;function rgt(n){return n?n.__builtin__?!0:!(typeof n.resize!="function"||typeof n.refresh!="function"):!1}function ogt(n,t){var e=document.createElement("div");return e.style.cssText=["position:relative","width:"+n+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",e}var sgt=function(){function n(t,e,i,r){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var o=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=i=ft({},i||{}),this.dpr=i.devicePixelRatio||OC,this._singleCanvas=o,this.root=t;var s=t.style;s&&(v8(t),t.innerHTML=""),this.storage=e;var a=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(o){var u=t,d=u.width,c=u.height;i.width!=null&&(d=i.width),i.height!=null&&(c=i.height),this.dpr=i.devicePixelRatio||1,u.width=d*this.dpr,u.height=c*this.dpr,this._width=d,this._height=c;var f=new ZM(u,this,this.dpr);f.__builtin__=!0,f.initContext(),l[Vu]=f,f.zlevel=Vu,a.push(Vu),this._domRoot=t}else{this._width=vb(t,0,i),this._height=vb(t,1,i);var h=this._domRoot=ogt(this._width,this._height);t.appendChild(h)}}return n.prototype.getType=function(){return"canvas"},n.prototype.isSingleCanvas=function(){return this._singleCanvas},n.prototype.getViewportRoot=function(){return this._domRoot},n.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},n.prototype.refresh=function(t){var e=this.storage.getDisplayList(!0),i=this._prevDisplayList,r=this._zlevelList;this._redrawId=Math.random(),this._paintList(e,i,t,this._redrawId);for(var o=0;o<r.length;o++){var s=r[o],a=this._layers[s];if(!a.__builtin__&&a.refresh){var l=o===0?this._backgroundColor:null;a.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=e.slice()),this},n.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},n.prototype._paintHoverList=function(t){var e=t.length,i=this._hoverlayer;if(i&&i.clear(),!!e){for(var r={inHover:!0,viewWidth:this._width,viewHeight:this._height},o,s=0;s<e;s++){var a=t[s];a.__inHover&&(i||(i=this._hoverlayer=this.getLayer(_3)),o||(o=i.ctx,o.save()),Cd(o,a,r,s===e-1))}o&&o.restore()}},n.prototype.getHoverLayer=function(){return this.getLayer(_3)},n.prototype.paintOne=function(t,e){E$(t,e)},n.prototype._paintList=function(t,e,i,r){if(this._redrawId===r){i=i||!1,this._updateLayerStatus(t);var o=this._doPaintList(t,e,i),s=o.finished,a=o.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),a&&this._paintHoverList(t),s)this.eachLayer(function(h){h.afterBrush&&h.afterBrush()});else{var l=this;BC(function(){l._paintList(t,e,i,r)})}}},n.prototype._compositeManually=function(){var t=this.getLayer(Vu).ctx,e=this._domRoot.width,i=this._domRoot.height;t.clearRect(0,0,e,i),this.eachBuiltinLayer(function(r){r.virtual&&t.drawImage(r.dom,0,0,e,i)})},n.prototype._doPaintList=function(t,e,i){for(var r=this,o=[],s=this._opts.useDirtyRect,a=0;a<this._zlevelList.length;a++){var l=this._zlevelList[a],h=this._layers[l];h.__builtin__&&h!==this._hoverlayer&&(h.__dirty||i)&&o.push(h)}for(var u=!0,d=!1,c=function(p){var v=o[p],m=v.ctx,y=s&&v.createRepaintRects(t,e,f._width,f._height),b=i?v.__startIndex:v.__drawIndex,_=!i&&v.incremental&&Date.now,w=_&&Date.now(),C=v.zlevel===f._zlevelList[0]?f._backgroundColor:null;if(v.__startIndex===v.__endIndex)v.clear(!1,C,y);else if(b===v.__startIndex){var x=t[b];(!x.incremental||!x.notClear||i)&&v.clear(!1,C,y)}b===-1&&(b=v.__startIndex);var S,A=function(E){var P={inHover:!1,allClipped:!1,prevEl:null,viewWidth:r._width,viewHeight:r._height};for(S=b;S<v.__endIndex;S++){var B=t[S];if(B.__inHover&&(d=!0),r._doPaintEl(B,v,s,E,P,S===v.__endIndex-1),_){var k=Date.now()-w;if(k>15)break}}P.prevElClipPaths&&m.restore()};if(y)if(y.length===0)S=v.__endIndex;else for(var T=f.dpr,M=0;M<y.length;++M){var R=y[M];m.save(),m.beginPath(),m.rect(R.x*T,R.y*T,R.width*T,R.height*T),m.clip(),A(R),m.restore()}else m.save(),A(),m.restore();v.__drawIndex=S,v.__drawIndex<v.__endIndex&&(u=!1)},f=this,g=0;g<o.length;g++)c(g);return ie.wxa&&N(this._layers,function(p){p&&p.ctx&&p.ctx.draw&&p.ctx.draw()}),{finished:u,needsRefreshHover:d}},n.prototype._doPaintEl=function(t,e,i,r,o,s){var a=e.ctx;if(i){var l=t.getPaintRect();(!r||l&&l.intersect(r))&&(Cd(a,t,o,s),t.setPrevPaintRect(l))}else Cd(a,t,o,s)},n.prototype.getLayer=function(t,e){this._singleCanvas&&!this._needsManuallyCompositing&&(t=Vu);var i=this._layers[t];return i||(i=new ZM("zr_"+t,this,this.dpr),i.zlevel=t,i.__builtin__=!0,this._layerConfig[t]?we(i,this._layerConfig[t],!0):this._layerConfig[t-Db]&&we(i,this._layerConfig[t-Db],!0),e&&(i.virtual=e),this.insertLayer(t,i),i.initContext()),i},n.prototype.insertLayer=function(t,e){var i=this._layers,r=this._zlevelList,o=r.length,s=this._domRoot,a=null,l=-1;if(!i[t]&&rgt(e)){if(o>0&&t>r[0]){for(l=0;l<o-1&&!(r[l]<t&&r[l+1]>t);l++);a=i[r[l]]}if(r.splice(l+1,0,t),i[t]=e,!e.virtual)if(a){var h=a.dom;h.nextSibling?s.insertBefore(e.dom,h.nextSibling):s.appendChild(e.dom)}else s.firstChild?s.insertBefore(e.dom,s.firstChild):s.appendChild(e.dom);e.painter||(e.painter=this)}},n.prototype.eachLayer=function(t,e){for(var i=this._zlevelList,r=0;r<i.length;r++){var o=i[r];t.call(e,this._layers[o],o)}},n.prototype.eachBuiltinLayer=function(t,e){for(var i=this._zlevelList,r=0;r<i.length;r++){var o=i[r],s=this._layers[o];s.__builtin__&&t.call(e,s,o)}},n.prototype.eachOtherLayer=function(t,e){for(var i=this._zlevelList,r=0;r<i.length;r++){var o=i[r],s=this._layers[o];s.__builtin__||t.call(e,s,o)}},n.prototype.getLayers=function(){return this._layers},n.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(d,c){d.__dirty=d.__used=!1});function e(d){o&&(o.__endIndex!==d&&(o.__dirty=!0),o.__endIndex=d)}if(this._singleCanvas)for(var i=1;i<t.length;i++){var r=t[i];if(r.zlevel!==t[i-1].zlevel||r.incremental){this._needsManuallyCompositing=!0;break}}var o=null,s=0,a,l;for(l=0;l<t.length;l++){var r=t[l],h=r.zlevel,u=void 0;a!==h&&(a=h,s=0),r.incremental?(u=this.getLayer(h+ngt,this._needsManuallyCompositing),u.incremental=!0,s=1):u=this.getLayer(h+(s>0?Db:0),this._needsManuallyCompositing),u.__builtin__||SE("ZLevel "+h+" has been used by unkown layer "+u.id),u!==o&&(u.__used=!0,u.__startIndex!==l&&(u.__dirty=!0),u.__startIndex=l,u.incremental?u.__drawIndex=-1:u.__drawIndex=l,e(l),o=u),r.__dirty&go&&!r.__inHover&&(u.__dirty=!0,u.incremental&&u.__drawIndex<0&&(u.__drawIndex=l))}e(l),this.eachBuiltinLayer(function(d,c){!d.__used&&d.getElementCount()>0&&(d.__dirty=!0,d.__startIndex=d.__endIndex=d.__drawIndex=0),d.__dirty&&d.__drawIndex<0&&(d.__drawIndex=d.__startIndex)})},n.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},n.prototype._clearLayer=function(t){t.clear()},n.prototype.setBackgroundColor=function(t){this._backgroundColor=t,N(this._layers,function(e){e.setUnpainted()})},n.prototype.configLayer=function(t,e){if(e){var i=this._layerConfig;i[t]?we(i[t],e,!0):i[t]=e;for(var r=0;r<this._zlevelList.length;r++){var o=this._zlevelList[r];if(o===t||o===t+Db){var s=this._layers[o];we(s,i[t],!0)}}}},n.prototype.delLayer=function(t){var e=this._layers,i=this._zlevelList,r=e[t];r&&(r.dom.parentNode.removeChild(r.dom),delete e[t],i.splice(_e(i,t),1))},n.prototype.resize=function(t,e){if(this._domRoot.style){var i=this._domRoot;i.style.display="none";var r=this._opts,o=this.root;if(t!=null&&(r.width=t),e!=null&&(r.height=e),t=vb(o,0,r),e=vb(o,1,r),i.style.display="",this._width!==t||e!==this._height){i.style.width=t+"px",i.style.height=e+"px";for(var s in this._layers)this._layers.hasOwnProperty(s)&&this._layers[s].resize(t,e);this.refresh(!0)}this._width=t,this._height=e}else{if(t==null||e==null)return;this._width=t,this._height=e,this.getLayer(Vu).resize(t,e)}return this},n.prototype.clearLayer=function(t){var e=this._layers[t];e&&e.clear()},n.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},n.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[Vu].dom;var e=new ZM("image",this,t.pixelRatio||this.dpr);e.initContext(),e.clear(!1,t.backgroundColor||this._backgroundColor);var i=e.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var r=e.dom.width,o=e.dom.height;this.eachLayer(function(d){d.__builtin__?i.drawImage(d.dom,0,0,r,o):d.renderToCanvas&&(i.save(),d.renderToCanvas(i),i.restore())})}else for(var s={inHover:!1,viewWidth:this._width,viewHeight:this._height},a=this.storage.getDisplayList(!0),l=0,h=a.length;l<h;l++){var u=a[l];Cd(i,u,s,l===h-1)}return e.dom},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n}();function M7t(n){n.registerPainter("canvas",sgt)}var ga=Vl.CMD;function Rf(n,t){return Math.abs(n-t)<1e-5}function UB(n){var t=n.data,e=n.len(),i=[],r,o=0,s=0,a=0,l=0;function h(E,P){r&&r.length>2&&i.push(r),r=[E,P]}function u(E,P,B,k){Rf(E,B)&&Rf(P,k)||r.push(E,P,B,k,B,k)}function d(E,P,B,k,L,O){var D=Math.abs(P-E),I=Math.tan(D/4)*4/3,H=P<E?-1:1,F=Math.cos(E),G=Math.sin(E),j=Math.cos(P),W=Math.sin(P),K=F*L+B,J=G*O+k,q=j*L+B,X=W*O+k,it=L*I*H,Z=O*I*H;r.push(K-it*G,J+Z*F,q+it*W,X-Z*j,q,X)}for(var c,f,g,p,v=0;v<e;){var m=t[v++],y=v===1;switch(y&&(o=t[v],s=t[v+1],a=o,l=s,(m===ga.L||m===ga.C||m===ga.Q)&&(r=[a,l])),m){case ga.M:o=a=t[v++],s=l=t[v++],h(a,l);break;case ga.L:c=t[v++],f=t[v++],u(o,s,c,f),o=c,s=f;break;case ga.C:r.push(t[v++],t[v++],t[v++],t[v++],o=t[v++],s=t[v++]);break;case ga.Q:c=t[v++],f=t[v++],g=t[v++],p=t[v++],r.push(o+2/3*(c-o),s+2/3*(f-s),g+2/3*(c-g),p+2/3*(f-p),g,p),o=g,s=p;break;case ga.A:var b=t[v++],_=t[v++],w=t[v++],C=t[v++],x=t[v++],S=t[v++]+x;v+=1;var A=!t[v++];c=Math.cos(x)*w+b,f=Math.sin(x)*C+_,y?(a=c,l=f,h(a,l)):u(o,s,c,f),o=Math.cos(S)*w+b,s=Math.sin(S)*C+_;for(var T=(A?-1:1)*Math.PI/2,M=x;A?M>S:M<S;M+=T){var R=A?Math.max(M+T,S):Math.min(M+T,S);d(M,R,b,_,w,C)}break;case ga.R:a=o=t[v++],l=s=t[v++],c=a+t[v++],f=l+t[v++],h(c,l),u(c,l,c,f),u(c,f,a,f),u(a,f,a,l),u(a,l,c,l);break;case ga.Z:r&&u(o,s,a,l),o=a,s=l;break}}return r&&r.length>2&&i.push(r),i}function XB(n,t,e,i,r,o,s,a,l,h){if(Rf(n,e)&&Rf(t,i)&&Rf(r,s)&&Rf(o,a)){l.push(s,a);return}var u=2/h,d=u*u,c=s-n,f=a-t,g=Math.sqrt(c*c+f*f);c/=g,f/=g;var p=e-n,v=i-t,m=r-s,y=o-a,b=p*p+v*v,_=m*m+y*y;if(b<d&&_<d){l.push(s,a);return}var w=c*p+f*v,C=-c*m-f*y,x=b-w*w,S=_-C*C;if(x<d&&w>=0&&S<d&&C>=0){l.push(s,a);return}var A=[],T=[];Xh(n,e,r,s,.5,A),Xh(t,i,o,a,.5,T),XB(A[0],T[0],A[1],T[1],A[2],T[2],A[3],T[3],l,h),XB(A[4],T[4],A[5],T[5],A[6],T[6],A[7],T[7],l,h)}function agt(n,t){var e=UB(n),i=[];t=t||1;for(var r=0;r<e.length;r++){var o=e[r],s=[],a=o[0],l=o[1];s.push(a,l);for(var h=2;h<o.length;){var u=o[h++],d=o[h++],c=o[h++],f=o[h++],g=o[h++],p=o[h++];XB(a,l,u,d,c,f,g,p,s,t),a=g,l=p}i.push(s)}return i}function Zj(n,t,e){var i=n[t],r=n[1-t],o=Math.abs(i/r),s=Math.ceil(Math.sqrt(o*e)),a=Math.floor(e/s);a===0&&(a=1,s=e);for(var l=[],h=0;h<s;h++)l.push(a);var u=s*a,d=e-u;if(d>0)for(var h=0;h<d;h++)l[h%s]+=1;return l}function C3(n,t,e){for(var i=n.r0,r=n.r,o=n.startAngle,s=n.endAngle,a=Math.abs(s-o),l=a*r,h=r-i,u=l>Math.abs(h),d=Zj([l,h],u?0:1,t),c=(u?a:h)/d.length,f=0;f<d.length;f++)for(var g=(u?h:a)/d[f],p=0;p<d[f];p++){var v={};u?(v.startAngle=o+c*f,v.endAngle=o+c*(f+1),v.r0=i+g*p,v.r=i+g*(p+1)):(v.startAngle=o+g*p,v.endAngle=o+g*(p+1),v.r0=i+c*f,v.r=i+c*(f+1)),v.clockwise=n.clockwise,v.cx=n.cx,v.cy=n.cy,e.push(v)}}function lgt(n,t,e){for(var i=n.width,r=n.height,o=i>r,s=Zj([i,r],o?0:1,t),a=o?"width":"height",l=o?"height":"width",h=o?"x":"y",u=o?"y":"x",d=n[a]/s.length,c=0;c<s.length;c++)for(var f=n[l]/s[c],g=0;g<s[c];g++){var p={};p[h]=c*d,p[u]=g*f,p[a]=d,p[l]=f,p.x+=n.x,p.y+=n.y,e.push(p)}}function w3(n,t,e,i){return n*i-e*t}function hgt(n,t,e,i,r,o,s,a){var l=e-n,h=i-t,u=s-r,d=a-o,c=w3(u,d,l,h);if(Math.abs(c)<1e-6)return null;var f=n-r,g=t-o,p=w3(f,g,u,d)/c;return p<0||p>1?null:new Vt(p*l+n,p*h+t)}function ugt(n,t,e){var i=new Vt;Vt.sub(i,e,t),i.normalize();var r=new Vt;Vt.sub(r,n,t);var o=r.dot(i);return o}function qc(n,t){var e=n[n.length-1];e&&e[0]===t[0]&&e[1]===t[1]||n.push(t)}function dgt(n,t,e){for(var i=n.length,r=[],o=0;o<i;o++){var s=n[o],a=n[(o+1)%i],l=hgt(s[0],s[1],a[0],a[1],t.x,t.y,e.x,e.y);l&&r.push({projPt:ugt(l,t,e),pt:l,idx:o})}if(r.length<2)return[{points:n},{points:n}];r.sort(function(v,m){return v.projPt-m.projPt});var h=r[0],u=r[r.length-1];if(u.idx<h.idx){var d=h;h=u,u=d}for(var c=[h.pt.x,h.pt.y],f=[u.pt.x,u.pt.y],g=[c],p=[f],o=h.idx+1;o<=u.idx;o++)qc(g,n[o].slice());qc(g,f),qc(g,c);for(var o=u.idx+1;o<=h.idx+i;o++)qc(p,n[o%i].slice());return qc(p,c),qc(p,f),[{points:g},{points:p}]}function x3(n){var t=n.points,e=[],i=[];e9(t,e,i);var r=new Te(e[0],e[1],i[0]-e[0],i[1]-e[1]),o=r.width,s=r.height,a=r.x,l=r.y,h=new Vt,u=new Vt;return o>s?(h.x=u.x=a+o/2,h.y=l,u.y=l+s):(h.y=u.y=l+s/2,h.x=a,u.x=a+o),dgt(t,h,u)}function dw(n,t,e,i){if(e===1)i.push(t);else{var r=Math.floor(e/2),o=n(t);dw(n,o[0],r,i),dw(n,o[1],e-r,i)}return i}function cgt(n,t){for(var e=[],i=0;i<t;i++)e.push(zE(n));return e}function fgt(n,t){t.setStyle(n.style),t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel}function ggt(n){for(var t=[],e=0;e<n.length;)t.push([n[e++],n[e++]]);return t}function pgt(n,t){var e=[],i=n.shape,r;switch(n.type){case"rect":lgt(i,t,e),r=ci;break;case"sector":C3(i,t,e),r=xo;break;case"circle":C3({r0:0,r:i.r,startAngle:0,endAngle:Math.PI*2,cx:i.cx,cy:i.cy},t,e),r=xo;break;default:var o=n.getComputedTransform(),s=o?Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1],o[2]*o[2]+o[3]*o[3])):1,a=St(agt(n.getUpdatedPathProxy(),s),function(m){return ggt(m)}),l=a.length;if(l===0)dw(x3,{points:a[0]},t,e);else if(l===t)for(var h=0;h<l;h++)e.push({points:a[h]});else{var u=0,d=St(a,function(m){var y=[],b=[];e9(m,y,b);var _=(b[1]-y[1])*(b[0]-y[0]);return u+=_,{poly:m,area:_}});d.sort(function(m,y){return y.area-m.area});for(var c=t,h=0;h<l;h++){var f=d[h];if(c<=0)break;var g=h===l-1?c:Math.ceil(f.area/u*t);g<0||(dw(x3,{points:f.poly},g,e),c-=g)}}r=Ac;break}if(!r)return cgt(n,t);for(var p=[],h=0;h<e.length;h++){var v=new r;v.setShape(e[h]),fgt(n,v),p.push(v)}return p}function vgt(n,t){var e=n.length,i=t.length;if(e===i)return[n,t];for(var r=[],o=[],s=e<i?n:t,a=Math.min(e,i),l=Math.abs(i-e)/6,h=(a-2)/6,u=Math.ceil(l/h)+1,d=[s[0],s[1]],c=l,f=2;f<a;){var g=s[f-2],p=s[f-1],v=s[f++],m=s[f++],y=s[f++],b=s[f++],_=s[f++],w=s[f++];if(c<=0){d.push(v,m,y,b,_,w);continue}for(var C=Math.min(c,u-1)+1,x=1;x<=C;x++){var S=x/C;Xh(g,v,y,_,S,r),Xh(p,m,b,w,S,o),g=r[3],p=o[3],d.push(r[1],o[1],r[2],o[2],g,p),v=r[5],m=o[5],y=r[6],b=o[6]}c-=C-1}return s===n?[d,t]:[n,d]}function S3(n,t){for(var e=n.length,i=n[e-2],r=n[e-1],o=[],s=0;s<t.length;)o[s++]=i,o[s++]=r;return o}function mgt(n,t){for(var e,i,r,o=[],s=[],a=0;a<Math.max(n.length,t.length);a++){var l=n[a],h=t[a],u=void 0,d=void 0;l?h?(e=vgt(l,h),u=e[0],d=e[1],i=u,r=d):(d=S3(r||l,l),u=l):(u=S3(i||h,h),d=h),o.push(u),s.push(d)}return[o,s]}function A3(n){for(var t=0,e=0,i=0,r=n.length,o=0,s=r-2;o<r;s=o,o+=2){var a=n[s],l=n[s+1],h=n[o],u=n[o+1],d=a*u-h*l;t+=d,e+=(a+h)*d,i+=(l+u)*d}return t===0?[n[0]||0,n[1]||0]:[e/t/3,i/t/3,t]}function ygt(n,t,e,i){for(var r=(n.length-2)/6,o=1/0,s=0,a=n.length,l=a-2,h=0;h<r;h++){for(var u=h*6,d=0,c=0;c<a;c+=2){var f=c===0?u:(u+c-2)%l+2,g=n[f]-e[0],p=n[f+1]-e[1],v=t[c]-i[0],m=t[c+1]-i[1],y=v-g,b=m-p;d+=y*y+b*b}d<o&&(o=d,s=h)}return s}function bgt(n){for(var t=[],e=n.length,i=0;i<e;i+=2)t[i]=n[e-i-2],t[i+1]=n[e-i-1];return t}function _gt(n,t,e,i){for(var r=[],o,s=0;s<n.length;s++){var a=n[s],l=t[s],h=A3(a),u=A3(l);o==null&&(o=h[2]<0!=u[2]<0);var d=[],c=[],f=0,g=1/0,p=[],v=a.length;o&&(a=bgt(a));for(var m=ygt(a,l,h,u)*6,y=v-2,b=0;b<y;b+=2){var _=(m+b)%y+2;d[b+2]=a[_]-h[0],d[b+3]=a[_+1]-h[1]}d[0]=a[m]-h[0],d[1]=a[m+1]-h[1];for(var w=i/e,C=-i/2;C<=i/2;C+=w){for(var x=Math.sin(C),S=Math.cos(C),A=0,b=0;b<a.length;b+=2){var T=d[b],M=d[b+1],R=l[b]-u[0],E=l[b+1]-u[1],P=R*S-E*x,B=R*x+E*S;p[b]=P,p[b+1]=B;var k=P-T,L=B-M;A+=k*k+L*L}if(A<g){g=A,f=C;for(var O=0;O<p.length;O++)c[O]=p[O]}}r.push({from:d,to:c,fromCp:h,toCp:u,rotation:-f})}return r}function cw(n){return n.__isCombineMorphing}var Jj="__mOriginal_";function fw(n,t,e){var i=Jj+t,r=n[i]||n[t];n[i]||(n[i]=n[t]);var o=e.replace,s=e.after,a=e.before;n[t]=function(){var l=arguments,h;return a&&a.apply(this,l),o?h=o.apply(this,l):h=r.apply(this,l),s&&s.apply(this,l),h}}function p0(n,t){var e=Jj+t;n[e]&&(n[t]=n[e],n[e]=null)}function T3(n,t){for(var e=0;e<n.length;e++)for(var i=n[e],r=0;r<i.length;){var o=i[r],s=i[r+1];i[r++]=t[0]*o+t[2]*s+t[4],i[r++]=t[1]*o+t[3]*s+t[5]}}function Qj(n,t){var e=n.getUpdatedPathProxy(),i=t.getUpdatedPathProxy(),r=mgt(UB(e),UB(i)),o=r[0],s=r[1],a=n.getComputedTransform(),l=t.getComputedTransform();function h(){this.transform=null}a&&T3(o,a),l&&T3(s,l),fw(t,"updateTransform",{replace:h}),t.transform=null;var u=_gt(o,s,10,Math.PI),d=[];fw(t,"buildPath",{replace:function(c){for(var f=t.__morphT,g=1-f,p=[],v=0;v<u.length;v++){var m=u[v],y=m.from,b=m.to,_=m.rotation*f,w=m.fromCp,C=m.toCp,x=Math.sin(_),S=Math.cos(_);W_(p,w,C,f);for(var A=0;A<y.length;A+=2){var T=y[A],M=y[A+1],R=b[A],E=b[A+1],P=T*g+R*f,B=M*g+E*f;d[A]=P*S-B*x+p[0],d[A+1]=P*x+B*S+p[1]}var k=d[0],L=d[1];c.moveTo(k,L);for(var A=2;A<y.length;){var R=d[A++],E=d[A++],O=d[A++],D=d[A++],I=d[A++],H=d[A++];k===R&&L===E&&O===I&&D===H?c.lineTo(I,H):c.bezierCurveTo(R,E,O,D,I,H),k=I,L=H}}}})}function YL(n,t,e){if(!n||!t)return t;var i=e.done,r=e.during;Qj(n,t),t.__morphT=0;function o(){p0(t,"buildPath"),p0(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape()}return t.animateTo({__morphT:1},Gt({during:function(s){t.dirtyShape(),r&&r(s)},done:function(){o(),i&&i()}},e)),t}function Cgt(n,t,e,i,r,o){var s=16;n=r===e?0:Math.round(32767*(n-e)/(r-e)),t=o===i?0:Math.round(32767*(t-i)/(o-i));for(var a=0,l,h=(1<<s)/2;h>0;h/=2){var u=0,d=0;(n&h)>0&&(u=1),(t&h)>0&&(d=1),a+=h*h*(3*u^d),d===0&&(u===1&&(n=h-1-n,t=h-1-t),l=n,n=t,t=l)}return a}function gw(n){var t=1/0,e=1/0,i=-1/0,r=-1/0,o=St(n,function(a){var l=a.getBoundingRect(),h=a.getComputedTransform(),u=l.x+l.width/2+(h?h[4]:0),d=l.y+l.height/2+(h?h[5]:0);return t=Math.min(u,t),e=Math.min(d,e),i=Math.max(u,i),r=Math.max(d,r),[u,d]}),s=St(o,function(a,l){return{cp:a,z:Cgt(a[0],a[1],t,e,i,r),path:n[l]}});return s.sort(function(a,l){return a.z-l.z}).map(function(a){return a.path})}function tU(n){return pgt(n.path,n.count)}function YB(){return{fromIndividuals:[],toIndividuals:[],count:0}}function wgt(n,t,e){var i=[];function r(w){for(var C=0;C<w.length;C++){var x=w[C];cw(x)?r(x.childrenRef()):x instanceof Ee&&i.push(x)}}r(n);var o=i.length;if(!o)return YB();var s=e.dividePath||tU,a=s({path:t,count:o});if(a.length!==o)return YB();i=gw(i),a=gw(a);for(var l=e.done,h=e.during,u=e.individualDelay,d=new ny,c=0;c<o;c++){var f=i[c],g=a[c];g.parent=t,g.copyTransform(d),u||Qj(f,g)}t.__isCombineMorphing=!0,t.childrenRef=function(){return a};function p(w){for(var C=0;C<a.length;C++)a[C].addSelfToZr(w)}fw(t,"addSelfToZr",{after:function(w){p(w)}}),fw(t,"removeSelfFromZr",{after:function(w){for(var C=0;C<a.length;C++)a[C].removeSelfFromZr(w)}});function v(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,p0(t,"addSelfToZr"),p0(t,"removeSelfFromZr")}var m=a.length;if(u)for(var y=m,b=function(){y--,y===0&&(v(),l&&l())},c=0;c<m;c++){var _=u?Gt({delay:(e.delay||0)+u(c,m,i[c],a[c]),done:b},e):e;YL(i[c],a[c],_)}else t.__morphT=0,t.animateTo({__morphT:1},Gt({during:function(w){for(var C=0;C<m;C++){var x=a[C];x.__morphT=t.__morphT,x.dirtyShape()}h&&h(w)},done:function(){v();for(var w=0;w<n.length;w++)p0(n[w],"updateTransform");l&&l()}},e));return t.__zr&&p(t.__zr),{fromIndividuals:i,toIndividuals:a,count:m}}function xgt(n,t,e){var i=t.length,r=[],o=e.dividePath||tU;function s(f){for(var g=0;g<f.length;g++){var p=f[g];cw(p)?s(p.childrenRef()):p instanceof Ee&&r.push(p)}}if(cw(n)){s(n.childrenRef());var a=r.length;if(a<i)for(var l=0,h=a;h<i;h++)r.push(zE(r[l++%a]));r.length=i}else{r=o({path:n,count:i});for(var u=n.getComputedTransform(),h=0;h<r.length;h++)r[h].setLocalTransform(u);if(r.length!==i)return YB()}r=gw(r),t=gw(t);for(var d=e.individualDelay,h=0;h<i;h++){var c=d?Gt({delay:(e.delay||0)+d(h,i,r[h],t[h])},e):e;YL(r[h],t[h],c)}return{fromIndividuals:r,toIndividuals:t,count:t.length}}function M3(n){return _t(n[0])}function R3(n,t){for(var e=[],i=n.length,r=0;r<i;r++)e.push({one:n[r],many:[]});for(var r=0;r<t.length;r++){var o=t[r].length,s=void 0;for(s=0;s<o;s++)e[s%i].many.push(t[r][s])}for(var a=0,r=i-1;r>=0;r--)if(!e[r].many.length){var l=e[a].many;if(l.length<=1)if(a)a=0;else return e;var o=l.length,h=Math.ceil(o/2);e[r].many=l.slice(h,o),e[a].many=l.slice(0,h),a++}return e}var Sgt={clone:function(n){for(var t=[],e=1-Math.pow(1-n.path.style.opacity,1/n.count),i=0;i<n.count;i++){var r=zE(n.path);r.setStyle("opacity",e),t.push(r)}return t},split:null};function JM(n,t,e,i,r,o){if(!n.length||!t.length)return;var s=uS("update",i,r);if(!(s&&s.duration>0))return;var a=i.getModel("universalTransition").get("delay"),l=Object.assign({setToFinal:!0},s),h,u;M3(n)&&(h=n,u=t),M3(t)&&(h=t,u=n);function d(m,y,b,_,w){var C=m.many,x=m.one;if(C.length===1&&!w){var S=y?C[0]:x,A=y?x:C[0];if(cw(S))d({many:[S],one:A},!0,b,_,!0);else{var T=a?Gt({delay:a(b,_)},l):l;YL(S,A,T),o(S,A,S,A,T)}}else for(var M=Gt({dividePath:Sgt[e],individualDelay:a&&function(L,O,D,I){return a(L+b,_)}},l),R=y?wgt(C,x,M):xgt(x,C,M),E=R.fromIndividuals,P=R.toIndividuals,B=E.length,k=0;k<B;k++){var T=a?Gt({delay:a(k,B)},l):l;o(E[k],P[k],y?C[k]:m.one,y?m.one:C[k],T)}}for(var c=h?h===n:n.length>t.length,f=h?R3(u,h):R3(c?t:n,[c?n:t]),g=0,p=0;p<f.length;p++)g+=f[p].many.length;for(var v=0,p=0;p<f.length;p++)d(f[p],c,v,g),v+=f[p].many.length}function Zu(n){if(!n)return[];if(_t(n)){for(var t=[],e=0;e<n.length;e++)t.push(Zu(n[e]));return t}var i=[];return n.traverse(function(r){r instanceof Ee&&!r.disableMorphing&&!r.invisible&&!r.ignore&&i.push(r)}),i}var eU=1e4,Agt=0,B3=1,P3=2,Tgt=Ke();function Mgt(n,t){for(var e=n.dimensions,i=0;i<e.length;i++){var r=n.getDimensionInfo(e[i]);if(r&&r.otherDims[t]===0)return e[i]}}function Rgt(n,t,e){var i=n.getDimensionInfo(e),r=i&&i.ordinalMeta;if(i){var o=n.get(i.name,t);return r&&r.categories[o]||o+""}}function k3(n,t,e,i){var r=i?"itemChildGroupId":"itemGroupId",o=Mgt(n,r);if(o){var s=Rgt(n,t,o);return s}var a=n.getRawDataItem(t),l=i?"childGroupId":"groupId";if(a&&a[l])return a[l]+"";if(!i)return e||n.getId(t)}function E3(n){var t=[];return N(n,function(e){var i=e.data,r=e.dataGroupId;if(!(i.count()>eU))for(var o=i.getIndices(),s=0;s<o.length;s++)t.push({data:i,groupId:k3(i,s,r,!1),childGroupId:k3(i,s,r,!0),divide:e.divide,dataIndex:s})}),t}function QM(n,t,e){n.traverse(function(i){i instanceof Ee&&nr(i,{style:{opacity:0}},t,{dataIndex:e,isFrom:!0})})}function tR(n){if(n.parent){var t=n.getComputedTransform();n.setLocalTransform(t),n.parent.remove(n)}}function Zc(n){n.stopAnimation(),n.isGroup&&n.traverse(function(t){t.stopAnimation()})}function Bgt(n,t,e){var i=uS("update",e,t);i&&n.traverse(function(r){if(r instanceof Sc){var o=Gnt(r);o&&r.animateFrom({style:o},i)}})}function Pgt(n,t){var e=n.length;if(e!==t.length)return!1;for(var i=0;i<e;i++){var r=n[i],o=t[i];if(r.data.getId(r.dataIndex)!==o.data.getId(o.dataIndex))return!1}return!0}function iU(n,t,e){var i=E3(n),r=E3(t);function o(b,_,w,C,x){(w||b)&&_.animateFrom({style:w&&w!==b?ft(ft({},w.style),b.style):b.style},x)}var s=!1,a=Agt,l=$t(),h=$t();i.forEach(function(b){b.groupId&&l.set(b.groupId,!0),b.childGroupId&&h.set(b.childGroupId,!0)});for(var u=0;u<r.length;u++){var d=r[u].groupId;if(h.get(d)){a=B3;break}var c=r[u].childGroupId;if(c&&l.get(c)){a=P3;break}}function f(b,_){return function(w){var C=w.data,x=w.dataIndex;return _?C.getId(x):b?a===B3?w.childGroupId:w.groupId:a===P3?w.childGroupId:w.groupId}}var g=Pgt(i,r),p={};if(!g)for(var u=0;u<r.length;u++){var v=r[u],m=v.data.getItemGraphicEl(v.dataIndex);m&&(p[m.id]=!0)}function y(b,_){var w=i[_],C=r[b],x=C.data.hostModel,S=w.data.getItemGraphicEl(w.dataIndex),A=C.data.getItemGraphicEl(C.dataIndex);if(S===A){A&&Bgt(A,C.dataIndex,x);return}S&&p[S.id]||A&&(Zc(A),S?(Zc(S),tR(S),s=!0,JM(Zu(S),Zu(A),C.divide,x,b,o)):QM(A,x,b))}new rc(i,r,f(!0,g),f(!1,g),null,"multiple").update(y).updateManyToOne(function(b,_){var w=r[b],C=w.data,x=C.hostModel,S=C.getItemGraphicEl(w.dataIndex),A=Ti(St(_,function(T){return i[T].data.getItemGraphicEl(i[T].dataIndex)}),function(T){return T&&T!==S&&!p[T.id]});S&&(Zc(S),A.length?(N(A,function(T){Zc(T),tR(T)}),s=!0,JM(Zu(A),Zu(S),w.divide,x,b,o)):QM(S,x,w.dataIndex))}).updateOneToMany(function(b,_){var w=i[_],C=w.data.getItemGraphicEl(w.dataIndex);if(!(C&&p[C.id])){var x=Ti(St(b,function(A){return r[A].data.getItemGraphicEl(r[A].dataIndex)}),function(A){return A&&A!==C}),S=r[b[0]].data.hostModel;x.length&&(N(x,function(A){return Zc(A)}),C?(Zc(C),tR(C),s=!0,JM(Zu(C),Zu(x),w.divide,S,b[0],o)):N(x,function(A){return QM(A,S,b[0])}))}}).updateManyToMany(function(b,_){new rc(_,b,function(w){return i[w].data.getId(i[w].dataIndex)},function(w){return r[w].data.getId(r[w].dataIndex)}).update(function(w,C){y(b[w],_[C])}).execute()}).execute(),s&&N(t,function(b){var _=b.data,w=_.hostModel,C=w&&e.getViewOfSeriesModel(w),x=uS("update",w,0);C&&w.isAnimationEnabled()&&x&&x.duration>0&&C.group.traverse(function(S){S instanceof Ee&&!S.animators.length&&S.animateFrom({style:{opacity:0}},x)})})}function L3(n){var t=n.getModel("universalTransition").get("seriesKey");return t||n.id}function O3(n){return _t(n)?n.sort().join(","):n}function _h(n){if(n.hostModel)return n.hostModel.getModel("universalTransition").get("divideShape")}function kgt(n,t){var e=$t(),i=$t(),r=$t();return N(n.oldSeries,function(o,s){var a=n.oldDataGroupIds[s],l=n.oldData[s],h=L3(o),u=O3(h);i.set(u,{dataGroupId:a,data:l}),_t(h)&&N(h,function(d){r.set(d,{key:u,dataGroupId:a,data:l})})}),N(t.updatedSeries,function(o){if(o.isUniversalTransitionEnabled()&&o.isAnimationEnabled()){var s=o.get("dataGroupId"),a=o.getData(),l=L3(o),h=O3(l),u=i.get(h);if(u)e.set(h,{oldSeries:[{dataGroupId:u.dataGroupId,divide:_h(u.data),data:u.data}],newSeries:[{dataGroupId:s,divide:_h(a),data:a}]});else if(_t(l)){var d=[];N(l,function(g){var p=i.get(g);p.data&&d.push({dataGroupId:p.dataGroupId,divide:_h(p.data),data:p.data})}),d.length&&e.set(h,{oldSeries:d,newSeries:[{dataGroupId:s,data:a,divide:_h(a)}]})}else{var c=r.get(l);if(c){var f=e.get(c.key);f||(f={oldSeries:[{dataGroupId:c.dataGroupId,data:c.data,divide:_h(c.data)}],newSeries:[]},e.set(c.key,f)),f.newSeries.push({dataGroupId:s,data:a,divide:_h(a)})}}}}),e}function D3(n,t){for(var e=0;e<n.length;e++){var i=t.seriesIndex!=null&&t.seriesIndex===n[e].seriesIndex||t.seriesId!=null&&t.seriesId===n[e].id;if(i)return e}}function Egt(n,t,e,i){var r=[],o=[];N(Ni(n.from),function(s){var a=D3(t.oldSeries,s);a>=0&&r.push({dataGroupId:t.oldDataGroupIds[a],data:t.oldData[a],divide:_h(t.oldData[a]),groupIdDim:s.dimension})}),N(Ni(n.to),function(s){var a=D3(e.updatedSeries,s);if(a>=0){var l=e.updatedSeries[a].getData();o.push({dataGroupId:t.oldDataGroupIds[a],data:l,divide:_h(l),groupIdDim:s.dimension})}}),r.length>0&&o.length>0&&iU(r,o,i)}function R7t(n){n.registerUpdateLifecycle("series:beforeupdate",function(t,e,i){N(Ni(i.seriesTransition),function(r){N(Ni(r.to),function(o){for(var s=i.updatedSeries,a=0;a<s.length;a++)(o.seriesIndex!=null&&o.seriesIndex===s[a].seriesIndex||o.seriesId!=null&&o.seriesId===s[a].id)&&(s[a][Q_]=!0)})})}),n.registerUpdateLifecycle("series:transition",function(t,e,i){var r=Tgt(e);if(r.oldSeries&&i.updatedSeries&&i.optionChanged){var o=i.seriesTransition;if(o)N(Ni(o),function(f){Egt(f,r,i,e)});else{var s=kgt(r,i);N(s.keys(),function(f){var g=s.get(f);iU(g.oldSeries,g.newSeries,e)})}N(i.updatedSeries,function(f){f[Q_]&&(f[Q_]=!1)})}for(var a=t.getSeries(),l=r.oldSeries=[],h=r.oldDataGroupIds=[],u=r.oldData=[],d=0;d<a.length;d++){var c=a[d].getData();c.count()<eU&&(l.push(a[d]),h.push(a[d].get("dataGroupId")),u.push(c))}})}typeof window=="object"&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);typeof window<"u"&&function(n){n.forEach(t=>{Object.prototype.hasOwnProperty.call(t,"append")||Object.defineProperty(t,"append",{configurable:!0,enumerable:!0,writable:!0,value(...e){const i=document.createDocumentFragment();e.forEach(r=>{const o=r instanceof Node;i.appendChild(o?r:document.createTextNode(String(r)))}),this.appendChild(i)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype]);class Gl{get disposed(){return this._disposed===!0}dispose(){this._disposed=!0}}(function(n){function t(){return(e,i,r)=>{const o=r.value,s=e.__proto__;r.value=function(...a){this.disposed||(o.call(this,...a),s.dispose.call(this))}}}n.dispose=t})(Gl||(Gl={}));class I3{constructor(){this.isDisposed=!1,this.items=new Set}get disposed(){return this.isDisposed}dispose(){this.isDisposed||(this.isDisposed=!0,this.items.forEach(t=>{t.dispose()}),this.items.clear())}contains(t){return this.items.has(t)}add(t){this.items.add(t)}remove(t){this.items.delete(t)}clear(){this.items.clear()}}(function(n){function t(e){const i=new n;return e.forEach(r=>{i.add(r)}),i}n.from=t})(I3||(I3={}));function nU(n,t,e){if(e)switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2]);case 4:return n.call(t,e[0],e[1],e[2],e[3]);case 5:return n.call(t,e[0],e[1],e[2],e[3],e[4]);case 6:return n.call(t,e[0],e[1],e[2],e[3],e[4],e[5]);default:return n.apply(t,e)}return n.call(t)}function Qt(n,t,...e){return nU(n,t,e)}function Lgt(n){return typeof n=="object"&&n.then&&typeof n.then=="function"}function H3(n){return n!=null&&(n instanceof Promise||Lgt(n))}function rU(...n){const t=[];if(n.forEach(i=>{Array.isArray(i)?t.push(...i):t.push(i)}),t.some(i=>H3(i))){const i=t.map(r=>H3(r)?r:Promise.resolve(r!==!1));return Promise.all(i).then(r=>r.reduce((o,s)=>s!==!1&&o,!0))}return t.every(i=>i!==!1)}function eR(n,t){const e=[];for(let i=0;i<n.length;i+=2){const r=n[i],o=n[i+1],s=Array.isArray(t)?t:[t],a=nU(r,o,s);e.push(a)}return rU(e)}class Ogt{constructor(){this.listeners={}}on(t,e,i){return e==null?this:(this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e,i),this)}once(t,e,i){const r=(...o)=>(this.off(t,r),eR([e,i],o));return this.on(t,r,this)}off(t,e,i){if(!(t||e||i))return this.listeners={},this;const r=this.listeners;return(t?[t]:Object.keys(r)).forEach(s=>{const a=r[s];if(a){if(!(e||i)){delete r[s];return}for(let l=a.length-2;l>=0;l-=2)e&&a[l]!==e||i&&a[l+1]!==i||a.splice(l,2)}}),this}trigger(t,...e){let i=!0;if(t!=="*"){const o=this.listeners[t];o!=null&&(i=eR([...o],e))}const r=this.listeners["*"];return r!=null?rU([i,eR([...r],[t,...e])]):i}emit(t,...e){return this.trigger(t,...e)}}function Dgt(n,...t){t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(i=>{i!=="constructor"&&Object.defineProperty(n.prototype,i,Object.getOwnPropertyDescriptor(e.prototype,i))})})}const Igt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])};function Hgt(n,t){Igt(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}class Fgt{}const zgt=/^\s*class\s+/.test(`${Fgt}`)||/^\s*class\s*\{/.test(`${class{}}`);function KL(n,t){let e;return zgt?e=class extends t{}:(e=function(){return t.apply(this,arguments)},Hgt(e,t)),Object.defineProperty(e,"name",{value:n}),e}function F3(n){return n==="__proto__"}function qL(n,t,e="/"){let i;const r=Array.isArray(t)?t:t.split(e);if(r.length)for(i=n;r.length;){const o=r.shift();if(Object(i)===i&&o&&o in i)i=i[o];else return}return i}function yp(n,t,e,i="/"){const r=Array.isArray(t)?t:t.split(i),o=r.pop();if(o&&!F3(o)){let s=n;r.forEach(a=>{F3(a)||(s[a]==null&&(s[a]={}),s=s[a])}),s[o]=e}return n}function z3(n,t,e="/"){const i=Array.isArray(t)?t.slice():t.split(e),r=i.pop();if(r)if(i.length>0){const o=qL(n,i);o&&delete o[r]}else delete n[r];return n}var Ngt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class To extends Ogt{dispose(){this.off()}}Ngt([Gl.dispose()],To.prototype,"dispose",null);(function(n){n.dispose=Gl.dispose})(To||(To={}));Dgt(To,Gl);const oU=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},sU=oU(n=>n.replace(/\B([A-Z])/g,"-$1").toLowerCase()),ZL=oU(n=>LQ(Kx(n)).replace(/ /g,""));function iR(n){let t=2166136261,e=!1,i=n;for(let r=0,o=i.length;r<o;r+=1){let s=i.charCodeAt(r);s>127&&!e&&(i=unescape(encodeURIComponent(i)),s=i.charCodeAt(r),e=!0),t^=s,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function pw(){let n="";const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";for(let e=0,i=t.length;e<i;e+=1){const r=t[e],o=Math.random()*16|0,s=r==="x"?o:r==="y"?o&3|8:r;n+=s.toString(16)}return n}function Wgt(n,t,e){const i=Math.min(2,Math.floor(n.length*.34));let r=Math.floor(n.length*.4)+1,o,s=!1;const a=n.toLowerCase();for(const l of t){const h=e(l);if(h!==void 0&&Math.abs(h.length-a.length)<=i){const u=h.toLowerCase();if(u===a){if(h===n)continue;return l}if(s||h.length<3)continue;const d=Vgt(a,u,r-1);if(d===void 0)continue;d<3?(s=!0,o=l):(r=d,o=l)}}return o}function Vgt(n,t,e){let i=new Array(t.length+1),r=new Array(t.length+1);const o=e+1;for(let a=0;a<=t.length;a+=1)i[a]=a;for(let a=1;a<=n.length;a+=1){const l=n.charCodeAt(a-1),h=a>e?a-e:1,u=t.length>e+a?e+a:t.length;r[0]=a;let d=a;for(let f=1;f<h;f+=1)r[f]=o;for(let f=h;f<=u;f+=1){const g=l===t.charCodeAt(f-1)?i[f-1]:Math.min(i[f]+1,r[f-1]+1,i[f-1]+2);r[f]=g,d=Math.min(d,g)}for(let f=u+1;f<=t.length;f+=1)r[f]=o;if(d>e)return;const c=i;i=r,r=c}const s=i[t.length];return s>e?void 0:s}function $l(n){return typeof n=="string"&&n.slice(-1)==="%"}function Gs(n,t){if(n==null)return 0;let e;if(typeof n=="string"){if(e=parseFloat(n),$l(n)&&(e/=100,Number.isFinite(e)))return e*t}else e=n;return Number.isFinite(e)?e>0&&e<1?e*t:e:0}function lc(n){if(typeof n=="object"){let e=0,i=0,r=0,o=0;return n.vertical!=null&&Number.isFinite(n.vertical)&&(i=o=n.vertical),n.horizontal!=null&&Number.isFinite(n.horizontal)&&(r=e=n.horizontal),n.left!=null&&Number.isFinite(n.left)&&(e=n.left),n.top!=null&&Number.isFinite(n.top)&&(i=n.top),n.right!=null&&Number.isFinite(n.right)&&(r=n.right),n.bottom!=null&&Number.isFinite(n.bottom)&&(o=n.bottom),{top:i,right:r,bottom:o,left:e}}let t=0;return n!=null&&Number.isFinite(n)&&(t=n),{top:t,right:t,bottom:t,left:t}}let JL=!1,aU=!1,lU=!1,hU=!1,uU=!1,dU=!1,cU=!1,fU=!1,gU=!1,pU=!1,vU=!1,mU=!1,yU=!1,bU=!1,_U=!1,CU=!1;if(typeof navigator=="object"){const n=navigator.userAgent;JL=n.indexOf("Macintosh")>=0,aU=!!n.match(/(iPad|iPhone|iPod)/g),lU=n.indexOf("Windows")>=0,hU=n.indexOf("MSIE")>=0,uU=!!n.match(/Trident\/7\./),dU=!!n.match(/Edge\//),cU=n.indexOf("Mozilla/")>=0&&n.indexOf("MSIE")<0&&n.indexOf("Edge/")<0,gU=n.indexOf("Chrome/")>=0&&n.indexOf("Edge/")<0,pU=n.indexOf("Opera/")>=0||n.indexOf("OPR/")>=0,vU=n.indexOf("Firefox/")>=0,mU=n.indexOf("AppleWebKit/")>=0&&n.indexOf("Chrome/")<0&&n.indexOf("Edge/")<0,typeof document=="object"&&(CU=!document.createElementNS||`${document.createElementNS("http://www.w3.org/2000/svg","foreignObject")}`!="[object SVGForeignObjectElement]"||n.indexOf("Opera/")>=0)}typeof window=="object"&&(fU=window.chrome!=null&&window.chrome.app!=null&&window.chrome.app.runtime!=null,bU=window.PointerEvent!=null&&!JL);if(typeof document=="object"){yU="ontouchstart"in document.documentElement;try{const n=Object.defineProperty({},"passive",{get(){_U=!0}}),t=document.createElement("div");t.addEventListener&&t.addEventListener("click",()=>{},n)}catch{}}var qh;(function(n){n.IS_MAC=JL,n.IS_IOS=aU,n.IS_WINDOWS=lU,n.IS_IE=hU,n.IS_IE11=uU,n.IS_EDGE=dU,n.IS_NETSCAPE=cU,n.IS_CHROME_APP=fU,n.IS_CHROME=gU,n.IS_OPERA=pU,n.IS_FIREFOX=vU,n.IS_SAFARI=mU,n.SUPPORT_TOUCH=yU,n.SUPPORT_POINTER=bU,n.SUPPORT_PASSIVE=_U,n.NO_FOREIGNOBJECT=CU,n.SUPPORT_FOREIGNOBJECT=!n.NO_FOREIGNOBJECT})(qh||(qh={}));(function(n){function t(){const o=window.module;return o!=null&&o.hot!=null&&o.hot.status!=null?o.hot.status():"unkonwn"}n.getHMRStatus=t;function e(){return t()==="apply"}n.isApplyingHMR=e;const i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function r(o){const s=document.createElement(i[o]||"div"),a=`on${o}`;let l=a in s;return l||(s.setAttribute(a,"return;"),l=typeof s[a]=="function"),l}n.isEventSupported=r})(qh||(qh={}));const QL=/[\t\r\n\f]/g,tO=/\S+/g,Mg=n=>` ${n} `;function Rg(n){return n&&n.getAttribute&&n.getAttribute("class")||""}function py(n,t){if(n==null||t==null)return!1;const e=Mg(Rg(n)),i=Mg(t);return n.nodeType===1?e.replace(QL," ").includes(i):!1}function je(n,t){if(!(n==null||t==null)){if(typeof t=="function")return je(n,t(Rg(n)));if(typeof t=="string"&&n.nodeType===1){const e=t.match(tO)||[],i=Mg(Rg(n)).replace(QL," ");let r=e.reduce((o,s)=>o.indexOf(Mg(s))<0?`${o}${s} `:o,i);r=r.trim(),i!==r&&n.setAttribute("class",r)}}}function rs(n,t){if(n!=null){if(typeof t=="function")return rs(n,t(Rg(n)));if((!t||typeof t=="string")&&n.nodeType===1){const e=(t||"").match(tO)||[],i=Mg(Rg(n)).replace(QL," ");let r=e.reduce((o,s)=>{const a=Mg(s);return o.indexOf(a)>-1?o.replace(a," "):o},i);r=t?r.trim():"",i!==r&&n.setAttribute("class",r)}}}function wU(n,t,e){if(!(n==null||t==null)){if(e!=null&&typeof t=="string"){e?je(n,t):rs(n,t);return}if(typeof t=="function")return wU(n,t(Rg(n),e),e);typeof t=="string"&&(t.match(tO)||[]).forEach(r=>{py(n,r)?rs(n,r):je(n,r)})}}let N3=0;function Ggt(){return N3+=1,`v${N3}`}function eO(n){return(n.id==null||n.id==="")&&(n.id=Ggt()),n.id}function Zh(n){return n==null?!1:typeof n.getScreenCTM=="function"&&n instanceof SVGElement}const Dn={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},W3="1.1";function V3(n,t=document){return t.createElement(n)}function iO(n,t=Dn.xhtml,e=document){return e.createElementNS(t,n)}function ra(n,t=document){return iO(n,Dn.svg,t)}function vw(n){if(n){const e=`<svg xmlns="${Dn.svg}" xmlns:xlink="${Dn.xlink}" version="${W3}">${n}</svg>`,{documentElement:i}=$gt(e,{async:!1});return i}const t=document.createElementNS(Dn.svg,"svg");return t.setAttributeNS(Dn.xmlns,"xmlns:xlink",Dn.xlink),t.setAttribute("version",W3),t}function $gt(n,t={}){let e;try{const i=new DOMParser;if(t.async!=null){const r=i;r.async=t.async}e=i.parseFromString(n,t.mimeType||"text/xml")}catch{e=void 0}if(!e||e.getElementsByTagName("parsererror").length)throw new Error(`Invalid XML: ${n}`);return e}function jgt(n,t=!0){const e=n.nodeName;return t?e.toLowerCase():e.toUpperCase()}function nO(n){let t=0,e=n.previousSibling;for(;e;)e.nodeType===1&&(t+=1),e=e.previousSibling;return t}function Ugt(n,t){return n.querySelectorAll(t)}function Xgt(n,t){return n.querySelector(t)}function xU(n,t,e){const i=n.ownerSVGElement;let r=n.parentNode;for(;r&&r!==e&&r!==i;){if(py(r,t))return r;r=r.parentNode}return null}function SU(n,t){const e=t&&t.parentNode;return n===e||!!(e&&e.nodeType===1&&n.compareDocumentPosition(e)&16)}function Bg(n){n&&(Array.isArray(n)?n:[n]).forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}function vy(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function my(n,t){(Array.isArray(t)?t:[t]).forEach(i=>{i!=null&&n.appendChild(i)})}function Ygt(n,t){const e=n.firstChild;return e?rO(e,t):my(n,t)}function rO(n,t){const e=n.parentNode;e&&(Array.isArray(t)?t:[t]).forEach(r=>{r!=null&&e.insertBefore(r,n)})}function Kgt(n,t){t?.appendChild(n)}function G3(n){try{return n instanceof HTMLElement}catch{return typeof n=="object"&&n.nodeType===1&&typeof n.style=="object"&&typeof n.ownerDocument=="object"}}const AU=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function qgt(n,t){return n.getAttribute(t)}function TU(n,t){const e=RU(t);e.ns?n.hasAttributeNS(e.ns,e.local)&&n.removeAttributeNS(e.ns,e.local):n.hasAttribute(t)&&n.removeAttribute(t)}function oO(n,t,e){if(e==null)return TU(n,t);const i=RU(t);i.ns&&typeof e=="string"?n.setAttributeNS(i.ns,t,e):t==="id"?n.id=`${e}`:n.setAttribute(t,`${e}`)}function MU(n,t){Object.keys(t).forEach(e=>{oO(n,e,t[e])})}function mi(n,t,e){if(t==null){const i=n.attributes,r={};for(let o=0;o<i.length;o+=1)r[i[o].name]=i[o].value;return r}if(typeof t=="string"&&e===void 0)return n.getAttribute(t);typeof t=="object"?MU(n,t):oO(n,t,e)}function RU(n){if(n.indexOf(":")!==-1){const t=n.split(":");return{ns:Dn[t[0]],local:t[1]}}return{ns:null,local:n}}function lm(n){const t={};return Object.keys(n).forEach(e=>{const i=AU.includes(e)?e:sU(e);t[i]=n[e]}),t}function Ib(n){const t={};return n.split(";").forEach(i=>{const r=i.trim();if(r){const o=r.split("=");o.length&&(t[o[0].trim()]=o[1]?o[1].trim():"")}}),t}function KB(n,t){return Object.keys(t).forEach(e=>{if(e==="class")n[e]=n[e]?`${n[e]} ${t[e]}`:t[e];else if(e==="style"){const i=typeof n[e]=="object",r=typeof t[e]=="object";let o,s;i&&r?(o=n[e],s=t[e]):i?(o=n[e],s=Ib(t[e])):r?(o=Ib(n[e]),s=t[e]):(o=Ib(n[e]),s=Ib(t[e])),n[e]=KB(o,s)}else n[e]=t[e]}),n}function Zgt(n,t,e={}){const i=e.offset||0,r=[],o=[];let s,a,l=null;for(let h=0;h<n.length;h+=1){s=o[h]=n[h];for(let u=0,d=t.length;u<d;u+=1){const c=t[u],f=c.start+i,g=c.end+i;h>=f&&h<g&&(typeof s=="string"?s=o[h]={t:n[h],attrs:c.attrs}:s.attrs=KB(KB({},s.attrs),c.attrs),e.includeAnnotationIndices&&(s.annotations==null&&(s.annotations=[]),s.annotations.push(u)))}a=o[h-1],a?Rv(s)&&Rv(a)?(l=l,JSON.stringify(s.attrs)===JSON.stringify(a.attrs)?l.t+=s.t:(r.push(l),l=s)):Rv(s)||Rv(a)?(l=l,r.push(l),l=s):l=(l||"")+s:l=s}return l!=null&&r.push(l),r}function Jgt(n){return n.replace(/ /g,"")}var $3;(function(n){function t(h){const u="data:";return h.substr(0,u.length)===u}n.isDataUrl=t;function e(h,u){if(!h||t(h)){setTimeout(()=>u(null,h));return}const d=()=>{u(new Error(`Failed to load image: ${h}`))},c=window.FileReader?g=>{if(g.status===200){const p=new FileReader;p.onload=v=>{const m=v.target.result;u(null,m)},p.onerror=d,p.readAsDataURL(g.response)}else d()}:g=>{const p=v=>{const y=[];for(let b=0;b<v.length;b+=32768)y.push(String.fromCharCode.apply(null,v.subarray(b,b+32768)));return y.join("")};if(g.status===200){let v=h.split(".").pop()||"png";v==="svg"&&(v="svg+xml");const m=`data:image/${v};base64,`,y=new Uint8Array(g.response),b=m+btoa(p(y));u(null,b)}else d()},f=new XMLHttpRequest;f.responseType=window.FileReader?"blob":"arraybuffer",f.open("GET",h,!0),f.addEventListener("error",d),f.addEventListener("load",()=>c(f)),f.send()}n.imageToDataUri=e;function i(h){let u=h.replace(/\s/g,"");u=decodeURIComponent(u);const d=u.indexOf(","),c=u.slice(0,d),f=c.split(":")[1].split(";")[0],g=u.slice(d+1);let p;c.indexOf("base64")>=0?p=atob(g):p=unescape(encodeURIComponent(g));const v=new Uint8Array(p.length);for(let m=0;m<p.length;m+=1)v[m]=p.charCodeAt(m);return new Blob([v],{type:f})}n.dataUriToBlob=i;function r(h,u){const d=window.navigator.msSaveBlob;if(d)d(h,u);else{const c=window.URL.createObjectURL(h),f=document.createElement("a");f.href=c,f.download=u,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(c)}}n.downloadBlob=r;function o(h,u){const d=i(h);r(d,u)}n.downloadDataUri=o;function s(h){const u=h.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return u&&u[2]?u[2].replace(/\s+/," ").split(" "):null}function a(h){const u=parseFloat(h);return Number.isNaN(u)?null:u}function l(h,u={}){let d=null;const c=b=>(d==null&&(d=s(h)),d!=null?a(d[b]):null),f=b=>{const _=h.match(b);return _&&_[2]?a(_[2]):null};let g=u.width;if(g==null&&(g=f(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),g==null&&(g=c(2)),g==null)throw new Error("Can not parse width from svg string");let p=u.height;if(p==null&&(p=f(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),p==null&&(p=c(3)),p==null)throw new Error("Can not parse height from svg string");return`data:image/svg+xml,${encodeURIComponent(h).replace(/'/g,"%27").replace(/"/g,"%22")}`}n.svgToDataUrl=l})($3||($3={}));let dd;const Qgt={px(n){return n},mm(n){return dd*n},cm(n){return dd*n*10},in(n){return dd*n*25.4},pt(n){return dd*(25.4*n/72)},pc(n){return dd*(25.4*n/6)}};var j3;(function(n){function t(i,r,o){const s=document.createElement("div"),a=s.style;a.display="inline-block",a.position="absolute",a.left="-15000px",a.top="-15000px",a.width=i+(o||"px"),a.height=r+(o||"px"),document.body.appendChild(s);const l=s.getBoundingClientRect(),h={width:l.width||0,height:l.height||0};return document.body.removeChild(s),h}n.measure=t;function e(i,r){dd==null&&(dd=t("1","1","mm").width);const o=r?Qgt[r]:null;return o?o(i):i}n.toPx=e})(j3||(j3={}));const tpt=/-(.)/g;function ept(n){return n.replace(tpt,(t,e)=>e.toUpperCase())}const nR={},U3=["webkit","ms","moz","o"],BU=typeof document<"u"?document.createElement("div").style:{};function ipt(n){for(let t=0;t<U3.length;t+=1){const e=U3[t]+n;if(e in BU)return e}return null}function npt(n){const t=ept(n);if(nR[t]==null){const e=t.charAt(0).toUpperCase()+t.slice(1);nR[t]=t in BU?t:ipt(e)}return nR[t]}function X3(n,t){const e=n.ownerDocument&&n.ownerDocument.defaultView&&n.ownerDocument.defaultView.opener?n.ownerDocument.defaultView.getComputedStyle(n,null):window.getComputedStyle(n,null);return e&&t?e.getPropertyValue(t)||e[t]:e}const rpt={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function opt(n){return/^--/.test(n)}function spt(n,t,e){const i=window.getComputedStyle(n,null);return e?i.getPropertyValue(t)||void 0:i[t]||n.style[t]}function apt(n,t){return!rpt[n]&&typeof t=="number"?`${t}px`:t}function yy(n,t,e){if(typeof t=="string"){const i=opt(t);if(i||(t=npt(t)),e===void 0)return spt(n,t,i);i||(e=apt(t,e));const r=n.style;i?r.setProperty(t,e):r[t]=e;return}for(const i in t)yy(n,i,t[i])}const mw=new WeakMap;function Y3(n,t){const e=Kx(t),i=mw.get(n);if(i)return i[e]}function lpt(n,t,e){const i=Kx(t),r=mw.get(n);r?r[i]=e:mw.set(n,{[i]:e})}function hc(n,t,e){if(!t){const i={};return Object.keys(mw).forEach(r=>{i[r]=Y3(n,r)}),i}if(typeof t=="string"){if(e===void 0)return Y3(n,t);lpt(n,t,e);return}for(const i in t)hc(n,i,t[i])}class qt{get[Symbol.toStringTag](){return qt.toStringTag}get type(){return this.node.nodeName}get id(){return this.node.id}set id(t){this.node.id=t}constructor(t,e,i){if(!t)throw new TypeError("Invalid element to create vector");let r;if(qt.isVector(t))r=t.node;else if(typeof t=="string")if(t.toLowerCase()==="svg")r=vw();else if(t[0]==="<"){const o=vw(t);r=document.importNode(o.firstChild,!0)}else r=document.createElementNS(Dn.svg,t);else r=t;this.node=r,e&&this.setAttributes(e),i&&this.append(i)}transform(t,e){return t==null?Pg(this.node):(Pg(this.node,t,e),this)}translate(t,e=0,i={}){return t==null?q3(this.node):(q3(this.node,t,e,i),this)}rotate(t,e,i,r={}){return t==null?JB(this.node):(JB(this.node,t,e,i,r),this)}scale(t,e){return t==null?QB(this.node):(QB(this.node,t,e),this)}getTransformToElement(t){const e=qt.toNode(t);return m0(this.node,e)}removeAttribute(t){return TU(this.node,t),this}getAttribute(t){return qgt(this.node,t)}setAttribute(t,e){return oO(this.node,t,e),this}setAttributes(t){return MU(this.node,t),this}attr(t,e){return t==null?mi(this.node):typeof t=="string"&&e===void 0?mi(this.node,t):(typeof t=="object"?mi(this.node,t):mi(this.node,t,e),this)}svg(){return this.node instanceof SVGSVGElement?this:qt.create(this.node.ownerSVGElement)}defs(){const t=this.svg()||this,e=t.node.getElementsByTagName("defs")[0];return e?qt.create(e):qt.create("defs").appendTo(t)}text(t,e={}){return kU(this.node,t,e),this}tagName(){return jgt(this.node)}clone(){return qt.create(this.node.cloneNode(!0))}remove(){return Bg(this.node),this}empty(){return vy(this.node),this}append(t){return my(this.node,qt.toNodes(t)),this}appendTo(t){return Kgt(this.node,qt.isVector(t)?t.node:t),this}prepend(t){return Ygt(this.node,qt.toNodes(t)),this}before(t){return rO(this.node,qt.toNodes(t)),this}replace(t){return this.node.parentNode&&this.node.parentNode.replaceChild(qt.toNode(t),this.node),qt.create(t)}first(){return this.node.firstChild?qt.create(this.node.firstChild):null}last(){return this.node.lastChild?qt.create(this.node.lastChild):null}get(t){const e=this.node.childNodes[t];return e?qt.create(e):null}indexOf(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(qt.toNode(t))}find(t){const e=[],i=Ugt(this.node,t);if(i)for(let r=0,o=i.length;r<o;r+=1)e.push(qt.create(i[r]));return e}findOne(t){const e=Xgt(this.node,t);return e?qt.create(e):null}findParentByClass(t,e){const i=xU(this.node,t,e);return i?qt.create(i):null}matches(t){const e=this.node;this.node.matches;const i=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return i&&i.call(e,t)}contains(t){return SU(this.node,qt.isVector(t)?t.node:t)}wrap(t){const e=qt.create(t),i=this.node.parentNode;return i?.insertBefore(e.node,this.node),e.append(this)}parent(t){let e=this;if(e.node.parentNode==null)return null;if(e=qt.create(e.node.parentNode),t==null)return e;do if(typeof t=="string"?e.matches(t):e instanceof t)return e;while(e=qt.create(e.node.parentNode));return e}children(){const t=this.node.childNodes,e=[];for(let i=0;i<t.length;i+=1)t[i].nodeType===1&&e.push(qt.create(t[i]));return e}eachChild(t,e){const i=this.children();for(let r=0,o=i.length;r<o;r+=1)t.call(i[r],i[r],r,i),e&&i[r].eachChild(t,e);return this}index(){return nO(this.node)}hasClass(t){return py(this.node,t)}addClass(t){return je(this.node,t),this}removeClass(t){return rs(this.node,t),this}toggleClass(t,e){return wU(this.node,t,e),this}toLocalPoint(t,e){return Rpt(this.node,t,e)}sample(t=1){return this.node instanceof SVGPathElement?cpt(this.node,t):[]}toPath(){return qt.create(bpt(this.node))}toPathData(){return DU(this.node)}}(function(n){n.toStringTag=`X6.${n.name}`;function t(s){if(s==null)return!1;if(s instanceof n)return!0;const a=s[Symbol.toStringTag],l=s;return(a==null||a===n.toStringTag)&&l.node instanceof SVGElement&&typeof l.sample=="function"&&typeof l.toPath=="function"}n.isVector=t;function e(s,a,l){return new n(s,a,l)}n.create=e;function i(s){if(s[0]==="<"){const a=vw(s),l=[];for(let h=0,u=a.childNodes.length;h<u;h+=1){const d=a.childNodes[h];l.push(e(document.importNode(d,!0)))}return l}return[e(s)]}n.createVectors=i;function r(s){return t(s)?s.node:s}n.toNode=r;function o(s){return Array.isArray(s)?s.map(a=>r(a)):[r(s)]}n.toNodes=o})(qt||(qt={}));function hpt(n,t){const e=qt.create(t),i=qt.create("textPath"),r=n.d;if(r&&n["xlink:href"]===void 0){const o=qt.create("path").attr("d",r).appendTo(e.defs());i.attr("xlink:href",`#${o.id}`)}return typeof n=="object"&&i.attr(n),i.node}function upt(n,t,e){const i=e.eol,r=e.baseSize,o=e.lineHeight;let s=0,a;const l={},h=t.length-1;for(let u=0;u<=h;u+=1){let d=t[u],c=null;if(typeof d=="object"){const f=d.attrs,g=qt.create("tspan",f);a=g.node;let p=d.t;i&&u===h&&(p+=i),a.textContent=p;const v=f.class;v&&g.addClass(v),e.includeAnnotationIndices&&g.attr("annotations",d.annotations.join(",")),c=parseFloat(f["font-size"]),c===void 0&&(c=r),c&&c>s&&(s=c)}else i&&u===h&&(d+=i),a=document.createTextNode(d||" "),r&&r>s&&(s=r);n.appendChild(a)}return s&&(l.maxFontSize=s),o?l.lineHeight=o:s&&(l.lineHeight=s*1.2),l}const PU=/em$/;function Hb(n,t){const e=parseFloat(n);return PU.test(n)?e*t:e}function dpt(n,t,e,i){if(!Array.isArray(t))return 0;const r=t.length;if(!r)return 0;let o=t[0];const s=Hb(o.maxFontSize,e)||e;let a=0;const l=Hb(i,e);for(let d=1;d<r;d+=1){o=t[d];const c=Hb(o.lineHeight,e)||l;a+=c}const h=Hb(o.maxFontSize,e)||e;let u;switch(n){case"middle":u=s/2-.15*h-a/2;break;case"bottom":u=-(.25*h)-a;break;case"top":default:u=.8*s;break}return u}function kU(n,t,e={}){t=Jgt(t);const i=e.eol;let r=e.textPath;const o=e.textVerticalAnchor,s=o==="middle"||o==="bottom"||o==="top";let a=e.x;a===void 0&&(a=n.getAttribute("x")||0);const l=e.includeAnnotationIndices;let h=e.annotations;h&&!Array.isArray(h)&&(h=[h]);const u=e.lineHeight,d=u==="auto",c=d?"1.5em":u||"1em";let f=!0;const g=n.childNodes;if(g.length===1){const A=g[0];A&&A.tagName.toUpperCase()==="TITLE"&&(f=!1)}f&&vy(n),mi(n,{"xml:space":"preserve",display:t||e.displayEmpty?null:"none"});const p=mi(n,"font-size");let v=parseFloat(p);v||(v=16,(s||h)&&!p&&mi(n,"font-size",`${v}`));let m;r?(typeof r=="string"&&(r={d:r}),m=hpt(r,n)):m=document.createDocumentFragment();let y,b=0,_;const w=t.split(`
`),C=[],x=w.length-1;for(let A=0;A<=x;A+=1){y=c;let T="v-line";const M=ra("tspan");let R,E=w[A];if(E)if(h){const P=Zgt(E,h,{offset:-b,includeAnnotationIndices:l});R=upt(M,P,{eol:A!==x&&i,baseSize:v,lineHeight:d?null:c,includeAnnotationIndices:l});const B=R.lineHeight;B&&d&&A!==0&&(y=B),A===0&&(_=R.maxFontSize*.8)}else i&&A!==x&&(E+=i),M.textContent=E;else{M.textContent="-",T+=" v-empty-line";const P=M.style;P.fillOpacity=0,P.strokeOpacity=0,h&&(R={})}R&&C.push(R),A>0&&M.setAttribute("dy",y),(A>0||r)&&M.setAttribute("x",a),M.className.baseVal=T,m.appendChild(M),b+=E.length+1}if(s)if(h)y=dpt(o,C,v,c);else if(o==="top")y="0.8em";else{let A;switch(x>0?(A=parseFloat(c)||1,A*=x,PU.test(c)||(A/=v)):A=0,o){case"middle":y=`${.3-A/2}em`;break;case"bottom":y=`${-A-.3}em`;break}}else o===0?y="0em":o?y=o:(y=0,n.getAttribute("y")==null&&n.setAttribute("y",`${_||"0.8em"}`));m.firstChild.setAttribute("dy",y),n.appendChild(m)}function v0(n,t={}){const e=document.createElement("canvas").getContext("2d");if(!n)return{width:0};const i=[],r=t["font-size"]?`${parseFloat(t["font-size"])}px`:"14px";return i.push(t["font-style"]||"normal"),i.push(t["font-variant"]||"normal"),i.push(t["font-weight"]||400),i.push(r),i.push(t["font-family"]||"sans-serif"),e.font=i.join(" "),e.measureText(n)}function K3(n,t,e,i={}){if(t>=e)return[n,""];const r=n.length,o={};let s=Math.round(t/e*r-1);for(s<0&&(s=0);s>=0&&s<r;){const a=n.slice(0,s),l=o[a]||v0(a,i).width,h=n.slice(0,s+1),u=o[h]||v0(h,i).width;if(o[a]=l,o[h]=u,l>t)s-=1;else if(u<=t)s+=1;else break}return[n.slice(0,s),n.slice(s)]}function EU(n,t,e={},i={}){const r=t.width,o=t.height,s=i.eol||`
`,a=e.fontSize||14,l=e.lineHeight?parseFloat(e.lineHeight):Math.ceil(a*1.4),h=Math.floor(o/l);if(n.indexOf(s)>-1){const v=pw(),m=[];return n.split(s).map(y=>{const b=EU(y,Object.assign(Object.assign({},t),{height:Number.MAX_SAFE_INTEGER}),e,Object.assign(Object.assign({},i),{eol:v}));b&&m.push(...b.split(v))}),m.slice(0,h).join(s)}const{width:u}=v0(n,e);if(u<r)return n;const d=[];let c=n,f=u,g=i.ellipsis,p=0;g&&(typeof g!="string"&&(g=""),p=v0(g,e).width);for(let v=0;v<h;v+=1)if(f>r)if(v===h-1){const[y]=K3(c,r-p,f,e);d.push(g?`${y}${g}`:y)}else{const[y,b]=K3(c,r,f,e);d.push(y),c=b,f=v0(c,e).width}else{d.push(c);break}return d.join(s)}const qB=.551784;function Kn(n,t,e=NaN){const i=n.getAttribute(t);if(i==null)return e;const r=parseFloat(i);return Number.isNaN(r)?e:r}function cpt(n,t=1){const e=n.getTotalLength(),i=[];let r=0,o;for(;r<e;)o=n.getPointAtLength(r),i.push({distance:r,x:o.x,y:o.y}),r+=t;return i}function fpt(n){return["M",Kn(n,"x1"),Kn(n,"y1"),"L",Kn(n,"x2"),Kn(n,"y2")].join(" ")}function gpt(n){const t=yw(n);return t.length===0?null:`${LU(t)} Z`}function ppt(n){const t=yw(n);return t.length===0?null:LU(t)}function LU(n){return`M ${n.map(e=>`${e.x} ${e.y}`).join(" L")}`}function yw(n){const t=[],e=n.points;if(e)for(let i=0,r=e.numberOfItems;i<r;i+=1)t.push(e.getItem(i));return t}function vpt(n){const t=Kn(n,"cx",0),e=Kn(n,"cy",0),i=Kn(n,"r"),r=i*qB;return["M",t,e-i,"C",t+r,e-i,t+i,e-r,t+i,e,"C",t+i,e+r,t+r,e+i,t,e+i,"C",t-r,e+i,t-i,e+r,t-i,e,"C",t-i,e-r,t-r,e-i,t,e-i,"Z"].join(" ")}function mpt(n){const t=Kn(n,"cx",0),e=Kn(n,"cy",0),i=Kn(n,"rx"),r=Kn(n,"ry")||i,o=i*qB,s=r*qB;return["M",t,e-r,"C",t+o,e-r,t+i,e-s,t+i,e,"C",t+i,e+s,t+o,e+r,t,e+r,"C",t-o,e+r,t-i,e+s,t-i,e,"C",t-i,e-s,t-o,e-r,t,e-r,"Z"].join(" ")}function ypt(n){return OU({x:Kn(n,"x",0),y:Kn(n,"y",0),width:Kn(n,"width",0),height:Kn(n,"height",0),rx:Kn(n,"rx",0),ry:Kn(n,"ry",0)})}function OU(n){let t;const e=n.x,i=n.y,r=n.width,o=n.height,s=Math.min(n.rx||n["top-rx"]||0,r/2),a=Math.min(n.rx||n["bottom-rx"]||0,r/2),l=Math.min(n.ry||n["top-ry"]||0,o/2),h=Math.min(n.ry||n["bottom-ry"]||0,o/2);return s||a||l||h?t=["M",e,i+l,"v",o-l-h,"a",a,h,0,0,0,a,h,"h",r-2*a,"a",a,h,0,0,0,a,-h,"v",-(o-h-l),"a",s,l,0,0,0,-s,-l,"h",-(r-2*s),"a",s,l,0,0,0,-s,l,"Z"]:t=["M",e,i,"H",e+r,"V",i+o,"H",e,"V",i,"Z"],t.join(" ")}function bpt(n){const t=ra("path");mi(t,mi(n));const e=DU(n);return e&&t.setAttribute("d",e),t}function DU(n){const t=n.tagName.toLowerCase();switch(t){case"path":return n.getAttribute("d");case"line":return fpt(n);case"polygon":return gpt(n);case"polyline":return ppt(n);case"ellipse":return mpt(n);case"circle":return vpt(n);case"rect":return ypt(n)}throw new Error(`"${t}" cannot be converted to svg path element.`)}const _pt=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,IU=/[ ,]+/,Cpt=/^(\w+)\((.*)\)/;function wpt(n,t){const i=ra("svg").createSVGPoint();return i.x=n,i.y=t,i}function zn(n){const e=ra("svg").createSVGMatrix();if(n!=null){const i=n,r=e;for(const o in i)r[o]=i[o]}return e}function Fv(n){const t=ra("svg");return n!=null?(n instanceof DOMMatrix||(n=zn(n)),t.createSVGTransformFromMatrix(n)):t.createSVGTransform()}function hm(n){let t=zn();const e=n!=null&&n.match(_pt);if(!e)return t;for(let i=0,r=e.length;i<r;i+=1){const s=e[i].match(Cpt);if(s){let a,l,h,u,d,c=zn();const f=s[2].split(IU);switch(s[1].toLowerCase()){case"scale":a=parseFloat(f[0]),l=f[1]===void 0?a:parseFloat(f[1]),c=c.scaleNonUniform(a,l);break;case"translate":h=parseFloat(f[0]),u=parseFloat(f[1]),c=c.translate(h,u);break;case"rotate":d=parseFloat(f[0]),h=parseFloat(f[1])||0,u=parseFloat(f[2])||0,h!==0||u!==0?c=c.translate(h,u).rotate(d).translate(-h,-u):c=c.rotate(d);break;case"skewx":d=parseFloat(f[0]),c=c.skewX(d);break;case"skewy":d=parseFloat(f[0]),c=c.skewY(d);break;case"matrix":c.a=parseFloat(f[0]),c.b=parseFloat(f[1]),c.c=parseFloat(f[2]),c.d=parseFloat(f[3]),c.e=parseFloat(f[4]),c.f=parseFloat(f[5]);break;default:continue}t=t.multiply(c)}}return t}function bp(n){const t=n||{},e=t.a!=null?t.a:1,i=t.b!=null?t.b:0,r=t.c!=null?t.c:0,o=t.d!=null?t.d:1,s=t.e!=null?t.e:0,a=t.f!=null?t.f:0;return`matrix(${e},${i},${r},${o},${s},${a})`}function kS(n){let t,e,i;if(n){const o=IU;if(n.trim().indexOf("matrix")>=0){const s=hm(n),a=xpt(s);t=[a.translateX,a.translateY],e=[a.rotation],i=[a.scaleX,a.scaleY];const l=[];(t[0]!==0||t[1]!==0)&&l.push(`translate(${t.join(",")})`),(i[0]!==1||i[1]!==1)&&l.push(`scale(${i.join(",")})`),e[0]!==0&&l.push(`rotate(${e[0]})`),n=l.join(" ")}else{const s=n.match(/translate\((.*?)\)/);s&&(t=s[1].split(o));const a=n.match(/rotate\((.*?)\)/);a&&(e=a[1].split(o));const l=n.match(/scale\((.*?)\)/);l&&(i=l[1].split(o))}}const r=i&&i[0]?parseFloat(i[0]):1;return{raw:n||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:e&&e[0]?parseInt(e[0],10):0,cx:e&&e[1]?parseInt(e[1],10):void 0,cy:e&&e[2]?parseInt(e[2],10):void 0},scale:{sx:r,sy:i&&i[1]?parseFloat(i[1]):r}}}function ZB(n,t){const e=t.x*n.a+t.y*n.c+0,i=t.x*n.b+t.y*n.d+0;return{x:e,y:i}}function xpt(n){const t=ZB(n,{x:0,y:1}),e=ZB(n,{x:1,y:0}),i=180/Math.PI*Math.atan2(t.y,t.x)-90,r=180/Math.PI*Math.atan2(e.y,e.x);return{skewX:i,skewY:r,translateX:n.e,translateY:n.f,scaleX:Math.sqrt(n.a*n.a+n.b*n.b),scaleY:Math.sqrt(n.c*n.c+n.d*n.d),rotation:i}}function Spt(n){let t,e,i,r;return n?(t=n.a==null?1:n.a,r=n.d==null?1:n.d,e=n.b,i=n.c):t=r=1,{sx:e?Math.sqrt(t*t+e*e):t,sy:i?Math.sqrt(i*i+r*r):r}}function Apt(n){let t={x:0,y:1};n&&(t=ZB(n,t));const e=180*Math.atan2(t.y,t.x)/Math.PI%360-90;return{angle:e%360+(e<0?360:0)}}function Tpt(n){return{tx:n&&n.e||0,ty:n&&n.f||0}}function Pg(n,t,e={}){if(t==null)return hm(mi(n,"transform"));if(e.absolute){n.setAttribute("transform",bp(t));return}const i=n.transform,r=Fv(t);i.baseVal.appendItem(r)}function q3(n,t,e=0,i={}){let r=mi(n,"transform");const o=kS(r);if(t==null)return o.translation;r=o.raw,r=r.replace(/translate\([^)]*\)/g,"").trim();const s=i.absolute?t:o.translation.tx+t,a=i.absolute?e:o.translation.ty+e,l=`translate(${s},${a})`;n.setAttribute("transform",`${l} ${r}`.trim())}function JB(n,t,e,i,r={}){let o=mi(n,"transform");const s=kS(o);if(t==null)return s.rotation;o=s.raw,o=o.replace(/rotate\([^)]*\)/g,"").trim(),t%=360;const a=r.absolute?t:s.rotation.angle+t,l=e!=null&&i!=null?`,${e},${i}`:"",h=`rotate(${a}${l})`;n.setAttribute("transform",`${o} ${h}`.trim())}function QB(n,t,e){let i=mi(n,"transform");const r=kS(i);if(t==null)return r.scale;e=e??t,i=r.raw,i=i.replace(/scale\([^)]*\)/g,"").trim();const o=`scale(${t},${e})`;n.setAttribute("transform",`${i} ${o}`.trim())}function m0(n,t){if(Zh(t)&&Zh(n)){const e=t.getScreenCTM(),i=n.getScreenCTM();if(e&&i)return e.inverse().multiply(i)}return zn()}function Mpt(n,t){let e=zn();if(Zh(t)&&Zh(n)){let i=n;const r=[];for(;i&&i!==t;){const o=i.getAttribute("transform")||null,s=hm(o);r.push(s),i=i.parentNode}r.reverse().forEach(o=>{e=e.multiply(o)})}return e}function Rpt(n,t,e){const i=n instanceof SVGSVGElement?n:n.ownerSVGElement,r=i.createSVGPoint();r.x=t,r.y=e;try{const o=i.getScreenCTM(),s=r.matrixTransform(o.inverse()),a=m0(n,i).inverse();return s.matrixTransform(a)}catch{return r}}var Jo;(function(n){const t={};function e(o){return t[o]||{}}n.get=e;function i(o,s){t[o]=s}n.register=i;function r(o){delete t[o]}n.unregister=r})(Jo||(Jo={}));var xd;(function(n){const t=new WeakMap;function e(o){return t.has(o)||t.set(o,{events:Object.create(null)}),t.get(o)}n.ensure=e;function i(o){return t.get(o)}n.get=i;function r(o){return t.delete(o)}n.remove=r})(xd||(xd={}));var ae;(function(n){n.returnTrue=()=>!0,n.returnFalse=()=>!1;function t(r){r.stopPropagation()}n.stopPropagationCallback=t;function e(r,o,s){r.addEventListener!=null&&r.addEventListener(o,s)}n.addEventListener=e;function i(r,o,s){r.removeEventListener!=null&&r.removeEventListener(o,s)}n.removeEventListener=i})(ae||(ae={}));(function(n){const t=/[^\x20\t\r\n\f]+/g,e=/^([^.]*)(?:\.(.+)|)/;function i(a){return(a||"").match(t)||[""]}n.splitType=i;function r(a){const l=e.exec(a)||[];return{originType:l[1]?l[1].trim():l[1],namespaces:l[2]?l[2].split(".").map(h=>h.trim()).sort():[]}}n.normalizeType=r;function o(a){return a.nodeType===1||a.nodeType===9||!+a.nodeType}n.isValidTarget=o;function s(a,l){if(l){const h=a;return h.querySelector!=null&&h.querySelector(l)!=null}return!0}n.isValidSelector=s})(ae||(ae={}));(function(n){let t=0;const e=new WeakMap;function i(a){return e.has(a)||(e.set(a,t),t+=1),e.get(a)}n.ensureHandlerId=i;function r(a){return e.get(a)}n.getHandlerId=r;function o(a){return e.delete(a)}n.removeHandlerId=o;function s(a,l){return e.set(a,l)}n.setHandlerId=s})(ae||(ae={}));(function(n){function t(e,i){const r=[],o=xd.get(e),s=o&&o.events&&o.events[i.type],a=s&&s.handlers||[],l=s?s.delegateCount:0;if(l>0&&!(i.type==="click"&&typeof i.button=="number"&&i.button>=1)){for(let h=i.target;h!==e;h=h.parentNode||e)if(h.nodeType===1&&!(i.type==="click"&&h.disabled===!0)){const u=[],d={};for(let c=0;c<l;c+=1){const f=a[c],g=f.selector;if(g!=null&&d[g]==null){const p=e,v=[];p.querySelectorAll(g).forEach(m=>{v.push(m)}),d[g]=v.includes(h)}d[g]&&u.push(f)}u.length&&r.push({elem:h,handlers:u})}}return l<a.length&&r.push({elem:e,handlers:a.slice(l)}),r}n.getHandlerQueue=t})(ae||(ae={}));(function(n){function t(e){return e!=null&&e===e.window}n.isWindow=t})(ae||(ae={}));(function(n){function t(e,i){const r=e.nodeType===9?e.documentElement:e,o=i&&i.parentNode;return e===o||!!(o&&o.nodeType===1&&(r.contains?r.contains(o):e.compareDocumentPosition&&e.compareDocumentPosition(o)&16))}n.contains=t})(ae||(ae={}));class Da{constructor(t,e){this.isDefaultPrevented=ae.returnFalse,this.isPropagationStopped=ae.returnFalse,this.isImmediatePropagationStopped=ae.returnFalse,this.isSimulated=!1,this.preventDefault=()=>{const i=this.originalEvent;this.isDefaultPrevented=ae.returnTrue,i&&!this.isSimulated&&i.preventDefault()},this.stopPropagation=()=>{const i=this.originalEvent;this.isPropagationStopped=ae.returnTrue,i&&!this.isSimulated&&i.stopPropagation()},this.stopImmediatePropagation=()=>{const i=this.originalEvent;this.isImmediatePropagationStopped=ae.returnTrue,i&&!this.isSimulated&&i.stopImmediatePropagation(),this.stopPropagation()},typeof t=="string"?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?ae.returnTrue:ae.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),e&&Object.assign(this,e),this.timeStamp||(this.timeStamp=Date.now())}}(function(n){function t(e){return e instanceof n?e:new n(e)}n.create=t})(Da||(Da={}));(function(n){function t(e,i){Object.defineProperty(n.prototype,e,{enumerable:!0,configurable:!0,get:typeof i=="function"?function(){if(this.originalEvent)return i(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set(r){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:r})}})}n.addProperty=t})(Da||(Da={}));(function(n){const t={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(t).forEach(e=>n.addProperty(e,t[e]))})(Da||(Da={}));(function(n){Jo.register("load",{noBubble:!0})})();(function(n){Jo.register("beforeunload",{postDispatch(t,e){e.result!==void 0&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}})})();(function(n){Jo.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle(t,e){let i;const r=e.relatedTarget,o=e.handleObj;return(!r||r!==t&&!ae.contains(t,r))&&(e.type=o.originType,i=o.handler.call(t,e),e.type="mouseover"),i}}),Jo.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle(t,e){let i;const r=e.relatedTarget,o=e.handleObj;return(!r||r!==t&&!ae.contains(t,r))&&(e.type=o.originType,i=o.handler.call(t,e),e.type="mouseout"),i}})})();var Bpt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e},um;(function(n){let t;function e(s,a,l,h,u){if(!ae.isValidTarget(s))return;let d;if(typeof l!="function"){const{handler:p,selector:v}=l,m=Bpt(l,["handler","selector"]);l=p,u=v,d=m}const c=xd.ensure(s);let f=c.handler;f==null&&(f=c.handler=function(p,...v){return t!==p.type?r(s,p,...v):void 0});const g=ae.ensureHandlerId(l);ae.splitType(a).forEach(p=>{const{originType:v,namespaces:m}=ae.normalizeType(p);if(!v)return;let y=v,b=Jo.get(y);y=(u?b.delegateType:b.bindType)||y,b=Jo.get(y);const _=Object.assign({type:y,originType:v,data:h,selector:u,guid:g,handler:l,namespace:m.join(".")},d),w=c.events;let C=w[y];C||(C=w[y]={handlers:[],delegateCount:0},(!b.setup||b.setup(s,h,m,f)===!1)&&ae.addEventListener(s,y,f)),b.add&&(ae.removeHandlerId(_.handler),b.add(s,_),ae.setHandlerId(_.handler,g)),u?(C.handlers.splice(C.delegateCount,0,_),C.delegateCount+=1):C.handlers.push(_)})}n.on=e;function i(s,a,l,h,u){const d=xd.get(s);if(!d)return;const c=d.events;c&&(ae.splitType(a).forEach(f=>{const{originType:g,namespaces:p}=ae.normalizeType(f);if(!g){Object.keys(c).forEach(w=>{i(s,w+f,l,h,!0)});return}let v=g;const m=Jo.get(v);v=(h?m.delegateType:m.bindType)||v;const y=c[v];if(!y)return;const b=p.length>0?new RegExp(`(^|\\.)${p.join("\\.(?:.*\\.|)")}(\\.|$)`):null,_=y.handlers.length;for(let w=y.handlers.length-1;w>=0;w-=1){const C=y.handlers[w];(u||g===C.originType)&&(!l||ae.getHandlerId(l)===C.guid)&&(b==null||C.namespace&&b.test(C.namespace))&&(h==null||h===C.selector||h==="**"&&C.selector)&&(y.handlers.splice(w,1),C.selector&&(y.delegateCount-=1),m.remove&&m.remove(s,C))}_&&y.handlers.length===0&&((!m.teardown||m.teardown(s,p,d.handler)===!1)&&ae.removeEventListener(s,v,d.handler),delete c[v])}),Object.keys(c).length===0&&xd.remove(s))}n.off=i;function r(s,a,...l){const h=Da.create(a);h.delegateTarget=s;const u=Jo.get(h.type);if(u.preDispatch&&u.preDispatch(s,h)===!1)return;const d=ae.getHandlerQueue(s,h);for(let c=0,f=d.length;c<f&&!h.isPropagationStopped();c+=1){const g=d[c];h.currentTarget=g.elem;for(let p=0,v=g.handlers.length;p<v&&!h.isImmediatePropagationStopped();p+=1){const m=g.handlers[p];if(h.rnamespace==null||m.namespace&&h.rnamespace.test(m.namespace)){h.handleObj=m,h.data=m.data;const y=Jo.get(m.originType).handle,b=y?y(g.elem,h,...l):m.handler.call(g.elem,h,...l);b!==void 0&&(h.result=b,b===!1&&(h.preventDefault(),h.stopPropagation()))}}}return u.postDispatch&&u.postDispatch(s,h),h.result}n.dispatch=r;function o(s,a,l,h){let u=s,d=typeof s=="string"?s:s.type,c=typeof s=="string"||u.namespace==null?[]:u.namespace.split(".");const f=l;if(f.nodeType===3||f.nodeType===8)return;d.indexOf(".")>-1&&(c=d.split("."),d=c.shift(),c.sort());const g=d.indexOf(":")<0&&`on${d}`;u=s instanceof Da?s:new Da(d,typeof s=="object"?s:null),u.namespace=c.join("."),u.rnamespace=u.namespace?new RegExp(`(^|\\.)${c.join("\\.(?:.*\\.|)")}(\\.|$)`):null,u.result=void 0,u.target||(u.target=f);const p=[u];Array.isArray(a)?p.push(...a):p.push(a);const v=Jo.get(d);if(!h&&v.trigger&&v.trigger(f,u,a)===!1)return;let m;const y=[f];if(!h&&!v.noBubble&&!ae.isWindow(f)){m=v.delegateType||d;let _=f,w=f.parentNode;for(;w!=null;)y.push(w),_=w,w=w.parentNode;const C=f.ownerDocument||document;if(_===C){const x=_.defaultView||_.parentWindow||window;y.push(x)}}let b=f;for(let _=0,w=y.length;_<w&&!u.isPropagationStopped();_+=1){const C=y[_];b=C,u.type=_>1?m:v.bindType||d;const x=xd.get(C);x&&x.events[u.type]&&x.handler&&x.handler.call(C,...p);const S=g&&C[g]||null;S&&ae.isValidTarget(C)&&(u.result=S.call(C,...p),u.result===!1&&u.preventDefault())}if(u.type=d,!h&&!u.isDefaultPrevented()){const _=v.preventDefault;if((_==null||_(y.pop(),u,a)===!1)&&ae.isValidTarget(f)&&g&&typeof f[d]=="function"&&!ae.isWindow(f)){const w=f[g];w&&(f[g]=null),t=d,u.isPropagationStopped()&&b.addEventListener(d,ae.stopPropagationCallback),f[d](),u.isPropagationStopped()&&b.removeEventListener(d,ae.stopPropagationCallback),t=void 0,w&&(f[g]=w)}}return u.result}n.trigger=o})(um||(um={}));var Xn;(function(n){function t(o,s,a,l,h){return y0.on(o,s,a,l,h),o}n.on=t;function e(o,s,a,l,h){return y0.on(o,s,a,l,h,!0),o}n.once=e;function i(o,s,a,l){return y0.off(o,s,a,l),o}n.off=i;function r(o,s,a,l){return um.trigger(s,a,o,l),o}n.trigger=r})(Xn||(Xn={}));var y0;(function(n){function t(i,r,o,s,a,l){if(typeof r=="object"){typeof o!="string"&&(s=s||o,o=void 0),Object.keys(r).forEach(h=>t(i,h,o,s,r[h],l));return}if(s==null&&a==null?(a=o,s=o=void 0):a==null&&(typeof o=="string"?(a=s,s=void 0):(a=s,s=o,o=void 0)),a===!1)a=ae.returnFalse;else if(!a)return;if(l){const h=a;a=function(u,...d){return n.off(i,u),h.call(this,u,...d)},ae.setHandlerId(a,ae.ensureHandlerId(h))}um.on(i,r,a,s,o)}n.on=t;function e(i,r,o,s){const a=r;if(a&&a.preventDefault!=null&&a.handleObj!=null){const l=a.handleObj;e(a.delegateTarget,l.namespace?`${l.originType}.${l.namespace}`:l.originType,l.selector,l.handler);return}if(typeof r=="object"){const l=r;Object.keys(l).forEach(h=>e(i,h,o,l[h]));return}(o===!1||typeof o=="function")&&(s=o,o=void 0),s===!1&&(s=ae.returnFalse),um.off(i,r,s,o)}n.off=e})(y0||(y0={}));class HU{constructor(t,e,i){this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=qh.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=e,this.onWheelGuard=i,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}enable(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}disable(){this.target.removeEventListener(this.eventName,this.onWheel)}onWheel(t){if(this.onWheelGuard!=null&&!this.onWheelGuard(t))return;this.deltaX+=t.deltaX,this.deltaY+=t.deltaY,t.preventDefault();let e;(this.deltaX!==0||this.deltaY!==0)&&(t.stopPropagation(),e=!0),e===!0&&this.animationFrameId===0&&(this.animationFrameId=requestAnimationFrame(()=>{this.didWheel(t)}))}didWheel(t){this.animationFrameId=0,this.onWheelCallback(t,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}function FU(n,t=60){let e=null;return(...i)=>{e&&clearTimeout(e),e=window.setTimeout(()=>{n.apply(this,i)},t)}}function Ppt(n){let t=null,e=[];const i=()=>{if(getComputedStyle(n).position==="static"){const h=n.style;h.position="relative"}const l=document.createElement("object");return l.onload=()=>{l.contentDocument.defaultView.addEventListener("resize",r),r()},l.style.display="block",l.style.position="absolute",l.style.top="0",l.style.left="0",l.style.height="100%",l.style.width="100%",l.style.overflow="hidden",l.style.pointerEvents="none",l.style.zIndex="-1",l.style.opacity="0",l.setAttribute("tabindex","-1"),l.type="text/html",n.appendChild(l),l.data="about:blank",l},r=FU(()=>{e.forEach(l=>l(n))}),o=l=>{t||(t=i()),e.indexOf(l)===-1&&e.push(l)},s=()=>{t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",r),t.parentNode.removeChild(t),t=null,e=[])};return{element:n,bind:o,destroy:s,unbind:l=>{const h=e.indexOf(l);h!==-1&&e.splice(h,1),e.length===0&&t&&s()}}}function kpt(n){let t=null,e=[];const i=FU(()=>{e.forEach(l=>{l(n)})}),r=()=>{const l=new ResizeObserver(i);return l.observe(n),i(),l},o=l=>{t||(t=r()),e.indexOf(l)===-1&&e.push(l)},s=()=>{t&&(t.disconnect(),e=[],t=null)};return{element:n,bind:o,destroy:s,unbind:l=>{const h=e.indexOf(l);h!==-1&&e.splice(h,1),e.length===0&&t&&s()}}}const Ept=typeof ResizeObserver<"u"?kpt:Ppt;var bw;(function(n){const t=new WeakMap;function e(r){let o=t.get(r);return o||(o=Ept(r),t.set(r,o),o)}function i(r){r.destroy(),t.delete(r.element)}n.bind=(r,o)=>{const s=e(r);return s.bind(o),()=>s.unbind(o)},n.clear=r=>{const o=e(r);i(o)}})(bw||(bw={}));class dm{constructor(t={}){this.comparator=t.comparator||dm.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}isEmpty(){return this.data.length===0}insert(t,e,i){const r={priority:t,value:e},o=this.data.length;return i&&(r.id=i,this.index[i]=o),this.data.push(r),this.bubbleUp(o),this}peek(){return this.data[0]?this.data[0].value:null}peekPriority(){return this.data[0]?this.data[0].priority:null}updatePriority(t,e){const i=this.index[t];if(typeof i>"u")throw new Error(`Node with id '${t}' was not found in the heap.`);const r=this.data,o=r[i].priority,s=this.comparator(e,o);s<0?(r[i].priority=e,this.bubbleUp(i)):s>0&&(r[i].priority=e,this.bubbleDown(i))}remove(){const t=this.data,e=t[0],i=t.pop();return e.id&&delete this.index[e.id],t.length>0&&(t[0]=i,i.id&&(this.index[i.id]=0),this.bubbleDown(0)),e?e.value:null}heapify(){for(let t=0;t<this.data.length;t+=1)this.bubbleUp(t)}bubbleUp(t){const e=this.data;let i,r,o=t;for(;o>0&&(r=o-1>>>1,this.comparator(e[o].priority,e[r].priority)<0);){i=e[r],e[r]=e[o];let s=e[o].id;s!=null&&(this.index[s]=r),e[o]=i,s=e[o].id,s!=null&&(this.index[s]=o),o=r}}bubbleDown(t){const e=this.data,i=e.length-1;let r=t;for(;;){const o=(r<<1)+1,s=o+1;let a=r;if(o<=i&&this.comparator(e[o].priority,e[a].priority)<0&&(a=o),s<=i&&this.comparator(e[s].priority,e[a].priority)<0&&(a=s),a!==r){const l=e[a];e[a]=e[r];let h=e[r].id;h!=null&&(this.index[h]=a),e[r]=l,h=e[r].id,h!=null&&(this.index[h]=r),r=a}else break}}}(function(n){n.defaultComparator=(t,e)=>t-e})(dm||(dm={}));var tP;(function(n){function t(e,i,r=(o,s)=>1){const o={},s={},a={},l=new dm;for(o[i]=0,Object.keys(e).forEach(h=>{h!==i&&(o[h]=1/0),l.insert(o[h],h,h)});!l.isEmpty();){const h=l.remove();a[h]=!0;const u=e[h]||[];for(let d=0;d<u.length;d+=1){const c=u[d];if(!a[c]){const f=o[h]+r(h,c);f<o[c]&&(o[c]=f,s[c]=h,l.updatePriority(c,f))}}}return s}n.run=t})(tP||(tP={}));let _w=class zv{constructor(t,e,i,r){if(t==null)return this.set(255,255,255,1);if(typeof t=="number")return this.set(t,e,i,r);if(typeof t=="string")return zv.fromString(t)||this;if(Array.isArray(t))return this.set(t);this.set(t.r,t.g,t.b,t.a==null?1:t.a)}blend(t,e,i){this.set(t.r+(e.r-t.r)*i,t.g+(e.g-t.g)*i,t.b+(e.b-t.b)*i,t.a+(e.a-t.a)*i)}lighten(t){const e=zv.lighten(this.toArray(),t);this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3]}darken(t){this.lighten(-t)}set(t,e,i,r){const o=Array.isArray(t)?t[0]:t,s=Array.isArray(t)?t[1]:e,a=Array.isArray(t)?t[2]:i,l=Array.isArray(t)?t[3]:r;return this.r=Math.round(is(o,0,255)),this.g=Math.round(is(s,0,255)),this.b=Math.round(is(a,0,255)),this.a=l==null?1:is(l,0,1),this}toHex(){return`#${["r","g","b"].map(e=>{const i=this[e].toString(16);return i.length<2?`0${i}`:i}).join("")}`}toRGBA(){return this.toArray()}toHSLA(){return zv.rgba2hsla(this.r,this.g,this.b,this.a)}toCSS(t){const e=`${this.r},${this.g},${this.b},`;return t?`rgb(${e})`:`rgba(${e},${this.a})`}toGrey(){return zv.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}toArray(){return[this.r,this.g,this.b,this.a]}toString(){return this.toCSS()}};(function(n){function t(b){return new n(b)}n.fromArray=t;function e(b){return new n([...g(b),1])}n.fromHex=e;function i(b){const _=b.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(_){const w=_[1].split(/\s*,\s*/).map(C=>parseInt(C,10));return new n(w)}return null}n.fromRGBA=i;function r(b,_,w){w<0&&++w,w>1&&--w;const C=6*w;return C<1?b+(_-b)*C:2*w<1?_:3*w<2?b+(_-b)*(2/3-w)*6:b}function o(b){const _=b.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(_){const w=_[2].split(/\s*,\s*/),C=(parseFloat(w[0])%360+360)%360/360,x=parseFloat(w[1])/100,S=parseFloat(w[2])/100,A=w[3]==null?1:parseInt(w[3],10);return new n(h(C,x,S,A))}return null}n.fromHSLA=o;function s(b){if(b.startsWith("#"))return e(b);if(b.startsWith("rgb"))return i(b);const _=n.named[b];return _?e(_):o(b)}n.fromString=s;function a(b,_){return n.fromArray([b,b,b,_])}n.makeGrey=a;function l(b,_,w,C){const x=Array.isArray(b)?b[0]:b,S=Array.isArray(b)?b[1]:_,A=Array.isArray(b)?b[2]:w,T=Array.isArray(b)?b[3]:C,M=Math.max(x,S,A),R=Math.min(x,S,A),E=(M+R)/2;let P=0,B=0;if(R!==M){const k=M-R;switch(B=E>.5?k/(2-M-R):k/(M+R),M){case x:P=(S-A)/k+(S<A?6:0);break;case S:P=(A-x)/k+2;break;case A:P=(x-S)/k+4;break}P/=6}return[P,B,E,T??1]}n.rgba2hsla=l;function h(b,_,w,C){const x=Array.isArray(b)?b[0]:b,S=Array.isArray(b)?b[1]:_,A=Array.isArray(b)?b[2]:w,T=Array.isArray(b)?b[3]:C,M=A<=.5?A*(S+1):A+S-A*S,R=2*A-M;return[r(R,M,x+1/3)*256,r(R,M,x)*256,r(R,M,x-1/3)*256,T??1]}n.hsla2rgba=h;function u(b){return new n(Math.round(Math.random()*256),Math.round(Math.random()*256),Math.round(Math.random()*256),b?void 0:parseFloat(Math.random().toFixed(2)))}n.random=u;function d(){const b="0123456789ABCDEF";let _="#";for(let w=0;w<6;w+=1)_+=b[Math.floor(Math.random()*16)];return _}n.randomHex=d;function c(b){return u(b).toString()}n.randomRGBA=c;function f(b,_){if(typeof b=="string"){const A=b[0]==="#",[T,M,R]=g(b);return _?T*.299+M*.587+R*.114>186?"#000000":"#ffffff":`${A?"#":""}${p(255-T,255-M,255-R)}`}const w=b[0],C=b[1],x=b[2],S=b[3];return _?w*.299+C*.587+x*.114>186?[0,0,0,S]:[255,255,255,S]:[255-w,255-C,255-x,S]}n.invert=f;function g(b){const _=b.indexOf("#")===0?b:`#${b}`;let w=+`0x${_.substr(1)}`;if(!(_.length===4||_.length===7)||Number.isNaN(w))throw new Error("Invalid hex color.");const C=_.length===4?4:8,x=(1<<C)-1,S=["b","g","r"].map(()=>{const A=w&x;return w>>=C,C===4?17*A:A});return[S[2],S[1],S[0]]}function p(b,_,w){const C=x=>x.length<2?`0${x}`:x;return`${C(b.toString(16))}${C(_.toString(16))}${C(w.toString(16))}`}function v(b,_){return y(b,_)}n.lighten=v;function m(b,_){return y(b,-_)}n.darken=m;function y(b,_){if(typeof b=="string"){const x=b[0]==="#",S=parseInt(x?b.substr(1):b,16),A=is((S>>16)+_,0,255),T=is((S>>8&255)+_,0,255),M=is((S&255)+_,0,255);return`${x?"#":""}${(M|T<<8|A<<16).toString(16)}`}const w=p(b[0],b[1],b[2]),C=g(y(w,_));return[C[0],C[1],C[2],b[3]]}})(_w||(_w={}));(function(n){n.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}})(_w||(_w={}));class eP{constructor(){this.clear()}clear(){this.map=new WeakMap,this.arr=[]}has(t){return this.map.has(t)}get(t){return this.map.get(t)}set(t,e){this.map.set(t,e),this.arr.push(t)}delete(t){const e=this.arr.indexOf(t);e>=0&&this.arr.splice(e,1);const i=this.map.get(t);return this.map.delete(t),i}each(t){this.arr.forEach(e=>{const i=this.map.get(e);t(i,e)})}dispose(){this.clear()}}var kg;(function(n){function t(r){const o=[],s=[];return Array.isArray(r)?o.push(...r):r.split("|").forEach(a=>{a.indexOf("&")===-1?o.push(a):s.push(...a.split("&"))}),{or:o,and:s}}n.parse=t;function e(r,o){if(r!=null&&o!=null){const s=t(r),a=t(o),l=s.or.sort(),h=a.or.sort(),u=s.and.sort(),d=a.and.sort(),c=(f,g)=>f.length===g.length&&(f.length===0||f.every((p,v)=>p===g[v]));return c(l,h)&&c(u,d)}return r==null&&o==null}n.equals=e;function i(r,o,s){if(o==null||Array.isArray(o)&&o.length===0)return s?r.altKey!==!0&&r.ctrlKey!==!0&&r.metaKey!==!0&&r.shiftKey!==!0:!0;const{or:a,and:l}=t(o),h=u=>{const d=`${u.toLowerCase()}Key`;return r[d]===!0};return a.some(u=>h(u))&&l.every(u=>h(u))}n.isMatch=i})(kg||(kg={}));var uc;(function(n){n.linear=t=>t,n.quad=t=>t*t,n.cubic=t=>t*t*t,n.inout=t=>{if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)},n.exponential=t=>Math.pow(2,10*(t-1)),n.bounce=t=>{for(let e=0,i=1;;e+=i,i/=2)if(t>=(7-4*e)/11){const r=(11-6*e-11*t)/4;return-r*r+i*i}}})(uc||(uc={}));(function(n){n.decorators={reverse(t){return e=>1-t(1-e)},reflect(t){return e=>.5*(e<.5?t(2*e):2-t(2-2*e))},clamp(t,e=0,i=1){return r=>{const o=t(r);return o<e?e:o>i?i:o}},back(t=1.70158){return e=>e*e*((t+1)*e-t)},elastic(t=1.5){return e=>Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}})(uc||(uc={}));(function(n){function t(B){return-1*Math.cos(B*(Math.PI/2))+1}n.easeInSine=t;function e(B){return Math.sin(B*(Math.PI/2))}n.easeOutSine=e;function i(B){return-.5*(Math.cos(Math.PI*B)-1)}n.easeInOutSine=i;function r(B){return B*B}n.easeInQuad=r;function o(B){return B*(2-B)}n.easeOutQuad=o;function s(B){return B<.5?2*B*B:-1+(4-2*B)*B}n.easeInOutQuad=s;function a(B){return B*B*B}n.easeInCubic=a;function l(B){const k=B-1;return k*k*k+1}n.easeOutCubic=l;function h(B){return B<.5?4*B*B*B:(B-1)*(2*B-2)*(2*B-2)+1}n.easeInOutCubic=h;function u(B){return B*B*B*B}n.easeInQuart=u;function d(B){const k=B-1;return 1-k*k*k*k}n.easeOutQuart=d;function c(B){const k=B-1;return B<.5?8*B*B*B*B:1-8*k*k*k*k}n.easeInOutQuart=c;function f(B){return B*B*B*B*B}n.easeInQuint=f;function g(B){const k=B-1;return 1+k*k*k*k*k}n.easeOutQuint=g;function p(B){const k=B-1;return B<.5?16*B*B*B*B*B:1+16*k*k*k*k*k}n.easeInOutQuint=p;function v(B){return B===0?0:Math.pow(2,10*(B-1))}n.easeInExpo=v;function m(B){return B===1?1:-Math.pow(2,-10*B)+1}n.easeOutExpo=m;function y(B){if(B===0||B===1)return B;const k=B*2,L=k-1;return k<1?.5*Math.pow(2,10*L):.5*(-Math.pow(2,-10*L)+2)}n.easeInOutExpo=y;function b(B){const k=B/1;return-1*(Math.sqrt(1-k*B)-1)}n.easeInCirc=b;function _(B){const k=B-1;return Math.sqrt(1-k*k)}n.easeOutCirc=_;function w(B){const k=B*2,L=k-2;return k<1?-.5*(Math.sqrt(1-k*k)-1):.5*(Math.sqrt(1-L*L)+1)}n.easeInOutCirc=w;function C(B,k=1.70158){return B*B*((k+1)*B-k)}n.easeInBack=C;function x(B,k=1.70158){const L=B/1-1;return L*L*((k+1)*L+k)+1}n.easeOutBack=x;function S(B,k=1.70158){const L=B*2,O=L-2,D=k*1.525;return L<1?.5*L*L*((D+1)*L-D):.5*(O*O*((D+1)*O+D)+2)}n.easeInOutBack=S;function A(B,k=.7){if(B===0||B===1)return B;const O=B/1-1,D=1-k,I=D/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*O)*Math.sin((O-I)*(2*Math.PI)/D))}n.easeInElastic=A;function T(B,k=.7){const L=1-k,O=B*2;if(B===0||B===1)return B;const D=L/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*O)*Math.sin((O-D)*(2*Math.PI)/L)+1}n.easeOutElastic=T;function M(B,k=.65){const L=1-k;if(B===0||B===1)return B;const O=B*2,D=O-1,I=L/(2*Math.PI)*Math.asin(1);return O<1?-.5*(Math.pow(2,10*D)*Math.sin((D-I)*(2*Math.PI)/L)):Math.pow(2,-10*D)*Math.sin((D-I)*(2*Math.PI)/L)*.5+1}n.easeInOutElastic=M;function R(B){const k=B/1;if(k<1/2.75)return 7.5625*k*k;if(k<2/2.75){const L=k-.5454545454545454;return 7.5625*L*L+.75}if(k<2.5/2.75){const L=k-.8181818181818182;return 7.5625*L*L+.9375}{const L=k-.9545454545454546;return 7.5625*L*L+.984375}}n.easeOutBounce=R;function E(B){return 1-R(1-B)}n.easeInBounce=E;function P(B){return B<.5?E(B*2)*.5:R(B*2-1)*.5+.5}n.easeInOutBounce=P})(uc||(uc={}));var Sd;(function(n){n.number=(t,e)=>{const i=e-t;return r=>t+i*r},n.object=(t,e)=>{const i=Object.keys(t);return r=>{const o={};for(let s=i.length-1;s!==-1;s-=1){const a=i[s];o[a]=t[a]+(e[a]-t[a])*r}return o}},n.unit=(t,e)=>{const i=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=i.exec(t),o=i.exec(e),s=o?o[1]:"",a=r?+r[1]:0,l=o?+o[1]:0,h=s.indexOf("."),u=h>0?s[1].length-h-1:0,d=l-a,c=r?r[2]:"";return f=>(a+d*f).toFixed(u)+c},n.color=(t,e)=>{const i=parseInt(t.slice(1),16),r=parseInt(e.slice(1),16),o=i&255,s=(r&255)-o,a=i&65280,l=(r&65280)-a,h=i&16711680,u=(r&16711680)-h;return d=>{const c=o+s*d&255,f=a+l*d&65280,g=h+u*d&16711680;return`#${(1<<24|c|f|g).toString(16).slice(1)}`}}})(Sd||(Sd={}));const b0=[];function Lpt(n,t){const e=b0.find(i=>i.name===n);if(!(e&&(e.loadTimes+=1,e.loadTimes>1))&&!qh.isApplyingHMR()){const i=document.createElement("style");i.setAttribute("type","text/css"),i.textContent=t;const r=document.querySelector("head");r&&r.insertBefore(i,r.firstChild),b0.push({name:n,loadTimes:1,styleElement:i})}}function Opt(n){const t=b0.findIndex(e=>e.name===n);if(t>-1){const e=b0[t];if(e.loadTimes-=1,e.loadTimes>0)return;let i=e.styleElement;i&&i.parentNode&&i.parentNode.removeChild(i),i=null,b0.splice(t,1)}}var vi;(function(n){function t(i){return 180*i/Math.PI%360}n.toDeg=t,n.toRad=function(i,r=!1){return(r?i:i%360)*Math.PI/180};function e(i){return i%360+(i<0?360:0)}n.normalize=e})(vi||(vi={}));var pi;(function(n){function t(a,l=0){return Number.isInteger(a)?a:+a.toFixed(l)}n.round=t;function e(a,l){let h,u;if(l==null?(u=a??1,h=0):(u=l,h=a??0),u<h){const d=h;h=u,u=d}return Math.floor(Math.random()*(u-h+1)+h)}n.random=e;function i(a,l,h){return Number.isNaN(a)?NaN:Number.isNaN(l)||Number.isNaN(h)?0:l<h?a<l?l:a>h?h:a:a<h?h:a>l?l:a}n.clamp=i;function r(a,l){return l*Math.round(a/l)}n.snapToGrid=r;function o(a,l){return l!=null&&a!=null&&l.x>=a.x&&l.x<=a.x+a.width&&l.y>=a.y&&l.y<=a.y+a.height}n.containsPoint=o;function s(a,l){const h=a.x-l.x,u=a.y-l.y;return h*h+u*u}n.squaredLength=s})(pi||(pi={}));class cu{valueOf(){return this.toJSON()}toString(){return JSON.stringify(this.toJSON())}}let tt=class Ze extends cu{constructor(t,e){super(),this.x=t??0,this.y=e??0}round(t=0){return this.x=pi.round(this.x,t),this.y=pi.round(this.y,t),this}add(t,e){const i=Ze.create(t,e);return this.x+=i.x,this.y+=i.y,this}update(t,e){const i=Ze.create(t,e);return this.x=i.x,this.y=i.y,this}translate(t,e){const i=Ze.create(t,e);return this.x+=i.x,this.y+=i.y,this}rotate(t,e){const i=Ze.rotate(this,t,e);return this.x=i.x,this.y=i.y,this}scale(t,e,i=new Ze){const r=Ze.create(i);return this.x=r.x+t*(this.x-r.x),this.y=r.y+e*(this.y-r.y),this}closest(t){if(t.length===1)return Ze.create(t[0]);let e=null,i=1/0;return t.forEach(r=>{const o=this.squaredDistance(r);o<i&&(e=r,i=o)}),e?Ze.create(e):null}distance(t){return Math.sqrt(this.squaredDistance(t))}squaredDistance(t){const e=Ze.create(t),i=this.x-e.x,r=this.y-e.y;return i*i+r*r}manhattanDistance(t){const e=Ze.create(t);return Math.abs(e.x-this.x)+Math.abs(e.y-this.y)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}theta(t=new Ze){const e=Ze.create(t),i=-(e.y-this.y),r=e.x-this.x;let o=Math.atan2(i,r);return o<0&&(o=2*Math.PI+o),180*o/Math.PI}angleBetween(t,e){if(this.equals(t)||this.equals(e))return NaN;let i=this.theta(e)-this.theta(t);return i<0&&(i+=360),i}vectorAngle(t){return new Ze(0,0).angleBetween(this,t)}toPolar(t){return this.update(Ze.toPolar(this,t)),this}changeInAngle(t,e,i=new Ze){return this.clone().translate(-t,-e).theta(i)-this.theta(i)}adhereToRect(t){return pi.containsPoint(t,this)||(this.x=Math.min(Math.max(this.x,t.x),t.x+t.width),this.y=Math.min(Math.max(this.y,t.y),t.y+t.height)),this}bearing(t){const e=Ze.create(t),i=vi.toRad(this.y),r=vi.toRad(e.y),o=this.x,s=e.x,a=vi.toRad(s-o),l=Math.sin(a)*Math.cos(r),h=Math.cos(i)*Math.sin(r)-Math.sin(i)*Math.cos(r)*Math.cos(a),u=vi.toDeg(Math.atan2(l,h)),d=["NE","E","SE","S","SW","W","NW","N"];let c=u-22.5;return c<0&&(c+=360),c=parseInt(c/45,10),d[c]}cross(t,e){if(t!=null&&e!=null){const i=Ze.create(t),r=Ze.create(e);return(r.x-this.x)*(i.y-this.y)-(r.y-this.y)*(i.x-this.x)}return NaN}dot(t){const e=Ze.create(t);return this.x*e.x+this.y*e.y}diff(t,e){if(typeof t=="number")return new Ze(this.x-t,this.y-e);const i=Ze.create(t);return new Ze(this.x-i.x,this.y-i.y)}lerp(t,e){const i=Ze.create(t);return new Ze((1-e)*this.x+e*i.x,(1-e)*this.y+e*i.y)}normalize(t=1){const e=t/this.magnitude();return this.scale(e,e)}move(t,e){const i=Ze.create(t),r=vi.toRad(i.theta(this));return this.translate(Math.cos(r)*e,-Math.sin(r)*e)}reflection(t){return Ze.create(t).move(this,this.distance(t))}snapToGrid(t,e){return this.x=pi.snapToGrid(this.x,t),this.y=pi.snapToGrid(this.y,e??t),this}equals(t){const e=Ze.create(t);return e!=null&&e.x===this.x&&e.y===this.y}clone(){return Ze.clone(this)}toJSON(){return Ze.toJSON(this)}serialize(){return`${this.x} ${this.y}`}};(function(n){function t(e){return e!=null&&e instanceof n}n.isPoint=t})(tt||(tt={}));(function(n){function t(i){return i!=null&&typeof i=="object"&&typeof i.x=="number"&&typeof i.y=="number"}n.isPointLike=t;function e(i){return i!=null&&Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"}n.isPointData=e})(tt||(tt={}));(function(n){function t(d,c){return d==null||typeof d=="number"?new n(d,c):e(d)}n.create=t;function e(d){return n.isPoint(d)?new n(d.x,d.y):Array.isArray(d)?new n(d[0],d[1]):new n(d.x,d.y)}n.clone=e;function i(d){return n.isPoint(d)?{x:d.x,y:d.y}:Array.isArray(d)?{x:d[0],y:d[1]}:{x:d.x,y:d.y}}n.toJSON=i;function r(d,c,f=new n){let g=Math.abs(d*Math.cos(c)),p=Math.abs(d*Math.sin(c));const v=e(f),m=vi.normalize(vi.toDeg(c));return m<90?p=-p:m<180?(g=-g,p=-p):m<270&&(g=-g),new n(v.x+g,v.y+p)}n.fromPolar=r;function o(d,c=new n){const f=e(d),g=e(c),p=f.x-g.x,v=f.y-g.y;return new n(Math.sqrt(p*p+v*v),vi.toRad(g.theta(f)))}n.toPolar=o;function s(d,c){return d===c?!0:d!=null&&c!=null?d.x===c.x&&d.y===c.y:!1}n.equals=s;function a(d,c){if(d==null&&c!=null||d!=null&&c==null||d!=null&&c!=null&&d.length!==c.length)return!1;if(d!=null&&c!=null){for(let f=0,g=d.length;f<g;f+=1)if(!s(d[f],c[f]))return!1}return!0}n.equalPoints=a;function l(d,c,f,g){return new n(pi.random(d,c),pi.random(f,g))}n.random=l;function h(d,c,f){const g=vi.toRad(vi.normalize(-c)),p=Math.sin(g),v=Math.cos(g);return u(d,v,p,f)}n.rotate=h;function u(d,c,f,g=new n){const p=e(d),v=e(g),m=p.x-v.x,y=p.y-v.y,b=m*c-y*f,_=y*c+m*f;return new n(b+v.x,_+v.y)}n.rotateEx=u})(tt||(tt={}));class Ct extends cu{get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get origin(){return new tt(this.x,this.y)}get topLeft(){return new tt(this.x,this.y)}get topCenter(){return new tt(this.x+this.width/2,this.y)}get topRight(){return new tt(this.x+this.width,this.y)}get center(){return new tt(this.x+this.width/2,this.y+this.height/2)}get bottomLeft(){return new tt(this.x,this.y+this.height)}get bottomCenter(){return new tt(this.x+this.width/2,this.y+this.height)}get bottomRight(){return new tt(this.x+this.width,this.y+this.height)}get corner(){return new tt(this.x+this.width,this.y+this.height)}get rightMiddle(){return new tt(this.x+this.width,this.y+this.height/2)}get leftMiddle(){return new tt(this.x,this.y+this.height/2)}get topLine(){return new It(this.topLeft,this.topRight)}get rightLine(){return new It(this.topRight,this.bottomRight)}get bottomLine(){return new It(this.bottomLeft,this.bottomRight)}get leftLine(){return new It(this.topLeft,this.bottomLeft)}constructor(t,e,i,r){super(),this.x=t??0,this.y=e??0,this.width=i??0,this.height=r??0}getOrigin(){return this.origin}getTopLeft(){return this.topLeft}getTopCenter(){return this.topCenter}getTopRight(){return this.topRight}getCenter(){return this.center}getCenterX(){return this.x+this.width/2}getCenterY(){return this.y+this.height/2}getBottomLeft(){return this.bottomLeft}getBottomCenter(){return this.bottomCenter}getBottomRight(){return this.bottomRight}getCorner(){return this.corner}getRightMiddle(){return this.rightMiddle}getLeftMiddle(){return this.leftMiddle}getTopLine(){return this.topLine}getRightLine(){return this.rightLine}getBottomLine(){return this.bottomLine}getLeftLine(){return this.leftLine}bbox(t){if(!t)return this.clone();const e=vi.toRad(t),i=Math.abs(Math.sin(e)),r=Math.abs(Math.cos(e)),o=this.width*r+this.height*i,s=this.width*i+this.height*r;return new Ct(this.x+(this.width-o)/2,this.y+(this.height-s)/2,o,s)}round(t=0){return this.x=pi.round(this.x,t),this.y=pi.round(this.y,t),this.width=pi.round(this.width,t),this.height=pi.round(this.height,t),this}add(t,e,i,r){const o=Ct.create(t,e,i,r),s=Math.min(this.x,o.x),a=Math.min(this.y,o.y),l=Math.max(this.x+this.width,o.x+o.width),h=Math.max(this.y+this.height,o.y+o.height);return this.x=s,this.y=a,this.width=l-s,this.height=h-a,this}update(t,e,i,r){const o=Ct.create(t,e,i,r);return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this}inflate(t,e){const i=t,r=e??t;return this.x-=i,this.y-=r,this.width+=2*i,this.height+=2*r,this}snapToGrid(t,e){const i=this.origin.snapToGrid(t,e),r=this.corner.snapToGrid(t,e);return this.x=i.x,this.y=i.y,this.width=r.x-i.x,this.height=r.y-i.y,this}translate(t,e){const i=tt.create(t,e);return this.x+=i.x,this.y+=i.y,this}scale(t,e,i=new tt){const r=this.origin.scale(t,e,i);return this.x=r.x,this.y=r.y,this.width*=t,this.height*=e,this}rotate(t,e=this.getCenter()){if(t!==0){const i=vi.toRad(t),r=Math.cos(i),o=Math.sin(i);let s=this.getOrigin(),a=this.getTopRight(),l=this.getBottomRight(),h=this.getBottomLeft();s=tt.rotateEx(s,r,o,e),a=tt.rotateEx(a,r,o,e),l=tt.rotateEx(l,r,o,e),h=tt.rotateEx(h,r,o,e);const u=new Ct(s.x,s.y,0,0);u.add(a.x,a.y,0,0),u.add(l.x,l.y,0,0),u.add(h.x,h.y,0,0),this.update(u)}return this}rotate90(){const t=(this.width-this.height)/2;this.x+=t,this.y-=t;const e=this.width;return this.width=this.height,this.height=e,this}moveAndExpand(t){const e=Ct.clone(t);return this.x+=e.x||0,this.y+=e.y||0,this.width+=e.width||0,this.height+=e.height||0,this}getMaxScaleToFit(t,e=this.center){const i=Ct.clone(t),r=e.x,o=e.y;let s=1/0,a=1/0,l=1/0,h=1/0,u=1/0,d=1/0,c=1/0,f=1/0;const g=i.topLeft;g.x<r&&(s=(this.x-r)/(g.x-r)),g.y<o&&(u=(this.y-o)/(g.y-o));const p=i.bottomRight;p.x>r&&(a=(this.x+this.width-r)/(p.x-r)),p.y>o&&(d=(this.y+this.height-o)/(p.y-o));const v=i.topRight;v.x>r&&(l=(this.x+this.width-r)/(v.x-r)),v.y<o&&(c=(this.y-o)/(v.y-o));const m=i.bottomLeft;return m.x<r&&(h=(this.x-r)/(m.x-r)),m.y>o&&(f=(this.y+this.height-o)/(m.y-o)),{sx:Math.min(s,a,l,h),sy:Math.min(u,d,c,f)}}getMaxUniformScaleToFit(t,e=this.center){const i=this.getMaxScaleToFit(t,e);return Math.min(i.sx,i.sy)}containsPoint(t,e){return pi.containsPoint(this,tt.create(t,e))}containsRect(t,e,i,r){const o=Ct.create(t,e,i,r),s=this.x,a=this.y,l=this.width,h=this.height,u=o.x,d=o.y,c=o.width,f=o.height;return l===0||h===0||c===0||f===0?!1:u>=s&&d>=a&&u+c<=s+l&&d+f<=a+h}intersectsWithLine(t){const e=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],i=[],r=[];return e.forEach(o=>{const s=t.intersectsWithLine(o);s!==null&&r.indexOf(s.toString())<0&&(i.push(s),r.push(s.toString()))}),i.length>0?i:null}intersectsWithLineFromCenterToPoint(t,e){const i=tt.clone(t),r=this.center;let o=null;e!=null&&e!==0&&i.rotate(e,r);const s=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],a=new It(r,i);for(let l=s.length-1;l>=0;l-=1){const h=s[l].intersectsWithLine(a);if(h!==null){o=h;break}}return o&&e!=null&&e!==0&&o.rotate(-e,r),o}intersectsWithRect(t,e,i,r){const o=Ct.create(t,e,i,r);if(!this.isIntersectWithRect(o))return null;const s=this.origin,a=this.corner,l=o.origin,h=o.corner,u=Math.max(s.x,l.x),d=Math.max(s.y,l.y);return new Ct(u,d,Math.min(a.x,h.x)-u,Math.min(a.y,h.y)-d)}isIntersectWithRect(t,e,i,r){const o=Ct.create(t,e,i,r),s=this.origin,a=this.corner,l=o.origin,h=o.corner;return!(h.x<=s.x||h.y<=s.y||l.x>=a.x||l.y>=a.y)}normalize(){let t=this.x,e=this.y,i=this.width,r=this.height;return this.width<0&&(t=this.x+this.width,i=-this.width),this.height<0&&(e=this.y+this.height,r=-this.height),this.x=t,this.y=e,this.width=i,this.height=r,this}union(t){const e=Ct.clone(t),i=this.origin,r=this.corner,o=e.origin,s=e.corner,a=Math.min(i.x,o.x),l=Math.min(i.y,o.y),h=Math.max(r.x,s.x),u=Math.max(r.y,s.y);return new Ct(a,l,h-a,u-l)}getNearestSideToPoint(t){const e=tt.clone(t),i=e.x-this.x,r=this.x+this.width-e.x,o=e.y-this.y,s=this.y+this.height-e.y;let a=i,l="left";return r<a&&(a=r,l="right"),o<a&&(a=o,l="top"),s<a&&(l="bottom"),l}getNearestPointToPoint(t){const e=tt.clone(t);if(this.containsPoint(e)){const i=this.getNearestSideToPoint(e);if(i==="left")return new tt(this.x,e.y);if(i==="top")return new tt(e.x,this.y);if(i==="right")return new tt(this.x+this.width,e.y);if(i==="bottom")return new tt(e.x,this.y+this.height)}return e.adhereToRect(this)}equals(t){return t!=null&&t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height}clone(){return new Ct(this.x,this.y,this.width,this.height)}toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height}}serialize(){return`${this.x} ${this.y} ${this.width} ${this.height}`}}(function(n){function t(e){return e!=null&&e instanceof n}n.isRectangle=t})(Ct||(Ct={}));(function(n){function t(e){return e!=null&&typeof e=="object"&&typeof e.x=="number"&&typeof e.y=="number"&&typeof e.width=="number"&&typeof e.height=="number"}n.isRectangleLike=t})(Ct||(Ct={}));(function(n){function t(s,a,l,h){return s==null||typeof s=="number"?new n(s,a,l,h):e(s)}n.create=t;function e(s){return n.isRectangle(s)?s.clone():Array.isArray(s)?new n(s[0],s[1],s[2],s[3]):new n(s.x,s.y,s.width,s.height)}n.clone=e;function i(s){return new n(s.x-s.a,s.y-s.b,2*s.a,2*s.b)}n.fromEllipse=i;function r(s){return new n(0,0,s.width,s.height)}n.fromSize=r;function o(s,a){return new n(s.x,s.y,a.width,a.height)}n.fromPositionAndSize=o})(Ct||(Ct={}));let It=class Ts extends cu{get center(){return new tt((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}constructor(t,e,i,r){super(),typeof t=="number"&&typeof e=="number"?(this.start=new tt(t,e),this.end=new tt(i,r)):(this.start=tt.create(t),this.end=tt.create(e))}getCenter(){return this.center}round(t=0){return this.start.round(t),this.end.round(t),this}translate(t,e){return typeof t=="number"?(this.start.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.end.translate(t)),this}rotate(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this}scale(t,e,i){return this.start.scale(t,e,i),this.end.scale(t,e,i),this}length(){return Math.sqrt(this.squaredLength())}squaredLength(){const t=this.start.x-this.end.x,e=this.start.y-this.end.y;return t*t+e*e}setLength(t){const e=this.length();if(!e)return this;const i=t/e;return this.scale(i,i,this.start)}parallel(t){const e=this.clone();if(!e.isDifferentiable())return e;const{start:i,end:r}=e,o=i.clone().rotate(270,r),s=r.clone().rotate(90,i);return i.move(s,t),r.move(o,t),e}vector(){return new tt(this.end.x-this.start.x,this.end.y-this.start.y)}angle(){const t=new tt(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)}bbox(){const t=Math.min(this.start.x,this.end.x),e=Math.min(this.start.y,this.end.y),i=Math.max(this.start.x,this.end.x),r=Math.max(this.start.y,this.end.y);return new Ct(t,e,i-t,r-e)}bearing(){return this.start.bearing(this.end)}closestPoint(t){return this.pointAt(this.closestPointNormalizedLength(t))}closestPointLength(t){return this.closestPointNormalizedLength(t)*this.length()}closestPointTangent(t){return this.tangentAt(this.closestPointNormalizedLength(t))}closestPointNormalizedLength(t){const e=this.vector().dot(new Ts(this.start,t).vector()),i=Math.min(1,Math.max(0,e/this.squaredLength()));return Number.isNaN(i)?0:i}pointAt(t){const e=this.start,i=this.end;return t<=0?e.clone():t>=1?i.clone():e.lerp(i,t)}pointAtLength(t){const e=this.start,i=this.end;let r=!0;t<0&&(r=!1,t=-t);const o=this.length();if(t>=o)return r?i.clone():e.clone();const s=(r?t:o-t)/o;return this.pointAt(s)}divideAt(t){const e=this.pointAt(t);return[new Ts(this.start,e),new Ts(e,this.end)]}divideAtLength(t){const e=this.pointAtLength(t);return[new Ts(this.start,e),new Ts(e,this.end)]}containsPoint(t){const e=this.start,i=this.end;if(e.cross(t,i)!==0)return!1;const r=this.length();return!(new Ts(e,t).length()>r||new Ts(t,i).length()>r)}intersect(t,e){const i=t.intersectsWithLine(this,e);return i?Array.isArray(i)?i:[i]:null}intersectsWithLine(t){const e=new tt(this.end.x-this.start.x,this.end.y-this.start.y),i=new tt(t.end.x-t.start.x,t.end.y-t.start.y),r=e.x*i.y-e.y*i.x,o=new tt(t.start.x-this.start.x,t.start.y-this.start.y),s=o.x*i.y-o.y*i.x,a=o.x*e.y-o.y*e.x;if(r===0||s*r<0||a*r<0)return null;if(r>0){if(s>r||a>r)return null}else if(s<r||a<r)return null;return new tt(this.start.x+s*e.x/r,this.start.y+s*e.y/r)}isDifferentiable(){return!this.start.equals(this.end)}pointOffset(t){const e=tt.clone(t),i=this.start,r=this.end;return((r.x-i.x)*(e.y-i.y)-(r.y-i.y)*(e.x-i.x))/this.length()}pointSquaredDistance(t,e){const i=tt.create(t,e);return this.closestPoint(i).squaredDistance(i)}pointDistance(t,e){const i=tt.create(t,e);return this.closestPoint(i).distance(i)}tangentAt(t){if(!this.isDifferentiable())return null;const e=this.start,i=this.end,r=this.pointAt(t),o=new Ts(e,i);return o.translate(r.x-e.x,r.y-e.y),o}tangentAtLength(t){if(!this.isDifferentiable())return null;const e=this.start,i=this.end,r=this.pointAtLength(t),o=new Ts(e,i);return o.translate(r.x-e.x,r.y-e.y),o}relativeCcw(t,e){const i=tt.create(t,e);let r=i.x-this.start.x,o=i.y-this.start.y;const s=this.end.x-this.start.x,a=this.end.y-this.start.y;let l=r*a-o*s;return l===0&&(l=r*s+o*a,l>0&&(r-=s,o-=a,l=r*s+o*a,l<0&&(l=0))),l<0?-1:l>0?1:0}equals(t){return t!=null&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y}clone(){return new Ts(this.start,this.end)}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.end.serialize()].join(" ")}};(function(n){function t(e){return e!=null&&e instanceof n}n.isLine=t})(It||(It={}));class Ys extends cu{get center(){return new tt(this.x,this.y)}constructor(t,e,i,r){super(),this.x=t??0,this.y=e??0,this.a=i??0,this.b=r??0}bbox(){return Ct.fromEllipse(this)}getCenter(){return this.center}inflate(t,e){const i=t,r=e??t;return this.a+=2*i,this.b+=2*r,this}normalizedDistance(t,e){const i=tt.create(t,e),r=i.x-this.x,o=i.y-this.y,s=this.a,a=this.b;return r*r/(s*s)+o*o/(a*a)}containsPoint(t,e){return this.normalizedDistance(t,e)<=1}intersectsWithLine(t){const e=[],i=this.a,r=this.b,o=t.start,s=t.end,a=t.vector(),l=o.diff(new tt(this.x,this.y)),h=new tt(a.x/(i*i),a.y/(r*r)),u=new tt(l.x/(i*i),l.y/(r*r)),d=a.dot(h),c=a.dot(u),f=l.dot(u)-1,g=c*c-d*f;if(g<0)return null;if(g>0){const p=Math.sqrt(g),v=(-c-p)/d,m=(-c+p)/d;if((v<0||v>1)&&(m<0||m>1))return null;v>=0&&v<=1&&e.push(o.lerp(s,v)),m>=0&&m<=1&&e.push(o.lerp(s,m))}else{const p=-c/d;if(p>=0&&p<=1)e.push(o.lerp(s,p));else return null}return e}intersectsWithLineFromCenterToPoint(t,e=0){const i=tt.clone(t);e&&i.rotate(e,this.getCenter());const r=i.x-this.x,o=i.y-this.y;let s;if(r===0)return s=this.bbox().getNearestPointToPoint(i),e?s.rotate(-e,this.getCenter()):s;const a=o/r,l=a*a,h=this.a*this.a,u=this.b*this.b;let d=Math.sqrt(1/(1/h+l/u));d=r<0?-d:d;const c=a*d;return s=new tt(this.x+d,this.y+c),e?s.rotate(-e,this.getCenter()):s}tangentTheta(t){const e=tt.clone(t),i=e.x,r=e.y,o=this.a,s=this.b,a=this.bbox().center,l=a.x,h=a.y,u=30,d=i>a.x+o/2,c=i<a.x-o/2;let f,g;return d||c?(g=i>a.x?r-u:r+u,f=o*o/(i-l)-o*o*(r-h)*(g-h)/(s*s*(i-l))+l):(f=r>a.y?i+u:i-u,g=s*s/(r-h)-s*s*(i-l)*(f-l)/(o*o*(r-h))+h),new tt(f,g).theta(e)}scale(t,e){return this.a*=t,this.b*=e,this}rotate(t,e){const i=Ct.fromEllipse(this);i.rotate(t,e);const r=Ys.fromRect(i);return this.a=r.a,this.b=r.b,this.x=r.x,this.y=r.y,this}translate(t,e){const i=tt.create(t,e);return this.x+=i.x,this.y+=i.y,this}equals(t){return t!=null&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b}clone(){return new Ys(this.x,this.y,this.a,this.b)}toJSON(){return{x:this.x,y:this.y,a:this.a,b:this.b}}serialize(){return`${this.x} ${this.y} ${this.a} ${this.b}`}}(function(n){function t(e){return e!=null&&e instanceof n}n.isEllipse=t})(Ys||(Ys={}));(function(n){function t(r,o,s,a){return r==null||typeof r=="number"?new n(r,o,s,a):e(r)}n.create=t;function e(r){return n.isEllipse(r)?r.clone():Array.isArray(r)?new n(r[0],r[1],r[2],r[3]):new n(r.x,r.y,r.a,r.b)}n.parse=e;function i(r){const o=r.center;return new n(o.x,o.y,r.width/2,r.height/2)}n.fromRect=i})(Ys||(Ys={}));const Dpt=new RegExp("^[\\s\\dLMCZz,.]*$");function Ipt(n){return typeof n!="string"?!1:Dpt.test(n)}function rR(n,t){return(n%t+t)%t}function Hpt(n,t,e,i,r){const o=[],s=n[n.length-1],a=t!=null&&t>0,l=t||0;if(i&&a){n=n.slice();const d=n[0],c=new tt(s.x+(d.x-s.x)/2,s.y+(d.y-s.y)/2);n.splice(0,0,c)}let h=n[0],u=1;for(e?o.push("M",h.x,h.y):o.push("L",h.x,h.y);u<(i?n.length:n.length-1);){let d=n[rR(u,n.length)],c=h.x-d.x,f=h.y-d.y;if(a&&(c!==0||f!==0)&&(r==null||r.indexOf(u-1)<0)){let g=Math.sqrt(c*c+f*f);const p=c*Math.min(l,g/2)/g,v=f*Math.min(l,g/2)/g,m=d.x+p,y=d.y+v;o.push("L",m,y);let b=n[rR(u+1,n.length)];for(;u<n.length-2&&Math.round(b.x-d.x)===0&&Math.round(b.y-d.y)===0;)b=n[rR(u+2,n.length)],u+=1;c=b.x-d.x,f=b.y-d.y,g=Math.max(1,Math.sqrt(c*c+f*f));const _=c*Math.min(l,g/2)/g,w=f*Math.min(l,g/2)/g,C=d.x+_,x=d.y+w;o.push("Q",d.x,d.y,C,x),d=new tt(C,x)}else o.push("L",d.x,d.y);h=d,u+=1}return i?o.push("Z"):o.push("L",s.x,s.y),o.map(d=>typeof d=="string"?d:+d.toFixed(3)).join(" ")}function zU(n,t={}){const e=[];return n&&n.length&&n.forEach(i=>{Array.isArray(i)?e.push({x:i[0],y:i[1]}):e.push({x:i.x,y:i.y})}),Hpt(e,t.round,t.initialMove==null||t.initialMove,t.close,t.exclude)}function Cw(n,t,e,i,r=0,o=0,s=0,a,l){if(e===0||i===0)return[];a-=n,l-=t,e=Math.abs(e),i=Math.abs(i);const h=-a/2,u=-l/2,d=Math.cos(r*Math.PI/180),c=Math.sin(r*Math.PI/180),f=d*h+c*u,g=-1*c*h+d*u,p=f*f,v=g*g,m=e*e,y=i*i,b=p/m+v/y;let _;if(b>1)e=Math.sqrt(b)*e,i=Math.sqrt(b)*i,_=0;else{let J=1;o===s&&(J=-1),_=J*Math.sqrt((m*y-m*v-y*p)/(m*v+y*p))}const w=_*e*g/i,C=-1*_*i*f/e,x=d*w-c*C+a/2,S=c*w+d*C+l/2;let A=Math.atan2((g-C)/i,(f-w)/e)-Math.atan2(0,1),T=A>=0?A:2*Math.PI+A;A=Math.atan2((-g-C)/i,(-f-w)/e)-Math.atan2((g-C)/i,(f-w)/e);let M=A>=0?A:2*Math.PI+A;s===0&&M>0?M-=2*Math.PI:s!==0&&M<0&&(M+=2*Math.PI);const R=M*2/Math.PI,E=Math.ceil(R<0?-1*R:R),P=M/E,B=8/3*Math.sin(P/4)*Math.sin(P/4)/Math.sin(P/2),k=d*e,L=d*i,O=c*e,D=c*i;let I=Math.cos(T),H=Math.sin(T),F=-B*(k*H+D*I),G=-B*(O*H-L*I),j=0,W=0;const K=[];for(let J=0;J<E;J+=1){T+=P,I=Math.cos(T),H=Math.sin(T),j=k*I-D*H+x,W=O*I+L*H+S;const q=-B*(k*H+D*I),X=-B*(O*H-L*I),it=J*6;K[it]=Number(F+n),K[it+1]=Number(G+t),K[it+2]=Number(j-q+n),K[it+3]=Number(W-X+t),K[it+4]=Number(j+n),K[it+5]=Number(W+t),F=j+q,G=W+X}return K.map(J=>+J.toFixed(2))}function Fpt(n,t,e,i,r=0,o=0,s=0,a,l){const h=[],u=Cw(n,t,e,i,r,o,s,a,l);if(u!=null)for(let d=0,c=u.length;d<c;d+=6)h.push("C",u[d],u[d+1],u[d+2],u[d+3],u[d+4],u[d+5]);return h.join(" ")}class gn extends cu{get start(){return this.points[0]||null}get end(){return this.points[this.points.length-1]||null}constructor(t){if(super(),t!=null){if(typeof t=="string")return gn.parse(t);this.points=t.map(e=>tt.create(e))}else this.points=[]}scale(t,e,i=new tt){return this.points.forEach(r=>r.scale(t,e,i)),this}rotate(t,e){return this.points.forEach(i=>i.rotate(t,e)),this}translate(t,e){const i=tt.create(t,e);return this.points.forEach(r=>r.translate(i.x,i.y)),this}round(t=0){return this.points.forEach(e=>e.round(t)),this}bbox(){if(this.points.length===0)return new Ct;let t=1/0,e=-1/0,i=1/0,r=-1/0;const o=this.points;for(let s=0,a=o.length;s<a;s+=1){const l=o[s],h=l.x,u=l.y;h<t&&(t=h),h>e&&(e=h),u<i&&(i=u),u>r&&(r=u)}return new Ct(t,i,e-t,r-i)}closestPoint(t){const e=this.closestPointLength(t);return this.pointAtLength(e)}closestPointLength(t){const e=this.points,i=e.length;if(i===0||i===1)return 0;let r=0,o=0,s=1/0;for(let a=0,l=i-1;a<l;a+=1){const h=new It(e[a],e[a+1]),u=h.length(),d=h.closestPointNormalizedLength(t),f=h.pointAt(d).squaredDistance(t);f<s&&(s=f,o=r+d*u),r+=u}return o}closestPointNormalizedLength(t){const e=this.length();return e===0?0:this.closestPointLength(t)/e}closestPointTangent(t){const e=this.closestPointLength(t);return this.tangentAtLength(e)}containsPoint(t){if(this.points.length===0)return!1;const e=tt.clone(t),i=e.x,r=e.y,o=this.points,s=o.length;let a=s-1,l=0;for(let h=0;h<s;h+=1){const u=o[a],d=o[h];if(e.equals(u))return!0;const c=new It(u,d);if(c.containsPoint(t))return!0;if(r<=u.y&&r>d.y||r>u.y&&r<=d.y){const f=u.x-i>d.x-i?u.x-i:d.x-i;if(f>=0){const g=new tt(i+f,r),p=new It(t,g);c.intersectsWithLine(p)&&(l+=1)}}a=h}return l%2===1}intersectsWithLine(t){const e=[];for(let i=0,r=this.points.length-1;i<r;i+=1){const o=this.points[i],s=this.points[i+1],a=t.intersectsWithLine(new It(o,s));a&&e.push(a)}return e.length>0?e:null}isDifferentiable(){for(let t=0,e=this.points.length-1;t<e;t+=1){const i=this.points[t],r=this.points[t+1];if(new It(i,r).isDifferentiable())return!0}return!1}length(){let t=0;for(let e=0,i=this.points.length-1;e<i;e+=1){const r=this.points[e],o=this.points[e+1];t+=r.distance(o)}return t}pointAt(t){const e=this.points,i=e.length;if(i===0)return null;if(i===1||t<=0)return e[0].clone();if(t>=1)return e[i-1].clone();const o=this.length()*t;return this.pointAtLength(o)}pointAtLength(t){const e=this.points,i=e.length;if(i===0)return null;if(i===1)return e[0].clone();let r=!0;t<0&&(r=!1,t=-t);let o=0;for(let a=0,l=i-1;a<l;a+=1){const h=r?a:l-1-a,u=e[h],d=e[h+1],c=new It(u,d),f=u.distance(d);if(t<=o+f)return c.pointAtLength((r?1:-1)*(t-o));o+=f}return(r?e[i-1]:e[0]).clone()}tangentAt(t){const i=this.points.length;if(i===0||i===1)return null;t<0&&(t=0),t>1&&(t=1);const o=this.length()*t;return this.tangentAtLength(o)}tangentAtLength(t){const e=this.points,i=e.length;if(i===0||i===1)return null;let r=!0;t<0&&(r=!1,t=-t);let o,s=0;for(let a=0,l=i-1;a<l;a+=1){const h=r?a:l-1-a,u=e[h],d=e[h+1],c=new It(u,d),f=u.distance(d);if(c.isDifferentiable()){if(t<=s+f)return c.tangentAtLength((r?1:-1)*(t-s));o=c}s+=f}if(o){const a=r?1:0;return o.tangentAt(a)}return null}simplify(t={}){const e=this.points;if(e.length<3)return this;const i=t.threshold||0;let r=0;for(;e[r+2];){const o=r,s=r+1,a=r+2,l=e[o],h=e[s],u=e[a];new It(l,u).closestPoint(h).distance(h)<=i?e.splice(s,1):r+=1}return this}toHull(){const t=this.points,e=t.length;if(e===0)return new gn;let i=t[0];for(let c=1;c<e;c+=1)(t[c].y<i.y||t[c].y===i.y&&t[c].x>i.x)&&(i=t[c]);const r=[];for(let c=0;c<e;c+=1){let f=i.theta(t[c]);f===0&&(f=360),r.push([t[c],c,f])}if(r.sort((c,f)=>{let g=c[2]-f[2];return g===0&&(g=f[1]-c[1]),g}),r.length>2){const c=r[r.length-1];r.unshift(c)}const o={},s=[],a=c=>`${c[0].toString()}@${c[1]}`;for(;r.length!==0;){const c=r.pop(),f=c[0];if(o[a(c)])continue;let g=!1;for(;!g;)if(s.length<2)s.push(c),g=!0;else{const p=s.pop(),v=p[0],m=s.pop(),y=m[0],b=y.cross(v,f);if(b<0)s.push(m),s.push(p),s.push(c),g=!0;else if(b===0){const w=v.angleBetween(y,f);Math.abs(w-180)<1e-10||v.equals(f)||y.equals(v)?(o[a(p)]=v,s.push(m)):Math.abs((w+1)%360-1)<1e-10&&(s.push(m),r.push(p))}else o[a(p)]=v,s.push(m)}}s.length>2&&s.pop();let l,h=-1;for(let c=0,f=s.length;c<f;c+=1){const g=s[c][1];(l===void 0||g<l)&&(l=g,h=c)}let u=[];if(h>0){const c=s.slice(h),f=s.slice(0,h);u=c.concat(f)}else u=s;const d=[];for(let c=0,f=u.length;c<f;c+=1)d.push(u[c][0]);return new gn(d)}equals(t){return t==null||t.points.length!==this.points.length?!1:t.points.every((e,i)=>e.equals(this.points[i]))}clone(){return new gn(this.points.map(t=>t.clone()))}toJSON(){return this.points.map(t=>t.toJSON())}serialize(){return this.points.map(t=>`${t.serialize()}`).join(" ")}}(function(n){function t(e){return e!=null&&e instanceof n}n.isPolyline=t})(gn||(gn={}));(function(n){function t(e){const i=e.trim();if(i==="")return new n;const r=[],o=i.split(/\s*,\s*|\s+/);for(let s=0,a=o.length;s<a;s+=2)r.push({x:+o[s],y:+o[s+1]});return new n(r)}n.parse=t})(gn||(gn={}));let Co=class gl extends cu{constructor(t,e,i,r){super(),this.PRECISION=3,this.start=tt.create(t),this.controlPoint1=tt.create(e),this.controlPoint2=tt.create(i),this.end=tt.create(r)}bbox(){const t=this.start,e=this.controlPoint1,i=this.controlPoint2,r=this.end,o=t.x,s=t.y,a=e.x,l=e.y,h=i.x,u=i.y,d=r.x,c=r.y,f=[],g=[[],[]];let p,v,m,y,b,_,w,C;for(let k=0;k<2;k+=1){if(k===0?(v=6*o-12*a+6*h,p=-3*o+9*a-9*h+3*d,m=3*a-3*o):(v=6*s-12*l+6*u,p=-3*s+9*l-9*u+3*c,m=3*l-3*s),Math.abs(p)<1e-12){if(Math.abs(v)<1e-12)continue;y=-m/v,y>0&&y<1&&f.push(y);continue}w=v*v-4*m*p,C=Math.sqrt(w),!(w<0)&&(b=(-v+C)/(2*p),b>0&&b<1&&f.push(b),_=(-v-C)/(2*p),_>0&&_<1&&f.push(_))}let x,S,A,T=f.length;const M=T;for(;T;)T-=1,y=f[T],A=1-y,x=A*A*A*o+3*A*A*y*a+3*A*y*y*h+y*y*y*d,g[0][T]=x,S=A*A*A*s+3*A*A*y*l+3*A*y*y*u+y*y*y*c,g[1][T]=S;f[M]=0,f[M+1]=1,g[0][M]=o,g[1][M]=s,g[0][M+1]=d,g[1][M+1]=c,f.length=M+2,g[0].length=M+2,g[1].length=M+2;const R=Math.min.apply(null,g[0]),E=Math.min.apply(null,g[1]),P=Math.max.apply(null,g[0]),B=Math.max.apply(null,g[1]);return new Ct(R,E,P-R,B-E)}closestPoint(t,e={}){return this.pointAtT(this.closestPointT(t,e))}closestPointLength(t,e={}){const i=this.getOptions(e);return this.lengthAtT(this.closestPointT(t,i),i)}closestPointNormalizedLength(t,e={}){const i=this.getOptions(e),r=this.closestPointLength(t,i);if(!r)return 0;const o=this.length(i);return o===0?0:r/o}closestPointT(t,e={}){const i=this.getPrecision(e),r=this.getDivisions(e),o=Math.pow(10,-i);let s=null,a=0,l=0,h=0,u=0,d=0,c=null;const f=r.length;let g=f>0?1/f:0;for(r.forEach((p,v)=>{const m=p.start.distance(t),y=p.end.distance(t),b=m+y;(c==null||b<c)&&(s=p,a=v*g,l=(v+1)*g,h=m,u=y,c=b,d=p.endpointDistance())});;){const p=h?Math.abs(h-u)/h:0,v=u!=null?Math.abs(h-u)/u:0,m=p<o||v<o,y=h?h<d*o:!0,b=u?u<d*o:!0;if(m||(y||b))return h<=u?a:l;const w=s.divide(.5);g/=2;const C=w[0].start.distance(t),x=w[0].end.distance(t),S=C+x,A=w[1].start.distance(t),T=w[1].end.distance(t),M=A+T;S<=M?(s=w[0],l-=g,h=C,u=x):(s=w[1],a+=g,h=A,u=T)}}closestPointTangent(t,e={}){return this.tangentAtT(this.closestPointT(t,e))}containsPoint(t,e={}){return this.toPolyline(e).containsPoint(t)}divideAt(t,e={}){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);const i=this.tAt(t,e);return this.divideAtT(i)}divideAtLength(t,e={}){const i=this.tAtLength(t,e);return this.divideAtT(i)}divide(t){return this.divideAtT(t)}divideAtT(t){const e=this.start,i=this.controlPoint1,r=this.controlPoint2,o=this.end;if(t<=0)return[new gl(e,e,e,e),new gl(e,i,r,o)];if(t>=1)return[new gl(e,i,r,o),new gl(o,o,o,o)];const s=this.getSkeletonPoints(t),a=s.startControlPoint1,l=s.startControlPoint2,h=s.divider,u=s.dividerControlPoint1,d=s.dividerControlPoint2;return[new gl(e,a,l,h),new gl(h,u,d,o)]}endpointDistance(){return this.start.distance(this.end)}getSkeletonPoints(t){const e=this.start,i=this.controlPoint1,r=this.controlPoint2,o=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:r.clone()};if(t>=1)return{startControlPoint1:i.clone(),startControlPoint2:r.clone(),divider:o.clone(),dividerControlPoint1:o.clone(),dividerControlPoint2:o.clone()};const s=new It(e,i).pointAt(t),a=new It(i,r).pointAt(t),l=new It(r,o).pointAt(t),h=new It(s,a).pointAt(t),u=new It(a,l).pointAt(t),d=new It(h,u).pointAt(t);return{startControlPoint1:s,startControlPoint2:h,divider:d,dividerControlPoint1:u,dividerControlPoint2:l}}getSubdivisions(t={}){const e=this.getPrecision(t);let i=[new gl(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(e===0)return i;let r=this.endpointDistance();const o=Math.pow(10,-e);let s=0;for(;;){s+=1;const a=[];i.forEach(u=>{const d=u.divide(.5);a.push(d[0],d[1])});const l=a.reduce((u,d)=>u+d.endpointDistance(),0),h=l!==0?(l-r)/l:0;if(s>1&&h<o)return a;i=a,r=l}}length(t={}){return this.getDivisions(t).reduce((i,r)=>i+r.endpointDistance(),0)}lengthAtT(t,e={}){if(t<=0)return 0;const i=e.precision===void 0?this.PRECISION:e.precision;return this.divide(t)[0].length({precision:i})}pointAt(t,e={}){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const i=this.tAt(t,e);return this.pointAtT(i)}pointAtLength(t,e={}){const i=this.tAtLength(t,e);return this.pointAtT(i)}pointAtT(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider}isDifferentiable(){const t=this.start,e=this.controlPoint1,i=this.controlPoint2,r=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(r))}tangentAt(t,e={}){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);const i=this.tAt(t,e);return this.tangentAtT(i)}tangentAtLength(t,e={}){if(!this.isDifferentiable())return null;const i=this.tAtLength(t,e);return this.tangentAtT(i)}tangentAtT(t){if(!this.isDifferentiable())return null;t<0&&(t=0),t>1&&(t=1);const e=this.getSkeletonPoints(t),i=e.startControlPoint2,r=e.dividerControlPoint1,o=e.divider,s=new It(i,r);return s.translate(o.x-i.x,o.y-i.y),s}getPrecision(t={}){return t.precision==null?this.PRECISION:t.precision}getDivisions(t={}){if(t.subdivisions!=null)return t.subdivisions;const e=this.getPrecision(t);return this.getSubdivisions({precision:e})}getOptions(t={}){const e=this.getPrecision(t),i=this.getDivisions(t);return{precision:e,subdivisions:i}}tAt(t,e={}){if(t<=0)return 0;if(t>=1)return 1;const i=this.getOptions(e),o=this.length(i)*t;return this.tAtLength(o,i)}tAtLength(t,e={}){let i=!0;t<0&&(i=!1,t=-t);const r=this.getPrecision(e),o=this.getDivisions(e),s={precision:r,subdivisions:o};let a=null,l,h,u=0,d=0,c=0;const f=o.length;let g=f>0?1/f:0;for(let m=0;m<f;m+=1){const y=i?m:f-1-m,b=o[m],_=b.endpointDistance();if(t<=c+_){a=b,l=y*g,h=(y+1)*g,u=i?t-c:_+c-t,d=i?_+c-t:t-c;break}c+=_}if(a==null)return i?1:0;const p=this.length(s),v=Math.pow(10,-r);for(;;){let m;if(m=p!==0?u/p:0,m<v)return l;if(m=p!==0?d/p:0,m<v)return h;let y,b;const _=a.divide(.5);g/=2;const w=_[0].endpointDistance(),C=_[1].endpointDistance();u<=w?(a=_[0],h-=g,y=u,b=w-y):(a=_[1],l+=g,y=u-w,b=C-y),u=y,d=b}}toPoints(t={}){const e=this.getDivisions(t),i=[e[0].start.clone()];return e.forEach(r=>i.push(r.end.clone())),i}toPolyline(t={}){return new gn(this.toPoints(t))}scale(t,e,i){return this.start.scale(t,e,i),this.controlPoint1.scale(t,e,i),this.controlPoint2.scale(t,e,i),this.end.scale(t,e,i),this}rotate(t,e){return this.start.rotate(t,e),this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?(this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.start.translate(t),this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return t!=null&&this.start.equals(t.start)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)&&this.end.equals(t.end)}clone(){return new gl(this.start,this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}};(function(n){function t(e){return e!=null&&e instanceof n}n.isCurve=t})(Co||(Co={}));(function(n){function t(r){const o=r.length,s=[],a=[];let l=2;s[0]=r[0]/l;for(let h=1;h<o;h+=1)a[h]=1/l,l=(h<o-1?4:3.5)-a[h],s[h]=(r[h]-s[h-1])/l;for(let h=1;h<o;h+=1)s[o-h-1]-=a[o-h]*s[o-h];return s}function e(r){const o=r.map(c=>tt.clone(c)),s=[],a=[],l=o.length-1;if(l===1)return s[0]=new tt((2*o[0].x+o[1].x)/3,(2*o[0].y+o[1].y)/3),a[0]=new tt(2*s[0].x-o[0].x,2*s[0].y-o[0].y),[s,a];const h=[];for(let c=1;c<l-1;c+=1)h[c]=4*o[c].x+2*o[c+1].x;h[0]=o[0].x+2*o[1].x,h[l-1]=(8*o[l-1].x+o[l].x)/2;const u=t(h);for(let c=1;c<l-1;c+=1)h[c]=4*o[c].y+2*o[c+1].y;h[0]=o[0].y+2*o[1].y,h[l-1]=(8*o[l-1].y+o[l].y)/2;const d=t(h);for(let c=0;c<l;c+=1)s.push(new tt(u[c],d[c])),c<l-1?a.push(new tt(2*o[c+1].x-u[c+1],2*o[c+1].y-d[c+1])):a.push(new tt((o[l].x+u[l-1])/2,(o[l].y+d[l-1])/2));return[s,a]}function i(r){if(r==null||Array.isArray(r)&&r.length<2)throw new Error("At least 2 points are required");const o=e(r),s=[];for(let a=0,l=o[0].length;a<l;a+=1){const h=new tt(o[0][a].x,o[0][a].y),u=new tt(o[1][a].x,o[1][a].y);s.push(new n(r[a],h,u,r[a+1]))}return s}n.throughPoints=i})(Co||(Co={}));let ES=class extends cu{constructor(){super(...arguments),this.isVisible=!0,this.isSegment=!0,this.isSubpathStart=!1}get end(){return this.endPoint}get start(){if(this.previousSegment==null)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}closestPointT(t,e){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}lengthAtT(t,e){if(t<=0)return 0;const i=this.length();return t>=1?i:i*t}divideAtT(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}pointAtT(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}tangentAtT(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}};class vr extends ES{constructor(t,e){super(),It.isLine(t)?this.endPoint=t.end.clone().round(2):this.endPoint=tt.create(t,e).round(2)}get type(){return"L"}get line(){return new It(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[new vr(e[0]),new vr(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[new vr(e[0]),new vr(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return this.previousSegment==null?!1:!this.start.equals(this.end)}clone(){return new vr(this.end)}scale(t,e,i){return this.end.scale(t,e,i),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?this.end.translate(t,e):this.end.translate(t),this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}(function(n){function t(...e){const i=e.length,r=e[0];if(It.isLine(r))return new n(r);if(tt.isPointLike(r))return i===1?new n(r):e.map(s=>new n(s));if(i===2)return new n(+e[0],+e[1]);const o=[];for(let s=0;s<i;s+=2){const a=+e[s],l=+e[s+1];o.push(new n(a,l))}return o}n.create=t})(vr||(vr={}));class Eg extends ES{get end(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}get type(){return"Z"}get line(){return new It(this.start,this.end)}bbox(){return this.line.bbox()}closestPoint(t){return this.line.closestPoint(t)}closestPointLength(t){return this.line.closestPointLength(t)}closestPointNormalizedLength(t){return this.line.closestPointNormalizedLength(t)}closestPointTangent(t){return this.line.closestPointTangent(t)}length(){return this.line.length()}divideAt(t){const e=this.line.divideAt(t);return[e[1].isDifferentiable()?new vr(e[0]):this.clone(),new vr(e[1])]}divideAtLength(t){const e=this.line.divideAtLength(t);return[e[1].isDifferentiable()?new vr(e[0]):this.clone(),new vr(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.line.pointAt(t)}pointAtLength(t){return this.line.pointAtLength(t)}tangentAt(t){return this.line.tangentAt(t)}tangentAtLength(t){return this.line.tangentAtLength(t)}isDifferentiable(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)}scale(){return this}rotate(){return this}translate(){return this}equals(t){return this.type===t.type&&this.start.equals(t.start)&&this.end.equals(t.end)}clone(){return new Eg}toJSON(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}serialize(){return this.type}}(function(n){function t(){return new n}n.create=t})(Eg||(Eg={}));class Lg extends ES{constructor(t,e){super(),this.isVisible=!1,this.isSubpathStart=!0,It.isLine(t)||Co.isCurve(t)?this.endPoint=t.end.clone().round(2):this.endPoint=tt.create(t,e).round(2)}get start(){throw new Error("Illegal access. Moveto segments should not need a start property.")}get type(){return"M"}bbox(){return null}closestPoint(){return this.end.clone()}closestPointLength(){return 0}closestPointNormalizedLength(){return 0}closestPointT(){return 1}closestPointTangent(){return null}length(){return 0}lengthAtT(){return 0}divideAt(){return[this.clone(),this.clone()]}divideAtLength(){return[this.clone(),this.clone()]}getSubdivisions(){return[]}pointAt(){return this.end.clone()}pointAtLength(){return this.end.clone()}pointAtT(){return this.end.clone()}tangentAt(){return null}tangentAtLength(){return null}tangentAtT(){return null}isDifferentiable(){return!1}scale(t,e,i){return this.end.scale(t,e,i),this}rotate(t,e){return this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?this.end.translate(t,e):this.end.translate(t),this}clone(){return new Lg(this.end)}equals(t){return this.type===t.type&&this.end.equals(t.end)}toJSON(){return{type:this.type,end:this.end.toJSON()}}serialize(){const t=this.end;return`${this.type} ${t.x} ${t.y}`}}(function(n){function t(...e){const i=e.length,r=e[0];if(It.isLine(r))return new n(r);if(Co.isCurve(r))return new n(r);if(tt.isPointLike(r)){if(i===1)return new n(r);const s=[];for(let a=0;a<i;a+=1)a===0?s.push(new n(e[a])):s.push(new vr(e[a]));return s}if(i===2)return new n(+e[0],+e[1]);const o=[];for(let s=0;s<i;s+=2){const a=+e[s],l=+e[s+1];s===0?o.push(new n(a,l)):o.push(new vr(a,l))}return o}n.create=t})(Lg||(Lg={}));class Uo extends ES{constructor(t,e,i,r,o,s){super(),Co.isCurve(t)?(this.controlPoint1=t.controlPoint1.clone().round(2),this.controlPoint2=t.controlPoint2.clone().round(2),this.endPoint=t.end.clone().round(2)):typeof t=="number"?(this.controlPoint1=new tt(t,e).round(2),this.controlPoint2=new tt(i,r).round(2),this.endPoint=new tt(o,s).round(2)):(this.controlPoint1=tt.create(t).round(2),this.controlPoint2=tt.create(e).round(2),this.endPoint=tt.create(i).round(2))}get type(){return"C"}get curve(){return new Co(this.start,this.controlPoint1,this.controlPoint2,this.end)}bbox(){return this.curve.bbox()}closestPoint(t){return this.curve.closestPoint(t)}closestPointLength(t){return this.curve.closestPointLength(t)}closestPointNormalizedLength(t){return this.curve.closestPointNormalizedLength(t)}closestPointTangent(t){return this.curve.closestPointTangent(t)}length(){return this.curve.length()}divideAt(t,e={}){const i=this.curve.divideAt(t,e);return[new Uo(i[0]),new Uo(i[1])]}divideAtLength(t,e={}){const i=this.curve.divideAtLength(t,e);return[new Uo(i[0]),new Uo(i[1])]}divideAtT(t){const e=this.curve.divideAtT(t);return[new Uo(e[0]),new Uo(e[1])]}getSubdivisions(){return[]}pointAt(t){return this.curve.pointAt(t)}pointAtLength(t){return this.curve.pointAtLength(t)}tangentAt(t){return this.curve.tangentAt(t)}tangentAtLength(t){return this.curve.tangentAtLength(t)}isDifferentiable(){if(!this.previousSegment)return!1;const t=this.start,e=this.controlPoint1,i=this.controlPoint2,r=this.end;return!(t.equals(e)&&e.equals(i)&&i.equals(r))}scale(t,e,i){return this.controlPoint1.scale(t,e,i),this.controlPoint2.scale(t,e,i),this.end.scale(t,e,i),this}rotate(t,e){return this.controlPoint1.rotate(t,e),this.controlPoint2.rotate(t,e),this.end.rotate(t,e),this}translate(t,e){return typeof t=="number"?(this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e)):(this.controlPoint1.translate(t),this.controlPoint2.translate(t),this.end.translate(t)),this}equals(t){return this.start.equals(t.start)&&this.end.equals(t.end)&&this.controlPoint1.equals(t.controlPoint1)&&this.controlPoint2.equals(t.controlPoint2)}clone(){return new Uo(this.controlPoint1,this.controlPoint2,this.end)}toJSON(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}serialize(){const t=this.controlPoint1,e=this.controlPoint2,i=this.end;return[this.type,t.x,t.y,e.x,e.y,i.x,i.y].join(" ")}}(function(n){function t(...e){const i=e.length,r=e[0];if(Co.isCurve(r))return new n(r);if(tt.isPointLike(r)){if(i===3)return new n(e[0],e[1],e[2]);const s=[];for(let a=0;a<i;a+=3)s.push(new n(e[a],e[a+1],e[a+2]));return s}if(i===6)return new n(e[0],e[1],e[2],e[3],e[4],e[5]);const o=[];for(let s=0;s<i;s+=6)o.push(new n(e[s],e[s+1],e[s+2],e[s+3],e[s+4],e[s+5]));return o}n.create=t})(Uo||(Uo={}));function Fb(n,t,e){return{x:n*Math.cos(e)-t*Math.sin(e),y:n*Math.sin(e)+t*Math.cos(e)}}function Z3(n,t,e,i,r,o){const s=.3333333333333333,a=2/3;return[s*n+a*e,s*t+a*i,s*r+a*e,s*o+a*i,r,o]}function NU(n,t,e,i,r,o,s,a,l,h){const u=Math.PI*120/180,d=Math.PI/180*(+r||0);let c=[],f,g,p,v,m;if(h)g=h[0],p=h[1],v=h[2],m=h[3];else{f=Fb(n,t,-d),n=f.x,t=f.y,f=Fb(a,l,-d),a=f.x,l=f.y;const P=(n-a)/2,B=(t-l)/2;let k=P*P/(e*e)+B*B/(i*i);k>1&&(k=Math.sqrt(k),e=k*e,i=k*i);const L=e*e,O=i*i,D=(o===s?-1:1)*Math.sqrt(Math.abs((L*O-L*B*B-O*P*P)/(L*B*B+O*P*P)));v=D*e*B/i+(n+a)/2,m=D*-i*P/e+(t+l)/2,g=Math.asin((t-m)/i),p=Math.asin((l-m)/i),g=n<v?Math.PI-g:g,p=a<v?Math.PI-p:p,g<0&&(g=Math.PI*2+g),p<0&&(p=Math.PI*2+p),s&&g>p&&(g-=Math.PI*2),!s&&p>g&&(p-=Math.PI*2)}let y=p-g;if(Math.abs(y)>u){const P=p,B=a,k=l;p=g+u*(s&&p>g?1:-1),a=v+e*Math.cos(p),l=m+i*Math.sin(p),c=NU(a,l,e,i,r,0,s,B,k,[p,P,v,m])}y=p-g;const b=Math.cos(g),_=Math.sin(g),w=Math.cos(p),C=Math.sin(p),x=Math.tan(y/4),S=4/3*(e*x),A=4/3*(i*x),T=[n,t],M=[n+S*_,t-A*b],R=[a+S*C,l-A*w],E=[a,l];if(M[0]=2*T[0]-M[0],M[1]=2*T[1]-M[1],h)return[M,R,E].concat(c);{c=[M,R,E].concat(c).join().split(",");const P=[],B=c.length;for(let k=0;k<B;k+=1)P[k]=k%2?Fb(+c[k-1],+c[k],d).y:Fb(+c[k],+c[k+1],d).x;return P}}function zpt(n){if(!n)return null;const t=`	
\v\f\r \u2028\u2029`,e=new RegExp(`([a-z])[${t},]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[${t}]*,?[${t}]*)+)`,"ig"),i=new RegExp(`(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[${t}]*,?[${t}]*`,"ig"),r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return n.replace(e,(s,a,l)=>{const h=[];let u=a.toLowerCase();l.replace(i,(c,f)=>(f&&h.push(+f),c)),u==="m"&&h.length>2&&(o.push([a,...h.splice(0,2)]),u="l",a=a==="m"?"l":"L");const d=r[u];for(;h.length>=d&&(o.push([a,...h.splice(0,d)]),!!d););return s}),o}function Npt(n){const t=zpt(n);if(!t||!t.length)return[["M",0,0]];let e=0,i=0,r=0,o=0;const s=[];for(let a=0,l=t.length;a<l;a+=1){const h=[];s.push(h);const u=t[a],d=u[0];if(d!==d.toUpperCase())switch(h[0]=d.toUpperCase(),h[0]){case"A":h[1]=u[1],h[2]=u[2],h[3]=u[3],h[4]=u[4],h[5]=u[5],h[6]=+u[6]+e,h[7]=+u[7]+i;break;case"V":h[1]=+u[1]+i;break;case"H":h[1]=+u[1]+e;break;case"M":r=+u[1]+e,o=+u[2]+i;for(let c=1,f=u.length;c<f;c+=1)h[c]=+u[c]+(c%2?e:i);break;default:for(let c=1,f=u.length;c<f;c+=1)h[c]=+u[c]+(c%2?e:i);break}else for(let c=0,f=u.length;c<f;c+=1)h[c]=u[c];switch(h[0]){case"Z":e=+r,i=+o;break;case"H":e=h[1];break;case"V":i=h[1];break;case"M":r=h[h.length-2],o=h[h.length-1],e=h[h.length-2],i=h[h.length-1];break;default:e=h[h.length-2],i=h[h.length-1];break}}return s}function Wpt(n){const t=Npt(n),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function i(l,h,u){let d,c;if(!l)return["C",h.x,h.y,h.x,h.y,h.x,h.y];switch(l[0]in{T:1,Q:1}||(h.qx=null,h.qy=null),l[0]){case"M":h.X=l[1],h.Y=l[2];break;case"A":return parseFloat(l[1])===0||parseFloat(l[2])===0?["L",l[6],l[7]]:["C"].concat(NU.apply(0,[h.x,h.y].concat(l.slice(1))));case"S":return u==="C"||u==="S"?(d=h.x*2-h.bx,c=h.y*2-h.by):(d=h.x,c=h.y),["C",d,c].concat(l.slice(1));case"T":return u==="Q"||u==="T"?(h.qx=h.x*2-h.qx,h.qy=h.y*2-h.qy):(h.qx=h.x,h.qy=h.y),["C"].concat(Z3(h.x,h.y,h.qx,h.qy,l[1],l[2]));case"Q":return h.qx=l[1],h.qy=l[2],["C"].concat(Z3(h.x,h.y,l[1],l[2],l[3],l[4]));case"H":return["L"].concat(l[1],h.y);case"V":return["L"].concat(h.x,l[1])}return l}function r(l,h){if(l[h].length>7){l[h].shift();const u=l[h];for(;u.length;)o[h]="A",h+=1,l.splice(h,0,["C"].concat(u.splice(0,6)));l.splice(h,1),a=t.length}}const o=[];let s="",a=t.length;for(let l=0;l<a;l+=1){let h="";t[l]&&(h=t[l][0]),h!=="C"&&(o[l]=h,l>0&&(s=o[l-1])),t[l]=i(t[l],e,s),o[l]!=="A"&&h==="C"&&(o[l]="C"),r(t,l);const u=t[l],d=u.length;e.x=u[d-2],e.y=u[d-1],e.bx=parseFloat(u[d-4])||e.x,e.by=parseFloat(u[d-3])||e.y}return(!t[0][0]||t[0][0]!=="M")&&t.unshift(["M",0,0]),t}function Vpt(n){return Wpt(n).map(t=>t.map(e=>typeof e=="string"?e:pi.round(e,2))).join(",").split(",").join(" ")}let Ce=class On extends cu{constructor(t){if(super(),this.PRECISION=3,this.segments=[],Array.isArray(t))if(It.isLine(t[0])||Co.isCurve(t[0])){let e=null;t.forEach((r,o)=>{o===0&&this.appendSegment(On.createSegment("M",r.start)),e!=null&&!e.end.equals(r.start)&&this.appendSegment(On.createSegment("M",r.start)),It.isLine(r)?this.appendSegment(On.createSegment("L",r.end)):Co.isCurve(r)&&this.appendSegment(On.createSegment("C",r.controlPoint1,r.controlPoint2,r.end)),e=r})}else t.forEach(i=>{i.isSegment&&this.appendSegment(i)});else t!=null&&(It.isLine(t)?(this.appendSegment(On.createSegment("M",t.start)),this.appendSegment(On.createSegment("L",t.end))):Co.isCurve(t)?(this.appendSegment(On.createSegment("M",t.start)),this.appendSegment(On.createSegment("C",t.controlPoint1,t.controlPoint2,t.end))):gn.isPolyline(t)?t.points&&t.points.length&&t.points.forEach((e,i)=>{const r=i===0?On.createSegment("M",e):On.createSegment("L",e);this.appendSegment(r)}):t.isSegment&&this.appendSegment(t))}get start(){const t=this.segments,e=t.length;if(e===0)return null;for(let i=0;i<e;i+=1){const r=t[i];if(r.isVisible)return r.start}return t[e-1].end}get end(){const t=this.segments,e=t.length;if(e===0)return null;for(let i=e-1;i>=0;i-=1){const r=t[i];if(r.isVisible)return r.end}return t[e-1].end}moveTo(...t){return this.appendSegment(Lg.create.call(null,...t))}lineTo(...t){return this.appendSegment(vr.create.call(null,...t))}curveTo(...t){return this.appendSegment(Uo.create.call(null,...t))}arcTo(t,e,i,r,o,s,a){const l=this.end||new tt,h=typeof s=="number"?Cw(l.x,l.y,t,e,i,r,o,s,a):Cw(l.x,l.y,t,e,i,r,o,s.x,s.y);if(h!=null)for(let u=0,d=h.length;u<d;u+=6)this.curveTo(h[u],h[u+1],h[u+2],h[u+3],h[u+4],h[u+5]);return this}quadTo(t,e,i,r){const o=this.end||new tt,s=["M",o.x,o.y];if(typeof t=="number")s.push("Q",t,e,i,r);else{const l=e;s.push("Q",t.x,t.y,l.x,l.y)}const a=On.parse(s.join(" "));return this.appendSegment(a.segments.slice(1)),this}close(){return this.appendSegment(Eg.create())}drawPoints(t,e={}){const i=zU(t,e),r=On.parse(i);r&&r.segments&&this.appendSegment(r.segments)}bbox(){const t=this.segments,e=t.length;if(e===0)return null;let i;for(let o=0;o<e;o+=1){const s=t[o];if(s.isVisible){const a=s.bbox();a!=null&&(i=i?i.union(a):a)}}if(i!=null)return i;const r=t[e-1];return new Ct(r.end.x,r.end.y,0,0)}appendSegment(t){const e=this.segments.length;let i=e!==0?this.segments[e-1]:null,r;const o=null;if(Array.isArray(t))for(let s=0,a=t.length;s<a;s+=1){const l=t[s];r=this.prepareSegment(l,i,o),this.segments.push(r),i=r}else t!=null&&t.isSegment&&(r=this.prepareSegment(t,i,o),this.segments.push(r));return this}insertSegment(t,e){const i=this.segments.length;if(t<0&&(t=i+t+1),t>i||t<0)throw new Error("Index out of range.");let r,o=null,s=null;if(i!==0&&(t>=1?(o=this.segments[t-1],s=o.nextSegment):(o=null,s=this.segments[0])),!Array.isArray(e))r=this.prepareSegment(e,o,s),this.segments.splice(t,0,r);else for(let a=0,l=e.length;a<l;a+=1){const h=e[a];r=this.prepareSegment(h,o,s),this.segments.splice(t+a,0,r),o=r}return this}removeSegment(t){const e=this.fixIndex(t),i=this.segments.splice(e,1)[0],r=i.previousSegment,o=i.nextSegment;return r&&(r.nextSegment=o),o&&(o.previousSegment=r),i.isSubpathStart&&o&&this.updateSubpathStartSegment(o),i}replaceSegment(t,e){const i=this.fixIndex(t);let r;const o=this.segments[i];let s=o.previousSegment;const a=o.nextSegment;let l=o.isSubpathStart;if(!Array.isArray(e))r=this.prepareSegment(e,s,a),this.segments.splice(i,1,r),l&&r.isSubpathStart&&(l=!1);else{this.segments.splice(t,1);for(let h=0,u=e.length;h<u;h+=1){const d=e[h];r=this.prepareSegment(d,s,a),this.segments.splice(t+h,0,r),s=r,l&&r.isSubpathStart&&(l=!1)}}l&&a&&this.updateSubpathStartSegment(a)}getSegment(t){const e=this.fixIndex(t);return this.segments[e]}fixIndex(t){const e=this.segments.length;if(e===0)throw new Error("Path has no segments.");let i=t;for(;i<0;)i=e+i;if(i>=e||i<0)throw new Error("Index out of range.");return i}segmentAt(t,e={}){const i=this.segmentIndexAt(t,e);return i?this.getSegment(i):null}segmentAtLength(t,e={}){const i=this.segmentIndexAtLength(t,e);return i?this.getSegment(i):null}segmentIndexAt(t,e={}){if(this.segments.length===0)return null;const i=pi.clamp(t,0,1),r=this.getOptions(e),s=this.length(r)*i;return this.segmentIndexAtLength(s,r)}segmentIndexAtLength(t,e={}){const i=this.segments.length;if(i===0)return null;let r=!0;t<0&&(r=!1,t=-t);const o=this.getPrecision(e),s=this.getSubdivisions(e);let a=0,l=null;for(let h=0;h<i;h+=1){const u=r?h:i-1-h,d=this.segments[u],c=s[u],f=d.length({precision:o,subdivisions:c});if(d.isVisible){if(t<=a+f)return u;l=u}a+=f}return l}getSegmentSubdivisions(t={}){const e=this.getPrecision(t),i=[];for(let r=0,o=this.segments.length;r<o;r+=1){const a=this.segments[r].getSubdivisions({precision:e});i.push(a)}return i}updateSubpathStartSegment(t){let e=t.previousSegment,i=t;for(;i&&!i.isSubpathStart;)e!=null?i.subpathStartSegment=e.subpathStartSegment:i.subpathStartSegment=null,e=i,i=i.nextSegment}prepareSegment(t,e,i){t.previousSegment=e,t.nextSegment=i,e!=null&&(e.nextSegment=t),i!=null&&(i.previousSegment=t);let r=t;return t.isSubpathStart&&(t.subpathStartSegment=t,r=i),r!=null&&this.updateSubpathStartSegment(r),t}closestPoint(t,e={}){const i=this.closestPointT(t,e);return i?this.pointAtT(i):null}closestPointLength(t,e={}){const i=this.getOptions(e),r=this.closestPointT(t,i);return r?this.lengthAtT(r,i):0}closestPointNormalizedLength(t,e={}){const i=this.getOptions(e),r=this.closestPointLength(t,i);if(r===0)return 0;const o=this.length(i);return o===0?0:r/o}closestPointT(t,e={}){if(this.segments.length===0)return null;const i=this.getPrecision(e),r=this.getSubdivisions(e);let o,s=1/0;for(let a=0,l=this.segments.length;a<l;a+=1){const h=this.segments[a],u=r[a];if(h.isVisible){const d=h.closestPointT(t,{precision:i,subdivisions:u}),c=h.pointAtT(d),f=pi.squaredLength(c,t);f<s&&(o={segmentIndex:a,value:d},s=f)}}return o||{segmentIndex:this.segments.length-1,value:1}}closestPointTangent(t,e={}){if(this.segments.length===0)return null;const i=this.getPrecision(e),r=this.getSubdivisions(e);let o,s=1/0;for(let a=0,l=this.segments.length;a<l;a+=1){const h=this.segments[a],u=r[a];if(h.isDifferentiable()){const d=h.closestPointT(t,{precision:i,subdivisions:u}),c=h.pointAtT(d),f=pi.squaredLength(c,t);f<s&&(o=h.tangentAtT(d),s=f)}}return o||null}containsPoint(t,e={}){const i=this.toPolylines(e);if(!i)return!1;let r=0;for(let o=0,s=i.length;o<s;o+=1)i[o].containsPoint(t)&&(r+=1);return r%2===1}pointAt(t,e={}){if(this.segments.length===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();const i=this.getOptions(e),o=this.length(i)*t;return this.pointAtLength(o,i)}pointAtLength(t,e={}){if(this.segments.length===0)return null;if(t===0)return this.start.clone();let i=!0;t<0&&(i=!1,t=-t);const r=this.getPrecision(e),o=this.getSubdivisions(e);let s,a=0;for(let h=0,u=this.segments.length;h<u;h+=1){const d=i?h:u-1-h,c=this.segments[d],f=o[d],g=c.length({precision:r,subdivisions:f});if(c.isVisible){if(t<=a+g)return c.pointAtLength((i?1:-1)*(t-a),{precision:r,subdivisions:f});s=c}a+=g}return s?i?s.end:s.start:this.segments[this.segments.length-1].end.clone()}pointAtT(t){const e=this.segments,i=e.length;if(i===0)return null;const r=t.segmentIndex;if(r<0)return e[0].pointAtT(0);if(r>=i)return e[i-1].pointAtT(1);const o=pi.clamp(t.value,0,1);return e[r].pointAtT(o)}divideAt(t,e={}){if(this.segments.length===0)return null;const i=pi.clamp(t,0,1),r=this.getOptions(e),s=this.length(r)*i;return this.divideAtLength(s,r)}divideAtLength(t,e={}){if(this.segments.length===0)return null;let i=!0;t<0&&(i=!1,t=-t);const r=this.getPrecision(e),o=this.getSubdivisions(e);let s=0,a,l,h,u,d;for(let w=0,C=this.segments.length;w<C;w+=1){const x=i?w:C-1-w,S=this.getSegment(x),A=o[x],T={precision:r,subdivisions:A},M=S.length(T);if(S.isDifferentiable()&&(h=S,u=x,t<=s+M)){l=x,a=S.divideAtLength((i?1:-1)*(t-s),T);break}s+=M}if(!h)return null;a||(l=u,d=i?1:0,a=h.divideAtT(d));const c=this.clone(),f=l;c.replaceSegment(f,a);const g=f;let p=f+1,v=f+2;a[0].isDifferentiable()||(c.removeSegment(g),p-=1,v-=1);const m=c.getSegment(p).start;c.insertSegment(p,On.createSegment("M",m)),v+=1,a[1].isDifferentiable()||(c.removeSegment(v-1),v-=1);const y=v-g-1;for(let w=v,C=c.segments.length;w<C;w+=1){const x=this.getSegment(w-y),S=c.getSegment(w);if(S.type==="Z"&&!x.subpathStartSegment.end.equals(S.subpathStartSegment.end)){const A=On.createSegment("L",x.end);c.replaceSegment(w,A)}}const b=new On(c.segments.slice(0,p)),_=new On(c.segments.slice(p));return[b,_]}intersectsWithLine(t,e={}){const i=this.toPolylines(e);if(i==null)return null;let r=null;for(let o=0,s=i.length;o<s;o+=1){const a=i[o],l=t.intersect(a);l&&(r==null&&(r=[]),Array.isArray(l)?r.push(...l):r.push(l))}return r}isDifferentiable(){for(let t=0,e=this.segments.length;t<e;t+=1)if(this.segments[t].isDifferentiable())return!0;return!1}isValid(){const t=this.segments;return t.length===0||t[0].type==="M"}length(t={}){if(this.segments.length===0)return 0;const e=this.getSubdivisions(t);let i=0;for(let r=0,o=this.segments.length;r<o;r+=1){const s=this.segments[r],a=e[r];i+=s.length({subdivisions:a})}return i}lengthAtT(t,e={}){const i=this.segments.length;if(i===0)return 0;let r=t.segmentIndex;if(r<0)return 0;let o=pi.clamp(t.value,0,1);r>=i&&(r=i-1,o=1);const s=this.getPrecision(e),a=this.getSubdivisions(e);let l=0;for(let d=0;d<r;d+=1){const c=this.segments[d],f=a[d];l+=c.length({precision:s,subdivisions:f})}const h=this.segments[r],u=a[r];return l+=h.lengthAtT(o,{precision:s,subdivisions:u}),l}tangentAt(t,e={}){if(this.segments.length===0)return null;const i=pi.clamp(t,0,1),r=this.getOptions(e),s=this.length(r)*i;return this.tangentAtLength(s,r)}tangentAtLength(t,e={}){if(this.segments.length===0)return null;let i=!0;t<0&&(i=!1,t=-t);const r=this.getPrecision(e),o=this.getSubdivisions(e);let s,a=0;for(let l=0,h=this.segments.length;l<h;l+=1){const u=i?l:h-1-l,d=this.segments[u],c=o[u],f=d.length({precision:r,subdivisions:c});if(d.isDifferentiable()){if(t<=a+f)return d.tangentAtLength((i?1:-1)*(t-a),{precision:r,subdivisions:c});s=d}a+=f}if(s){const l=i?1:0;return s.tangentAtT(l)}return null}tangentAtT(t){const e=this.segments.length;if(e===0)return null;const i=t.segmentIndex;if(i<0)return this.segments[0].tangentAtT(0);if(i>=e)return this.segments[e-1].tangentAtT(1);const r=pi.clamp(t.value,0,1);return this.segments[i].tangentAtT(r)}getPrecision(t={}){return t.precision==null?this.PRECISION:t.precision}getSubdivisions(t={}){if(t.segmentSubdivisions==null){const e=this.getPrecision(t);return this.getSegmentSubdivisions({precision:e})}return t.segmentSubdivisions}getOptions(t={}){const e=this.getPrecision(t),i=this.getSubdivisions(t);return{precision:e,segmentSubdivisions:i}}toPoints(t={}){const e=this.segments,i=e.length;if(i===0)return null;const r=this.getSubdivisions(t),o=[];let s=[];for(let a=0;a<i;a+=1){const l=e[a];if(l.isVisible){const h=r[a];h.length>0?h.forEach(u=>s.push(u.start)):s.push(l.start)}else s.length>0&&(s.push(e[a-1].end),o.push(s),s=[])}return s.length>0&&(s.push(this.end),o.push(s)),o}toPolylines(t={}){const e=this.toPoints(t);return e?e.map(i=>new gn(i)):null}scale(t,e,i){return this.segments.forEach(r=>r.scale(t,e,i)),this}rotate(t,e){return this.segments.forEach(i=>i.rotate(t,e)),this}translate(t,e){return typeof t=="number"?this.segments.forEach(i=>i.translate(t,e)):this.segments.forEach(i=>i.translate(t)),this}clone(){const t=new On;return this.segments.forEach(e=>t.appendSegment(e.clone())),t}equals(t){if(t==null)return!1;const e=this.segments,i=t.segments,r=e.length;if(i.length!==r)return!1;for(let o=0;o<r;o+=1){const s=e[o],a=i[o];if(s.type!==a.type||!s.equals(a))return!1}return!0}toJSON(){return this.segments.map(t=>t.toJSON())}serialize(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map(t=>t.serialize()).join(" ")}toString(){return this.serialize()}};(function(n){function t(e){return e!=null&&e instanceof n}n.isPath=t})(Ce||(Ce={}));(function(n){function t(i){if(!i)return new n;const r=new n,o=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,s=n.normalize(i).match(o);if(s!=null)for(let a=0,l=s.length;a<l;a+=1){const h=s[a],u=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,d=h.match(u);if(d!=null){const c=d[0],f=d.slice(1).map(p=>+p),g=e.call(null,c,...f);r.appendSegment(g)}}return r}n.parse=t;function e(i,...r){if(i==="M")return Lg.create.call(null,...r);if(i==="L")return vr.create.call(null,...r);if(i==="C")return Uo.create.call(null,...r);if(i==="z"||i==="Z")return Eg.create();throw new Error(`Invalid path segment type "${i}"`)}n.createSegment=e})(Ce||(Ce={}));(function(n){n.normalize=Vpt,n.isValid=Ipt,n.drawArc=Fpt,n.drawPoints=zU,n.arcToCurves=Cw})(Ce||(Ce={}));class yn{constructor(t){this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}get names(){return Object.keys(this.data)}register(t,e,i=!1){if(typeof t=="object"){Object.entries(t).forEach(([s,a])=>{this.register(s,a,e)});return}this.exist(t)&&!i&&!qh.isApplyingHMR()&&this.onDuplicated(t);const r=this.options.process,o=r?Qt(r,this,t,e):e;return this.data[t]=o,o}unregister(t){const e=t?this.data[t]:null;return delete this.data[t],e}get(t){return t?this.data[t]:null}exist(t){return t?this.data[t]!=null:!1}onDuplicated(t){try{throw this.options.onConflict&&Qt(this.options.onConflict,this,t),new Error(`${XD(this.options.type)} with name '${t}' already registered.`)}catch(e){throw e}}onNotFound(t,e){throw new Error(this.getSpellingSuggestion(t,e))}getSpellingSuggestion(t,e){const i=this.getSpellingSuggestionForName(t),r=e?`${e} ${OQ(this.options.type)}`:this.options.type;return`${XD(r)} with name '${t}' does not exist.${i?` Did you mean '${i}'?`:""}`}getSpellingSuggestionForName(t){return Wgt(t,Object.keys(this.data),e=>e)}}(function(n){function t(e){return new n(e)}n.create=t})(yn||(yn={}));const Gpt={color:"#aaaaaa",thickness:1,markup:"rect",update(n,t){const e=t.thickness*t.sx,i=t.thickness*t.sy;mi(n,{width:e,height:i,rx:e,ry:i,fill:t.color})}},$pt={color:"#aaaaaa",thickness:1,markup:"rect",update(n,t){const e=t.sx<=1?t.thickness*t.sx:t.thickness;mi(n,{width:e,height:e,rx:e,ry:e,fill:t.color})}},jpt={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(n,t){let e;const i=t.width,r=t.height,o=t.thickness;i-o>=0&&r-o>=0?e=["M",i,0,"H0 M0 0 V0",r].join(" "):e="M 0 0 0 0",mi(n,{d:e,stroke:t.color,"stroke-width":t.thickness})}},Upt=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update(n,t){let e;const i=t.width,r=t.height,o=t.thickness;i-o>=0&&r-o>=0?e=["M",i,0,"H0 M0 0 V0",r].join(" "):e="M 0 0 0 0",mi(n,{d:e,stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update(n,t){let e;const i=t.factor||1,r=t.width*i,o=t.height*i,s=t.thickness;r-s>=0&&o-s>=0?e=["M",r,0,"H0 M0 0 V0",o].join(" "):e="M 0 0 0 0",t.width=r,t.height=o,mi(n,{d:e,stroke:t.color,"stroke-width":t.thickness})}}],Xpt=Object.freeze(Object.defineProperty({__proto__:null,dot:Gpt,doubleMesh:Upt,fixedDot:$pt,mesh:jpt},Symbol.toStringTag,{value:"Module"}));let Lh=class{constructor(){this.patterns={},this.root=qt.create(vw(),{width:"100%",height:"100%"},[ra("defs")]).node}add(t,e){const i=this.root.childNodes[0];i&&i.appendChild(e),this.patterns[t]=e,qt.create("rect",{width:"100%",height:"100%",fill:`url(#${t})`}).appendTo(this.root)}get(t){return this.patterns[t]}has(t){return this.patterns[t]!=null}};(function(n){n.presets=Xpt,n.registry=yn.create({type:"grid"}),n.registry.register(n.presets,!0)})(Lh||(Lh={}));const WU=function(n){const t=document.createElement("canvas"),e=n.width,i=n.height;t.width=e*2,t.height=i;const r=t.getContext("2d");return r.drawImage(n,0,0,e,i),r.translate(2*e,0),r.scale(-1,1),r.drawImage(n,0,0,e,i),t},VU=function(n){const t=document.createElement("canvas"),e=n.width,i=n.height;t.width=e,t.height=i*2;const r=t.getContext("2d");return r.drawImage(n,0,0,e,i),r.translate(0,2*i),r.scale(1,-1),r.drawImage(n,0,0,e,i),t},GU=function(n){const t=document.createElement("canvas"),e=n.width,i=n.height;t.width=2*e,t.height=2*i;const r=t.getContext("2d");return r.drawImage(n,0,0,e,i),r.setTransform(-1,0,0,-1,t.width,t.height),r.drawImage(n,0,0,e,i),r.setTransform(-1,0,0,1,t.width,0),r.drawImage(n,0,0,e,i),r.setTransform(1,0,0,-1,0,t.height),r.drawImage(n,0,0,e,i),t},Ypt=function(n,t){const e=n.width,i=n.height,r=document.createElement("canvas");r.width=e*3,r.height=i*3;const o=r.getContext("2d"),s=t.angle!=null?-t.angle:-20,a=vi.toRad(s),l=r.width/4,h=r.height/4;for(let u=0;u<4;u+=1)for(let d=0;d<4;d+=1)(u+d)%2>0&&(o.setTransform(1,0,0,1,(2*u-1)*l,(2*d-1)*h),o.rotate(a),o.drawImage(n,-e/2,-i/2,e,i));return r},Kpt=Object.freeze(Object.defineProperty({__proto__:null,flipX:WU,flipXY:GU,flipY:VU,watermark:Ypt},Symbol.toStringTag,{value:"Module"}));var cm;(function(n){n.presets=Object.assign({},Kpt),n.presets["flip-x"]=WU,n.presets["flip-y"]=VU,n.presets["flip-xy"]=GU,n.registry=yn.create({type:"background pattern"}),n.registry.register(n.presets,!0)})(cm||(cm={}));function sO(n,t){return n??t}function In(n,t){return n!=null&&Number.isFinite(n)?n:t}function qpt(n={}){const t=sO(n.color,"blue"),e=In(n.width,1),i=In(n.margin,2),r=In(n.opacity,1),o=i,s=i+e;return`
    <filter>
      <feFlood flood-color="${t}" flood-opacity="${r}" result="colored"/>
      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${s}" />
      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${o}" />
      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>
      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>
      <feMerge>
        <feMergeNode in="outline"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  `.trim()}function Zpt(n={}){const t=sO(n.color,"red"),e=In(n.blur,0),i=In(n.width,1),r=In(n.opacity,1);return`
      <filter>
        <feFlood flood-color="${t}" flood-opacity="${r}" result="colored"/>
        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${i}"/>
        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>
        <feGaussianBlur result="blured" in="composed" stdDeviation="${e}"/>
        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>
      </filter>
    `.trim()}function Jpt(n={}){const t=In(n.x,2);return`
    <filter>
      <feGaussianBlur stdDeviation="${n.y!=null&&Number.isFinite(n.y)?[t,n.y]:t}"/>
    </filter>
  `.trim()}function Qpt(n={}){const t=In(n.dx,0),e=In(n.dy,0),i=sO(n.color,"black"),r=In(n.blur,4),o=In(n.opacity,1);return"SVGFEDropShadowElement"in window?`<filter>
         <feDropShadow stdDeviation="${r}" dx="${t}" dy="${e}" flood-color="${i}" flood-opacity="${o}" />
       </filter>`.trim():`<filter>
         <feGaussianBlur in="SourceAlpha" stdDeviation="${r}" />
         <feOffset dx="${t}" dy="${e}" result="offsetblur" />
         <feFlood flood-color="${i}" />
         <feComposite in2="offsetblur" operator="in" />
         <feComponentTransfer>
           <feFuncA type="linear" slope="${o}" />
         </feComponentTransfer>
         <feMerge>
           <feMergeNode/>
           <feMergeNode in="SourceGraphic"/>
         </feMerge>
       </filter>`.trim()}function tvt(n={}){const t=In(n.amount,1),e=.2126+.7874*(1-t),i=.7152-.7152*(1-t),r=.0722-.0722*(1-t),o=.2126-.2126*(1-t),s=.7152+.2848*(1-t),a=.0722-.0722*(1-t),l=.2126-.2126*(1-t),h=.0722+.9278*(1-t);return`
    <filter>
      <feColorMatrix type="matrix" values="${e} ${i} ${r} 0 0 ${o} ${s} ${a} 0 0 ${l} ${i} ${h} 0 0 0 0 0 1 0"/>
    </filter>
  `.trim()}function evt(n={}){const t=In(n.amount,1),e=.393+.607*(1-t),i=.769-.769*(1-t),r=.189-.189*(1-t),o=.349-.349*(1-t),s=.686+.314*(1-t),a=.168-.168*(1-t),l=.272-.272*(1-t),h=.534-.534*(1-t),u=.131+.869*(1-t);return`
      <filter>
        <feColorMatrix type="matrix" values="${e} ${i} ${r} 0 0 ${o} ${s} ${a} 0 0 ${l} ${h} ${u} 0 0 0 0 0 1 0"/>
      </filter>
    `.trim()}function ivt(n={}){return`
      <filter>
        <feColorMatrix type="saturate" values="${1-In(n.amount,1)}"/>
      </filter>
    `.trim()}function nvt(n={}){return`
      <filter>
        <feColorMatrix type="hueRotate" values="${In(n.angle,0)}"/>
      </filter>
    `.trim()}function rvt(n={}){const t=In(n.amount,1),e=1-t;return`
      <filter>
        <feComponentTransfer>
          <feFuncR type="table" tableValues="${t} ${e}"/>
          <feFuncG type="table" tableValues="${t} ${e}"/>
          <feFuncB type="table" tableValues="${t} ${e}"/>
        </feComponentTransfer>
      </filter>
    `.trim()}function ovt(n={}){const t=In(n.amount,1);return`
    <filter>
      <feComponentTransfer>
        <feFuncR type="linear" slope="${t}"/>
        <feFuncG type="linear" slope="${t}"/>
        <feFuncB type="linear" slope="${t}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}function svt(n={}){const t=In(n.amount,1),e=.5-t/2;return`
    <filter>
     <feComponentTransfer>
        <feFuncR type="linear" slope="${t}" intercept="${e}"/>
        <feFuncG type="linear" slope="${t}" intercept="${e}"/>
        <feFuncB type="linear" slope="${t}" intercept="${e}"/>
      </feComponentTransfer>
    </filter>
  `.trim()}const avt=Object.freeze(Object.defineProperty({__proto__:null,blur:Jpt,brightness:ovt,contrast:svt,dropShadow:Qpt,grayScale:tvt,highlight:Zpt,hueRotate:nvt,invert:rvt,outline:qpt,saturate:ivt,sepia:evt},Symbol.toStringTag,{value:"Module"}));var Og;(function(n){n.presets=avt,n.registry=yn.create({type:"filter"}),n.registry.register(n.presets,!0)})(Og||(Og={}));const lvt={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},hvt={},$U={position:LS("x","width","origin")},jU={position:LS("y","height","origin")},uvt={position:LS("x","width","corner")},dvt={position:LS("y","height","corner")},UU={set:Jh("width","width")},XU={set:Jh("height","height")},cvt={set:Jh("rx","width")},fvt={set:Jh("ry","height")},YU={set:(n=>{const t=Jh(n,"width"),e=Jh(n,"height");return function(i,r){const o=r.refBBox,s=o.height>o.width?t:e;return Qt(s,this,i,r)}})("r")},gvt={set(n,{refBBox:t}){let e=parseFloat(n);const i=$l(n);i&&(e/=100);const r=Math.sqrt(t.height*t.height+t.width*t.width);let o;return Number.isFinite(e)&&(i||e>=0&&e<=1?o=e*r:o=Math.max(e+r,0)),{r:o}}},pvt={set:Jh("cx","width")},vvt={set:Jh("cy","height")},KU={set:JU({resetOffset:!0})},mvt={set:JU({resetOffset:!1})},qU={set:QU({resetOffset:!0})},yvt={set:QU({resetOffset:!1})},bvt=YU,_vt=KU,Cvt=qU,wvt=$U,xvt=jU,Svt=UU,Avt=XU;function LS(n,t,e){return(i,{refBBox:r})=>{if(i==null)return null;let o=parseFloat(i);const s=$l(i);s&&(o/=100);let a;if(Number.isFinite(o)){const h=r[e];s||o>0&&o<1?a=h[n]+r[t]*o:a=h[n]+o}const l=new tt;return l[n]=a||0,l}}function Jh(n,t){return function(e,{refBBox:i}){let r=parseFloat(e);const o=$l(e);o&&(r/=100);const s={};if(Number.isFinite(r)){const a=o||r>=0&&r<=1?r*i[t]:Math.max(r+i[t],0);s[n]=a}return s}}function ZU(n,t){const e="x6-shape",i=t&&t.resetOffset;return function(r,{elem:o,refBBox:s}){let a=hc(o,e);if(!a||a.value!==r){const p=n(r);a={value:r,shape:p,shapeBBox:p.bbox()},hc(o,e,a)}const l=a.shape.clone(),h=a.shapeBBox.clone(),u=h.getOrigin(),d=s.getOrigin();h.x=d.x,h.y=d.y;const c=s.getMaxScaleToFit(h,d),f=h.width===0||s.width===0?1:c.sx,g=h.height===0||s.height===0?1:c.sy;return l.scale(f,g,u),i&&l.translate(-u.x,-u.y),l}}function JU(n){function t(i){return Ce.parse(i)}const e=ZU(t,n);return(i,r)=>({d:e(i,r).serialize()})}function QU(n){const t=ZU(e=>new gn(e),n);return(e,i)=>({points:t(e,i).serialize()})}const Tvt={qualify:ql,set(n,{view:t}){return`url(#${t.graph.defineGradient(n)})`}},Mvt={qualify:ql,set(n,{view:t}){const e=t.cell,i=Object.assign({},n);if(e.isEdge()&&i.type==="linearGradient"){const r=t,o=r.sourcePoint,s=r.targetPoint;i.id=`gradient-${i.type}-${e.id}`,i.attrs=Object.assign(Object.assign({},i.attrs),{x1:o.x,y1:o.y,x2:s.x,y2:s.y,gradientUnits:"userSpaceOnUse"}),t.graph.defs.remove(i.id)}return`url(#${t.graph.defineGradient(i)})`}},tX={qualify(n,{attrs:t}){return t.textWrap==null||!ql(t.textWrap)},set(n,{view:t,elem:e,attrs:i}){const r="x6-text",o=hc(e,r),s=u=>{try{return JSON.parse(u)}catch{return u}},a={x:i.x,eol:i.eol,annotations:s(i.annotations),textPath:s(i["text-path"]||i.textPath),textVerticalAnchor:i["text-vertical-anchor"]||i.textVerticalAnchor,displayEmpty:(i["display-empty"]||i.displayEmpty)==="true",lineHeight:i["line-height"]||i.lineHeight},l=i["font-size"]||i.fontSize,h=JSON.stringify([n,a]);if(l&&e.setAttribute("font-size",l),o==null||o!==h){const u=a.textPath;if(u!=null&&typeof u=="object"){const d=u.selector;if(typeof d=="string"){const c=t.find(d)[0];c instanceof SVGPathElement&&(eO(c),a.textPath=Object.assign({"xlink:href":`#${c.id}`},u))}}kU(e,`${n}`,a),hc(e,r,h)}}},Rvt={qualify:ql,set(n,{view:t,elem:e,attrs:i,refBBox:r}){const o=n,s=o.width||0;$l(s)?r.width*=parseFloat(s)/100:s<=0?r.width+=s:r.width=s;const a=o.height||0;$l(a)?r.height*=parseFloat(a)/100:a<=0?r.height+=a:r.height=a;let l,h=o.text;h==null&&(h=i.text||e?.textContent),h!=null?l=EU(`${h}`,r,{"font-weight":i["font-weight"]||i.fontWeight,"font-size":i["font-size"]||i.fontSize,"font-family":i["font-family"]||i.fontFamily,lineHeight:i.lineHeight},{ellipsis:o.ellipsis}):l="",Qt(tX.set,this,l,{view:t,elem:e,attrs:i,refBBox:r,cell:t.cell})}},_p=(n,{attrs:t})=>t.text!==void 0,Bvt={qualify:_p},Pvt={qualify:_p},kvt={qualify:_p},Evt={qualify:_p},Lvt={qualify:_p},Ovt={qualify:_p},Dvt={qualify(n,{elem:t}){return t instanceof SVGElement},set(n,{elem:t}){const e="x6-title",i=`${n}`,r=hc(t,e);if(r==null||r!==i){hc(t,e,i);const o=t.firstChild;if(o&&o.tagName.toUpperCase()==="TITLE"){const s=o;s.textContent=i}else{const s=document.createElementNS(t.namespaceURI,"title");s.textContent=i,t.insertBefore(s,o)}}}},Ivt={offset:eX("x","width","right")},Hvt={offset:eX("y","height","bottom")},Fvt={offset(n,{refBBox:t}){return n?{x:-t.x,y:-t.y}:{x:0,y:0}}};function eX(n,t,e){return(i,{refBBox:r})=>{const o=new tt;let s;return i==="middle"?s=r[t]/2:i===e?s=r[t]:typeof i=="number"&&Number.isFinite(i)?s=i>-1&&i<1?-r[t]*i:-i:$l(i)?s=r[t]*parseFloat(i)/100:s=0,o[n]=-(r[n]+s),o}}const zvt={qualify:ql,set(n,{elem:t}){yy(t,n)}},Nvt={set(n,{elem:t}){t.innerHTML=`${n}`}},Wvt={qualify:ql,set(n,{view:t}){return`url(#${t.graph.defineFilter(n)})`}},Vvt={set(n){return n!=null&&typeof n=="object"&&n.id?n.id:n}};function fu(n,t,e){let i,r;typeof t=="object"?(i=t.x,r=t.y):(i=t,r=e);const o=Ce.parse(n),s=o.bbox();if(s){let a=-s.height/2-s.y,l=-s.width/2-s.x;typeof i=="number"&&(l-=i),typeof r=="number"&&(a-=r),o.translate(l,a)}return o.serialize()}var iX=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const Gvt=n=>{var{size:t,width:e,height:i,offset:r,open:o}=n,s=iX(n,["size","width","height","offset","open"]);return nX({size:t,width:e,height:i,offset:r},o===!0,!0,void 0,s)},$vt=n=>{var{size:t,width:e,height:i,offset:r,factor:o}=n,s=iX(n,["size","width","height","offset","factor"]);return nX({size:t,width:e,height:i,offset:r},!1,!1,o,s)};function nX(n,t,e,i=3/4,r={}){const o=n.size||10,s=n.width||o,a=n.height||o,l=new Ce,h={};if(t)l.moveTo(s,0).lineTo(0,a/2).lineTo(s,a),h.fill="none";else{if(l.moveTo(0,a/2),l.lineTo(s,0),!e){const u=is(i,0,1);l.lineTo(s*u,a/2)}l.lineTo(s,a),l.close()}return Object.assign(Object.assign(Object.assign({},h),r),{tagName:"path",d:fu(l.serialize(),{x:n.offset!=null?n.offset:-s/2})})}var jvt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const Uvt=n=>{var{size:t,width:e,height:i,offset:r}=n,o=jvt(n,["size","width","height","offset"]);const s=t||10,a=e||s,l=i||s,h=new Ce;return h.moveTo(0,l/2).lineTo(a/2,0).lineTo(a,l/2).lineTo(a/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:fu(h.serialize(),r??-a/2)})};var Xvt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const Yvt=n=>{var{d:t,offsetX:e,offsetY:i}=n,r=Xvt(n,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},r),{tagName:"path",d:fu(t,e,i)})};var Kvt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const qvt=n=>{var{size:t,width:e,height:i,offset:r}=n,o=Kvt(n,["size","width","height","offset"]);const s=t||10,a=e||s,l=i||s,h=new Ce;return h.moveTo(0,0).lineTo(a,l).moveTo(0,l).lineTo(a,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:fu(h.serialize(),r||-a/2)})};var Zvt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const Jvt=n=>{var{width:t,height:e,offset:i,open:r,flip:o}=n,s=Zvt(n,["width","height","offset","open","flip"]);let a=e||6;const l=t||10,h=r===!0,u=o===!0,d=Object.assign(Object.assign({},s),{tagName:"path"});u&&(a=-a);const c=new Ce;return c.moveTo(0,a).lineTo(l,0),h?d.fill="none":(c.lineTo(l,a),c.close()),d.d=fu(c.serialize(),{x:i||-l/2,y:a/2}),d};var rX=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const oX=n=>{var{r:t}=n,e=rX(n,["r"]);const i=t||5;return Object.assign(Object.assign({cx:i},e),{tagName:"circle",r:i})},Qvt=n=>{var{r:t}=n,e=rX(n,["r"]);const i=t||5,r=new Ce;return r.moveTo(i,0).lineTo(i,i*2),r.moveTo(0,i).lineTo(i*2,i),{children:[Object.assign(Object.assign({},oX({r:i})),{fill:"none"}),Object.assign(Object.assign({},e),{tagName:"path",d:fu(r.serialize(),-i)})]}};var t0t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const e0t=n=>{var{rx:t,ry:e}=n,i=t0t(n,["rx","ry"]);const r=t||5,o=e||5;return Object.assign(Object.assign({cx:r},i),{tagName:"ellipse",rx:r,ry:o})},i0t=Object.freeze(Object.defineProperty({__proto__:null,async:Jvt,block:Gvt,circle:oX,circlePlus:Qvt,classic:$vt,cross:qvt,diamond:Uvt,ellipse:e0t,path:Yvt},Symbol.toStringTag,{value:"Module"}));var Qh;(function(n){n.presets=i0t,n.registry=yn.create({type:"marker"}),n.registry.register(n.presets,!0)})(Qh||(Qh={}));(function(n){n.normalize=fu})(Qh||(Qh={}));var n0t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};function aO(n){return typeof n=="string"||ql(n)}const r0t={qualify:aO,set(n,{view:t,attrs:e}){return lO("marker-start",n,t,e)}},o0t={qualify:aO,set(n,{view:t,attrs:e}){return lO("marker-end",n,t,e,{transform:"rotate(180)"})}},s0t={qualify:aO,set(n,{view:t,attrs:e}){return lO("marker-mid",n,t,e)}};function lO(n,t,e,i,r={}){const o=typeof t=="string"?{name:t}:t,{name:s,args:a}=o,l=n0t(o,["name","args"]);let h=l;if(s&&typeof s=="string"){const d=Qh.registry.get(s);if(d)h=d(Object.assign(Object.assign({},l),a));else return Qh.registry.onNotFound(s)}const u=Object.assign(Object.assign(Object.assign({},a0t(i,n)),r),h);return{[n]:`url(#${e.graph.defineMarker(u)})`}}function a0t(n,t){const e={},i=n.stroke;typeof i=="string"&&(e.stroke=i,e.fill=i);let r=n.strokeOpacity;if(r==null&&(r=n["stroke-opacity"]),r==null&&(r=n.opacity),r!=null&&(e["stroke-opacity"]=r,e["fill-opacity"]=r),t!=="marker-mid"){const o=parseFloat(n.strokeWidth||n["stroke-width"]);if(Number.isFinite(o)&&o>1){const s=Math.ceil(o/2);e.refX=t==="marker-start"?s:-s}}return e}const by=(n,{view:t})=>t.cell.isEdge(),l0t={qualify:by,set(n,t){var e,i,r,o;const s=t.view,a=n.reverse||!1,l=n.stubs||0;let h;if(Number.isFinite(l)&&l!==0)if(a){let u,d;const c=s.getConnectionLength()||0;l<0?(u=(c+l)/2,d=-l):(u=l,d=c-l*2);const f=s.getConnection();h=(o=(r=(i=(e=f?.divideAtLength(u))===null||e===void 0?void 0:e[1])===null||i===void 0?void 0:i.divideAtLength(d))===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.serialize()}else{let u;l<0?u=((s.getConnectionLength()||0)+l)/2:u=l;const d=s.getConnection();if(d){const c=d.divideAtLength(u),f=d.divideAtLength(-u);c&&f&&(h=`${c[0].serialize()} ${f[1].serialize()}`)}}return{d:h||s.getConnectionPathData()}}},sX={qualify:by,set:OS("getTangentAtLength",{rotate:!0})},h0t={qualify:by,set:OS("getTangentAtLength",{rotate:!1})},aX={qualify:by,set:OS("getTangentAtRatio",{rotate:!0})},u0t={qualify:by,set:OS("getTangentAtRatio",{rotate:!1})},d0t=sX,c0t=aX;function OS(n,t){const e={x:1,y:0};return(i,r)=>{let o,s;const a=r.view,l=a[n](Number(i));return l?(s=t.rotate?l.vector().vectorAngle(e):0,o=l.start):(o=a.path.start,s=0),s===0?{transform:`translate(${o.x},${o.y}')`}:{transform:`translate(${o.x},${o.y}') rotate(${s})`}}}const f0t=Object.freeze(Object.defineProperty({__proto__:null,annotations:Evt,atConnectionLength:d0t,atConnectionLengthIgnoreGradient:h0t,atConnectionLengthKeepGradient:sX,atConnectionRatio:c0t,atConnectionRatioIgnoreGradient:u0t,atConnectionRatioKeepGradient:aX,connection:l0t,displayEmpty:Ovt,eol:Lvt,fill:Tvt,filter:Wvt,html:Nvt,lineHeight:Bvt,port:Vvt,ref:hvt,refCx:pvt,refCy:vvt,refD:_vt,refDKeepOffset:mvt,refDResetOffset:KU,refDx:uvt,refDy:dvt,refHeight:XU,refHeight2:Avt,refPoints:Cvt,refPointsKeepOffset:yvt,refPointsResetOffset:qU,refR:bvt,refRCircumscribed:gvt,refRInscribed:YU,refRx:cvt,refRy:fvt,refWidth:UU,refWidth2:Svt,refX:$U,refX2:wvt,refY:jU,refY2:xvt,resetOffset:Fvt,sourceMarker:r0t,stroke:Mvt,style:zvt,targetMarker:o0t,text:tX,textPath:kvt,textVerticalAnchor:Pvt,textWrap:Rvt,title:Dvt,vertexMarker:s0t,xAlign:Ivt,yAlign:Hvt},Symbol.toStringTag,{value:"Module"}));var Wa;(function(n){function t(e,i,r){return!!(e!=null&&(typeof e=="string"||typeof e.qualify!="function"||Qt(e.qualify,this,i,r)))}n.isValidDefinition=t})(Wa||(Wa={}));(function(n){n.presets=Object.assign(Object.assign({},lvt),f0t),n.registry=yn.create({type:"attribute definition"}),n.registry.register(n.presets,!0)})(Wa||(Wa={}));const Ks={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix(n){return`${Ks.prefixCls}-${n}`}},J3=Ks.prefix("highlighted"),g0t={highlight(n,t,e){const i=e&&e.className||J3;je(t,i)},unhighlight(n,t,e){const i=e&&e.className||J3;rs(t,i)}},Q3=Ks.prefix("highlight-opacity"),p0t={highlight(n,t){je(t,Q3)},unhighlight(n,t){rs(t,Q3)}};var oi;(function(n){n.normalizeMarker=fu;function t(c,f){const g=wpt(c.x,c.y).matrixTransform(f);return new tt(g.x,g.y)}n.transformPoint=t;function e(c,f){return new It(t(c.start,f),t(c.end,f))}n.transformLine=e;function i(c,f){let g=c instanceof gn?c.points:c;return Array.isArray(g)||(g=[]),new gn(g.map(p=>t(p,f)))}n.transformPolyline=i;function r(c,f){const p=ra("svg").createSVGPoint();p.x=c.x,p.y=c.y;const v=p.matrixTransform(f);p.x=c.x+c.width,p.y=c.y;const m=p.matrixTransform(f);p.x=c.x+c.width,p.y=c.y+c.height;const y=p.matrixTransform(f);p.x=c.x,p.y=c.y+c.height;const b=p.matrixTransform(f),_=Math.min(v.x,m.x,y.x,b.x),w=Math.max(v.x,m.x,y.x,b.x),C=Math.min(v.y,m.y,y.y,b.y),x=Math.max(v.y,m.y,y.y,b.y);return new Ct(_,C,w-_,x-C)}n.transformRectangle=r;function o(c,f,g){let p;const v=c.ownerSVGElement;if(!v)return new Ct(0,0,0,0);try{p=c.getBBox()}catch{p={x:c.clientLeft,y:c.clientTop,width:c.clientWidth,height:c.clientHeight}}if(f)return Ct.create(p);const m=m0(c,g||v);return r(p,m)}n.bbox=o;function s(c,f={}){let g;if(!c.ownerSVGElement||!Zh(c)){if(G3(c)){const{left:y,top:b,width:_,height:w}=a(c);return new Ct(y,b,_,w)}return new Ct(0,0,0,0)}let v=f.target;if(!f.recursive){try{g=c.getBBox()}catch{g={x:c.clientLeft,y:c.clientTop,width:c.clientWidth,height:c.clientHeight}}if(!v)return Ct.create(g);const y=m0(c,v);return r(g,y)}{const y=c.childNodes,b=y.length;if(b===0)return s(c,{target:v});v||(v=c);for(let _=0;_<b;_+=1){const w=y[_];let C;w.childNodes.length===0?C=s(w,{target:v}):C=s(w,{target:v,recursive:!0}),g?g=g.union(C):g=C}return g}}n.getBBox=s;function a(c){let f=0,g=0,p=0,v=0;if(c){let m=c;for(;m;)f+=m.offsetLeft,g+=m.offsetTop,m=m.offsetParent,m&&(f+=parseInt(X3(m,"borderLeft"),10),g+=parseInt(X3(m,"borderTop"),10));p=c.offsetWidth,v=c.offsetHeight}return{left:f,top:g,width:p,height:v}}n.getBoundingOffsetRect=a;function l(c){const f=g=>{const p=c.getAttribute(g),v=p?parseFloat(p):0;return Number.isNaN(v)?0:v};switch(c instanceof SVGElement&&c.nodeName.toLowerCase()){case"rect":return new Ct(f("x"),f("y"),f("width"),f("height"));case"circle":return new Ys(f("cx"),f("cy"),f("r"),f("r"));case"ellipse":return new Ys(f("cx"),f("cy"),f("rx"),f("ry"));case"polyline":{const g=yw(c);return new gn(g)}case"polygon":{const g=yw(c);return g.length>1&&g.push(g[0]),new gn(g)}case"path":{let g=c.getAttribute("d");return Ce.isValid(g)||(g=Ce.normalize(g)),Ce.parse(g)}case"line":return new It(f("x1"),f("y1"),f("x2"),f("y2"))}return s(c)}n.toGeometryShape=l;function h(c,f,g,p){const v=tt.create(f),m=tt.create(g);p||(p=c instanceof SVGSVGElement?c:c.ownerSVGElement);const y=QB(c);c.setAttribute("transform","");const b=s(c,{target:p}).scale(y.sx,y.sy),_=Fv();_.setTranslate(-b.x-b.width/2,-b.y-b.height/2);const w=Fv(),C=v.angleBetween(m,v.clone().translate(1,0));C&&w.setRotate(C,0,0);const x=Fv(),S=v.clone().move(m,b.width/2);x.setTranslate(2*v.x-S.x,2*v.y-S.y);const A=m0(c,p),T=Fv();T.setMatrix(x.matrix.multiply(w.matrix.multiply(_.matrix.multiply(A.scale(y.sx,y.sy))))),c.setAttribute("transform",bp(T.matrix))}n.translateAndAutoOrient=h;function u(c){if(c==null)return null;let f=c;do{let g=f.tagName;if(typeof g!="string")return null;if(g=g.toUpperCase(),py(f,"x6-port"))f=f.nextElementSibling;else if(g==="G")f=f.firstElementChild;else if(g==="TITLE")f=f.nextElementSibling;else break}while(f);return f}n.findShapeNode=u;function d(c){const f=u(c);if(!Zh(f)){if(G3(c)){const{left:v,top:m,width:y,height:b}=a(c);return new Ct(v,m,y,b)}return new Ct(0,0,0,0)}return l(f).bbox()||Ct.create()}n.getBBoxV2=d})(oi||(oi={}));const v0t={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},m0t={highlight(n,t,e){const i=Ch.getHighlighterId(t,e);if(Ch.hasCache(i))return;e=i8({},e,v0t);const r=qt.create(t);let o,s;try{o=r.toPathData()}catch{s=oi.bbox(r.node,!0),o=OU(Object.assign(Object.assign({},e),s))}const a=ra("path");if(mi(a,Object.assign({d:o,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},e.attrs?lm(e.attrs):null)),n.isEdgeElement(t))mi(a,"d",n.getConnectionPathData());else{let u=r.getTransformToElement(n.container);const d=e.padding;if(d){s==null&&(s=oi.bbox(r.node,!0));const c=s.x+s.width/2,f=s.y+s.height/2;s=oi.transformRectangle(s,u);const g=Math.max(s.width,1),p=Math.max(s.height,1),v=(g+d)/g,m=(p+d)/p,y=zn({a:v,b:0,c:0,d:m,e:c-v*c,f:f-m*f});u=u.multiply(y)}Pg(a,u)}je(a,Ks.prefix("highlight-stroke"));const l=n.cell,h=()=>Ch.removeHighlighter(i);l.on("removed",h),l.model&&l.model.on("reseted",h),n.container.appendChild(a),Ch.setCache(i,a)},unhighlight(n,t,e){Ch.removeHighlighter(Ch.getHighlighterId(t,e))}};var Ch;(function(n){function t(s,a){return eO(s),s.id+JSON.stringify(a)}n.getHighlighterId=t;const e={};function i(s,a){e[s]=a}n.setCache=i;function r(s){return e[s]!=null}n.hasCache=r;function o(s){const a=e[s];a&&(Bg(a),delete e[s])}n.removeHighlighter=o})(Ch||(Ch={}));const y0t=Object.freeze(Object.defineProperty({__proto__:null,className:g0t,opacity:p0t,stroke:m0t},Symbol.toStringTag,{value:"Module"}));var Dl;(function(n){function t(e,i){if(typeof i.highlight!="function")throw new Error(`Highlighter '${e}' is missing required \`highlight()\` method`);if(typeof i.unhighlight!="function")throw new Error(`Highlighter '${e}' is missing required \`unhighlight()\` method`)}n.check=t})(Dl||(Dl={}));(function(n){n.presets=y0t,n.registry=yn.create({type:"highlighter"}),n.registry.register(n.presets,!0)})(Dl||(Dl={}));function iP(n,t={}){return new tt(Gs(t.x,n.width),Gs(t.y,n.height))}function hO(n,t,e){return Object.assign({angle:t,position:n.toJSON()},e)}const b0t=(n,t)=>n.map(({x:e,y:i,angle:r})=>hO(iP(t,{x:e,y:i}),r||0)),_0t=(n,t,e)=>{const i=e.start||0,r=e.step||20;return lX(n,t,i,(o,s)=>(o+.5-s/2)*r)},C0t=(n,t,e)=>{const i=e.start||0,r=e.step||360/n.length;return lX(n,t,i,o=>o*r)};function lX(n,t,e,i){const r=t.getCenter(),o=t.getTopCenter(),s=t.width/t.height,a=Ys.fromRect(t),l=n.length;return n.map((h,u)=>{const d=e+i(u,l),c=o.clone().rotate(-d,r).scale(s,1,r),f=h.compensateRotate?-a.tangentTheta(c):0;return(h.dx||h.dy)&&c.translate(h.dx||0,h.dy||0),h.dr&&c.move(r,h.dr),hO(c.round(),f,h)})}var w0t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const x0t=(n,t,e)=>{const i=iP(t,e.start||t.getOrigin()),r=iP(t,e.end||t.getCorner());return _y(n,i,r,e)},S0t=(n,t,e)=>_y(n,t.getTopLeft(),t.getBottomLeft(),e),A0t=(n,t,e)=>_y(n,t.getTopRight(),t.getBottomRight(),e),T0t=(n,t,e)=>_y(n,t.getTopLeft(),t.getTopRight(),e),M0t=(n,t,e)=>_y(n,t.getBottomLeft(),t.getBottomRight(),e);function _y(n,t,e,i){const r=new It(t,e),o=n.length;return n.map((s,a)=>{var{strict:l}=s,h=w0t(s,["strict"]);const u=l||i.strict?(a+1)/(o+1):(a+.5)/o,d=r.pointAt(u);return(h.dx||h.dy)&&d.translate(h.dx||0,h.dy||0),hO(d.round(),0,h)})}const R0t=Object.freeze(Object.defineProperty({__proto__:null,absolute:b0t,bottom:M0t,ellipse:_0t,ellipseSpread:C0t,left:S0t,line:x0t,right:A0t,top:T0t},Symbol.toStringTag,{value:"Module"}));var Nd;(function(n){n.presets=R0t,n.registry=yn.create({type:"port layout"}),n.registry.register(n.presets,!0)})(Nd||(Nd={}));const B0t={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function gu(n,t){const{x:e,y:i,angle:r,attrs:o}=t||{};return i8({},{angle:r,attrs:o,position:{x:e,y:i}},n,B0t)}const P0t=(n,t,e)=>gu({position:t.getTopLeft()},e),k0t=(n,t,e)=>gu({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},e),E0t=(n,t,e)=>gu({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},e),L0t=(n,t,e)=>gu({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},e),O0t=(n,t,e)=>gu({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},e),D0t=(n,t,e)=>hX(n,t,!1,e),I0t=(n,t,e)=>hX(n,t,!0,e),H0t=(n,t,e)=>uX(n,t,!1,e),F0t=(n,t,e)=>uX(n,t,!0,e);function hX(n,t,e,i){const r=i.offset!=null?i.offset:15,o=t.getCenter().theta(n),s=dX(t);let a,l,h,u,d=0;return o<s[1]||o>s[2]?(a=".3em",l=r,h=0,u="start"):o<s[0]?(a="0",l=0,h=-r,e?(d=-90,u="start"):u="middle"):o<s[3]?(a=".3em",l=-r,h=0,u="end"):(a=".6em",l=0,h=r,e?(d=90,u="start"):u="middle"),gu({position:{x:Math.round(l),y:Math.round(h)},angle:d,attrs:{".":{y:a,"text-anchor":u}}},i)}function uX(n,t,e,i){const r=i.offset!=null?i.offset:15,o=t.getCenter().theta(n),s=dX(t);let a,l,h,u,d=0;return o<s[1]||o>s[2]?(a=".3em",l=-r,h=0,u="end"):o<s[0]?(a=".6em",l=0,h=r,e?(d=90,u="start"):u="middle"):o<s[3]?(a=".3em",l=r,h=0,u="start"):(a="0em",l=0,h=-r,e?(d=-90,u="start"):u="middle"),gu({position:{x:Math.round(l),y:Math.round(h)},angle:d,attrs:{".":{y:a,"text-anchor":u}}},i)}function dX(n){const t=n.getCenter(),e=t.theta(n.getTopLeft()),i=t.theta(n.getBottomLeft()),r=t.theta(n.getBottomRight()),o=t.theta(n.getTopRight());return[e,o,r,i]}const z0t=(n,t,e)=>cX(n.diff(t.getCenter()),!1,e),N0t=(n,t,e)=>cX(n.diff(t.getCenter()),!0,e);function cX(n,t,e){const i=e.offset!=null?e.offset:20,r=new tt(0,0),o=-n.theta(r),s=n.clone().move(r,i).diff(n).round();let a=".3em",l,h=o;return(o+90)%180===0?(l=t?"end":"middle",!t&&o===-270&&(a="0em")):o>-270&&o<-90?(l="start",h=o-180):l="end",gu({position:s.round().toJSON(),angle:t?h:0,attrs:{".":{y:a,"text-anchor":l}}},e)}const W0t=Object.freeze(Object.defineProperty({__proto__:null,bottom:O0t,inside:H0t,insideOriented:F0t,left:k0t,manual:P0t,outside:D0t,outsideOriented:I0t,radial:z0t,radialOriented:N0t,right:E0t,top:L0t},Symbol.toStringTag,{value:"Module"}));var Dg;(function(n){n.presets=W0t,n.registry=yn.create({type:"port label layout"}),n.registry.register(n.presets,!0)})(Dg||(Dg={}));var V0t=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class Bi extends To{get priority(){return 2}get disposeContainer(){return!0}constructor(){super(),this.cid=nP.uniqueId(),Bi.views[this.cid]=this}confirmUpdate(t,e){return 0}empty(t=this.container){return vy(t),this}unmount(t=this.container){return Bg(t),this}remove(t=this.container){return t===this.container?(this.removeEventListeners(document),this.onRemove(),delete Bi.views[this.cid],this.disposeContainer&&this.unmount(t)):this.unmount(t),this}onRemove(){}setClass(t,e=this.container){e.classList.value=Array.isArray(t)?t.join(" "):t}addClass(t,e=this.container){return je(e,Array.isArray(t)?t.join(" "):t),this}removeClass(t,e=this.container){return rs(e,Array.isArray(t)?t.join(" "):t),this}setStyle(t,e=this.container){return yy(e,t),this}setAttrs(t,e=this.container){return t!=null&&e!=null&&mi(e,t),this}findAttr(t,e=this.container){let i=e;for(;i&&i.nodeType===1;){const r=i.getAttribute(t);if(r!=null)return r;if(i===this.container)return null;i=i.parentNode}return null}find(t,e=this.container,i=this.selectors){return Bi.find(t,e,i).elems}findOne(t,e=this.container,i=this.selectors){const r=this.find(t,e,i);return r.length>0?r[0]:null}findByAttr(t,e=this.container){let i=e;for(;i&&i.getAttribute;){const r=i.getAttribute(t);if((r!=null||i===this.container)&&r!=="false")return i;i=i.parentNode}return null}getSelector(t,e){let i;if(t===this.container)return typeof e=="string"&&(i=`> ${e}`),i;if(t){const r=nO(t)+1;i=`${t.tagName.toLowerCase()}:nth-child(${r})`,e&&(i+=` > ${e}`),i=this.getSelector(t.parentNode,i)}return i}prefixClassName(t){return Ks.prefix(t)}delegateEvents(t,e){if(t==null)return this;e||this.undelegateEvents();const i=/^(\S+)\s*(.*)$/;return Object.keys(t).forEach(r=>{const o=r.match(i);if(o==null)return;const s=this.getEventHandler(t[r]);typeof s=="function"&&this.delegateEvent(o[1],o[2],s)}),this}undelegateEvents(){return Xn.off(this.container,this.getEventNamespace()),this}delegateDocumentEvents(t,e){return this.addEventListeners(document,t,e),this}undelegateDocumentEvents(){return this.removeEventListeners(document),this}delegateEvent(t,e,i){return Xn.on(this.container,t+this.getEventNamespace(),e,i),this}undelegateEvent(t,e,i){const r=t+this.getEventNamespace();return e==null?Xn.off(this.container,r):typeof e=="string"?Xn.off(this.container,r,e,i):Xn.off(this.container,r,e),this}addEventListeners(t,e,i){if(e==null)return this;const r=this.getEventNamespace();return Object.keys(e).forEach(o=>{const s=this.getEventHandler(e[o]);typeof s=="function"&&Xn.on(t,o+r,i,s)}),this}removeEventListeners(t){return t!=null&&Xn.off(t,this.getEventNamespace()),this}getEventNamespace(){return`.${Ks.prefixCls}-event-${this.cid}`}getEventHandler(t){let e;if(typeof t=="string"){const i=this[t];typeof i=="function"&&(e=(...r)=>i.call(this,...r))}else e=(...i)=>t.call(this,...i);return e}getEventTarget(t,e={}){const{target:i,type:r,clientX:o=0,clientY:s=0}=t;return e.fromPoint||r==="touchmove"||r==="touchend"?document.elementFromPoint(o,s):i}stopPropagation(t){return this.setEventData(t,{propagationStopped:!0}),this}isPropagationStopped(t){return this.getEventData(t).propagationStopped===!0}getEventData(t){return this.eventData(t)}setEventData(t,e){return this.eventData(t,e)}eventData(t,e){if(t==null)throw new TypeError("Event object required");let i=t.data;const r=`__${this.cid}__`;return e==null?i==null?{}:i[r]||{}:(i==null&&(i=t.data={}),i[r]==null?i[r]=Object.assign({},e):i[r]=Object.assign(Object.assign({},i[r]),e),i[r])}normalizeEvent(t){return Bi.normalizeEvent(t)}dispose(){this.remove()}}V0t([Bi.dispose()],Bi.prototype,"dispose",null);(function(n){function t(r,o){return o?ra(r||"g"):iO(r||"div")}n.createElement=t;function e(r,o,s){if(!r||r===".")return{elems:[o]};if(s){const a=s[r];if(a)return{elems:Array.isArray(a)?a:[a]}}{const a=r.includes(">")?`:scope ${r}`:r;return{isCSSSelector:!0,elems:Array.prototype.slice.call(o.querySelectorAll(a))}}}n.find=e;function i(r){let o=r;const s=r.originalEvent,a=s&&s.changedTouches&&s.changedTouches[0];if(a){for(const l in r)a[l]===void 0&&(a[l]=r[l]);o=a}return o}n.normalizeEvent=i})(Bi||(Bi={}));(function(n){n.views={};function t(e){return n.views[e]||null}n.getView=t})(Bi||(Bi={}));var nP;(function(n){let t=0;function e(){const i=`v${t}`;return t+=1,i}n.uniqueId=e})(nP||(nP={}));class G0t{constructor(t){this.view=t,this.clean()}clean(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new eP,this.pathCache={}}get(t){return this.elemCache.has(t)||this.elemCache.set(t,{}),this.elemCache.get(t)}getData(t){const e=this.get(t);return e.data||(e.data={}),e.data}getMatrix(t){const e=this.get(t);if(e.matrix==null){const i=this.view.container;e.matrix=Mpt(t,i)}return zn(e.matrix)}getShape(t){const e=this.get(t);return e.shape==null&&(e.shape=oi.toGeometryShape(t)),e.shape.clone()}getBoundingRect(t){const e=this.get(t);return e.boundingRect==null&&(e.boundingRect=oi.getBBoxV2(t)),e.boundingRect.clone()}}var Mi;(function(n){function t(h){return h!=null&&!e(h)}n.isJSONMarkup=t;function e(h){return h!=null&&typeof h=="string"}n.isStringMarkup=e;function i(h){return h==null||e(h)?h:Ki(h)}n.clone=i;function r(h){return`${h}`.trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")}n.sanitize=r;function o(h,u={ns:Dn.svg}){const d=document.createDocumentFragment(),c={},f={},g=[{markup:Array.isArray(h)?h:[h],parent:d,ns:u.ns}];for(;g.length>0;){const p=g.pop();let v=p.ns||Dn.svg;const m=p.markup,y=p.parent;m.forEach(b=>{const _=b.tagName;if(!_)throw new TypeError("Invalid tagName");b.ns&&(v=b.ns);const w=v?iO(_,v):V3(_),C=b.attrs;C&&mi(w,lm(C));const x=b.style;x&&yy(w,x);const S=b.className;S!=null&&w.setAttribute("class",Array.isArray(S)?S.join(" "):S),b.textContent&&(w.textContent=b.textContent);const A=b.selector;if(A!=null){if(f[A])throw new TypeError("Selector must be unique");f[A]=w}if(b.groupSelector){let M=b.groupSelector;Array.isArray(M)||(M=[M]),M.forEach(R=>{c[R]||(c[R]=[]),c[R].push(w)})}y.appendChild(w);const T=b.children;Array.isArray(T)&&g.push({ns:v,markup:T,parent:w})})}return Object.keys(c).forEach(p=>{if(f[p])throw new Error("Ambiguous group selector");f[p]=c[p]}),{fragment:d,selectors:f,groups:c}}n.parseJSONMarkup=o;function s(h){return h instanceof SVGElement?ra("g"):V3("div")}function a(h){if(e(h)){const f=qt.createVectors(h),g=f.length;if(g===1)return{elem:f[0].node};if(g>1){const p=s(f[0].node);return f.forEach(v=>{p.appendChild(v.node)}),{elem:p}}return{}}const u=o(h),d=u.fragment;let c=null;return d.childNodes.length>1?(c=s(d.firstChild),c.appendChild(d)):c=d.firstChild,{elem:c,selectors:u.selectors}}n.renderMarkup=a;function l(h){const u=qt.createVectors(h),d=document.createDocumentFragment();for(let c=0,f=u.length;c<f;c+=1){const g=u[c].node;d.appendChild(g)}return{fragment:d,selectors:{}}}n.parseLabelStringMarkup=l})(Mi||(Mi={}));(function(n){function t(e,i,r){if(e!=null){let o;const s=e.tagName.toLowerCase();if(e===i)return typeof r=="string"?o=`> ${s} > ${r}`:o=`> ${s}`,o;const a=e.parentNode;if(a&&a.childNodes.length>1){const l=nO(e)+1;o=`${s}:nth-child(${l})`}else o=s;return r&&(o+=` > ${r}`),t(e.parentNode,i,o)}return r}n.getSelector=t})(Mi||(Mi={}));(function(n){function t(){return"g"}n.getPortContainerMarkup=t;function e(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}}n.getPortMarkup=e;function i(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}n.getPortLabelMarkup=i})(Mi||(Mi={}));(function(n){function t(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}n.getEdgeMarkup=t})(Mi||(Mi={}));(function(n){function t(e=!1){return{tagName:"foreignObject",selector:"fo",children:[{ns:Dn.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:Dn.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}n.getForeignObjectMarkup=t})(Mi||(Mi={}));class fX{constructor(t){this.view=t}get cell(){return this.view.cell}getDefinition(t){return this.cell.getAttrDefinition(t)}processAttrs(t,e){let i,r,o,s;const a=[];return Object.keys(e).forEach(l=>{const h=e[l],u=this.getDefinition(l),d=Qt(Wa.isValidDefinition,this.view,u,h,{elem:t,attrs:e,cell:this.cell,view:this.view});if(u&&d)typeof u=="string"?(i==null&&(i={}),i[u]=h):h!==null&&a.push({name:l,definition:u});else{i==null&&(i={});const c=AU.includes(l)?l:sU(l);i[c]=h}}),a.forEach(({name:l,definition:h})=>{const u=e[l];typeof h.set=="function"&&(r==null&&(r={}),r[l]=u),typeof h.offset=="function"&&(o==null&&(o={}),o[l]=u),typeof h.position=="function"&&(s==null&&(s={}),s[l]=u)}),{raw:e,normal:i,set:r,offset:o,position:s}}mergeProcessedAttrs(t,e){t.set=Object.assign(Object.assign({},t.set),e.set),t.position=Object.assign(Object.assign({},t.position),e.position),t.offset=Object.assign(Object.assign({},t.offset),e.offset);const i=t.normal&&t.normal.transform;i!=null&&e.normal&&(e.normal.transform=i),t.normal=e.normal}findAttrs(t,e,i,r){const o=[],s=new eP;return Object.keys(t).forEach(a=>{const l=t[a];if(!ql(l))return;const{isCSSSelector:h,elems:u}=Bi.find(a,e,r);i[a]=u;for(let d=0,c=u.length;d<c;d+=1){const f=u[d],g=r&&r[a]===f,p=s.get(f);if(p){p.array||(o.push(f),p.array=!0,p.attrs=[p.attrs],p.priority=[p.priority]);const v=p.attrs,m=p.priority;if(g)v.unshift(l),m.unshift(-1);else{const y=DQ(m,h?-1:c);v.splice(y,0,l),m.splice(y,0,c)}}else s.set(f,{elem:f,attrs:l,priority:g?-1:c,array:!1})}}),o.forEach(a=>{const l=s.get(a),h=l.attrs;l.attrs=h.reduceRight((u,d)=>Cn(u,d),{})}),s}updateRelativeAttrs(t,e,i){const r=e.raw||{};let o=e.normal||{};const s=e.set,a=e.position,l=e.offset,h=()=>({elem:t,cell:this.cell,view:this.view,attrs:r,refBBox:i.clone()});if(s!=null&&Object.keys(s).forEach(v=>{const m=s[v],y=this.getDefinition(v);if(y!=null){const b=Qt(y.set,this.view,m,h());typeof b=="object"?o=Object.assign(Object.assign({},o),b):b!=null&&(o[v]=b)}}),t instanceof HTMLElement){this.view.setAttrs(o,t);return}const u=o.transform,d=u?`${u}`:null,c=hm(d),f=new tt(c.e,c.f);u&&(delete o.transform,c.e=0,c.f=0);let g=!1;a!=null&&Object.keys(a).forEach(v=>{const m=a[v],y=this.getDefinition(v);if(y!=null){const b=Qt(y.position,this.view,m,h());b!=null&&(g=!0,f.translate(tt.create(b)))}}),this.view.setAttrs(o,t);let p=!1;if(l!=null){const v=this.view.getBoundingRectOfElement(t);if(v.width>0&&v.height>0){const m=oi.transformRectangle(v,c);Object.keys(l).forEach(y=>{const b=l[y],_=this.getDefinition(y);if(_!=null){const w=Qt(_.offset,this.view,b,{elem:t,cell:this.cell,view:this.view,attrs:r,refBBox:m});w!=null&&(p=!0,f.translate(tt.create(w)))}})}}(u!=null||g||p)&&(f.round(1),c.e=f.x,c.f=f.y,t.setAttribute("transform",bp(c)))}update(t,e,i){const r={},o=this.findAttrs(i.attrs||e,t,r,i.selectors),s=i.attrs?this.findAttrs(e,t,r,i.selectors):o,a=[];o.each(u=>{const d=u.elem,c=u.attrs,f=this.processAttrs(d,c);if(f.set==null&&f.position==null&&f.offset==null)this.view.setAttrs(f.normal,d);else{const g=s.get(d),p=g?g.attrs:null,v=p&&c.ref==null?p.ref:c.ref;let m;if(v){if(m=(r[v]||this.view.find(v,t,i.selectors))[0],!m)throw new Error(`"${v}" reference does not exist.`)}else m=null;const y={node:d,refNode:m,attributes:p,processedAttributes:f},b=a.findIndex(_=>_.refNode===d);b>-1?a.splice(b,0,y):a.push(y)}});const l=new eP;let h;a.forEach(u=>{const d=u.node,c=u.refNode;let f;const g=c!=null&&i.rotatableNode!=null&&SU(i.rotatableNode,c);if(c&&(f=l.get(c)),!f){const m=g?i.rotatableNode:t;f=c?oi.getBBox(c,{target:m}):i.rootBBox,c&&l.set(c,f)}let p;i.attrs&&u.attributes?(p=this.processAttrs(d,u.attributes),this.mergeProcessedAttrs(p,u.processedAttributes)):p=u.processedAttributes;let v=f;g&&i.rotatableNode!=null&&!i.rotatableNode.contains(d)&&(h||(h=hm(mi(i.rotatableNode,"transform"))),v=oi.transformRectangle(f,h)),this.updateRelativeAttrs(d,p,v)})}}class gX{get cell(){return this.view.cell}constructor(t,e,i=[]){this.view=t;const r={},o={};let s=0;Object.keys(e).forEach(l=>{let h=e[l];Array.isArray(h)||(h=[h]),h.forEach(u=>{let d=r[u];d||(s+=1,d=r[u]=1<<s),o[l]|=d})});let a=i;if(Array.isArray(a)||(a=[a]),a.forEach(l=>{r[l]||(s+=1,r[l]=1<<s)}),s>25)throw new Error("Maximum number of flags exceeded.");this.flags=r,this.attrs=o,this.bootstrap=i}getFlag(t){const e=this.flags;return e==null?0:Array.isArray(t)?t.reduce((i,r)=>i|e[r],0):e[t]|0}hasAction(t,e){return t&this.getFlag(e)}removeAction(t,e){return t^t&this.getFlag(e)}getBootstrapFlag(){return this.getFlag(this.bootstrap)}getChangedFlag(){let t=0;return this.attrs&&Object.keys(this.attrs).forEach(e=>{this.cell.hasChanged(e)&&(t|=this.attrs[e])}),t}}var $0t=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},j0t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class vn extends Bi{static getDefaults(){return this.defaults}static config(t){this.defaults=this.getOptions(t)}static getOptions(t){const e=(h,u)=>u!=null?n8([...Array.isArray(h)?h:[h],...Array.isArray(u)?u:[u]]):Array.isArray(h)?[...h]:[h],i=Ki(this.getDefaults()),{bootstrap:r,actions:o,events:s,documentEvents:a}=t,l=j0t(t,["bootstrap","actions","events","documentEvents"]);return r&&(i.bootstrap=e(i.bootstrap,r)),o&&Object.entries(o).forEach(([h,u])=>{const d=i.actions[h];u&&d?i.actions[h]=e(d,u):u&&(i.actions[h]=e(u))}),s&&(i.events=Object.assign(Object.assign({},i.events),s)),t.documentEvents&&(i.documentEvents=Object.assign(Object.assign({},i.documentEvents),a)),Cn(i,l)}get[Symbol.toStringTag](){return vn.toStringTag}constructor(t,e={}){super(),this.cell=t,this.options=this.ensureOptions(e),this.graph=this.options.graph,this.attr=new fX(this),this.flag=new gX(this,this.options.actions,this.options.bootstrap),this.cache=new G0t(this),this.setContainer(this.ensureContainer()),this.setup(),this.init()}init(){}onRemove(){this.removeTools()}get priority(){return this.options.priority}get rootSelector(){return this.options.rootSelector}getConstructor(){return this.constructor}ensureOptions(t){return this.getConstructor().getOptions(t)}getContainerTagName(){return this.options.isSvgElement?"g":"div"}getContainerStyle(){}getContainerAttrs(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}getContainerClassName(){return this.prefixClassName("cell")}ensureContainer(){return Bi.createElement(this.getContainerTagName(),this.options.isSvgElement)}setContainer(t){if(this.container!==t){this.undelegateEvents(),this.container=t,this.options.events!=null&&this.delegateEvents(this.options.events);const e=this.getContainerAttrs();e!=null&&this.setAttrs(e,t);const i=this.getContainerStyle();i!=null&&this.setStyle(i,t);const r=this.getContainerClassName();r!=null&&this.addClass(r,t)}return this}isNodeView(){return!1}isEdgeView(){return!1}render(){return this}confirmUpdate(t,e={}){return 0}getBootstrapFlag(){return this.flag.getBootstrapFlag()}getFlag(t){return this.flag.getFlag(t)}hasAction(t,e){return this.flag.hasAction(t,e)}removeAction(t,e){return this.flag.removeAction(t,e)}handleAction(t,e,i,r){if(this.hasAction(t,e)){i();const o=[e];return r&&(typeof r=="string"?o.push(r):o.push(...r)),this.removeAction(t,o)}return t}setup(){this.cell.on("changed",this.onCellChanged,this)}onCellChanged({options:t}){this.onAttrsChange(t)}onAttrsChange(t){let e=this.flag.getChangedFlag();t.updated||!e||(t.dirty&&this.hasAction(e,"update")&&(e|=this.getFlag("render")),t.toolId&&(t.async=!1),this.graph!=null&&this.graph.renderer.requestViewUpdate(this,e,t))}parseJSONMarkup(t,e){const i=Mi.parseJSONMarkup(t),r=i.selectors,o=this.rootSelector;if(e&&o){if(r[o])throw new Error("Invalid root selector");r[o]=e}return i}can(t){let e=this.graph.options.interacting;if(typeof e=="function"&&(e=Qt(e,this.graph,this)),typeof e=="object"){let i=e[t];return typeof i=="function"&&(i=Qt(i,this.graph,this)),i!==!1}return typeof e=="boolean"?e:!1}cleanCache(){return this.cache.clean(),this}getCache(t){return this.cache.get(t)}getDataOfElement(t){return this.cache.getData(t)}getMatrixOfElement(t){return this.cache.getMatrix(t)}getShapeOfElement(t){return this.cache.getShape(t)}getBoundingRectOfElement(t){return this.cache.getBoundingRect(t)}getBBoxOfElement(t){const e=this.getBoundingRectOfElement(t),i=this.getMatrixOfElement(t),r=this.getRootRotatedMatrix(),o=this.getRootTranslatedMatrix();return oi.transformRectangle(e,o.multiply(r).multiply(i))}getUnrotatedBBoxOfElement(t){const e=this.getBoundingRectOfElement(t),i=this.getMatrixOfElement(t),r=this.getRootTranslatedMatrix();return oi.transformRectangle(e,r.multiply(i))}getBBox(t={}){let e;if(t.useCellGeometry){const i=this.cell,r=i.isNode()?i.getAngle():0;e=i.getBBox().bbox(r)}else e=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(e)}getRootTranslatedMatrix(){const t=this.cell,e=t.isNode()?t.getPosition():{x:0,y:0};return zn().translate(e.x,e.y)}getRootRotatedMatrix(){let t=zn();const e=this.cell,i=e.isNode()?e.getAngle():0;if(i){const r=e.getBBox(),o=r.width/2,s=r.height/2;t=t.translate(o,s).rotate(i).translate(-o,-s)}return t}findMagnet(t=this.container){return this.findByAttr("magnet",t)}updateAttrs(t,e,i={}){i.rootBBox==null&&(i.rootBBox=new Ct),i.selectors==null&&(i.selectors=this.selectors),this.attr.update(t,e,i)}isEdgeElement(t){return this.cell.isEdge()&&(t==null||t===this.container)}prepareHighlight(t,e={}){const i=t||this.container;return e.partial=i===this.container,i}highlight(t,e={}){const i=this.prepareHighlight(t,e);return this.notify("cell:highlight",{magnet:i,options:e,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:i,options:e,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:i,options:e,view:this,node:this.cell,cell:this.cell}),this}unhighlight(t,e={}){const i=this.prepareHighlight(t,e);return this.notify("cell:unhighlight",{magnet:i,options:e,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:i,options:e,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:i,options:e,view:this,edge:this.cell,cell:this.cell}),this}notifyUnhighlight(t,e){}getEdgeTerminal(t,e,i,r,o){const s=this.cell,a=this.findAttr("port",t),l=t.getAttribute("data-selector"),h={cell:s.id};return l!=null&&(h.magnet=l),a!=null?(h.port=a,s.isNode()&&!s.hasPort(a)&&l==null&&(h.selector=this.getSelector(t))):l==null&&this.container!==t&&(h.selector=this.getSelector(t)),h}getMagnetFromEdgeTerminal(t){const e=this.cell,i=this.container,r=t.port;let o=t.magnet,s;return r!=null&&e.isNode()&&e.hasPort(r)?s=this.findPortElem(r,o)||i:(o||(o=t.selector),!o&&r!=null&&(o=`[port="${r}"]`),s=this.findOne(o,i,this.selectors)),s}hasTools(t){const e=this.tools;return e==null?!1:t==null?!0:e.name===t}addTools(t){if(this.removeTools(),t){if(!this.can("toolsAddable"))return this;const e=Tn.isToolsView(t)?t:new Tn(t);this.tools=e,e.config({view:this}),e.mount()}return this}updateTools(t={}){return this.tools&&this.tools.update(t),this}removeTools(){return this.tools&&(this.tools.remove(),this.tools=null),this}hideTools(){return this.tools&&this.tools.hide(),this}showTools(){return this.tools&&this.tools.show(),this}renderTools(){const t=this.cell.getTools();return this.addTools(t),this}notify(t,e){return this.trigger(t,e),this.graph.trigger(t,e),this}getEventArgs(t,e,i){const r=this,o=r.cell;return e==null||i==null?{e:t,view:r,cell:o}:{e:t,x:e,y:i,view:r,cell:o}}onClick(t,e,i){this.notify("cell:click",this.getEventArgs(t,e,i))}onDblClick(t,e,i){this.notify("cell:dblclick",this.getEventArgs(t,e,i))}onContextMenu(t,e,i){this.notify("cell:contextmenu",this.getEventArgs(t,e,i))}onMouseDown(t,e,i){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(t,e,i))}onMouseUp(t,e,i){this.notify("cell:mouseup",this.getEventArgs(t,e,i)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}onMouseMove(t,e,i){this.notify("cell:mousemove",this.getEventArgs(t,e,i))}onMouseOver(t){this.notify("cell:mouseover",this.getEventArgs(t))}onMouseOut(t){this.notify("cell:mouseout",this.getEventArgs(t))}onMouseEnter(t){this.notify("cell:mouseenter",this.getEventArgs(t))}onMouseLeave(t){this.notify("cell:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,i,r){this.notify("cell:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,i)))}onCustomEvent(t,e,i,r){this.notify("cell:customevent",Object.assign({name:e},this.getEventArgs(t,i,r))),this.notify(e,Object.assign({},this.getEventArgs(t,i,r)))}onMagnetMouseDown(t,e,i,r){}onMagnetDblClick(t,e,i,r){}onMagnetContextMenu(t,e,i,r){}onLabelMouseDown(t,e,i){}checkMouseleave(t){const e=this.getEventTarget(t,{fromPoint:!0}),i=this.graph.findViewByElem(e);i!==this&&(this.onMouseLeave(t),i&&i.onMouseEnter(t))}dispose(){this.cell.off("changed",this.onCellChanged,this)}}vn.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}};$0t([vn.dispose()],vn.prototype,"dispose",null);(function(n){n.Flag=gX,n.Attr=fX})(vn||(vn={}));(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.isNodeView=="function"&&typeof r.isEdgeView=="function"&&typeof r.confirmUpdate=="function"}n.isCellView=t})(vn||(vn={}));(function(n){function t(i){return function(r){r.config({priority:i})}}n.priority=t;function e(i){return function(r){r.config({bootstrap:i})}}n.bootstrap=e})(vn||(vn={}));(function(n){n.registry=yn.create({type:"view"})})(vn||(vn={}));class Tn extends Bi{get name(){return this.options.name}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get[Symbol.toStringTag](){return Tn.toStringTag}constructor(t={}){super(),this.svgContainer=this.createContainer(!0,t),this.htmlContainer=this.createContainer(!1,t),this.config(t)}createContainer(t,e){const i=t?Bi.createElement("g",!0):Bi.createElement("div",!1);return je(i,this.prefixClassName("cell-tools")),e.className&&je(i,e.className),i}config(t){if(this.options=Object.assign(Object.assign({},this.options),t),!vn.isCellView(t.view)||t.view===this.cellView)return this;this.cellView=t.view,this.cell.isEdge()?(je(this.svgContainer,this.prefixClassName("edge-tools")),je(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(je(this.svgContainer,this.prefixClassName("node-tools")),je(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));const e=this.options.items;if(!Array.isArray(e))return this;this.tools=[];const i=[];e.forEach(r=>{Tn.ToolItem.isToolItem(r)?r.name==="vertices"?i.unshift(r):i.push(r):(typeof r=="object"?r.name:r)==="vertices"?i.unshift(r):i.push(r)});for(let r=0;r<i.length;r+=1){const o=i[r];let s;if(Tn.ToolItem.isToolItem(o))s=o;else{const a=typeof o=="object"?o.name:o,l=typeof o=="object"?o.args||{}:{};if(a){if(this.cell.isNode()){const h=Hg.registry.get(a);if(h)s=new h(l);else return Hg.registry.onNotFound(a)}else if(this.cell.isEdge()){const h=Fg.registry.get(a);if(h)s=new h(l);else return Fg.registry.onNotFound(a)}}}s&&(s.config(this.cellView,this),s.render(),(s.options.isSVGElement!==!1?this.svgContainer:this.htmlContainer).appendChild(s.container),this.tools.push(s))}return this}update(t={}){const e=this.tools;return e&&e.forEach(i=>{t.toolId!==i.cid&&i.isVisible()&&i.update()}),this}focus(t){const e=this.tools;return e&&e.forEach(i=>{t===i?i.show():i.hide()}),this}blur(t){const e=this.tools;return e&&e.forEach(i=>{i!==t&&!i.isVisible()&&(i.show(),i.update())}),this}hide(){return this.focus(null)}show(){return this.blur(null)}remove(){const t=this.tools;return t&&(t.forEach(e=>e.remove()),this.tools=null),Bg(this.svgContainer),Bg(this.htmlContainer),super.remove()}mount(){const t=this.tools,e=this.cellView;if(e&&t){const i=t.some(o=>o.options.isSVGElement!==!1),r=t.some(o=>o.options.isSVGElement===!1);i&&(this.options.local?e.container:e.graph.view.decorator).appendChild(this.svgContainer),r&&this.graph.container.appendChild(this.htmlContainer)}return this}}(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&r.graph!=null&&r.cell!=null&&typeof r.config=="function"&&typeof r.update=="function"&&typeof r.focus=="function"&&typeof r.blur=="function"&&typeof r.show=="function"&&typeof r.hide=="function"}n.isToolsView=t})(Tn||(Tn={}));(function(n){class t extends Bi{static getDefaults(){return this.defaults}static config(i){this.defaults=this.getOptions(i)}static getOptions(i){return Cn(Ki(this.getDefaults()),i)}get graph(){return this.cellView.graph}get cell(){return this.cellView.cell}get name(){return this.options.name}get[Symbol.toStringTag](){return t.toStringTag}constructor(i={}){super(),this.visible=!0,this.options=this.getOptions(i),this.container=Bi.createElement(this.options.tagName||"g",this.options.isSVGElement!==!1),je(this.container,this.prefixClassName("cell-tool")),typeof this.options.className=="string"&&je(this.container,this.options.className),this.init()}init(){}getOptions(i){return this.constructor.getOptions(i)}delegateEvents(){return this.options.events&&super.delegateEvents(this.options.events),this}config(i,r){return this.cellView=i,this.parent=r,this.stamp(this.container),this.cell.isEdge()?je(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&je(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}render(){this.empty();const i=this.options.markup;if(i){const r=Mi.parseJSONMarkup(i);this.container.appendChild(r.fragment),this.childNodes=r.selectors}return this.onRender(),this}onRender(){}update(){return this}stamp(i){i&&i.setAttribute("data-cell-id",this.cellView.cell.id)}show(){return this.container.style.display="",this.visible=!0,this}hide(){return this.container.style.display="none",this.visible=!1,this}isVisible(){return this.visible}focus(){const i=this.options.focusOpacity;return i!=null&&Number.isFinite(i)&&(this.container.style.opacity=`${i}`),this.parent.focus(this),this}blur(){return this.container.style.opacity="",this.parent.blur(this),this}guard(i){return this.graph==null||this.cellView==null?!0:this.graph.view.guard(i,this.cellView)}}t.defaults={isSVGElement:!0,tagName:"g"},n.ToolItem=t,function(e){let i=0;function r(s){return s?ZL(s):(i+=1,`CustomTool${i}`)}function o(s){const a=KL(r(s.name),this);return a.config(s),a}e.define=o}(t=n.ToolItem||(n.ToolItem={})),function(e){e.toStringTag=`X6.${e.name}`;function i(r){if(r==null)return!1;if(r instanceof e)return!0;const o=r[Symbol.toStringTag],s=r;return(o==null||o===e.toStringTag)&&s.graph!=null&&s.cell!=null&&typeof s.config=="function"&&typeof s.update=="function"&&typeof s.focus=="function"&&typeof s.blur=="function"&&typeof s.show=="function"&&typeof s.hide=="function"&&typeof s.isVisible=="function"}e.isToolItem=i}(t=n.ToolItem||(n.ToolItem={}))})(Tn||(Tn={}));const U0t=n=>n;function tN(n,t){return t===0?"0%":`${Math.round(n/t*100)}%`}function pX(n){return(e,i,r,o)=>i.isEdgeElement(r)?Y0t(n,e,i,r,o):X0t(n,e,i,r,o)}function X0t(n,t,e,i,r){const o=e.cell,s=o.getAngle(),a=e.getUnrotatedBBoxOfElement(i),l=o.getBBox().getCenter(),h=tt.create(r).rotate(s,l);let u=h.x-a.x,d=h.y-a.y;return n&&(u=tN(u,a.width),d=tN(d,a.height)),t.anchor={name:"topLeft",args:{dx:u,dy:d,rotate:!0}},t}function Y0t(n,t,e,i,r){const o=e.getConnection();if(!o)return t;const s=o.closestPointLength(r);if(n){const a=o.length();t.anchor={name:"ratio",args:{ratio:s/a}}}else t.anchor={name:"length",args:{length:s}};return t}const K0t=pX(!0),q0t=pX(!1),Z0t=Object.freeze(Object.defineProperty({__proto__:null,noop:U0t,pinAbsolute:q0t,pinRelative:K0t},Symbol.toStringTag,{value:"Module"}));var rP;(function(n){n.presets=Z0t,n.registry=yn.create({type:"connection strategy"}),n.registry.register(n.presets,!0)})(rP||(rP={}));function vX(n,t,e,i){return Qt(rP.presets.pinRelative,this.graph,{},t,e,n,this.cell,i,{}).anchor}function mX(n,t){return t?n.cell.getBBox():n.cell.isEdge()?n.getConnection().bbox():n.getUnrotatedBBoxOfElement(n.container)}class tu extends Tn.ToolItem{onRender(){je(this.container,this.prefixClassName("cell-tool-button")),this.update()}update(){return this.updatePosition(),this}updatePosition(){const e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Pg(this.container,e,{absolute:!0})}getNodeMatrix(){const t=this.cellView,e=this.options;let{x:i=0,y:r=0}=e;const{offset:o,useCellGeometry:s,rotate:a}=e;let l=mX(t,s);const h=t.cell.getAngle();a||(l=l.bbox(h));let u=0,d=0;typeof o=="number"?(u=o,d=o):typeof o=="object"&&(u=o.x,d=o.y),i=Gs(i,l.width),r=Gs(r,l.height);let c=zn().translate(l.x+l.width/2,l.y+l.height/2);return a&&(c=c.rotate(h)),c=c.translate(i+u-l.width/2,r+d-l.height/2),c}getEdgeMatrix(){const t=this.cellView,e=this.options,{offset:i=0,distance:r=0,rotate:o}=e;let s,a,l;const h=Gs(r,1);h>=0&&h<=1?s=t.getTangentAtRatio(h):s=t.getTangentAtLength(h),s?(a=s.start,l=s.vector().vectorAngle(new tt(1,0))||0):(a=t.getConnection().start,l=0);let u=zn().translate(a.x,a.y).rotate(l);return typeof i=="object"?u=u.translate(i.x||0,i.y||0):u=u.translate(0,i),o||(u=u.rotate(-l)),u}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.options.onClick;typeof e=="function"&&Qt(e,this.cellView,{e:t,view:this.cellView,cell:this.cellView.cell,btn:this})}}(function(n){n.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})})(tu||(tu={}));(function(n){n.Remove=n.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick({view:t,btn:e}){e.parent.remove(),t.cell.remove({ui:!0,toolId:e.cid})}})})(tu||(tu={}));var J0t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class ww extends Tn.ToolItem{onRender(){if(je(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){const t=this.options.attrs,{class:e}=t,i=J0t(t,["class"]);mi(this.container,lm(i)),e&&je(this.container,e)}this.update()}update(){const t=this.cellView,e=this.options,{useCellGeometry:i,rotate:r}=e,o=lc(e.padding);let s=mX(t,i).moveAndExpand({x:-o.left,y:-o.top,width:o.left+o.right,height:o.top+o.bottom});const a=t.cell;if(a.isNode()){const l=a.getAngle();if(l)if(r){const h=a.getBBox().getCenter();JB(this.container,l,h.x,h.y,{absolute:!0})}else s=s.bbox(l)}return mi(this.container,s.toJSON()),this}}(function(n){n.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})})(ww||(ww={}));class fm extends Tn.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}onRender(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}update(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach(e=>{this.stopHandleListening(e),e.remove()})}renderHandles(){const t=this.vertices;for(let e=0,i=t.length;e<i;e+=1){const r=t[e],o=this.options.createHandle,s=this.options.processHandle,a=o({index:e,graph:this.graph,guard:l=>this.guard(l),attrs:this.options.attrs||{}});s&&s(a),a.updatePosition(r.x,r.y),this.stamp(a.container),this.container.appendChild(a.container),this.handles.push(a),this.startHandleListening(a)}}updateHandles(){const t=this.vertices;for(let e=0,i=t.length;e<i;e+=1){const r=t[e],o=this.handles[e];o&&o.updatePosition(r.x,r.y)}}updatePath(){const t=this.childNodes.connection;t&&t.setAttribute("d",this.cellView.getConnectionPathData())}startHandleListening(t){const e=this.cellView;e.can("vertexMovable")&&(t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.on("remove",this.onHandleRemove,this)}stopHandleListening(t){const e=this.cellView;e.can("vertexMovable")&&(t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)),e.can("vertexDeletable")&&t.off("remove",this.onHandleRemove,this)}getNeighborPoints(t){const e=this.cellView,i=this.vertices,r=t>0?i[t-1]:e.sourceAnchor,o=t<i.length-1?i[t+1]:e.targetAnchor;return{prev:tt.create(r),next:tt.create(o)}}getMouseEventArgs(t){const e=this.normalizeEvent(t),{x:i,y:r}=this.graph.snapToGrid(e.clientX,e.clientY);return{e,x:i,y:r}}onHandleChange({e:t}){this.focus();const e=this.cellView;if(e.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){const{e:i,x:r,y:o}=this.getMouseEventArgs(t);this.eventData(i,{start:{x:r,y:o}}),e.notifyMouseDown(i,r,o)}}onHandleChanging({handle:t,e}){const i=this.cellView,r=t.options.index,{e:o,x:s,y:a}=this.getMouseEventArgs(e),l={x:s,y:a};this.snapVertex(l,r),i.cell.setVertexAt(r,l,{ui:!0,toolId:this.cid}),t.updatePosition(l.x,l.y),this.options.stopPropagation||i.notifyMouseMove(o,s,a)}stopBatch(t){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),t&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}onHandleChanged({e:t}){const e=this.options,i=this.cellView;if(e.addable&&this.updatePath(),!e.removeRedundancies){this.stopBatch(this.eventData(t).vertexAdded);return}i.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(t).vertexAdded);const{e:o,x:s,y:a}=this.getMouseEventArgs(t);if(!this.options.stopPropagation){i.notifyMouseUp(o,s,a);const{start:l}=this.eventData(o);if(l){const{x:h,y:u}=l;h===s&&u===a&&i.onClick(o,s,a)}}i.checkMouseleave(o),e.onChanged&&e.onChanged({edge:i.cell,edgeView:i})}snapVertex(t,e){const i=this.options.snapRadius||0;if(i>0){const r=this.getNeighborPoints(e),o=r.prev,s=r.next;Math.abs(t.x-o.x)<i?t.x=o.x:Math.abs(t.x-s.x)<i&&(t.x=s.x),Math.abs(t.y-o.y)<i?t.y=r.prev.y:Math.abs(t.y-s.y)<i&&(t.y=s.y)}}onHandleRemove({handle:t,e}){if(this.options.removable){const i=t.options.index,r=this.cellView;r.cell.removeVertexAt(i,{ui:!0}),this.options.addable&&this.updatePath(),r.checkMouseleave(this.normalizeEvent(e))}}allowAddVertex(t){const e=this.guard(t),i=this.options.addable&&this.cellView.can("vertexAddable"),r=this.options.modifiers?kg.isMatch(t,this.options.modifiers):!0;return!e&&i&&r}onPathMouseDown(t){const e=this.cellView;if(!this.allowAddVertex(t))return;t.stopPropagation(),t.preventDefault();const i=this.normalizeEvent(t),r=this.graph.snapToGrid(i.clientX,i.clientY).toJSON();e.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});const o=e.getVertexIndex(r.x,r.y);this.snapVertex(r,o),e.cell.insertVertex(r,o,{ui:!0,toolId:this.cid}),this.render();const s=this.handles[o];this.eventData(i,{vertexAdded:!0}),s.onMouseDown(i)}onRemove(){this.resetHandles()}}(function(n){class t extends Bi{get graph(){return this.options.graph}constructor(i){super(),this.options=i,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"})}render(){this.container=Bi.createElement("circle",!0);const i=this.options.attrs;if(typeof i=="function"){const r=n.getDefaults();this.setAttrs(Object.assign(Object.assign({},r.attrs),i(this)))}else this.setAttrs(i);this.addClass(this.prefixClassName("edge-tool-vertex"))}updatePosition(i,r){this.setAttrs({cx:i,cy:r})}onMouseDown(i){this.options.guard(i)||(i.stopPropagation(),i.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},i.data),this.emit("change",{e:i,handle:this}))}onMouseMove(i){this.emit("changing",{e:i,handle:this})}onMouseUp(i){this.emit("changed",{e:i,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}onDoubleClick(i){this.emit("remove",{e:i,handle:this})}}n.Handle=t})(fm||(fm={}));(function(n){const t=Ks.prefix("edge-tool-vertex-path");n.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:e=>new n.Handle(e),markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:{[`mousedown .${t}`]:"onPathMouseDown",[`touchstart .${t}`]:"onPathMouseDown"}})})(fm||(fm={}));class gm extends Tn.ToolItem{constructor(){super(...arguments),this.handles=[]}get vertices(){return this.cellView.cell.getVertices()}update(){return this.render(),this}onRender(){je(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();const t=this.cellView,e=[...this.vertices];e.unshift(t.sourcePoint),e.push(t.targetPoint);for(let i=0,r=e.length;i<r-1;i+=1){const o=e[i],s=e[i+1],a=this.renderHandle(o,s,i);this.stamp(a.container),this.handles.push(a)}return this}renderHandle(t,e,i){const r=this.options.createHandle({index:i,graph:this.graph,guard:o=>this.guard(o),attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(r),this.updateHandle(r,t,e),this.container.appendChild(r.container),this.startHandleListening(r),r}startHandleListening(t){t.on("change",this.onHandleChange,this),t.on("changing",this.onHandleChanging,this),t.on("changed",this.onHandleChanged,this)}stopHandleListening(t){t.off("change",this.onHandleChange,this),t.off("changing",this.onHandleChanging,this),t.off("changed",this.onHandleChanged,this)}resetHandles(){const t=this.handles;this.handles=[],t&&t.forEach(e=>{this.stopHandleListening(e),e.remove()})}shiftHandleIndexes(t){const e=this.handles;for(let i=0,r=e.length;i<r;i+=1)e[i].options.index+=t}resetAnchor(t,e){const i=this.cellView.cell,r={ui:!0,toolId:this.cid};e?i.prop([t,"anchor"],e,r):i.removeProp([t,"anchor"],r)}snapHandle(t,e,i){const r=t.options.axis,o=t.options.index,l=this.cellView.cell.getVertices(),h=l[o-2]||i.sourceAnchor,u=l[o+1]||i.targetAnchor,d=this.options.snapRadius;return Math.abs(e[r]-h[r])<d?e[r]=h[r]:Math.abs(e[r]-u[r])<d&&(e[r]=u[r]),e}onHandleChanging({handle:t,e}){const i=this.graph,r=this.options,o=this.cellView,s=r.anchor,a=t.options.axis,l=t.options.index-1,h=this.getEventData(e),u=this.normalizeEvent(e),d=i.snapToGrid(u.clientX,u.clientY),c=this.snapHandle(t,d.clone(),h),f=Ki(this.vertices);let g=f[l],p=f[l+1];const v=o.sourceView,m=o.sourceBBox;let y=!1,b=!1;if(g?l===0?m.containsPoint(g)?(f.shift(),this.shiftHandleIndexes(-1),y=!0):(g[a]=c[a],b=!0):g[a]=c[a]:(g=o.sourceAnchor.toJSON(),g[a]=c[a],m.containsPoint(g)?y=!0:(f.unshift(g),this.shiftHandleIndexes(1),b=!0)),typeof s=="function"&&v){if(y){const S=h.sourceAnchor.clone();S[a]=c[a];const A=Qt(s,o,S,v,o.sourceMagnet||v.container,"source",o,this);this.resetAnchor("source",A)}b&&this.resetAnchor("source",h.sourceAnchorDef)}const _=o.targetView,w=o.targetBBox;let C=!1,x=!1;if(p?l===f.length-2?w.containsPoint(p)?(f.pop(),C=!0):(p[a]=c[a],x=!0):p[a]=c[a]:(p=o.targetAnchor.toJSON(),p[a]=c[a],w.containsPoint(p)?C=!0:(f.push(p),x=!0)),typeof s=="function"&&_){if(C){const S=h.targetAnchor.clone();S[a]=c[a];const A=Qt(s,o,S,_,o.targetMagnet||_.container,"target",o,this);this.resetAnchor("target",A)}x&&this.resetAnchor("target",h.targetAnchorDef)}tt.equalPoints(f,this.vertices)||this.cellView.cell.setVertices(f,{ui:!0,toolId:this.cid}),this.updateHandle(t,g,p,0),r.stopPropagation||o.notifyMouseMove(u,d.x,d.y)}onHandleChange({handle:t,e}){const i=this.options,r=this.handles,o=this.cellView,s=t.options.index;if(Array.isArray(r)){for(let a=0,l=r.length;a<l;a+=1)a!==s&&r[a].hide();if(this.focus(),this.setEventData(e,{sourceAnchor:o.sourceAnchor.clone(),targetAnchor:o.targetAnchor.clone(),sourceAnchorDef:Ki(this.cell.prop(["source","anchor"])),targetAnchorDef:Ki(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!i.stopPropagation){const a=this.normalizeEvent(e),l=this.graph.snapToGrid(a.clientX,a.clientY);o.notifyMouseDown(a,l.x,l.y)}}}onHandleChanged({e:t}){const e=this.options,i=this.cellView;e.removeRedundancies&&i.removeRedundantLinearVertices({ui:!0,toolId:this.cid});const r=this.normalizeEvent(t),o=this.graph.snapToGrid(r.clientX,r.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),e.stopPropagation||i.notifyMouseUp(r,o.x,o.y),i.checkMouseleave(r),e.onChanged&&e.onChanged({edge:i.cell,edgeView:i})}updateHandle(t,e,i,r=0){const o=this.options.precision||0,s=Math.abs(e.x-i.x)<o,a=Math.abs(e.y-i.y)<o;if(s||a){const l=new It(e,i);if(l.length()<this.options.threshold)t.hide();else{const u=l.getCenter(),d=s?"x":"y";u[d]+=r||0;const c=l.vector().vectorAngle(new tt(1,0));t.updatePosition(u.x,u.y,c,this.cellView),t.show(),t.options.axis=d}}else t.hide()}onRemove(){this.resetHandles()}}(function(n){class t extends Bi{constructor(i){super(),this.options=i,this.render(),this.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"})}render(){this.container=Bi.createElement("rect",!0);const i=this.options.attrs;if(typeof i=="function"){const r=n.getDefaults();this.setAttrs(Object.assign(Object.assign({},r.attrs),i(this)))}else this.setAttrs(i);this.addClass(this.prefixClassName("edge-tool-segment"))}updatePosition(i,r,o,s){const a=s.getClosestPoint(new tt(i,r))||new tt(i,r);let l=zn().translate(a.x,a.y);if(a.equals({x:i,y:r}))l=l.rotate(o);else{let u=new It(i,r,a.x,a.y).vector().vectorAngle(new tt(1,0));u!==0&&(u+=90),l=l.rotate(u)}this.setAttrs({transform:bp(l),cursor:o%180===0?"row-resize":"col-resize"})}onMouseDown(i){this.options.guard(i)||(this.trigger("change",{e:i,handle:this}),i.stopPropagation(),i.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},i.data))}onMouseMove(i){this.emit("changing",{e:i,handle:this})}onMouseUp(i){this.emit("changed",{e:i,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}show(){this.container.style.display=""}hide(){this.container.style.display="none"}}n.Handle=t})(gm||(gm={}));(function(n){n.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:t=>new n.Handle(t),anchor:vX})})(gm||(gm={}));class xw extends Tn.ToolItem{get type(){return this.options.type}onRender(){je(this.container,this.prefixClassName(`edge-tool-${this.type}-anchor`)),this.toggleArea(!1),this.update()}update(){const t=this.type;return this.cellView.getTerminalView(t)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}updateAnchor(){const t=this.childNodes;if(!t)return;const e=t.anchor;if(!e)return;const i=this.type,r=this.cellView,o=this.options,s=r.getTerminalAnchor(i),a=r.cell.prop([i,"anchor"]);e.setAttribute("transform",`translate(${s.x}, ${s.y})`);const l=a?o.customAnchorAttrs:o.defaultAnchorAttrs;l&&Object.keys(l).forEach(h=>{e.setAttribute(h,l[h])})}updateArea(){const t=this.childNodes;if(!t)return;const e=t.area;if(!e)return;const i=this.type,r=this.cellView,o=r.getTerminalView(i);if(o){const s=o.cell,a=r.getTerminalMagnet(i);let l=this.options.areaPadding||0;Number.isFinite(l)||(l=0);let h,u,d;o.isEdgeElement(a)?(h=o.getBBox(),u=0,d=h.getCenter()):(h=o.getUnrotatedBBoxOfElement(a),u=s.getAngle(),d=h.getCenter(),u&&d.rotate(-u,s.getBBox().getCenter())),h.inflate(l),mi(e,{x:-h.width/2,y:-h.height/2,width:h.width,height:h.height,transform:`translate(${d.x}, ${d.y}) rotate(${u})`})}}toggleArea(t){if(this.childNodes){const e=this.childNodes.area;e&&(e.style.display=t?"":"none")}}onMouseDown(t){this.guard(t)||(t.stopPropagation(),t.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}resetAnchor(t){const e=this.type,i=this.cell;t?i.prop([e,"anchor"],t,{rewrite:!0,ui:!0,toolId:this.cid}):i.removeProp([e,"anchor"],{ui:!0,toolId:this.cid})}onMouseMove(t){const e=this.type,i=this.cellView,r=i.getTerminalView(e);if(r==null)return;const o=this.normalizeEvent(t),s=r.cell,a=i.getTerminalMagnet(e);let l=this.graph.coord.clientToLocalPoint(o.clientX,o.clientY);const h=this.options.snap;if(typeof h=="function"){const c=Qt(h,i,l,r,a,e,i,this);l=tt.create(c)}if(this.options.restrictArea)if(r.isEdgeElement(a)){const c=r.getClosestPoint(l);c&&(l=c)}else{const c=r.getUnrotatedBBoxOfElement(a),f=s.getAngle(),g=s.getBBox().getCenter(),p=l.clone().rotate(f,g);c.containsPoint(p)||(l=c.getNearestPointToPoint(p).rotate(-f,g))}let u;const d=this.options.anchor;typeof d=="function"&&(u=Qt(d,i,l,r,a,e,i,this)),this.resetAnchor(u),this.update()}onMouseUp(t){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);const e=this.cellView;this.options.removeRedundancies&&e.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}onDblClick(){const t=this.options.resetAnchor;t&&this.resetAnchor(t===!0?void 0:t),this.update()}}(function(n){n.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:vX,snap(t,e,i,r,o,s){const a=s.options.snapRadius||0,l=r==="source",h=l?0:-1,u=this.cell.getVertexAt(h)||this.getTerminalAnchor(l?"target":"source");return u&&(Math.abs(u.x-t.x)<a&&(t.x=u.x),Math.abs(u.y-t.y)<a&&(t.y=u.y)),t}})})(xw||(xw={}));const Q0t=xw.define({name:"source-anchor",type:"source"}),tmt=xw.define({name:"target-anchor",type:"target"});var emt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class Sw extends Tn.ToolItem{get type(){return this.options.type}get ratio(){return this.options.ratio}init(){if(this.options.attrs){const t=this.options.attrs,{class:e}=t,i=emt(t,["class"]);this.setAttrs(i,this.container),e&&je(this.container,e)}}onRender(){je(this.container,this.prefixClassName(`edge-tool-${this.type}-arrowhead`)),this.update()}update(){const t=this.ratio,e=this.cellView,i=e.getTangentAtRatio(t),r=i?i.start:e.getPointAtRatio(t),o=i&&i.vector().vectorAngle(new tt(1,0))||0;if(!r)return this;const s=zn().translate(r.x,r.y).rotate(o);return Pg(this.container,s,{absolute:!0}),this}onMouseDown(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const e=this.cellView;if(e.can("arrowheadMovable")){e.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});const i=this.graph.snapToGrid(t.clientX,t.clientY),r=e.prepareArrowheadDragging(this.type,{x:i.x,y:i.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(t,r),this.delegateDocumentEvents(this.options.documentEvents,t.data),e.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}onMouseMove(t){const e=this.normalizeEvent(t),i=this.graph.snapToGrid(e.clientX,e.clientY);this.cellView.onMouseMove(e,i.x,i.y),this.update()}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),i=this.cellView,r=this.graph.snapToGrid(e.clientX,e.clientY);i.onMouseUp(e,r.x,r.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",i.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}(function(n){n.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})})(Sw||(Sw={}));const imt=Sw.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),nmt=Sw.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}});class Ig extends Tn.ToolItem{constructor(){super(...arguments),this.labelIndex=-1,this.distance=.5,this.dblClick=this.onCellDblClick.bind(this)}onRender(){const t=this.cellView;t&&t.on("cell:dblclick",this.dblClick)}createElement(){const t=[this.prefixClassName(`${this.cell.isEdge()?"edge":"node"}-tool-editor`),this.prefixClassName("cell-tool-editor")];this.editor=Tn.createElement("div",!1),this.addClass(t,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}removeElement(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}updateEditor(){const{cell:t,editor:e}=this;if(!e)return;const{style:i}=e;t.isNode()?this.updateNodeEditorTransform():t.isEdge()&&this.updateEdgeEditorTransform();const{attrs:r}=this.options;i.fontSize=`${r.fontSize}px`,i.fontFamily=r.fontFamily,i.color=r.color,i.backgroundColor=r.backgroundColor;const o=this.getCellText()||"";return e.innerText=o,this.setCellText(""),this}updateNodeEditorTransform(){const{graph:t,cell:e,editor:i}=this;if(!i)return;let r=tt.create(),o=20,s="",{x:a,y:l}=this.options;const{width:h,height:u}=this.options;if(typeof a<"u"&&typeof l<"u"){const f=e.getBBox();a=Gs(a,f.width),l=Gs(l,f.height),r=f.topLeft.translate(a,l),o=f.width-a*2}else{const f=e.getBBox();r=f.center,o=f.width-4,s="translate(-50%, -50%)"}const d=t.scale(),{style:c}=i;r=t.localToGraph(r),c.left=`${r.x}px`,c.top=`${r.y}px`,c.transform=`scale(${d.sx}, ${d.sy}) ${s}`,c.minWidth=`${o}px`,typeof h=="number"&&(c.width=`${h}px`),typeof u=="number"&&(c.height=`${u}px`)}updateEdgeEditorTransform(){if(!this.event)return;const{graph:t,editor:e}=this;if(!e)return;let i=tt.create(),r=20;const{style:o}=e,s=this.event.target,a=s.parentElement;if(a&&py(a,this.prefixClassName("edge-label"))){const u=a.getAttribute("data-index")||"0";this.labelIndex=parseInt(u,10);const d=a.getAttribute("transform"),{translation:c}=kS(d);i=new tt(c.tx,c.ty),r=oi.getBBox(s).width}else{if(!this.options.labelAddable)return this;i=t.clientToLocal(tt.create(this.event.clientX,this.event.clientY));const d=this.cellView.path.closestPointLength(i);this.distance=d,this.labelIndex=-1}i=t.localToGraph(i);const h=t.scale();o.left=`${i.x}px`,o.top=`${i.y}px`,o.minWidth=`${r}px`,o.transform=`scale(${h.sx}, ${h.sy}) translate(-50%, -50%)`}onDocumentMouseUp(t){if(this.editor&&t.target!==this.editor){const e=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(e!==""?e:null),this.removeElement()}}onCellDblClick({e:t}){this.editor||(t.stopPropagation(),this.removeElement(),this.event=t,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}onMouseDown(t){t.stopPropagation()}autoFocus(){setTimeout(()=>{this.editor&&(this.editor.focus(),this.selectText())})}selectText(){if(window.getSelection&&this.editor){const t=document.createRange(),e=window.getSelection();t.selectNodeContents(this.editor),e.removeAllRanges(),e.addRange(t)}}getCellText(){const{getText:t}=this.options;if(typeof t=="function")return Qt(t,this.cellView,{cell:this.cell,index:this.labelIndex});if(typeof t=="string"){if(this.cell.isNode())return this.cell.attr(t);if(this.cell.isEdge()&&this.labelIndex!==-1)return this.cell.prop(`labels/${this.labelIndex}/attrs/${t}`)}}setCellText(t){const e=this.options.setText;if(typeof e=="function"){Qt(e,this.cellView,{cell:this.cell,value:t,index:this.labelIndex,distance:this.distance});return}if(typeof e=="string"){if(this.cell.isNode()){t!==null&&this.cell.attr(e,t);return}if(this.cell.isEdge()){const i=this.cell;if(this.labelIndex===-1){if(t){const r={position:{distance:this.distance},attrs:{}};yp(r,`attrs/${e}`,t),i.appendLabel(r)}}else t!==null?i.prop(`labels/${this.labelIndex}/attrs/${e}`,t):typeof this.labelIndex=="number"&&i.removeLabelAt(this.labelIndex)}}}onRemove(){const t=this.cellView;t&&t.off("cell:dblclick",this.dblClick),this.removeElement()}}(function(n){n.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})})(Ig||(Ig={}));(function(n){n.NodeEditor=n.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),n.EdgeEditor=n.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})})(Ig||(Ig={}));var yX=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e},Hg;(function(n){n.presets={boundary:ww,button:tu,"button-remove":tu.Remove,"node-editor":Ig.NodeEditor},n.registry=yn.create({type:"node tool",process(t,e){if(typeof e=="function")return e;let i=Tn.ToolItem;const{inherit:r}=e,o=yX(e,["inherit"]);if(r){const s=this.get(r);s==null?this.onNotFound(r,"inherited"):i=s}return o.name==null&&(o.name=t),i.define.call(i,o)}}),n.registry.register(n.presets,!0)})(Hg||(Hg={}));var Fg;(function(n){n.presets={boundary:ww,vertices:fm,segments:gm,button:tu,"button-remove":tu.Remove,"source-anchor":Q0t,"target-anchor":tmt,"source-arrowhead":imt,"target-arrowhead":nmt,"edge-editor":Ig.EdgeEditor},n.registry=yn.create({type:"edge tool",process(t,e){if(typeof e=="function")return e;let i=Tn.ToolItem;const{inherit:r}=e,o=yX(e,["inherit"]);if(r){const s=this.get(r);s==null?this.onNotFound(r,"inherited"):i=s}return o.name==null&&(o.name=t),i.define.call(i,o)}}),n.registry.register(n.presets,!0)})(Fg||(Fg={}));const rmt=Jl("center"),omt=Jl("topCenter"),smt=Jl("bottomCenter"),amt=Jl("leftMiddle"),lmt=Jl("rightMiddle"),hmt=Jl("topLeft"),umt=Jl("topRight"),dmt=Jl("bottomLeft"),cmt=Jl("bottomRight");function Jl(n){return function(t,e,i,r={}){const o=r.rotate?t.getUnrotatedBBoxOfElement(e):t.getBBoxOfElement(e),s=o[n];s.x+=Gs(r.dx,o.width),s.y+=Gs(r.dy,o.height);const a=t.cell;return r.rotate?s.rotate(-a.getAngle(),a.getBBox().getCenter()):s}}function DS(n){return function(t,e,i,r){if(i instanceof Element){const o=this.graph.findViewByElem(i);let s;if(o)if(o.isEdgeElement(i)){const a=r.fixedAt!=null?r.fixedAt:"50%";s=bX(o,a)}else s=o.getBBoxOfElement(i).getCenter();else s=new tt;return n.call(this,t,e,s,r)}return n.apply(this,arguments)}}function bX(n,t){const e=$l(t),i=typeof t=="string"?parseFloat(t):t;return e?n.getPointAtRatio(i/100):n.getPointAtLength(i)}const fmt=function(n,t,e,i){const r=vi.normalize(n.cell.getAngle()),o=n.getBBoxOfElement(t),s=o.getCenter(),a=o.getTopLeft(),l=o.getBottomRight();let h=i.padding;if(Number.isFinite(h)||(h=0),a.y+h<=e.y&&e.y<=l.y-h){const u=e.y-s.y;s.x+=r===0||r===180?0:u*1/Math.tan(vi.toRad(r)),s.y+=u}else if(a.x+h<=e.x&&e.x<=l.x-h){const u=e.x-s.x;s.y+=r===90||r===270?0:u*Math.tan(vi.toRad(r)),s.x+=u}return s},gmt=DS(fmt),pmt=function(n,t,e,i,r){const o=n.cell.getConnectionPoint(this.cell,r);return(i.dx||i.dy)&&o.translate(i.dx||0,i.dy||0),o},vmt=function(n,t,e,i){let r,o=0,s;const a=n.cell;i.rotate?(r=n.getUnrotatedBBoxOfElement(t),s=a.getBBox().getCenter(),o=a.getAngle()):r=n.getBBoxOfElement(t);const l=i.padding;l!=null&&Number.isFinite(l)&&r.inflate(l),i.rotate&&e.rotate(o,s);const h=r.getNearestSideToPoint(e);let u;switch(h){case"left":u=r.getLeftMiddle();break;case"right":u=r.getRightMiddle();break;case"top":u=r.getTopCenter();break;case"bottom":u=r.getBottomCenter();break}const d=i.direction;return d==="H"?(h==="top"||h==="bottom")&&(e.x<=r.x+r.width?u=r.getLeftMiddle():u=r.getRightMiddle()):d==="V"&&(e.y<=r.y+r.height?u=r.getTopCenter():u=r.getBottomCenter()),i.rotate?u.rotate(-o,s):u},mmt=DS(vmt),ymt=Object.freeze(Object.defineProperty({__proto__:null,bottom:smt,bottomLeft:dmt,bottomRight:cmt,center:rmt,left:amt,midSide:mmt,nodeCenter:pmt,orth:gmt,right:lmt,top:omt,topLeft:hmt,topRight:umt},Symbol.toStringTag,{value:"Module"}));var zg;(function(n){n.presets=ymt,n.registry=yn.create({type:"node endpoint"}),n.registry.register(n.presets,!0)})(zg||(zg={}));const bmt=function(n,t,e,i){let r=i.ratio!=null?i.ratio:.5;return r>1&&(r/=100),n.getPointAtRatio(r)},_mt=function(n,t,e,i){const r=i.length!=null?i.length:20;return n.getPointAtLength(r)},_X=function(n,t,e,i){const r=n.getClosestPoint(e);return r??new tt},Cmt=DS(_X),wmt=function(n,t,e,i){const o=n.getConnection(),s=n.getConnectionSubdivisions(),a=new It(e.clone().translate(0,1e6),e.clone().translate(0,-1e6)),l=new It(e.clone().translate(1e6,0),e.clone().translate(-1e6,0)),h=a.intersect(o,{segmentSubdivisions:s}),u=l.intersect(o,{segmentSubdivisions:s}),d=[];return h&&d.push(...h),u&&d.push(...u),d.length>0?e.closest(d):i.fallbackAt!=null?bX(n,i.fallbackAt):Qt(_X,this,n,t,e,i)},xmt=DS(wmt),Smt=Object.freeze(Object.defineProperty({__proto__:null,closest:Cmt,length:_mt,orth:xmt,ratio:bmt},Symbol.toStringTag,{value:"Module"}));var Ng;(function(n){n.presets=Smt,n.registry=yn.create({type:"edge endpoint"}),n.registry.register(n.presets,!0)})(Ng||(Ng={}));function IS(n,t,e){let i;if(typeof e=="object"){if(Number.isFinite(e.y)){const o=new It(t,n),{start:s,end:a}=o.parallel(e.y);t=s,n=a}i=e.x}else i=e;if(i==null||!Number.isFinite(i))return n;const r=n.distance(t);return i===0&&r>0?n:n.move(t,-Math.min(i,r-1))}function Aw(n){const t=n.getAttribute("stroke-width");return t===null?0:parseFloat(t)||0}function Amt(n){if(n==null)return null;let t=n;do{let e=t.tagName;if(typeof e!="string")return null;if(e=e.toUpperCase(),e==="G")t=t.firstElementChild;else if(e==="TITLE")t=t.nextElementSibling;else break}while(t);return t}const CX=function(n,t,e,i){const r=t.getBBoxOfElement(e);i.stroked&&r.inflate(Aw(e)/2);const o=n.intersect(r),s=o&&o.length?n.start.closest(o):n.end;return IS(s,n.start,i.offset)},Tmt=function(n,t,e,i,r){const o=t.cell,s=o.isNode()?o.getAngle():0;if(s===0)return Qt(CX,this,n,t,e,i,r);const a=t.getUnrotatedBBoxOfElement(e);i.stroked&&a.inflate(Aw(e)/2);const l=a.getCenter(),h=n.clone().rotate(s,l),u=h.setLength(1e6).intersect(a),d=u&&u.length?h.start.closest(u).rotate(-s,l):n.end;return IS(d,n.start,i.offset)},Mmt=function(n,t,e,i){let r,o;const s=n.end,a=i.selector;if(typeof a=="string"?r=t.findOne(a):Array.isArray(a)?r=qL(e,a):r=Amt(e),!Zh(r)){if(r===e||!Zh(e))return s;r=e}const l=t.getShapeOfElement(r),h=t.getMatrixOfElement(r),u=t.getRootTranslatedMatrix(),d=t.getRootRotatedMatrix(),c=u.multiply(d).multiply(h),f=c.inverse(),g=oi.transformLine(n,f),p=g.start.clone(),v=t.getDataOfElement(r);if(i.insideout===!1){v.shapeBBox==null&&(v.shapeBBox=l.bbox());const _=v.shapeBBox;if(_!=null&&_.containsPoint(p))return s}i.extrapolate===!0&&g.setLength(1e6);let m;if(Ce.isPath(l)){const _=i.precision||2;v.segmentSubdivisions==null&&(v.segmentSubdivisions=l.getSegmentSubdivisions({precision:_})),m={precision:_,segmentSubdivisions:v.segmentSubdivisions},o=g.intersect(l,m)}else o=g.intersect(l);o?Array.isArray(o)&&(o=p.closest(o)):i.sticky===!0&&(Ct.isRectangle(l)?o=l.getNearestPointToPoint(p):Ys.isEllipse(l)?o=l.intersectsWithLineFromCenterToPoint(p):o=l.closestPoint(p,m));const y=o?oi.transformPoint(o,c):s;let b=i.offset||0;return i.stroked!==!1&&(typeof b=="object"?(b=Object.assign({},b),b.x==null&&(b.x=0),b.x+=Aw(r)/2):b+=Aw(r)/2),IS(y,n.start,b)};function Rmt(n,t,e=0){const{start:i,end:r}=n;let o,s,a,l;switch(t){case"left":l="x",o=r,s=i,a=-1;break;case"right":l="x",o=i,s=r,a=1;break;case"top":l="y",o=r,s=i,a=-1;break;case"bottom":l="y",o=i,s=r,a=1;break;default:return}i[l]<r[l]?o[l]=s[l]:s[l]=o[l],Number.isFinite(e)&&(o[l]+=a*e,s[l]+=a*e)}const Bmt=function(n,t,e,i){const{alignOffset:r,align:o}=i;return o&&Rmt(n,o,r),IS(n.end,n.start,i.offset)},Pmt=Object.freeze(Object.defineProperty({__proto__:null,anchor:Bmt,bbox:CX,boundary:Mmt,rect:Tmt},Symbol.toStringTag,{value:"Module"}));var Wg;(function(n){n.presets=Pmt,n.registry=yn.create({type:"connection point"}),n.registry.register(n.presets,!0)})(Wg||(Wg={}));const kmt=function(n){return[...n]},Emt=function(n,t,e){const i=t.side||"bottom",r=lc(t.padding||40),o=e.sourceBBox,s=e.targetBBox,a=o.getCenter(),l=s.getCenter();let h,u,d;switch(i){case"top":d=-1,h="y",u="height";break;case"left":d=-1,h="x",u="width";break;case"right":d=1,h="x",u="width";break;case"bottom":default:d=1,h="y",u="height";break}return a[h]+=d*(o[u]/2+r[i]),l[h]+=d*(s[u]/2+r[i]),d*(a[h]-l[h])>0?l[h]=a[h]:a[h]=l[h],[a.toJSON(),...n,l.toJSON()]};function zb(n){return new Ct(n.x,n.y,0,0)}function Tw(n={}){const t=lc(n.padding||20);return{x:-t.left,y:-t.top,width:t.left+t.right,height:t.top+t.bottom}}function wX(n,t={}){return n.sourceBBox.clone().moveAndExpand(Tw(t))}function xX(n,t={}){return n.targetBBox.clone().moveAndExpand(Tw(t))}function Lmt(n,t={}){return n.sourceAnchor?n.sourceAnchor:wX(n,t).getCenter()}function Omt(n,t={}){return n.targetAnchor?n.targetAnchor:xX(n,t).getCenter()}const SX=function(n,t,e){let i=wX(e,t),r=xX(e,t);const o=Lmt(e,t),s=Omt(e,t);i=i.union(zb(o)),r=r.union(zb(s));const a=n.map(u=>tt.create(u));a.unshift(o),a.push(s);let l=null;const h=[];for(let u=0,d=a.length-1;u<d;u+=1){let c=null;const f=a[u],g=a[u+1],p=Ho.getBearing(f,g)!=null;if(u===0)u+1===d?i.intersectsWithRect(r.clone().inflate(1))?c=Ho.insideNode(f,g,i,r):p||(c=Ho.nodeToNode(f,g,i,r)):i.containsPoint(g)?c=Ho.insideNode(f,g,i,zb(g).moveAndExpand(Tw(t))):p||(c=Ho.nodeToVertex(f,g,i));else if(u+1===d){const v=p&&Ho.getBearing(g,f)===l;r.containsPoint(f)||v?c=Ho.insideNode(f,g,zb(f).moveAndExpand(Tw(t)),r,l):p||(c=Ho.vertexToNode(f,g,r,l))}else p||(c=Ho.vertexToVertex(f,g,l));c?(h.push(...c.points),l=c.direction):l=Ho.getBearing(f,g),u+1<d&&h.push(g)}return h};var Ho;(function(n){const t={N:"S",S:"N",E:"W",W:"E"},e={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function i(d,c,f){let g=new tt(d.x,c.y);return f.containsPoint(g)&&(g=new tt(c.x,d.y)),g}function r(d,c){return d[c==="W"||c==="E"?"width":"height"]}n.getBBoxSize=r;function o(d,c){return d.x===c.x?d.y>c.y?"N":"S":d.y===c.y?d.x>c.x?"W":"E":null}n.getBearing=o;function s(d,c,f){const g=new tt(d.x,c.y),p=new tt(c.x,d.y),v=o(d,g),m=o(d,p),y=f?t[f]:null,b=v===f||v!==y&&(m===y||m!==f)?g:p;return{points:[b],direction:o(b,c)}}n.vertexToVertex=s;function a(d,c,f){const g=i(d,c,f);return{points:[g],direction:o(g,c)}}n.nodeToVertex=a;function l(d,c,f,g){const p=[new tt(d.x,c.y),new tt(c.x,d.y)],v=p.filter(b=>!f.containsPoint(b)),m=v.filter(b=>o(b,d)!==g);let y;if(m.length>0)return y=m.filter(b=>o(d,b)===g).pop(),y=y||m[0],{points:[y],direction:o(y,c)};{y=IQ(p,v)[0];const b=tt.create(c).move(y,-r(f,g)/2);return{points:[i(b,d,f),b],direction:o(b,c)}}}n.vertexToNode=l;function h(d,c,f,g){let p=a(c,d,g);const v=p.points[0];if(f.containsPoint(v)){p=a(d,c,f);const m=p.points[0];if(g.containsPoint(m)){const y=tt.create(d).move(m,-r(f,o(d,m))/2),b=tt.create(c).move(v,-r(g,o(c,v))/2),_=new It(y,b).getCenter(),w=a(d,_,f),C=s(_,c,w.direction);p.points=[w.points[0],C.points[0]],p.direction=C.direction}}return p}n.nodeToNode=h;function u(d,c,f,g,p){const v=f.union(g).inflate(1),m=v.getCenter(),y=m.distance(c)>m.distance(d),b=y?c:d,_=y?d:c;let w,C,x;p?(w=tt.fromPolar(v.width+v.height,e[p],b),w=v.getNearestPointToPoint(w).move(w,-1)):w=v.getNearestPointToPoint(b).move(b,1),C=i(w,_,v);let S;w.round().equals(C.round())?(C=tt.fromPolar(v.width+v.height,vi.toRad(w.theta(b))+Math.PI/2,_),C=v.getNearestPointToPoint(C).move(_,1).round(),x=i(w,C,v),S=y?[C,x,w]:[w,x,C]):S=y?[C,w]:[w,C];const A=o(y?w:C,c);return{points:S,direction:A}}n.insideNode=u})(Ho||(Ho={}));const Dmt={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost(){return Ah(this.step,this)},directions(){const n=Ah(this.step,this),t=Ah(this.cost,this);return[{cost:t,offsetX:n,offsetY:0},{cost:t,offsetX:-n,offsetY:0},{cost:t,offsetX:0,offsetY:n},{cost:t,offsetX:0,offsetY:-n}]},penalties(){const n=Ah(this.step,this);return{0:0,45:n/2,90:n/2}},paddingBox(){const n=Ah(this.step,this);return{x:-n,y:-n,width:2*n,height:2*n}},fallbackRouter:SX,draggingRouter:null,snapToGrid:!0};function Ah(n,t){return typeof n=="function"?n.call(t):n}function Imt(n){const t=Object.keys(n).reduce((e,i)=>{const r=e;return i==="fallbackRouter"||i==="draggingRouter"||i==="fallbackRoute"?r[i]=n[i]:r[i]=Ah(n[i],n),e},{});if(t.padding){const e=lc(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}return t.directions.forEach(e=>{const i=new tt(0,0),r=new tt(e.offsetX,e.offsetY);e.angle=vi.normalize(i.theta(r))}),t}const eN=1,iN=2;class Hmt{constructor(){this.items=[],this.hash={},this.values={}}add(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=eN,this.values[t]=e;const i=HQ(this.items,t,r=>this.values[r]);this.items.splice(i,0,t)}pop(){const t=this.items.shift();return t&&(this.hash[t]=iN),t}isOpen(t){return this.hash[t]===eN}isClose(t){return this.hash[t]===iN}isEmpty(){return this.items.length===0}}class Fmt{constructor(t){this.options=t,this.mapGridSize=100,this.map={}}build(t,e){const i=this.options,r=i.excludeTerminals.reduce((h,u)=>{const d=e[u];if(d){const c=t.getCell(d.cell);c&&h.push(c)}return h},[]);let o=[];const s=t.getCell(e.getSourceCellId());s&&(o=YD(o,s.getAncestors().map(h=>h.id)));const a=t.getCell(e.getTargetCellId());a&&(o=YD(o,a.getAncestors().map(h=>h.id)));const l=this.mapGridSize;return t.getNodes().reduce((h,u)=>{const d=r.some(v=>v.id===u.id),c=u.shape?i.excludeShapes.includes(u.shape):!1,f=i.excludeNodes.some(v=>typeof v=="string"?u.id===v:v===u),g=o.includes(u.id),p=c||d||f||g;if(u.isVisible()&&!p){const v=u.getBBox().moveAndExpand(i.paddingBox),m=v.getOrigin().snapToGrid(l),y=v.getCorner().snapToGrid(l);for(let b=m.x;b<=y.x;b+=l)for(let _=m.y;_<=y.y;_+=l){const w=new tt(b,_).toString();h[w]==null&&(h[w]=[]),h[w].push(v)}}return h},this.map),this}isAccessible(t){const e=t.clone().snapToGrid(this.mapGridSize).toString(),i=this.map[e];return i?i.every(r=>!r.containsPoint(t)):!0}}function AX(n,t){const e=n.sourceBBox.clone();return t&&t.paddingBox?e.moveAndExpand(t.paddingBox):e}function TX(n,t){const e=n.targetBBox.clone();return t&&t.paddingBox?e.moveAndExpand(t.paddingBox):e}function MX(n,t){return n.sourceAnchor?n.sourceAnchor:AX(n,t).getCenter()}function zmt(n,t){return n.targetAnchor?n.targetAnchor:TX(n,t).getCenter()}function oR(n,t,e,i,r){const o=360/e,s=n.theta(Nmt(n,t,i,r)),a=vi.normalize(s+o/2);return o*Math.floor(a/o)}function Nmt(n,t,e,i){const r=i.step,o=t.x-n.x,s=t.y-n.y,a=o/e.x,l=s/e.y,h=a*r,u=l*r;return new tt(n.x+h,n.y+u)}function nN(n,t){const e=Math.abs(n-t);return e>180?360-e:e}function Wmt(n,t){const e=t.step;return t.directions.forEach(i=>{i.gridOffsetX=i.offsetX/e*n.x,i.gridOffsetY=i.offsetY/e*n.y}),t.directions}function Vmt(n,t,e){return{source:t.clone(),x:rN(e.x-t.x,n),y:rN(e.y-t.y,n)}}function rN(n,t){if(!n)return t;const e=Math.abs(n),i=Math.round(e/t);if(!i)return e;const r=i*t,s=(e-r)/i;return t+s}function Gmt(n,t){const e=t.source,i=pi.snapToGrid(n.x-e.x,t.x)+e.x,r=pi.snapToGrid(n.y-e.y,t.y)+e.y;return new tt(i,r)}function Nv(n,t){return n.round(t)}function nC(n,t,e){return Nv(Gmt(n.clone(),t),e)}function _0(n){return n.toString()}function sR(n){return new tt(n.x===0?0:Math.abs(n.x)/n.x,n.y===0?0:Math.abs(n.y)/n.y)}function oN(n,t){let e=1/0;for(let i=0,r=t.length;i<r;i+=1){const o=n.manhattanDistance(t[i]);o<e&&(e=o)}return e}function sN(n,t,e,i,r){const o=r.precision,s=r.directionMap,a=n.diff(t.getCenter()),l=Object.keys(s).reduce((h,u)=>{if(e.includes(u)){const d=s[u],c=new tt(n.x+d.x*(Math.abs(a.x)+t.width),n.y+d.y*(Math.abs(a.y)+t.height)),g=new It(n,c).intersect(t)||[];let p,v=null;for(let m=0;m<g.length;m+=1){const y=g[m],b=n.squaredDistance(y);(p==null||b>p)&&(p=b,v=y)}if(v){let m=nC(v,i,o);t.containsPoint(m)&&(m=nC(m.translate(d.x*i.x,d.y*i.y),i,o)),h.push(m)}}return h},[]);return t.containsPoint(n)||l.push(nC(n,i,o)),l}function $mt(n,t,e,i,r){const o=[];let s=sR(r.diff(e)),a=_0(e),l=n[a],h;for(;l;){h=t[a];const c=sR(h.diff(l));c.equals(s)||(o.unshift(h),s=c),a=_0(l),l=n[a]}const u=t[a];return sR(u.diff(i)).equals(s)||o.unshift(u),o}function jmt(n,t,e,i,r){const o=r.precision;let s,a;Ct.isRectangle(t)?s=Nv(MX(n,r).clone(),o):s=Nv(t.clone(),o),Ct.isRectangle(e)?a=Nv(zmt(n,r).clone(),o):a=Nv(e.clone(),o);const l=Vmt(r.step,s,a),h=s,u=a;let d,c;if(Ct.isRectangle(t)?d=sN(h,t,r.startDirections,l,r):d=[h],Ct.isRectangle(e)?c=sN(a,e,r.endDirections,l,r):c=[u],d=d.filter(f=>i.isAccessible(f)),c=c.filter(f=>i.isAccessible(f)),d.length>0&&c.length>0){const f=new Hmt,g={},p={},v={};for(let T=0,M=d.length;T<M;T+=1){const R=d[T],E=_0(R);f.add(E,oN(R,c)),g[E]=R,v[E]=0}const m=r.previousDirectionAngle,y=m===void 0;let b,_;const w=Wmt(l,r),C=w.length,x=c.reduce((T,M)=>{const R=_0(M);return T.push(R),T},[]),S=tt.equalPoints(d,c);let A=r.maxLoopCount;for(;!f.isEmpty()&&A>0;){const T=f.pop(),M=g[T],R=p[T],E=v[T],P=M.equals(h),B=R==null;let k;if(B?y?P?k=null:k=oR(h,M,C,l,r):k=m:k=oR(R,M,C,l,r),!(B&&S)&&x.indexOf(T)>=0)return r.previousDirectionAngle=k,$mt(p,g,M,h,u);for(let O=0;O<C;O+=1){b=w[O];const D=b.angle;if(_=nN(k,D),!(y&&P)&&_>r.maxDirectionChange)continue;const I=nC(M.clone().translate(b.gridOffsetX||0,b.gridOffsetY||0),l,o),H=_0(I);if(f.isClose(H)||!i.isAccessible(I))continue;if(x.indexOf(H)>=0&&!I.equals(u)){const K=oR(I,u,C,l,r);if(nN(D,K)>r.maxDirectionChange)continue}const F=b.cost,G=P?0:r.penalties[_],j=E+F+G;(!f.isOpen(H)||j<v[H])&&(g[H]=I,p[H]=M,v[H]=j,f.add(H,j+oN(I,c)))}A-=1}}return r.fallbackRoute?Qt(r.fallbackRoute,this,h,u,r):null}function Umt(n,t=10){if(n.length<=1)return n;for(let e=0,i=n.length;e<i-1;e+=1){const r=n[e],o=n[e+1];if(r.x===o.x){const s=t*Math.round(r.x/t);r.x!==s&&(r.x=s,o.x=s)}else if(r.y===o.y){const s=t*Math.round(r.y/t);r.y!==s&&(r.y=s,o.y=s)}}return n}const Xmt=function(n,t,e){const i=Imt(t),r=AX(e,i),o=TX(e,i),s=MX(e,i),a=new Fmt(i).build(e.graph.model,e.cell),l=n.map(f=>tt.create(f)),h=[];let u=s,d,c;for(let f=0,g=l.length;f<=g;f+=1){let p=null;if(d=c||r,c=l[f],c==null){c=o;const m=e.cell;if((m.getSourceCellId()==null||m.getTargetCellId()==null)&&typeof i.draggingRouter=="function"){const b=d===r?s:d,_=c.getOrigin();p=Qt(i.draggingRouter,e,b,_,i)}}if(p==null&&(p=jmt(e,d,c,a,i)),p===null)return Qt(i.fallbackRouter,this,n,i,e);const v=p[0];v&&v.equals(u)&&p.shift(),u=p[p.length-1]||u,h.push(...p)}return i.snapToGrid?Umt(h,e.graph.grid.getGridSize()):h},RX=function(n,t,e){return Qt(Xmt,this,n,Object.assign(Object.assign({},Dmt),t),e)},Ymt={maxDirectionChange:45,directions(){const n=Ah(this.step,this),t=Ah(this.cost,this),e=Math.ceil(Math.sqrt(n*n<<1));return[{cost:t,offsetX:n,offsetY:0},{cost:e,offsetX:n,offsetY:n},{cost:t,offsetX:0,offsetY:n},{cost:e,offsetX:-n,offsetY:n},{cost:t,offsetX:-n,offsetY:0},{cost:e,offsetX:-n,offsetY:-n},{cost:t,offsetX:0,offsetY:-n},{cost:e,offsetX:n,offsetY:-n}]},fallbackRoute(n,t,e){const i=n.theta(t),r=[];let o={x:t.x,y:n.y},s={x:n.x,y:t.y};if(i%180>90){const b=o;o=s,s=b}const a=i%90<45?o:s,l=new It(n,a),h=90*Math.ceil(i/90),u=tt.fromPolar(l.squaredLength(),vi.toRad(h+135),a),d=new It(t,u),c=l.intersectsWithLine(d),f=c||t,g=c?f:n,p=360/e.directions.length,v=g.theta(t),m=vi.normalize(v+p/2),y=p*Math.floor(m/p);return e.previousDirectionAngle=y,f&&r.push(f.round()),r.push(t),r}},Kmt=function(n,t,e){return Qt(RX,this,n,Object.assign(Object.assign({},Ymt),t),e)},qmt=function(n,t,e){const i=t.offset||32,r=t.min==null?16:t.min;let o=0,s=t.direction;const a=e.sourceBBox,l=e.targetBBox,h=a.getCenter(),u=l.getCenter();if(typeof i=="number"&&(o=i),s==null){let m=l.left-a.right,y=l.top-a.bottom;m>=0&&y>=0?s=m>=y?"L":"T":m<=0&&y>=0?(m=a.left-l.right,m>=0?s=m>=y?"R":"T":s="T"):m>=0&&y<=0?(y=a.top-l.bottom,y>=0?s=m>=y?"L":"B":s="L"):(m=a.left-l.right,y=a.top-l.bottom,m>=0&&y>=0?s=m>=y?"R":"B":m<=0&&y>=0?s="B":m>=0&&y<=0?s="R":s=Math.abs(m)>Math.abs(y)?"R":"B")}s==="H"?s=u.x-h.x>=0?"L":"R":s==="V"&&(s=u.y-h.y>=0?"T":"B"),i==="center"&&(s==="L"?o=(l.left-a.right)/2:s==="R"?o=(a.left-l.right)/2:s==="T"?o=(l.top-a.bottom)/2:s==="B"&&(o=(a.top-l.bottom)/2));let d,c,f;const g=s==="L"||s==="R";if(g){if(u.y===h.y)return[...n];f=s==="L"?1:-1,d="x",c="width"}else{if(u.x===h.x)return[...n];f=s==="T"?1:-1,d="y",c="height"}const p=h.clone(),v=u.clone();if(p[d]+=f*(a[c]/2+o),v[d]-=f*(l[c]/2+o),g){const m=p.x,y=v.x,b=a.width/2+r,_=l.width/2+r;u.x>h.x?y<=m&&(p.x=Math.max(y,h.x+b),v.x=Math.min(m,u.x-_)):y>=m&&(p.x=Math.min(y,h.x-b),v.x=Math.max(m,u.x+_))}else{const m=p.y,y=v.y,b=a.height/2+r,_=l.height/2+r;u.y>h.y?y<=m&&(p.y=Math.max(y,h.y+b),v.y=Math.min(m,u.y-_)):y>=m&&(p.y=Math.min(y,h.y-b),v.y=Math.max(m,u.y+_))}return[p.toJSON(),...n,v.toJSON()]};function Jc(n,t){if(t!=null&&t!==!1){const e=typeof t=="boolean"?0:t;if(e>0){const i=tt.create(n[1]).move(n[2],e),r=tt.create(n[1]).move(n[0],e);return[i.toJSON(),...n,r.toJSON()]}{const i=n[1];return[Object.assign({},i),...n,Object.assign({},i)]}}return n}const Zmt=function(n,t,e){const i=t.width||50,o=(t.height||80)/2,s=t.angle||"auto",a=e.sourceAnchor,l=e.targetAnchor,h=e.sourceBBox,u=e.targetBBox;if(a.equals(l)){const d=m=>{const y=vi.toRad(m),b=Math.sin(y),_=Math.cos(y),w=new tt(a.x+_*i,a.y+b*i),C=new tt(w.x-_*o,w.y-b*o),x=C.clone().rotate(-90,w),S=C.clone().rotate(90,w);return[x.toJSON(),w.toJSON(),S.toJSON()]},c=m=>{const y=a.clone().move(m,-1),b=new It(y,m);return!h.containsPoint(m)&&!h.intersectsWithLine(b)},f=[0,90,180,270,45,135,225,315];if(typeof s=="number")return Jc(d(s),t.merge);const g=h.getCenter();if(g.equals(a))return Jc(d(0),t.merge);const p=g.angleBetween(a,g.clone().translate(1,0));let v=d(p);if(c(v[1]))return Jc(v,t.merge);for(let m=1,y=f.length;m<y;m+=1)if(v=d(p+f[m]),c(v[1]))return Jc(v,t.merge);return Jc(v,t.merge)}{const d=new It(a,l);let c=d.parallel(-i),f=c.getCenter(),g=c.start.clone().move(c.end,o),p=c.end.clone().move(c.start,o);const v=d.parallel(-1),m=new It(v.start,f),y=new It(v.end,f);if((h.containsPoint(f)||u.containsPoint(f)||h.intersectsWithLine(m)||h.intersectsWithLine(y)||u.intersectsWithLine(m)||u.intersectsWithLine(y))&&(c=d.parallel(i),f=c.getCenter(),g=c.start.clone().move(c.end,o),p=c.end.clone().move(c.start,o)),t.merge){const b=new It(a,l),_=new It(f,b.center).setLength(Number.MAX_SAFE_INTEGER),w=h.intersectsWithLine(_),C=u.intersectsWithLine(_),x=w?Array.isArray(w)?w:[w]:[];C&&(Array.isArray(C)?x.push(...C):x.push(C));const S=b.center.closest(x);S?(e.sourceAnchor=S.clone(),e.targetAnchor=S.clone()):(e.sourceAnchor=b.center.clone(),e.targetAnchor=b.center.clone())}return Jc([g.toJSON(),f.toJSON(),p.toJSON()],t.merge)}},Jmt=Object.freeze(Object.defineProperty({__proto__:null,er:qmt,loop:Zmt,manhattan:RX,metro:Kmt,normal:kmt,oneSide:Emt,orth:SX},Symbol.toStringTag,{value:"Module"}));var Oh;(function(n){n.presets=Jmt,n.registry=yn.create({type:"router"}),n.registry.register(n.presets,!0)})(Oh||(Oh={}));const Qmt=function(n,t,e,i={}){const r=[n,...e,t],o=new gn(r),s=new Ce(o);return i.raw?s:s.serialize()},tyt=function(n,t,e,i={}){const r=e.length===3?0:1,o=tt.create(e[0+r]),s=tt.create(e[2+r]),a=tt.create(e[1+r]);if(!tt.equals(n,t)){const h=new tt((n.x+t.x)/2,(n.y+t.y)/2),u=h.angleBetween(tt.create(n).rotate(90,h),a);u>1&&(o.rotate(180-u,h),s.rotate(180-u,h),a.rotate(180-u,h))}const l=`
     M ${n.x} ${n.y}
     Q ${o.x} ${o.y} ${a.x} ${a.y}
     Q ${s.x} ${s.y} ${t.x} ${t.y}
  `;return i.raw?Ce.parse(l):l},eyt=function(n,t,e,i={}){const r=new Ce;r.appendSegment(Ce.createSegment("M",n));const o=1/3,s=2/3,a=i.radius||10;let l,h;for(let u=0,d=e.length;u<d;u+=1){const c=tt.create(e[u]),f=e[u-1]||n,g=e[u+1]||t;l=h||c.distance(f)/2,h=c.distance(g)/2;const p=-Math.min(a,l),v=-Math.min(a,h),m=c.clone().move(f,p).round(),y=c.clone().move(g,v).round(),b=new tt(o*m.x+s*c.x,s*c.y+o*m.y),_=new tt(o*y.x+s*c.x,s*c.y+o*y.y);r.appendSegment(Ce.createSegment("L",m)),r.appendSegment(Ce.createSegment("C",b,_,y))}return r.appendSegment(Ce.createSegment("L",t)),i.raw?r:r.serialize()},iyt=function(n,t,e,i={}){let r,o=i.direction;if(e&&e.length!==0){const s=[n,...e,t],a=Co.throughPoints(s);r=new Ce(a)}else if(r=new Ce,r.appendSegment(Ce.createSegment("M",n)),o||(o=Math.abs(n.x-t.x)>=Math.abs(n.y-t.y)?"H":"V"),o==="H"){const s=(n.x+t.x)/2;r.appendSegment(Ce.createSegment("C",s,n.y,s,t.y,t.x,t.y))}else{const s=(n.y+t.y)/2;r.appendSegment(Ce.createSegment("C",n.x,s,t.x,s,t.x,t.y))}return i.raw?r:r.serialize()},aN=1,Nb=1/3,Wb=2/3;function nyt(n){let t=n.graph._jumpOverUpdateList;if(t==null&&(t=n.graph._jumpOverUpdateList=[],n.graph.on("cell:mouseup",()=>{const e=n.graph._jumpOverUpdateList;setTimeout(()=>{for(let i=0;i<e.length;i+=1)e[i].update()})}),n.graph.on("model:reseted",()=>{t=n.graph._jumpOverUpdateList=[]})),t.indexOf(n)<0){t.push(n);const e=()=>t.splice(t.indexOf(n),1);n.cell.once("change:connector",e),n.cell.once("removed",e)}}function aR(n,t,e=[]){const i=[n,...e,t],r=[];return i.forEach((o,s)=>{const a=i[s+1];a!=null&&r.push(new It(o,a))}),r}function ryt(n,t){const e=[];return t.forEach(i=>{const r=n.intersectsWithLine(i);r&&e.push(r)}),e}function lN(n,t){return new It(n,t).squaredLength()}function oyt(n,t,e){return t.reduce((i,r,o)=>{if(Mw.includes(r))return i;const s=i.pop()||n,a=tt.create(r).move(s.start,-e);let l=tt.create(r).move(s.start,+e);const h=t[o+1];if(h!=null){const c=l.distance(h);c<=e&&(l=h.move(s.start,c),Mw.push(h))}else if(a.distance(s.end)<e*2+aN)return i.push(s),i;if(l.distance(s.start)<e*2+aN)return i.push(s),i;const d=new It(a,l);return pm.push(d),i.push(new It(s.start,a),d,new It(l,s.end)),i},[])}function hN(n,t,e,i){const r=new Ce;let o;return o=Ce.createSegment("M",n[0].start),r.appendSegment(o),n.forEach((s,a)=>{if(pm.includes(s)){let l,h,u,d;if(e==="arc"){l=-90,h=s.start.diff(s.end),(h.x<0||h.x===0&&h.y<0)&&(l+=180);const f=s.getCenter(),g=new It(f,s.end).rotate(l,f);let p;p=new It(s.start,f),u=p.pointAt(2/3).rotate(l,s.start),d=g.pointAt(1/3).rotate(-l,g.end),o=Ce.createSegment("C",u,d,g.end),r.appendSegment(o),p=new It(f,s.end),u=g.pointAt(1/3).rotate(l,g.end),d=p.pointAt(1/3).rotate(-l,s.end),o=Ce.createSegment("C",u,d,s.end),r.appendSegment(o)}else if(e==="gap")o=Ce.createSegment("M",s.end),r.appendSegment(o);else if(e==="cubic"){l=s.start.theta(s.end);const c=t*.6;let f=t*1.35;h=s.start.diff(s.end),(h.x<0||h.x===0&&h.y<0)&&(f*=-1),u=new tt(s.start.x+c,s.start.y+f).rotate(l,s.start),d=new tt(s.end.x-c,s.end.y+f).rotate(l,s.end),o=Ce.createSegment("C",u,d,s.end),r.appendSegment(o)}}else{const l=n[a+1];i===0||!l||pm.includes(l)?(o=Ce.createSegment("L",s.end),r.appendSegment(o)):syt(i,r,s.end,s.start,l.end)}}),r}function syt(n,t,e,i,r){const o=e.distance(i)/2,s=e.distance(r)/2,a=-Math.min(n,o),l=-Math.min(n,s),h=e.clone().move(i,a).round(),u=e.clone().move(r,l).round(),d=new tt(Nb*h.x+Wb*e.x,Wb*e.y+Nb*h.y),c=new tt(Nb*u.x+Wb*e.x,Wb*e.y+Nb*u.y);let f;f=Ce.createSegment("L",h),t.appendSegment(f),f=Ce.createSegment("C",d,c,u),t.appendSegment(f)}let pm,Mw;const ayt=function(n,t,e,i={}){pm=[],Mw=[],nyt(this);const r=i.size||5,o=i.type||"arc",s=i.radius||0,a=i.ignoreConnectors||["smooth"],l=this.graph,u=l.model.getEdges();if(u.length===1)return hN(aR(n,t,e),r,o,s);const d=this.cell,c=u.indexOf(d),f=l.options.connecting.connector||{},g=u.filter((_,w)=>{const C=_.getConnector()||f;return a.includes(C.name)?!1:w>c?C.name!=="jumpover":!0}),p=g.map(_=>l.findViewByCell(_)),v=aR(n,t,e),m=p.map(_=>_==null?[]:_===this?v:aR(_.sourcePoint,_.targetPoint,_.routePoints)),y=[];v.forEach(_=>{const w=g.reduce((C,x,S)=>{if(x!==d){const A=ryt(_,m[S]);C.push(...A)}return C},[]).sort((C,x)=>lN(_.start,C)-lN(_.start,x));w.length>0?y.push(...oyt(_,w,r)):y.push(_)});const b=hN(y,r,o,s);return pm=[],Mw=[],i.raw?b:b.serialize()},lyt=Object.freeze(Object.defineProperty({__proto__:null,jumpover:ayt,loop:tyt,normal:Qmt,rounded:eyt,smooth:iyt},Symbol.toStringTag,{value:"Module"}));var Wd;(function(n){n.presets=lyt,n.registry=yn.create({type:"connector"}),n.registry.register(n.presets,!0)})(Wd||(Wd={}));var hyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class BX extends To{constructor(t={}){super(),this.pending=!1,this.changing=!1,this.data={},this.mutate(Ki(t)),this.changed={}}mutate(t,e={}){const i=e.unset===!0,r=e.silent===!0,o=[],s=this.changing;this.changing=!0,s||(this.previous=Ki(this.data),this.changed={});const a=this.data,l=this.previous,h=this.changed;if(Object.keys(t).forEach(u=>{const d=u,c=t[d];kl(a[d],c)||o.push(d),kl(l[d],c)?delete h[d]:h[d]=c,i?delete a[d]:a[d]=c}),!r&&o.length>0&&(this.pending=!0,this.pendingOptions=e,o.forEach(u=>{this.emit("change:*",{key:u,options:e,store:this,current:a[u],previous:l[u]})})),s)return this;if(!r)for(;this.pending;)this.pending=!1,this.emit("changed",{current:a,previous:l,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}get(t,e){if(t==null)return this.data;const i=this.data[t];return i??e}getPrevious(t){if(this.previous){const e=this.previous[t];return e??void 0}}set(t,e,i){return t!=null&&(typeof t=="object"?this.mutate(t,e):this.mutate({[t]:e},i)),this}remove(t,e){const r={};let o;if(typeof t=="string")r[t]=void 0,o=e;else if(Array.isArray(t))t.forEach(s=>r[s]=void 0),o=e;else{for(const s in this.data)r[s]=void 0;o=t}return this.mutate(r,Object.assign(Object.assign({},o),{unset:!0})),this}getByPath(t){return qL(this.data,t,"/")}setByPath(t,e,i={}){const r="/",o=Array.isArray(t)?[...t]:t.split(r),s=Array.isArray(t)?t.join(r):t,a=o[0],l=o.length;if(i.propertyPath=s,i.propertyValue=e,i.propertyPathArray=o,l===1)this.set(a,e,i);else{const h={};let u=h,d=a;for(let g=1;g<l;g+=1){const p=o[g],v=Number.isFinite(Number(p));u=u[d]=v?[]:{},d=p}yp(h,o,e,r);const c=Ki(this.data);i.rewrite&&z3(c,t,r);const f=Cn(c,h);this.set(a,f[a],i)}return this}removeByPath(t,e){const i=Array.isArray(t)?t:t.split("/"),r=i[0];if(i.length===1)this.remove(r,e);else{const o=i.slice(1),s=Ki(this.get(r));s&&z3(s,o),this.set(r,s,e)}return this}hasChanged(t){return t==null?Object.keys(this.changed).length>0:t in this.changed}getChanges(t){if(t==null)return this.hasChanged()?Ki(this.changed):null;const e=this.changing?this.previous:this.data,i={};let r;for(const o in t){const s=t[o];kl(e[o],s)||(i[o]=s,r=!0)}return r?Ki(i):null}toJSON(){return Ki(this.data)}clone(){const t=this.constructor;return new t(this.data)}dispose(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}hyt([To.dispose()],BX.prototype,"dispose",null);class vm{constructor(t){this.cell=t,this.ids={},this.cache={}}get(){return Object.keys(this.ids)}start(t,e,i={},r="/"){const o=this.cell.getPropByPath(t),s=FQ(i,vm.defaultOptions),a=this.getTiming(s.timing),l=this.getInterp(s.interp,o,e);let h=0;const u=Array.isArray(t)?t.join(r):t,d=Array.isArray(t)?t:t.split(r),c=()=>{const f=new Date().getTime();h===0&&(h=f);let p=(f-h)/s.duration;p<1?this.ids[u]=requestAnimationFrame(c):p=1;const v=l(a(p));this.cell.setPropByPath(d,v),i.progress&&i.progress(Object.assign({progress:p,currentValue:v},this.getArgs(u))),p===1&&(this.cell.notify("transition:complete",this.getArgs(u)),i.complete&&i.complete(this.getArgs(u)),this.cell.notify("transition:finish",this.getArgs(u)),i.finish&&i.finish(this.getArgs(u)),this.clean(u))};return setTimeout(()=>{this.stop(t,void 0,r),this.cache[u]={startValue:o,targetValue:e,options:s},this.ids[u]=requestAnimationFrame(c),this.cell.notify("transition:start",this.getArgs(u)),i.start&&i.start(this.getArgs(u))},i.delay),this.stop.bind(this,t,r,i)}stop(t,e={},i="/"){const r=Array.isArray(t)?t:t.split(i);return Object.keys(this.ids).filter(o=>kl(r,o.split(i).slice(0,r.length))).forEach(o=>{cancelAnimationFrame(this.ids[o]);const s=this.cache[o],a=this.getArgs(o),l=Object.assign(Object.assign({},s.options),e),h=l.jumpedToEnd;h&&s.targetValue!=null&&(this.cell.setPropByPath(o,s.targetValue),this.cell.notify("transition:end",Object.assign({},a)),this.cell.notify("transition:complete",Object.assign({},a)),l.complete&&l.complete(Object.assign({},a)));const u=Object.assign({jumpedToEnd:h},a);this.cell.notify("transition:stop",Object.assign({},u)),l.stop&&l.stop(Object.assign({},u)),this.cell.notify("transition:finish",Object.assign({},a)),l.finish&&l.finish(Object.assign({},a)),this.clean(o)}),this}clean(t){delete this.ids[t],delete this.cache[t]}getTiming(t){return typeof t=="string"?uc[t]:t}getInterp(t,e,i){return t?t(e,i):typeof i=="number"?Sd.number(e,i):typeof i=="string"?i[0]==="#"?Sd.color(e,i):Sd.unit(e,i):Sd.object(e,i)}getArgs(t){const e=this.cache[t];return{path:t,startValue:e.startValue,targetValue:e.targetValue,cell:this.cell}}}(function(n){n.defaultOptions={delay:10,duration:100,timing:"linear"}})(vm||(vm={}));var uyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},PX=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class Re extends To{static config(t){const{markup:e,propHooks:i,attrHooks:r}=t,o=PX(t,["markup","propHooks","attrHooks"]);e!=null&&(this.markup=e),i&&(this.propHooks=this.propHooks.slice(),Array.isArray(i)?this.propHooks.push(...i):typeof i=="function"?this.propHooks.push(i):Object.values(i).forEach(s=>{typeof s=="function"&&this.propHooks.push(s)})),r&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),r)),this.defaults=Cn({},this.defaults,o)}static getMarkup(){return this.markup}static getDefaults(t){return t?this.defaults:Ki(this.defaults)}static getAttrHooks(){return this.attrHooks}static applyPropHooks(t,e){return this.propHooks.reduce((i,r)=>r?Qt(r,t,i):i,e)}get[Symbol.toStringTag](){return Re.toStringTag}constructor(t={}){super();const i=this.constructor.getDefaults(!0),r=Cn({},this.preprocess(i),this.preprocess(t));this.id=r.id||pw(),this.store=new BX(r),this.animation=new vm(this),this.setup(),this.init(),this.postprocess(t)}init(){}get model(){return this._model}set model(t){this._model!==t&&(this._model=t)}preprocess(t,e){const i=t.id,o=this.constructor.applyPropHooks(this,t);return i==null&&e!==!0&&(o.id=pw()),o}postprocess(t){}setup(){this.store.on("change:*",t=>{const{key:e,current:i,previous:r,options:o}=t;this.notify("change:*",{key:e,options:o,current:i,previous:r,cell:this}),this.notify(`change:${e}`,{options:o,current:i,previous:r,cell:this});const s=e;(s==="source"||s==="target")&&this.notify("change:terminal",{type:s,current:i,previous:r,options:o,cell:this})}),this.store.on("changed",({options:t})=>this.notify("changed",{options:t,cell:this}))}notify(t,e){this.trigger(t,e);const i=this.model;return i&&(i.notify(`cell:${t}`,e),this.isNode()?i.notify(`node:${t}`,Object.assign(Object.assign({},e),{node:this})):this.isEdge()&&i.notify(`edge:${t}`,Object.assign(Object.assign({},e),{edge:this}))),this}isNode(){return!1}isEdge(){return!1}isSameStore(t){return this.store===t.store}get view(){return this.store.get("view")}get shape(){return this.store.get("shape","")}getProp(t,e){return t==null?this.store.get():this.store.get(t,e)}setProp(t,e,i){if(typeof t=="string")this.store.set(t,e,i);else{const r=this.preprocess(t,!0);this.store.set(Cn({},this.getProp(),r),e),this.postprocess(t)}return this}removeProp(t,e){return typeof t=="string"||Array.isArray(t)?this.store.removeByPath(t,e):this.store.remove(e),this}hasChanged(t){return t==null?this.store.hasChanged():this.store.hasChanged(t)}getPropByPath(t){return this.store.getByPath(t)}setPropByPath(t,e,i={}){return this.model&&(t==="children"?this._children=e?e.map(r=>this.model.getCell(r)).filter(r=>r!=null):null:t==="parent"&&(this._parent=e?this.model.getCell(e):null)),this.store.setByPath(t,e,i),this}removePropByPath(t,e={}){const i=Array.isArray(t)?t:t.split("/");return i[0]==="attrs"&&(e.dirty=!0),this.store.removeByPath(i,e),this}prop(t,e,i){return t==null?this.getProp():typeof t=="string"||Array.isArray(t)?arguments.length===1?this.getPropByPath(t):e==null?this.removePropByPath(t,i||{}):this.setPropByPath(t,e,i||{}):this.setProp(t,e||{})}previous(t){return this.store.getPrevious(t)}get zIndex(){return this.getZIndex()}set zIndex(t){t==null?this.removeZIndex():this.setZIndex(t)}getZIndex(){return this.store.get("zIndex")}setZIndex(t,e={}){return this.store.set("zIndex",t,e),this}removeZIndex(t={}){return this.store.remove("zIndex",t),this}toFront(t={}){const e=this.model;if(e){let i=e.getMaxZIndex(),r;t.deep?(r=this.getDescendants({deep:!0,breadthFirst:!0}),r.unshift(this)):r=[this],i=i-r.length+1;const o=e.total();let s=e.indexOf(this)!==o-r.length;s||(s=r.some((a,l)=>a.getZIndex()!==i+l)),s&&this.batchUpdate("to-front",()=>{i+=r.length,r.forEach((a,l)=>{a.setZIndex(i+l,t)})})}return this}toBack(t={}){const e=this.model;if(e){let i=e.getMinZIndex(),r;t.deep?(r=this.getDescendants({deep:!0,breadthFirst:!0}),r.unshift(this)):r=[this];let o=e.indexOf(this)!==0;o||(o=r.some((s,a)=>s.getZIndex()!==i+a)),o&&this.batchUpdate("to-back",()=>{i-=r.length,r.forEach((s,a)=>{s.setZIndex(i+a,t)})})}return this}get markup(){return this.getMarkup()}set markup(t){t==null?this.removeMarkup():this.setMarkup(t)}getMarkup(){let t=this.store.get("markup");return t==null&&(t=this.constructor.getMarkup()),t}setMarkup(t,e={}){return this.store.set("markup",t,e),this}removeMarkup(t={}){return this.store.remove("markup",t),this}get attrs(){return this.getAttrs()}set attrs(t){t==null?this.removeAttrs():this.setAttrs(t)}getAttrs(){const t=this.store.get("attrs");return t?Object.assign({},t):{}}setAttrs(t,e={}){if(t==null)this.removeAttrs(e);else{const i=r=>this.store.set("attrs",r,e);if(e.overwrite===!0)i(t);else{const r=this.getAttrs();e.deep===!1?i(Object.assign(Object.assign({},r),t)):i(Cn({},r,t))}}return this}replaceAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateAttrs(t,e={}){return this.setAttrs(t,Object.assign(Object.assign({},e),{deep:!1}))}removeAttrs(t={}){return this.store.remove("attrs",t),this}getAttrDefinition(t){if(!t)return null;const i=this.constructor.getAttrHooks()||{};let r=i[t]||Wa.registry.get(t);if(!r){const o=Kx(t);r=i[o]||Wa.registry.get(o)}return r||null}getAttrByPath(t){return t==null||t===""?this.getAttrs():this.getPropByPath(this.prefixAttrPath(t))}setAttrByPath(t,e,i={}){return this.setPropByPath(this.prefixAttrPath(t),e,i),this}removeAttrByPath(t,e={}){return this.removePropByPath(this.prefixAttrPath(t),e),this}prefixAttrPath(t){return Array.isArray(t)?["attrs"].concat(t):`attrs/${t}`}attr(t,e,i){return t==null?this.getAttrByPath():typeof t=="string"||Array.isArray(t)?arguments.length===1?this.getAttrByPath(t):e==null?this.removeAttrByPath(t,i||{}):this.setAttrByPath(t,e,i||{}):this.setAttrs(t,e||{})}get visible(){return this.isVisible()}set visible(t){this.setVisible(t)}setVisible(t,e={}){return this.store.set("visible",t,e),this}isVisible(){return this.store.get("visible")!==!1}show(t={}){return this.isVisible()||this.setVisible(!0,t),this}hide(t={}){return this.isVisible()&&this.setVisible(!1,t),this}toggleVisible(t,e={}){const i=typeof t=="boolean"?t:!this.isVisible(),r=typeof t=="boolean"?e:t;return i?this.show(r):this.hide(r),this}get data(){return this.getData()}set data(t){this.setData(t)}getData(){return this.store.get("data")}setData(t,e={}){if(t==null)this.removeData(e);else{const i=r=>this.store.set("data",r,e);if(e.overwrite===!0)i(t);else{const r=this.getData();e.deep===!1?i(typeof t=="object"?Object.assign(Object.assign({},r),t):t):i(Cn({},r,t))}}return this}replaceData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{overwrite:!0}))}updateData(t,e={}){return this.setData(t,Object.assign(Object.assign({},e),{deep:!1}))}removeData(t={}){return this.store.remove("data",t),this}get parent(){return this.getParent()}get children(){return this.getChildren()}getParentId(){return this.store.get("parent")}getParent(){const t=this.getParentId();if(t&&this.model){const e=this.model.getCell(t);return this._parent=e,e}return null}getChildren(){const t=this.store.get("children");if(t&&t.length&&this.model){const e=t.map(i=>{var r;return(r=this.model)===null||r===void 0?void 0:r.getCell(i)}).filter(i=>i!=null);return this._children=e,[...e]}return null}hasParent(){return this.parent!=null}isParentOf(t){return t!=null&&t.getParent()===this}isChildOf(t){return t!=null&&this.getParent()===t}eachChild(t,e){return this.children&&this.children.forEach(t,e),this}filterChild(t,e){return this.children?this.children.filter(t,e):[]}getChildCount(){return this.children==null?0:this.children.length}getChildIndex(t){return this.children==null?-1:this.children.indexOf(t)}getChildAt(t){return this.children!=null&&t>=0?this.children[t]:null}getAncestors(t={}){const e=[];let i=this.getParent();for(;i;)e.push(i),i=t.deep!==!1?i.getParent():null;return e}getDescendants(t={}){if(t.deep!==!1){if(t.breadthFirst){const e=[],i=this.getChildren()||[];for(;i.length>0;){const r=i.shift(),o=r.getChildren();e.push(r),o&&i.push(...o)}return e}{const e=this.getChildren()||[];return e.forEach(i=>{e.push(...i.getDescendants(t))}),e}}return this.getChildren()||[]}isDescendantOf(t,e={}){if(t==null)return!1;if(e.deep!==!1){let i=this.getParent();for(;i;){if(i===t)return!0;i=i.getParent()}return!1}return this.isChildOf(t)}isAncestorOf(t,e={}){return t==null?!1:t.isDescendantOf(this,e)}contains(t){return this.isAncestorOf(t)}getCommonAncestor(...t){return Re.getCommonAncestor(this,...t)}setParent(t,e={}){return this._parent=t,t?this.store.set("parent",t.id,e):this.store.remove("parent",e),this}setChildren(t,e={}){return this._children=t,t!=null?this.store.set("children",t.map(i=>i.id),e):this.store.remove("children",e),this}unembed(t,e={}){const i=this.children;if(i!=null&&t!=null){const r=this.getChildIndex(t);r!==-1&&(i.splice(r,1),t.setParent(null,e),this.setChildren(i,e))}return this}embed(t,e={}){return t.addTo(this,e),this}addTo(t,e={}){return Re.isCell(t)?t.addChild(this,e):t.addCell(this,e),this}insertTo(t,e,i={}){return t.insertChild(this,e,i),this}addChild(t,e={}){return this.insertChild(t,void 0,e)}insertChild(t,e,i={}){if(t!=null&&t!==this){const r=t.getParent(),o=this!==r;let s=e;if(s==null&&(s=this.getChildCount(),o||(s-=1)),r){const l=r.getChildren();if(l){const h=l.indexOf(t);h>=0&&(t.setParent(null,i),l.splice(h,1),r.setChildren(l,i))}}let a=this.children;if(a==null?(a=[],a.push(t)):a.splice(s,0,t),t.setParent(this,i),this.setChildren(a,i),o&&this.model){const l=this.model.getIncomingEdges(this),h=this.model.getOutgoingEdges(this);l&&l.forEach(u=>u.updateParent(i)),h&&h.forEach(u=>u.updateParent(i))}this.model&&this.model.addCell(t,i)}return this}removeFromParent(t={}){const e=this.getParent();if(e!=null){const i=e.getChildIndex(this);e.removeChildAt(i,t)}return this}removeChild(t,e={}){const i=this.getChildIndex(t);return this.removeChildAt(i,e)}removeChildAt(t,e={}){const i=this.getChildAt(t);return this.children!=null&&i!=null&&(this.unembed(i,e),i.remove(e)),i}remove(t={}){return this.batchUpdate("remove",()=>{const e=this.getParent();e&&e.removeChild(this,t),t.deep!==!1&&this.eachChild(i=>i.remove(t)),this.model&&this.model.removeCell(this,t)}),this}transition(t,e,i={},r="/"){return this.animation.start(t,e,i,r)}stopTransition(t,e,i="/"){return this.animation.stop(t,e,i),this}getTransitions(){return this.animation.get()}translate(t,e,i){return this}scale(t,e,i,r){return this}addTools(t,e,i){const r=Array.isArray(t)?t:[t],o=typeof e=="string"?e:null,s=typeof e=="object"?e:typeof i=="object"?i:{};if(s.reset)return this.setTools({name:o,items:r,local:s.local},s);let a=Ki(this.getTools());if(a==null||o==null||a.name===o)return a==null&&(a={}),a.items||(a.items=[]),a.name=o,a.items=[...a.items,...r],this.setTools(Object.assign({},a),s)}setTools(t,e={}){return t==null?this.removeTools():this.store.set("tools",Re.normalizeTools(t),e),this}getTools(){return this.store.get("tools")}removeTools(t={}){return this.store.remove("tools",t),this}hasTools(t){const e=this.getTools();return e==null?!1:t==null?!0:e.name===t}hasTool(t){const e=this.getTools();return e==null?!1:e.items.some(i=>typeof i=="string"?i===t:i.name===t)}removeTool(t,e={}){const i=Ki(this.getTools());if(i){let r=!1;const o=i.items.slice(),s=a=>{o.splice(a,1),r=!0};if(typeof t=="number")s(t);else for(let a=o.length-1;a>=0;a-=1){const l=o[a];(typeof l=="string"?l===t:l.name===t)&&s(a)}r&&(i.items=o,this.setTools(i,e))}return this}getBBox(t){return new Ct}getConnectionPoint(t,e){return new tt}toJSON(t={}){const e=Object.assign({},this.store.get()),i=Object.prototype.toString,r=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!e.shape){const g=this.constructor;throw new Error(`Unable to serialize ${r} missing "shape" prop, check the ${r} "${g.name||i.call(g)}"`)}const o=this.constructor,s=t.diff===!0,a=e.attrs||{},l=o.getDefaults(!0),h=s?this.preprocess(l,!0):l,u=h.attrs||{},d={};Object.entries(e).forEach(([g,p])=>{if(p!=null&&!Array.isArray(p)&&typeof p=="object"&&!ql(p))throw new Error(`Can only serialize ${r} with plain-object props, but got a "${i.call(p)}" type of key "${g}" on ${r} "${this.id}"`);if(g!=="attrs"&&g!=="shape"&&s){const v=h[g];kl(p,v)&&delete e[g]}}),Object.keys(a).forEach(g=>{const p=a[g],v=u[g];Object.keys(p).forEach(m=>{const y=p[m],b=v?v[m]:null;y!=null&&typeof y=="object"&&!Array.isArray(y)?Object.keys(y).forEach(_=>{const w=y[_];if(v==null||b==null||!Rv(b)||!kl(b[_],w)){d[g]==null&&(d[g]={}),d[g][m]==null&&(d[g][m]={});const C=d[g][m];C[_]=w}}):(v==null||!kl(b,y))&&(d[g]==null&&(d[g]={}),d[g][m]=y)})});const c=Object.assign(Object.assign({},e),{attrs:r8(d)?void 0:d});c.attrs==null&&delete c.attrs;const f=c;return f.angle===0&&delete f.angle,Ki(f)}clone(t={}){if(!t.deep){const i=Object.assign({},this.store.get());t.keepId||delete i.id,delete i.parent,delete i.children;const r=this.constructor;return new r(i)}return Re.deepClone(this)[this.id]}findView(t){return t.findViewByCell(this)}startBatch(t,e={},i=this.model){return this.notify("batch:start",{name:t,data:e,cell:this}),i&&i.startBatch(t,Object.assign(Object.assign({},e),{cell:this})),this}stopBatch(t,e={},i=this.model){return i&&i.stopBatch(t,Object.assign(Object.assign({},e),{cell:this})),this.notify("batch:stop",{name:t,data:e,cell:this}),this}batchUpdate(t,e,i){const r=this.model;this.startBatch(t,i,r);const o=e();return this.stopBatch(t,i,r),o}dispose(){this.removeFromParent(),this.store.dispose()}}Re.defaults={};Re.attrHooks={};Re.propHooks=[];uyt([To.dispose()],Re.prototype,"dispose",null);(function(n){function t(e){return typeof e=="string"?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]}}n.normalizeTools=t})(Re||(Re={}));(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.isNode=="function"&&typeof r.isEdge=="function"&&typeof r.prop=="function"&&typeof r.attr=="function"}n.isCell=t})(Re||(Re={}));(function(n){function t(...o){const s=o.filter(l=>l!=null).map(l=>l.getAncestors()).sort((l,h)=>l.length-h.length);return s.shift().find(l=>s.every(h=>h.includes(l)))||null}n.getCommonAncestor=t;function e(o,s={}){let a=null;for(let l=0,h=o.length;l<h;l+=1){const u=o[l];let d=u.getBBox(s);if(d){if(u.isNode()){const c=u.getAngle();c!=null&&c!==0&&(d=d.bbox(c))}a=a==null?d:a.union(d)}}return a}n.getCellsBBox=e;function i(o){const s=[o,...o.getDescendants({deep:!0})];return n.cloneCells(s)}n.deepClone=i;function r(o){const s=n8(o),a=s.reduce((l,h)=>(l[h.id]=h.clone(),l),{});return s.forEach(l=>{const h=a[l.id];if(h.isEdge()){const c=h.getSourceCellId(),f=h.getTargetCellId();c&&a[c]&&h.setSource(Object.assign(Object.assign({},h.getSource()),{cell:a[c].id})),f&&a[f]&&h.setTarget(Object.assign(Object.assign({},h.getTarget()),{cell:a[f].id}))}const u=l.getParent();u&&a[u.id]&&h.setParent(a[u.id]);const d=l.getChildren();if(d&&d.length){const c=d.reduce((f,g)=>(a[g.id]&&f.push(a[g.id]),f),[]);c.length>0&&h.setChildren(c)}}),a}n.cloneCells=r})(Re||(Re={}));(function(n){n.config({propHooks(t){var{tools:e}=t,i=PX(t,["tools"]);return e&&(i.tools=n.normalizeTools(e)),i}})})(Re||(Re={}));var Vg;(function(n){let t,e;function i(s,a){return a?t!=null&&t.exist(s):e!=null&&e.exist(s)}n.exist=i;function r(s){t=s}n.setEdgeRegistry=r;function o(s){e=s}n.setNodeRegistry=o})(Vg||(Vg={}));class dyt{constructor(t){this.ports=[],this.groups={},this.init(Ki(t))}getPorts(){return this.ports}getGroup(t){return t!=null?this.groups[t]:null}getPortsByGroup(t){return this.ports.filter(e=>e.group===t||e.group==null&&t==null)}getPortsLayoutByGroup(t,e){const i=this.getPortsByGroup(t),r=t?this.getGroup(t):null,o=r?r.position:null,s=o?o.name:null;let a;if(s!=null){const d=Nd.registry.get(s);if(d==null)return Nd.registry.onNotFound(s);a=d}else a=Nd.presets.left;const l=i.map(d=>d&&d.position&&d.position.args||{}),h=o&&o.args||{};return a(l,e,h).map((d,c)=>{const f=i[c];return{portLayout:d,portId:f.id,portSize:f.size,portAttrs:f.attrs,labelSize:f.label.size,labelLayout:this.getPortLabelLayout(f,tt.create(d.position),e)}})}init(t){const{groups:e,items:i}=t;e!=null&&Object.keys(e).forEach(r=>{this.groups[r]=this.parseGroup(e[r])}),Array.isArray(i)&&i.forEach(r=>{this.ports.push(this.parsePort(r))})}parseGroup(t){return Object.assign(Object.assign({},t),{label:this.getLabel(t,!0),position:this.getPortPosition(t.position,!0)})}parsePort(t){const e=Object.assign({},t),i=this.getGroup(t.group)||{};return e.markup=e.markup||i.markup,e.attrs=Cn({},i.attrs,e.attrs),e.position=this.createPosition(i,e),e.label=Cn({},i.label,this.getLabel(e)),e.zIndex=this.getZIndex(i,e),e.size=Object.assign(Object.assign({},i.size),e.size),e}getZIndex(t,e){return typeof e.zIndex=="number"?e.zIndex:typeof t.zIndex=="number"||t.zIndex==="auto"?t.zIndex:"auto"}createPosition(t,e){return Cn({name:"left",args:{}},t.position,{args:e.args})}getPortPosition(t,e=!1){if(t==null){if(e)return{name:"left",args:{}}}else{if(typeof t=="string")return{name:t,args:{}};if(Array.isArray(t))return{name:"absolute",args:{x:t[0],y:t[1]}};if(typeof t=="object")return t}return{args:{}}}getPortLabelPosition(t,e=!1){if(t==null){if(e)return{name:"left",args:{}}}else{if(typeof t=="string")return{name:t,args:{}};if(typeof t=="object")return t}return{args:{}}}getLabel(t,e=!1){const i=t.label||{};return i.position=this.getPortLabelPosition(i.position,e),i}getPortLabelLayout(t,e,i){const r=t.label.position.name||"left",o=t.label.position.args||{},s=Dg.registry.get(r)||Dg.presets.left;return s?s(e,i,o):null}}var HS=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};let Ln=class kX extends Re{get[Symbol.toStringTag](){return kX.toStringTag}constructor(t={}){super(t),this.initPorts()}preprocess(t,e){const{x:i,y:r,width:o,height:s}=t,a=HS(t,["x","y","width","height"]);if(i!=null||r!=null){const l=a.position;a.position=Object.assign(Object.assign({},l),{x:i??(l?l.x:0),y:r??(l?l.y:0)})}if(o!=null||s!=null){const l=a.size;a.size=Object.assign(Object.assign({},l),{width:o??(l?l.width:0),height:s??(l?l.height:0)})}return super.preprocess(a,e)}isNode(){return!0}size(t,e,i){return t===void 0?this.getSize():typeof t=="number"?this.setSize(t,e,i):this.setSize(t,e)}getSize(){const t=this.store.get("size");return t?Object.assign({},t):{width:1,height:1}}setSize(t,e,i){return typeof t=="object"?this.resize(t.width,t.height,e):this.resize(t,e,i),this}resize(t,e,i={}){this.startBatch("resize",i);const r=i.direction;if(r){const o=this.getSize();switch(r){case"left":case"right":e=o.height;break;case"top":case"bottom":t=o.width;break}let a={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[r];const l=vi.normalize(this.getAngle()||0);i.absolute&&(a+=Math.floor((l+45)/90),a%=4);const h=this.getBBox();let u;a===0?u=h.getBottomLeft():a===1?u=h.getCorner():a===2?u=h.getTopRight():u=h.getOrigin();const d=u.clone().rotate(-l,h.getCenter()),c=Math.sqrt(t*t+e*e)/2;let f=a*Math.PI/2;f+=Math.atan(a%2===0?e/t:t/e),f-=vi.toRad(l);const p=tt.fromPolar(c,f,d).clone().translate(t/-2,e/-2);this.store.set("size",{width:t,height:e},i),this.setPosition(p.x,p.y,i)}else this.store.set("size",{width:t,height:e},i);return this.stopBatch("resize",i),this}scale(t,e,i,r={}){const o=this.getBBox().scale(t,e,i??void 0);return this.startBatch("scale",r),this.setPosition(o.x,o.y,r),this.resize(o.width,o.height,r),this.stopBatch("scale"),this}position(t,e,i){return typeof t=="number"?this.setPosition(t,e,i):this.getPosition(t)}getPosition(t={}){if(t.relative){const i=this.getParent();if(i!=null&&i.isNode()){const r=this.getPosition(),o=i.getPosition();return{x:r.x-o.x,y:r.y-o.y}}}const e=this.store.get("position");return e?Object.assign({},e):{x:0,y:0}}setPosition(t,e,i={}){let r,o,s;if(typeof t=="object"?(r=t.x,o=t.y,s=e||{}):(r=t,o=e,s=i||{}),s.relative){const a=this.getParent();if(a!=null&&a.isNode()){const l=a.getPosition();r+=l.x,o+=l.y}}if(s.deep){const a=this.getPosition();this.translate(r-a.x,o-a.y,s)}else this.store.set("position",{x:r,y:o},s);return this}translate(t=0,e=0,i={}){if(t===0&&e===0)return this;i.translateBy=i.translateBy||this.id;const r=this.getPosition();if(i.restrict!=null&&i.translateBy===this.id){const s=this.getBBox({deep:!0}),a=i.restrict,l=r.x-s.x,h=r.y-s.y,u=Math.max(a.x+l,Math.min(a.x+a.width+l-s.width,r.x+t)),d=Math.max(a.y+h,Math.min(a.y+a.height+h-s.height,r.y+e));t=u-r.x,e=d-r.y}const o={x:r.x+t,y:r.y+e};return i.tx=t,i.ty=e,i.transition?(typeof i.transition!="object"&&(i.transition={}),this.transition("position",o,Object.assign(Object.assign({},i.transition),{interp:Sd.object})),this.eachChild(s=>{var a;((a=i.exclude)===null||a===void 0?void 0:a.includes(s))||s.translate(t,e,i)})):(this.startBatch("translate",i),this.store.set("position",o,i),this.eachChild(s=>{var a;((a=i.exclude)===null||a===void 0?void 0:a.includes(s))||s.translate(t,e,i)}),this.stopBatch("translate",i)),this}angle(t,e){return t==null?this.getAngle():this.rotate(t,e)}getAngle(){return this.store.get("angle",0)}rotate(t,e={}){const i=this.getAngle();if(e.center){const r=this.getSize(),o=this.getPosition(),s=this.getBBox().getCenter();s.rotate(i-t,e.center);const a=s.x-r.width/2-o.x,l=s.y-r.height/2-o.y;this.startBatch("rotate",{angle:t,options:e}),this.setPosition(o.x+a,o.y+l,e),this.rotate(t,Object.assign(Object.assign({},e),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",e.absolute?t:(i+t)%360,e);return this}getBBox(t={}){if(t.deep){const e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),Re.getCellsBBox(e)}return Ct.fromPositionAndSize(this.getPosition(),this.getSize())}getConnectionPoint(t,e){const i=this.getBBox(),r=i.getCenter(),o=t.getTerminal(e);if(o==null)return r;const s=o.port;if(!s||!this.hasPort(s))return r;const a=this.getPort(s);if(!a||!a.group)return r;const h=this.getPortsPosition(a.group)[s].position,u=tt.create(h).translate(i.getOrigin()),d=this.getAngle();return d&&u.rotate(-d,r),u}fit(t={}){const i=(this.getChildren()||[]).filter(h=>h.isNode());if(i.length===0)return this;this.startBatch("fit-embeds",t),t.deep&&i.forEach(h=>h.fit(t));let{x:r,y:o,width:s,height:a}=Re.getCellsBBox(i);const l=lc(t.padding);return r-=l.left,o-=l.top,s+=l.left+l.right,a+=l.bottom+l.top,this.store.set({position:{x:r,y:o},size:{width:s,height:a}},t),this.stopBatch("fit-embeds"),this}get portContainerMarkup(){return this.getPortContainerMarkup()}set portContainerMarkup(t){this.setPortContainerMarkup(t)}getDefaultPortContainerMarkup(){return this.store.get("defaultPortContainerMarkup")||Mi.getPortContainerMarkup()}getPortContainerMarkup(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}setPortContainerMarkup(t,e={}){return this.store.set("portContainerMarkup",Mi.clone(t),e),this}get portMarkup(){return this.getPortMarkup()}set portMarkup(t){this.setPortMarkup(t)}getDefaultPortMarkup(){return this.store.get("defaultPortMarkup")||Mi.getPortMarkup()}getPortMarkup(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}setPortMarkup(t,e={}){return this.store.set("portMarkup",Mi.clone(t),e),this}get portLabelMarkup(){return this.getPortLabelMarkup()}set portLabelMarkup(t){this.setPortLabelMarkup(t)}getDefaultPortLabelMarkup(){return this.store.get("defaultPortLabelMarkup")||Mi.getPortLabelMarkup()}getPortLabelMarkup(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}setPortLabelMarkup(t,e={}){return this.store.set("portLabelMarkup",Mi.clone(t),e),this}get ports(){const t=this.store.get("ports",{items:[]});return t.items==null&&(t.items=[]),t}getPorts(){return Ki(this.ports.items)}getPortsByGroup(t){return this.getPorts().filter(e=>e.group===t)}getPort(t){return Ki(this.ports.items.find(e=>e.id&&e.id===t))}getPortAt(t){return this.ports.items[t]||null}hasPorts(){return this.ports.items.length>0}hasPort(t){return this.getPortIndex(t)!==-1}getPortIndex(t){const e=typeof t=="string"?t:t.id;return e!=null?this.ports.items.findIndex(i=>i.id===e):-1}getPortsPosition(t){const e=this.getSize();return this.port.getPortsLayoutByGroup(t,new Ct(0,0,e.width,e.height)).reduce((r,o)=>{const s=o.portLayout;return r[o.portId]={position:Object.assign({},s.position),angle:s.angle||0},r},{})}getPortProp(t,e){return this.getPropByPath(this.prefixPortPath(t,e))}setPortProp(t,e,i,r){if(typeof e=="string"||Array.isArray(e)){const a=this.prefixPortPath(t,e),l=i;return this.setPropByPath(a,l,r)}const o=this.prefixPortPath(t),s=e;return this.setPropByPath(o,s,i)}removePortProp(t,e,i){return typeof e=="string"||Array.isArray(e)?this.removePropByPath(this.prefixPortPath(t,e),i):this.removePropByPath(this.prefixPortPath(t),e)}portProp(t,e,i,r){return e==null?this.getPortProp(t):typeof e=="string"||Array.isArray(e)?arguments.length===2?this.getPortProp(t,e):i==null?this.removePortProp(t,e,r):this.setPortProp(t,e,i,r):this.setPortProp(t,e,i)}prefixPortPath(t,e){const i=this.getPortIndex(t);if(i===-1)throw new Error(`Unable to find port with id: "${t}"`);return e==null||e===""?["ports","items",`${i}`]:Array.isArray(e)?["ports","items",`${i}`,...e]:`ports/items/${i}/${e}`}addPort(t,e){const i=[...this.ports.items];return i.push(t),this.setPropByPath("ports/items",i,e),this}addPorts(t,e){return this.setPropByPath("ports/items",[...this.ports.items,...t],e),this}insertPort(t,e,i){const r=[...this.ports.items];return r.splice(t,0,e),this.setPropByPath("ports/items",r,i),this}removePort(t,e={}){return this.removePortAt(this.getPortIndex(t),e)}removePortAt(t,e={}){if(t>=0){const i=[...this.ports.items];i.splice(t,1),e.rewrite=!0,this.setPropByPath("ports/items",i,e)}return this}removePorts(t,e){let i;if(Array.isArray(t)){if(i=e||{},t.length){i.rewrite=!0;const o=[...this.ports.items].filter(s=>!t.some(a=>{const l=typeof a=="string"?a:a.id;return s.id===l}));this.setPropByPath("ports/items",o,i)}}else i=t||{},i.rewrite=!0,this.setPropByPath("ports/items",[],i);return this}getParsedPorts(){return this.port.getPorts()}getParsedGroups(){return this.port.groups}getPortsLayoutByGroup(t,e){return this.port.getPortsLayoutByGroup(t,e)}initPorts(){this.updatePortData(),this.on("change:ports",()=>{this.processRemovedPort(),this.updatePortData()})}processRemovedPort(){const t=this.ports,e={};t.items.forEach(s=>{s.id&&(e[s.id]=!0)});const i={};(this.store.getPrevious("ports")||{items:[]}).items.forEach(s=>{s.id&&!e[s.id]&&(i[s.id]=!0)});const o=this.model;o&&!r8(i)&&(o.getConnectedEdges(this,{incoming:!0}).forEach(l=>{const h=l.getTargetPortId();h&&i[h]&&l.remove()}),o.getConnectedEdges(this,{outgoing:!0}).forEach(l=>{const h=l.getSourcePortId();h&&i[h]&&l.remove()}))}validatePorts(){const t={},e=[];return this.ports.items.forEach(i=>{typeof i!="object"&&e.push(`Invalid port ${i}.`),i.id==null&&(i.id=this.generatePortId()),t[i.id]&&e.push("Duplicitied port id."),t[i.id]=!0}),e}generatePortId(){return pw()}updatePortData(){const t=this.validatePorts();if(t.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(t.join(" "));const e=this.port?this.port.getPorts():null;this.port=new dyt(this.ports);const i=this.port.getPorts(),r=e?i.filter(s=>e.find(a=>a.id===s.id)?null:s):[...i],o=e?e.filter(s=>i.find(a=>a.id===s.id)?null:s):[];r.length>0&&this.notify("ports:added",{added:r,cell:this,node:this}),o.length>0&&this.notify("ports:removed",{removed:o,cell:this,node:this})}};Ln.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}};(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.isNode=="function"&&typeof r.isEdge=="function"&&typeof r.prop=="function"&&typeof r.attr=="function"&&typeof r.size=="function"&&typeof r.position=="function"}n.isNode=t})(Ln||(Ln={}));(function(n){n.config({propHooks(t){var{ports:e}=t,i=HS(t,["ports"]);return e&&(i.ports=Array.isArray(e)?{items:e}:e),i}})})(Ln||(Ln={}));(function(n){n.registry=yn.create({type:"node",process(t,e){if(Vg.exist(t,!0))throw new Error(`Node with name '${t}' was registered by anthor Edge`);if(typeof e=="function")return e.config({shape:t}),e;let i=n;const{inherit:r}=e,o=HS(e,["inherit"]);if(r)if(typeof r=="string"){const a=this.get(r);a==null?this.onNotFound(r,"inherited"):i=a}else i=r;o.constructorName==null&&(o.constructorName=t);const s=i.define.call(i,o);return s.config({shape:t}),s}}),Vg.setNodeRegistry(n.registry)})(Ln||(Ln={}));(function(n){let t=0;function e(o){return o?ZL(o):(t+=1,`CustomNode${t}`)}function i(o){const{constructorName:s,overwrite:a}=o,l=HS(o,["constructorName","overwrite"]),h=KL(e(s||l.shape),this);return h.config(l),l.shape&&n.registry.register(l.shape,h,a),h}n.define=i;function r(o){const s=o.shape||"rect",a=n.registry.get(s);return a?new a(o):n.registry.onNotFound(s)}n.create=r})(Ln||(Ln={}));var FS=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};let Qi=class EX extends Re{get[Symbol.toStringTag](){return EX.toStringTag}constructor(t={}){super(t)}preprocess(t,e){const{source:i,sourceCell:r,sourcePort:o,sourcePoint:s,target:a,targetCell:l,targetPort:h,targetPoint:u}=t,c=FS(t,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),f=g=>typeof g=="string"||typeof g=="number";if(i!=null)if(Re.isCell(i))c.source={cell:i.id};else if(f(i))c.source={cell:i};else if(tt.isPoint(i))c.source=i.toJSON();else if(Array.isArray(i))c.source={x:i[0],y:i[1]};else{const g=i.cell;Re.isCell(g)?c.source=Object.assign(Object.assign({},i),{cell:g.id}):c.source=i}if(r!=null||o!=null){let g=c.source;if(r!=null){const p=f(r)?r:r.id;g?g.cell=p:g=c.source={cell:p}}o!=null&&g&&(g.port=o)}else s!=null&&(c.source=tt.create(s).toJSON());if(a!=null)if(Re.isCell(a))c.target={cell:a.id};else if(f(a))c.target={cell:a};else if(tt.isPoint(a))c.target=a.toJSON();else if(Array.isArray(a))c.target={x:a[0],y:a[1]};else{const g=a.cell;Re.isCell(g)?c.target=Object.assign(Object.assign({},a),{cell:g.id}):c.target=a}if(l!=null||h!=null){let g=c.target;if(l!=null){const p=f(l)?l:l.id;g?g.cell=p:g=c.target={cell:p}}h!=null&&g&&(g.port=h)}else u!=null&&(c.target=tt.create(u).toJSON());return super.preprocess(c,e)}setup(){super.setup(),this.on("change:labels",t=>this.onLabelsChanged(t)),this.on("change:vertices",t=>this.onVertexsChanged(t))}isEdge(){return!0}disconnect(t={}){return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},t),this}get source(){return this.getSource()}set source(t){this.setSource(t)}getSource(){return this.getTerminal("source")}getSourceCellId(){return this.source.cell}getSourcePortId(){return this.source.port}setSource(t,e,i={}){return this.setTerminal("source",t,e,i)}get target(){return this.getTarget()}set target(t){this.setTarget(t)}getTarget(){return this.getTerminal("target")}getTargetCellId(){return this.target.cell}getTargetPortId(){return this.target.port}setTarget(t,e,i={}){return this.setTerminal("target",t,e,i)}getTerminal(t){return Object.assign({},this.store.get(t))}setTerminal(t,e,i,r={}){if(Re.isCell(e))return this.store.set(t,Cn({},i,{cell:e.id}),r),this;const o=e;return tt.isPoint(e)||o.x!=null&&o.y!=null?(this.store.set(t,Cn({},i,{x:o.x,y:o.y}),r),this):(this.store.set(t,Ki(e),r),this)}getSourcePoint(){return this.getTerminalPoint("source")}getTargetPoint(){return this.getTerminalPoint("target")}getTerminalPoint(t){const e=this[t];if(tt.isPointLike(e))return tt.create(e);const i=this.getTerminalCell(t);return i?i.getConnectionPoint(this,t):new tt}getSourceCell(){return this.getTerminalCell("source")}getTargetCell(){return this.getTerminalCell("target")}getTerminalCell(t){if(this.model){const e=t==="source"?this.getSourceCellId():this.getTargetCellId();if(e)return this.model.getCell(e)}return null}getSourceNode(){return this.getTerminalNode("source")}getTargetNode(){return this.getTerminalNode("target")}getTerminalNode(t){let e=this;const i={};for(;e&&e.isEdge();){if(i[e.id])return null;i[e.id]=!0,e=e.getTerminalCell(t)}return e&&e.isNode()?e:null}get router(){return this.getRouter()}set router(t){t==null?this.removeRouter():this.setRouter(t)}getRouter(){return this.store.get("router")}setRouter(t,e,i){return typeof t=="object"?this.store.set("router",t,e):this.store.set("router",{name:t,args:e},i),this}removeRouter(t={}){return this.store.remove("router",t),this}get connector(){return this.getConnector()}set connector(t){t==null?this.removeConnector():this.setConnector(t)}getConnector(){return this.store.get("connector")}setConnector(t,e,i){return typeof t=="object"?this.store.set("connector",t,e):this.store.set("connector",{name:t,args:e},i),this}removeConnector(t={}){return this.store.remove("connector",t)}getDefaultLabel(){const t=this.constructor,e=this.store.get("defaultLabel")||t.defaultLabel||{};return Ki(e)}get labels(){return this.getLabels()}set labels(t){this.setLabels(t)}getLabels(){return[...this.store.get("labels",[])].map(t=>this.parseLabel(t))}setLabels(t,e={}){return this.store.set("labels",Array.isArray(t)?t:[t],e),this}insertLabel(t,e,i={}){const r=this.getLabels(),o=r.length;let s=e!=null&&Number.isFinite(e)?e:o;return s<0&&(s=o+s+1),r.splice(s,0,this.parseLabel(t)),this.setLabels(r,i)}appendLabel(t,e={}){return this.insertLabel(t,-1,e)}getLabelAt(t){const e=this.getLabels();return t!=null&&Number.isFinite(t)?this.parseLabel(e[t]):null}setLabelAt(t,e,i={}){if(t!=null&&Number.isFinite(t)){const r=this.getLabels();r[t]=this.parseLabel(e),this.setLabels(r,i)}return this}removeLabelAt(t,e={}){const i=this.getLabels(),r=t!=null&&Number.isFinite(t)?t:-1,o=i.splice(r,1);return this.setLabels(i,e),o.length?o[0]:null}parseLabel(t){return typeof t=="string"?this.constructor.parseStringLabel(t):t}onLabelsChanged({previous:t,current:e}){const i=t&&e?e.filter(o=>t.find(s=>o===s||kl(o,s))?null:o):e?[...e]:[],r=t&&e?t.filter(o=>e.find(s=>o===s||kl(o,s))?null:o):t?[...t]:[];i.length>0&&this.notify("labels:added",{added:i,cell:this,edge:this}),r.length>0&&this.notify("labels:removed",{removed:r,cell:this,edge:this})}get vertices(){return this.getVertices()}set vertices(t){this.setVertices(t)}getVertices(){return[...this.store.get("vertices",[])]}setVertices(t,e={}){const i=Array.isArray(t)?t:[t];return this.store.set("vertices",i.map(r=>tt.toJSON(r)),e),this}insertVertex(t,e,i={}){const r=this.getVertices(),o=r.length;let s=e!=null&&Number.isFinite(e)?e:o;return s<0&&(s=o+s+1),r.splice(s,0,tt.toJSON(t)),this.setVertices(r,i)}appendVertex(t,e={}){return this.insertVertex(t,-1,e)}getVertexAt(t){return t!=null&&Number.isFinite(t)?this.getVertices()[t]:null}setVertexAt(t,e,i={}){if(t!=null&&Number.isFinite(t)){const r=this.getVertices();r[t]=e,this.setVertices(r,i)}return this}removeVertexAt(t,e={}){const i=this.getVertices(),r=t!=null&&Number.isFinite(t)?t:-1;return i.splice(r,1),this.setVertices(i,e)}onVertexsChanged({previous:t,current:e}){const i=t&&e?e.filter(o=>t.find(s=>tt.equals(o,s))?null:o):e?[...e]:[],r=t&&e?t.filter(o=>e.find(s=>tt.equals(o,s))?null:o):t?[...t]:[];i.length>0&&this.notify("vertexs:added",{added:i,cell:this,edge:this}),r.length>0&&this.notify("vertexs:removed",{removed:r,cell:this,edge:this})}getDefaultMarkup(){return this.store.get("defaultMarkup")||Mi.getEdgeMarkup()}getMarkup(){return super.getMarkup()||this.getDefaultMarkup()}translate(t,e,i={}){return i.translateBy=i.translateBy||this.id,i.tx=t,i.ty=e,this.applyToPoints(r=>({x:(r.x||0)+t,y:(r.y||0)+e}),i)}scale(t,e,i,r={}){return this.applyToPoints(o=>tt.create(o).scale(t,e,i).toJSON(),r)}applyToPoints(t,e={}){const i={},r=this.getSource(),o=this.getTarget();tt.isPointLike(r)&&(i.source=t(r)),tt.isPointLike(o)&&(i.target=t(o));const s=this.getVertices();return s.length>0&&(i.vertices=s.map(t)),this.store.set(i,e),this}getBBox(){return this.getPolyline().bbox()}getConnectionPoint(){return this.getPolyline().pointAt(.5)}getPolyline(){const t=[this.getSourcePoint(),...this.getVertices().map(e=>tt.create(e)),this.getTargetPoint()];return new gn(t)}updateParent(t){let e=null;const i=this.getSourceCell(),r=this.getTargetCell(),o=this.getParent();return i&&r&&(i===r||i.isDescendantOf(r)?e=r:r.isDescendantOf(i)?e=i:e=Re.getCommonAncestor(i,r)),o&&e&&e.id!==o.id&&o.unembed(this,t),e&&(!o||o.id!==e.id)&&e.embed(this,t),e}hasLoop(t={}){const e=this.getSource(),i=this.getTarget(),r=e.cell,o=i.cell;if(!r||!o)return!1;let s=r===o;if(!s&&t.deep&&this._model){const a=this.getSourceCell(),l=this.getTargetCell();a&&l&&(s=a.isAncestorOf(l,t)||l.isAncestorOf(a,t))}return s}getFragmentAncestor(){const t=[this,this.getSourceNode(),this.getTargetNode()].filter(e=>e!=null);return this.getCommonAncestor(...t)}isFragmentDescendantOf(t){const e=this.getFragmentAncestor();return!!e&&(e.id===t.id||e.isDescendantOf(t))}};Qi.defaults={};(function(n){function t(e,i){const r=e,o=i;return r.cell===o.cell?r.port===o.port||r.port==null&&o.port==null:!1}n.equalTerminals=t})(Qi||(Qi={}));(function(n){n.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}};function t(e){return{attrs:{label:{text:e}}}}n.parseStringLabel=t})(Qi||(Qi={}));(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.isNode=="function"&&typeof r.isEdge=="function"&&typeof r.prop=="function"&&typeof r.attr=="function"&&typeof r.disconnect=="function"&&typeof r.getSource=="function"&&typeof r.getTarget=="function"}n.isEdge=t})(Qi||(Qi={}));(function(n){n.registry=yn.create({type:"edge",process(t,e){if(Vg.exist(t,!1))throw new Error(`Edge with name '${t}' was registered by anthor Node`);if(typeof e=="function")return e.config({shape:t}),e;let i=n;const{inherit:r="edge"}=e,o=FS(e,["inherit"]);if(typeof r=="string"){const a=this.get(r||"edge");a==null&&r?this.onNotFound(r,"inherited"):i=a}else i=r;o.constructorName==null&&(o.constructorName=t);const s=i.define.call(i,o);return s.config({shape:t}),s}}),Vg.setEdgeRegistry(n.registry)})(Qi||(Qi={}));(function(n){let t=0;function e(o){return o?ZL(o):(t+=1,`CustomEdge${t}`)}function i(o){const{constructorName:s,overwrite:a}=o,l=FS(o,["constructorName","overwrite"]),h=KL(e(s||l.shape),this);return h.config(l),l.shape&&n.registry.register(l.shape,h,a),h}n.define=i;function r(o){const s=o.shape||"edge",a=n.registry.get(s);return a?new a(o):n.registry.onNotFound(s)}n.create=r})(Qi||(Qi={}));(function(n){const t="basic.edge";n.config({shape:t,propHooks(e){const{label:i,vertices:r}=e,o=FS(e,["label","vertices"]);if(i){o.labels==null&&(o.labels=[]);const s=typeof i=="string"?n.parseStringLabel(i):i;o.labels.push(s)}return r&&Array.isArray(r)&&(o.vertices=r.map(s=>tt.create(s).toJSON())),o}}),n.registry.register(t,n)})(Qi||(Qi={}));var cyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class oP extends To{constructor(t,e={}){super(),this.length=0,this.comparator=e.comparator||"zIndex",this.clean(),t&&this.reset(t,{silent:!0})}toJSON(){return this.cells.map(t=>t.toJSON())}add(t,e,i){let r,o;typeof e=="number"?(r=e,o=Object.assign({merge:!1},i)):(r=this.length,o=Object.assign({merge:!1},e)),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);const s=Array.isArray(t)?t:[t],a=this.comparator&&typeof e!="number"&&o.sort!==!1,l=this.comparator||null;let h=!1;const u=[],d=[];return s.forEach(c=>{const f=this.get(c);f?o.merge&&!c.isSameStore(f)&&(f.setProp(c.getProp(),i),d.push(f),a&&!h&&(l==null||typeof l=="function"?h=f.hasChanged():typeof l=="string"?h=f.hasChanged(l):h=l.some(g=>f.hasChanged(g)))):(u.push(c),this.reference(c))}),u.length&&(a&&(h=!0),this.cells.splice(r,0,...u),this.length=this.cells.length),h&&this.sort({silent:!0}),o.silent||(u.forEach((c,f)=>{const g={cell:c,index:r+f,options:o};this.trigger("added",g),o.dryrun||c.notify("added",Object.assign({},g))}),h&&this.trigger("sorted"),(u.length||d.length)&&this.trigger("updated",{added:u,merged:d,removed:[],options:o})),this}remove(t,e={}){const i=Array.isArray(t)?t:[t],r=this.removeCells(i,e);return!e.silent&&r.length>0&&this.trigger("updated",{options:e,removed:r,added:[],merged:[]}),Array.isArray(t)?r:r[0]}removeCells(t,e){const i=[];for(let r=0;r<t.length;r+=1){const o=this.get(t[r]);if(o==null)continue;const s=this.cells.indexOf(o);this.cells.splice(s,1),this.length-=1,delete this.map[o.id],i.push(o),this.unreference(o),e.dryrun||o.remove(),e.silent||(this.trigger("removed",{cell:o,index:s,options:e}),e.dryrun||o.notify("removed",{cell:o,index:s,options:e}))}return i}reset(t,e={}){const i=this.cells.slice();if(i.forEach(r=>this.unreference(r)),this.clean(),this.add(t,Object.assign({silent:!0},e)),!e.silent){const r=this.cells.slice();this.trigger("reseted",{options:e,previous:i,current:r});const o=[],s=[];r.forEach(a=>{i.some(h=>h.id===a.id)||o.push(a)}),i.forEach(a=>{r.some(h=>h.id===a.id)||s.push(a)}),this.trigger("updated",{options:e,added:o,removed:s,merged:[]})}return this}push(t,e){return this.add(t,this.length,e)}pop(t){const e=this.at(this.length-1);return this.remove(e,t)}unshift(t,e){return this.add(t,0,e)}shift(t){const e=this.at(0);return this.remove(e,t)}get(t){if(t==null)return null;const e=typeof t=="string"||typeof t=="number"?t:t.id;return this.map[e]||null}has(t){return this.get(t)!=null}at(t){return t<0&&(t+=this.length),this.cells[t]||null}first(){return this.at(0)}last(){return this.at(-1)}indexOf(t){return this.cells.indexOf(t)}toArray(){return this.cells.slice()}sort(t={}){return this.comparator!=null&&(this.cells=zQ(this.cells,this.comparator),t.silent||this.trigger("sorted")),this}clone(){const t=this.constructor;return new t(this.cells.slice(),{comparator:this.comparator})}reference(t){this.map[t.id]=t,t.on("*",this.notifyCellEvent,this)}unreference(t){t.off("*",this.notifyCellEvent,this),delete this.map[t.id]}notifyCellEvent(t,e){const i=e.cell;this.trigger(`cell:${t}`,e),i&&(i.isNode()?this.trigger(`node:${t}`,Object.assign(Object.assign({},e),{node:i})):i.isEdge()&&this.trigger(`edge:${t}`,Object.assign(Object.assign({},e),{edge:i})))}clean(){this.length=0,this.cells=[],this.map={}}dispose(){this.reset([])}}cyt([oP.dispose()],oP.prototype,"dispose",null);var fyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class $s extends To{get[Symbol.toStringTag](){return $s.toStringTag}constructor(t=[]){super(),this.batches={},this.addings=new WeakMap,this.nodes={},this.edges={},this.outgoings={},this.incomings={},this.collection=new oP(t),this.setup()}notify(t,e){this.trigger(t,e);const i=this.graph;return i&&(t==="sorted"||t==="reseted"||t==="updated"?i.trigger(`model:${t}`,e):i.trigger(t,e)),this}setup(){const t=this.collection;t.on("sorted",()=>this.notify("sorted",null)),t.on("updated",e=>this.notify("updated",e)),t.on("cell:change:zIndex",()=>this.sortOnChangeZ()),t.on("added",({cell:e})=>{this.onCellAdded(e)}),t.on("removed",e=>{const i=e.cell;this.onCellRemoved(i,e.options),this.notify("cell:removed",e),i.isNode()?this.notify("node:removed",Object.assign(Object.assign({},e),{node:i})):i.isEdge()&&this.notify("edge:removed",Object.assign(Object.assign({},e),{edge:i}))}),t.on("reseted",e=>{this.onReset(e.current),this.notify("reseted",e)}),t.on("edge:change:source",({edge:e})=>this.onEdgeTerminalChanged(e,"source")),t.on("edge:change:target",({edge:e})=>{this.onEdgeTerminalChanged(e,"target")})}sortOnChangeZ(){this.collection.sort()}onCellAdded(t){const e=t.id;t.isEdge()?(t.updateParent(),this.edges[e]=!0,this.onEdgeTerminalChanged(t,"source"),this.onEdgeTerminalChanged(t,"target")):this.nodes[e]=!0}onCellRemoved(t,e){const i=t.id;if(t.isEdge()){delete this.edges[i];const r=t.getSource(),o=t.getTarget();if(r&&r.cell){const s=this.outgoings[r.cell],a=s?s.indexOf(i):-1;a>=0&&(s.splice(a,1),s.length===0&&delete this.outgoings[r.cell])}if(o&&o.cell){const s=this.incomings[o.cell],a=s?s.indexOf(i):-1;a>=0&&(s.splice(a,1),s.length===0&&delete this.incomings[o.cell])}}else delete this.nodes[i];e.clear||(e.disconnectEdges?this.disconnectConnectedEdges(t,e):this.removeConnectedEdges(t,e)),t.model===this&&(t.model=null)}onReset(t){this.nodes={},this.edges={},this.outgoings={},this.incomings={},t.forEach(e=>this.onCellAdded(e))}onEdgeTerminalChanged(t,e){const i=e==="source"?this.outgoings:this.incomings,r=t.previous(e);if(r&&r.cell){const s=Re.isCell(r.cell)?r.cell.id:r.cell,a=i[s],l=a?a.indexOf(t.id):-1;l>=0&&(a.splice(l,1),a.length===0&&delete i[s])}const o=t.getTerminal(e);if(o&&o.cell){const s=Re.isCell(o.cell)?o.cell.id:o.cell,a=i[s]||[];a.indexOf(t.id)===-1&&a.push(t.id),i[s]=a}}prepareCell(t,e){return!t.model&&(!e||!e.dryrun)&&(t.model=this),t.zIndex==null&&t.setZIndex(this.getMaxZIndex()+1,{silent:!0}),t}resetCells(t,e={}){return t.map(i=>this.prepareCell(i,Object.assign(Object.assign({},e),{dryrun:!0}))),this.collection.reset(t,e),t.map(i=>this.prepareCell(i,{options:e})),this}clear(t={}){const e=this.getCells();if(e.length===0)return this;const i=Object.assign(Object.assign({},t),{clear:!0});return this.batchUpdate("clear",()=>{const r=e.sort((o,s)=>{const a=o.isEdge()?1:2,l=s.isEdge()?1:2;return a-l});for(;r.length>0;){const o=r.shift();o&&o.remove(i)}},i),this}addNode(t,e={}){const i=Ln.isNode(t)?t:this.createNode(t);return this.addCell(i,e),i}updateNode(t,e={}){const i=this.createNode(t),r=i.getProp();return i.dispose(),this.updateCell(r,e)}createNode(t){return Ln.create(t)}addEdge(t,e={}){const i=Qi.isEdge(t)?t:this.createEdge(t);return this.addCell(i,e),i}createEdge(t){return Qi.create(t)}updateEdge(t,e={}){const i=this.createEdge(t),r=i.getProp();return i.dispose(),this.updateCell(r,e)}addCell(t,e={}){return Array.isArray(t)?this.addCells(t,e):(!this.collection.has(t)&&!this.addings.has(t)&&(this.addings.set(t,!0),this.collection.add(this.prepareCell(t,e),e),t.eachChild(i=>this.addCell(i,e)),this.addings.delete(t)),this)}addCells(t,e={}){const i=t.length;if(i===0)return this;const r=Object.assign(Object.assign({},e),{position:i-1,maxPosition:i-1});return this.startBatch("add",Object.assign(Object.assign({},r),{cells:t})),t.forEach(o=>{this.addCell(o,r),r.position-=1}),this.stopBatch("add",Object.assign(Object.assign({},r),{cells:t})),this}updateCell(t,e={}){const i=t.id&&this.getCell(t.id);return i?this.batchUpdate("update",()=>(Object.entries(t).forEach(([r,o])=>i.setProp(r,o,e)),!0),t):!1}removeCell(t,e={}){const i=typeof t=="string"?this.getCell(t):t;return i&&this.has(i)?this.collection.remove(i,e):null}updateCellId(t,e){if(t.id===e)return;this.startBatch("update",{id:e}),t.prop("id",e);const i=t.clone({keepId:!0});return this.addCell(i),this.getConnectedEdges(t).forEach(o=>{const s=o.getSourceCell(),a=o.getTargetCell();s===t&&o.setSource(Object.assign(Object.assign({},o.getSource()),{cell:e})),a===t&&o.setTarget(Object.assign(Object.assign({},o.getTarget()),{cell:e}))}),this.removeCell(t),this.stopBatch("update",{id:e}),i}removeCells(t,e={}){return t.length?this.batchUpdate("remove",()=>t.map(i=>this.removeCell(i,e))):[]}removeConnectedEdges(t,e={}){const i=this.getConnectedEdges(t);return i.forEach(r=>{r.remove(e)}),i}disconnectConnectedEdges(t,e={}){const i=typeof t=="string"?t:t.id;this.getConnectedEdges(t).forEach(r=>{const o=r.getSourceCellId(),s=r.getTargetCellId();o===i&&r.setSource({x:0,y:0},e),s===i&&r.setTarget({x:0,y:0},e)})}has(t){return this.collection.has(t)}total(){return this.collection.length}indexOf(t){return this.collection.indexOf(t)}getCell(t){return this.collection.get(t)}getCells(){return this.collection.toArray()}getFirstCell(){return this.collection.first()}getLastCell(){return this.collection.last()}getMinZIndex(){const t=this.collection.first();return t&&t.getZIndex()||0}getMaxZIndex(){const t=this.collection.last();return t&&t.getZIndex()||0}getCellsFromCache(t){return t?Object.keys(t).map(e=>this.getCell(e)).filter(e=>e!=null):[]}getNodes(){return this.getCellsFromCache(this.nodes)}getEdges(){return this.getCellsFromCache(this.edges)}getOutgoingEdges(t){const e=typeof t=="string"?t:t.id,i=this.outgoings[e];return i?i.map(r=>this.getCell(r)).filter(r=>r&&r.isEdge()):null}getIncomingEdges(t){const e=typeof t=="string"?t:t.id,i=this.incomings[e];return i?i.map(r=>this.getCell(r)).filter(r=>r&&r.isEdge()):null}getConnectedEdges(t,e={}){const i=[],r=typeof t=="string"?this.getCell(t):t;if(r==null)return i;const o={},s=e.indirect;let a=e.incoming,l=e.outgoing;a==null&&l==null&&(a=l=!0);const h=(u,d)=>{const c=d?this.getOutgoingEdges(u):this.getIncomingEdges(u);if(c?.forEach(f=>{o[f.id]||(i.push(f),o[f.id]=!0,s&&(a&&h(f,!1),l&&h(f,!0)))}),s&&u.isEdge()){const f=d?u.getTargetCell():u.getSourceCell();f&&f.isEdge()&&(o[f.id]||(i.push(f),h(f,d)))}};if(l&&h(r,!0),a&&h(r,!1),e.deep){const u=r.getDescendants({deep:!0}),d={};u.forEach(f=>{f.isNode()&&(d[f.id]=!0)});const c=(f,g)=>{const p=g?this.getOutgoingEdges(f.id):this.getIncomingEdges(f.id);p?.forEach(v=>{if(!o[v.id]){const m=v.getSourceCell(),y=v.getTargetCell();if(!e.enclosed&&m&&d[m.id]&&y&&d[y.id])return;i.push(v),o[v.id]=!0}})};u.forEach(f=>{f.isEdge()||(l&&c(f,!0),a&&c(f,!1))})}return i}isBoundary(t,e){const i=typeof t=="string"?this.getCell(t):t,r=e?this.getIncomingEdges(i):this.getOutgoingEdges(i);return r==null||r.length===0}getBoundaryNodes(t){const e=[];return Object.keys(this.nodes).forEach(i=>{if(this.isBoundary(i,t)){const r=this.getCell(i);r&&e.push(r)}}),e}getRoots(){return this.getBoundaryNodes(!0)}getLeafs(){return this.getBoundaryNodes(!1)}isRoot(t){return this.isBoundary(t,!0)}isLeaf(t){return this.isBoundary(t,!1)}getNeighbors(t,e={}){let i=e.incoming,r=e.outgoing;i==null&&r==null&&(i=r=!0);const s=this.getConnectedEdges(t,e).reduce((a,l)=>{const h=l.hasLoop(e),u=l.getSourceCell(),d=l.getTargetCell();return i&&u&&u.isNode()&&!a[u.id]&&(h||u!==t&&(!e.deep||!u.isDescendantOf(t)))&&(a[u.id]=u),r&&d&&d.isNode()&&!a[d.id]&&(h||d!==t&&(!e.deep||!d.isDescendantOf(t)))&&(a[d.id]=d),a},{});if(t.isEdge()){if(i){const a=t.getSourceCell();a&&a.isNode()&&!s[a.id]&&(s[a.id]=a)}if(r){const a=t.getTargetCell();a&&a.isNode()&&!s[a.id]&&(s[a.id]=a)}}return Object.keys(s).map(a=>s[a])}isNeighbor(t,e,i={}){let r=i.incoming,o=i.outgoing;return r==null&&o==null&&(r=o=!0),this.getConnectedEdges(t,i).some(s=>{const a=s.getSourceCell(),l=s.getTargetCell();return!!(r&&a&&a.id===e.id||o&&l&&l.id===e.id)})}getSuccessors(t,e={}){const i=[];return this.search(t,(r,o)=>{r!==t&&this.matchDistance(o,e.distance)&&i.push(r)},Object.assign(Object.assign({},e),{outgoing:!0})),i}isSuccessor(t,e,i={}){let r=!1;return this.search(t,(o,s)=>{if(o===e&&o!==t&&this.matchDistance(s,i.distance))return r=!0,!1},Object.assign(Object.assign({},i),{outgoing:!0})),r}getPredecessors(t,e={}){const i=[];return this.search(t,(r,o)=>{r!==t&&this.matchDistance(o,e.distance)&&i.push(r)},Object.assign(Object.assign({},e),{incoming:!0})),i}isPredecessor(t,e,i={}){let r=!1;return this.search(t,(o,s)=>{if(o===e&&o!==t&&this.matchDistance(s,i.distance))return r=!0,!1},Object.assign(Object.assign({},i),{incoming:!0})),r}matchDistance(t,e){return e==null?!0:typeof e=="function"?e(t):Array.isArray(e)&&e.includes(t)?!0:t===e}getCommonAncestor(...t){const e=[];return t.forEach(i=>{i&&(Array.isArray(i)?e.push(...i):e.push(i))}),Re.getCommonAncestor(...e)}getSubGraph(t,e={}){const i=[],r={},o=[],s=[],a=l=>{r[l.id]||(i.push(l),r[l.id]=l,l.isEdge()&&s.push(l),l.isNode()&&o.push(l))};return t.forEach(l=>{a(l),e.deep&&l.getDescendants({deep:!0}).forEach(u=>a(u))}),s.forEach(l=>{const h=l.getSourceCell(),u=l.getTargetCell();h&&!r[h.id]&&(i.push(h),r[h.id]=h,h.isNode()&&o.push(h)),u&&!r[u.id]&&(i.push(u),r[u.id]=u,u.isNode()&&o.push(u))}),o.forEach(l=>{this.getConnectedEdges(l,e).forEach(u=>{const d=u.getSourceCell(),c=u.getTargetCell();!r[u.id]&&d&&r[d.id]&&c&&r[c.id]&&(i.push(u),r[u.id]=u)})}),i}cloneSubGraph(t,e={}){const i=this.getSubGraph(t,e);return this.cloneCells(i)}cloneCells(t){return Re.cloneCells(t)}getNodesFromPoint(t,e){const i=typeof t=="number"?{x:t,y:e||0}:t;return this.getNodes().filter(r=>r.getBBox().containsPoint(i))}getNodesInArea(t,e,i,r,o){const s=typeof t=="number"?new Ct(t,e,i,r):Ct.create(t),a=typeof t=="number"?o:e,l=a&&a.strict;return this.getNodes().filter(h=>{const u=h.getBBox();return l?s.containsRect(u):s.isIntersectWithRect(u)})}getEdgesInArea(t,e,i,r,o){const s=typeof t=="number"?new Ct(t,e,i,r):Ct.create(t),a=typeof t=="number"?o:e,l=a&&a.strict;return this.getEdges().filter(h=>{const u=h.getBBox();return u.width===0?u.inflate(1,0):u.height===0&&u.inflate(0,1),l?s.containsRect(u):s.isIntersectWithRect(u)})}getNodesUnderNode(t,e={}){const i=t.getBBox();return(e.by==null||e.by==="bbox"?this.getNodesInArea(i):this.getNodesFromPoint(i[e.by])).filter(o=>t.id!==o.id&&!o.isDescendantOf(t))}getAllCellsBBox(){return this.getCellsBBox(this.getCells())}getCellsBBox(t,e={}){return Re.getCellsBBox(t,e)}search(t,e,i={}){i.breadthFirst?this.breadthFirstSearch(t,e,i):this.depthFirstSearch(t,e,i)}breadthFirstSearch(t,e,i={}){const r=[],o={},s={};for(r.push(t),s[t.id]=0;r.length>0;){const a=r.shift();if(a==null||o[a.id]||(o[a.id]=!0,Qt(e,this,a,s[a.id])===!1))continue;this.getNeighbors(a,i).forEach(h=>{s[h.id]=s[a.id]+1,r.push(h)})}}depthFirstSearch(t,e,i={}){const r=[],o={},s={};for(r.push(t),s[t.id]=0;r.length>0;){const a=r.pop();if(a==null||o[a.id]||(o[a.id]=!0,Qt(e,this,a,s[a.id])===!1))continue;const l=this.getNeighbors(a,i),h=r.length;l.forEach(u=>{s[u.id]=s[a.id]+1,r.splice(h,0,u)})}}getShortestPath(t,e,i={}){const r={};this.getEdges().forEach(h=>{const u=h.getSourceCellId(),d=h.getTargetCellId();u&&d&&(r[u]||(r[u]=[]),r[d]||(r[d]=[]),r[u].push(d),i.directed||r[d].push(u))});const o=typeof t=="string"?t:t.id,s=tP.run(r,o,i.weight),a=[];let l=typeof e=="string"?e:e.id;for(s[l]&&a.push(l);l=s[l];)a.unshift(l);return a}translate(t,e,i){return this.getCells().filter(r=>!r.hasParent()).forEach(r=>r.translate(t,e,i)),this}resize(t,e,i){return this.resizeCells(t,e,this.getCells(),i)}resizeCells(t,e,i,r={}){const o=this.getCellsBBox(i);if(o){const s=Math.max(t/o.width,0),a=Math.max(e/o.height,0),l=o.getOrigin();i.forEach(h=>h.scale(s,a,l,r))}return this}toJSON(t={}){return $s.toJSON(this.getCells(),t)}parseJSON(t){return $s.fromJSON(t)}fromJSON(t,e={}){const i=this.parseJSON(t);return this.resetCells(i,e),this}startBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)+1,this.notify("batch:start",{name:t,data:e}),this}stopBatch(t,e={}){return this.batches[t]=(this.batches[t]||0)-1,this.notify("batch:stop",{name:t,data:e}),this}batchUpdate(t,e,i={}){this.startBatch(t,i);const r=e();return this.stopBatch(t,i),r}hasActiveBatch(t=Object.keys(this.batches)){return(Array.isArray(t)?t:[t]).some(i=>this.batches[i]>0)}dispose(){this.collection.dispose()}}fyt([$s.dispose()],$s.prototype,"dispose",null);(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.addNode=="function"&&typeof r.addEdge=="function"&&r.collection!=null}n.isModel=t})($s||($s={}));(function(n){function t(i,r={}){return{cells:i.map(o=>o.toJSON(r))}}n.toJSON=t;function e(i){const r=[];return Array.isArray(i)?r.push(...i):(i.cells&&r.push(...i.cells),i.nodes&&i.nodes.forEach(o=>{o.shape==null&&(o.shape="rect"),r.push(o)}),i.edges&&i.edges.forEach(o=>{o.shape==null&&(o.shape="edge"),r.push(o)})),r.map(o=>{const s=o.shape;if(s){if(Ln.registry.exist(s))return Ln.create(o);if(Qi.registry.exist(s))return Qi.create(o)}throw new Error("The `shape` should be specified when creating a node/edge instance")})}n.fromJSON=e})($s||($s={}));var gyt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};let eu=class extends Ln{get label(){return this.getLabel()}set label(t){this.setLabel(t)}getLabel(){return this.getAttrByPath("text/text")}setLabel(t,e){return t==null?this.removeLabel():this.setAttrByPath("text/text",t,e),this}removeLabel(){return this.removeAttrByPath("text/text"),this}};(function(n){n.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},n.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},n.config({attrs:{text:Object.assign({},n.labelAttr)},propHooks(t){const{label:e}=t,i=gyt(t,["label"]);return e&&yp(i,"attrs/text/text",e),i},visible:!0})})(eu||(eu={}));var pyt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};function vyt(n,t="body"){return[{tagName:n,selector:t},{tagName:"text",selector:"label"}]}function myt(n="xlink:href"){return e=>{const{imageUrl:i,imageWidth:r,imageHeight:o}=e,s=pyt(e,["imageUrl","imageWidth","imageHeight"]);if(i!=null||r!=null||o!=null){const a=()=>{if(s.attrs){const l=s.attrs.image;i!=null&&(l[n]=i),r!=null&&(l.width=r),o!=null&&(l.height=o),s.attrs.image=l}};s.attrs?(s.attrs.image==null&&(s.attrs.image={}),a()):(s.attrs={image:{}},a())}return s}}function Cp(n,t,e={}){const i={constructorName:n,markup:vyt(n,e.selector),attrs:{[n]:Object.assign({},eu.bodyAttr)}};return(e.parent||eu).define(Cn(i,t,{shape:n}))}Cp("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});const yyt=Qi.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});Cp("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var byt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class Gg extends eu{get points(){return this.getPoints()}set points(t){this.setPoints(t)}getPoints(){return this.getAttrByPath("body/refPoints")}setPoints(t,e){return t==null?this.removePoints():this.setAttrByPath("body/refPoints",Gg.pointsToString(t),e),this}removePoints(){return this.removeAttrByPath("body/refPoints"),this}}(function(n){function t(e){return typeof e=="string"?e:e.map(i=>Array.isArray(i)?i.join(","):tt.isPointLike(i)?`${i.x}, ${i.y}`:"").join(" ")}n.pointsToString=t,n.config({propHooks(e){const{points:i}=e,r=byt(e,["points"]);if(i){const o=t(i);o&&yp(r,"attrs/body/refPoints",o)}return r}})})(Gg||(Gg={}));Cp("polygon",{},{parent:Gg});Cp("polyline",{},{parent:Gg});var _yt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};eu.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks(n){const{path:t}=n,e=_yt(n,["path"]);return t&&yp(e,"attrs/body/refD",t),e}});var Cyt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};eu.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},qh.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:Dn.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},eu.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks(n){const{text:t}=n,e=Cyt(n,["text"]);return t&&yp(e,"attrs/label/text",t),e},attrHooks:{text:{set(n,{cell:t,view:e,refBBox:i,elem:r,attrs:o}){if(r instanceof HTMLElement)r.textContent=n;else{const s=o.style||{},a={text:n,width:-5,height:"100%"},l=Object.assign({textVerticalAnchor:"middle"},s),h=Wa.presets.textWrap;return Qt(h.set,this,a,{cell:t,view:e,elem:r,refBBox:i,attrs:l}),{fill:s.color||null}}},position(n,{refBBox:t,elem:e}){if(e instanceof SVGElement)return t.getCenter()}}}});Cp("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:myt()},{selector:"image"});Cp("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});class qs extends vn{constructor(){super(...arguments),this.portsCache={}}get[Symbol.toStringTag](){return qs.toStringTag}getContainerClassName(){const t=[super.getContainerClassName(),this.prefixClassName("node")];return this.can("nodeMovable")||t.push(this.prefixClassName("node-immovable")),t.join(" ")}updateClassName(t){const e=t.target;if(e.hasAttribute("magnet")){const i=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?rs(e,i):je(e,i)}else{const i=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(i):this.addClass(i)}}isNodeView(){return!0}confirmUpdate(t,e={}){let i=t;return this.hasAction(i,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","resize","translate","rotate","ports","tools"])):(i=this.handleAction(i,"resize",()=>this.resize(),"update"),i=this.handleAction(i,"update",()=>this.update(),"ports"),i=this.handleAction(i,"translate",()=>this.translate()),i=this.handleAction(i,"rotate",()=>this.rotate()),i=this.handleAction(i,"ports",()=>this.renderPorts()),i=this.handleAction(i,"tools",()=>{this.getFlag("tools")===t?this.renderTools():this.updateTools(e)})),i}update(t){this.cleanCache(),this.removePorts();const e=this.cell,i=e.getSize(),r=e.getAttrs();this.updateAttrs(this.container,r,{attrs:t===r?null:t,rootBBox:new Ct(0,0,i.width,i.height),selectors:this.selectors}),this.renderPorts()}renderMarkup(){const t=this.cell.markup;if(t){if(typeof t=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(t)}throw new TypeError("Invalid node markup.")}renderJSONMarkup(t){const e=this.parseJSONMarkup(t,this.container);this.selectors=e.selectors,this.container.appendChild(e.fragment)}render(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),this.renderTools(),this}resize(){this.cell.getAngle()&&this.rotate(),this.update()}translate(){this.updateTransform()}rotate(){this.updateTransform()}getTranslationString(){const t=this.cell.getPosition();return`translate(${t.x},${t.y})`}getRotationString(){const t=this.cell.getAngle();if(t){const e=this.cell.getSize();return`rotate(${t},${e.width/2},${e.height/2})`}}updateTransform(){let t=this.getTranslationString();const e=this.getRotationString();e&&(t+=` ${e}`),this.container.setAttribute("transform",t)}findPortElem(t,e){const i=t?this.portsCache[t]:null;if(!i)return null;const r=i.portContentElement,o=i.portContentSelectors||{};return this.findOne(e,r,o)}cleanPortsCache(){this.portsCache={}}removePorts(){Object.values(this.portsCache).forEach(t=>{Bg(t.portElement)})}renderPorts(){const t=this.container,e=[];t.childNodes.forEach(s=>{e.push(s)});const i=this.cell.getParsedPorts(),r=KD(i,"zIndex"),o="auto";r[o]&&r[o].forEach(s=>{const a=this.getPortElement(s);t.append(a),e.push(a)}),Object.keys(r).forEach(s=>{if(s!==o){const a=parseInt(s,10);this.appendPorts(r[s],a,e)}}),this.updatePorts()}appendPorts(t,e,i){const r=t.map(o=>this.getPortElement(o));i[e]||e<0?rO(i[Math.max(e,0)],r):my(this.container,r)}getPortElement(t){const e=this.portsCache[t.id];return e?e.portElement:this.createPortElement(t)}createPortElement(t){let e=Mi.renderMarkup(this.cell.getPortContainerMarkup());const i=e.elem;if(i==null)throw new Error("Invalid port container markup.");e=Mi.renderMarkup(this.getPortMarkup(t));const r=e.elem,o=e.selectors;if(r==null)throw new Error("Invalid port markup.");this.setAttrs({port:t.id,"port-group":t.group},r);let s="x6-port";t.group&&(s+=` x6-port-${t.group}`),je(i,s),je(i,"x6-port"),je(r,"x6-port-body"),i.appendChild(r);let a=o,l,h;if(this.existPortLabel(t)){if(e=Mi.renderMarkup(this.getPortLabelMarkup(t.label)),l=e.elem,h=e.selectors,l==null)throw new Error("Invalid port label markup.");if(o&&h){for(const d in h)if(o[d]&&d!==this.rootSelector)throw new Error("Selectors within port must be unique.");a=Object.assign(Object.assign({},o),h)}je(l,"x6-port-label"),i.appendChild(l)}return this.portsCache[t.id]={portElement:i,portSelectors:a,portLabelElement:l,portLabelSelectors:h,portContentElement:r,portContentSelectors:o},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:t,node:this.cell,container:i,selectors:a,labelContainer:l,labelSelectors:h,contentContainer:r,contentSelectors:o}),i}updatePorts(){const t=this.cell.getParsedGroups(),e=Object.keys(t);e.length===0?this.updatePortGroup():e.forEach(i=>this.updatePortGroup(i))}updatePortGroup(t){const e=Ct.fromSize(this.cell.getSize()),i=this.cell.getPortsLayoutByGroup(t,e);for(let r=0,o=i.length;r<o;r+=1){const s=i[r],a=s.portId,l=this.portsCache[a]||{},h=s.portLayout;if(this.applyPortTransform(l.portElement,h),s.portAttrs!=null){const d={selectors:l.portSelectors||{}};s.portSize&&(d.rootBBox=Ct.fromSize(s.portSize)),this.updateAttrs(l.portElement,s.portAttrs,d)}const u=s.labelLayout;if(u&&l.portLabelElement&&(this.applyPortTransform(l.portLabelElement,u,-(h.angle||0)),u.attrs)){const d={selectors:l.portLabelSelectors||{}};s.labelSize&&(d.rootBBox=Ct.fromSize(s.labelSize)),this.updateAttrs(l.portLabelElement,u.attrs,d)}}}applyPortTransform(t,e,i=0){const r=e.angle,o=e.position,s=zn().rotate(i).translate(o.x||0,o.y||0).rotate(r||0);Pg(t,s,{absolute:!0})}getPortMarkup(t){return t.markup||this.cell.portMarkup}getPortLabelMarkup(t){return t.markup||this.cell.portLabelMarkup}existPortLabel(t){return t.attrs&&t.attrs.text}getEventArgs(t,e,i){const r=this,o=r.cell,s=o;return e==null||i==null?{e:t,view:r,node:o,cell:s}:{e:t,x:e,y:i,view:r,node:o,cell:s}}getPortEventArgs(t,e,i){const r=this,o=r.cell,s=o;return i?{e:t,x:i.x,y:i.y,view:r,node:o,cell:s,port:e}:{e:t,view:r,node:o,cell:s,port:e}}notifyMouseDown(t,e,i){super.onMouseDown(t,e,i),this.notify("node:mousedown",this.getEventArgs(t,e,i))}notifyMouseMove(t,e,i){super.onMouseMove(t,e,i),this.notify("node:mousemove",this.getEventArgs(t,e,i))}notifyMouseUp(t,e,i){super.onMouseUp(t,e,i),this.notify("node:mouseup",this.getEventArgs(t,e,i))}notifyPortEvent(t,e,i){const r=this.findAttr("port",e.target);if(r){const o=e.type;t==="node:port:mouseenter"?e.type="mouseenter":t==="node:port:mouseleave"&&(e.type="mouseleave"),this.notify(t,this.getPortEventArgs(e,r,i)),e.type=o}}onClick(t,e,i){super.onClick(t,e,i),this.notify("node:click",this.getEventArgs(t,e,i)),this.notifyPortEvent("node:port:click",t,{x:e,y:i})}onDblClick(t,e,i){super.onDblClick(t,e,i),this.notify("node:dblclick",this.getEventArgs(t,e,i)),this.notifyPortEvent("node:port:dblclick",t,{x:e,y:i})}onContextMenu(t,e,i){super.onContextMenu(t,e,i),this.notify("node:contextmenu",this.getEventArgs(t,e,i)),this.notifyPortEvent("node:port:contextmenu",t,{x:e,y:i})}onMouseDown(t,e,i){this.isPropagationStopped(t)||(this.notifyMouseDown(t,e,i),this.notifyPortEvent("node:port:mousedown",t,{x:e,y:i}),this.startNodeDragging(t,e,i))}onMouseMove(t,e,i){const r=this.getEventData(t),o=r.action;if(o==="magnet")this.dragMagnet(t,e,i);else{if(o==="move"){const a=r.targetView||this;a.dragNode(t,e,i),a.notify("node:moving",{e:t,x:e,y:i,view:a,cell:a.cell,node:a.cell})}this.notifyMouseMove(t,e,i),this.notifyPortEvent("node:port:mousemove",t,{x:e,y:i})}this.setEventData(t,r)}onMouseUp(t,e,i){const r=this.getEventData(t),o=r.action;o==="magnet"?this.stopMagnetDragging(t,e,i):(this.notifyMouseUp(t,e,i),this.notifyPortEvent("node:port:mouseup",t,{x:e,y:i}),o==="move"&&(r.targetView||this).stopNodeDragging(t,e,i));const s=r.targetMagnet;s&&this.onMagnetClick(t,s,e,i),this.checkMouseleave(t)}onMouseOver(t){super.onMouseOver(t),this.notify("node:mouseover",this.getEventArgs(t)),this.notifyPortEvent("node:port:mouseenter",t),this.notifyPortEvent("node:port:mouseover",t)}onMouseOut(t){super.onMouseOut(t),this.notify("node:mouseout",this.getEventArgs(t)),this.notifyPortEvent("node:port:mouseleave",t),this.notifyPortEvent("node:port:mouseout",t)}onMouseEnter(t){this.updateClassName(t),super.onMouseEnter(t),this.notify("node:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("node:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,i,r){super.onMouseWheel(t,e,i,r),this.notify("node:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,i)))}onMagnetClick(t,e,i,r){const o=this.graph;o.view.getMouseMovedCount(t)>o.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:e},this.getEventArgs(t,i,r)))}onMagnetDblClick(t,e,i,r){this.notify("node:magnet:dblclick",Object.assign({magnet:e},this.getEventArgs(t,i,r)))}onMagnetContextMenu(t,e,i,r){this.notify("node:magnet:contextmenu",Object.assign({magnet:e},this.getEventArgs(t,i,r)))}onMagnetMouseDown(t,e,i,r){this.startMagnetDragging(t,i,r)}onCustomEvent(t,e,i,r){this.notify("node:customevent",Object.assign({name:e},this.getEventArgs(t,i,r))),super.onCustomEvent(t,e,i,r)}prepareEmbedding(t){const e=this.graph,r=this.getEventData(t).cell||this.cell,o=e.findViewByCell(r),s=e.snapToGrid(t.clientX,t.clientY);this.notify("node:embed",{e:t,node:r,view:o,cell:r,x:s.x,y:s.y,currentParent:r.getParent()})}processEmbedding(t,e){const i=e.cell||this.cell,r=e.graph||this.graph,o=r.options.embedding,s=o.findParent;let a=typeof s=="function"?Qt(s,r,{view:this,node:this.cell}).filter(c=>Re.isCell(c)&&this.cell.id!==c.id&&!c.isDescendantOf(this.cell)):r.model.getNodesUnderNode(i,{by:s});if(o.frontOnly&&a.length>0){const c=KD(a,"zIndex"),f=NQ(Object.keys(c).map(g=>parseInt(g,10)));f&&(a=c[f])}a=a.filter(c=>c.visible);let l=null;const h=e.candidateEmbedView,u=o.validate;for(let c=a.length-1;c>=0;c-=1){const f=a[c];if(h&&h.cell.id===f.id){l=h;break}else{const g=f.findView(r);if(u&&Qt(u,r,{child:this.cell,parent:g.cell,childView:this,parentView:g})){l=g;break}}}this.clearEmbedding(e),l&&l.highlight(null,{type:"embedding"}),e.candidateEmbedView=l;const d=r.snapToGrid(t.clientX,t.clientY);this.notify("node:embedding",{e:t,cell:i,node:i,view:r.findViewByCell(i),x:d.x,y:d.y,currentParent:i.getParent(),candidateParent:l?l.cell:null})}clearEmbedding(t){const e=t.candidateEmbedView;e&&(e.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null)}finalizeEmbedding(t,e){this.graph.startBatch("embedding");const i=e.cell||this.cell,r=e.graph||this.graph,o=r.findViewByCell(i),s=i.getParent(),a=e.candidateEmbedView;if(a?(a.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null,(s==null||s.id!==a.cell.id)&&a.cell.insertChild(i,void 0,{ui:!0})):s&&s.unembed(i,{ui:!0}),r.model.getConnectedEdges(i,{deep:!0}).forEach(l=>{l.updateParent({ui:!0})}),o&&a){const l=r.snapToGrid(t.clientX,t.clientY);o.notify("node:embedded",{e:t,cell:i,x:l.x,y:l.y,node:i,view:r.findViewByCell(i),previousParent:s,currentParent:i.getParent()})}this.graph.stopBatch("embedding")}getDelegatedView(){let t=this.cell,e=this;for(;e&&!t.isEdge();){if(!t.hasParent()||e.can("stopDelegateOnDragging"))return e;t=t.getParent(),e=this.graph.findViewByCell(t)}return null}validateMagnet(t,e,i){if(e.getAttribute("magnet")!=="passive"){const r=this.graph.options.connecting.validateMagnet;return r?Qt(r,this.graph,{e:i,magnet:e,view:t,cell:t.cell}):!0}return!1}startMagnetDragging(t,e,i){if(!this.can("magnetConnectable"))return;t.stopPropagation();const r=t.currentTarget,o=this.graph;this.setEventData(t,{targetMagnet:r}),this.validateMagnet(this,r,t)?(o.options.magnetThreshold<=0&&this.startConnectting(t,r,e,i),this.setEventData(t,{action:"magnet"}),this.stopPropagation(t)):this.onMouseDown(t,e,i),o.view.delegateDragEvents(t,this)}startConnectting(t,e,i,r){this.graph.model.startBatch("add-edge");const o=this.createEdgeFromMagnet(e,i,r);o.setEventData(t,o.prepareArrowheadDragging("target",{x:i,y:r,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(t,{edgeView:o}),o.notifyMouseDown(t,i,r)}getDefaultEdge(t,e){let i;const r=this.graph.options.connecting.createEdge;return r&&(i=Qt(r,this.graph,{sourceMagnet:e,sourceView:t,sourceCell:t.cell})),i}createEdgeFromMagnet(t,e,i){const r=this.graph,o=r.model,s=this.getDefaultEdge(this,t);return s.setSource(Object.assign(Object.assign({},s.getSource()),this.getEdgeTerminal(t,e,i,s,"source"))),s.setTarget(Object.assign(Object.assign({},s.getTarget()),{x:e,y:i})),s.addTo(o,{async:!1,ui:!0}),s.findView(r)}dragMagnet(t,e,i){const r=this.getEventData(t),o=r.edgeView;if(o)o.onMouseMove(t,e,i),this.autoScrollGraph(t.clientX,t.clientY);else{const s=this.graph,a=s.options.magnetThreshold,l=this.getEventTarget(t),h=r.targetMagnet;if(a==="onleave"){if(h===l||h.contains(l))return}else if(s.view.getMouseMovedCount(t)<=a)return;this.startConnectting(t,h,e,i)}}stopMagnetDragging(t,e,i){const o=this.eventData(t).edgeView;o&&(o.onMouseUp(t,e,i),this.graph.model.stopBatch("add-edge"))}notifyUnhandledMouseDown(t,e,i){this.notify("node:unhandled:mousedown",{e:t,x:e,y:i,view:this,cell:this.cell,node:this.cell})}notifyNodeMove(t,e,i,r,o){let s=[o];const a=this.graph.getPlugin("selection");if(a&&a.isSelectionMovable()){const l=a.getSelectedCells();l.includes(o)&&(s=l.filter(h=>h.isNode()))}s.forEach(l=>{this.notify(t,{e,x:i,y:r,cell:l,node:l,view:l.findView(this.graph)})})}getRestrictArea(t){const e=this.graph.options.translating.restrict,i=typeof e=="function"?Qt(e,this.graph,t):e;return typeof i=="number"?this.graph.transform.getGraphArea().inflate(i):i===!0?this.graph.transform.getGraphArea():i||null}startNodeDragging(t,e,i){const r=this.getDelegatedView();if(r==null||!r.can("nodeMovable"))return this.notifyUnhandledMouseDown(t,e,i);this.setEventData(t,{targetView:r,action:"move"});const o=tt.create(r.cell.getPosition());r.setEventData(t,{moving:!1,offset:o.diff(e,i),restrict:this.getRestrictArea(r)})}dragNode(t,e,i){const r=this.cell,o=this.graph,s=o.getGridSize(),a=this.getEventData(t),l=a.offset,h=a.restrict;a.moving||(a.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",t,e,i,this.cell)),this.autoScrollGraph(t.clientX,t.clientY);const u=pi.snapToGrid(e+l.x,s),d=pi.snapToGrid(i+l.y,s);r.setPosition(u,d,{restrict:h,deep:!0,ui:!0}),o.options.embedding.enabled&&(a.embedding||(this.prepareEmbedding(t),a.embedding=!0),this.processEmbedding(t,a))}stopNodeDragging(t,e,i){const r=this.getEventData(t);r.embedding&&this.finalizeEmbedding(t,r),r.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",t,e,i,this.cell)),r.moving=!1,r.embedding=!1}autoScrollGraph(t,e){const i=this.graph.getPlugin("scroller");i&&i.autoScroll(t,e)}}(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.isNodeView=="function"&&typeof r.isEdgeView=="function"&&typeof r.confirmUpdate=="function"&&typeof r.update=="function"&&typeof r.findPortElem=="function"&&typeof r.resize=="function"&&typeof r.rotate=="function"&&typeof r.translate=="function"}n.isNodeView=t})(qs||(qs={}));qs.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}});qs.registry.register("node",qs,!0);var wyt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class jl extends vn{constructor(){super(...arguments),this.POINT_ROUNDING=2,this.labelDestroyFn={}}get[Symbol.toStringTag](){return jl.toStringTag}getContainerClassName(){return[super.getContainerClassName(),this.prefixClassName("edge")].join(" ")}get sourceBBox(){const t=this.sourceView;if(!t){const i=this.cell.getSource();return new Ct(i.x,i.y)}const e=this.sourceMagnet;return t.isEdgeElement(e)?new Ct(this.sourceAnchor.x,this.sourceAnchor.y):t.getBBoxOfElement(e||t.container)}get targetBBox(){const t=this.targetView;if(!t){const i=this.cell.getTarget();return new Ct(i.x,i.y)}const e=this.targetMagnet;return t.isEdgeElement(e)?new Ct(this.targetAnchor.x,this.targetAnchor.y):t.getBBoxOfElement(e||t.container)}isEdgeView(){return!0}confirmUpdate(t,e={}){let i=t;if(this.hasAction(i,"source")){if(!this.updateTerminalProperties("source"))return i;i=this.removeAction(i,"source")}if(this.hasAction(i,"target")){if(!this.updateTerminalProperties("target"))return i;i=this.removeAction(i,"target")}return this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","labels","tools"]),i):(i=this.handleAction(i,"update",()=>this.update(e)),i=this.handleAction(i,"labels",()=>this.onLabelsChange(e)),i=this.handleAction(i,"tools",()=>this.renderTools()),i)}render(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}renderMarkup(){const t=this.cell.markup;if(t){if(typeof t=="string")throw new TypeError("Not support string markup.");return this.renderJSONMarkup(t)}throw new TypeError("Invalid edge markup.")}renderJSONMarkup(t){const e=this.parseJSONMarkup(t,this.container);this.selectors=e.selectors,this.container.append(e.fragment)}customizeLabels(){if(this.labelContainer){const t=this.cell,e=t.labels;for(let i=0,r=e.length;i<r;i+=1){const o=e[i],s=this.labelCache[i],a=this.labelSelectors[i],l=this.graph.options.onEdgeLabelRendered;if(l){const h=l({edge:t,label:o,container:s,selectors:a});h&&(this.labelDestroyFn[i]=h)}}}}destroyCustomizeLabels(){const t=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(let e=0,i=t.length;e<i;e+=1){const r=this.labelDestroyFn[e],o=this.labelCache[e],s=this.labelSelectors[e];r&&o&&s&&r({edge:this.cell,label:t[e],container:o,selectors:s})}this.labelDestroyFn={}}renderLabels(){const t=this.cell,e=t.getLabels(),i=e.length;let r=this.labelContainer;if(this.labelCache={},this.labelSelectors={},i<=0)return r&&r.parentNode&&r.parentNode.removeChild(r),this;r?this.empty(r):(r=ra("g"),this.addClass(this.prefixClassName("edge-labels"),r),this.labelContainer=r);for(let o=0,s=e.length;o<s;o+=1){const a=e[o],l=this.normalizeLabelMarkup(this.parseLabelMarkup(a.markup));let h,u;if(l)h=l.node,u=l.selectors;else{const c=t.getDefaultLabel(),f=this.normalizeLabelMarkup(this.parseLabelMarkup(c.markup));h=f.node,u=f.selectors}h.setAttribute("data-index",`${o}`),r.appendChild(h);const d=this.rootSelector;if(u[d])throw new Error("Ambiguous label root selector.");u[d]=h,this.labelCache[o]=h,this.labelSelectors[o]=u}return r.parentNode==null&&this.container.appendChild(r),this.updateLabels(),this.customizeLabels(),this}onLabelsChange(t={}){this.destroyCustomizeLabels(),this.shouldRerenderLabels(t)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}shouldRerenderLabels(t={}){const e=this.cell.previous("labels");if(e==null)return!0;if("propertyPathArray"in t&&"propertyValue"in t){const i=t.propertyPathArray||[],r=i.length;if(r>1){const o=i[1];if(e[o]){if(r===2)return typeof t.propertyValue=="object"&&Gy(t.propertyValue,"markup");if(i[2]!=="markup")return!1}}}return!0}parseLabelMarkup(t){return t?typeof t=="string"?this.parseLabelStringMarkup(t):this.parseJSONMarkup(t):null}parseLabelStringMarkup(t){const e=qt.createVectors(t),i=document.createDocumentFragment();for(let r=0,o=e.length;r<o;r+=1){const s=e[r].node;i.appendChild(s)}return{fragment:i,selectors:{}}}normalizeLabelMarkup(t){if(t==null)return;const e=t.fragment;if(!(e instanceof DocumentFragment)||!e.hasChildNodes())throw new Error("Invalid label markup.");let i;const r=e.childNodes;return r.length>1||r[0].nodeName.toUpperCase()!=="G"?i=qt.create("g").append(e):i=qt.create(r[0]),i.addClass(this.prefixClassName("edge-label")),{node:i.node,selectors:t.selectors}}updateLabels(){if(this.labelContainer){const t=this.cell,e=t.labels,i=this.can("edgeLabelMovable"),r=t.getDefaultLabel();for(let o=0,s=e.length;o<s;o+=1){const a=this.labelCache[o],l=this.labelSelectors[o];a.setAttribute("cursor",i?"move":"default");const h=e[o],u=Cn({},r.attrs,h.attrs);this.updateAttrs(a,u,{selectors:l,rootBBox:h.size?Ct.fromSize(h.size):void 0})}}}renderTools(){const t=this.cell.getTools();return this.addTools(t),this}update(t={}){this.cleanCache(),this.updateConnection(t);const e=this.cell.getAttrs(),{text:i}=e,r=wyt(e,["text"]);return r!=null&&this.updateAttrs(this.container,r,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(t),this}removeRedundantLinearVertices(t={}){const e=this.cell,i=e.getVertices(),r=[this.sourceAnchor,...i,this.targetAnchor],o=r.length,s=new gn(r);s.simplify({threshold:.01});const a=s.points.map(h=>h.toJSON()),l=a.length;return o===l?0:(e.setVertices(a.slice(1,l-1),t),o-l)}getTerminalView(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalAnchor(t){switch(t){case"source":return tt.create(this.sourceAnchor);case"target":return tt.create(this.targetAnchor);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalConnectionPoint(t){switch(t){case"source":return tt.create(this.sourcePoint);case"target":return tt.create(this.targetPoint);default:throw new Error(`Unknown terminal type '${t}'`)}}getTerminalMagnet(t,e={}){switch(t){case"source":{if(e.raw)return this.sourceMagnet;const i=this.sourceView;return i?this.sourceMagnet||i.container:null}case"target":{if(e.raw)return this.targetMagnet;const i=this.targetView;return i?this.targetMagnet||i.container:null}default:throw new Error(`Unknown terminal type '${t}'`)}}updateConnection(t={}){const e=this.cell;if(t.translateBy&&e.isFragmentDescendantOf(t.translateBy)){const i=t.tx||0,r=t.ty||0;this.routePoints=new gn(this.routePoints).translate(i,r).points,this.translateConnectionPoints(i,r),this.path.translate(i,r)}else{const i=e.getVertices(),r=this.findAnchors(i);this.sourceAnchor=r.source,this.targetAnchor=r.target,this.routePoints=this.findRoutePoints(i);const o=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=o.source,this.targetPoint=o.target;const s=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,s.source||this.sourcePoint,s.target||this.targetPoint)}this.cleanCache()}findAnchors(t){const e=this.cell,i=e.source,r=e.target,o=t[0],s=t[t.length-1];return r.priority&&!i.priority?this.findAnchorsOrdered("target",s,"source",o):this.findAnchorsOrdered("source",o,"target",s)}findAnchorsOrdered(t,e,i,r){let o,s;const a=this.cell,l=a[t],h=a[i],u=this.getTerminalView(t),d=this.getTerminalView(i),c=this.getTerminalMagnet(t),f=this.getTerminalMagnet(i);if(u){let g;e?g=tt.create(e):d?g=f:g=tt.create(h),o=this.getAnchor(l.anchor,u,c,g,t)}else o=tt.create(l);if(d){const g=tt.create(r||o);s=this.getAnchor(h.anchor,d,f,g,i)}else s=tt.isPointLike(h)?tt.create(h):new tt;return{[t]:o,[i]:s}}getAnchor(t,e,i,r,o){const s=e.isEdgeElement(i),a=this.graph.options.connecting;let l=typeof t=="string"?{name:t}:t;if(!l){const d=s?(o==="source"?a.sourceEdgeAnchor:a.targetEdgeAnchor)||a.edgeAnchor:(o==="source"?a.sourceAnchor:a.targetAnchor)||a.anchor;l=typeof d=="string"?{name:d}:d}if(!l)throw new Error("Anchor should be specified.");let h;const u=l.name;if(s){const d=Ng.registry.get(u);if(typeof d!="function")return Ng.registry.onNotFound(u);h=Qt(d,this,e,i,r,l.args||{},o)}else{const d=zg.registry.get(u);if(typeof d!="function")return zg.registry.onNotFound(u);h=Qt(d,this,e,i,r,l.args||{},o)}return h?h.round(this.POINT_ROUNDING):new tt}findRoutePoints(t=[]){const e=this.graph.options.connecting.router||Oh.presets.normal,i=this.cell.getRouter()||e;let r;if(typeof i=="function")r=Qt(i,this,t,{},this);else{const o=typeof i=="string"?i:i.name,s=typeof i=="string"?{}:i.args||{},a=o?Oh.registry.get(o):Oh.presets.normal;if(typeof a!="function")return Oh.registry.onNotFound(o);r=Qt(a,this,t,s,this)}return r==null?t.map(o=>tt.create(o)):r.map(o=>tt.create(o))}findConnectionPoints(t,e,i){const r=this.cell,o=this.graph.options.connecting,s=r.getSource(),a=r.getTarget(),l=this.sourceView,h=this.targetView,u=t[0],d=t[t.length-1];let c;if(l&&!l.isEdgeElement(this.sourceMagnet)){const g=this.sourceMagnet||l.container,p=u||i,v=new It(p,e),m=s.connectionPoint||o.sourceConnectionPoint||o.connectionPoint;c=this.getConnectionPoint(m,l,g,v,"source")}else c=e;let f;if(h&&!h.isEdgeElement(this.targetMagnet)){const g=this.targetMagnet||h.container,p=a.connectionPoint||o.targetConnectionPoint||o.connectionPoint,v=d||e,m=new It(v,i);f=this.getConnectionPoint(p,h,g,m,"target")}else f=i;return{source:c,target:f}}getConnectionPoint(t,e,i,r,o){const s=r.end;if(t==null)return s;const a=typeof t=="string"?t:t.name,l=typeof t=="string"?{}:t.args,h=Wg.registry.get(a);if(typeof h!="function")return Wg.registry.onNotFound(a);const u=Qt(h,this,r,e,i,l||{},o);return u?u.round(this.POINT_ROUNDING):s}findMarkerPoints(t,e,i){const r=d=>{const c=this.cell.getAttrs(),f=Object.keys(c);for(let g=0,p=f.length;g<p;g+=1){const v=c[f[g]];if(v[`${d}Marker`]||v[`${d}-marker`]){const m=v.strokeWidth||v["stroke-width"];if(m)return parseFloat(m);break}}return null},o=t[0],s=t[t.length-1];let a,l;const h=r("source");h&&(a=e.clone().move(o||i,-h));const u=r("target");return u&&(l=i.clone().move(s||e,-u)),this.sourceMarkerPoint=a||e.clone(),this.targetMarkerPoint=l||i.clone(),{source:a,target:l}}findPath(t,e,i){const r=this.cell.getConnector()||this.graph.options.connecting.connector;let o,s,a;if(typeof r=="string"?o=r:(o=r.name,s=r.args),o){const h=Wd.registry.get(o);if(typeof h!="function")return Wd.registry.onNotFound(o);a=h}else a=Wd.presets.normal;const l=Qt(a,this,e,i,t,Object.assign(Object.assign({},s),{raw:!0}),this);return typeof l=="string"?Ce.parse(l):l}translateConnectionPoints(t,e){this.sourcePoint.translate(t,e),this.targetPoint.translate(t,e),this.sourceAnchor.translate(t,e),this.targetAnchor.translate(t,e),this.sourceMarkerPoint.translate(t,e),this.targetMarkerPoint.translate(t,e)}updateLabelPositions(){if(this.labelContainer==null)return this;if(!this.path)return this;const e=this.cell,i=e.getLabels();if(i.length===0)return this;const r=e.getDefaultLabel(),o=this.normalizeLabelPosition(r.position);for(let s=0,a=i.length;s<a;s+=1){const l=i[s],h=this.labelCache[s];if(!h)continue;const u=this.normalizeLabelPosition(l.position),d=Cn({},o,u),c=this.getLabelTransformationMatrix(d);h.setAttribute("transform",bp(c))}return this}updateTerminalProperties(t){const e=this.cell,i=this.graph,r=e[t],o=r&&r.cell,s=`${t}View`;if(!o)return this[s]=null,this.updateTerminalMagnet(t),!0;const a=i.getCellById(o);if(!a)throw new Error(`Edge's ${t} node with id "${o}" not exists`);const l=a.findView(i);return l?(this[s]=l,this.updateTerminalMagnet(t),!0):!1}updateTerminalMagnet(t){const e=`${t}Magnet`,i=this.getTerminalView(t);if(i){let r=i.getMagnetFromEdgeTerminal(this.cell[t]);r===i.container&&(r=null),this[e]=r}else this[e]=null}getLabelPositionAngle(t){const e=this.cell.getLabelAt(t);return e&&e.position&&typeof e.position=="object"&&e.position.angle||0}getLabelPositionArgs(t){const e=this.cell.getLabelAt(t);if(e&&e.position&&typeof e.position=="object")return e.position.options}getDefaultLabelPositionArgs(){const t=this.cell.getDefaultLabel();if(t&&t.position&&typeof t.position=="object")return t.position.options}mergeLabelPositionArgs(t,e){return t===null?null:t===void 0?e===null?null:e:Cn({},e,t)}getConnection(){return this.path!=null?this.path.clone():null}getConnectionPathData(){if(this.path==null)return"";const t=this.cache.pathCache;return Gy(t,"data")||(t.data=this.path.serialize()),t.data||""}getConnectionSubdivisions(){if(this.path==null)return null;const t=this.cache.pathCache;return Gy(t,"segmentSubdivisions")||(t.segmentSubdivisions=this.path.getSegmentSubdivisions()),t.segmentSubdivisions}getConnectionLength(){if(this.path==null)return 0;const t=this.cache.pathCache;return Gy(t,"length")||(t.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),t.length}getPointAtLength(t){return this.path==null?null:this.path.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getPointAtRatio(t){return this.path==null?null:($l(t)&&(t=parseFloat(t)/100),this.path.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}))}getTangentAtLength(t){return this.path==null?null:this.path.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getTangentAtRatio(t){return this.path==null?null:this.path.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPoint(t){return this.path==null?null:this.path.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointLength(t){return this.path==null?null:this.path.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getClosestPointRatio(t){return this.path==null?null:this.path.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()})}getLabelPosition(t,e,i,r){const o={distance:0};let s=0,a;typeof i=="number"?(s=i,a=r):a=i,a!=null&&(o.options=a);const l=a&&a.absoluteOffset,h=!(a&&a.absoluteDistance),u=a&&a.absoluteDistance&&a.reverseDistance,d=this.path,c={segmentSubdivisions:this.getConnectionSubdivisions()},f=new tt(t,e),g=d.closestPointT(f,c),p=this.getConnectionLength()||0;let v=d.lengthAtT(g,c);h&&(v=p>0?v/p:0),u&&(v=-1*(p-v)||1),o.distance=v;let m;l||(m=d.tangentAtT(g));let y;if(m)y=m.pointOffset(f);else{const b=d.pointAtT(g),_=f.diff(b);y={x:_.x,y:_.y}}return o.offset=y,o.angle=s,o}normalizeLabelPosition(t){return typeof t=="number"?{distance:t}:t}getLabelTransformationMatrix(t){const e=this.normalizeLabelPosition(t),i=e.options||{},r=e.angle||0,o=e.distance,s=o>0&&o<=1;let a=0;const l={x:0,y:0},h=e.offset;h&&(typeof h=="number"?a=h:(h.x!=null&&(l.x=h.x),h.y!=null&&(l.y=h.y)));const u=l.x!==0||l.y!==0||a===0,d=i.keepGradient,c=i.ensureLegibility,f=this.path,g={segmentSubdivisions:this.getConnectionSubdivisions()},p=s?o*this.getConnectionLength():o,v=f.tangentAtLength(p,g);let m,y=r;if(v){if(u)m=v.start,m.translate(l);else{const b=v.clone();b.rotate(-90,v.start),b.setLength(a),m=b.end}d&&(y=v.angle()+r,c&&(y=vi.normalize((y+90)%180-90)))}else m=f.start,u&&m.translate(l);return zn().translate(m.x,m.y).rotate(y)}getVertexIndex(t,e){const r=this.cell.getVertices(),o=this.getClosestPointLength(new tt(t,e));let s=0;if(o!=null)for(const a=r.length;s<a;s+=1){const l=r[s],h=this.getClosestPointLength(l);if(h!=null&&o<h)break}return s}getEventArgs(t,e,i){const r=this,o=r.cell,s=o;return e==null||i==null?{e:t,view:r,edge:o,cell:s}:{e:t,x:e,y:i,view:r,edge:o,cell:s}}notifyUnhandledMouseDown(t,e,i){this.notify("edge:unhandled:mousedown",{e:t,x:e,y:i,view:this,cell:this.cell,edge:this.cell})}notifyMouseDown(t,e,i){super.onMouseDown(t,e,i),this.notify("edge:mousedown",this.getEventArgs(t,e,i))}notifyMouseMove(t,e,i){super.onMouseMove(t,e,i),this.notify("edge:mousemove",this.getEventArgs(t,e,i))}notifyMouseUp(t,e,i){super.onMouseUp(t,e,i),this.notify("edge:mouseup",this.getEventArgs(t,e,i))}onClick(t,e,i){super.onClick(t,e,i),this.notify("edge:click",this.getEventArgs(t,e,i))}onDblClick(t,e,i){super.onDblClick(t,e,i),this.notify("edge:dblclick",this.getEventArgs(t,e,i))}onContextMenu(t,e,i){super.onContextMenu(t,e,i),this.notify("edge:contextmenu",this.getEventArgs(t,e,i))}onMouseDown(t,e,i){this.notifyMouseDown(t,e,i),this.startEdgeDragging(t,e,i)}onMouseMove(t,e,i){const r=this.getEventData(t);switch(r.action){case"drag-label":{this.dragLabel(t,e,i);break}case"drag-arrowhead":{this.dragArrowhead(t,e,i);break}case"drag-edge":{this.dragEdge(t,e,i);break}}return this.notifyMouseMove(t,e,i),r}onMouseUp(t,e,i){const r=this.getEventData(t);switch(r.action){case"drag-label":{this.stopLabelDragging(t,e,i);break}case"drag-arrowhead":{this.stopArrowheadDragging(t,e,i);break}case"drag-edge":{this.stopEdgeDragging(t,e,i);break}}return this.notifyMouseUp(t,e,i),this.checkMouseleave(t),r}onMouseOver(t){super.onMouseOver(t),this.notify("edge:mouseover",this.getEventArgs(t))}onMouseOut(t){super.onMouseOut(t),this.notify("edge:mouseout",this.getEventArgs(t))}onMouseEnter(t){super.onMouseEnter(t),this.notify("edge:mouseenter",this.getEventArgs(t))}onMouseLeave(t){super.onMouseLeave(t),this.notify("edge:mouseleave",this.getEventArgs(t))}onMouseWheel(t,e,i,r){super.onMouseWheel(t,e,i,r),this.notify("edge:mousewheel",Object.assign({delta:r},this.getEventArgs(t,e,i)))}onCustomEvent(t,e,i,r){if(xU(t.target,"edge-tool",this.container)){if(t.stopPropagation(),this.can("useEdgeTools")){if(e==="edge:remove"){this.cell.remove({ui:!0});return}this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,i,r)))}this.notifyMouseDown(t,i,r)}else this.notify("edge:customevent",Object.assign({name:e},this.getEventArgs(t,i,r))),super.onCustomEvent(t,e,i,r)}onLabelMouseDown(t,e,i){this.notifyMouseDown(t,e,i),this.startLabelDragging(t,e,i),this.getEventData(t).stopPropagation&&t.stopPropagation()}startEdgeDragging(t,e,i){if(!this.can("edgeMovable")){this.notifyUnhandledMouseDown(t,e,i);return}this.setEventData(t,{x:e,y:i,moving:!1,action:"drag-edge"})}dragEdge(t,e,i){const r=this.getEventData(t);r.moving||(r.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:t,x:e,y:i,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(e-r.x,i-r.y,{ui:!0}),this.setEventData(t,{x:e,y:i}),this.notify("edge:moving",{e:t,x:e,y:i,view:this,cell:this.cell,edge:this.cell})}stopEdgeDragging(t,e,i){const r=this.getEventData(t);r.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:t,x:e,y:i,view:this,cell:this.cell,edge:this.cell})),r.moving=!1}prepareArrowheadDragging(t,e){const i=this.getTerminalMagnet(t),r={action:"drag-arrowhead",x:e.x,y:e.y,isNewEdge:e.isNewEdge===!0,terminalType:t,initialMagnet:i,initialTerminal:T2(this.cell[t]),fallbackAction:e.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(t),options:e.options};return this.beforeArrowheadDragging(r),r}createValidateConnectionArgs(t){const e=[];e[4]=t,e[5]=this;let i,r=0,o=0;t==="source"?(r=2,i="target"):(o=2,i="source");const s=this.cell[i],a=s.cell;if(a){let l;const h=e[r]=this.graph.findViewByCell(a);h&&(l=h.getMagnetFromEdgeTerminal(s),l===h.container&&(l=void 0)),e[r+1]=l}return(l,h)=>(e[o]=l,e[o+1]=l.container===h?void 0:h,e)}beforeArrowheadDragging(t){t.zIndex=this.cell.zIndex,this.cell.toFront();const e=this.container.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(t)}afterArrowheadDragging(t){t.zIndex!=null&&(this.cell.setZIndex(t.zIndex,{ui:!0}),t.zIndex=null);const e=this.container;e.style.pointerEvents=t.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(t)}validateConnection(t,e,i,r,o,s,a){const l=this.graph.options.connecting,h=l.allowLoop,u=l.allowNode,d=l.allowEdge,c=l.allowPort,f=l.allowMulti,g=l.validateConnection,p=s?s.cell:null,v=o==="target"?i:t,m=o==="target"?r:e;let y=!0;const b=_=>{const w=o==="source"?a?a.port:null:p?p.getSourcePortId():null,C=o==="target"?a?a.port:null:p?p.getTargetPortId():null;return Qt(_,this.graph,{edge:p,edgeView:s,sourceView:t,targetView:i,sourcePort:w,targetPort:C,sourceMagnet:e,targetMagnet:r,sourceCell:t?t.cell:null,targetCell:i?i.cell:null,type:o})};if(h!=null&&(typeof h=="boolean"?!h&&t===i&&(y=!1):y=b(h)),y&&c!=null&&(typeof c=="boolean"?!c&&m&&(y=!1):y=b(c)),y&&d!=null&&(typeof d=="boolean"?!d&&jl.isEdgeView(v)&&(y=!1):y=b(d)),y&&u!=null&&m==null&&(typeof u=="boolean"?!u&&qs.isNodeView(v)&&(y=!1):y=b(u)),y&&f!=null&&s){const _=s.cell,w=o==="source"?a:_.getSource(),C=o==="target"?a:_.getTarget(),x=a?this.graph.getCellById(a.cell):null;if(w&&C&&w.cell&&C.cell&&x)if(typeof f=="function")y=b(f);else{const S=this.graph.model.getConnectedEdges(x,{outgoing:o==="source",incoming:o==="target"});S.length&&(f==="withPort"?S.some(T=>{const M=T.getSource(),R=T.getTarget();return M&&R&&M.cell===w.cell&&R.cell===C.cell&&M.port!=null&&M.port===w.port&&R.port!=null&&R.port===C.port})&&(y=!1):f||S.some(T=>{const M=T.getSource(),R=T.getTarget();return M&&R&&M.cell===w.cell&&R.cell===C.cell})&&(y=!1))}}return y&&g!=null&&(y=b(g)),y}allowConnectToBlank(t){const e=this.graph,r=e.options.connecting.allowBlank;if(typeof r!="function")return!!r;const o=e.findViewByCell(t),s=t.getSourceCell(),a=t.getTargetCell(),l=e.findViewByCell(s),h=e.findViewByCell(a);return Qt(r,e,{edge:t,edgeView:o,sourceCell:s,targetCell:a,sourceView:l,targetView:h,sourcePort:t.getSourcePortId(),targetPort:t.getTargetPortId(),sourceMagnet:o.sourceMagnet,targetMagnet:o.targetMagnet})}validateEdge(t,e,i){const r=this.graph;if(!this.allowConnectToBlank(t)){const s=t.getSourceCellId(),a=t.getTargetCellId();if(!(s&&a))return!1}const o=r.options.connecting.validateEdge;return o?Qt(o,r,{edge:t,type:e,previous:i}):!0}arrowheadDragging(t,e,i,r){r.x=e,r.y=i,r.currentTarget!==t&&(r.currentMagnet&&r.currentView&&r.currentView.unhighlight(r.currentMagnet,{type:"magnetAdsorbed"}),r.currentView=this.graph.findViewByElem(t),r.currentView?(r.currentMagnet=r.currentView.findMagnet(t),r.currentMagnet&&this.validateConnection(...r.getValidateConnectionArgs(r.currentView,r.currentMagnet),r.currentView.getEdgeTerminal(r.currentMagnet,e,i,this.cell,r.terminalType))?r.currentView.highlight(r.currentMagnet,{type:"magnetAdsorbed"}):r.currentMagnet=null):r.currentMagnet=null),r.currentTarget=t,this.cell.prop(r.terminalType,{x:e,y:i},Object.assign(Object.assign({},r.options),{ui:!0}))}arrowheadDragged(t,e,i){const r=t.currentView,o=t.currentMagnet;if(!o||!r)return;r.unhighlight(o,{type:"magnetAdsorbed"});const s=t.terminalType,a=r.getEdgeTerminal(o,e,i,this.cell,s);this.cell.setTerminal(s,a,{ui:!0})}snapArrowhead(t,e,i){const r=this.graph,{snap:o,allowEdge:s}=r.options.connecting,a=typeof o=="object"&&o.radius||50,l=typeof o=="object"&&o.anchor||"center",h=r.renderer.findViewsInArea({x:t-a,y:e-a,width:2*a,height:2*a},{nodeOnly:!0});if(s){const _=r.renderer.findEdgeViewsFromPoint({x:t,y:e},a).filter(w=>w!==this);h.push(..._)}const u=i.closestView||null,d=i.closestMagnet||null;i.closestView=null,i.closestMagnet=null;let c,f=Number.MAX_SAFE_INTEGER;const g=new tt(t,e);h.forEach(_=>{if(_.container.getAttribute("magnet")!=="false"){if(_.isNodeView())c=l==="center"?_.cell.getBBox().getCenter().distance(g):_.cell.getBBox().getNearestPointToPoint(g).distance(g);else if(_.isEdgeView()){const w=_.getClosestPoint(g);w?c=w.distance(g):c=Number.MAX_SAFE_INTEGER}c<a&&c<f&&(d===_.container||this.validateConnection(...i.getValidateConnectionArgs(_,null),_.getEdgeTerminal(_.container,t,e,this.cell,i.terminalType)))&&(f=c,i.closestView=_,i.closestMagnet=_.container)}_.container.querySelectorAll("[magnet]").forEach(w=>{if(w.getAttribute("magnet")!=="false"){const C=_.getBBoxOfElement(w);c=g.distance(C.getCenter()),c<a&&c<f&&(d===w||this.validateConnection(...i.getValidateConnectionArgs(_,w),_.getEdgeTerminal(w,t,e,this.cell,i.terminalType)))&&(f=c,i.closestView=_,i.closestMagnet=w)}})});let p;const v=i.terminalType,m=i.closestView,y=i.closestMagnet,b=d!==y;if(u&&b&&u.unhighlight(d,{type:"magnetAdsorbed"}),m){if(!b)return;m.highlight(y,{type:"magnetAdsorbed"}),p=m.getEdgeTerminal(y,t,e,this.cell,v)}else p={x:t,y:e};this.cell.setTerminal(v,p,{},Object.assign(Object.assign({},i.options),{ui:!0}))}snapArrowheadEnd(t){const e=t.closestView,i=t.closestMagnet;e&&i&&(e.unhighlight(i,{type:"magnetAdsorbed"}),t.currentMagnet=e.findMagnet(i)),t.closestView=null,t.closestMagnet=null}finishEmbedding(t){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(t.zIndex=null)}fallbackConnection(t){switch(t.fallbackAction){case"remove":this.cell.remove({ui:!0});break;case"revert":default:this.cell.prop(t.terminalType,t.initialTerminal,{ui:!0});break}}notifyConnectionEvent(t,e){const i=t.terminalType,r=t.initialTerminal,o=this.cell[i];if(o&&!Qi.equalTerminals(r,o)){const a=this.graph,l=r,h=l.cell?a.getCellById(l.cell):null,u=l.port,d=h?a.findViewByCell(h):null,c=h||t.isNewEdge?null:tt.create(r).toJSON(),f=o,g=f.cell?a.getCellById(f.cell):null,p=f.port,v=g?a.findViewByCell(g):null,m=g?null:tt.create(o).toJSON();this.notify("edge:connected",{e,previousCell:h,previousPort:u,previousView:d,previousPoint:c,currentCell:g,currentView:v,currentPort:p,currentPoint:m,previousMagnet:t.initialMagnet,currentMagnet:t.currentMagnet,edge:this.cell,view:this,type:i,isNew:t.isNewEdge})}}highlightAvailableMagnets(t){const e=this.graph,i=e.model.getCells();t.marked={};for(let r=0,o=i.length;r<o;r+=1){const s=e.findViewByCell(i[r]);if(!s||s.cell.id===this.cell.id)continue;const a=Array.prototype.slice.call(s.container.querySelectorAll("[magnet]"));s.container.getAttribute("magnet")!=="false"&&a.push(s.container);const l=a.filter(h=>this.validateConnection(...t.getValidateConnectionArgs(s,h),s.getEdgeTerminal(h,t.x,t.y,this.cell,t.terminalType)));if(l.length>0){for(let h=0,u=l.length;h<u;h+=1)s.highlight(l[h],{type:"magnetAvailable"});s.highlight(null,{type:"nodeAvailable"}),t.marked[s.cell.id]=l}}}unhighlightAvailableMagnets(t){const e=t.marked||{};Object.keys(e).forEach(i=>{const r=this.graph.findViewByCell(i);r&&(e[i].forEach(s=>{r.unhighlight(s,{type:"magnetAvailable"})}),r.unhighlight(null,{type:"nodeAvailable"}))}),t.marked=null}startArrowheadDragging(t,e,i){if(!this.can("arrowheadMovable")){this.notifyUnhandledMouseDown(t,e,i);return}const o=t.target.getAttribute("data-terminal"),s=this.prepareArrowheadDragging(o,{x:e,y:i});this.setEventData(t,s)}dragArrowhead(t,e,i){const r=this.getEventData(t);this.graph.options.connecting.snap?this.snapArrowhead(e,i,r):this.arrowheadDragging(this.getEventTarget(t),e,i,r)}stopArrowheadDragging(t,e,i){const r=this.graph,o=this.getEventData(t);r.options.connecting.snap?this.snapArrowheadEnd(o):this.arrowheadDragged(o,e,i),this.validateEdge(this.cell,o.terminalType,o.initialTerminal)?(this.finishEmbedding(o),this.notifyConnectionEvent(o,t)):this.fallbackConnection(o),this.afterArrowheadDragging(o)}startLabelDragging(t,e,i){if(this.can("edgeLabelMovable")){const r=t.currentTarget,o=parseInt(r.getAttribute("data-index"),10),s=this.getLabelPositionAngle(o),a=this.getLabelPositionArgs(o),l=this.getDefaultLabelPositionArgs(),h=this.mergeLabelPositionArgs(a,l);this.setEventData(t,{index:o,positionAngle:s,positionArgs:h,stopPropagation:!0,action:"drag-label"})}else this.setEventData(t,{stopPropagation:!0});this.graph.view.delegateDragEvents(t,this)}dragLabel(t,e,i){const r=this.getEventData(t),o=this.cell.getLabelAt(r.index),s=Cn({},o,{position:this.getLabelPosition(e,i,r.positionAngle,r.positionArgs)});this.cell.setLabelAt(r.index,s)}stopLabelDragging(t,e,i){}}(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag],r=e;return(i==null||i===n.toStringTag)&&typeof r.isNodeView=="function"&&typeof r.isEdgeView=="function"&&typeof r.confirmUpdate=="function"&&typeof r.update=="function"&&typeof r.getConnection=="function"}n.isEdgeView=t})(jl||(jl={}));jl.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}});jl.registry.register("edge",jl,!0);var xyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class Va extends Bi{get disposeContainer(){return!1}get options(){return this.graph.options}constructor(t){super(),this.graph=t;const{selectors:e,fragment:i}=Mi.parseJSONMarkup(Va.markup);this.background=e.background,this.grid=e.grid,this.svg=e.svg,this.defs=e.defs,this.viewport=e.viewport,this.primer=e.primer,this.stage=e.stage,this.decorator=e.decorator,this.overlay=e.overlay,this.container=this.options.container,this.restore=Va.snapshoot(this.container),je(this.container,this.prefixClassName("graph")),my(this.container,i),this.delegateEvents()}delegateEvents(){const t=this.constructor;return super.delegateEvents(t.events),this}guard(t,e){return t.type==="mousedown"&&t.button===2||this.options.guard&&this.options.guard(t,e)?!0:t.data&&t.data.guarded!==void 0?t.data.guarded:!(e&&e.cell&&Re.isCell(e.cell)||this.svg===t.target||this.container===t.target||this.svg.contains(t.target))}findView(t){return this.graph.findViewByElem(t)}onDblClick(t){this.options.preventDefaultDblClick&&t.preventDefault();const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.guard(e,i))return;const r=this.graph.snapToGrid(e.clientX,e.clientY);i?i.onDblClick(e,r.x,r.y):this.graph.trigger("blank:dblclick",{e,x:r.x,y:r.y})}onClick(t){if(this.getMouseMovedCount(t)<=this.options.clickThreshold){const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.guard(e,i))return;const r=this.graph.snapToGrid(e.clientX,e.clientY);i?i.onClick(e,r.x,r.y):this.graph.trigger("blank:click",{e,x:r.x,y:r.y})}}isPreventDefaultContextMenu(t){let e=this.options.preventDefaultContextMenu;return typeof e=="function"&&(e=Qt(e,this.graph,{view:t})),e}onContextMenu(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.isPreventDefaultContextMenu(i)&&t.preventDefault(),this.guard(e,i))return;const r=this.graph.snapToGrid(e.clientX,e.clientY);i?i.onContextMenu(e,r.x,r.y):this.graph.trigger("blank:contextmenu",{e,x:r.x,y:r.y})}delegateDragEvents(t,e){t.data==null&&(t.data={}),this.setEventData(t,{currentView:e||null,mouseMovedCount:0,startPosition:{x:t.clientX,y:t.clientY}});const i=this.constructor;this.delegateDocumentEvents(i.documentEvents,t.data),this.undelegateEvents()}getMouseMovedCount(t){return this.getEventData(t).mouseMovedCount||0}onMouseDown(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.guard(e,i))return;this.options.preventDefaultMouseDown&&t.preventDefault();const r=this.graph.snapToGrid(e.clientX,e.clientY);i?i.onMouseDown(e,r.x,r.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(e.type)&&t.preventDefault(),this.graph.trigger("blank:mousedown",{e,x:r.x,y:r.y})),this.delegateDragEvents(e,i)}onMouseMove(t){const e=this.getEventData(t),i=e.startPosition;if(i&&i.x===t.clientX&&i.y===t.clientY||(e.mouseMovedCount==null&&(e.mouseMovedCount=0),e.mouseMovedCount+=1,e.mouseMovedCount<=this.options.moveThreshold))return;const o=this.normalizeEvent(t),s=this.graph.snapToGrid(o.clientX,o.clientY),a=e.currentView;a?a.onMouseMove(o,s.x,s.y):this.graph.trigger("blank:mousemove",{e:o,x:s.x,y:s.y}),this.setEventData(o,e)}onMouseUp(t){this.undelegateDocumentEvents();const e=this.normalizeEvent(t),i=this.graph.snapToGrid(e.clientX,e.clientY),o=this.getEventData(t).currentView;if(o?o.onMouseUp(e,i.x,i.y):this.graph.trigger("blank:mouseup",{e,x:i.x,y:i.y}),!t.isPropagationStopped()){const s=new Da(t,{type:"click",data:t.data});this.onClick(s)}t.stopImmediatePropagation(),this.delegateEvents()}onMouseOver(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(!this.guard(e,i))if(i)i.onMouseOver(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseover",{e})}}onMouseOut(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(!this.guard(e,i))if(i)i.onMouseOut(e);else{if(this.container===e.target)return;this.graph.trigger("blank:mouseout",{e})}}onMouseEnter(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.guard(e,i))return;const r=this.graph.findViewByElem(e.relatedTarget);if(i){if(r===i)return;i.onMouseEnter(e)}else{if(r)return;this.graph.trigger("graph:mouseenter",{e})}}onMouseLeave(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.guard(e,i))return;const r=this.graph.findViewByElem(e.relatedTarget);if(i){if(r===i)return;i.onMouseLeave(e)}else{if(r)return;this.graph.trigger("graph:mouseleave",{e})}}onMouseWheel(t){const e=this.normalizeEvent(t),i=this.findView(e.target);if(this.guard(e,i))return;const r=e.originalEvent,o=this.graph.snapToGrid(r.clientX,r.clientY),s=Math.max(-1,Math.min(1,r.wheelDelta||-r.detail));i?i.onMouseWheel(e,o.x,o.y,s):this.graph.trigger("blank:mousewheel",{e,delta:s,x:o.x,y:o.y})}onCustomEvent(t){const e=t.currentTarget,i=e.getAttribute("event")||e.getAttribute("data-event");if(i){const r=this.findView(e);if(r){const o=this.normalizeEvent(t);if(this.guard(o,r))return;const s=this.graph.snapToGrid(o.clientX,o.clientY);r.onCustomEvent(o,i,s.x,s.y)}}}handleMagnetEvent(t,e){const i=t.currentTarget,r=i.getAttribute("magnet");if(r&&r.toLowerCase()!=="false"){const o=this.findView(i);if(o){const s=this.normalizeEvent(t);if(this.guard(s,o))return;const a=this.graph.snapToGrid(s.clientX,s.clientY);Qt(e,this.graph,o,s,i,a.x,a.y)}}}onMagnetMouseDown(t){this.handleMagnetEvent(t,(e,i,r,o,s)=>{e.onMagnetMouseDown(i,r,o,s)})}onMagnetDblClick(t){this.handleMagnetEvent(t,(e,i,r,o,s)=>{e.onMagnetDblClick(i,r,o,s)})}onMagnetContextMenu(t){const e=this.findView(t.target);this.isPreventDefaultContextMenu(e)&&t.preventDefault(),this.handleMagnetEvent(t,(i,r,o,s,a)=>{i.onMagnetContextMenu(r,o,s,a)})}onLabelMouseDown(t){const e=t.currentTarget,i=this.findView(e);if(i){const r=this.normalizeEvent(t);if(this.guard(r,i))return;const o=this.graph.snapToGrid(r.clientX,r.clientY);i.onLabelMouseDown(r,o.x,o.y)}}onImageDragStart(){return!1}dispose(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=()=>{}}}xyt([Bi.dispose()],Va.prototype,"dispose",null);(function(n){const t=`${Ks.prefixCls}-graph`;n.markup=[{ns:Dn.xhtml,tagName:"div",selector:"background",className:`${t}-background`},{ns:Dn.xhtml,tagName:"div",selector:"grid",className:`${t}-grid`},{ns:Dn.svg,tagName:"svg",selector:"svg",className:`${t}-svg`,attrs:{width:"100%",height:"100%","xmlns:xlink":Dn.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:`${t}-svg-viewport`,children:[{tagName:"g",selector:"primer",className:`${t}-svg-primer`},{tagName:"g",selector:"stage",className:`${t}-svg-stage`},{tagName:"g",selector:"decorator",className:`${t}-svg-decorator`},{tagName:"g",selector:"overlay",className:`${t}-svg-overlay`}]}]}];function e(i){const r=i.cloneNode();return i.childNodes.forEach(o=>r.appendChild(o)),()=>{for(vy(i);i.attributes.length>0;)i.removeAttribute(i.attributes[0].name);for(let o=0,s=r.attributes.length;o<s;o+=1){const a=r.attributes[o];i.setAttribute(a.name,a.value)}r.childNodes.forEach(o=>i.appendChild(o))}}n.snapshoot=e})(Va||(Va={}));(function(n){const t=Ks.prefixCls;n.events={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel",[`mouseenter  .${t}-cell`]:"onMouseEnter",[`mouseleave  .${t}-cell`]:"onMouseLeave",[`mouseenter  .${t}-cell-tools`]:"onMouseEnter",[`mouseleave  .${t}-cell-tools`]:"onMouseLeave",[`mousedown   .${t}-cell [event]`]:"onCustomEvent",[`touchstart  .${t}-cell [event]`]:"onCustomEvent",[`mousedown   .${t}-cell [data-event]`]:"onCustomEvent",[`touchstart  .${t}-cell [data-event]`]:"onCustomEvent",[`dblclick    .${t}-cell [magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [magnet]`]:"onMagnetMouseDown",[`dblclick    .${t}-cell [data-magnet]`]:"onMagnetDblClick",[`contextmenu .${t}-cell [data-magnet]`]:"onMagnetContextMenu",[`mousedown   .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`touchstart  .${t}-cell [data-magnet]`]:"onMagnetMouseDown",[`dragstart   .${t}-cell image`]:"onImageDragStart",[`mousedown   .${t}-edge .${t}-edge-label`]:"onLabelMouseDown",[`touchstart  .${t}-edge .${t}-edge-label`]:"onLabelMouseDown"},n.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})(Va||(Va={}));const Syt=`.x6-graph {
  position: relative;
  overflow: hidden;
  outline: none;
  touch-action: none;
}
.x6-graph-background,
.x6-graph-grid,
.x6-graph-svg {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
.x6-graph-background-stage,
.x6-graph-grid-stage,
.x6-graph-svg-stage {
  user-select: none;
}
.x6-graph.x6-graph-pannable {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}
.x6-graph.x6-graph-panning {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
  user-select: none;
}
.x6-node {
  cursor: move;
  /* stylelint-disable-next-line */
}
.x6-node.x6-node-immovable {
  cursor: default;
}
.x6-node * {
  -webkit-user-drag: none;
}
.x6-node .scalable * {
  vector-effect: non-scaling-stroke;
}
.x6-node [magnet='true'] {
  cursor: crosshair;
  transition: opacity 0.3s;
}
.x6-node [magnet='true']:hover {
  opacity: 0.7;
}
.x6-node foreignObject {
  display: block;
  overflow: visible;
  background-color: transparent;
}
.x6-node foreignObject > body {
  position: static;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: visible;
  background-color: transparent;
}
.x6-edge .source-marker,
.x6-edge .target-marker {
  vector-effect: non-scaling-stroke;
}
.x6-edge .connection {
  stroke-linejoin: round;
  fill: none;
}
.x6-edge .connection-wrap {
  cursor: move;
  opacity: 0;
  fill: none;
  stroke: #000;
  stroke-width: 15;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.x6-edge .connection-wrap:hover {
  opacity: 0.4;
  stroke-opacity: 0.4;
}
.x6-edge .vertices {
  cursor: move;
  opacity: 0;
}
.x6-edge .vertices .vertex {
  fill: #1abc9c;
}
.x6-edge .vertices .vertex :hover {
  fill: #34495e;
  stroke: none;
}
.x6-edge .vertices .vertex-remove {
  cursor: pointer;
  fill: #fff;
}
.x6-edge .vertices .vertex-remove-area {
  cursor: pointer;
  opacity: 0.1;
}
.x6-edge .vertices .vertex-group:hover .vertex-remove-area {
  opacity: 1;
}
.x6-edge .arrowheads {
  cursor: move;
  opacity: 0;
}
.x6-edge .arrowheads .arrowhead {
  fill: #1abc9c;
}
.x6-edge .arrowheads .arrowhead :hover {
  fill: #f39c12;
  stroke: none;
}
.x6-edge .tools {
  cursor: pointer;
  opacity: 0;
}
.x6-edge .tools .tool-options {
  display: none;
}
.x6-edge .tools .tool-remove circle {
  fill: #f00;
}
.x6-edge .tools .tool-remove path {
  fill: #fff;
}
.x6-edge:hover .vertices,
.x6-edge:hover .arrowheads,
.x6-edge:hover .tools {
  opacity: 1;
}
.x6-highlight-opacity {
  opacity: 0.3;
}
.x6-cell-tool-editor {
  position: relative;
  display: inline-block;
  min-height: 1em;
  margin: 0;
  padding: 0;
  line-height: 1;
  white-space: normal;
  text-align: center;
  vertical-align: top;
  overflow-wrap: normal;
  outline: none;
  transform-origin: 0 0;
  -webkit-user-drag: none;
}
.x6-edge-tool-editor {
  border: 1px solid #275fc5;
  border-radius: 2px;
}
`;class Nn extends Gl{get options(){return this.graph.options}get model(){return this.graph.model}get view(){return this.graph.view}constructor(t){super(),this.graph=t,this.init()}init(){}}var Ayt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class sP extends Nn{init(){Lpt("core",Syt)}dispose(){Opt("core")}}Ayt([sP.dispose()],sP.prototype,"dispose",null);var Tyt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e},mm;(function(n){function t(e){const{grid:i,panning:r,mousewheel:o,embedding:s}=e,a=Tyt(e,["grid","panning","mousewheel","embedding"]),l=e.container;if(l!=null)a.width==null&&(a.width=l.clientWidth),a.height==null&&(a.height=l.clientHeight);else throw new Error("Ensure the container of the graph is specified and valid");const h=Cn({},n.defaults,a),u={size:10,visible:!1};return typeof i=="number"?h.grid={size:i,visible:!1}:typeof i=="boolean"?h.grid=Object.assign(Object.assign({},u),{visible:i}):h.grid=Object.assign(Object.assign({},u),i),["panning","mousewheel","embedding"].forEach(c=>{const f=e[c];typeof f=="boolean"?h[c].enabled=f:h[c]=Object.assign(Object.assign({},h[c]),f)}),h}n.get=t})(mm||(mm={}));(function(n){n.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:Ks.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:Ks.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection({type:t,sourceView:e,targetView:i}){return(t==="target"?i:e)!=null},createEdge(){return new yyt}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:()=>!0},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:()=>!1}})(mm||(mm={}));var Myt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},Ryt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class uO extends Nn{get elem(){return this.view.grid}get grid(){return this.options.grid}init(){this.startListening(),this.draw(this.grid)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}setVisible(t){this.grid.visible!==t&&(this.grid.visible=t,this.update())}getGridSize(){return this.grid.size}setGridSize(t){this.grid.size=Math.max(t,1),this.update()}show(){this.setVisible(!0),this.update()}hide(){this.setVisible(!1),this.update()}clear(){this.elem.style.backgroundImage=""}draw(t){this.clear(),this.instance=null,Object.assign(this.grid,t),this.patterns=this.resolveGrid(t),this.update()}update(t={}){const e=this.grid.size;if(e<=1||!this.grid.visible)return this.clear();const i=this.graph.matrix(),r=this.getInstance(),o=Array.isArray(t)?t:[t];this.patterns.forEach((l,h)=>{const u=`pattern_${h}`,d=i.a||1,c=i.d||1,{update:f,markup:g}=l,p=Ryt(l,["update","markup"]),v=Object.assign(Object.assign(Object.assign({},p),o[h]),{sx:d,sy:c,ox:i.e||0,oy:i.f||0,width:e*d,height:e*c});r.has(u)||r.add(u,qt.create("pattern",{id:u,patternUnits:"userSpaceOnUse"},qt.createVectors(g)).node);const m=r.get(u);typeof f=="function"&&f(m.childNodes[0],v);let y=v.ox%v.width;y<0&&(y+=v.width);let b=v.oy%v.height;b<0&&(b+=v.height),mi(m,{x:y,y:b,width:v.width,height:v.height})});const s=new XMLSerializer().serializeToString(r.root),a=`url(data:image/svg+xml;base64,${btoa(s)})`;this.elem.style.backgroundImage=a}getInstance(){return this.instance||(this.instance=new Lh),this.instance}resolveGrid(t){if(!t)return[];const e=t.type;if(e==null)return[Object.assign(Object.assign({},Lh.presets.dot),t.args)];const i=Lh.registry.get(e);if(i){let r=t.args||[];return Array.isArray(r)||(r=[r]),Array.isArray(i)?i.map((o,s)=>Object.assign(Object.assign({},o),r[s])):[Object.assign(Object.assign({},i),r[0])]}return Lh.registry.onNotFound(e)}dispose(){this.stopListening(),this.clear()}}Myt([Nn.dispose()],uO.prototype,"dispose",null);class LX extends Nn{get container(){return this.graph.view.container}get viewport(){return this.graph.view.viewport}get stage(){return this.graph.view.stage}init(){this.resize()}getMatrix(){const t=this.viewport.getAttribute("transform");return t!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=t),zn(this.viewportMatrix)}setMatrix(t){const e=zn(t),i=bp(e);this.viewport.setAttribute("transform",i),this.viewportMatrix=e,this.viewportTransformString=i}resize(t,e){let i=t===void 0?this.options.width:t,r=e===void 0?this.options.height:e;this.options.width=i,this.options.height=r,typeof i=="number"&&(i=Math.round(i)),typeof r=="number"&&(r=Math.round(r)),this.container.style.width=i==null?"":`${i}px`,this.container.style.height=r==null?"":`${r}px`;const o=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},o)),this}getComputedSize(){let t=this.options.width,e=this.options.height;return qD(t)||(t=this.container.clientWidth),qD(e)||(e=this.container.clientHeight),{width:t,height:e}}getScale(){return Spt(this.getMatrix())}scale(t,e=t,i=0,r=0){if(t=this.clampScale(t),e=this.clampScale(e),i||r){const s=this.getTranslation(),a=s.tx-i*(t-1),l=s.ty-r*(e-1);(a!==s.tx||l!==s.ty)&&this.translate(a,l)}const o=this.getMatrix();return o.a=t,o.d=e,this.setMatrix(o),this.graph.trigger("scale",{sx:t,sy:e,ox:i,oy:r}),this}clampScale(t){const e=this.graph.options.scaling;return is(t,e.min||.01,e.max||16)}getZoom(){return this.getScale().sx}zoom(t,e){e=e||{};let i=t,r=t;const o=this.getScale(),s=this.getComputedSize();let a=s.width/2,l=s.height/2;if(e.absolute||(i+=o.sx,r+=o.sy),e.scaleGrid&&(i=Math.round(i/e.scaleGrid)*e.scaleGrid,r=Math.round(r/e.scaleGrid)*e.scaleGrid),e.maxScale&&(i=Math.min(e.maxScale,i),r=Math.min(e.maxScale,r)),e.minScale&&(i=Math.max(e.minScale,i),r=Math.max(e.minScale,r)),e.center&&(a=e.center.x,l=e.center.y),i=this.clampScale(i),r=this.clampScale(r),a||l){const h=this.getTranslation(),u=a-(a-h.tx)*(i/o.sx),d=l-(l-h.ty)*(r/o.sy);(u!==h.tx||d!==h.ty)&&this.translate(u,d)}return this.scale(i,r),this}getRotation(){return Apt(this.getMatrix())}rotate(t,e,i){if(e==null||i==null){const o=oi.getBBox(this.stage);e=o.width/2,i=o.height/2}const r=this.getMatrix().translate(e,i).rotate(t).translate(-e,-i);return this.setMatrix(r),this}getTranslation(){return Tpt(this.getMatrix())}translate(t,e){const i=this.getMatrix();i.e=t||0,i.f=e||0,this.setMatrix(i);const r=this.getTranslation();return this.options.x=r.tx,this.options.y=r.ty,this.graph.trigger("translate",Object.assign({},r)),this}setOrigin(t,e){return this.translate(t||0,e||0)}fitToContent(t,e,i,r){if(typeof t=="object"){const b=t;t=b.gridWidth||1,e=b.gridHeight||1,i=b.padding||0,r=b}else t=t||1,e=e||1,i=i||0,r==null&&(r={});const o=lc(i),s=r.border||0,a=r.contentArea?Ct.create(r.contentArea):this.getContentArea(r);s>0&&a.inflate(s);const l=this.getScale(),h=this.getTranslation(),u=l.sx,d=l.sy;a.x*=u,a.y*=d,a.width*=u,a.height*=d;let c=Math.max(Math.ceil((a.width+a.x)/t),1)*t,f=Math.max(Math.ceil((a.height+a.y)/e),1)*e,g=0,p=0;(r.allowNewOrigin==="negative"&&a.x<0||r.allowNewOrigin==="positive"&&a.x>=0||r.allowNewOrigin==="any")&&(g=Math.ceil(-a.x/t)*t,g+=o.left,c+=g),(r.allowNewOrigin==="negative"&&a.y<0||r.allowNewOrigin==="positive"&&a.y>=0||r.allowNewOrigin==="any")&&(p=Math.ceil(-a.y/e)*e,p+=o.top,f+=p),c+=o.right,f+=o.bottom,c=Math.max(c,r.minWidth||0),f=Math.max(f,r.minHeight||0),c=Math.min(c,r.maxWidth||Number.MAX_SAFE_INTEGER),f=Math.min(f,r.maxHeight||Number.MAX_SAFE_INTEGER);const v=this.getComputedSize(),m=c!==v.width||f!==v.height;return(g!==h.tx||p!==h.ty)&&this.translate(g,p),m&&this.resize(c,f),new Ct(-g/u,-p/d,c/u,f/d)}scaleContentToFit(t={}){this.scaleContentToFitImpl(t)}scaleContentToFitImpl(t={},e=!0){let i,r;if(t.contentArea){const m=t.contentArea;i=this.graph.localToGraph(m),r=tt.create(m)}else i=this.getContentBBox(t),r=this.graph.graphToLocal(i);if(!i.width||!i.height)return;const o=lc(t.padding),s=t.minScale||0,a=t.maxScale||Number.MAX_SAFE_INTEGER,l=t.minScaleX||s,h=t.maxScaleX||a,u=t.minScaleY||s,d=t.maxScaleY||a;let c;if(t.viewportArea)c=t.viewportArea;else{const m=this.getComputedSize(),y=this.getTranslation();c={x:y.tx,y:y.ty,width:m.width,height:m.height}}c=Ct.create(c).moveAndExpand({x:o.left,y:o.top,width:-o.left-o.right,height:-o.top-o.bottom});const f=this.getScale();let g=c.width/i.width*f.sx,p=c.height/i.height*f.sy;t.preserveAspectRatio!==!1&&(g=p=Math.min(g,p));const v=t.scaleGrid;if(v&&(g=v*Math.floor(g/v),p=v*Math.floor(p/v)),g=is(g,l,h),p=is(p,u,d),this.scale(g,p),e){const m=this.options,y=c.x-r.x*g-m.x,b=c.y-r.y*p-m.y;this.translate(y,b)}}getContentArea(t={}){return t.useCellGeometry!==!1?this.model.getAllCellsBBox()||new Ct:oi.getBBox(this.stage)}getContentBBox(t={}){return this.graph.localToGraph(this.getContentArea(t))}getGraphArea(){const t=Ct.fromSize(this.getComputedSize());return this.graph.graphToLocal(t)}zoomToRect(t,e={}){const i=Ct.create(t),r=this.graph;e.contentArea=i,e.viewportArea==null&&(e.viewportArea={x:r.options.x,y:r.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(e,!1);const o=i.getCenter();return this.centerPoint(o.x,o.y),this}zoomToFit(t={}){return this.zoomToRect(this.getContentArea(t),t)}centerPoint(t,e){const i=this.getComputedSize(),r=this.getScale(),o=this.getTranslation(),s=i.width/2,a=i.height/2;t=typeof t=="number"?t:s,e=typeof e=="number"?e:a,t=s-t*r.sx,e=a-e*r.sy,(o.tx!==t||o.ty!==e)&&this.translate(t,e)}centerContent(t){const i=this.graph.getContentArea(t).getCenter();this.centerPoint(i.x,i.y)}centerCell(t){return this.positionCell(t,"center")}positionPoint(t,e,i){const r=this.getComputedSize();e=Gs(e,Math.max(0,r.width)),e<0&&(e=r.width+e),i=Gs(i,Math.max(0,r.height)),i<0&&(i=r.height+i);const o=this.getTranslation(),s=this.getScale(),a=e-t.x*s.sx,l=i-t.y*s.sy;(o.tx!==a||o.ty!==l)&&this.translate(a,l)}positionRect(t,e){const i=Ct.create(t);switch(e){case"center":return this.positionPoint(i.getCenter(),"50%","50%");case"top":return this.positionPoint(i.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(i.getTopRight(),"100%",0);case"right":return this.positionPoint(i.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(i.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(i.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(i.getBottomLeft(),0,"100%");case"left":return this.positionPoint(i.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(i.getTopLeft(),0,0);default:return this}}positionCell(t,e){const i=t.getBBox();return this.positionRect(i,e)}positionContent(t,e){const i=this.graph.getContentArea(e);return this.positionRect(i,t)}}var Byt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class dO extends Nn{get elem(){return this.view.background}init(){this.startListening(),this.options.background&&this.draw(this.options.background)}startListening(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}stopListening(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}updateBackgroundImage(t={}){let e=t.size||"auto auto",i=t.position||"center";const r=this.graph.transform.getScale(),o=this.graph.translate();if(typeof i=="object"){const s=o.tx+r.sx*(i.x||0),a=o.ty+r.sy*(i.y||0);i=`${s}px ${a}px`}typeof e=="object"&&(e=Ct.fromSize(e).scale(r.sx,r.sy),e=`${e.width}px ${e.height}px`),this.elem.style.backgroundSize=e,this.elem.style.backgroundPosition=i}drawBackgroundImage(t,e={}){if(!(t instanceof HTMLImageElement)){this.elem.style.backgroundImage="";return}const i=this.optionsCache;if(i&&i.image!==e.image)return;let r;const o=e.opacity,s=e.size;let a=e.repeat||"no-repeat";const l=cm.registry.get(a);if(typeof l=="function"){const u=e.quality||1;t.width*=u,t.height*=u;const d=l(t,e);if(!(d instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");r=d.toDataURL("image/png"),e.repeat&&a!==e.repeat?a=e.repeat:a="repeat",typeof s=="object"?(s.width*=d.width/t.width,s.height*=d.height/t.height):s===void 0&&(e.size={width:d.width/u,height:d.height/u})}else r=t.src,s===void 0&&(e.size={width:t.width,height:t.height});i!=null&&typeof e.size=="object"&&e.image===i.image&&e.repeat===i.repeat&&e.quality===i.quality&&(i.size=T2(e.size));const h=this.elem.style;h.backgroundImage=`url(${r})`,h.backgroundRepeat=a,h.opacity=o==null||o>=1?"":`${o}`,this.updateBackgroundImage(e)}updateBackgroundColor(t){this.elem.style.backgroundColor=t||""}updateBackgroundOptions(t){this.graph.options.background=t}update(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}draw(t){const e=t||{};if(this.updateBackgroundOptions(t),this.updateBackgroundColor(e.color),e.image){this.optionsCache=T2(e);const i=document.createElement("img");i.onload=()=>this.drawBackgroundImage(i,t),i.setAttribute("crossorigin","anonymous"),i.src=e.image}else this.drawBackgroundImage(null),this.optionsCache=null}clear(){this.draw()}dispose(){this.clear(),this.stopListening()}}Byt([Nn.dispose()],dO.prototype,"dispose",null);var Pyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class cO extends Nn{get widgetOptions(){return this.options.panning}get pannable(){return this.widgetOptions&&this.widgetOptions.enabled===!0}init(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}startListening(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),Xn.on(this.graph.container,"mousedown",this.onRightMouseDown),Xn.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new HU(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}stopListening(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),Xn.off(this.graph.container,"mousedown",this.onRightMouseDown),Xn.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}allowPanning(t,e){return t.spaceKey=this.isSpaceKeyPressed,this.pannable&&kg.isMatch(t,this.widgetOptions.modifiers,e)}startPanning(t){const e=this.view.normalizeEvent(t);this.clientX=e.clientX,this.clientY=e.clientY,this.panning=!0,this.updateClassName(),Xn.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Xn.on(window,"mouseup.panning",this.stopPanning.bind(this))}pan(t){const e=this.view.normalizeEvent(t),i=e.clientX-this.clientX,r=e.clientY-this.clientY;this.clientX=e.clientX,this.clientY=e.clientY,this.graph.translateBy(i,r)}stopPanning(t){this.panning=!1,this.updateClassName(),Xn.off(document.body,".panning"),Xn.off(window,".panning")}updateClassName(){const t=this.view.container,e=this.view.prefixClassName("graph-panning"),i=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(je(t,e),rs(t,i)):(rs(t,e),je(t,i)):(rs(t,e),rs(t,i))}onMouseDown({e:t}){if(!this.allowBlankMouseDown(t))return;const e=this.graph.getPlugin("selection"),i=e&&e.allowRubberband(t,!0);(this.allowPanning(t,!0)||this.allowPanning(t)&&!i)&&this.startPanning(t)}onRightMouseDown(t){const e=this.widgetOptions.eventTypes;e?.includes("rightMouseDown")&&t.button===2&&this.allowPanning(t,!0)&&this.startPanning(t)}onMouseWheel(t,e,i){this.graph.translateBy(-e,-i)}onSpaceKeyDown(t){t.which===32&&(this.isSpaceKeyPressed=!0)}onSpaceKeyUp(t){t.which===32&&(this.isSpaceKeyPressed=!1)}allowBlankMouseDown(t){const e=this.widgetOptions.eventTypes;return e?.includes("leftMouseDown")&&t.button===0||e?.includes("mouseWheelDown")&&t.button===1}allowMouseWheel(t){var e;return this.pannable&&!t.ctrlKey&&((e=this.widgetOptions.eventTypes)===null||e===void 0?void 0:e.includes("mouseWheel"))}autoPanning(t,e){const r=this.graph.getGraphArea();let o=0,s=0;t<=r.left+10&&(o=-10),e<=r.top+10&&(s=-10),t>=r.right-10&&(o=10),e>=r.bottom-10&&(s=10),(o!==0||s!==0)&&this.graph.translateBy(-o,-s)}enablePanning(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}disablePanning(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}dispose(){this.stopListening()}}Pyt([Nn.dispose()],cO.prototype,"dispose",null);var kyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class fO extends Nn{constructor(){super(...arguments),this.cumulatedFactor=1}get widgetOptions(){return this.options.mousewheel}init(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new HU(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}get disabled(){return this.widgetOptions.enabled!==!0}enable(t){(this.disabled||t)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}disable(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}allowMouseWheel(t){const e=this.widgetOptions.guard;return(e==null||e(t))&&kg.isMatch(t,this.widgetOptions.modifiers)}onMouseWheel(t){const e=this.widgetOptions.guard;if((e==null||e(t))&&kg.isMatch(t,this.widgetOptions.modifiers)){const i=this.widgetOptions.factor||1.2;this.currentScale==null&&(this.startPos={x:t.clientX,y:t.clientY},this.currentScale=this.graph.transform.getScale().sx),t.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*i*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/i)*20)/20/this.currentScale,this.cumulatedFactor===1&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);const o=this.currentScale;let s=this.graph.transform.clampScale(o*this.cumulatedFactor);const a=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,l=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if(s=is(s,a,l),s!==o)if(this.widgetOptions.zoomAtMousePosition){const u=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(s,{absolute:!0,center:u.clone()})}else this.graph.zoom(s,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}dispose(){this.disable()}}kyt([Gl.dispose()],fO.prototype,"dispose",null);var Eyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class OX extends Nn{init(){this.resetRenderArea=WQ(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}startListening(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}stopListening(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}enableVirtualRender(){this.options.virtual=!0,this.resetRenderArea()}disableVirtualRender(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}resetRenderArea(){if(this.options.virtual){const t=this.graph.getGraphArea();this.graph.renderer.setRenderArea(t)}}dispose(){this.stopListening()}}Eyt([Nn.dispose()],OX.prototype,"dispose",null);class Lyt{constructor(){this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}queueJob(t){if(t.priority&bl.PRIOR)t.cb();else{const e=this.findInsertionIndex(t);e>=0&&this.queue.splice(e,0,t)}}queueFlush(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.scheduleJob())}queueFlushSync(){!this.isFlushing&&!this.isFlushPending&&(this.isFlushPending=!0,this.flushJobsSync())}clearJobs(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}flushJobs(){this.isFlushPending=!1,this.isFlushing=!0;const t=this.getCurrentTime();let e;for(;(e=this.queue.shift())&&(e.cb(),!(this.getCurrentTime()-t>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}flushJobsSync(){this.isFlushPending=!1,this.isFlushing=!0;let t;for(;t=this.queue.shift();)try{t.cb()}catch{}this.isFlushing=!1}findInsertionIndex(t){let e=0,i=this.queue.length,r=i-1;const o=t.priority;for(;e<=r;){const s=(r-e>>1)+e;o<=this.queue[s].priority?e=s+1:(i=s,r=s-1)}return i}scheduleJob(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}cancelScheduleJob(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}getCurrentTime(){return typeof performance=="object"&&typeof performance.now=="function"?performance.now():Date.now()-this.initialTime}}var bl;(function(n){n[n.Update=2]="Update",n[n.RenderEdge=4]="RenderEdge",n[n.RenderNode=8]="RenderNode",n[n.PRIOR=1048576]="PRIOR"})(bl||(bl={}));var Oyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class Mn extends Gl{get model(){return this.graph.model}get container(){return this.graph.view.stage}constructor(t){super(),this.views={},this.willRemoveViews={},this.queue=new Lyt,this.graph=t,this.init()}init(){this.startListening(),this.renderViews(this.model.getCells())}startListening(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}stopListening(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}onModelReseted({options:t}){this.queue.clearJobs(),this.removeZPivots(),this.resetViews();const e=this.model.getCells();this.renderViews(e,Object.assign(Object.assign({},t),{queue:e.map(i=>i.id)}))}onCellAdded({cell:t,options:e}){this.renderViews([t],e)}onCellRemoved({cell:t}){this.removeViews([t])}onCellZIndexChanged({cell:t,options:e}){const i=this.views[t.id];i&&this.requestViewUpdate(i.view,Mn.FLAG_INSERT,e,bl.Update,!0)}onCellVisibleChanged({cell:t,current:e}){this.toggleVisible(t,!!e)}requestViewUpdate(t,e,i={},r=bl.Update,o=!0){const s=t.cell.id,a=this.views[s];if(!a)return;a.flag=e,a.options=i,(t.hasAction(e,["translate","resize","rotate"])||i.async===!1)&&(r=bl.PRIOR,o=!1),this.queue.queueJob({id:s,priority:r,cb:()=>{this.renderViewInArea(t,e,i);const u=i.queue;if(u){const d=u.indexOf(t.cell.id);d>=0&&u.splice(d,1),u.length===0&&this.graph.trigger("render:done")}}}),this.getEffectedEdges(t).forEach(u=>{this.requestViewUpdate(u.view,u.flag,i,r,!1)}),o&&this.flush()}setRenderArea(t){this.renderArea=t,this.flushWaitingViews()}isViewMounted(t){if(t==null)return!1;const e=this.views[t.cell.id];return e?e.state===Mn.ViewState.MOUNTED:!1}renderViews(t,e={}){t.sort((i,r)=>i.isNode()&&r.isEdge()?-1:0),t.forEach(i=>{const r=i.id,o=this.views;let s=0,a=o[r];if(a)s=Mn.FLAG_INSERT;else{const l=this.createCellView(i);l&&(l.graph=this.graph,s=Mn.FLAG_INSERT|l.getBootstrapFlag(),a={view:l,flag:s,options:e,state:Mn.ViewState.CREATED},this.views[r]=a)}a&&this.requestViewUpdate(a.view,s,e,this.getRenderPriority(a.view),!1)}),this.flush()}renderViewInArea(t,e,i={}){const r=t.cell,o=r.id,s=this.views[o];if(!s)return;let a=0;this.isUpdatable(t)?(a=this.updateView(t,e,i),s.flag=a):s.state===Mn.ViewState.MOUNTED?(a=this.updateView(t,e,i),s.flag=a):s.state=Mn.ViewState.WAITING,a&&r.isEdge()&&!(a&t.getFlag(["source","target"]))&&this.queue.queueJob({id:o,priority:bl.RenderEdge,cb:()=>{this.updateView(t,e,i)}})}removeViews(t){t.forEach(e=>{const i=e.id,r=this.views[i];r&&(this.willRemoveViews[i]=r,delete this.views[i],this.queue.queueJob({id:i,priority:this.getRenderPriority(r.view),cb:()=>{this.removeView(r.view)}}))}),this.flush()}flush(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}flushWaitingViews(){Object.values(this.views).forEach(t=>{if(t&&t.state===Mn.ViewState.WAITING){const{view:e,flag:i,options:r}=t;this.requestViewUpdate(e,i,r,this.getRenderPriority(e),!1)}}),this.flush()}updateView(t,e,i={}){if(t==null)return 0;if(vn.isCellView(t)){if(e&Mn.FLAG_REMOVE)return this.removeView(t.cell),0;e&Mn.FLAG_INSERT&&(this.insertView(t),e^=Mn.FLAG_INSERT)}return e?t.confirmUpdate(e,i):0}insertView(t){const e=this.views[t.cell.id];if(e){const i=t.cell.getZIndex(),r=this.addZPivot(i);this.container.insertBefore(t.container,r),t.cell.isVisible()||this.toggleVisible(t.cell,!1),e.state=Mn.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:t})}}resetViews(){this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach(t=>{t&&this.removeView(t.view)}),this.views={},this.willRemoveViews={}}removeView(t){const e=t.cell,i=this.willRemoveViews[e.id];i&&t&&(i.view.remove(),delete this.willRemoveViews[e.id],this.graph.trigger("view:unmounted",{view:t}))}toggleVisible(t,e){const i=this.model.getConnectedEdges(t);for(let o=0,s=i.length;o<s;o+=1){const a=i[o];if(e){const l=a.getSourceCell(),h=a.getTargetCell();if(l&&!l.isVisible()||h&&!h.isVisible())continue;this.toggleVisible(a,!0)}else this.toggleVisible(a,!1)}const r=this.views[t.id];r&&yy(r.view.container,{display:e?"unset":"none"})}addZPivot(t=0){this.zPivots==null&&(this.zPivots={});const e=this.zPivots;let i=e[t];if(i)return i;i=e[t]=document.createComment(`z-index:${t+1}`);let r=-1/0;for(const s in e){const a=+s;a<t&&a>r&&(r=a,t-1)}const o=this.container;if(r!==-1/0){const s=e[r];o.insertBefore(i,s.nextSibling)}else o.insertBefore(i,o.firstChild);return i}removeZPivots(){this.zPivots&&Object.values(this.zPivots).forEach(t=>{t&&t.parentNode&&t.parentNode.removeChild(t)}),this.zPivots={}}createCellView(t){const e={graph:this.graph},i=this.graph.options.createCellView;if(i){const o=Qt(i,this.graph,t);if(o)return new o(t,e);if(o===null)return null}const r=t.view;if(r!=null&&typeof r=="string"){const o=vn.registry.get(r);return o?new o(t,e):vn.registry.onNotFound(r)}return t.isNode()?new qs(t,e):t.isEdge()?new jl(t,e):null}getEffectedEdges(t){const e=[],i=t.cell,r=this.model.getConnectedEdges(i);for(let o=0,s=r.length;o<s;o+=1){const a=r[o],l=this.views[a.id];if(!l)continue;const h=l.view;if(!this.isViewMounted(h))continue;const u=["update"];a.getTargetCell()===i&&u.push("target"),a.getSourceCell()===i&&u.push("source"),e.push({id:a.id,view:h,flag:h.getFlag(u)})}return e}isUpdatable(t){if(t.isNodeView())return this.renderArea?this.renderArea.isIntersectWithRect(t.cell.getBBox()):!0;if(t.isEdgeView()){const e=t.cell,i=e.getSourceCell(),r=e.getTargetCell();if(this.renderArea&&i&&r)return this.renderArea.isIntersectWithRect(i.getBBox())||this.renderArea.isIntersectWithRect(r.getBBox())}return!0}getRenderPriority(t){return t.cell.isNode()?bl.RenderNode:bl.RenderEdge}dispose(){this.stopListening(),Object.keys(this.views).forEach(t=>{this.views[t].view.dispose()}),this.views={}}}Oyt([Gl.dispose()],Mn.prototype,"dispose",null);(function(n){n.FLAG_INSERT=1<<30,n.FLAG_REMOVE=1<<29,n.FLAG_RENDER=(1<<26)-1})(Mn||(Mn={}));(function(n){(function(t){t[t.CREATED=0]="CREATED",t[t.MOUNTED=1]="MOUNTED",t[t.WAITING=2]="WAITING"})(n.ViewState||(n.ViewState={}))})(Mn||(Mn={}));var Dyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class gO extends Nn{constructor(){super(...arguments),this.schedule=new Mn(this.graph)}requestViewUpdate(t,e,i={}){this.schedule.requestViewUpdate(t,e,i)}isViewMounted(t){return this.schedule.isViewMounted(t)}setRenderArea(t){this.schedule.setRenderArea(t)}findViewByElem(t){if(t==null)return null;const e=this.options.container,i=typeof t=="string"?e.querySelector(t):t instanceof Element?t:t[0];if(i){const r=this.graph.view.findAttr("data-cell-id",i);if(r){const o=this.schedule.views;if(o[r])return o[r].view}}return null}findViewByCell(t){if(t==null)return null;const e=Re.isCell(t)?t.id:t,i=this.schedule.views;return i[e]?i[e].view:null}findViewsFromPoint(t){const e={x:t.x,y:t.y};return this.model.getCells().map(i=>this.findViewByCell(i)).filter(i=>i!=null?oi.getBBox(i.container,{target:this.view.stage}).containsPoint(e):!1)}findEdgeViewsFromPoint(t,e=5){return this.model.getEdges().map(i=>this.findViewByCell(i)).filter(i=>{if(i!=null){const r=i.getClosestPoint(t);if(r)return r.distance(t)<=e}return!1})}findViewsInArea(t,e={}){const i=Ct.create(t);return this.model.getCells().map(r=>this.findViewByCell(r)).filter(r=>{if(r){if(e.nodeOnly&&!r.isNodeView())return!1;const o=oi.getBBox(r.container,{target:this.view.stage});return o.width===0?o.inflate(1,0):o.height===0&&o.inflate(0,1),e.strict?i.containsRect(o):i.isIntersectWithRect(o)}return!1})}dispose(){this.schedule.dispose()}}Dyt([Nn.dispose()],gO.prototype,"dispose",null);var uN=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class DX extends Nn{get cid(){return this.graph.view.cid}get svg(){return this.view.svg}get defs(){return this.view.defs}isDefined(t){return this.svg.getElementById(t)!=null}filter(t){let e=t.id;const i=t.name;if(e||(e=`filter-${i}-${this.cid}-${iR(JSON.stringify(t))}`),!this.isDefined(e)){const r=Og.registry.get(i);if(r==null)return Og.registry.onNotFound(i);const o=r(t.args||{}),s=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},t.attrs),{id:e});qt.create(Mi.sanitize(o),s).appendTo(this.defs)}return e}gradient(t){let e=t.id;const i=t.type;if(e||(e=`gradient-${i}-${this.cid}-${iR(JSON.stringify(t))}`),!this.isDefined(e)){const o=t.stops.map(l=>{const h=l.opacity!=null&&Number.isFinite(l.opacity)?l.opacity:1;return`<stop offset="${l.offset}" stop-color="${l.color}" stop-opacity="${h}"/>`}),s=`<${i}>${o.join("")}</${i}>`,a=Object.assign({id:e},t.attrs);qt.create(s,a).appendTo(this.defs)}return e}marker(t){const{id:e,refX:i,refY:r,markerUnits:o,markerOrient:s,tagName:a,children:l}=t,h=uN(t,["id","refX","refY","markerUnits","markerOrient","tagName","children"]);let u=e;if(u||(u=`marker-${this.cid}-${iR(JSON.stringify(t))}`),!this.isDefined(u)){a!=="path"&&delete h.d;const d=qt.create("marker",{refX:i,refY:r,id:u,overflow:"visible",orient:s??"auto",markerUnits:o||"userSpaceOnUse"},l?l.map(c=>{var{tagName:f}=c,g=uN(c,["tagName"]);return qt.create(`${f}`||"path",lm(Object.assign(Object.assign({},h),g)))}):[qt.create(a||"path",lm(h))]);this.defs.appendChild(d.node)}return u}remove(t){const e=this.svg.getElementById(t);e&&e.parentNode&&e.parentNode.removeChild(e)}}class IX extends Nn{getClientMatrix(){return zn(this.view.stage.getScreenCTM())}getClientOffset(){const t=this.view.svg.getBoundingClientRect();return new tt(t.left,t.top)}getPageOffset(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}snapToGrid(t,e){return(typeof t=="number"?this.clientToLocalPoint(t,e):this.clientToLocalPoint(t.x,t.y)).snapToGrid(this.graph.getGridSize())}localToGraphPoint(t,e){const i=tt.create(t,e);return oi.transformPoint(i,this.graph.matrix())}localToClientPoint(t,e){const i=tt.create(t,e);return oi.transformPoint(i,this.getClientMatrix())}localToPagePoint(t,e){return(typeof t=="number"?this.localToGraphPoint(t,e):this.localToGraphPoint(t)).translate(this.getPageOffset())}localToGraphRect(t,e,i,r){const o=Ct.create(t,e,i,r);return oi.transformRectangle(o,this.graph.matrix())}localToClientRect(t,e,i,r){const o=Ct.create(t,e,i,r);return oi.transformRectangle(o,this.getClientMatrix())}localToPageRect(t,e,i,r){return(typeof t=="number"?this.localToGraphRect(t,e,i,r):this.localToGraphRect(t)).translate(this.getPageOffset())}graphToLocalPoint(t,e){const i=tt.create(t,e);return oi.transformPoint(i,this.graph.matrix().inverse())}clientToLocalPoint(t,e){const i=tt.create(t,e);return oi.transformPoint(i,this.getClientMatrix().inverse())}clientToGraphPoint(t,e){const i=tt.create(t,e);return oi.transformPoint(i,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalPoint(t,e){const r=tt.create(t,e).diff(this.getPageOffset());return this.graphToLocalPoint(r)}graphToLocalRect(t,e,i,r){const o=Ct.create(t,e,i,r);return oi.transformRectangle(o,this.graph.matrix().inverse())}clientToLocalRect(t,e,i,r){const o=Ct.create(t,e,i,r);return oi.transformRectangle(o,this.getClientMatrix().inverse())}clientToGraphRect(t,e,i,r){const o=Ct.create(t,e,i,r);return oi.transformRectangle(o,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}pageToLocalRect(t,e,i,r){const o=Ct.create(t,e,i,r),s=this.getPageOffset();return o.x-=s.x,o.y-=s.y,this.graphToLocalRect(o)}}var Iyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class Rw extends Nn{constructor(){super(...arguments),this.highlights={}}init(){this.startListening()}startListening(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}stopListening(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}onCellHighlight({view:t,magnet:e,options:i={}}){const r=this.resolveHighlighter(i);if(!r)return;const o=this.getHighlighterId(e,r);if(!this.highlights[o]){const s=r.highlighter;s.highlight(t,e,Object.assign({},r.args)),this.highlights[o]={cellView:t,magnet:e,highlighter:s,args:r.args}}}onCellUnhighlight({magnet:t,options:e={}}){const i=this.resolveHighlighter(e);if(!i)return;const r=this.getHighlighterId(t,i);this.unhighlight(r)}resolveHighlighter(t){const e=this.options;let i=t.highlighter;if(i==null){const a=t.type;i=a&&e.highlighting[a]||e.highlighting.default}if(i==null)return null;const r=typeof i=="string"?{name:i}:i,o=r.name,s=Dl.registry.get(o);return s==null?Dl.registry.onNotFound(o):(Dl.check(o,s),{name:o,highlighter:s,args:r.args||{}})}getHighlighterId(t,e){return eO(t),e.name+t.id+JSON.stringify(e.args)}unhighlight(t){const e=this.highlights[t];e&&(e.highlighter.unhighlight(e.cellView,e.magnet,e.args),delete this.highlights[t])}dispose(){Object.keys(this.highlights).forEach(t=>this.unhighlight(t)),this.stopListening()}}Iyt([Rw.dispose()],Rw.prototype,"dispose",null);var Hyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class HX extends Nn{getScroller(){const t=this.graph.getPlugin("scroller");return t&&t.options.enabled?t:null}getContainer(){const t=this.getScroller();return t?t.container.parentElement:this.graph.container.parentElement}getSensorTarget(){const t=this.options.autoResize;if(t)return typeof t=="boolean"?this.getContainer():t}init(){if(this.options.autoResize){const e=this.getSensorTarget();e&&bw.bind(e,()=>{const i=e.offsetWidth,r=e.offsetHeight;this.resize(i,r)})}}resize(t,e){const i=this.getScroller();i?i.resize(t,e):this.graph.transform.resize(t,e)}dispose(){bw.clear(this.graph.container)}}Hyt([Nn.dispose()],HX.prototype,"dispose",null);var Fyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o};class Jr extends To{get container(){return this.options.container}get[Symbol.toStringTag](){return Jr.toStringTag}constructor(t){super(),this.installedPlugins=new Set,this.options=mm.get(t),this.css=new sP(this),this.view=new Va(this),this.defs=new DX(this),this.coord=new IX(this),this.transform=new LX(this),this.highlight=new Rw(this),this.grid=new uO(this),this.background=new dO(this),this.options.model?this.model=this.options.model:(this.model=new $s,this.model.graph=this),this.renderer=new gO(this),this.panning=new cO(this),this.mousewheel=new fO(this),this.virtualRender=new OX(this),this.size=new HX(this)}isNode(t){return t.isNode()}isEdge(t){return t.isEdge()}resetCells(t,e={}){return this.model.resetCells(t,e),this}clearCells(t={}){return this.model.clear(t),this}toJSON(t={}){return this.model.toJSON(t)}parseJSON(t){return this.model.parseJSON(t)}fromJSON(t,e={}){return this.model.fromJSON(t,e),this}getCellById(t){return this.model.getCell(t)}addNode(t,e={}){return this.model.addNode(t,e)}addNodes(t,e={}){return this.addCell(t.map(i=>Ln.isNode(i)?i:this.createNode(i)),e)}createNode(t){return this.model.createNode(t)}removeNode(t,e={}){return this.model.removeCell(t,e)}addEdge(t,e={}){return this.model.addEdge(t,e)}addEdges(t,e={}){return this.addCell(t.map(i=>Qi.isEdge(i)?i:this.createEdge(i)),e)}removeEdge(t,e={}){return this.model.removeCell(t,e)}createEdge(t){return this.model.createEdge(t)}addCell(t,e={}){return this.model.addCell(t,e),this}removeCell(t,e={}){return this.model.removeCell(t,e)}removeCells(t,e={}){return this.model.removeCells(t,e)}removeConnectedEdges(t,e={}){return this.model.removeConnectedEdges(t,e)}disconnectConnectedEdges(t,e={}){return this.model.disconnectConnectedEdges(t,e),this}hasCell(t){return this.model.has(t)}getCells(){return this.model.getCells()}getCellCount(){return this.model.total()}getNodes(){return this.model.getNodes()}getEdges(){return this.model.getEdges()}getOutgoingEdges(t){return this.model.getOutgoingEdges(t)}getIncomingEdges(t){return this.model.getIncomingEdges(t)}getConnectedEdges(t,e={}){return this.model.getConnectedEdges(t,e)}getRootNodes(){return this.model.getRoots()}getLeafNodes(){return this.model.getLeafs()}isRootNode(t){return this.model.isRoot(t)}isLeafNode(t){return this.model.isLeaf(t)}getNeighbors(t,e={}){return this.model.getNeighbors(t,e)}isNeighbor(t,e,i={}){return this.model.isNeighbor(t,e,i)}getSuccessors(t,e={}){return this.model.getSuccessors(t,e)}isSuccessor(t,e,i={}){return this.model.isSuccessor(t,e,i)}getPredecessors(t,e={}){return this.model.getPredecessors(t,e)}isPredecessor(t,e,i={}){return this.model.isPredecessor(t,e,i)}getCommonAncestor(...t){return this.model.getCommonAncestor(...t)}getSubGraph(t,e={}){return this.model.getSubGraph(t,e)}cloneSubGraph(t,e={}){return this.model.cloneSubGraph(t,e)}cloneCells(t){return this.model.cloneCells(t)}getNodesFromPoint(t,e){return this.model.getNodesFromPoint(t,e)}getNodesInArea(t,e,i,r,o){return this.model.getNodesInArea(t,e,i,r,o)}getNodesUnderNode(t,e={}){return this.model.getNodesUnderNode(t,e)}searchCell(t,e,i={}){return this.model.search(t,e,i),this}getShortestPath(t,e,i={}){return this.model.getShortestPath(t,e,i)}getAllCellsBBox(){return this.model.getAllCellsBBox()}getCellsBBox(t,e={}){return this.model.getCellsBBox(t,e)}startBatch(t,e={}){this.model.startBatch(t,e)}stopBatch(t,e={}){this.model.stopBatch(t,e)}batchUpdate(t,e,i){const r=typeof t=="string"?t:"update",o=typeof t=="string"?e:t,s=typeof e=="function"?i:e;this.startBatch(r,s);const a=o();return this.stopBatch(r,s),a}updateCellId(t,e){return this.model.updateCellId(t,e)}findView(t){return Re.isCell(t)?this.findViewByCell(t):this.findViewByElem(t)}findViews(t){return Ct.isRectangleLike(t)?this.findViewsInArea(t):tt.isPointLike(t)?this.findViewsFromPoint(t):[]}findViewByCell(t){return this.renderer.findViewByCell(t)}findViewByElem(t){return this.renderer.findViewByElem(t)}findViewsFromPoint(t,e){const i=typeof t=="number"?{x:t,y:e}:t;return this.renderer.findViewsFromPoint(i)}findViewsInArea(t,e,i,r,o){const s=typeof t=="number"?{x:t,y:e,width:i,height:r}:t,a=typeof t=="number"?o:e;return this.renderer.findViewsInArea(s,a)}matrix(t){return typeof t>"u"?this.transform.getMatrix():(this.transform.setMatrix(t),this)}resize(t,e){const i=this.getPlugin("scroller");return i?i.resize(t,e):this.transform.resize(t,e),this}scale(t,e=t,i=0,r=0){return typeof t>"u"?this.transform.getScale():(this.transform.scale(t,e,i,r),this)}zoom(t,e){const i=this.getPlugin("scroller");if(i){if(typeof t>"u")return i.zoom();i.zoom(t,e)}else{if(typeof t>"u")return this.transform.getZoom();this.transform.zoom(t,e)}return this}zoomTo(t,e={}){const i=this.getPlugin("scroller");return i?i.zoom(t,Object.assign(Object.assign({},e),{absolute:!0})):this.transform.zoom(t,Object.assign(Object.assign({},e),{absolute:!0})),this}zoomToRect(t,e={}){const i=this.getPlugin("scroller");return i?i.zoomToRect(t,e):this.transform.zoomToRect(t,e),this}zoomToFit(t={}){const e=this.getPlugin("scroller");return e?e.zoomToFit(t):this.transform.zoomToFit(t),this}rotate(t,e,i){return typeof t>"u"?this.transform.getRotation():(this.transform.rotate(t,e,i),this)}translate(t,e){return typeof t>"u"?this.transform.getTranslation():(this.transform.translate(t,e),this)}translateBy(t,e){const i=this.translate(),r=i.tx+t,o=i.ty+e;return this.translate(r,o)}getGraphArea(){return this.transform.getGraphArea()}getContentArea(t={}){return this.transform.getContentArea(t)}getContentBBox(t={}){return this.transform.getContentBBox(t)}fitToContent(t,e,i,r){return this.transform.fitToContent(t,e,i,r)}scaleContentToFit(t={}){return this.transform.scaleContentToFit(t),this}center(t){return this.centerPoint(t)}centerPoint(t,e,i){const r=this.getPlugin("scroller");return r?r.centerPoint(t,e,i):this.transform.centerPoint(t,e),this}centerContent(t){const e=this.getPlugin("scroller");return e?e.centerContent(t):this.transform.centerContent(t),this}centerCell(t,e){const i=this.getPlugin("scroller");return i?i.centerCell(t,e):this.transform.centerCell(t),this}positionPoint(t,e,i,r={}){const o=this.getPlugin("scroller");return o?o.positionPoint(t,e,i,r):this.transform.positionPoint(t,e,i),this}positionRect(t,e,i){const r=this.getPlugin("scroller");return r?r.positionRect(t,e,i):this.transform.positionRect(t,e),this}positionCell(t,e,i){const r=this.getPlugin("scroller");return r?r.positionCell(t,e,i):this.transform.positionCell(t,e),this}positionContent(t,e){const i=this.getPlugin("scroller");return i?i.positionContent(t,e):this.transform.positionContent(t,e),this}snapToGrid(t,e){return this.coord.snapToGrid(t,e)}pageToLocal(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.pageToLocalRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.pageToLocalRect(t,e,i,r):this.coord.pageToLocalPoint(t,e)}localToPage(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.localToPageRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.localToPageRect(t,e,i,r):this.coord.localToPagePoint(t,e)}clientToLocal(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.clientToLocalRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.clientToLocalRect(t,e,i,r):this.coord.clientToLocalPoint(t,e)}localToClient(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.localToClientRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.localToClientRect(t,e,i,r):this.coord.localToClientPoint(t,e)}localToGraph(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.localToGraphRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.localToGraphRect(t,e,i,r):this.coord.localToGraphPoint(t,e)}graphToLocal(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.graphToLocalRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.graphToLocalRect(t,e,i,r):this.coord.graphToLocalPoint(t,e)}clientToGraph(t,e,i,r){return Ct.isRectangleLike(t)?this.coord.clientToGraphRect(t):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"?this.coord.clientToGraphRect(t,e,i,r):this.coord.clientToGraphPoint(t,e)}defineFilter(t){return this.defs.filter(t)}defineGradient(t){return this.defs.gradient(t)}defineMarker(t){return this.defs.marker(t)}getGridSize(){return this.grid.getGridSize()}setGridSize(t){return this.grid.setGridSize(t),this}showGrid(){return this.grid.show(),this}hideGrid(){return this.grid.hide(),this}clearGrid(){return this.grid.clear(),this}drawGrid(t){return this.grid.draw(t),this}updateBackground(){return this.background.update(),this}drawBackground(t,e){const i=this.getPlugin("scroller");return i!=null&&(this.options.background==null||!e)?i.drawBackground(t,e):this.background.draw(t),this}clearBackground(t){const e=this.getPlugin("scroller");return e!=null&&(this.options.background==null||!t)?e.clearBackground(t):this.background.clear(),this}enableVirtualRender(){return this.virtualRender.enableVirtualRender(),this}disableVirtualRender(){return this.virtualRender.disableVirtualRender(),this}isMouseWheelEnabled(){return!this.mousewheel.disabled}enableMouseWheel(){return this.mousewheel.enable(),this}disableMouseWheel(){return this.mousewheel.disable(),this}toggleMouseWheel(t){return t==null?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():t?this.enableMouseWheel():this.disableMouseWheel(),this}isPannable(){const t=this.getPlugin("scroller");return t?t.isPannable():this.panning.pannable}enablePanning(){const t=this.getPlugin("scroller");return t?t.enablePanning():this.panning.enablePanning(),this}disablePanning(){const t=this.getPlugin("scroller");return t?t.disablePanning():this.panning.disablePanning(),this}togglePanning(t){return t==null?this.isPannable()?this.disablePanning():this.enablePanning():t!==this.isPannable()&&(t?this.enablePanning():this.disablePanning()),this}use(t,...e){return this.installedPlugins.has(t)||(this.installedPlugins.add(t),t.init(this,...e)),this}getPlugin(t){return Array.from(this.installedPlugins).find(e=>e.name===t)}getPlugins(t){return Array.from(this.installedPlugins).filter(e=>t.includes(e.name))}enablePlugins(t){let e=t;Array.isArray(e)||(e=[e]);const i=this.getPlugins(e);return i?.forEach(r=>{var o;(o=r?.enable)===null||o===void 0||o.call(r)}),this}disablePlugins(t){let e=t;Array.isArray(e)||(e=[e]);const i=this.getPlugins(e);return i?.forEach(r=>{var o;(o=r?.disable)===null||o===void 0||o.call(r)}),this}isPluginEnabled(t){var e;const i=this.getPlugin(t);return(e=i?.isEnabled)===null||e===void 0?void 0:e.call(i)}disposePlugins(t){let e=t;Array.isArray(e)||(e=[e]);const i=this.getPlugins(e);return i?.forEach(r=>{r.dispose(),this.installedPlugins.delete(r)}),this}dispose(t=!0){t&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach(e=>{e.dispose()})}}Fyt([To.dispose()],Jr.prototype,"dispose",null);(function(n){n.View=Va,n.Renderer=gO,n.MouseWheel=fO,n.DefsManager=DX,n.GridManager=uO,n.CoordManager=IX,n.TransformManager=LX,n.HighlightManager=Rw,n.BackgroundManager=dO,n.PanningManager=cO})(Jr||(Jr={}));(function(n){n.toStringTag=`X6.${n.name}`;function t(e){if(e==null)return!1;if(e instanceof n)return!0;const i=e[Symbol.toStringTag];return i==null||i===n.toStringTag}n.isGraph=t})(Jr||(Jr={}));(function(n){function t(e,i){const r=e instanceof HTMLElement?new n({container:e}):new n(e);return i!=null&&r.fromJSON(i),r}n.render=t})(Jr||(Jr={}));(function(n){n.registerNode=Ln.registry.register,n.registerEdge=Qi.registry.register,n.registerView=vn.registry.register,n.registerAttr=Wa.registry.register,n.registerGrid=Lh.registry.register,n.registerFilter=Og.registry.register,n.registerNodeTool=Hg.registry.register,n.registerEdgeTool=Fg.registry.register,n.registerBackground=cm.registry.register,n.registerHighlighter=Dl.registry.register,n.registerPortLayout=Nd.registry.register,n.registerPortLabelLayout=Dg.registry.register,n.registerMarker=Qh.registry.register,n.registerRouter=Oh.registry.register,n.registerConnector=Wd.registry.register,n.registerAnchor=zg.registry.register,n.registerEdgeAnchor=Ng.registry.register,n.registerConnectionPoint=Wg.registry.register})(Jr||(Jr={}));(function(n){n.unregisterNode=Ln.registry.unregister,n.unregisterEdge=Qi.registry.unregister,n.unregisterView=vn.registry.unregister,n.unregisterAttr=Wa.registry.unregister,n.unregisterGrid=Lh.registry.unregister,n.unregisterFilter=Og.registry.unregister,n.unregisterNodeTool=Hg.registry.unregister,n.unregisterEdgeTool=Fg.registry.unregister,n.unregisterBackground=cm.registry.unregister,n.unregisterHighlighter=Dl.registry.unregister,n.unregisterPortLayout=Nd.registry.unregister,n.unregisterPortLabelLayout=Dg.registry.unregister,n.unregisterMarker=Qh.registry.unregister,n.unregisterRouter=Oh.registry.unregister,n.unregisterConnector=Wd.registry.unregister,n.unregisterAnchor=zg.registry.unregister,n.unregisterEdgeAnchor=Ng.registry.unregister,n.unregisterConnectionPoint=Wg.registry.unregister})(Jr||(Jr={}));var zyt=function(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o},Nyt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};class $g extends Ln{}(function(n){class t extends qs{init(){super.init(),this.cell.on("change:*",this.onCellChangeAny,this)}onCellChangeAny({key:i}){const r=n.shapeMaps[this.cell.shape];if(r){const{effect:o}=r;(!o||o.includes(i))&&this.renderHTMLComponent()}}confirmUpdate(i){const r=super.confirmUpdate(i);return this.handleAction(r,t.action,()=>this.renderHTMLComponent())}renderHTMLComponent(){const i=this.selectors&&this.selectors.foContent;if(i){vy(i);const r=n.shapeMaps[this.cell.shape];if(!r)return;let{html:o}=r;typeof o=="function"&&(o=o(this.cell)),o&&(typeof o=="string"?i.innerHTML=o:my(i,o))}}dispose(){this.cell.off("change:*",this.onCellChangeAny,this)}}zyt([t.dispose()],t.prototype,"dispose",null),n.View=t,function(e){e.action="html",e.config({bootstrap:[e.action],actions:{html:e.action}}),qs.registry.register("html-view",e,!0)}(t=n.View||(n.View={}))})($g||($g={}));(function(n){n.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Mi.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Ln.registry.register("html",n,!0)})($g||($g={}));(function(n){n.shapeMaps={};function t(e){const{shape:i,html:r,effect:o,inherit:s}=e,a=Nyt(e,["shape","html","effect","inherit"]);if(!i)throw new Error("should specify shape in config");n.shapeMaps[i]={html:r,effect:o},Jr.registerNode(i,Object.assign({inherit:s||"html"},a),!0)}n.register=t})($g||($g={}));function zS(n){return o8()?(N_(n),!0):!1}function xl(n){return typeof n=="function"?n():Xt(n)}const Wyt=typeof window<"u"&&typeof document<"u",Vyt=n=>typeof n<"u",Gyt=Object.prototype.toString,$yt=n=>Gyt.call(n)==="[object Object]",jyt=()=>{};function Uyt(n,t){function e(...i){return new Promise((r,o)=>{Promise.resolve(n(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})).then(r).catch(o)})}return e}const FX=n=>n();function Xyt(n=FX){const t=qi(!0);function e(){t.value=!1}function i(){t.value=!0}const r=(...o)=>{t.value&&n(...o)};return{isActive:ZQ(t),pause:e,resume:i,eventFilter:r}}function dN(n,t=!1,e="Timeout"){return new Promise((i,r)=>{setTimeout(t?()=>r(e):i,n)})}function Yyt(n,t,e={}){const{eventFilter:i=FX,...r}=e;return li(n,Uyt(i,t),r)}function Qc(n,t,e={}){const{eventFilter:i,...r}=e,{eventFilter:o,pause:s,resume:a,isActive:l}=Xyt(i);return{stop:Yyt(n,t,{...r,eventFilter:o}),pause:s,resume:a,isActive:l}}function Kyt(n,t={}){if(!bE(n))return XQ(n);const e=Array.isArray(n.value)?Array.from({length:n.value.length}):{};for(const i in n.value)e[i]=YQ(()=>({get(){return n.value[i]},set(r){var o;if((o=xl(t.replaceRef))!=null?o:!0)if(Array.isArray(n.value)){const a=[...n.value];a[i]=r,n.value=a}else{const a={...n.value,[i]:r};Object.setPrototypeOf(a,Object.getPrototypeOf(n.value)),n.value=a}else n.value[i]=r}}));return e}function aP(n,t=!1){function e(d,{flush:c="sync",deep:f=!1,timeout:g,throwOnTimeout:p}={}){let v=null;const y=[new Promise(b=>{v=li(n,_=>{d(_)!==t&&(v?.(),b(_))},{flush:c,deep:f,immediate:!0})})];return g!=null&&y.push(dN(g,p).then(()=>xl(n)).finally(()=>v?.())),Promise.race(y)}function i(d,c){if(!bE(d))return e(_=>_===d,c);const{flush:f="sync",deep:g=!1,timeout:p,throwOnTimeout:v}=c??{};let m=null;const b=[new Promise(_=>{m=li([n,d],([w,C])=>{t!==(w===C)&&(m?.(),_(w))},{flush:f,deep:g,immediate:!0})})];return p!=null&&b.push(dN(p,v).then(()=>xl(n)).finally(()=>(m?.(),xl(n)))),Promise.race(b)}function r(d){return e(c=>!!c,d)}function o(d){return i(null,d)}function s(d){return i(void 0,d)}function a(d){return e(Number.isNaN,d)}function l(d,c){return e(f=>{const g=Array.from(f);return g.includes(d)||g.includes(xl(d))},c)}function h(d){return u(1,d)}function u(d=1,c){let f=-1;return e(()=>(f+=1,f>=d),c)}return Array.isArray(xl(n))?{toMatch:e,toContains:l,changed:h,changedTimes:u,get not(){return aP(n,!t)}}:{toMatch:e,toBe:i,toBeTruthy:r,toBeNull:o,toBeNaN:a,toBeUndefined:s,changed:h,changedTimes:u,get not(){return aP(n,!t)}}}function lP(n){return aP(n)}function qyt(n){var t;const e=xl(n);return(t=e?.$el)!=null?t:e}const zX=Wyt?window:void 0;function NX(...n){let t,e,i,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([e,i,r]=n,t=zX):[t,e,i,r]=n,!t)return jyt;Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);const o=[],s=()=>{o.forEach(u=>u()),o.length=0},a=(u,d,c,f)=>(u.addEventListener(d,c,f),()=>u.removeEventListener(d,c,f)),l=li(()=>[qyt(t),xl(r)],([u,d])=>{if(s(),!u)return;const c=$yt(d)?{...d}:d;o.push(...e.flatMap(f=>i.map(g=>a(u,f,g,c))))},{immediate:!0,flush:"post"}),h=()=>{l(),s()};return zS(h),h}function Zyt(n){return typeof n=="function"?n:typeof n=="string"?t=>t.key===n:Array.isArray(n)?t=>n.includes(t.key):()=>!0}function cN(...n){let t,e,i={};n.length===3?(t=n[0],e=n[1],i=n[2]):n.length===2?typeof n[1]=="object"?(t=!0,e=n[0],i=n[1]):(t=n[0],e=n[1]):(t=!0,e=n[0]);const{target:r=zX,eventName:o="keydown",passive:s=!1,dedupe:a=!1}=i,l=Zyt(t);return NX(r,o,u=>{u.repeat&&xl(a)||l(u)&&e(u)},s)}function Jyt(n){return JSON.parse(JSON.stringify(n))}function lR(n,t,e,i={}){var r,o,s;const{clone:a=!1,passive:l=!1,eventName:h,deep:u=!1,defaultValue:d,shouldEmit:c}=i,f=ty(),g=e||f?.emit||((r=f?.$emit)==null?void 0:r.bind(f))||((s=(o=f?.proxy)==null?void 0:o.$emit)==null?void 0:s.bind(f?.proxy));let p=h;t||(t="modelValue"),p=p||`update:${t.toString()}`;const v=b=>a?typeof a=="function"?a(b):Jyt(b):b,m=()=>Vyt(n[t])?v(n[t]):d,y=b=>{c?c(b)&&g(p,b):g(p,b)};if(l){const b=m(),_=qi(b);let w=!1;return li(()=>n[t],C=>{w||(w=!0,_.value=v(C),El(()=>w=!1))}),li(_,C=>{!w&&(C!==n[t]||u)&&y(C)},{deep:u}),_}else return be({get(){return m()},set(b){y(b)}})}var Qyt={value:()=>{}};function NS(){for(var n=0,t=arguments.length,e={},i;n<t;++n){if(!(i=arguments[n]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new rC(e)}function rC(n){this._=n}function tbt(n,t){return n.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");if(r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}rC.prototype=NS.prototype={constructor:rC,on:function(n,t){var e=this._,i=tbt(n+"",e),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(n=i[o]).type)&&(r=ebt(e[r],n.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(n=i[o]).type)e[r]=fN(e[r],n.name,t);else if(t==null)for(r in e)e[r]=fN(e[r],n.name,null);return this},copy:function(){var n={},t=this._;for(var e in t)n[e]=t[e].slice();return new rC(n)},call:function(n,t){if((r=arguments.length-2)>0)for(var e=new Array(r),i=0,r,o;i<r;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(o=this._[n],i=0,r=o.length;i<r;++i)o[i].value.apply(t,e)},apply:function(n,t,e){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var i=this._[n],r=0,o=i.length;r<o;++r)i[r].value.apply(t,e)}};function ebt(n,t){for(var e=0,i=n.length,r;e<i;++e)if((r=n[e]).name===t)return r.value}function fN(n,t,e){for(var i=0,r=n.length;i<r;++i)if(n[i].name===t){n[i]=Qyt,n=n.slice(0,i).concat(n.slice(i+1));break}return e!=null&&n.push({name:t,value:e}),n}var hP="http://www.w3.org/1999/xhtml";const gN={svg:"http://www.w3.org/2000/svg",xhtml:hP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function WS(n){var t=n+="",e=t.indexOf(":");return e>=0&&(t=n.slice(0,e))!=="xmlns"&&(n=n.slice(e+1)),gN.hasOwnProperty(t)?{space:gN[t],local:n}:n}function ibt(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===hP&&t.documentElement.namespaceURI===hP?t.createElement(n):t.createElementNS(e,n)}}function nbt(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function WX(n){var t=WS(n);return(t.local?nbt:ibt)(t)}function rbt(){}function pO(n){return n==null?rbt:function(){return this.querySelector(n)}}function obt(n){typeof n!="function"&&(n=pO(n));for(var t=this._groups,e=t.length,i=new Array(e),r=0;r<e;++r)for(var o=t[r],s=o.length,a=i[r]=new Array(s),l,h,u=0;u<s;++u)(l=o[u])&&(h=n.call(l,l.__data__,u,o))&&("__data__"in l&&(h.__data__=l.__data__),a[u]=h);return new Mo(i,this._parents)}function sbt(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function abt(){return[]}function VX(n){return n==null?abt:function(){return this.querySelectorAll(n)}}function lbt(n){return function(){return sbt(n.apply(this,arguments))}}function hbt(n){typeof n=="function"?n=lbt(n):n=VX(n);for(var t=this._groups,e=t.length,i=[],r=[],o=0;o<e;++o)for(var s=t[o],a=s.length,l,h=0;h<a;++h)(l=s[h])&&(i.push(n.call(l,l.__data__,h,s)),r.push(l));return new Mo(i,r)}function GX(n){return function(){return this.matches(n)}}function $X(n){return function(t){return t.matches(n)}}var ubt=Array.prototype.find;function dbt(n){return function(){return ubt.call(this.children,n)}}function cbt(){return this.firstElementChild}function fbt(n){return this.select(n==null?cbt:dbt(typeof n=="function"?n:$X(n)))}var gbt=Array.prototype.filter;function pbt(){return Array.from(this.children)}function vbt(n){return function(){return gbt.call(this.children,n)}}function mbt(n){return this.selectAll(n==null?pbt:vbt(typeof n=="function"?n:$X(n)))}function ybt(n){typeof n!="function"&&(n=GX(n));for(var t=this._groups,e=t.length,i=new Array(e),r=0;r<e;++r)for(var o=t[r],s=o.length,a=i[r]=[],l,h=0;h<s;++h)(l=o[h])&&n.call(l,l.__data__,h,o)&&a.push(l);return new Mo(i,this._parents)}function jX(n){return new Array(n.length)}function bbt(){return new Mo(this._enter||this._groups.map(jX),this._parents)}function Bw(n,t){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=t}Bw.prototype={constructor:Bw,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,t){return this._parent.insertBefore(n,t)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function _bt(n){return function(){return n}}function Cbt(n,t,e,i,r,o){for(var s=0,a,l=t.length,h=o.length;s<h;++s)(a=t[s])?(a.__data__=o[s],i[s]=a):e[s]=new Bw(n,o[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function wbt(n,t,e,i,r,o,s){var a,l,h=new Map,u=t.length,d=o.length,c=new Array(u),f;for(a=0;a<u;++a)(l=t[a])&&(c[a]=f=s.call(l,l.__data__,a,t)+"",h.has(f)?r[a]=l:h.set(f,l));for(a=0;a<d;++a)f=s.call(n,o[a],a,o)+"",(l=h.get(f))?(i[a]=l,l.__data__=o[a],h.delete(f)):e[a]=new Bw(n,o[a]);for(a=0;a<u;++a)(l=t[a])&&h.get(c[a])===l&&(r[a]=l)}function xbt(n){return n.__data__}function Sbt(n,t){if(!arguments.length)return Array.from(this,xbt);var e=t?wbt:Cbt,i=this._parents,r=this._groups;typeof n!="function"&&(n=_bt(n));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),h=0;h<o;++h){var u=i[h],d=r[h],c=d.length,f=Abt(n.call(u,u&&u.__data__,h,i)),g=f.length,p=a[h]=new Array(g),v=s[h]=new Array(g),m=l[h]=new Array(c);e(u,d,p,v,m,f,t);for(var y=0,b=0,_,w;y<g;++y)if(_=p[y]){for(y>=b&&(b=y+1);!(w=v[b])&&++b<g;);_._next=w||null}}return s=new Mo(s,i),s._enter=a,s._exit=l,s}function Abt(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Tbt(){return new Mo(this._exit||this._groups.map(jX),this._parents)}function Mbt(n,t,e){var i=this.enter(),r=this,o=this.exit();return typeof n=="function"?(i=n(i),i&&(i=i.selection())):i=i.append(n+""),t!=null&&(r=t(r),r&&(r=r.selection())),e==null?o.remove():e(o),i&&r?i.merge(r).order():r}function Rbt(n){for(var t=n.selection?n.selection():n,e=this._groups,i=t._groups,r=e.length,o=i.length,s=Math.min(r,o),a=new Array(r),l=0;l<s;++l)for(var h=e[l],u=i[l],d=h.length,c=a[l]=new Array(d),f,g=0;g<d;++g)(f=h[g]||u[g])&&(c[g]=f);for(;l<r;++l)a[l]=e[l];return new Mo(a,this._parents)}function Bbt(){for(var n=this._groups,t=-1,e=n.length;++t<e;)for(var i=n[t],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Pbt(n){n||(n=kbt);function t(d,c){return d&&c?n(d.__data__,c.__data__):!d-!c}for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o){for(var s=e[o],a=s.length,l=r[o]=new Array(a),h,u=0;u<a;++u)(h=s[u])&&(l[u]=h);l.sort(t)}return new Mo(r,this._parents).order()}function kbt(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function Ebt(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function Lbt(){return Array.from(this)}function Obt(){for(var n=this._groups,t=0,e=n.length;t<e;++t)for(var i=n[t],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function Dbt(){let n=0;for(const t of this)++n;return n}function Ibt(){return!this.node()}function Hbt(n){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var r=t[e],o=0,s=r.length,a;o<s;++o)(a=r[o])&&n.call(a,a.__data__,o,r);return this}function Fbt(n){return function(){this.removeAttribute(n)}}function zbt(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Nbt(n,t){return function(){this.setAttribute(n,t)}}function Wbt(n,t){return function(){this.setAttributeNS(n.space,n.local,t)}}function Vbt(n,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(n):this.setAttribute(n,e)}}function Gbt(n,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}}function $bt(n,t){var e=WS(n);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((t==null?e.local?zbt:Fbt:typeof t=="function"?e.local?Gbt:Vbt:e.local?Wbt:Nbt)(e,t))}function UX(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function jbt(n){return function(){this.style.removeProperty(n)}}function Ubt(n,t,e){return function(){this.style.setProperty(n,t,e)}}function Xbt(n,t,e){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(n):this.style.setProperty(n,i,e)}}function Ybt(n,t,e){return arguments.length>1?this.each((t==null?jbt:typeof t=="function"?Xbt:Ubt)(n,t,e??"")):jg(this.node(),n)}function jg(n,t){return n.style.getPropertyValue(t)||UX(n).getComputedStyle(n,null).getPropertyValue(t)}function Kbt(n){return function(){delete this[n]}}function qbt(n,t){return function(){this[n]=t}}function Zbt(n,t){return function(){var e=t.apply(this,arguments);e==null?delete this[n]:this[n]=e}}function Jbt(n,t){return arguments.length>1?this.each((t==null?Kbt:typeof t=="function"?Zbt:qbt)(n,t)):this.node()[n]}function XX(n){return n.trim().split(/^|\s+/)}function vO(n){return n.classList||new YX(n)}function YX(n){this._node=n,this._names=XX(n.getAttribute("class")||"")}YX.prototype={add:function(n){var t=this._names.indexOf(n);t<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var t=this._names.indexOf(n);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function KX(n,t){for(var e=vO(n),i=-1,r=t.length;++i<r;)e.add(t[i])}function qX(n,t){for(var e=vO(n),i=-1,r=t.length;++i<r;)e.remove(t[i])}function Qbt(n){return function(){KX(this,n)}}function t_t(n){return function(){qX(this,n)}}function e_t(n,t){return function(){(t.apply(this,arguments)?KX:qX)(this,n)}}function i_t(n,t){var e=XX(n+"");if(arguments.length<2){for(var i=vO(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each((typeof t=="function"?e_t:t?Qbt:t_t)(e,t))}function n_t(){this.textContent=""}function r_t(n){return function(){this.textContent=n}}function o_t(n){return function(){var t=n.apply(this,arguments);this.textContent=t??""}}function s_t(n){return arguments.length?this.each(n==null?n_t:(typeof n=="function"?o_t:r_t)(n)):this.node().textContent}function a_t(){this.innerHTML=""}function l_t(n){return function(){this.innerHTML=n}}function h_t(n){return function(){var t=n.apply(this,arguments);this.innerHTML=t??""}}function u_t(n){return arguments.length?this.each(n==null?a_t:(typeof n=="function"?h_t:l_t)(n)):this.node().innerHTML}function d_t(){this.nextSibling&&this.parentNode.appendChild(this)}function c_t(){return this.each(d_t)}function f_t(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function g_t(){return this.each(f_t)}function p_t(n){var t=typeof n=="function"?n:WX(n);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function v_t(){return null}function m_t(n,t){var e=typeof n=="function"?n:WX(n),i=t==null?v_t:typeof t=="function"?t:pO(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function y_t(){var n=this.parentNode;n&&n.removeChild(this)}function b_t(){return this.each(y_t)}function __t(){var n=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(n,this.nextSibling):n}function C_t(){var n=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(n,this.nextSibling):n}function w_t(n){return this.select(n?C_t:__t)}function x_t(n){return arguments.length?this.property("__data__",n):this.node().__data__}function S_t(n){return function(t){n.call(this,t,this.__data__)}}function A_t(n){return n.trim().split(/^|\s+/).map(function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}})}function T_t(n){return function(){var t=this.__on;if(t){for(var e=0,i=-1,r=t.length,o;e<r;++e)o=t[e],(!n.type||o.type===n.type)&&o.name===n.name?this.removeEventListener(o.type,o.listener,o.options):t[++i]=o;++i?t.length=i:delete this.__on}}}function M_t(n,t,e){return function(){var i=this.__on,r,o=S_t(t);if(i){for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===n.type&&r.name===n.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),r.value=t;return}}this.addEventListener(n.type,o,e),r={type:n.type,name:n.name,value:t,listener:o,options:e},i?i.push(r):this.__on=[r]}}function R_t(n,t,e){var i=A_t(n+""),r,o=i.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,h=a.length,u;l<h;++l)for(r=0,u=a[l];r<o;++r)if((s=i[r]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?M_t:T_t,r=0;r<o;++r)this.each(a(i[r],t,e));return this}function ZX(n,t,e){var i=UX(n),r=i.CustomEvent;typeof r=="function"?r=new r(t,e):(r=i.document.createEvent("Event"),e?(r.initEvent(t,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(t,!1,!1)),n.dispatchEvent(r)}function B_t(n,t){return function(){return ZX(this,n,t)}}function P_t(n,t){return function(){return ZX(this,n,t.apply(this,arguments))}}function k_t(n,t){return this.each((typeof t=="function"?P_t:B_t)(n,t))}function*E_t(){for(var n=this._groups,t=0,e=n.length;t<e;++t)for(var i=n[t],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var JX=[null];function Mo(n,t){this._groups=n,this._parents=t}function Cy(){return new Mo([[document.documentElement]],JX)}function L_t(){return this}Mo.prototype=Cy.prototype={constructor:Mo,select:obt,selectAll:hbt,selectChild:fbt,selectChildren:mbt,filter:ybt,data:Sbt,enter:bbt,exit:Tbt,join:Mbt,merge:Rbt,selection:L_t,order:Bbt,sort:Pbt,call:Ebt,nodes:Lbt,node:Obt,size:Dbt,empty:Ibt,each:Hbt,attr:$bt,style:Ybt,property:Jbt,classed:i_t,text:s_t,html:u_t,raise:c_t,lower:g_t,append:p_t,insert:m_t,remove:b_t,clone:w_t,datum:x_t,on:R_t,dispatch:k_t,[Symbol.iterator]:E_t};function Is(n){return typeof n=="string"?new Mo([[document.querySelector(n)]],[document.documentElement]):new Mo([[n]],JX)}function O_t(n){let t;for(;t=n.sourceEvent;)n=t;return n}function _a(n,t){if(n=O_t(n),t===void 0&&(t=n.currentTarget),t){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=n.clientX,i.y=n.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[n.clientX-r.left-t.clientLeft,n.clientY-r.top-t.clientTop]}}return[n.pageX,n.pageY]}const D_t={passive:!1},ym={capture:!0,passive:!1};function hR(n){n.stopImmediatePropagation()}function jf(n){n.preventDefault(),n.stopImmediatePropagation()}function QX(n){var t=n.document.documentElement,e=Is(n).on("dragstart.drag",jf,ym);"onselectstart"in t?e.on("selectstart.drag",jf,ym):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function tY(n,t){var e=n.document.documentElement,i=Is(n).on("dragstart.drag",null);t&&(i.on("click.drag",jf,ym),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}const Vb=n=>()=>n;function uP(n,{sourceEvent:t,subject:e,target:i,identifier:r,active:o,x:s,y:a,dx:l,dy:h,dispatch:u}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:u}})}uP.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function I_t(n){return!n.ctrlKey&&!n.button}function H_t(){return this.parentNode}function F_t(n,t){return t??{x:n.x,y:n.y}}function z_t(){return navigator.maxTouchPoints||"ontouchstart"in this}function N_t(){var n=I_t,t=H_t,e=F_t,i=z_t,r={},o=NS("start","drag","end"),s=0,a,l,h,u,d=0;function c(_){_.on("mousedown.drag",f).filter(i).on("touchstart.drag",v).on("touchmove.drag",m,D_t).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(_,w){if(!(u||!n.call(this,_,w))){var C=b(this,t.call(this,_,w),_,w,"mouse");C&&(Is(_.view).on("mousemove.drag",g,ym).on("mouseup.drag",p,ym),QX(_.view),hR(_),h=!1,a=_.clientX,l=_.clientY,C("start",_))}}function g(_){if(jf(_),!h){var w=_.clientX-a,C=_.clientY-l;h=w*w+C*C>d}r.mouse("drag",_)}function p(_){Is(_.view).on("mousemove.drag mouseup.drag",null),tY(_.view,h),jf(_),r.mouse("end",_)}function v(_,w){if(n.call(this,_,w)){var C=_.changedTouches,x=t.call(this,_,w),S=C.length,A,T;for(A=0;A<S;++A)(T=b(this,x,_,w,C[A].identifier,C[A]))&&(hR(_),T("start",_,C[A]))}}function m(_){var w=_.changedTouches,C=w.length,x,S;for(x=0;x<C;++x)(S=r[w[x].identifier])&&(jf(_),S("drag",_,w[x]))}function y(_){var w=_.changedTouches,C=w.length,x,S;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),x=0;x<C;++x)(S=r[w[x].identifier])&&(hR(_),S("end",_,w[x]))}function b(_,w,C,x,S,A){var T=o.copy(),M=_a(A||C,w),R,E,P;if((P=e.call(_,new uP("beforestart",{sourceEvent:C,target:c,identifier:S,active:s,x:M[0],y:M[1],dx:0,dy:0,dispatch:T}),x))!=null)return R=P.x-M[0]||0,E=P.y-M[1]||0,function B(k,L,O){var D=M,I;switch(k){case"start":r[S]=B,I=s++;break;case"end":delete r[S],--s;case"drag":M=_a(O||L,w),I=s;break}T.call(k,_,new uP(k,{sourceEvent:L,subject:P,target:c,identifier:S,active:I,x:M[0]+R,y:M[1]+E,dx:M[0]-D[0],dy:M[1]-D[1],dispatch:T}),x)}}return c.filter=function(_){return arguments.length?(n=typeof _=="function"?_:Vb(!!_),c):n},c.container=function(_){return arguments.length?(t=typeof _=="function"?_:Vb(_),c):t},c.subject=function(_){return arguments.length?(e=typeof _=="function"?_:Vb(_),c):e},c.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:Vb(!!_),c):i},c.on=function(){var _=o.on.apply(o,arguments);return _===o?c:_},c.clickDistance=function(_){return arguments.length?(d=(_=+_)*_,c):Math.sqrt(d)},c}function mO(n,t,e){n.prototype=t.prototype=e,e.constructor=n}function eY(n,t){var e=Object.create(n.prototype);for(var i in t)e[i]=t[i];return e}function wy(){}var bm=.7,Pw=1/bm,Uf="\\s*([+-]?\\d+)\\s*",_m="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ia="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",W_t=/^#([0-9a-f]{3,8})$/,V_t=new RegExp(`^rgb\\(${Uf},${Uf},${Uf}\\)$`),G_t=new RegExp(`^rgb\\(${Ia},${Ia},${Ia}\\)$`),$_t=new RegExp(`^rgba\\(${Uf},${Uf},${Uf},${_m}\\)$`),j_t=new RegExp(`^rgba\\(${Ia},${Ia},${Ia},${_m}\\)$`),U_t=new RegExp(`^hsl\\(${_m},${Ia},${Ia}\\)$`),X_t=new RegExp(`^hsla\\(${_m},${Ia},${Ia},${_m}\\)$`),pN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mO(wy,dc,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:vN,formatHex:vN,formatHex8:Y_t,formatHsl:K_t,formatRgb:mN,toString:mN});function vN(){return this.rgb().formatHex()}function Y_t(){return this.rgb().formatHex8()}function K_t(){return iY(this).formatHsl()}function mN(){return this.rgb().formatRgb()}function dc(n){var t,e;return n=(n+"").trim().toLowerCase(),(t=W_t.exec(n))?(e=t[1].length,t=parseInt(t[1],16),e===6?yN(t):e===3?new Vr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?Gb(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?Gb(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=V_t.exec(n))?new Vr(t[1],t[2],t[3],1):(t=G_t.exec(n))?new Vr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$_t.exec(n))?Gb(t[1],t[2],t[3],t[4]):(t=j_t.exec(n))?Gb(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=U_t.exec(n))?CN(t[1],t[2]/100,t[3]/100,1):(t=X_t.exec(n))?CN(t[1],t[2]/100,t[3]/100,t[4]):pN.hasOwnProperty(n)?yN(pN[n]):n==="transparent"?new Vr(NaN,NaN,NaN,0):null}function yN(n){return new Vr(n>>16&255,n>>8&255,n&255,1)}function Gb(n,t,e,i){return i<=0&&(n=t=e=NaN),new Vr(n,t,e,i)}function q_t(n){return n instanceof wy||(n=dc(n)),n?(n=n.rgb(),new Vr(n.r,n.g,n.b,n.opacity)):new Vr}function dP(n,t,e,i){return arguments.length===1?q_t(n):new Vr(n,t,e,i??1)}function Vr(n,t,e,i){this.r=+n,this.g=+t,this.b=+e,this.opacity=+i}mO(Vr,dP,eY(wy,{brighter(n){return n=n==null?Pw:Math.pow(Pw,n),new Vr(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?bm:Math.pow(bm,n),new Vr(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Vr(Vd(this.r),Vd(this.g),Vd(this.b),kw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bN,formatHex:bN,formatHex8:Z_t,formatRgb:_N,toString:_N}));function bN(){return`#${Ad(this.r)}${Ad(this.g)}${Ad(this.b)}`}function Z_t(){return`#${Ad(this.r)}${Ad(this.g)}${Ad(this.b)}${Ad((isNaN(this.opacity)?1:this.opacity)*255)}`}function _N(){const n=kw(this.opacity);return`${n===1?"rgb(":"rgba("}${Vd(this.r)}, ${Vd(this.g)}, ${Vd(this.b)}${n===1?")":`, ${n})`}`}function kw(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Vd(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Ad(n){return n=Vd(n),(n<16?"0":"")+n.toString(16)}function CN(n,t,e,i){return i<=0?n=t=e=NaN:e<=0||e>=1?n=t=NaN:t<=0&&(n=NaN),new Hs(n,t,e,i)}function iY(n){if(n instanceof Hs)return new Hs(n.h,n.s,n.l,n.opacity);if(n instanceof wy||(n=dc(n)),!n)return new Hs;if(n instanceof Hs)return n;n=n.rgb();var t=n.r/255,e=n.g/255,i=n.b/255,r=Math.min(t,e,i),o=Math.max(t,e,i),s=NaN,a=o-r,l=(o+r)/2;return a?(t===o?s=(e-i)/a+(e<i)*6:e===o?s=(i-t)/a+2:s=(t-e)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new Hs(s,a,l,n.opacity)}function J_t(n,t,e,i){return arguments.length===1?iY(n):new Hs(n,t,e,i??1)}function Hs(n,t,e,i){this.h=+n,this.s=+t,this.l=+e,this.opacity=+i}mO(Hs,J_t,eY(wy,{brighter(n){return n=n==null?Pw:Math.pow(Pw,n),new Hs(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?bm:Math.pow(bm,n),new Hs(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,t=isNaN(n)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*t,r=2*e-i;return new Vr(uR(n>=240?n-240:n+120,r,i),uR(n,r,i),uR(n<120?n+240:n-120,r,i),this.opacity)},clamp(){return new Hs(wN(this.h),$b(this.s),$b(this.l),kw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=kw(this.opacity);return`${n===1?"hsl(":"hsla("}${wN(this.h)}, ${$b(this.s)*100}%, ${$b(this.l)*100}%${n===1?")":`, ${n})`}`}}));function wN(n){return n=(n||0)%360,n<0?n+360:n}function $b(n){return Math.max(0,Math.min(1,n||0))}function uR(n,t,e){return(n<60?t+(e-t)*n/60:n<180?e:n<240?t+(e-t)*(240-n)/60:t)*255}const yO=n=>()=>n;function Q_t(n,t){return function(e){return n+e*t}}function tCt(n,t,e){return n=Math.pow(n,e),t=Math.pow(t,e)-n,e=1/e,function(i){return Math.pow(n+i*t,e)}}function eCt(n){return(n=+n)==1?nY:function(t,e){return e-t?tCt(t,e,n):yO(isNaN(t)?e:t)}}function nY(n,t){var e=t-n;return e?Q_t(n,e):yO(isNaN(n)?t:n)}const Ew=function n(t){var e=eCt(t);function i(r,o){var s=e((r=dP(r)).r,(o=dP(o)).r),a=e(r.g,o.g),l=e(r.b,o.b),h=nY(r.opacity,o.opacity);return function(u){return r.r=s(u),r.g=a(u),r.b=l(u),r.opacity=h(u),r+""}}return i.gamma=n,i}(1);function iCt(n,t){t||(t=[]);var e=n?Math.min(t.length,n.length):0,i=t.slice(),r;return function(o){for(r=0;r<e;++r)i[r]=n[r]*(1-o)+t[r]*o;return i}}function nCt(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function rCt(n,t){var e=t?t.length:0,i=n?Math.min(e,n.length):0,r=new Array(i),o=new Array(e),s;for(s=0;s<i;++s)r[s]=C0(n[s],t[s]);for(;s<e;++s)o[s]=t[s];return function(a){for(s=0;s<i;++s)o[s]=r[s](a);return o}}function oCt(n,t){var e=new Date;return n=+n,t=+t,function(i){return e.setTime(n*(1-i)+t*i),e}}function wa(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function sCt(n,t){var e={},i={},r;(n===null||typeof n!="object")&&(n={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in n?e[r]=C0(n[r],t[r]):i[r]=t[r];return function(o){for(r in e)i[r]=e[r](o);return i}}var cP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dR=new RegExp(cP.source,"g");function aCt(n){return function(){return n}}function lCt(n){return function(t){return n(t)+""}}function rY(n,t){var e=cP.lastIndex=dR.lastIndex=0,i,r,o,s=-1,a=[],l=[];for(n=n+"",t=t+"";(i=cP.exec(n))&&(r=dR.exec(t));)(o=r.index)>e&&(o=t.slice(e,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:wa(i,r)})),e=dR.lastIndex;return e<t.length&&(o=t.slice(e),a[s]?a[s]+=o:a[++s]=o),a.length<2?l[0]?lCt(l[0].x):aCt(t):(t=l.length,function(h){for(var u=0,d;u<t;++u)a[(d=l[u]).i]=d.x(h);return a.join("")})}function C0(n,t){var e=typeof t,i;return t==null||e==="boolean"?yO(t):(e==="number"?wa:e==="string"?(i=dc(t))?(t=i,Ew):rY:t instanceof dc?Ew:t instanceof Date?oCt:nCt(t)?iCt:Array.isArray(t)?rCt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?sCt:wa)(n,t)}var xN=180/Math.PI,fP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function oY(n,t,e,i,r,o){var s,a,l;return(s=Math.sqrt(n*n+t*t))&&(n/=s,t/=s),(l=n*e+t*i)&&(e-=n*l,i-=t*l),(a=Math.sqrt(e*e+i*i))&&(e/=a,i/=a,l/=a),n*i<t*e&&(n=-n,t=-t,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,n)*xN,skewX:Math.atan(l)*xN,scaleX:s,scaleY:a}}var jb;function hCt(n){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return t.isIdentity?fP:oY(t.a,t.b,t.c,t.d,t.e,t.f)}function uCt(n){return n==null||(jb||(jb=document.createElementNS("http://www.w3.org/2000/svg","g")),jb.setAttribute("transform",n),!(n=jb.transform.baseVal.consolidate()))?fP:(n=n.matrix,oY(n.a,n.b,n.c,n.d,n.e,n.f))}function sY(n,t,e,i){function r(h){return h.length?h.pop()+" ":""}function o(h,u,d,c,f,g){if(h!==d||u!==c){var p=f.push("translate(",null,t,null,e);g.push({i:p-4,x:wa(h,d)},{i:p-2,x:wa(u,c)})}else(d||c)&&f.push("translate("+d+t+c+e)}function s(h,u,d,c){h!==u?(h-u>180?u+=360:u-h>180&&(h+=360),c.push({i:d.push(r(d)+"rotate(",null,i)-2,x:wa(h,u)})):u&&d.push(r(d)+"rotate("+u+i)}function a(h,u,d,c){h!==u?c.push({i:d.push(r(d)+"skewX(",null,i)-2,x:wa(h,u)}):u&&d.push(r(d)+"skewX("+u+i)}function l(h,u,d,c,f,g){if(h!==d||u!==c){var p=f.push(r(f)+"scale(",null,",",null,")");g.push({i:p-4,x:wa(h,d)},{i:p-2,x:wa(u,c)})}else(d!==1||c!==1)&&f.push(r(f)+"scale("+d+","+c+")")}return function(h,u){var d=[],c=[];return h=n(h),u=n(u),o(h.translateX,h.translateY,u.translateX,u.translateY,d,c),s(h.rotate,u.rotate,d,c),a(h.skewX,u.skewX,d,c),l(h.scaleX,h.scaleY,u.scaleX,u.scaleY,d,c),h=u=null,function(f){for(var g=-1,p=c.length,v;++g<p;)d[(v=c[g]).i]=v.x(f);return d.join("")}}}var dCt=sY(hCt,"px, ","px)","deg)"),cCt=sY(uCt,", ",")",")"),fCt=1e-12;function SN(n){return((n=Math.exp(n))+1/n)/2}function gCt(n){return((n=Math.exp(n))-1/n)/2}function pCt(n){return((n=Math.exp(2*n))-1)/(n+1)}const oC=function n(t,e,i){function r(o,s){var a=o[0],l=o[1],h=o[2],u=s[0],d=s[1],c=s[2],f=u-a,g=d-l,p=f*f+g*g,v,m;if(p<fCt)m=Math.log(c/h)/t,v=function(x){return[a+x*f,l+x*g,h*Math.exp(t*x*m)]};else{var y=Math.sqrt(p),b=(c*c-h*h+i*p)/(2*h*e*y),_=(c*c-h*h-i*p)/(2*c*e*y),w=Math.log(Math.sqrt(b*b+1)-b),C=Math.log(Math.sqrt(_*_+1)-_);m=(C-w)/t,v=function(x){var S=x*m,A=SN(w),T=h/(e*y)*(A*pCt(t*S+w)-gCt(w));return[a+T*f,l+T*g,h*A/SN(t*S+w)]}}return v.duration=m*1e3*t/Math.SQRT2,v}return r.rho=function(o){var s=Math.max(.001,+o),a=s*s,l=a*a;return n(s,a,l)},r}(Math.SQRT2,2,4);var Ug=0,Wv=0,uv=0,aY=1e3,Lw,Vv,Ow=0,cc=0,VS=0,Cm=typeof performance=="object"&&performance.now?performance:Date,lY=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function bO(){return cc||(lY(vCt),cc=Cm.now()+VS)}function vCt(){cc=0}function Dw(){this._call=this._time=this._next=null}Dw.prototype=hY.prototype={constructor:Dw,restart:function(n,t,e){if(typeof n!="function")throw new TypeError("callback is not a function");e=(e==null?bO():+e)+(t==null?0:+t),!this._next&&Vv!==this&&(Vv?Vv._next=this:Lw=this,Vv=this),this._call=n,this._time=e,gP()},stop:function(){this._call&&(this._call=null,this._time=1/0,gP())}};function hY(n,t,e){var i=new Dw;return i.restart(n,t,e),i}function mCt(){bO(),++Ug;for(var n=Lw,t;n;)(t=cc-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Ug}function AN(){cc=(Ow=Cm.now())+VS,Ug=Wv=0;try{mCt()}finally{Ug=0,bCt(),cc=0}}function yCt(){var n=Cm.now(),t=n-Ow;t>aY&&(VS-=t,Ow=n)}function bCt(){for(var n,t=Lw,e,i=1/0;t;)t._call?(i>t._time&&(i=t._time),n=t,t=t._next):(e=t._next,t._next=null,t=n?n._next=e:Lw=e);Vv=n,gP(i)}function gP(n){if(!Ug){Wv&&(Wv=clearTimeout(Wv));var t=n-cc;t>24?(n<1/0&&(Wv=setTimeout(AN,n-Cm.now()-VS)),uv&&(uv=clearInterval(uv))):(uv||(Ow=Cm.now(),uv=setInterval(yCt,aY)),Ug=1,lY(AN))}}function TN(n,t,e){var i=new Dw;return t=t==null?0:+t,i.restart(r=>{i.stop(),n(r+t)},t,e),i}var _Ct=NS("start","end","cancel","interrupt"),CCt=[],uY=0,MN=1,pP=2,sC=3,RN=4,vP=5,aC=6;function GS(n,t,e,i,r,o){var s=n.__transition;if(!s)n.__transition={};else if(e in s)return;wCt(n,e,{name:t,index:i,group:r,on:_Ct,tween:CCt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:uY})}function _O(n,t){var e=oa(n,t);if(e.state>uY)throw new Error("too late; already scheduled");return e}function Ya(n,t){var e=oa(n,t);if(e.state>sC)throw new Error("too late; already running");return e}function oa(n,t){var e=n.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function wCt(n,t,e){var i=n.__transition,r;i[t]=e,e.timer=hY(o,0,e.time);function o(h){e.state=MN,e.timer.restart(s,e.delay,e.time),e.delay<=h&&s(h-e.delay)}function s(h){var u,d,c,f;if(e.state!==MN)return l();for(u in i)if(f=i[u],f.name===e.name){if(f.state===sC)return TN(s);f.state===RN?(f.state=aC,f.timer.stop(),f.on.call("interrupt",n,n.__data__,f.index,f.group),delete i[u]):+u<t&&(f.state=aC,f.timer.stop(),f.on.call("cancel",n,n.__data__,f.index,f.group),delete i[u])}if(TN(function(){e.state===sC&&(e.state=RN,e.timer.restart(a,e.delay,e.time),a(h))}),e.state=pP,e.on.call("start",n,n.__data__,e.index,e.group),e.state===pP){for(e.state=sC,r=new Array(c=e.tween.length),u=0,d=-1;u<c;++u)(f=e.tween[u].value.call(n,n.__data__,e.index,e.group))&&(r[++d]=f);r.length=d+1}}function a(h){for(var u=h<e.duration?e.ease.call(null,h/e.duration):(e.timer.restart(l),e.state=vP,1),d=-1,c=r.length;++d<c;)r[d].call(n,u);e.state===vP&&(e.on.call("end",n,n.__data__,e.index,e.group),l())}function l(){e.state=aC,e.timer.stop(),delete i[t];for(var h in i)return;delete n.__transition}}function lC(n,t){var e=n.__transition,i,r,o=!0,s;if(e){t=t==null?null:t+"";for(s in e){if((i=e[s]).name!==t){o=!1;continue}r=i.state>pP&&i.state<vP,i.state=aC,i.timer.stop(),i.on.call(r?"interrupt":"cancel",n,n.__data__,i.index,i.group),delete e[s]}o&&delete n.__transition}}function xCt(n){return this.each(function(){lC(this,n)})}function SCt(n,t){var e,i;return function(){var r=Ya(this,n),o=r.tween;if(o!==e){i=e=o;for(var s=0,a=i.length;s<a;++s)if(i[s].name===t){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function ACt(n,t,e){var i,r;if(typeof e!="function")throw new Error;return function(){var o=Ya(this,n),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:t,value:e},l=0,h=r.length;l<h;++l)if(r[l].name===t){r[l]=a;break}l===h&&r.push(a)}o.tween=r}}function TCt(n,t){var e=this._id;if(n+="",arguments.length<2){for(var i=oa(this.node(),e).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===n)return s.value;return null}return this.each((t==null?SCt:ACt)(e,n,t))}function CO(n,t,e){var i=n._id;return n.each(function(){var r=Ya(this,i);(r.value||(r.value={}))[t]=e.apply(this,arguments)}),function(r){return oa(r,i).value[t]}}function dY(n,t){var e;return(typeof t=="number"?wa:t instanceof dc?Ew:(e=dc(t))?(t=e,Ew):rY)(n,t)}function MCt(n){return function(){this.removeAttribute(n)}}function RCt(n){return function(){this.removeAttributeNS(n.space,n.local)}}function BCt(n,t,e){var i,r=e+"",o;return function(){var s=this.getAttribute(n);return s===r?null:s===i?o:o=t(i=s,e)}}function PCt(n,t,e){var i,r=e+"",o;return function(){var s=this.getAttributeNS(n.space,n.local);return s===r?null:s===i?o:o=t(i=s,e)}}function kCt(n,t,e){var i,r,o;return function(){var s,a=e(this),l;return a==null?void this.removeAttribute(n):(s=this.getAttribute(n),l=a+"",s===l?null:s===i&&l===r?o:(r=l,o=t(i=s,a)))}}function ECt(n,t,e){var i,r,o;return function(){var s,a=e(this),l;return a==null?void this.removeAttributeNS(n.space,n.local):(s=this.getAttributeNS(n.space,n.local),l=a+"",s===l?null:s===i&&l===r?o:(r=l,o=t(i=s,a)))}}function LCt(n,t){var e=WS(n),i=e==="transform"?cCt:dY;return this.attrTween(n,typeof t=="function"?(e.local?ECt:kCt)(e,i,CO(this,"attr."+n,t)):t==null?(e.local?RCt:MCt)(e):(e.local?PCt:BCt)(e,i,t))}function OCt(n,t){return function(e){this.setAttribute(n,t.call(this,e))}}function DCt(n,t){return function(e){this.setAttributeNS(n.space,n.local,t.call(this,e))}}function ICt(n,t){var e,i;function r(){var o=t.apply(this,arguments);return o!==i&&(e=(i=o)&&DCt(n,o)),e}return r._value=t,r}function HCt(n,t){var e,i;function r(){var o=t.apply(this,arguments);return o!==i&&(e=(i=o)&&OCt(n,o)),e}return r._value=t,r}function FCt(n,t){var e="attr."+n;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;var i=WS(n);return this.tween(e,(i.local?ICt:HCt)(i,t))}function zCt(n,t){return function(){_O(this,n).delay=+t.apply(this,arguments)}}function NCt(n,t){return t=+t,function(){_O(this,n).delay=t}}function WCt(n){var t=this._id;return arguments.length?this.each((typeof n=="function"?zCt:NCt)(t,n)):oa(this.node(),t).delay}function VCt(n,t){return function(){Ya(this,n).duration=+t.apply(this,arguments)}}function GCt(n,t){return t=+t,function(){Ya(this,n).duration=t}}function $Ct(n){var t=this._id;return arguments.length?this.each((typeof n=="function"?VCt:GCt)(t,n)):oa(this.node(),t).duration}function jCt(n,t){if(typeof t!="function")throw new Error;return function(){Ya(this,n).ease=t}}function UCt(n){var t=this._id;return arguments.length?this.each(jCt(t,n)):oa(this.node(),t).ease}function XCt(n,t){return function(){var e=t.apply(this,arguments);if(typeof e!="function")throw new Error;Ya(this,n).ease=e}}function YCt(n){if(typeof n!="function")throw new Error;return this.each(XCt(this._id,n))}function KCt(n){typeof n!="function"&&(n=GX(n));for(var t=this._groups,e=t.length,i=new Array(e),r=0;r<e;++r)for(var o=t[r],s=o.length,a=i[r]=[],l,h=0;h<s;++h)(l=o[h])&&n.call(l,l.__data__,h,o)&&a.push(l);return new Ul(i,this._parents,this._name,this._id)}function qCt(n){if(n._id!==this._id)throw new Error;for(var t=this._groups,e=n._groups,i=t.length,r=e.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l=t[a],h=e[a],u=l.length,d=s[a]=new Array(u),c,f=0;f<u;++f)(c=l[f]||h[f])&&(d[f]=c);for(;a<i;++a)s[a]=t[a];return new Ul(s,this._parents,this._name,this._id)}function ZCt(n){return(n+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||t==="start"})}function JCt(n,t,e){var i,r,o=ZCt(t)?_O:Ya;return function(){var s=o(this,n),a=s.on;a!==i&&(r=(i=a).copy()).on(t,e),s.on=r}}function QCt(n,t){var e=this._id;return arguments.length<2?oa(this.node(),e).on.on(n):this.each(JCt(e,n,t))}function twt(n){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==n)return;t&&t.removeChild(this)}}function ewt(){return this.on("end.remove",twt(this._id))}function iwt(n){var t=this._name,e=this._id;typeof n!="function"&&(n=pO(n));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a=i[s],l=a.length,h=o[s]=new Array(l),u,d,c=0;c<l;++c)(u=a[c])&&(d=n.call(u,u.__data__,c,a))&&("__data__"in u&&(d.__data__=u.__data__),h[c]=d,GS(h[c],t,e,c,h,oa(u,e)));return new Ul(o,this._parents,t,e)}function nwt(n){var t=this._name,e=this._id;typeof n!="function"&&(n=VX(n));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var l=i[a],h=l.length,u,d=0;d<h;++d)if(u=l[d]){for(var c=n.call(u,u.__data__,d,l),f,g=oa(u,e),p=0,v=c.length;p<v;++p)(f=c[p])&&GS(f,t,e,p,c,g);o.push(c),s.push(u)}return new Ul(o,s,t,e)}var rwt=Cy.prototype.constructor;function owt(){return new rwt(this._groups,this._parents)}function swt(n,t){var e,i,r;return function(){var o=jg(this,n),s=(this.style.removeProperty(n),jg(this,n));return o===s?null:o===e&&s===i?r:r=t(e=o,i=s)}}function cY(n){return function(){this.style.removeProperty(n)}}function awt(n,t,e){var i,r=e+"",o;return function(){var s=jg(this,n);return s===r?null:s===i?o:o=t(i=s,e)}}function lwt(n,t,e){var i,r,o;return function(){var s=jg(this,n),a=e(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(n),jg(this,n))),s===l?null:s===i&&l===r?o:(r=l,o=t(i=s,a))}}function hwt(n,t){var e,i,r,o="style."+t,s="end."+o,a;return function(){var l=Ya(this,n),h=l.on,u=l.value[o]==null?a||(a=cY(t)):void 0;(h!==e||r!==u)&&(i=(e=h).copy()).on(s,r=u),l.on=i}}function uwt(n,t,e){var i=(n+="")=="transform"?dCt:dY;return t==null?this.styleTween(n,swt(n,i)).on("end.style."+n,cY(n)):typeof t=="function"?this.styleTween(n,lwt(n,i,CO(this,"style."+n,t))).each(hwt(this._id,n)):this.styleTween(n,awt(n,i,t),e).on("end.style."+n,null)}function dwt(n,t,e){return function(i){this.style.setProperty(n,t.call(this,i),e)}}function cwt(n,t,e){var i,r;function o(){var s=t.apply(this,arguments);return s!==r&&(i=(r=s)&&dwt(n,s,e)),i}return o._value=t,o}function fwt(n,t,e){var i="style."+(n+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,cwt(n,t,e??""))}function gwt(n){return function(){this.textContent=n}}function pwt(n){return function(){var t=n(this);this.textContent=t??""}}function vwt(n){return this.tween("text",typeof n=="function"?pwt(CO(this,"text",n)):gwt(n==null?"":n+""))}function mwt(n){return function(t){this.textContent=n.call(this,t)}}function ywt(n){var t,e;function i(){var r=n.apply(this,arguments);return r!==e&&(t=(e=r)&&mwt(r)),t}return i._value=n,i}function bwt(n){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(n==null)return this.tween(t,null);if(typeof n!="function")throw new Error;return this.tween(t,ywt(n))}function _wt(){for(var n=this._name,t=this._id,e=fY(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,l,h=0;h<a;++h)if(l=s[h]){var u=oa(l,t);GS(l,n,e,h,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ul(i,this._parents,n,e)}function Cwt(){var n,t,e=this,i=e._id,r=e.size();return new Promise(function(o,s){var a={value:s},l={value:function(){--r===0&&o()}};e.each(function(){var h=Ya(this,i),u=h.on;u!==n&&(t=(n=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),h.on=t}),r===0&&o()})}var wwt=0;function Ul(n,t,e,i){this._groups=n,this._parents=t,this._name=e,this._id=i}function fY(){return++wwt}var rl=Cy.prototype;Ul.prototype={constructor:Ul,select:iwt,selectAll:nwt,selectChild:rl.selectChild,selectChildren:rl.selectChildren,filter:KCt,merge:qCt,selection:owt,transition:_wt,call:rl.call,nodes:rl.nodes,node:rl.node,size:rl.size,empty:rl.empty,each:rl.each,on:QCt,attr:LCt,attrTween:FCt,style:uwt,styleTween:fwt,text:vwt,textTween:bwt,remove:ewt,tween:TCt,delay:WCt,duration:$Ct,ease:UCt,easeVarying:YCt,end:Cwt,[Symbol.iterator]:rl[Symbol.iterator]};function xwt(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Swt={time:null,delay:0,duration:250,ease:xwt};function Awt(n,t){for(var e;!(e=n.__transition)||!(e=e[t]);)if(!(n=n.parentNode))throw new Error(`transition ${t} not found`);return e}function Twt(n){var t,e;n instanceof Ul?(t=n._id,n=n._name):(t=fY(),(e=Swt).time=bO(),n=n==null?null:n+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,l,h=0;h<a;++h)(l=s[h])&&GS(l,n,t,h,s,e||Awt(l,t));return new Ul(i,this._parents,n,t)}Cy.prototype.interrupt=xCt;Cy.prototype.transition=Twt;const Ub=n=>()=>n;function Mwt(n,{sourceEvent:t,target:e,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Bl(n,t,e){this.k=n,this.x=t,this.y=e}Bl.prototype={constructor:Bl,scale:function(n){return n===1?this:new Bl(this.k*n,this.x,this.y)},translate:function(n,t){return n===0&t===0?this:new Bl(this.k,this.x+this.k*n,this.y+this.k*t)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Xg=new Bl(1,0,0);Bl.prototype;function cR(n){n.stopImmediatePropagation()}function dv(n){n.preventDefault(),n.stopImmediatePropagation()}function Rwt(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function Bwt(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function BN(){return this.__zoom||Xg}function Pwt(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function kwt(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ewt(n,t,e){var i=n.invertX(t[0][0])-e[0][0],r=n.invertX(t[1][0])-e[1][0],o=n.invertY(t[0][1])-e[0][1],s=n.invertY(t[1][1])-e[1][1];return n.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function Lwt(){var n=Rwt,t=Bwt,e=Ewt,i=Pwt,r=kwt,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=oC,h=NS("start","zoom","end"),u,d,c,f=500,g=150,p=0,v=10;function m(P){P.property("__zoom",BN).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",T).filter(r).on("touchstart.zoom",M).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(P,B,k,L){var O=P.selection?P.selection():P;O.property("__zoom",BN),P!==O?w(P,B,k,L):O.interrupt().each(function(){C(this,arguments).event(L).start().zoom(null,typeof B=="function"?B.apply(this,arguments):B).end()})},m.scaleBy=function(P,B,k,L){m.scaleTo(P,function(){var O=this.__zoom.k,D=typeof B=="function"?B.apply(this,arguments):B;return O*D},k,L)},m.scaleTo=function(P,B,k,L){m.transform(P,function(){var O=t.apply(this,arguments),D=this.__zoom,I=k==null?_(O):typeof k=="function"?k.apply(this,arguments):k,H=D.invert(I),F=typeof B=="function"?B.apply(this,arguments):B;return e(b(y(D,F),I,H),O,s)},k,L)},m.translateBy=function(P,B,k,L){m.transform(P,function(){return e(this.__zoom.translate(typeof B=="function"?B.apply(this,arguments):B,typeof k=="function"?k.apply(this,arguments):k),t.apply(this,arguments),s)},null,L)},m.translateTo=function(P,B,k,L,O){m.transform(P,function(){var D=t.apply(this,arguments),I=this.__zoom,H=L==null?_(D):typeof L=="function"?L.apply(this,arguments):L;return e(Xg.translate(H[0],H[1]).scale(I.k).translate(typeof B=="function"?-B.apply(this,arguments):-B,typeof k=="function"?-k.apply(this,arguments):-k),D,s)},L,O)};function y(P,B){return B=Math.max(o[0],Math.min(o[1],B)),B===P.k?P:new Bl(B,P.x,P.y)}function b(P,B,k){var L=B[0]-k[0]*P.k,O=B[1]-k[1]*P.k;return L===P.x&&O===P.y?P:new Bl(P.k,L,O)}function _(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function w(P,B,k,L){P.on("start.zoom",function(){C(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(L).end()}).tween("zoom",function(){var O=this,D=arguments,I=C(O,D).event(L),H=t.apply(O,D),F=k==null?_(H):typeof k=="function"?k.apply(O,D):k,G=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),j=O.__zoom,W=typeof B=="function"?B.apply(O,D):B,K=l(j.invert(F).concat(G/j.k),W.invert(F).concat(G/W.k));return function(J){if(J===1)J=W;else{var q=K(J),X=G/q[2];J=new Bl(X,F[0]-q[0]*X,F[1]-q[1]*X)}I.zoom(null,J)}})}function C(P,B,k){return!k&&P.__zooming||new x(P,B)}function x(P,B){this.that=P,this.args=B,this.active=0,this.sourceEvent=null,this.extent=t.apply(P,B),this.taps=0}x.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,B){return this.mouse&&P!=="mouse"&&(this.mouse[1]=B.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=B.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=B.invert(this.touch1[0])),this.that.__zoom=B,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var B=Is(this.that).datum();h.call(P,this.that,new Mwt(P,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:h}),B)}};function S(P,...B){if(!n.apply(this,arguments))return;var k=C(this,B).event(P),L=this.__zoom,O=Math.max(o[0],Math.min(o[1],L.k*Math.pow(2,i.apply(this,arguments)))),D=_a(P);if(k.wheel)(k.mouse[0][0]!==D[0]||k.mouse[0][1]!==D[1])&&(k.mouse[1]=L.invert(k.mouse[0]=D)),clearTimeout(k.wheel);else{if(L.k===O)return;k.mouse=[D,L.invert(D)],lC(this),k.start()}dv(P),k.wheel=setTimeout(I,g),k.zoom("mouse",e(b(y(L,O),k.mouse[0],k.mouse[1]),k.extent,s));function I(){k.wheel=null,k.end()}}function A(P,...B){if(c||!n.apply(this,arguments))return;var k=P.currentTarget,L=C(this,B,!0).event(P),O=Is(P.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",G,!0),D=_a(P,k),I=P.clientX,H=P.clientY;QX(P.view),cR(P),L.mouse=[D,this.__zoom.invert(D)],lC(this),L.start();function F(j){if(dv(j),!L.moved){var W=j.clientX-I,K=j.clientY-H;L.moved=W*W+K*K>p}L.event(j).zoom("mouse",e(b(L.that.__zoom,L.mouse[0]=_a(j,k),L.mouse[1]),L.extent,s))}function G(j){O.on("mousemove.zoom mouseup.zoom",null),tY(j.view,L.moved),dv(j),L.event(j).end()}}function T(P,...B){if(n.apply(this,arguments)){var k=this.__zoom,L=_a(P.changedTouches?P.changedTouches[0]:P,this),O=k.invert(L),D=k.k*(P.shiftKey?.5:2),I=e(b(y(k,D),L,O),t.apply(this,B),s);dv(P),a>0?Is(this).transition().duration(a).call(w,I,L,P):Is(this).call(m.transform,I,L,P)}}function M(P,...B){if(n.apply(this,arguments)){var k=P.touches,L=k.length,O=C(this,B,P.changedTouches.length===L).event(P),D,I,H,F;for(cR(P),I=0;I<L;++I)H=k[I],F=_a(H,this),F=[F,this.__zoom.invert(F),H.identifier],O.touch0?!O.touch1&&O.touch0[2]!==F[2]&&(O.touch1=F,O.taps=0):(O.touch0=F,D=!0,O.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(O.taps<2&&(d=F[0],u=setTimeout(function(){u=null},f)),lC(this),O.start())}}function R(P,...B){if(this.__zooming){var k=C(this,B).event(P),L=P.changedTouches,O=L.length,D,I,H,F;for(dv(P),D=0;D<O;++D)I=L[D],H=_a(I,this),k.touch0&&k.touch0[2]===I.identifier?k.touch0[0]=H:k.touch1&&k.touch1[2]===I.identifier&&(k.touch1[0]=H);if(I=k.that.__zoom,k.touch1){var G=k.touch0[0],j=k.touch0[1],W=k.touch1[0],K=k.touch1[1],J=(J=W[0]-G[0])*J+(J=W[1]-G[1])*J,q=(q=K[0]-j[0])*q+(q=K[1]-j[1])*q;I=y(I,Math.sqrt(J/q)),H=[(G[0]+W[0])/2,(G[1]+W[1])/2],F=[(j[0]+K[0])/2,(j[1]+K[1])/2]}else if(k.touch0)H=k.touch0[0],F=k.touch0[1];else return;k.zoom("touch",e(b(I,H,F),k.extent,s))}}function E(P,...B){if(this.__zooming){var k=C(this,B).event(P),L=P.changedTouches,O=L.length,D,I;for(cR(P),c&&clearTimeout(c),c=setTimeout(function(){c=null},f),D=0;D<O;++D)I=L[D],k.touch0&&k.touch0[2]===I.identifier?delete k.touch0:k.touch1&&k.touch1[2]===I.identifier&&delete k.touch1;if(k.touch1&&!k.touch0&&(k.touch0=k.touch1,delete k.touch1),k.touch0)k.touch0[1]=this.__zoom.invert(k.touch0[0]);else if(k.end(),k.taps===2&&(I=_a(I,this),Math.hypot(d[0]-I[0],d[1]-I[1])<v)){var H=Is(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return m.wheelDelta=function(P){return arguments.length?(i=typeof P=="function"?P:Ub(+P),m):i},m.filter=function(P){return arguments.length?(n=typeof P=="function"?P:Ub(!!P),m):n},m.touchable=function(P){return arguments.length?(r=typeof P=="function"?P:Ub(!!P),m):r},m.extent=function(P){return arguments.length?(t=typeof P=="function"?P:Ub([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),m):t},m.scaleExtent=function(P){return arguments.length?(o[0]=+P[0],o[1]=+P[1],m):[o[0],o[1]]},m.translateExtent=function(P){return arguments.length?(s[0][0]=+P[0][0],s[1][0]=+P[1][0],s[0][1]=+P[0][1],s[1][1]=+P[1][1],m):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},m.constrain=function(P){return arguments.length?(e=P,m):e},m.duration=function(P){return arguments.length?(a=+P,m):a},m.interpolate=function(P){return arguments.length?(l=P,m):l},m.on=function(){var P=h.on.apply(h,arguments);return P===h?m:P},m.clickDistance=function(P){return arguments.length?(p=(P=+P)*P,m):Math.sqrt(p)},m.tapDistance=function(P){return arguments.length?(v=+P,m):v},m}var Ot=(n=>(n.Left="left",n.Top="top",n.Right="right",n.Bottom="bottom",n))(Ot||{}),wO=(n=>(n.Partial="partial",n.Full="full",n))(wO||{}),cd=(n=>(n.Bezier="default",n.SimpleBezier="simple-bezier",n.Straight="straight",n.Step="step",n.SmoothStep="smoothstep",n))(cd||{}),iu=(n=>(n.Strict="strict",n.Loose="loose",n))(iu||{}),mP=(n=>(n.Arrow="arrow",n.ArrowClosed="arrowclosed",n))(mP||{}),w0=(n=>(n.Free="free",n.Vertical="vertical",n.Horizontal="horizontal",n))(w0||{});const Owt=["INPUT","SELECT","TEXTAREA"],Dwt=typeof document<"u"?document:null;function yP(n){var t,e;const i=((e=(t=n.composedPath)==null?void 0:t.call(n))==null?void 0:e[0])||n.target,r=typeof i?.hasAttribute=="function"?i.hasAttribute("contenteditable"):!1,o=typeof i?.closest=="function"?i.closest(".nokey"):null;return Owt.includes(i?.nodeName)||r||!!o}function Iwt(n){return n.ctrlKey||n.metaKey||n.shiftKey||n.altKey}function PN(n,t,e,i){const r=t.replace("+",`
`).replace(`

`,`
+`).split(`
`).map(s=>s.trim().toLowerCase());if(r.length===1)return n.toLowerCase()===t.toLowerCase();i||e.add(n.toLowerCase());const o=r.every((s,a)=>e.has(s)&&Array.from(e.values())[a]===r[a]);return i&&e.delete(n.toLowerCase()),o}function Hwt(n,t){return e=>{if(!e.code&&!e.key)return!1;const i=Fwt(e.code,n);return Array.isArray(n)?n.some(r=>PN(e[i],r,t,e.type==="keyup")):PN(e[i],n,t,e.type==="keyup")}}function Fwt(n,t){return t.includes(n)?"code":"key"}function x0(n,t){const e=be(()=>Be(t?.target)??Dwt),i=MC(Be(n)===!0);let r=!1;const o=new Set;let s=l(Be(n));li(()=>Be(n),(h,u)=>{typeof u=="boolean"&&typeof h!="boolean"&&a(),s=l(h)},{immediate:!0}),NX(["blur","contextmenu"],a),cN((...h)=>s(...h),h=>{var u,d;const c=Be(t?.actInsideInputWithModifier)??!0,f=Be(t?.preventDefault)??!1;if(r=Iwt(h),(!r||r&&!c)&&yP(h))return;const p=((d=(u=h.composedPath)==null?void 0:u.call(h))==null?void 0:d[0])||h.target,v=p?.nodeName==="BUTTON"||p?.nodeName==="A";!f&&(r||!v)&&h.preventDefault(),i.value=!0},{eventName:"keydown",target:e}),cN((...h)=>s(...h),h=>{const u=Be(t?.actInsideInputWithModifier)??!0;if(i.value){if((!r||r&&!u)&&yP(h))return;r=!1,i.value=!1}},{eventName:"keyup",target:e});function a(){r=!1,o.clear(),i.value=Be(n)===!0}function l(h){return h===null?(a(),()=>!1):typeof h=="boolean"?(a(),i.value=h,()=>!1):Array.isArray(h)||typeof h=="string"?Hwt(h,o):h}return i}const gY="vue-flow__node-desc",pY="vue-flow__edge-desc",zwt="vue-flow__aria-live",vY=["Enter"," ","Escape"],Xf={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};function Iw(n){return{...n.computedPosition||{x:0,y:0},width:n.dimensions.width||0,height:n.dimensions.height||0}}function Hw(n,t){const e=Math.max(0,Math.min(n.x+n.width,t.x+t.width)-Math.max(n.x,t.x)),i=Math.max(0,Math.min(n.y+n.height,t.y+t.height)-Math.max(n.y,t.y));return Math.ceil(e*i)}function $S(n){return{width:n.offsetWidth,height:n.offsetHeight}}function fc(n,t=0,e=1){return Math.min(Math.max(n,t),e)}function mY(n,t){return{x:fc(n.x,t[0][0],t[1][0]),y:fc(n.y,t[0][1],t[1][1])}}function kN(n){const t=n.getRootNode();return"elementFromPoint"in t?t:window.document}function nu(n){return n&&typeof n=="object"&&"id"in n&&"source"in n&&"target"in n}function Gd(n){return n&&typeof n=="object"&&"id"in n&&"position"in n&&!nu(n)}function Gv(n){return Gd(n)&&"computedPosition"in n}function Xb(n){return!Number.isNaN(n)&&Number.isFinite(n)}function Nwt(n){return Xb(n.width)&&Xb(n.height)&&Xb(n.x)&&Xb(n.y)}function Wwt(n,t,e){const i={id:n.id.toString(),type:n.type??"default",dimensions:t0({width:0,height:0}),computedPosition:t0({z:0,...n.position}),handleBounds:{source:[],target:[]},draggable:void 0,selectable:void 0,connectable:void 0,focusable:void 0,selected:!1,dragging:!1,resizing:!1,initialized:!1,isParent:!1,position:{x:0,y:0},data:_n(n.data)?n.data:{},events:t0(_n(n.events)?n.events:{})};return Object.assign(t??i,n,{id:n.id.toString(),parentNode:e})}function yY(n,t,e){var i,r;const o={id:n.id.toString(),type:n.type??t?.type??"default",source:n.source.toString(),target:n.target.toString(),sourceHandle:(i=n.sourceHandle)==null?void 0:i.toString(),targetHandle:(r=n.targetHandle)==null?void 0:r.toString(),updatable:n.updatable??e?.updatable,selectable:n.selectable??e?.selectable,focusable:n.focusable??e?.focusable,data:_n(n.data)?n.data:{},events:t0(_n(n.events)?n.events:{}),label:n.label??"",interactionWidth:n.interactionWidth??e?.interactionWidth,...e??{}};return Object.assign(t??o,n,{id:n.id.toString()})}function bY(n,t,e,i){const r=typeof n=="string"?n:n.id,o=new Set,s=i==="source"?"target":"source";for(const a of e)a[s]===r&&o.add(a[i]);return t.filter(a=>o.has(a.id))}function Vwt(...n){if(n.length===3){const[o,s,a]=n;return bY(o,s,a,"target")}const[t,e]=n,i=typeof t=="string"?t:t.id;return e.filter(o=>nu(o)&&o.source===i).map(o=>e.find(s=>Gd(s)&&s.id===o.target))}function Gwt(...n){if(n.length===3){const[o,s,a]=n;return bY(o,s,a,"source")}const[t,e]=n,i=typeof t=="string"?t:t.id;return e.filter(o=>nu(o)&&o.target===i).map(o=>e.find(s=>Gd(s)&&s.id===o.source))}function _Y({source:n,sourceHandle:t,target:e,targetHandle:i}){return`vueflow__edge-${n}${t??""}-${e}${i??""}`}function $wt(n,t){return t.some(e=>nu(e)&&e.source===n.source&&e.target===n.target&&(e.sourceHandle===n.sourceHandle||!e.sourceHandle&&!n.sourceHandle)&&(e.targetHandle===n.targetHandle||!e.targetHandle&&!n.targetHandle))}function bP({x:n,y:t},{x:e,y:i,zoom:r}){return{x:n*r+e,y:t*r+i}}function wm({x:n,y:t},{x:e,y:i,zoom:r},o=!1,s=[1,1]){const a={x:(n-e)/r,y:(t-i)/r};return o?jS(a,s):a}function jwt(n,t){return{x:Math.min(n.x,t.x),y:Math.min(n.y,t.y),x2:Math.max(n.x2,t.x2),y2:Math.max(n.y2,t.y2)}}function CY({x:n,y:t,width:e,height:i}){return{x:n,y:t,x2:n+e,y2:t+i}}function Uwt({x:n,y:t,x2:e,y2:i}){return{x:n,y:t,width:e-n,height:i-t}}function wY(n){let t={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,x2:Number.NEGATIVE_INFINITY,y2:Number.NEGATIVE_INFINITY};for(let e=0;e<n.length;e++){const i=n[e];t=jwt(t,CY({...i.computedPosition,...i.dimensions}))}return Uwt(t)}function xY(n,t,e={x:0,y:0,zoom:1},i=!1,r=!1){const o={...wm(t,e),width:t.width/e.zoom,height:t.height/e.zoom},s=[];for(const a of n){const{dimensions:l,selectable:h=!0,hidden:u=!1}=a,d=l.width??a.width??null,c=l.height??a.height??null;if(r&&!h||u)continue;const f=Hw(o,Iw(a)),g=d===null||c===null,p=i&&f>0,v=(d??0)*(c??0);(g||p||f>=v||a.dragging)&&s.push(a)}return s}function SY(n,t){const e=new Set;if(typeof n=="string")e.add(n);else if(n.length>=1)for(const i of n)e.add(i.id);return t.filter(i=>e.has(i.source)||e.has(i.target))}function EN(n,t,e,i,r,o=.1,s={x:0,y:0}){const a=t/(n.width*(1+o)),l=e/(n.height*(1+o)),h=Math.min(a,l),u=fc(h,i,r),d=n.x+n.width/2,c=n.y+n.height/2,f=t/2-d*u+(s.x??0),g=e/2-c*u+(s.y??0);return{x:f,y:g,zoom:u}}function Xwt(n,t){return{x:t.x+n.x,y:t.y+n.y,z:(n.z>t.z?n.z:t.z)+1}}function AY(n,t){if(!n.parentNode)return!1;const e=t(n.parentNode);return e?e.selected?!0:AY(e,t):!1}function xm(n,t){return typeof n>"u"?"":typeof n=="string"?n:`${t?`${t}__`:""}${Object.keys(n).sort().map(i=>`${i}=${n[i]}`).join("&")}`}function LN(n,t,e){return n<t?fc(Math.abs(n-t),1,t)/t:n>e?-fc(Math.abs(n-e),1,t)/t:0}function TY(n,t,e=15,i=40){const r=LN(n.x,i,t.width-i)*e,o=LN(n.y,i,t.height-i)*e;return[r,o]}function fR(n,t){if(t){const e=n.position.x+n.dimensions.width-t.dimensions.width,i=n.position.y+n.dimensions.height-t.dimensions.height;if(e>0||i>0||n.position.x<0||n.position.y<0){let r={};if(typeof t.style=="function"?r={...t.style(t)}:t.style&&(r={...t.style}),r.width=r.width??`${t.dimensions.width}px`,r.height=r.height??`${t.dimensions.height}px`,e>0)if(typeof r.width=="string"){const o=Number(r.width.replace("px",""));r.width=`${o+e}px`}else r.width+=e;if(i>0)if(typeof r.height=="string"){const o=Number(r.height.replace("px",""));r.height=`${o+i}px`}else r.height+=i;if(n.position.x<0){const o=Math.abs(n.position.x);if(t.position.x=t.position.x-o,typeof r.width=="string"){const s=Number(r.width.replace("px",""));r.width=`${s+o}px`}else r.width+=o;n.position.x=0}if(n.position.y<0){const o=Math.abs(n.position.y);if(t.position.y=t.position.y-o,typeof r.height=="string"){const s=Number(r.height.replace("px",""));r.height=`${s+o}px`}else r.height+=o;n.position.y=0}t.dimensions.width=Number(r.width.toString().replace("px","")),t.dimensions.height=Number(r.height.toString().replace("px","")),typeof t.style=="function"?t.style=o=>{const s=t.style;return{...s(o),...r}}:t.style={...t.style,...r}}}}function ON(n,t){var e,i;const r=n.filter(s=>s.type==="add"||s.type==="remove");for(const s of r)if(s.type==="add")t.findIndex(l=>l.id===s.item.id)===-1&&t.push(s.item);else if(s.type==="remove"){const a=t.findIndex(l=>l.id===s.id);a!==-1&&t.splice(a,1)}const o=t.map(s=>s.id);for(const s of t)for(const a of n)if(a.id===s.id)switch(a.type){case"select":s.selected=a.selected;break;case"position":if(Gv(s)&&(typeof a.position<"u"&&(s.position=a.position),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&s.parentNode)){const l=t[o.indexOf(s.parentNode)];l&&Gv(l)&&fR(s,l)}break;case"dimensions":if(Gv(s)&&(typeof a.dimensions<"u"&&(s.dimensions=a.dimensions),typeof a.updateStyle<"u"&&a.updateStyle&&(s.style={...s.style||{},width:`${(e=a.dimensions)==null?void 0:e.width}px`,height:`${(i=a.dimensions)==null?void 0:i.height}px`}),typeof a.resizing<"u"&&(s.resizing=a.resizing),s.expandParent&&s.parentNode)){const l=t[o.indexOf(s.parentNode)];l&&Gv(l)&&(!!l.dimensions.width&&!!l.dimensions.height?fR(s,l):El(()=>{fR(s,l)}))}break}return t}function bh(n,t){return{id:n,type:"select",selected:t}}function DN(n){return{item:n,type:"add"}}function IN(n){return{id:n,type:"remove"}}function HN(n,t,e,i,r){return{id:n,source:t,target:e,sourceHandle:i||null,targetHandle:r||null,type:"remove"}}function wh(n,t=new Set,e=!1){const i=[];for(const[r,o]of n){const s=t.has(r);!(o.selected===void 0&&!s)&&o.selected!==s&&(e&&(o.selected=s),i.push(bh(o.id,s)))}return i}function Rt(n){const t=new Set;let e=!1;const i=()=>t.size>0;n&&(e=!0,t.add(n));const r=a=>{t.delete(a)};return{on:a=>{n&&e&&t.delete(n),t.add(a);const l=()=>{r(a),n&&e&&t.add(n)};return zS(l),{off:l}},off:r,trigger:a=>Promise.all(Array.from(t).map(l=>l(a))),hasListeners:i,fns:t}}function FN(n,t,e){let i=n;do{if(i&&i.matches(t))return!0;if(i===e)return!1;i=i.parentElement}while(i);return!1}function Ywt(n,t,e,i,r){var o,s;const a=[];for(const l of n)(l.selected||l.id===r)&&(!l.parentNode||!AY(l,i))&&(l.draggable||t&&typeof l.draggable>"u")&&a.push(t0({id:l.id,position:l.position||{x:0,y:0},distance:{x:e.x-((o=l.computedPosition)==null?void 0:o.x)||0,y:e.y-((s=l.computedPosition)==null?void 0:s.y)||0},from:l.computedPosition,extent:l.extent,parentNode:l.parentNode,dimensions:l.dimensions,expandParent:l.expandParent}));return a}function gR({id:n,dragItems:t,findNode:e}){const i=[];for(const r of t){const o=e(r.id);o&&i.push(o)}return[n?i.find(r=>r.id===n):i[0],i]}function MY(n){if(Array.isArray(n))switch(n.length){case 1:return[n[0],n[0],n[0],n[0]];case 2:return[n[0],n[1],n[0],n[1]];case 3:return[n[0],n[1],n[2],n[1]];case 4:return n;default:return[0,0,0,0]}return[n,n,n,n]}function Kwt(n,t,e){const[i,r,o,s]=typeof n!="string"?MY(n.padding):[0,0,0,0];return e&&typeof e.computedPosition.x<"u"&&typeof e.computedPosition.y<"u"&&typeof e.dimensions.width<"u"&&typeof e.dimensions.height<"u"?[[e.computedPosition.x+s,e.computedPosition.y+i],[e.computedPosition.x+e.dimensions.width-r,e.computedPosition.y+e.dimensions.height-o]]:!1}function qwt(n,t,e,i){let r=n.extent||e;if((r==="parent"||!Array.isArray(r)&&r?.range==="parent")&&!n.expandParent)if(n.parentNode&&i&&n.dimensions.width&&n.dimensions.height){const o=Kwt(r,n,i);o&&(r=o)}else t(new Pn(Sn.NODE_EXTENT_INVALID,n.id)),r=e;else if(Array.isArray(r)){const o=i?.computedPosition.x||0,s=i?.computedPosition.y||0;r=[[r[0][0]+o,r[0][1]+s],[r[1][0]+o,r[1][1]+s]]}else if(r!=="parent"&&r?.range&&Array.isArray(r.range)){const[o,s,a,l]=MY(r.padding),h=i?.computedPosition.x||0,u=i?.computedPosition.y||0;r=[[r.range[0][0]+h+l,r.range[0][1]+u+o],[r.range[1][0]+h-s,r.range[1][1]+u-a]]}return r==="parent"?[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]]:r}function Zwt({width:n,height:t},e){return[e[0],[e[1][0]-(n||0),e[1][1]-(t||0)]]}function xO(n,t,e,i,r){const o=Zwt(n.dimensions,qwt(n,e,i,r)),s=mY(t,o);return{position:{x:s.x-(r?.computedPosition.x||0),y:s.y-(r?.computedPosition.y||0)},computedPosition:s}}function Yg(n,t,e=Ot.Left,i=!1){const r=(t?.x??0)+n.computedPosition.x,o=(t?.y??0)+n.computedPosition.y,{width:s,height:a}=t??e1t(n);if(i)return{x:r+s/2,y:o+a/2};switch(t?.position??e){case Ot.Top:return{x:r+s/2,y:o};case Ot.Right:return{x:r+s,y:o+a/2};case Ot.Bottom:return{x:r+s/2,y:o+a};case Ot.Left:return{x:r,y:o+a/2}}}function zN(n,t){return n&&(t?n.find(e=>e.id===t):n[0])||null}function Jwt({sourcePos:n,targetPos:t,sourceWidth:e,sourceHeight:i,targetWidth:r,targetHeight:o,width:s,height:a,viewport:l}){const h={x:Math.min(n.x,t.x),y:Math.min(n.y,t.y),x2:Math.max(n.x+e,t.x+r),y2:Math.max(n.y+i,t.y+o)};h.x===h.x2&&(h.x2+=1),h.y===h.y2&&(h.y2+=1);const u=CY({x:(0-l.x)/l.zoom,y:(0-l.y)/l.zoom,width:s/l.zoom,height:a/l.zoom}),d=Math.max(0,Math.min(u.x2,h.x2)-Math.max(u.x,h.x)),c=Math.max(0,Math.min(u.y2,h.y2)-Math.max(u.y,h.y));return Math.ceil(d*c)>0}function Qwt(n,t,e=!1){const i=typeof n.zIndex=="number";let r=i?n.zIndex:0;const o=t(n.source),s=t(n.target);return!o||!s?0:(e&&(r=i?n.zIndex:Math.max(o.computedPosition.z||0,s.computedPosition.z||0)),r)}var Sn=(n=>(n.MISSING_STYLES="MISSING_STYLES",n.MISSING_VIEWPORT_DIMENSIONS="MISSING_VIEWPORT_DIMENSIONS",n.NODE_INVALID="NODE_INVALID",n.NODE_NOT_FOUND="NODE_NOT_FOUND",n.NODE_MISSING_PARENT="NODE_MISSING_PARENT",n.NODE_TYPE_MISSING="NODE_TYPE_MISSING",n.NODE_EXTENT_INVALID="NODE_EXTENT_INVALID",n.EDGE_INVALID="EDGE_INVALID",n.EDGE_NOT_FOUND="EDGE_NOT_FOUND",n.EDGE_SOURCE_MISSING="EDGE_SOURCE_MISSING",n.EDGE_TARGET_MISSING="EDGE_TARGET_MISSING",n.EDGE_TYPE_MISSING="EDGE_TYPE_MISSING",n.EDGE_SOURCE_TARGET_SAME="EDGE_SOURCE_TARGET_SAME",n.EDGE_SOURCE_TARGET_MISSING="EDGE_SOURCE_TARGET_MISSING",n.EDGE_ORPHANED="EDGE_ORPHANED",n.USEVUEFLOW_OPTIONS="USEVUEFLOW_OPTIONS",n))(Sn||{});const NN={MISSING_STYLES:()=>"It seems that you haven't loaded the necessary styles. Please import '@vue-flow/core/dist/style.css' to ensure that the graph is rendered correctly",MISSING_VIEWPORT_DIMENSIONS:()=>"The Vue Flow parent container needs a width and a height to render the graph",NODE_INVALID:n=>`Node is invalid
Node: ${n}`,NODE_NOT_FOUND:n=>`Node not found
Node: ${n}`,NODE_MISSING_PARENT:(n,t)=>`Node is missing a parent
Node: ${n}
Parent: ${t}`,NODE_TYPE_MISSING:n=>`Node type is missing
Type: ${n}`,NODE_EXTENT_INVALID:n=>`Only child nodes can use a parent extent
Node: ${n}`,EDGE_INVALID:n=>`An edge needs a source and a target
Edge: ${n}`,EDGE_SOURCE_MISSING:(n,t)=>`Edge source is missing
Edge: ${n} 
Source: ${t}`,EDGE_TARGET_MISSING:(n,t)=>`Edge target is missing
Edge: ${n} 
Target: ${t}`,EDGE_TYPE_MISSING:n=>`Edge type is missing
Type: ${n}`,EDGE_SOURCE_TARGET_SAME:(n,t,e)=>`Edge source and target are the same
Edge: ${n} 
Source: ${t} 
Target: ${e}`,EDGE_SOURCE_TARGET_MISSING:(n,t,e)=>`Edge source or target is missing
Edge: ${n} 
Source: ${t} 
Target: ${e}`,EDGE_ORPHANED:n=>`Edge was orphaned (suddenly missing source or target) and has been removed
Edge: ${n}`,EDGE_NOT_FOUND:n=>`Edge not found
Edge: ${n}`,USEVUEFLOW_OPTIONS:()=>"The options parameter is deprecated and will be removed in the next major version. Please use the id parameter instead"};class Pn extends Error{constructor(t,...e){var i;super((i=NN[t])==null?void 0:i.call(NN,...e)),this.name="VueFlowError",this.code=t,this.args=e}}function SO(n){return"clientX"in n}function t1t(n){return"sourceEvent"in n}function Aa(n,t){const e=SO(n);let i,r;return e?(i=n.clientX,r=n.clientY):"touches"in n&&n.touches.length>0?(i=n.touches[0].clientX,r=n.touches[0].clientY):"changedTouches"in n&&n.changedTouches.length>0?(i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(i=0,r=0),{x:i-(t?.left??0),y:r-(t?.top??0)}}const Fw=()=>{var n;return typeof navigator<"u"&&((n=navigator?.userAgent)==null?void 0:n.indexOf("Mac"))>=0};function e1t(n){var t,e;return{width:((t=n.dimensions)==null?void 0:t.width)??n.width??0,height:((e=n.dimensions)==null?void 0:e.height)??n.height??0}}function jS(n,t=[1,1]){return{x:t[0]*Math.round(n.x/t[0]),y:t[1]*Math.round(n.y/t[1])}}const i1t=()=>!0;function pR(n){n?.classList.remove("valid","connecting","vue-flow__handle-valid","vue-flow__handle-connecting")}function n1t(n,t,e){const i=[],r={x:n.x-e,y:n.y-e,width:e*2,height:e*2};for(const o of t.values())Hw(r,Iw(o))>0&&i.push(o);return i}const r1t=250;function o1t(n,t,e,i){var r,o;let s=[],a=Number.POSITIVE_INFINITY;const l=n1t(n,e,t+r1t);for(const h of l){const u=[...((r=h.handleBounds)==null?void 0:r.source)??[],...((o=h.handleBounds)==null?void 0:o.target)??[]];for(const d of u){if(i.nodeId===d.nodeId&&i.type===d.type&&i.id===d.id)continue;const{x:c,y:f}=Yg(h,d,d.position,!0),g=Math.sqrt((c-n.x)**2+(f-n.y)**2);g>t||(g<a?(s=[{...d,x:c,y:f}],a=g):g===a&&s.push({...d,x:c,y:f}))}}if(!s.length)return null;if(s.length>1){const h=i.type==="source"?"target":"source";return s.find(u=>u.type===h)??s[0]}return s[0]}function WN(n,{handle:t,connectionMode:e,fromNodeId:i,fromHandleId:r,fromType:o,doc:s,lib:a,flowId:l,isValidConnection:h=i1t},u,d,c){const f=o==="target",g=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:p,y:v}=Aa(n),m=s.elementFromPoint(p,v),y=m?.classList.contains(`${a}-flow__handle`)?m:g,b={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const _=RY(void 0,y),w=y.getAttribute("data-nodeid"),C=y.getAttribute("data-handleid"),x=y.classList.contains("connectable"),S=y.classList.contains("connectableend");if(!w||!_)return b;const A={source:f?w:i,sourceHandle:f?C:r,target:f?i:w,targetHandle:f?r:C};b.connection=A;const M=x&&S&&(e===iu.Strict?f&&_==="source"||!f&&_==="target":w!==i||C!==r);b.isValid=M&&h(A,{nodes:d,edges:u,sourceNode:c(i),targetNode:c(w)}),b.toHandle=t}return b}function RY(n,t){return n||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function s1t(n,t){let e=null;return t?e="valid":n&&!t&&(e="invalid"),e}function a1t(n,t){let e=null;return t?e=!0:n&&!t&&(e=!1),e}function l1t(n,t,e,i,r,o=!1){var s,a,l;const h=i.get(n);if(!h)return null;const u=r===iu.Strict?(s=h.handleBounds)==null?void 0:s[t]:[...((a=h.handleBounds)==null?void 0:a.source)??[],...((l=h.handleBounds)==null?void 0:l.target)??[]],d=(e?u?.find(c=>c.id===e):u?.[0])??null;return d&&o?{...d,...Yg(h,d,d.position,!0)}:d}const _P={[Ot.Left]:Ot.Right,[Ot.Right]:Ot.Left,[Ot.Top]:Ot.Bottom,[Ot.Bottom]:Ot.Top},h1t=["production","prod"];function US(n,...t){BY()}function BY(){return!h1t.includes("production")}function VN(n,t,e,i,r){const o=t.querySelectorAll(`.vue-flow__handle.${n}`);return o?.length?Array.from(o).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:n,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-e.left)/i,y:(a.top-e.top)/i,...$S(s)}}):null}function CP(n,t,e,i,r,o=!1,s){r.value=!1,n.selected?(o||n.selected&&t)&&(i([n]),El(()=>{s.blur()})):e([n])}function _n(n){return typeof Xt(n)<"u"}function u1t(n,t,e,i){if(!n||!n.source||!n.target)return e(new Pn(Sn.EDGE_INVALID,n?.id??"[ID UNKNOWN]")),!1;let r;return nu(n)?r=n:r={...n,id:_Y(n)},r=yY(r,void 0,i),$wt(r,t)?!1:r}function d1t(n,t,e,i,r){if(!t.source||!t.target)return r(new Pn(Sn.EDGE_INVALID,n.id)),!1;if(!e)return r(new Pn(Sn.EDGE_NOT_FOUND,n.id)),!1;const{id:o,...s}=n;return{...s,id:i?_Y(t):o,source:t.source,target:t.target,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle}}function GN(n,t,e){const i={},r=[];for(let o=0;o<n.length;++o){const s=n[o];if(!Gd(s)){e(new Pn(Sn.NODE_INVALID,s?.id)||`[ID UNKNOWN|INDEX ${o}]`);continue}const a=Wwt(s,t(s.id),s.parentNode);s.parentNode&&(i[s.parentNode]=!0),r[o]=a}for(const o of r){const s=t(o.parentNode)||r.find(a=>a.id===o.parentNode);o.parentNode&&!s&&e(new Pn(Sn.NODE_MISSING_PARENT,o.id,o.parentNode)),(o.parentNode||i[o.id])&&(i[o.id]&&(o.isParent=!0),s&&(s.isParent=!0))}return r}function $N(n,t,e,i,r,o){let s=r;const a=i.get(s)||new Map;i.set(s,a.set(e,t)),s=`${r}-${n}`;const l=i.get(s)||new Map;if(i.set(s,l.set(e,t)),o){s=`${r}-${n}-${o}`;const h=i.get(s)||new Map;i.set(s,h.set(e,t))}}function vR(n,t,e){n.clear();for(const i of e){const{source:r,target:o,sourceHandle:s=null,targetHandle:a=null}=i,l={edgeId:i.id,source:r,target:o,sourceHandle:s,targetHandle:a},h=`${r}-${s}--${o}-${a}`,u=`${o}-${a}--${r}-${s}`;$N("source",l,u,n,r,s),$N("target",l,h,n,o,a)}}function jN(n,t){if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0}function mR(n,t,e,i,r,o,s,a){const l=[];for(const h of n){const u=nu(h)?h:u1t(h,a,r,o);if(!u)continue;const d=e(u.source),c=e(u.target);if(!d||!c){r(new Pn(Sn.EDGE_SOURCE_TARGET_MISSING,u.id,u.source,u.target));continue}if(!d){r(new Pn(Sn.EDGE_SOURCE_MISSING,u.id,u.source));continue}if(!c){r(new Pn(Sn.EDGE_TARGET_MISSING,u.id,u.target));continue}if(t&&!t(u,{edges:a,nodes:s,sourceNode:d,targetNode:c})){r(new Pn(Sn.EDGE_INVALID,u.id));continue}const f=i(u.id);l.push({...yY(u,f,o),sourceNode:d,targetNode:c})}return l}const UN=Symbol("vueFlow"),PY=Symbol("nodeId"),kY=Symbol("nodeRef"),c1t=Symbol("edgeId"),f1t=Symbol("edgeRef"),XS=Symbol("slots");function EY(n){const{vueFlowRef:t,snapToGrid:e,snapGrid:i,noDragClassName:r,nodes:o,nodeExtent:s,nodeDragThreshold:a,viewport:l,autoPanOnNodeDrag:h,autoPanSpeed:u,nodesDraggable:d,panBy:c,findNode:f,multiSelectionActive:g,nodesSelectionActive:p,selectNodesOnDrag:v,removeSelectedElements:m,addSelectedNodes:y,updateNodePositions:b,emits:_}=en(),{onStart:w,onDrag:C,onStop:x,onClick:S,el:A,disabled:T,id:M,selectable:R,dragHandle:E}=n,P=MC(!1);let B=[],k,L=null,O={x:void 0,y:void 0},D={x:0,y:0},I=null,H=!1,F=0,G=!1;const j=v1t(),W=({x:Z,y:et})=>{O={x:Z,y:et};let nt=!1;if(B=B.map(z=>{const V={x:Z-z.distance.x,y:et-z.distance.y},{computedPosition:$}=xO(z,e.value?jS(V,i.value):V,_.error,s.value,z.parentNode?f(z.parentNode):void 0);return nt=nt||z.position.x!==$.x||z.position.y!==$.y,z.position=$,z}),!!nt&&(b(B,!0,!0),P.value=!0,I)){const[z,V]=gR({id:M,dragItems:B,findNode:f});C({event:I,node:z,nodes:V})}},K=()=>{if(!L)return;const[Z,et]=TY(D,L,u.value);if(Z!==0||et!==0){const nt={x:(O.x??0)-Z/l.value.zoom,y:(O.y??0)-et/l.value.zoom};c({x:Z,y:et})&&W(nt)}F=requestAnimationFrame(K)},J=(Z,et)=>{H=!0;const nt=f(M);!v.value&&!g.value&&nt&&(nt.selected||m()),nt&&Be(R)&&v.value&&CP(nt,g.value,y,m,p,!1,et);const z=j(Z.sourceEvent);if(O=z,B=Ywt(o.value,d.value,z,f,M),B.length){const[V,$]=gR({id:M,dragItems:B,findNode:f});w({event:Z.sourceEvent,node:V,nodes:$})}},q=(Z,et)=>{var nt;Z.sourceEvent.type==="touchmove"&&Z.sourceEvent.touches.length>1||(a.value===0&&J(Z,et),O=j(Z.sourceEvent),L=((nt=t.value)==null?void 0:nt.getBoundingClientRect())||null,D=Aa(Z.sourceEvent,L))},X=(Z,et)=>{const nt=j(Z.sourceEvent);if(!G&&H&&h.value&&(G=!0,K()),!H){const z=nt.xSnapped-(O.x??0),V=nt.ySnapped-(O.y??0);Math.sqrt(z*z+V*V)>a.value&&J(Z,et)}(O.x!==nt.xSnapped||O.y!==nt.ySnapped)&&B.length&&H&&(I=Z.sourceEvent,D=Aa(Z.sourceEvent,L),W(nt))},it=Z=>{let et=!1;if(!H&&!P.value&&!g.value){const nt=Z.sourceEvent,z=j(nt),V=z.xSnapped-(O.x??0),$=z.ySnapped-(O.y??0),U=Math.sqrt(V*V+$*$);U!==0&&U<=a.value&&(S?.(nt),et=!0)}if(B.length&&!et){b(B,!1,!1);const[nt,z]=gR({id:M,dragItems:B,findNode:f});x({event:Z.sourceEvent,node:nt,nodes:z})}B=[],P.value=!1,G=!1,H=!1,O={x:void 0,y:void 0},cancelAnimationFrame(F)};return li([()=>Be(T),A],([Z,et],nt,z)=>{if(et){const V=Is(et);Z||(k=N_t().on("start",$=>q($,et)).on("drag",$=>X($,et)).on("end",$=>it($)).filter($=>{const U=$.target,Q=Be(E);return!$.button&&(!r.value||!FN(U,`.${r.value}`,et)&&(!Q||FN(U,Q,et)))}),V.call(k)),z(()=>{V.on(".drag",null),k&&(k.on("start",null),k.on("drag",null),k.on("end",null))})}}),P}function g1t(){return{doubleClick:Rt(),click:Rt(),mouseEnter:Rt(),mouseMove:Rt(),mouseLeave:Rt(),contextMenu:Rt(),updateStart:Rt(),update:Rt(),updateEnd:Rt()}}function p1t(n,t){const e=g1t();return e.doubleClick.on(i=>{var r,o;t.edgeDoubleClick(i),(o=(r=n.events)==null?void 0:r.doubleClick)==null||o.call(r,i)}),e.click.on(i=>{var r,o;t.edgeClick(i),(o=(r=n.events)==null?void 0:r.click)==null||o.call(r,i)}),e.mouseEnter.on(i=>{var r,o;t.edgeMouseEnter(i),(o=(r=n.events)==null?void 0:r.mouseEnter)==null||o.call(r,i)}),e.mouseMove.on(i=>{var r,o;t.edgeMouseMove(i),(o=(r=n.events)==null?void 0:r.mouseMove)==null||o.call(r,i)}),e.mouseLeave.on(i=>{var r,o;t.edgeMouseLeave(i),(o=(r=n.events)==null?void 0:r.mouseLeave)==null||o.call(r,i)}),e.contextMenu.on(i=>{var r,o;t.edgeContextMenu(i),(o=(r=n.events)==null?void 0:r.contextMenu)==null||o.call(r,i)}),e.updateStart.on(i=>{var r,o;t.edgeUpdateStart(i),(o=(r=n.events)==null?void 0:r.updateStart)==null||o.call(r,i)}),e.update.on(i=>{var r,o;t.edgeUpdate(i),(o=(r=n.events)==null?void 0:r.update)==null||o.call(r,i)}),e.updateEnd.on(i=>{var r,o;t.edgeUpdateEnd(i),(o=(r=n.events)==null?void 0:r.updateEnd)==null||o.call(r,i)}),Object.entries(e).reduce((i,[r,o])=>(i.emit[r]=o.trigger,i.on[r]=o.on,i),{emit:{},on:{}})}function v1t(){const{viewport:n,snapGrid:t,snapToGrid:e,vueFlowRef:i}=en();return r=>{var o;const s=((o=i.value)==null?void 0:o.getBoundingClientRect())??{left:0,top:0},a=t1t(r)?r.sourceEvent:r,{x:l,y:h}=Aa(a,s),u=wm({x:l,y:h},n.value),{x:d,y:c}=e.value?jS(u,t.value):u;return{xSnapped:d,ySnapped:c,...u}}}function Yb(){return!0}function LY({handleId:n,nodeId:t,type:e,isValidConnection:i,edgeUpdaterType:r,onEdgeUpdate:o,onEdgeUpdateEnd:s}){const{id:a,vueFlowRef:l,connectionMode:h,connectionRadius:u,connectOnClick:d,connectionClickStartHandle:c,nodesConnectable:f,autoPanOnConnect:g,autoPanSpeed:p,findNode:v,panBy:m,startConnection:y,updateConnection:b,endConnection:_,emits:w,viewport:C,edges:x,nodes:S,isValidConnection:A,nodeLookup:T}=en();let M=null,R=!1,E=null;function P(k){var L;const O=Be(e)==="target",D=SO(k),I=kN(k.target);if(D&&k.button===0||!D){let H=function(ht){z=Aa(ht,Z),W=o1t(wm(z,C.value,!1,[1,1]),u.value,T.value,U),V||($(),V=!0);const gt=WN(ht,{handle:W,connectionMode:h.value,fromNodeId:Be(t),fromHandleId:Be(n),fromType:O?"target":"source",isValidConnection:j,doc:I,lib:"vue",flowId:a,nodeLookup:T.value},x.value,S.value,v);E=gt.handleDomNode,M=gt.connection,R=a1t(!!W,gt.isValid);const dt={...at,isValid:R,to:gt.toHandle&&R?bP({x:gt.toHandle.x,y:gt.toHandle.y},C.value):z,toHandle:gt.toHandle,toPosition:R&&gt.toHandle?gt.toHandle.position:_P[U.position],toNode:gt.toHandle?T.value.get(gt.toHandle.nodeId):null};if(!(R&&W&&at?.toHandle&&dt.toHandle&&at.toHandle.type===dt.toHandle.type&&at.toHandle.nodeId===dt.toHandle.nodeId&&at.toHandle.id===dt.toHandle.id&&at.to.x===dt.to.x&&at.to.y===dt.to.y)){if(b(W&&R?bP({x:W.x,y:W.y},C.value):z,gt.toHandle,s1t(!!W,R)),at=dt,!W&&!R&&!E)return pR(nt);M&&M.source!==M.target&&E&&(pR(nt),nt=E,E.classList.add("connecting","vue-flow__handle-connecting"),E.classList.toggle("valid",!!R),E.classList.toggle("vue-flow__handle-valid",!!R))}},F=function(ht){(W||E)&&M&&R&&(o?o(ht,M):w.connect(M)),w.connectEnd(ht),r&&s?.(ht),pR(nt),cancelAnimationFrame(K),_(ht),V=!1,R=!1,M=null,E=null,I.removeEventListener("mousemove",H),I.removeEventListener("mouseup",F),I.removeEventListener("touchmove",H),I.removeEventListener("touchend",F)};const G=v(Be(t));let j=Be(i)||A.value||Yb;!j&&G&&(j=(O?G.isValidSourcePos:G.isValidTargetPos)||Yb);let W,K=0;const{x:J,y:q}=Aa(k),X=I?.elementFromPoint(J,q),it=RY(Be(r),X),Z=(L=l.value)==null?void 0:L.getBoundingClientRect();if(!Z||!it)return;const et=l1t(Be(t),it,Be(n),T.value,h.value);if(!et)return;let nt,z=Aa(k,Z),V=!1;const $=()=>{if(!g.value)return;const[ht,gt]=TY(z,Z,p.value);m({x:ht,y:gt}),K=requestAnimationFrame($)},U={...et,nodeId:Be(t),type:it,position:et.position},Q=T.value.get(Be(t)),st={inProgress:!0,isValid:null,from:Yg(Q,U,Ot.Left,!0),fromHandle:U,fromPosition:U.position,fromNode:Q,to:z,toHandle:null,toPosition:_P[U.position],toNode:null};y({nodeId:Be(t),id:Be(n),type:it,position:X?.getAttribute("data-handlepos")||Ot.Top,...z},{x:J-Z.left,y:q-Z.top}),w.connectStart({event:k,nodeId:Be(t),handleId:Be(n),handleType:it});let at=st;I.addEventListener("mousemove",H),I.addEventListener("mouseup",F),I.addEventListener("touchmove",H),I.addEventListener("touchend",F)}}function B(k){var L,O;if(!d.value)return;const D=Be(e)==="target";if(!c.value){w.clickConnectStart({event:k,nodeId:Be(t),handleId:Be(n)}),y({nodeId:Be(t),type:Be(e),id:Be(n),position:Ot.Top,...Aa(k)},void 0,!0);return}let I=Be(i)||A.value||Yb;const H=v(Be(t));if(!I&&H&&(I=(D?H.isValidSourcePos:H.isValidTargetPos)||Yb),H&&(typeof H.connectable>"u"?f.value:H.connectable)===!1)return;const F=kN(k.target),G=WN(k,{handle:{nodeId:Be(t),id:Be(n),type:Be(e),position:Ot.Top,...Aa(k)},connectionMode:h.value,fromNodeId:c.value.nodeId,fromHandleId:c.value.id??null,fromType:c.value.type,isValidConnection:I,doc:F,lib:"vue",flowId:a,nodeLookup:T.value},x.value,S.value,v),j=((L=G.connection)==null?void 0:L.source)===((O=G.connection)==null?void 0:O.target);G.isValid&&G.connection&&!j&&w.connect(G.connection),w.clickConnectEnd(k),_(k,!0)}return{handlePointerDown:P,handleClick:B}}function m1t(){return hp(PY,"")}function OY(n){const t=n??m1t()??"",e=hp(kY,qi(null)),{findNode:i,edges:r,emits:o}=en(),s=i(t);return s||o.error(new Pn(Sn.NODE_NOT_FOUND,t)),{id:t,nodeEl:e,node:s,parentNode:be(()=>i(s.parentNode)),connectedEdges:be(()=>SY([s],r.value))}}function y1t(){return{doubleClick:Rt(),click:Rt(),mouseEnter:Rt(),mouseMove:Rt(),mouseLeave:Rt(),contextMenu:Rt(),dragStart:Rt(),drag:Rt(),dragStop:Rt()}}function b1t(n,t){const e=y1t();return e.doubleClick.on(i=>{var r,o;t.nodeDoubleClick(i),(o=(r=n.events)==null?void 0:r.doubleClick)==null||o.call(r,i)}),e.click.on(i=>{var r,o;t.nodeClick(i),(o=(r=n.events)==null?void 0:r.click)==null||o.call(r,i)}),e.mouseEnter.on(i=>{var r,o;t.nodeMouseEnter(i),(o=(r=n.events)==null?void 0:r.mouseEnter)==null||o.call(r,i)}),e.mouseMove.on(i=>{var r,o;t.nodeMouseMove(i),(o=(r=n.events)==null?void 0:r.mouseMove)==null||o.call(r,i)}),e.mouseLeave.on(i=>{var r,o;t.nodeMouseLeave(i),(o=(r=n.events)==null?void 0:r.mouseLeave)==null||o.call(r,i)}),e.contextMenu.on(i=>{var r,o;t.nodeContextMenu(i),(o=(r=n.events)==null?void 0:r.contextMenu)==null||o.call(r,i)}),e.dragStart.on(i=>{var r,o;t.nodeDragStart(i),(o=(r=n.events)==null?void 0:r.dragStart)==null||o.call(r,i)}),e.drag.on(i=>{var r,o;t.nodeDrag(i),(o=(r=n.events)==null?void 0:r.drag)==null||o.call(r,i)}),e.dragStop.on(i=>{var r,o;t.nodeDragStop(i),(o=(r=n.events)==null?void 0:r.dragStop)==null||o.call(r,i)}),Object.entries(e).reduce((i,[r,o])=>(i.emit[r]=o.trigger,i.on[r]=o.on,i),{emit:{},on:{}})}function DY(){const{getSelectedNodes:n,nodeExtent:t,updateNodePositions:e,findNode:i,snapGrid:r,snapToGrid:o,nodesDraggable:s,emits:a}=en();return(l,h=!1)=>{const u=o.value?r.value[0]:5,d=o.value?r.value[1]:5,c=h?4:1,f=l.x*u*c,g=l.y*d*c,p=[];for(const v of n.value)if(v.draggable||s&&typeof v.draggable>"u"){const m={x:v.computedPosition.x+f,y:v.computedPosition.y+g},{computedPosition:y}=xO(v,m,a.error,t.value,v.parentNode?i(v.parentNode):void 0);p.push({id:v.id,position:y,from:v.position,distance:{x:l.x,y:l.y},dimensions:v.dimensions})}e(p,!0,!1)}}const yR=.1,_1t=n=>((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2;function uh(){return US("Viewport not initialized yet."),Promise.resolve(!1)}const C1t={zoomIn:uh,zoomOut:uh,zoomTo:uh,fitView:uh,setCenter:uh,fitBounds:uh,project:n=>n,screenToFlowCoordinate:n=>n,flowToScreenCoordinate:n=>n,setViewport:uh,setTransform:uh,getViewport:()=>({x:0,y:0,zoom:1}),getTransform:()=>({x:0,y:0,zoom:1}),viewportInitialized:!1};function w1t(n){function t(i,r){return new Promise(o=>{n.d3Selection&&n.d3Zoom?n.d3Zoom.interpolate(r?.interpolate==="linear"?C0:oC).scaleBy(bR(n.d3Selection,r?.duration,r?.ease,()=>{o(!0)}),i):o(!1)})}function e(i,r,o,s){return new Promise(a=>{var l;const{x:h,y:u}=mY({x:-i,y:-r},n.translateExtent),d=Xg.translate(-h,-u).scale(o);n.d3Selection&&n.d3Zoom?(l=n.d3Zoom)==null||l.interpolate(s?.interpolate==="linear"?C0:oC).transform(bR(n.d3Selection,s?.duration,s?.ease,()=>{a(!0)}),d):a(!1)})}return be(()=>n.d3Zoom&&n.d3Selection&&n.dimensions.width&&n.dimensions.height?{viewportInitialized:!0,zoomIn:r=>t(1.2,r),zoomOut:r=>t(1/1.2,r),zoomTo:(r,o)=>new Promise(s=>{n.d3Selection&&n.d3Zoom?n.d3Zoom.interpolate(o?.interpolate==="linear"?C0:oC).scaleTo(bR(n.d3Selection,o?.duration,o?.ease,()=>{s(!0)}),r):s(!1)}),setViewport:(r,o)=>e(r.x,r.y,r.zoom,o),setTransform:(r,o)=>e(r.x,r.y,r.zoom,o),getViewport:()=>({x:n.viewport.x,y:n.viewport.y,zoom:n.viewport.zoom}),getTransform:()=>({x:n.viewport.x,y:n.viewport.y,zoom:n.viewport.zoom}),fitView:(r={padding:yR,includeHiddenNodes:!1,duration:0})=>{var o,s;const a=[];for(const c of n.nodes)c.dimensions.width&&c.dimensions.height&&(r?.includeHiddenNodes||!c.hidden)&&(!((o=r.nodes)!=null&&o.length)||(s=r.nodes)!=null&&s.length&&r.nodes.includes(c.id))&&a.push(c);if(!a.length)return Promise.resolve(!1);const l=wY(a),{x:h,y:u,zoom:d}=EN(l,n.dimensions.width,n.dimensions.height,r.minZoom??n.minZoom,r.maxZoom??n.maxZoom,r.padding??yR,r.offset);return e(h,u,d,r)},setCenter:(r,o,s)=>{const a=typeof s?.zoom<"u"?s.zoom:n.maxZoom,l=n.dimensions.width/2-r*a,h=n.dimensions.height/2-o*a;return e(l,h,a,s)},fitBounds:(r,o={padding:yR})=>{const{x:s,y:a,zoom:l}=EN(r,n.dimensions.width,n.dimensions.height,n.minZoom,n.maxZoom,o.padding);return e(s,a,l,o)},project:r=>wm(r,n.viewport,n.snapToGrid,n.snapGrid),screenToFlowCoordinate:r=>{if(n.vueFlowRef){const{x:o,y:s}=n.vueFlowRef.getBoundingClientRect(),a={x:r.x-o,y:r.y-s};return wm(a,n.viewport,n.snapToGrid,n.snapGrid)}return{x:0,y:0}},flowToScreenCoordinate:r=>{if(n.vueFlowRef){const{x:o,y:s}=n.vueFlowRef.getBoundingClientRect(),a={x:r.x+o,y:r.y+s};return bP(a,n.viewport)}return{x:0,y:0}}}:C1t)}function bR(n,t=0,e=_1t,i=()=>{}){const r=typeof t=="number"&&t>0;return r||i(),r?n.transition().duration(t).ease(e).on("end",i):n}function x1t(n,t,e){const i=s8(!0);return i.run(()=>{const r=()=>{i.run(()=>{let p,v,m=!!(e.nodes.value.length||e.edges.value.length);p=Qc([n.modelValue,()=>{var y,b;return(b=(y=n.modelValue)==null?void 0:y.value)==null?void 0:b.length}],([y])=>{y&&Array.isArray(y)&&(v?.pause(),e.setElements(y),!v&&!m&&y.length?m=!0:v?.resume())}),v=Qc([e.nodes,e.edges,()=>e.edges.value.length,()=>e.nodes.value.length],([y,b])=>{var _;(_=n.modelValue)!=null&&_.value&&Array.isArray(n.modelValue.value)&&(p?.pause(),n.modelValue.value=[...y,...b],El(()=>{p?.resume()}))},{immediate:m}),N_(()=>{p?.stop(),v?.stop()})})},o=()=>{i.run(()=>{let p,v,m=!!e.nodes.value.length;p=Qc([n.nodes,()=>{var y,b;return(b=(y=n.nodes)==null?void 0:y.value)==null?void 0:b.length}],([y])=>{y&&Array.isArray(y)&&(v?.pause(),e.setNodes(y),!v&&!m&&y.length?m=!0:v?.resume())}),v=Qc([e.nodes,()=>e.nodes.value.length],([y])=>{var b;(b=n.nodes)!=null&&b.value&&Array.isArray(n.nodes.value)&&(p?.pause(),n.nodes.value=[...y],El(()=>{p?.resume()}))},{immediate:m}),N_(()=>{p?.stop(),v?.stop()})})},s=()=>{i.run(()=>{let p,v,m=!!e.edges.value.length;p=Qc([n.edges,()=>{var y,b;return(b=(y=n.edges)==null?void 0:y.value)==null?void 0:b.length}],([y])=>{y&&Array.isArray(y)&&(v?.pause(),e.setEdges(y),!v&&!m&&y.length?m=!0:v?.resume())}),v=Qc([e.edges,()=>e.edges.value.length],([y])=>{var b;(b=n.edges)!=null&&b.value&&Array.isArray(n.edges.value)&&(p?.pause(),n.edges.value=[...y],El(()=>{p?.resume()}))},{immediate:m}),N_(()=>{p?.stop(),v?.stop()})})},a=()=>{i.run(()=>{li(()=>t.maxZoom,()=>{t.maxZoom&&_n(t.maxZoom)&&e.setMaxZoom(t.maxZoom)},{immediate:!0})})},l=()=>{i.run(()=>{li(()=>t.minZoom,()=>{t.minZoom&&_n(t.minZoom)&&e.setMinZoom(t.minZoom)},{immediate:!0})})},h=()=>{i.run(()=>{li(()=>t.translateExtent,()=>{t.translateExtent&&_n(t.translateExtent)&&e.setTranslateExtent(t.translateExtent)},{immediate:!0})})},u=()=>{i.run(()=>{li(()=>t.nodeExtent,()=>{t.nodeExtent&&_n(t.nodeExtent)&&e.setNodeExtent(t.nodeExtent)},{immediate:!0})})},d=()=>{i.run(()=>{li(()=>t.applyDefault,()=>{_n(t.applyDefault)&&(e.applyDefault.value=t.applyDefault)},{immediate:!0})})},c=()=>{i.run(()=>{const p=async v=>{let m=v;typeof t.autoConnect=="function"&&(m=await t.autoConnect(v)),m!==!1&&e.addEdges([m])};li(()=>t.autoConnect,()=>{_n(t.autoConnect)&&(e.autoConnect.value=t.autoConnect)},{immediate:!0}),li(e.autoConnect,(v,m,y)=>{v?e.onConnect(p):e.hooks.value.connect.off(p),y(()=>{e.hooks.value.connect.off(p)})},{immediate:!0})})},f=()=>{const p=["id","modelValue","translateExtent","nodeExtent","edges","nodes","maxZoom","minZoom","applyDefault","autoConnect"];for(const v of Object.keys(t)){const m=v;if(!p.includes(m)){const y=dn(()=>t[m]),b=e[m];bE(b)&&i.run(()=>{li(y,_=>{_n(_)&&(b.value=_)},{immediate:!0})})}}};(()=>{r(),o(),s(),l(),a(),h(),u(),d(),c(),f()})()}),()=>i.stop()}function S1t(){return{edgesChange:Rt(),nodesChange:Rt(),nodeDoubleClick:Rt(),nodeClick:Rt(),nodeMouseEnter:Rt(),nodeMouseMove:Rt(),nodeMouseLeave:Rt(),nodeContextMenu:Rt(),nodeDragStart:Rt(),nodeDrag:Rt(),nodeDragStop:Rt(),nodesInitialized:Rt(),miniMapNodeClick:Rt(),miniMapNodeDoubleClick:Rt(),miniMapNodeMouseEnter:Rt(),miniMapNodeMouseMove:Rt(),miniMapNodeMouseLeave:Rt(),connect:Rt(),connectStart:Rt(),connectEnd:Rt(),clickConnectStart:Rt(),clickConnectEnd:Rt(),paneReady:Rt(),init:Rt(),move:Rt(),moveStart:Rt(),moveEnd:Rt(),selectionDragStart:Rt(),selectionDrag:Rt(),selectionDragStop:Rt(),selectionContextMenu:Rt(),selectionStart:Rt(),selectionEnd:Rt(),viewportChangeStart:Rt(),viewportChange:Rt(),viewportChangeEnd:Rt(),paneScroll:Rt(),paneClick:Rt(),paneContextMenu:Rt(),paneMouseEnter:Rt(),paneMouseMove:Rt(),paneMouseLeave:Rt(),edgeContextMenu:Rt(),edgeMouseEnter:Rt(),edgeMouseMove:Rt(),edgeMouseLeave:Rt(),edgeDoubleClick:Rt(),edgeClick:Rt(),edgeUpdateStart:Rt(),edgeUpdate:Rt(),edgeUpdateEnd:Rt(),updateNodeInternals:Rt(),error:Rt(n=>US(n.message))}}function A1t(n,t){$Q(()=>{for(const[e,i]of Object.entries(t.value)){const r=o=>{n(e,o)};i.fns.add(r),zS(()=>{i.off(r)})}})}function IY(){return{vueFlowRef:null,viewportRef:null,nodes:[],edges:[],connectionLookup:new Map,nodeTypes:{},edgeTypes:{},initialized:!1,dimensions:{width:0,height:0},viewport:{x:0,y:0,zoom:1},d3Zoom:null,d3Selection:null,d3ZoomHandler:null,minZoom:.5,maxZoom:2,translateExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],nodeExtent:[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],selectionMode:wO.Full,paneDragging:!1,preventScrolling:!0,zoomOnScroll:!0,zoomOnPinch:!0,zoomOnDoubleClick:!0,panOnScroll:!1,panOnScrollSpeed:.5,panOnScrollMode:w0.Free,paneClickDistance:0,panOnDrag:!0,edgeUpdaterRadius:10,onlyRenderVisibleElements:!1,defaultViewport:{x:0,y:0,zoom:1},nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,defaultMarkerColor:"#b1b1b7",connectionLineStyle:{},connectionLineType:null,connectionLineOptions:{type:cd.Bezier,style:{}},connectionMode:iu.Loose,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectionPosition:{x:Number.NaN,y:Number.NaN},connectionRadius:20,connectOnClick:!0,connectionStatus:null,isValidConnection:null,snapGrid:[15,15],snapToGrid:!1,edgesUpdatable:!1,edgesFocusable:!0,nodesFocusable:!0,nodesConnectable:!0,nodesDraggable:!0,nodeDragThreshold:1,elementsSelectable:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,selectionKeyCode:"Shift",multiSelectionKeyCode:Fw()?"Meta":"Control",zoomActivationKeyCode:Fw()?"Meta":"Control",deleteKeyCode:"Backspace",panActivationKeyCode:"Space",hooks:S1t(),applyDefault:!0,autoConnect:!1,fitViewOnInit:!1,fitViewOnInitDone:!1,noDragClassName:"nodrag",noWheelClassName:"nowheel",noPanClassName:"nopan",defaultEdgeOptions:void 0,elevateEdgesOnSelect:!1,elevateNodesOnSelect:!0,autoPanOnNodeDrag:!0,autoPanOnConnect:!0,autoPanSpeed:15,disableKeyboardA11y:!1,ariaLiveMessage:""}}const T1t=["id","vueFlowRef","viewportRef","initialized","modelValue","nodes","edges","maxZoom","minZoom","translateExtent","hooks","defaultEdgeOptions"];function M1t(n,t,e){const i=w1t(n),r=z=>{const V=z??[];n.hooks.updateNodeInternals.trigger(V)},o=z=>Gwt(z,n.nodes,n.edges),s=z=>Vwt(z,n.nodes,n.edges),a=z=>SY(z,n.edges),l=({id:z,type:V,nodeId:$})=>{var U;return Array.from(((U=n.connectionLookup.get(`${$}-${V}-${z??null}`))==null?void 0:U.values())??[])},h=z=>{if(z)return t.value.get(z)},u=z=>{if(z)return e.value.get(z)},d=(z,V,$)=>{var U,Q;const rt=[];for(const st of z){const at={id:st.id,type:"position",dragging:$,from:st.from};if(V&&(at.position=st.position,st.parentNode)){const ht=h(st.parentNode);at.position={x:at.position.x-(((U=ht?.computedPosition)==null?void 0:U.x)??0),y:at.position.y-(((Q=ht?.computedPosition)==null?void 0:Q.y)??0)}}rt.push(at)}rt?.length&&n.hooks.nodesChange.trigger(rt)},c=z=>{if(!n.vueFlowRef)return;const V=n.vueFlowRef.querySelector(".vue-flow__transformationpane");if(!V)return;const $=window.getComputedStyle(V),{m22:U}=new window.DOMMatrixReadOnly($.transform),Q=[];for(const rt of z){const st=rt,at=h(st.id);if(at){const ht=$S(st.nodeElement);if(!!(ht.width&&ht.height&&(at.dimensions.width!==ht.width||at.dimensions.height!==ht.height||st.forceUpdate))){const dt=st.nodeElement.getBoundingClientRect();at.dimensions=ht,at.handleBounds.source=VN("source",st.nodeElement,dt,U,at.id),at.handleBounds.target=VN("target",st.nodeElement,dt,U,at.id),Q.push({id:at.id,type:"dimensions",dimensions:ht})}}}!n.fitViewOnInitDone&&n.fitViewOnInit&&i.value.fitView().then(()=>{n.fitViewOnInitDone=!0}),Q.length&&n.hooks.nodesChange.trigger(Q)},f=(z,V)=>{const $=new Set,U=new Set;for(const st of z)Gd(st)?$.add(st.id):nu(st)&&U.add(st.id);const Q=wh(t.value,$,!0),rt=wh(e.value,U);if(n.multiSelectionActive){for(const st of $)Q.push(bh(st,V));for(const st of U)rt.push(bh(st,V))}Q.length&&n.hooks.nodesChange.trigger(Q),rt.length&&n.hooks.edgesChange.trigger(rt)},g=z=>{if(n.multiSelectionActive){const V=z.map($=>bh($.id,!0));n.hooks.nodesChange.trigger(V);return}n.hooks.nodesChange.trigger(wh(t.value,new Set(z.map(V=>V.id)),!0)),n.hooks.edgesChange.trigger(wh(e.value))},p=z=>{if(n.multiSelectionActive){const V=z.map($=>bh($.id,!0));n.hooks.edgesChange.trigger(V);return}n.hooks.edgesChange.trigger(wh(e.value,new Set(z.map(V=>V.id)))),n.hooks.nodesChange.trigger(wh(t.value,new Set,!0))},v=z=>{f(z,!0)},m=z=>{const $=(z||n.nodes).map(U=>(U.selected=!1,bh(U.id,!1)));n.hooks.nodesChange.trigger($)},y=z=>{const $=(z||n.edges).map(U=>(U.selected=!1,bh(U.id,!1)));n.hooks.edgesChange.trigger($)},b=z=>{if(!z||!z.length)return f([],!1);const V=z.reduce(($,U)=>{const Q=bh(U.id,!1);return Gd(U)?$.nodes.push(Q):$.edges.push(Q),$},{nodes:[],edges:[]});V.nodes.length&&n.hooks.nodesChange.trigger(V.nodes),V.edges.length&&n.hooks.edgesChange.trigger(V.edges)},_=z=>{var V;(V=n.d3Zoom)==null||V.scaleExtent([z,n.maxZoom]),n.minZoom=z},w=z=>{var V;(V=n.d3Zoom)==null||V.scaleExtent([n.minZoom,z]),n.maxZoom=z},C=z=>{var V;(V=n.d3Zoom)==null||V.translateExtent(z),n.translateExtent=z},x=z=>{n.nodeExtent=z,r()},S=z=>{var V;(V=n.d3Zoom)==null||V.clickDistance(z)},A=z=>{n.nodesDraggable=z,n.nodesConnectable=z,n.elementsSelectable=z},T=z=>{const V=z instanceof Function?z(n.nodes):z;!n.initialized&&!V.length||(n.nodes=GN(V,h,n.hooks.error.trigger))},M=z=>{const V=z instanceof Function?z(n.edges):z;if(!n.initialized&&!V.length)return;const $=mR(V,n.isValidConnection,h,u,n.hooks.error.trigger,n.defaultEdgeOptions,n.nodes,n.edges);vR(n.connectionLookup,e.value,$),n.edges=$},R=z=>{const V=z instanceof Function?z([...n.nodes,...n.edges]):z;!n.initialized&&!V.length||(T(V.filter(Gd)),M(V.filter(nu)))},E=z=>{let V=z instanceof Function?z(n.nodes):z;V=Array.isArray(V)?V:[V];const $=GN(V,h,n.hooks.error.trigger),U=[];for(const Q of $)U.push(DN(Q));U.length&&n.hooks.nodesChange.trigger(U)},P=z=>{let V=z instanceof Function?z(n.edges):z;V=Array.isArray(V)?V:[V];const $=mR(V,n.isValidConnection,h,u,n.hooks.error.trigger,n.defaultEdgeOptions,n.nodes,n.edges),U=[];for(const Q of $)U.push(DN(Q));U.length&&n.hooks.edgesChange.trigger(U)},B=(z,V=!0,$=!1)=>{const U=z instanceof Function?z(n.nodes):z,Q=Array.isArray(U)?U:[U],rt=[],st=[];function at(gt){const dt=a(gt);for(const vt of dt)(!_n(vt.deletable)||vt.deletable)&&st.push(HN(vt.id,vt.source,vt.target,vt.sourceHandle,vt.targetHandle))}function ht(gt){const dt=[];for(const vt of n.nodes)vt.parentNode===gt&&dt.push(vt);if(dt.length){for(const vt of dt)rt.push(IN(vt.id));V&&at(dt);for(const vt of dt)ht(vt.id)}}for(const gt of Q){const dt=typeof gt=="string"?h(gt):gt;dt&&(_n(dt.deletable)&&!dt.deletable||(rt.push(IN(dt.id)),V&&at([dt]),$&&ht(dt.id)))}st.length&&n.hooks.edgesChange.trigger(st),rt.length&&n.hooks.nodesChange.trigger(rt)},k=z=>{const V=z instanceof Function?z(n.edges):z,$=Array.isArray(V)?V:[V],U=[];for(const Q of $){const rt=typeof Q=="string"?u(Q):Q;rt&&(_n(rt.deletable)&&!rt.deletable||U.push(HN(typeof Q=="string"?Q:Q.id,rt.source,rt.target,rt.sourceHandle,rt.targetHandle)))}n.hooks.edgesChange.trigger(U)},L=(z,V,$=!0)=>{const U=u(z.id);if(!U)return!1;const Q=n.edges.indexOf(U),rt=d1t(z,V,U,$,n.hooks.error.trigger);if(rt){const[st]=mR([rt],n.isValidConnection,h,u,n.hooks.error.trigger,n.defaultEdgeOptions,n.nodes,n.edges);return n.edges=n.edges.map((at,ht)=>ht===Q?st:at),vR(n.connectionLookup,e.value,[st]),st}return!1},O=(z,V,$={replace:!1})=>{const U=u(z);if(!U)return;const Q=typeof V=="function"?V(U):V;U.data=$.replace?Q:{...U.data,...Q}},D=z=>ON(z,n.nodes),I=z=>{const V=ON(z,n.edges);return vR(n.connectionLookup,e.value,V),V},H=(z,V,$={replace:!1})=>{const U=h(z);if(!U)return;const Q=typeof V=="function"?V(U):V;$.replace?n.nodes.splice(n.nodes.indexOf(U),1,Q):Object.assign(U,Q)},F=(z,V,$={replace:!1})=>{const U=h(z);if(!U)return;const Q=typeof V=="function"?V(U):V;U.data=$.replace?Q:{...U.data,...Q}},G=(z,V,$=!1)=>{$?n.connectionClickStartHandle=z:n.connectionStartHandle=z,n.connectionEndHandle=null,n.connectionStatus=null,V&&(n.connectionPosition=V)},j=(z,V=null,$=null)=>{n.connectionStartHandle&&(n.connectionPosition=z,n.connectionEndHandle=V,n.connectionStatus=$)},W=(z,V)=>{n.connectionPosition={x:Number.NaN,y:Number.NaN},n.connectionEndHandle=null,n.connectionStatus=null,V?n.connectionClickStartHandle=null:n.connectionStartHandle=null},K=z=>{const V=Nwt(z),$=V?null:Gv(z)?z:h(z.id);return!V&&!$?[null,null,V]:[V?z:Iw($),$,V]},J=(z,V=!0,$=n.nodes)=>{const[U,Q,rt]=K(z);if(!U)return[];const st=[];for(const at of $||n.nodes){if(!rt&&(at.id===Q.id||!at.computedPosition))continue;const ht=Iw(at),gt=Hw(ht,U);(V&&gt>0||gt>=Number(U.width)*Number(U.height))&&st.push(at)}return st},q=(z,V,$=!0)=>{const[U]=K(z);if(!U)return!1;const Q=Hw(U,V);return $&&Q>0||Q>=Number(U.width)*Number(U.height)},X=z=>{const{viewport:V,dimensions:$,d3Zoom:U,d3Selection:Q,translateExtent:rt}=n;if(!U||!Q||!z.x&&!z.y)return!1;const st=Xg.translate(V.x+z.x,V.y+z.y).scale(V.zoom),at=[[0,0],[$.width,$.height]],ht=U.constrain()(st,at,rt),gt=n.viewport.x!==ht.x||n.viewport.y!==ht.y||n.viewport.zoom!==ht.k;return U.transform(Q,ht),gt},it=z=>{const V=z instanceof Function?z(n):z,$=["d3Zoom","d3Selection","d3ZoomHandler","viewportRef","vueFlowRef","dimensions","hooks"];_n(V.defaultEdgeOptions)&&(n.defaultEdgeOptions=V.defaultEdgeOptions);const U=V.modelValue||V.nodes||V.edges?[]:void 0;U&&(V.modelValue&&U.push(...V.modelValue),V.nodes&&U.push(...V.nodes),V.edges&&U.push(...V.edges),R(U));const Q=()=>{_n(V.maxZoom)&&w(V.maxZoom),_n(V.minZoom)&&_(V.minZoom),_n(V.translateExtent)&&C(V.translateExtent)};for(const rt of Object.keys(V)){const st=rt,at=V[st];![...T1t,...$].includes(st)&&_n(at)&&(n[st]=at)}lP(()=>n.d3Zoom).not.toBeNull().then(Q),n.initialized||(n.initialized=!0)};return{updateNodePositions:d,updateNodeDimensions:c,setElements:R,setNodes:T,setEdges:M,addNodes:E,addEdges:P,removeNodes:B,removeEdges:k,findNode:h,findEdge:u,updateEdge:L,updateEdgeData:O,updateNode:H,updateNodeData:F,applyEdgeChanges:I,applyNodeChanges:D,addSelectedElements:v,addSelectedNodes:g,addSelectedEdges:p,setMinZoom:_,setMaxZoom:w,setTranslateExtent:C,setNodeExtent:x,setPaneClickDistance:S,removeSelectedElements:b,removeSelectedNodes:m,removeSelectedEdges:y,startConnection:G,updateConnection:j,endConnection:W,setInteractive:A,setState:it,getIntersectingNodes:J,getIncomers:o,getOutgoers:s,getConnectedEdges:a,getHandleConnections:l,isNodeIntersecting:q,panBy:X,fitView:z=>i.value.fitView(z),zoomIn:z=>i.value.zoomIn(z),zoomOut:z=>i.value.zoomOut(z),zoomTo:(z,V)=>i.value.zoomTo(z,V),setViewport:(z,V)=>i.value.setViewport(z,V),setTransform:(z,V)=>i.value.setTransform(z,V),getViewport:()=>i.value.getViewport(),getTransform:()=>i.value.getTransform(),setCenter:(z,V,$)=>i.value.setCenter(z,V,$),fitBounds:(z,V)=>i.value.fitBounds(z,V),project:z=>i.value.project(z),screenToFlowCoordinate:z=>i.value.screenToFlowCoordinate(z),flowToScreenCoordinate:z=>i.value.flowToScreenCoordinate(z),toObject:()=>{const z=[],V=[];for(const $ of n.nodes){const{computedPosition:U,handleBounds:Q,selected:rt,dimensions:st,isParent:at,resizing:ht,dragging:gt,events:dt,...vt}=$;z.push(vt)}for(const $ of n.edges){const{selected:U,sourceNode:Q,targetNode:rt,events:st,...at}=$;V.push(at)}return JSON.parse(JSON.stringify({nodes:z,edges:V,position:[n.viewport.x,n.viewport.y],zoom:n.viewport.zoom,viewport:n.viewport}))},fromObject:z=>new Promise(V=>{const{nodes:$,edges:U,position:Q,zoom:rt,viewport:st}=z;if($&&T($),U&&M(U),st?.x&&st?.y||Q){const at=st?.x||Q[0],ht=st?.y||Q[1],gt=st?.zoom||rt||n.viewport.zoom;return lP(()=>i.value.viewportInitialized).toBe(!0).then(()=>{i.value.setViewport({x:at,y:ht,zoom:gt}).then(()=>{V(!0)})})}else V(!0)}),updateNodeInternals:r,viewportHelper:i,$reset:()=>{const z=IY();if(n.edges=[],n.nodes=[],n.d3Zoom&&n.d3Selection){const V=Xg.translate(z.defaultViewport.x??0,z.defaultViewport.y??0).scale(fc(z.defaultViewport.zoom??1,z.minZoom,z.maxZoom)),$=n.viewportRef.getBoundingClientRect(),U=[[0,0],[$.width,$.height]],Q=n.d3Zoom.constrain()(V,U,z.translateExtent);n.d3Zoom.transform(n.d3Selection,Q)}it(z)},$destroy:()=>{}}}const R1t=["data-id","data-handleid","data-nodeid","data-handlepos"],B1t={name:"Handle",compatConfig:{MODE:3}},zw=tn({...B1t,props:{id:{default:null},type:{},position:{default:()=>Ot.Top},isValidConnection:{type:Function},connectable:{type:[Boolean,Number,String,Function],default:void 0},connectableStart:{type:Boolean,default:!0},connectableEnd:{type:Boolean,default:!0}},setup(n,{expose:t}){const e=qQ(n,["position","connectable","connectableStart","connectableEnd","id"]),i=dn(()=>e.type??"source"),r=dn(()=>e.isValidConnection??null),{id:o,connectionStartHandle:s,connectionClickStartHandle:a,connectionEndHandle:l,vueFlowRef:h,nodesConnectable:u,noDragClassName:d,noPanClassName:c}=en(),{id:f,node:g,nodeEl:p,connectedEdges:v}=OY(),m=qi(),y=dn(()=>typeof n.connectableStart<"u"?n.connectableStart:!0),b=dn(()=>typeof n.connectableEnd<"u"?n.connectableEnd:!0),_=dn(()=>{var M,R,E,P,B,k;return((M=s.value)==null?void 0:M.nodeId)===f&&((R=s.value)==null?void 0:R.id)===n.id&&((E=s.value)==null?void 0:E.type)===i.value||((P=l.value)==null?void 0:P.nodeId)===f&&((B=l.value)==null?void 0:B.id)===n.id&&((k=l.value)==null?void 0:k.type)===i.value}),w=dn(()=>{var M,R,E;return((M=a.value)==null?void 0:M.nodeId)===f&&((R=a.value)==null?void 0:R.id)===n.id&&((E=a.value)==null?void 0:E.type)===i.value}),{handlePointerDown:C,handleClick:x}=LY({nodeId:f,handleId:n.id,isValidConnection:r,type:i}),S=be(()=>typeof n.connectable=="string"&&n.connectable==="single"?!v.value.some(M=>{const R=M[`${i.value}Handle`];return M[i.value]!==f?!1:R?R===n.id:!0}):typeof n.connectable=="number"?v.value.filter(M=>{const R=M[`${i.value}Handle`];return M[i.value]!==f?!1:R?R===n.id:!0}).length<n.connectable:typeof n.connectable=="function"?n.connectable(g,v.value):_n(n.connectable)?n.connectable:u.value);uu(()=>{var M;if(!g.dimensions.width||!g.dimensions.height)return;const R=(M=g.handleBounds[i.value])==null?void 0:M.find(D=>D.id===n.id);if(!h.value||R)return;const E=h.value.querySelector(".vue-flow__transformationpane");if(!p.value||!m.value||!E||!n.id)return;const P=p.value.getBoundingClientRect(),B=m.value.getBoundingClientRect(),k=window.getComputedStyle(E),{m22:L}=new window.DOMMatrixReadOnly(k.transform),O={id:n.id,position:n.position,x:(B.left-P.left)/L,y:(B.top-P.top)/L,type:i.value,nodeId:f,...$S(m.value)};g.handleBounds[i.value]=[...g.handleBounds[i.value]??[],O]});function A(M){const R=SO(M);S.value&&y.value&&(R&&M.button===0||!R)&&C(M)}function T(M){!f||!a.value&&!y.value||S.value&&x(M)}return t({handleClick:x,handlePointerDown:C,onClick:T,onPointerDown:A}),(M,R)=>(ti(),Di("div",{ref_key:"handle",ref:m,"data-id":`${Xt(o)}-${Xt(f)}-${n.id}-${i.value}`,"data-handleid":n.id,"data-nodeid":Xt(f),"data-handlepos":M.position,class:V0(["vue-flow__handle",[`vue-flow__handle-${M.position}`,`vue-flow__handle-${n.id}`,Xt(d),Xt(c),i.value,{connectable:S.value,connecting:w.value,connectablestart:y.value,connectableend:b.value,connectionindicator:S.value&&(y.value&&!_.value||b.value&&_.value)}]]),onMousedown:A,onTouchstartPassive:A,onClick:T},[Zd(M.$slots,"default",{id:M.id})],42,R1t))}}),YS=function({sourcePosition:n=Ot.Bottom,targetPosition:t=Ot.Top,label:e,connectable:i=!0,isValidTargetPos:r,isValidSourcePos:o,data:s}){const a=s.label??e;return[hi(zw,{type:"target",position:t,connectable:i,isValidConnection:r}),typeof a!="string"&&a?hi(a):hi(Fa,[a]),hi(zw,{type:"source",position:n,connectable:i,isValidConnection:o})]};YS.props=["sourcePosition","targetPosition","label","isValidTargetPos","isValidSourcePos","connectable","data"];YS.inheritAttrs=!1;YS.compatConfig={MODE:3};const P1t=YS,KS=function({targetPosition:n=Ot.Top,label:t,connectable:e=!0,isValidTargetPos:i,data:r}){const o=r.label??t;return[hi(zw,{type:"target",position:n,connectable:e,isValidConnection:i}),typeof o!="string"&&o?hi(o):hi(Fa,[o])]};KS.props=["targetPosition","label","isValidTargetPos","connectable","data"];KS.inheritAttrs=!1;KS.compatConfig={MODE:3};const k1t=KS,qS=function({sourcePosition:n=Ot.Bottom,label:t,connectable:e=!0,isValidSourcePos:i,data:r}){const o=r.label??t;return[typeof o!="string"&&o?hi(o):hi(Fa,[o]),hi(zw,{type:"source",position:n,connectable:e,isValidConnection:i})]};qS.props=["sourcePosition","label","isValidSourcePos","connectable","data"];qS.inheritAttrs=!1;qS.compatConfig={MODE:3};const E1t=qS,L1t=["transform"],O1t=["width","height","x","y","rx","ry"],D1t=["y"],I1t={name:"EdgeText",compatConfig:{MODE:3}},H1t=tn({...I1t,props:{x:{},y:{},label:{},labelStyle:{default:()=>({})},labelShowBg:{type:Boolean,default:!0},labelBgStyle:{default:()=>({})},labelBgPadding:{default:()=>[2,4]},labelBgBorderRadius:{default:2}},setup(n){const t=qi({x:0,y:0,width:0,height:0}),e=qi(null),i=be(()=>`translate(${n.x-t.value.width/2} ${n.y-t.value.height/2})`);uu(r),li([()=>n.x,()=>n.y,e,()=>n.label],r);function r(){if(!e.value)return;const o=e.value.getBBox();(o.width!==t.value.width||o.height!==t.value.height)&&(t.value=o)}return(o,s)=>(ti(),Di("g",{transform:i.value,class:"vue-flow__edge-textwrapper"},[o.labelShowBg?(ti(),Di("rect",{key:0,class:"vue-flow__edge-textbg",width:`${t.value.width+2*o.labelBgPadding[0]}px`,height:`${t.value.height+2*o.labelBgPadding[1]}px`,x:-o.labelBgPadding[0],y:-o.labelBgPadding[1],style:jh(o.labelBgStyle),rx:o.labelBgBorderRadius,ry:o.labelBgBorderRadius},null,12,O1t)):za("",!0),Jd("text",h8(o.$attrs,{ref_key:"el",ref:e,class:"vue-flow__edge-text",y:t.value.height/2,dy:"0.3em",style:o.labelStyle}),[Zd(o.$slots,"default",{},()=>[typeof o.label!="string"?(ti(),cg(JQ(o.label),{key:0})):(ti(),Di(Fa,{key:1},[QQ(R2(o.label),1)],64))])],16,D1t)],8,L1t))}}),F1t=["id","d","marker-end","marker-start"],z1t=["d","stroke-width"],N1t={name:"BaseEdge",inheritAttrs:!1,compatConfig:{MODE:3}},ZS=tn({...N1t,props:{id:{},labelX:{},labelY:{},path:{},label:{},markerStart:{},markerEnd:{},interactionWidth:{default:20},labelStyle:{},labelShowBg:{type:Boolean},labelBgStyle:{},labelBgPadding:{},labelBgBorderRadius:{}},setup(n,{expose:t}){const e=qi(null),i=qi(null),r=qi(null),o=KQ();return t({pathEl:e,interactionEl:i,labelEl:r}),(s,a)=>(ti(),Di(Fa,null,[Jd("path",h8(Xt(o),{id:s.id,ref_key:"pathEl",ref:e,d:s.path,class:"vue-flow__edge-path","marker-end":s.markerEnd,"marker-start":s.markerStart}),null,16,F1t),s.interactionWidth?(ti(),Di("path",{key:0,ref_key:"interactionEl",ref:i,fill:"none",d:s.path,"stroke-width":s.interactionWidth,"stroke-opacity":0,class:"vue-flow__edge-interaction"},null,8,z1t)):za("",!0),s.label&&s.labelX&&s.labelY?(ti(),cg(H1t,{key:1,ref_key:"labelEl",ref:r,x:s.labelX,y:s.labelY,label:s.label,"label-show-bg":s.labelShowBg,"label-bg-style":s.labelBgStyle,"label-bg-padding":s.labelBgPadding,"label-bg-border-radius":s.labelBgBorderRadius,"label-style":s.labelStyle},null,8,["x","y","label","label-show-bg","label-bg-style","label-bg-padding","label-bg-border-radius","label-style"])):za("",!0)],64))}});function HY({sourceX:n,sourceY:t,targetX:e,targetY:i}){const r=Math.abs(e-n)/2,o=e<n?e+r:e-r,s=Math.abs(i-t)/2,a=i<t?i+s:i-s;return[o,a,r,s]}function FY({sourceX:n,sourceY:t,targetX:e,targetY:i,sourceControlX:r,sourceControlY:o,targetControlX:s,targetControlY:a}){const l=n*.125+r*.375+s*.375+e*.125,h=t*.125+o*.375+a*.375+i*.125,u=Math.abs(l-n),d=Math.abs(h-t);return[l,h,u,d]}function Kb(n,t){return n>=0?.5*n:t*25*Math.sqrt(-n)}function XN({pos:n,x1:t,y1:e,x2:i,y2:r,c:o}){let s,a;switch(n){case Ot.Left:s=t-Kb(t-i,o),a=e;break;case Ot.Right:s=t+Kb(i-t,o),a=e;break;case Ot.Top:s=t,a=e-Kb(e-r,o);break;case Ot.Bottom:s=t,a=e+Kb(r-e,o);break}return[s,a]}function zY(n){const{sourceX:t,sourceY:e,sourcePosition:i=Ot.Bottom,targetX:r,targetY:o,targetPosition:s=Ot.Top,curvature:a=.25}=n,[l,h]=XN({pos:i,x1:t,y1:e,x2:r,y2:o,c:a}),[u,d]=XN({pos:s,x1:r,y1:o,x2:t,y2:e,c:a}),[c,f,g,p]=FY({sourceX:t,sourceY:e,targetX:r,targetY:o,sourceControlX:l,sourceControlY:h,targetControlX:u,targetControlY:d});return[`M${t},${e} C${l},${h} ${u},${d} ${r},${o}`,c,f,g,p]}function YN({pos:n,x1:t,y1:e,x2:i,y2:r}){let o,s;switch(n){case Ot.Left:case Ot.Right:o=.5*(t+i),s=e;break;case Ot.Top:case Ot.Bottom:o=t,s=.5*(e+r);break}return[o,s]}function NY(n){const{sourceX:t,sourceY:e,sourcePosition:i=Ot.Bottom,targetX:r,targetY:o,targetPosition:s=Ot.Top}=n,[a,l]=YN({pos:i,x1:t,y1:e,x2:r,y2:o}),[h,u]=YN({pos:s,x1:r,y1:o,x2:t,y2:e}),[d,c,f,g]=FY({sourceX:t,sourceY:e,targetX:r,targetY:o,sourceControlX:a,sourceControlY:l,targetControlX:h,targetControlY:u});return[`M${t},${e} C${a},${l} ${h},${u} ${r},${o}`,d,c,f,g]}const KN={[Ot.Left]:{x:-1,y:0},[Ot.Right]:{x:1,y:0},[Ot.Top]:{x:0,y:-1},[Ot.Bottom]:{x:0,y:1}};function W1t({source:n,sourcePosition:t=Ot.Bottom,target:e}){return t===Ot.Left||t===Ot.Right?n.x<e.x?{x:1,y:0}:{x:-1,y:0}:n.y<e.y?{x:0,y:1}:{x:0,y:-1}}function qN(n,t){return Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2)}function V1t({source:n,sourcePosition:t=Ot.Bottom,target:e,targetPosition:i=Ot.Top,center:r,offset:o}){const s=KN[t],a=KN[i],l={x:n.x+s.x*o,y:n.y+s.y*o},h={x:e.x+a.x*o,y:e.y+a.y*o},u=W1t({source:l,sourcePosition:t,target:h}),d=u.x!==0?"x":"y",c=u[d];let f,g,p;const v={x:0,y:0},m={x:0,y:0},[y,b,_,w]=HY({sourceX:n.x,sourceY:n.y,targetX:e.x,targetY:e.y});if(s[d]*a[d]===-1){g=r.x??y,p=r.y??b;const x=[{x:g,y:l.y},{x:g,y:h.y}],S=[{x:l.x,y:p},{x:h.x,y:p}];s[d]===c?f=d==="x"?x:S:f=d==="x"?S:x}else{const x=[{x:l.x,y:h.y}],S=[{x:h.x,y:l.y}];if(d==="x"?f=s.x===c?S:x:f=s.y===c?x:S,t===i){const E=Math.abs(n[d]-e[d]);if(E<=o){const P=Math.min(o-1,o-E);s[d]===c?v[d]=(l[d]>n[d]?-1:1)*P:m[d]=(h[d]>e[d]?-1:1)*P}}if(t!==i){const E=d==="x"?"y":"x",P=s[d]===a[E],B=l[E]>h[E],k=l[E]<h[E];(s[d]===1&&(!P&&B||P&&k)||s[d]!==1&&(!P&&k||P&&B))&&(f=d==="x"?x:S)}const A={x:l.x+v.x,y:l.y+v.y},T={x:h.x+m.x,y:h.y+m.y},M=Math.max(Math.abs(A.x-f[0].x),Math.abs(T.x-f[0].x)),R=Math.max(Math.abs(A.y-f[0].y),Math.abs(T.y-f[0].y));M>=R?(g=(A.x+T.x)/2,p=f[0].y):(g=f[0].x,p=(A.y+T.y)/2)}return[[n,{x:l.x+v.x,y:l.y+v.y},...f,{x:h.x+m.x,y:h.y+m.y},e],g,p,_,w]}function G1t(n,t,e,i){const r=Math.min(qN(n,t)/2,qN(t,e)/2,i),{x:o,y:s}=t;if(n.x===o&&o===e.x||n.y===s&&s===e.y)return`L${o} ${s}`;if(n.y===s){const h=n.x<e.x?-1:1,u=n.y<e.y?1:-1;return`L ${o+r*h},${s}Q ${o},${s} ${o},${s+r*u}`}const a=n.x<e.x?1:-1,l=n.y<e.y?-1:1;return`L ${o},${s+r*l}Q ${o},${s} ${o+r*a},${s}`}function wP(n){const{sourceX:t,sourceY:e,sourcePosition:i=Ot.Bottom,targetX:r,targetY:o,targetPosition:s=Ot.Top,borderRadius:a=5,centerX:l,centerY:h,offset:u=20}=n,[d,c,f,g,p]=V1t({source:{x:t,y:e},sourcePosition:i,target:{x:r,y:o},targetPosition:s,center:{x:l,y:h},offset:u});return[d.reduce((m,y,b)=>{let _;return b>0&&b<d.length-1?_=G1t(d[b-1],y,d[b+1],a):_=`${b===0?"M":"L"}${y.x} ${y.y}`,m+=_,m},""),c,f,g,p]}function $1t(n){const{sourceX:t,sourceY:e,targetX:i,targetY:r}=n,[o,s,a,l]=HY({sourceX:t,sourceY:e,targetX:i,targetY:r});return[`M ${t},${e}L ${i},${r}`,o,s,a,l]}const j1t=tn({name:"StraightEdge",props:["label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(n,{attrs:t}){return()=>{const[e,i,r]=$1t(n);return hi(ZS,{path:e,labelX:i,labelY:r,...t,...n})}}}),U1t=j1t,X1t=tn({name:"SmoothStepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","borderRadius","markerEnd","markerStart","interactionWidth","offset"],compatConfig:{MODE:3},setup(n,{attrs:t}){return()=>{const[e,i,r]=wP({...n,sourcePosition:n.sourcePosition??Ot.Bottom,targetPosition:n.targetPosition??Ot.Top});return hi(ZS,{path:e,labelX:i,labelY:r,...t,...n})}}}),WY=X1t,Y1t=tn({name:"StepEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],setup(n,{attrs:t}){return()=>hi(WY,{...n,...t,borderRadius:0})}}),K1t=Y1t,q1t=tn({name:"BezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","curvature","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(n,{attrs:t}){return()=>{const[e,i,r]=zY({...n,sourcePosition:n.sourcePosition??Ot.Bottom,targetPosition:n.targetPosition??Ot.Top});return hi(ZS,{path:e,labelX:i,labelY:r,...t,...n})}}}),Z1t=q1t,J1t=tn({name:"SimpleBezierEdge",props:["sourcePosition","targetPosition","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","sourceY","sourceX","targetX","targetY","markerEnd","markerStart","interactionWidth"],compatConfig:{MODE:3},setup(n,{attrs:t}){return()=>{const[e,i,r]=NY({...n,sourcePosition:n.sourcePosition??Ot.Bottom,targetPosition:n.targetPosition??Ot.Top});return hi(ZS,{path:e,labelX:i,labelY:r,...t,...n})}}}),Q1t=J1t,txt={input:E1t,default:P1t,output:k1t},ext={default:Z1t,straight:U1t,step:K1t,smoothstep:WY,simplebezier:Q1t};function ixt(n,t,e){const i=be(()=>p=>t.value.get(p)),r=be(()=>p=>e.value.get(p)),o=be(()=>{const p={...ext,...n.edgeTypes},v=Object.keys(p);for(const m of n.edges)m.type&&!v.includes(m.type)&&(p[m.type]=m.type);return p}),s=be(()=>{const p={...txt,...n.nodeTypes},v=Object.keys(p);for(const m of n.nodes)m.type&&!v.includes(m.type)&&(p[m.type]=m.type);return p}),a=be(()=>n.onlyRenderVisibleElements?xY(n.nodes,{x:0,y:0,width:n.dimensions.width,height:n.dimensions.height},n.viewport,!0):n.nodes),l=be(()=>{if(n.onlyRenderVisibleElements){const p=[];for(const v of n.edges){const m=t.value.get(v.source),y=t.value.get(v.target);Jwt({sourcePos:m.computedPosition||{x:0,y:0},targetPos:y.computedPosition||{x:0,y:0},sourceWidth:m.dimensions.width,sourceHeight:m.dimensions.height,targetWidth:y.dimensions.width,targetHeight:y.dimensions.height,width:n.dimensions.width,height:n.dimensions.height,viewport:n.viewport})&&p.push(v)}return p}return n.edges}),h=be(()=>[...a.value,...l.value]),u=be(()=>{const p=[];for(const v of n.nodes)v.selected&&p.push(v);return p}),d=be(()=>{const p=[];for(const v of n.edges)v.selected&&p.push(v);return p}),c=be(()=>[...u.value,...d.value]),f=be(()=>{const p=[];for(const v of n.nodes)v.dimensions.width&&v.dimensions.height&&v.handleBounds!==void 0&&p.push(v);return p}),g=be(()=>a.value.length>0&&f.value.length===a.value.length);return{getNode:i,getEdge:r,getElements:h,getEdgeTypes:o,getNodeTypes:s,getEdges:l,getNodes:a,getSelectedElements:c,getSelectedNodes:u,getSelectedEdges:d,getNodesInitialized:f,areNodesInitialized:g}}class fd{constructor(){this.currentId=0,this.flows=new Map}static getInstance(){var t;const e=(t=ty())==null?void 0:t.appContext.app,i=e?.config.globalProperties.$vueFlowStorage??fd.instance;return fd.instance=i??new fd,e&&(e.config.globalProperties.$vueFlowStorage=fd.instance),fd.instance}set(t,e){return this.flows.set(t,e)}get(t){return this.flows.get(t)}remove(t){return this.flows.delete(t)}create(t,e){const i=IY(),r=UQ(i),o={};for(const[c,f]of Object.entries(r.hooks)){const g=`on${c.charAt(0).toUpperCase()+c.slice(1)}`;o[g]=f.on}const s={};for(const[c,f]of Object.entries(r.hooks))s[c]=f.trigger;const a=be(()=>{const c=new Map;for(const f of r.nodes)c.set(f.id,f);return c}),l=be(()=>{const c=new Map;for(const f of r.edges)c.set(f.id,f);return c}),h=ixt(r,a,l),u=M1t(r,a,l);u.setState({...r,...e});const d={...o,...h,...u,...Kyt(r),nodeLookup:a,edgeLookup:l,emits:s,id:t,vueFlowVersion:"1.45.0",$destroy:()=>{this.remove(t)}};return this.set(t,d),d}getId(){return`vue-flow-${this.currentId++}`}}function en(n){const t=fd.getInstance(),e=o8(),i=typeof n=="object",r=i?n:{id:n},o=r.id,s=o??e?.vueFlowId;let a;if(e){const l=hp(UN,null);typeof l<"u"&&l!==null&&(!s||l.id===s)&&(a=l)}if(a||s&&(a=t.get(s)),!a||s&&a.id!==s){const l=o??t.getId(),h=t.create(l,r);a=h,(e??s8(!0)).run(()=>{li(h.applyDefault,(d,c,f)=>{const g=v=>{h.applyNodeChanges(v)},p=v=>{h.applyEdgeChanges(v)};d?(h.onNodesChange(g),h.onEdgesChange(p)):(h.hooks.value.nodesChange.off(g),h.hooks.value.edgesChange.off(p)),f(()=>{h.hooks.value.nodesChange.off(g),h.hooks.value.edgesChange.off(p)})},{immediate:!0}),zS(()=>{if(a){const d=t.get(a.id);d?d.$destroy():US(`No store instance found for id ${a.id} in storage.`)}})})}else i&&a.setState(r);if(e&&(fg(UN,a),e.vueFlowId=a.id),i){const l=ty();l?.type.name!=="VueFlow"&&a.emits.error(new Pn(Sn.USEVUEFLOW_OPTIONS))}return a}function nxt(n){const{emits:t,dimensions:e}=en();let i;uu(()=>{const r=n.value,o=()=>{if(!r)return;const s=$S(r);(s.width===0||s.height===0)&&t.error(new Pn(Sn.MISSING_VIEWPORT_DIMENSIONS)),e.value={width:s.width||500,height:s.height||500}};o(),window.addEventListener("resize",o),r&&(i=new ResizeObserver(()=>o()),i.observe(r)),a8(()=>{window.removeEventListener("resize",o),i&&r&&i.unobserve(r)})})}const rxt={name:"UserSelection",compatConfig:{MODE:3}},oxt=tn({...rxt,props:{userSelectionRect:{}},setup(n){return(t,e)=>(ti(),Di("div",{class:"vue-flow__selection vue-flow__container",style:jh({width:`${t.userSelectionRect.width}px`,height:`${t.userSelectionRect.height}px`,transform:`translate(${t.userSelectionRect.x}px, ${t.userSelectionRect.y}px)`})},null,4))}}),sxt=["tabIndex"],axt={name:"NodesSelection",compatConfig:{MODE:3}},lxt=tn({...axt,setup(n){const{emits:t,viewport:e,getSelectedNodes:i,noPanClassName:r,disableKeyboardA11y:o,userSelectionActive:s}=en(),a=DY(),l=qi(null),h=EY({el:l,onStart(g){t.selectionDragStart(g)},onDrag(g){t.selectionDrag(g)},onStop(g){t.selectionDragStop(g)}});uu(()=>{var g;o.value||(g=l.value)==null||g.focus({preventScroll:!0})});const u=be(()=>wY(i.value)),d=be(()=>({width:`${u.value.width}px`,height:`${u.value.height}px`,top:`${u.value.y}px`,left:`${u.value.x}px`}));function c(g){t.selectionContextMenu({event:g,nodes:i.value})}function f(g){o||Xf[g.key]&&(g.preventDefault(),a({x:Xf[g.key].x,y:Xf[g.key].y},g.shiftKey))}return(g,p)=>!Xt(s)&&u.value.width&&u.value.height?(ti(),Di("div",{key:0,class:V0(["vue-flow__nodesselection vue-flow__container",Xt(r)]),style:jh({transform:`translate(${Xt(e).x}px,${Xt(e).y}px) scale(${Xt(e).zoom})`})},[Jd("div",{ref_key:"el",ref:l,class:V0([{dragging:Xt(h)},"vue-flow__nodesselection-rect"]),style:jh(d.value),tabIndex:Xt(o)?void 0:-1,onContextmenu:c,onKeydown:f},null,46,sxt)],6)):za("",!0)}});function hxt(n,t){return{x:n.clientX-t.left,y:n.clientY-t.top}}const uxt={name:"Pane",compatConfig:{MODE:3}},dxt=tn({...uxt,props:{isSelecting:{type:Boolean},selectionKeyPressed:{type:Boolean}},setup(n){const{vueFlowRef:t,nodes:e,viewport:i,emits:r,userSelectionActive:o,removeSelectedElements:s,userSelectionRect:a,elementsSelectable:l,nodesSelectionActive:h,getSelectedEdges:u,getSelectedNodes:d,removeNodes:c,removeEdges:f,selectionMode:g,deleteKeyCode:p,multiSelectionKeyCode:v,multiSelectionActive:m,edgeLookup:y,nodeLookup:b,connectionLookup:_,defaultEdgeOptions:w,connectionStartHandle:C}=en(),x=qi(null),S=qi(new Set),A=qi(new Set),T=qi(),M=dn(()=>l.value&&(n.isSelecting||o.value)),R=dn(()=>C.value!==null);let E=!1,P=!1;const B=x0(p,{actInsideInputWithModifier:!1}),k=x0(v);li(B,j=>{j&&(c(d.value),f(u.value),h.value=!1)}),li(k,j=>{m.value=j});function L(j,W){return K=>{K.target===W&&j?.(K)}}function O(j){if(E||R.value){E=!1;return}r.paneClick(j),s(),h.value=!1}function D(j){j.preventDefault(),j.stopPropagation(),r.paneContextMenu(j)}function I(j){r.paneScroll(j)}function H(j){var W,K,J;if(T.value=(W=t.value)==null?void 0:W.getBoundingClientRect(),!l.value||!n.isSelecting||j.button!==0||j.target!==x.value||!T.value)return;(J=(K=j.target)==null?void 0:K.setPointerCapture)==null||J.call(K,j.pointerId);const{x:q,y:X}=hxt(j,T.value);P=!0,E=!1,s(),a.value={width:0,height:0,startX:q,startY:X,x:q,y:X},r.selectionStart(j)}function F(j){var W;if(!T.value||!a.value)return;E=!0;const{x:K,y:J}=Aa(j,T.value),{startX:q=0,startY:X=0}=a.value,it={startX:q,startY:X,x:K<q?K:q,y:J<X?J:X,width:Math.abs(K-q),height:Math.abs(J-X)},Z=S.value,et=A.value;S.value=new Set(xY(e.value,it,i.value,g.value===wO.Partial,!0).map(z=>z.id)),A.value=new Set;const nt=((W=w.value)==null?void 0:W.selectable)??!0;for(const z of S.value){const V=_.value.get(z);if(V)for(const{edgeId:$}of V.values()){const U=y.value.get($);U&&(U.selectable??nt)&&A.value.add($)}}if(!jN(Z,S.value)){const z=wh(b.value,S.value,!0);r.nodesChange(z)}if(!jN(et,A.value)){const z=wh(y.value,A.value);r.edgesChange(z)}a.value=it,o.value=!0,h.value=!1}function G(j){var W;j.button!==0||!P||((W=j.target)==null||W.releasePointerCapture(j.pointerId),!o.value&&a.value&&j.target===x.value&&O(j),o.value=!1,a.value=null,h.value=S.value.size>0,r.selectionEnd(j),n.selectionKeyPressed&&(E=!1),P=!1)}return(j,W)=>(ti(),Di("div",{ref_key:"container",ref:x,class:V0(["vue-flow__pane vue-flow__container",{selection:j.isSelecting}]),onClick:W[0]||(W[0]=K=>M.value?void 0:L(O,x.value)(K)),onContextmenu:W[1]||(W[1]=K=>L(D,x.value)(K)),onWheelPassive:W[2]||(W[2]=K=>L(I,x.value)(K)),onPointerenter:W[3]||(W[3]=K=>M.value?void 0:Xt(r).paneMouseEnter(K)),onPointerdown:W[4]||(W[4]=K=>M.value?H(K):Xt(r).paneMouseMove(K)),onPointermove:W[5]||(W[5]=K=>M.value?F(K):Xt(r).paneMouseMove(K)),onPointerup:W[6]||(W[6]=K=>M.value?G(K):void 0),onPointerleave:W[7]||(W[7]=K=>Xt(r).paneMouseLeave(K))},[Zd(j.$slots,"default"),Xt(o)&&Xt(a)?(ti(),cg(oxt,{key:0,"user-selection-rect":Xt(a)},null,8,["user-selection-rect"])):za("",!0),Xt(h)&&Xt(d).length?(ti(),cg(lxt,{key:1})):za("",!0)],34))}}),cxt={name:"Transform",compatConfig:{MODE:3}},fxt=tn({...cxt,setup(n){const{viewport:t,fitViewOnInit:e,fitViewOnInitDone:i}=en(),r=be(()=>e.value?!i.value:!1),o=be(()=>`translate(${t.value.x}px,${t.value.y}px) scale(${t.value.zoom})`);return(s,a)=>(ti(),Di("div",{class:"vue-flow__transformationpane vue-flow__container",style:jh({transform:o.value,opacity:r.value?0:void 0})},[Zd(s.$slots,"default")],4))}}),gxt={name:"Viewport",compatConfig:{MODE:3}},pxt=tn({...gxt,setup(n){const{minZoom:t,maxZoom:e,defaultViewport:i,translateExtent:r,zoomActivationKeyCode:o,selectionKeyCode:s,panActivationKeyCode:a,panOnScroll:l,panOnScrollMode:h,panOnScrollSpeed:u,panOnDrag:d,zoomOnDoubleClick:c,zoomOnPinch:f,zoomOnScroll:g,preventScrolling:p,noWheelClassName:v,noPanClassName:m,emits:y,connectionStartHandle:b,userSelectionActive:_,paneDragging:w,d3Zoom:C,d3Selection:x,d3ZoomHandler:S,viewport:A,viewportRef:T,paneClickDistance:M}=en();nxt(T);const R=MC(!1),E=MC(!1);let P=null,B=!1,k=0,L={x:0,y:0,zoom:0};const O=x0(a),D=x0(s),I=x0(o),H=dn(()=>(!D.value||D.value&&s.value===!0)&&(O.value||d.value)),F=dn(()=>O.value||l.value),G=dn(()=>D.value||s.value===!0&&H.value!==!0);uu(()=>{if(!T.value){US("Viewport element is missing");return}const X=T.value,it=X.getBoundingClientRect(),Z=Lwt().clickDistance(M.value).scaleExtent([t.value,e.value]).translateExtent(r.value),et=Is(X).call(Z),nt=et.on("wheel.zoom"),z=Xg.translate(i.value.x??0,i.value.y??0).scale(fc(i.value.zoom??1,t.value,e.value)),V=[[0,0],[it.width,it.height]],$=Z.constrain()(z,V,r.value);Z.transform(et,$),Z.wheelDelta(W),C.value=Z,x.value=et,S.value=nt,A.value={x:$.x,y:$.y,zoom:$.k},Z.on("start",U=>{var Q;if(!U.sourceEvent)return null;k=U.sourceEvent.button,R.value=!0;const rt=J(U.transform);((Q=U.sourceEvent)==null?void 0:Q.type)==="mousedown"&&(w.value=!0),L=rt,y.viewportChangeStart(rt),y.moveStart({event:U,flowTransform:rt})}),Z.on("end",U=>{if(!U.sourceEvent)return null;if(R.value=!1,w.value=!1,j(H.value,k??0)&&!B&&y.paneContextMenu(U.sourceEvent),B=!1,K(L,U.transform)){const Q=J(U.transform);L=Q,y.viewportChangeEnd(Q),y.moveEnd({event:U,flowTransform:Q})}}),Z.filter(U=>{var Q;const rt=I.value||g.value,st=f.value&&U.ctrlKey,at=U.button;if(at===1&&U.type==="mousedown"&&(q(U,"vue-flow__node")||q(U,"vue-flow__edge")))return!0;if(!H.value&&!rt&&!F.value&&!c.value&&!f.value||_.value||!c.value&&U.type==="dblclick"||q(U,v.value)&&U.type==="wheel"||q(U,m.value)&&(U.type!=="wheel"||F.value&&U.type==="wheel"&&!I.value)||!f.value&&U.ctrlKey&&U.type==="wheel"||!rt&&!F.value&&!st&&U.type==="wheel")return!1;if(!f&&U.type==="touchstart"&&((Q=U.touches)==null?void 0:Q.length)>1)return U.preventDefault(),!1;if(!H.value&&(U.type==="mousedown"||U.type==="touchstart")||s.value===!0&&Array.isArray(d.value)&&d.value.includes(0)&&at===0||Array.isArray(d.value)&&!d.value.includes(at)&&(U.type==="mousedown"||U.type==="touchstart"))return!1;const ht=Array.isArray(d.value)&&d.value.includes(at)||s.value===!0&&Array.isArray(d.value)&&!d.value.includes(0)||!at||at<=1;return(!U.ctrlKey||O.value||U.type==="wheel")&&ht}),li([_,H],()=>{_.value&&!R.value?Z.on("zoom",null):_.value||Z.on("zoom",U=>{A.value={x:U.transform.x,y:U.transform.y,zoom:U.transform.k};const Q=J(U.transform);B=j(H.value,k??0),y.viewportChange(Q),y.move({event:U,flowTransform:Q})})},{immediate:!0}),li([_,F,h,I,f,p,v],()=>{F.value&&!I.value&&!_.value?et.on("wheel.zoom",U=>{if(q(U,v.value))return!1;const Q=I.value||g.value,rt=f.value&&U.ctrlKey;if(!(!p.value||F.value||Q||rt))return!1;U.preventDefault(),U.stopImmediatePropagation();const at=et.property("__zoom").k||1,ht=Fw();if(!O.value&&U.ctrlKey&&f.value&&ht){const Se=_a(U),fi=W(U),me=at*2**fi;Z.scaleTo(et,me,Se,U);return}const gt=U.deltaMode===1?20:1;let dt=h.value===w0.Vertical?0:U.deltaX*gt,vt=h.value===w0.Horizontal?0:U.deltaY*gt;!ht&&U.shiftKey&&h.value!==w0.Vertical&&!dt&&vt&&(dt=vt,vt=0),Z.translateBy(et,-(dt/at)*u.value,-(vt/at)*u.value);const oe=J(et.property("__zoom"));P&&clearTimeout(P),E.value?(y.move({event:U,flowTransform:oe}),y.viewportChange(oe),P=setTimeout(()=>{y.moveEnd({event:U,flowTransform:oe}),y.viewportChangeEnd(oe),E.value=!1},150)):(E.value=!0,y.moveStart({event:U,flowTransform:oe}),y.viewportChangeStart(oe))},{passive:!1}):typeof nt<"u"&&et.on("wheel.zoom",function(U,Q){const rt=!p.value&&U.type==="wheel"&&!U.ctrlKey,st=I.value||g.value,at=f.value&&U.ctrlKey;if(!st&&!l.value&&!at&&U.type==="wheel"||rt||q(U,v.value))return null;U.preventDefault(),nt.call(this,U,Q)},{passive:!1})},{immediate:!0})});function j(X,it){return it===2&&Array.isArray(X)&&X.includes(2)}function W(X){const it=X.ctrlKey&&Fw()?10:1;return-X.deltaY*(X.deltaMode===1?.05:X.deltaMode?1:.002)*it}function K(X,it){return X.x!==it.x&&!Number.isNaN(it.x)||X.y!==it.y&&!Number.isNaN(it.y)||X.zoom!==it.k&&!Number.isNaN(it.k)}function J(X){return{x:X.x,y:X.y,zoom:X.k}}function q(X,it){return X.target.closest(`.${it}`)}return(X,it)=>(ti(),Di("div",{ref_key:"viewportRef",ref:T,class:"vue-flow__viewport vue-flow__container"},[Al(dxt,{"is-selecting":G.value,"selection-key-pressed":Xt(D),class:V0({connecting:!!Xt(b),dragging:Xt(w),draggable:Xt(d)===!0||Array.isArray(Xt(d))&&Xt(d).includes(0)})},{default:M2(()=>[Al(fxt,null,{default:M2(()=>[Zd(X.$slots,"default")]),_:3})]),_:3},8,["is-selecting","selection-key-pressed","class"])],512))}}),vxt=["id"],mxt=["id"],yxt=["id"],bxt={name:"A11yDescriptions",compatConfig:{MODE:3}},_xt=tn({...bxt,setup(n){const{id:t,disableKeyboardA11y:e,ariaLiveMessage:i}=en();return(r,o)=>(ti(),Di(Fa,null,[Jd("div",{id:`${Xt(gY)}-${Xt(t)}`,style:{display:"none"}}," Press enter or space to select a node. "+R2(Xt(e)?"":"You can then use the arrow keys to move the node around.")+" You can then use the arrow keys to move the node around, press delete to remove it and press escape to cancel. ",9,vxt),Jd("div",{id:`${Xt(pY)}-${Xt(t)}`,style:{display:"none"}}," Press enter or space to select an edge. You can then press delete to remove it or press escape to cancel. ",8,mxt),Xt(e)?za("",!0):(ti(),Di("div",{key:0,id:`${Xt(zwt)}-${Xt(t)}`,"aria-live":"assertive","aria-atomic":"true",style:{position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)","clip-path":"inset(100%)"}},R2(Xt(i)),9,yxt))],64))}});function Cxt(){const n=en();li(()=>n.viewportHelper.value.viewportInitialized,t=>{t&&setTimeout(()=>{n.emits.init(n),n.emits.paneReady(n)},1)})}function wxt(n,t,e){return e===Ot.Left?n-t:e===Ot.Right?n+t:n}function xxt(n,t,e){return e===Ot.Top?n-t:e===Ot.Bottom?n+t:n}const AO=function({radius:n=10,centerX:t=0,centerY:e=0,position:i=Ot.Top,type:r}){return hi("circle",{class:`vue-flow__edgeupdater vue-flow__edgeupdater-${r}`,cx:wxt(t,n,i),cy:xxt(e,n,i),r:n,stroke:"transparent",fill:"transparent"})};AO.props=["radius","centerX","centerY","position","type"];AO.compatConfig={MODE:3};const ZN=AO,Sxt=tn({name:"Edge",compatConfig:{MODE:3},props:["id"],setup(n){const{id:t,addSelectedEdges:e,connectionMode:i,edgeUpdaterRadius:r,emits:o,nodesSelectionActive:s,noPanClassName:a,getEdgeTypes:l,removeSelectedEdges:h,findEdge:u,findNode:d,isValidConnection:c,multiSelectionActive:f,disableKeyboardA11y:g,elementsSelectable:p,edgesUpdatable:v,edgesFocusable:m,hooks:y}=en(),b=be(()=>u(n.id)),{emit:_,on:w}=p1t(b.value,o),C=hp(XS),x=ty(),S=qi(!1),A=qi(!1),T=qi(""),M=qi(null),R=qi("source"),E=qi(null),P=dn(()=>typeof b.value.selectable>"u"?p.value:b.value.selectable),B=dn(()=>typeof b.value.updatable>"u"?v.value:b.value.updatable),k=dn(()=>typeof b.value.focusable>"u"?m.value:b.value.focusable);fg(c1t,n.id),fg(f1t,E);const L=be(()=>b.value.class instanceof Function?b.value.class(b.value):b.value.class),O=be(()=>b.value.style instanceof Function?b.value.style(b.value):b.value.style),D=be(()=>{const V=b.value.type||"default",$=C?.[`edge-${V}`];if($)return $;let U=b.value.template??l.value[V];if(typeof U=="string"&&x){const Q=Object.keys(x.appContext.components);Q&&Q.includes(V)&&(U=l8(V,!1))}return U&&typeof U!="string"?U:(o.error(new Pn(Sn.EDGE_TYPE_MISSING,U)),!1)}),{handlePointerDown:I}=LY({nodeId:T,handleId:M,type:R,isValidConnection:c,edgeUpdaterType:R,onEdgeUpdate:G,onEdgeUpdateEnd:j});return()=>{const V=d(b.value.source),$=d(b.value.target),U="pathOptions"in b.value?b.value.pathOptions:{};if(!V&&!$)return o.error(new Pn(Sn.EDGE_SOURCE_TARGET_MISSING,b.value.id,b.value.source,b.value.target)),null;if(!V)return o.error(new Pn(Sn.EDGE_SOURCE_MISSING,b.value.id,b.value.source)),null;if(!$)return o.error(new Pn(Sn.EDGE_TARGET_MISSING,b.value.id,b.value.target)),null;if(!b.value||b.value.hidden||V.hidden||$.hidden)return null;let Q;i.value===iu.Strict?Q=V.handleBounds.source:Q=[...V.handleBounds.source||[],...V.handleBounds.target||[]];const rt=zN(Q,b.value.sourceHandle);let st;i.value===iu.Strict?st=$.handleBounds.target:st=[...$.handleBounds.target||[],...$.handleBounds.source||[]];const at=zN(st,b.value.targetHandle),ht=rt?.position||Ot.Bottom,gt=at?.position||Ot.Top,{x:dt,y:vt}=Yg(V,rt,ht),{x:oe,y:Se}=Yg($,at,gt);return b.value.sourceX=dt,b.value.sourceY=vt,b.value.targetX=oe,b.value.targetY=Se,hi("g",{ref:E,key:n.id,"data-id":n.id,class:["vue-flow__edge",`vue-flow__edge-${D.value===!1?"default":b.value.type||"default"}`,a.value,L.value,{updating:S.value,selected:b.value.selected,animated:b.value.animated,inactive:!P.value&&!y.value.edgeClick.hasListeners()}],tabIndex:k.value?0:void 0,"aria-label":b.value.ariaLabel===null?void 0:b.value.ariaLabel??`Edge from ${b.value.source} to ${b.value.target}`,"aria-describedby":k.value?`${pY}-${t}`:void 0,"aria-roledescription":"edge",role:k.value?"group":"img",...b.value.domAttributes,onClick:K,onContextmenu:J,onDblclick:q,onMouseenter:X,onMousemove:it,onMouseleave:Z,onKeyDown:k.value?z:void 0},[A.value?null:hi(D.value===!1?l.value.default:D.value,{id:n.id,sourceNode:V,targetNode:$,source:b.value.source,target:b.value.target,type:b.value.type,updatable:B.value,selected:b.value.selected,animated:b.value.animated,label:b.value.label,labelStyle:b.value.labelStyle,labelShowBg:b.value.labelShowBg,labelBgStyle:b.value.labelBgStyle,labelBgPadding:b.value.labelBgPadding,labelBgBorderRadius:b.value.labelBgBorderRadius,data:b.value.data,events:{...b.value.events,...w},style:O.value,markerStart:`url('#${xm(b.value.markerStart,t)}')`,markerEnd:`url('#${xm(b.value.markerEnd,t)}')`,sourcePosition:ht,targetPosition:gt,sourceX:dt,sourceY:vt,targetX:oe,targetY:Se,sourceHandleId:b.value.sourceHandle,targetHandleId:b.value.targetHandle,interactionWidth:b.value.interactionWidth,...U}),[B.value==="source"||B.value===!0?[hi("g",{onMousedown:et,onMouseenter:H,onMouseout:F},hi(ZN,{position:ht,centerX:dt,centerY:vt,radius:r.value,type:"source","data-type":"source"}))]:null,B.value==="target"||B.value===!0?[hi("g",{onMousedown:nt,onMouseenter:H,onMouseout:F},hi(ZN,{position:gt,centerX:oe,centerY:Se,radius:r.value,type:"target","data-type":"target"}))]:null]])};function H(){S.value=!0}function F(){S.value=!1}function G(V,$){_.update({event:V,edge:b.value,connection:$})}function j(V){_.updateEnd({event:V,edge:b.value}),A.value=!1}function W(V,$){V.button===0&&(A.value=!0,T.value=$?b.value.target:b.value.source,M.value=($?b.value.targetHandle:b.value.sourceHandle)??null,R.value=$?"target":"source",_.updateStart({event:V,edge:b.value}),I(V))}function K(V){var $;const U={event:V,edge:b.value};P.value&&(s.value=!1,b.value.selected&&f.value?(h([b.value]),($=E.value)==null||$.blur()):e([b.value])),_.click(U)}function J(V){_.contextMenu({event:V,edge:b.value})}function q(V){_.doubleClick({event:V,edge:b.value})}function X(V){_.mouseEnter({event:V,edge:b.value})}function it(V){_.mouseMove({event:V,edge:b.value})}function Z(V){_.mouseLeave({event:V,edge:b.value})}function et(V){W(V,!0)}function nt(V){W(V,!1)}function z(V){var $;!g.value&&vY.includes(V.key)&&P.value&&(V.key==="Escape"?(($=E.value)==null||$.blur(),h([u(n.id)])):e([u(n.id)]))}}}),Axt=Sxt,Txt=tn({name:"ConnectionLine",compatConfig:{MODE:3},setup(){var n;const{id:t,connectionMode:e,connectionStartHandle:i,connectionEndHandle:r,connectionPosition:o,connectionLineType:s,connectionLineStyle:a,connectionLineOptions:l,connectionStatus:h,viewport:u,findNode:d}=en(),c=(n=hp(XS))==null?void 0:n["connection-line"],f=be(()=>{var y;return d((y=i.value)==null?void 0:y.nodeId)}),g=be(()=>{var y;return d((y=r.value)==null?void 0:y.nodeId)??null}),p=be(()=>({x:(o.value.x-u.value.x)/u.value.zoom,y:(o.value.y-u.value.y)/u.value.zoom})),v=be(()=>l.value.markerStart?`url(#${xm(l.value.markerStart,t)})`:""),m=be(()=>l.value.markerEnd?`url(#${xm(l.value.markerEnd,t)})`:"");return()=>{var y,b,_;if(!f.value||!i.value)return null;const w=i.value.id,C=i.value.type,x=f.value.handleBounds;let S=x?.[C]??[];if(e.value===iu.Loose){const O=x?.[C==="source"?"target":"source"]??[];S=[...S,...O]}if(!S)return null;const A=(w?S.find(O=>O.id===w):S[0])??null,T=A?.position??Ot.Top,{x:M,y:R}=Yg(f.value,A,T);let E=null;g.value&&(e.value===iu.Strict?E=((y=g.value.handleBounds[C==="source"?"target":"source"])==null?void 0:y.find(O=>{var D;return O.id===((D=r.value)==null?void 0:D.id)}))||null:E=((b=[...g.value.handleBounds.source??[],...g.value.handleBounds.target??[]])==null?void 0:b.find(O=>{var D;return O.id===((D=r.value)==null?void 0:D.id)}))||null);const P=((_=r.value)==null?void 0:_.position)??(T?_P[T]:null);if(!T||!P)return null;const B=s.value??l.value.type??cd.Bezier;let k="";const L={sourceX:M,sourceY:R,sourcePosition:T,targetX:p.value.x,targetY:p.value.y,targetPosition:P};return B===cd.Bezier?[k]=zY(L):B===cd.Step?[k]=wP({...L,borderRadius:0}):B===cd.SmoothStep?[k]=wP(L):B===cd.SimpleBezier?[k]=NY(L):k=`M${M},${R} ${p.value.x},${p.value.y}`,hi("svg",{class:"vue-flow__edges vue-flow__connectionline vue-flow__container"},hi("g",{class:"vue-flow__connection"},c?hi(c,{sourceX:M,sourceY:R,sourcePosition:T,targetX:p.value.x,targetY:p.value.y,targetPosition:P,sourceNode:f.value,sourceHandle:A,targetNode:g.value,targetHandle:E,markerEnd:m.value,markerStart:v.value,connectionStatus:h.value}):hi("path",{d:k,class:[l.value.class,h,"vue-flow__connection-path"],style:{...a.value,...l.value.style},"marker-end":m.value,"marker-start":v.value})))}}}),Mxt=Txt,Rxt=["id","markerWidth","markerHeight","markerUnits","orient"],Bxt={name:"MarkerType",compatConfig:{MODE:3}},Pxt=tn({...Bxt,props:{id:{},type:{},color:{default:"none"},width:{default:12.5},height:{default:12.5},markerUnits:{default:"strokeWidth"},orient:{default:"auto-start-reverse"},strokeWidth:{default:1}},setup(n){return(t,e)=>(ti(),Di("marker",{id:t.id,class:"vue-flow__arrowhead",viewBox:"-10 -10 20 20",refX:"0",refY:"0",markerWidth:`${t.width}`,markerHeight:`${t.height}`,markerUnits:t.markerUnits,orient:t.orient},[t.type===Xt(mP).ArrowClosed?(ti(),Di("polyline",{key:0,style:jh({stroke:t.color,fill:t.color,strokeWidth:t.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",points:"-5,-4 0,0 -5,4 -5,-4"},null,4)):za("",!0),t.type===Xt(mP).Arrow?(ti(),Di("polyline",{key:1,style:jh({stroke:t.color,strokeWidth:t.strokeWidth}),"stroke-linecap":"round","stroke-linejoin":"round",fill:"none",points:"-5,-4 0,0 -5,4"},null,4)):za("",!0)],8,Rxt))}}),kxt={class:"vue-flow__marker vue-flow__container","aria-hidden":"true"},Ext={name:"MarkerDefinitions",compatConfig:{MODE:3}},Lxt=tn({...Ext,setup(n){const{id:t,edges:e,connectionLineOptions:i,defaultMarkerColor:r}=en(),o=be(()=>{const s=new Set,a=[],l=h=>{if(h){const u=xm(h,t);s.has(u)||(typeof h=="object"?a.push({...h,id:u,color:h.color||r.value}):a.push({id:u,color:r.value,type:h}),s.add(u))}};for(const h of[i.value.markerEnd,i.value.markerStart])l(h);for(const h of e.value)for(const u of[h.markerStart,h.markerEnd])l(u);return a.sort((h,u)=>h.id.localeCompare(u.id))});return(s,a)=>(ti(),Di("svg",kxt,[Jd("defs",null,[(ti(!0),Di(Fa,null,yE(o.value,l=>(ti(),cg(Pxt,{id:l.id,key:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,"stroke-width":l.strokeWidth,orient:l.orient},null,8,["id","type","color","width","height","markerUnits","stroke-width","orient"]))),128))])]))}}),Oxt={name:"Edges",compatConfig:{MODE:3}},Dxt=tn({...Oxt,setup(n){const{findNode:t,getEdges:e,elevateEdgesOnSelect:i}=en();return(r,o)=>(ti(),Di(Fa,null,[Al(Lxt),(ti(!0),Di(Fa,null,yE(Xt(e),s=>(ti(),Di("svg",{key:s.id,class:"vue-flow__edges vue-flow__container",style:jh({zIndex:Xt(Qwt)(s,Xt(t),Xt(i))})},[Al(Xt(Axt),{id:s.id},null,8,["id"])],4))),128)),Al(Xt(Mxt))],64))}}),Ixt=tn({name:"Node",compatConfig:{MODE:3},props:["id","resizeObserver"],setup(n){const{id:t,noPanClassName:e,selectNodesOnDrag:i,nodesSelectionActive:r,multiSelectionActive:o,emits:s,removeSelectedNodes:a,addSelectedNodes:l,updateNodeDimensions:h,onUpdateNodeInternals:u,getNodeTypes:d,nodeExtent:c,elevateNodesOnSelect:f,disableKeyboardA11y:g,ariaLiveMessage:p,snapToGrid:v,snapGrid:m,nodeDragThreshold:y,nodesDraggable:b,elementsSelectable:_,nodesConnectable:w,nodesFocusable:C,hooks:x}=en(),S=qi(null);fg(kY,S),fg(PY,n.id);const A=hp(XS),T=ty(),M=DY(),{node:R,parentNode:E}=OY(n.id),{emit:P,on:B}=b1t(R,s),k=dn(()=>typeof R.draggable>"u"?b.value:R.draggable),L=dn(()=>typeof R.selectable>"u"?_.value:R.selectable),O=dn(()=>typeof R.connectable>"u"?w.value:R.connectable),D=dn(()=>typeof R.focusable>"u"?C.value:R.focusable),I=be(()=>L.value||k.value||x.value.nodeClick.hasListeners()||x.value.nodeDoubleClick.hasListeners()||x.value.nodeMouseEnter.hasListeners()||x.value.nodeMouseMove.hasListeners()||x.value.nodeMouseLeave.hasListeners()),H=dn(()=>!!R.dimensions.width&&!!R.dimensions.height),F=be(()=>{const $=R.type||"default",U=A?.[`node-${$}`];if(U)return U;let Q=R.template||d.value[$];if(typeof Q=="string"&&T){const rt=Object.keys(T.appContext.components);rt&&rt.includes($)&&(Q=l8($,!1))}return Q&&typeof Q!="string"?Q:(s.error(new Pn(Sn.NODE_TYPE_MISSING,Q)),!1)}),G=EY({id:n.id,el:S,disabled:()=>!k.value,selectable:L,dragHandle:()=>R.dragHandle,onStart($){P.dragStart($)},onDrag($){P.drag($)},onStop($){P.dragStop($)},onClick($){z($)}}),j=be(()=>R.class instanceof Function?R.class(R):R.class),W=be(()=>{const $=(R.style instanceof Function?R.style(R):R.style)||{},U=R.width instanceof Function?R.width(R):R.width,Q=R.height instanceof Function?R.height(R):R.height;return!$.width&&U&&($.width=typeof U=="string"?U:`${U}px`),!$.height&&Q&&($.height=typeof Q=="string"?Q:`${Q}px`),$}),K=dn(()=>Number(R.zIndex??W.value.zIndex??0));return u($=>{($.includes(n.id)||!$.length)&&q()}),uu(()=>{li(()=>R.hidden,($=!1,U,Q)=>{!$&&S.value&&(n.resizeObserver.observe(S.value),Q(()=>{S.value&&n.resizeObserver.unobserve(S.value)}))},{immediate:!0,flush:"post"})}),li([()=>R.type,()=>R.sourcePosition,()=>R.targetPosition],()=>{El(()=>{h([{id:n.id,nodeElement:S.value,forceUpdate:!0}])})}),li([()=>R.position.x,()=>R.position.y,()=>{var $;return($=E.value)==null?void 0:$.computedPosition.x},()=>{var $;return($=E.value)==null?void 0:$.computedPosition.y},()=>{var $;return($=E.value)==null?void 0:$.computedPosition.z},K,()=>R.selected,()=>R.dimensions.height,()=>R.dimensions.width,()=>{var $;return($=E.value)==null?void 0:$.dimensions.height},()=>{var $;return($=E.value)==null?void 0:$.dimensions.width}],([$,U,Q,rt,st,at])=>{const ht={x:$,y:U,z:at+(f.value&&R.selected?1e3:0)};typeof Q<"u"&&typeof rt<"u"?R.computedPosition=Xwt({x:Q,y:rt,z:st},ht):R.computedPosition=ht},{flush:"post",immediate:!0}),li([()=>R.extent,c],([$,U],[Q,rt])=>{($!==Q||U!==rt)&&J()}),R.extent==="parent"||typeof R.extent=="object"&&"range"in R.extent&&R.extent.range==="parent"?lP(()=>H).toBe(!0).then(J):J(),()=>R.hidden?null:hi("div",{ref:S,"data-id":R.id,class:["vue-flow__node",`vue-flow__node-${F.value===!1?"default":R.type||"default"}`,{[e.value]:k.value,dragging:G?.value,draggable:k.value,selected:R.selected,selectable:L.value,parent:R.isParent},j.value],style:{visibility:H.value?"visible":"hidden",zIndex:R.computedPosition.z??K.value,transform:`translate(${R.computedPosition.x}px,${R.computedPosition.y}px)`,pointerEvents:I.value?"all":"none",...W.value},tabIndex:D.value?0:void 0,role:D.value?"group":void 0,"aria-describedby":g.value?void 0:`${gY}-${t}`,"aria-label":R.ariaLabel,"aria-roledescription":"node",...R.domAttributes,onMouseenter:X,onMousemove:it,onMouseleave:Z,onContextmenu:et,onClick:z,onDblclick:nt,onKeydown:V},[hi(F.value===!1?d.value.default:F.value,{id:R.id,type:R.type,data:R.data,events:{...R.events,...B},selected:R.selected,resizing:R.resizing,dragging:G.value,connectable:O.value,position:R.computedPosition,dimensions:R.dimensions,isValidTargetPos:R.isValidTargetPos,isValidSourcePos:R.isValidSourcePos,parent:R.parentNode,parentNodeId:R.parentNode,zIndex:R.computedPosition.z??K.value,targetPosition:R.targetPosition,sourcePosition:R.sourcePosition,label:R.label,dragHandle:R.dragHandle,onUpdateNodeInternals:q})]);function J(){const $=R.computedPosition,{computedPosition:U,position:Q}=xO(R,v.value?jS($,m.value):$,s.error,c.value,E.value);(R.computedPosition.x!==U.x||R.computedPosition.y!==U.y)&&(R.computedPosition={...R.computedPosition,...U}),(R.position.x!==Q.x||R.position.y!==Q.y)&&(R.position=Q)}function q(){S.value&&h([{id:n.id,nodeElement:S.value,forceUpdate:!0}])}function X($){G?.value||P.mouseEnter({event:$,node:R})}function it($){G?.value||P.mouseMove({event:$,node:R})}function Z($){G?.value||P.mouseLeave({event:$,node:R})}function et($){return P.contextMenu({event:$,node:R})}function nt($){return P.doubleClick({event:$,node:R})}function z($){L.value&&(!i.value||!k.value||y.value>0)&&CP(R,o.value,l,a,r,!1,S.value),P.click({event:$,node:R})}function V($){if(!(yP($)||g.value))if(vY.includes($.key)&&L.value){const U=$.key==="Escape";CP(R,o.value,l,a,r,U,S.value)}else k.value&&R.selected&&Xf[$.key]&&($.preventDefault(),p.value=`Moved selected node ${$.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~R.position.x}, y: ${~~R.position.y}`,M({x:Xf[$.key].x,y:Xf[$.key].y},$.shiftKey))}}}),Hxt=Ixt;function Fxt(n={includeHiddenNodes:!1}){const{nodes:t}=en();return be(()=>{if(t.value.length===0)return!1;for(const e of t.value)if((n.includeHiddenNodes||!e.hidden)&&(e?.handleBounds===void 0||e.dimensions.width===0||e.dimensions.height===0))return!1;return!0})}const zxt={class:"vue-flow__nodes vue-flow__container"},Nxt={name:"Nodes",compatConfig:{MODE:3}},Wxt=tn({...Nxt,setup(n){const{getNodes:t,updateNodeDimensions:e,emits:i}=en(),r=Fxt(),o=qi();return li(r,s=>{s&&El(()=>{i.nodesInitialized(t.value)})},{immediate:!0}),uu(()=>{o.value=new ResizeObserver(s=>{const a=s.map(l=>({id:l.target.getAttribute("data-id"),nodeElement:l.target,forceUpdate:!0}));El(()=>e(a))})}),a8(()=>{var s;return(s=o.value)==null?void 0:s.disconnect()}),(s,a)=>(ti(),Di("div",zxt,[o.value?(ti(!0),Di(Fa,{key:0},yE(Xt(t),(l,h,u,d)=>{const c=[l.id];if(d&&d.key===l.id&&jQ(d,c))return d;const f=(ti(),cg(Xt(Hxt),{id:l.id,key:l.id,"resize-observer":o.value},null,8,["id","resize-observer"]));return f.memo=c,f},a,0),128)):za("",!0)]))}});function Vxt(){const{emits:n}=en();uu(()=>{if(BY()){const t=document.querySelector(".vue-flow__pane");t&&window.getComputedStyle(t).zIndex!=="1"&&n.error(new Pn(Sn.MISSING_STYLES))}})}const Gxt=Jd("div",{class:"vue-flow__edge-labels"},null,-1),$xt={name:"VueFlow",compatConfig:{MODE:3}},E7t=tn({...$xt,props:{id:{},modelValue:{},nodes:{},edges:{},edgeTypes:{},nodeTypes:{},connectionMode:{},connectionLineType:{},connectionLineStyle:{default:void 0},connectionLineOptions:{default:void 0},connectionRadius:{},isValidConnection:{type:[Function,null],default:void 0},deleteKeyCode:{default:void 0},selectionKeyCode:{type:[Boolean,null],default:void 0},multiSelectionKeyCode:{default:void 0},zoomActivationKeyCode:{default:void 0},panActivationKeyCode:{default:void 0},snapToGrid:{type:Boolean,default:void 0},snapGrid:{},onlyRenderVisibleElements:{type:Boolean,default:void 0},edgesUpdatable:{type:[Boolean,String],default:void 0},nodesDraggable:{type:Boolean,default:void 0},nodesConnectable:{type:Boolean,default:void 0},nodeDragThreshold:{},elementsSelectable:{type:Boolean,default:void 0},selectNodesOnDrag:{type:Boolean,default:void 0},panOnDrag:{type:[Boolean,Array],default:void 0},minZoom:{},maxZoom:{},defaultViewport:{},translateExtent:{},nodeExtent:{},defaultMarkerColor:{},zoomOnScroll:{type:Boolean,default:void 0},zoomOnPinch:{type:Boolean,default:void 0},panOnScroll:{type:Boolean,default:void 0},panOnScrollSpeed:{},panOnScrollMode:{},paneClickDistance:{},zoomOnDoubleClick:{type:Boolean,default:void 0},preventScrolling:{type:Boolean,default:void 0},selectionMode:{},edgeUpdaterRadius:{},fitViewOnInit:{type:Boolean,default:void 0},connectOnClick:{type:Boolean,default:void 0},applyDefault:{type:Boolean,default:void 0},autoConnect:{type:[Boolean,Function],default:void 0},noDragClassName:{},noWheelClassName:{},noPanClassName:{},defaultEdgeOptions:{},elevateEdgesOnSelect:{type:Boolean,default:void 0},elevateNodesOnSelect:{type:Boolean,default:void 0},disableKeyboardA11y:{type:Boolean,default:void 0},edgesFocusable:{type:Boolean,default:void 0},nodesFocusable:{type:Boolean,default:void 0},autoPanOnConnect:{type:Boolean,default:void 0},autoPanOnNodeDrag:{type:Boolean,default:void 0},autoPanSpeed:{}},emits:["nodesChange","edgesChange","nodesInitialized","paneReady","init","updateNodeInternals","error","connect","connectStart","connectEnd","clickConnectStart","clickConnectEnd","moveStart","move","moveEnd","selectionDragStart","selectionDrag","selectionDragStop","selectionContextMenu","selectionStart","selectionEnd","viewportChangeStart","viewportChange","viewportChangeEnd","paneScroll","paneClick","paneContextMenu","paneMouseEnter","paneMouseMove","paneMouseLeave","edgeUpdate","edgeContextMenu","edgeMouseEnter","edgeMouseMove","edgeMouseLeave","edgeDoubleClick","edgeClick","edgeUpdateStart","edgeUpdateEnd","nodeContextMenu","nodeMouseEnter","nodeMouseMove","nodeMouseLeave","nodeDoubleClick","nodeClick","nodeDragStart","nodeDrag","nodeDragStop","miniMapNodeClick","miniMapNodeDoubleClick","miniMapNodeMouseEnter","miniMapNodeMouseMove","miniMapNodeMouseLeave","update:modelValue","update:nodes","update:edges"],setup(n,{expose:t,emit:e}){const i=n,r=VQ(),o=lR(i,"modelValue",e),s=lR(i,"nodes",e),a=lR(i,"edges",e),l=en(i),h=x1t({modelValue:o,nodes:s,edges:a},i,l);return A1t(e,l.hooks),Cxt(),Vxt(),fg(XS,r),GQ(()=>{h()}),t(l),(u,d)=>(ti(),Di("div",{ref:Xt(l).vueFlowRef,class:"vue-flow"},[Al(pxt,null,{default:M2(()=>[Al(Dxt),Gxt,Al(Wxt),Zd(u.$slots,"zoom-pane")]),_:3}),Zd(u.$slots,"default"),Al(_xt)],512))}});var Ve;(function(n){n.default="default",n.grabing="grabing",n.scrolling="scrolling"})(Ve||(Ve={}));var Gr;(function(n){n.FinishToStart="finish_to_start",n.StartToStart="start_to_start",n.FinishToFinish="finish_to_finish",n.StartToFinish="start_to_finish"})(Gr||(Gr={}));var mt;(function(n){n.Tasks_Separate="tasks_separate",n.Sub_Tasks_Inline="sub_tasks_inline",n.Sub_Tasks_Separate="sub_tasks_separate",n.Sub_Tasks_Arrange="sub_tasks_arrange",n.Sub_Tasks_Compact="sub_tasks_compact",n.Project_Sub_Tasks_Inline="project_sub_tasks_inline"})(mt||(mt={}));var Me;(function(n){n.TASK="task",n.PROJECT="project",n.MILESTONE="milestone"})(Me||(Me={}));const de={SCROLL:"scroll",CHANGE_DATE_RANGE:"change_date_range",CLICK_TASK_BAR:"click_task_bar",CONTEXTMENU_TASK_BAR:"contextmenu_task_bar",MOUSEENTER_TASK_BAR:"mouseenter_task_bar",MOUSELEAVE_TASK_BAR:"mouseleave_task_bar",CREATE_TASK_SCHEDULE:"create_task_schedule",CREATE_DEPENDENCY_LINK:"create_dependency_link",DELETE_DEPENDENCY_LINK:"delete_dependency_link",CLICK_DEPENDENCY_LINK_POINT:"click_dependency_link_point",CONTEXTMENU_DEPENDENCY_LINK:"contextmenu_dependency_link",CLICK_MARKLINE_CREATE:"click_markline_create",CLICK_MARKLINE_CONTENT:"click_markline_content",MOVE_END_TASK_BAR:"move_end_task_bar",PROGRESS_UPDATE:"progress_update"};class nn{static GenAutoIncrementId(){return nn.auto_increment_id++}}nn.auto_increment_id=0;class Ut{constructor(t){this.id=nn.GenAutoIncrementId(),this.registry=t}}const JS="named",VY="inject",GY="multi_inject",$Y="inversify:tagged",jY="inversify:paramtypes";class TO{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===JS?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}const Yf=function(n){var t;return function(e){const i=typeof Symbol=="function",r=i&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",o=Object.getPrototypeOf(Function),s=Map,a=new WeakMap;function l(B,k,L,O){if(!C(L))throw new TypeError;return m(B,k,L,O)}function h(B,k,L){if(!C(k))throw new TypeError;return b(L)||(L=M(L)),f(B,k,L)}function u(B,k,L){if(!C(k))throw new TypeError;return b(L)||(L=M(L)),g(B,k,L)}function d(B,k,L){if(!C(k))throw new TypeError;return b(L)||(L=M(L)),p(B,k,L)}function c(B,k,L){let O=a.get(B);if(b(O)){if(!L)return;O=new s,a.set(B,O)}let D=O.get(k);if(b(D)){if(!L)return;D=new s,O.set(k,D)}return D}function f(B,k,L){if(g(B,k,L))return!0;const O=P(k);return!_(O)&&f(B,O,L)}function g(B,k,L){const O=c(k,L,!1);return!b(O)&&A(O.has(B))}function p(B,k,L){if(g(B,k,L))return v(B,k,L);const O=P(k);return _(O)?void 0:p(B,O,L)}function v(B,k,L){const O=c(k,L,!1);if(!b(O))return O.get(B)}function m(B,k,L,O){c(L,O,!0).set(B,k)}function y(B){if(B===null)return 1;switch(typeof B){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return B===null?1:6;default:return 6}}function b(B){return B===void 0}function _(B){return B===null}function w(B){return typeof B=="symbol"}function C(B){return typeof B=="object"?B!==null:typeof B=="function"}function x(B,k){switch(y(B)){case 0:case 1:case 2:case 3:case 4:case 5:return B}const L="string",O=E(B,r);if(O!==void 0){const D=O.call(B,L);if(C(D))throw new TypeError;return D}return S(B)}function S(B,k){{const L=B.toString;if(R(L)){const D=L.call(B);if(!C(D))return D}const O=B.valueOf;if(R(O)){const D=O.call(B);if(!C(D))return D}}throw new TypeError}function A(B){return!!B}function T(B){return""+B}function M(B){const k=x(B);return w(k)?k:T(k)}function R(B){return typeof B=="function"}function E(B,k){const L=B[k];if(L!=null){if(!R(L))throw new TypeError;return L}}function P(B){const k=Object.getPrototypeOf(B);if(typeof B!="function"||B===o||k!==o)return k;const L=B.prototype,O=L&&Object.getPrototypeOf(L);if(O==null||O===Object.prototype)return k;const D=O.constructor;return typeof D!="function"||D===B?k:D}e("defineMetadata",l),e("hasMetadata",h),e("hasOwnMetadata",u),e("getMetadata",d)}((t=n,function(e,i){typeof t[e]!="function"&&Object.defineProperty(t,e,{configurable:!0,writable:!0,value:i})})),n}({});function jxt(n,t,e,i){const r=[i];let o={};Yf.hasOwnMetadata(n,t)&&(o=Yf.getMetadata(n,t));let s=o[e];s===void 0&&(s=[]),s.push(...r),o[e]=s,Yf.defineMetadata(n,o,t)}function Uxt(n,t,e,i){jxt($Y,n,e.toString(),i)}function UY(n){return(t,e,i)=>{Uxt(t,e,i,n)}}function XY(n){return t=>(e,i,r)=>UY(new TO(n,t))(e,i,r)}const le=XY(VY),YY=XY(GY);function yt(){return function(n){return Yf.defineMetadata(jY,null,n),n}}function mn(n){return UY(new TO(JS,n))}const gc={Singleton:"Singleton",Transient:"Transient"},Dh={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class MO{constructor(t,e){this.id=nn.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=Dh.Invalid,this.constraint=i=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){const t=new MO(this.serviceIdentifier,this.scope);return t.activated=t.scope===gc.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}class Xxt{getConstructorMetadata(t){return{compilerGeneratedMetadata:Yf.getMetadata(jY,t),userGeneratedMetadata:Yf.getMetadata($Y,t)||{}}}getPropertiesMetadata(t){throw new Error("")}}const Yxt=n=>t=>{const e=i=>{if(i==null)return!1;if(i.key===n&&i.value===t)return!0;if(i.constructorArgsMetadata==null)return!1;const r=i.constructorArgsMetadata;for(let o=0;o<r.length;o++)if(r[o].key===n&&r[o].value===t)return!0;return!1};return e.metaData=new TO(n,t),e},Kxt=Yxt(JS);class qb{constructor(t){this._binding=t}inRequestScope(){throw new Error("")}inSingletonScope(){return this._binding.scope=gc.Singleton,this}inTransientScope(){return this._binding.scope=gc.Transient,this}whenTargetNamed(t){return this._binding.constraint=Kxt(t),this}}class qxt{constructor(t){this._binding=t}to(t){return this._binding.type=Dh.Instance,this._binding.implementationType=t,new qb(this._binding)}toSelf(){const t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=Dh.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new qb(this._binding)}toConstantValue(t){return this._binding.type=Dh.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=gc.Singleton,new qb(this._binding)}toFactory(t){return this._binding.type=Dh.Factory,this._binding.factory=t,this._binding.scope=gc.Singleton,new qb(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let Zxt=class{constructor(t){const e=t||{};e.defaultScope=e.defaultScope||gc.Transient,this.options=e,this.id=nn.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new Xxt}load(t){const e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){const e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){const e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,i){const r=this._getNotAllArgs(t,!1,e,i);return this._get(r)}getNamed(t,e){return this.getTagged(t,JS,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){const e=this.options.defaultScope,i=new MO(t,e),r=this._bindingDictionary.get(t)||[];return r.push(i),this._bindingDictionary.set(t,r),new qxt(i)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){const t=(s,a)=>{s._binding.moduleId=a},e=s=>a=>{const l=this.bind(a);return t(l,s),l},i=()=>s=>this.unbind(s),r=()=>s=>this.isBound(s),o=s=>a=>{const l=this.rebind(a);return t(l,s),l};return s=>({bindFunction:e(s),isboundFunction:r(),rebindFunction:o(s),unbindFunction:i(),unbindAsyncFunction:a=>null})}_getNotAllArgs(t,e,i,r){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:i,value:r}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){const e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(i=>i.constraint(t)).forEach(i=>{e.push(this._resolveFromBinding(i))}),t.isMultiInject||e.length!==1?e:e[0]}_getChildRequest(t){const e=t.implementationType,{userGeneratedMetadata:i}=this._metadataReader.getConstructorMetadata(e),r=Object.keys(i),o=[];for(let s=0;s<r.length;s++){const a=i[s],l={};a.forEach(f=>{l[f.key]=f.value});const h={inject:l[VY],multiInject:l[GY]},u=h.inject||h.multiInject,d={serviceIdentifier:u,constructorArgsMetadata:a},c=(this._bindingDictionary.get(u)||[]).filter(f=>f.constraint(d));if(c.length){const f={injectIdentifier:u,metadata:a,bindings:c};o.push(f)}}return o}_resolveFromBinding(t){const e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case Dh.ConstantValue:case Dh.Function:e=t.cache;break;case Dh.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;const i=this._getChildRequest(t);return this._createInstance(e,i)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(e=>e.bindings.length>1?e.bindings.map(i=>this._resolveFromBinding(i)):this._resolveFromBinding(e.bindings[0]))}_saveToScope(t,e){t.scope===gc.Singleton&&(t.cache=e,t.activated=!0)}};const Wi=Symbol("ContributionProvider");class KY{constructor(t,e){this.serviceIdentifier=t,this.container=e,qY.setStore(this.serviceIdentifier,this)}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}refresh(){this.caches&&(this.caches.length=0,this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier)))}}function tr(n,t){n(Wi).toDynamicValue(({container:e})=>new KY(t,e)).inSingletonScope().whenTargetNamed(t)}function Jxt(n,t){n(Wi).toDynamicValue(({container:e})=>new KY(t,e)).whenTargetNamed(t)}class qY{static getStore(t){return this.store.get(t)}static setStore(t,e){this.store.set(t,e)}static refreshAllContributions(){this.store.forEach(t=>{t.refresh()})}}qY.store=new Map;class Qxt{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){const i=typeof t=="string"?t.trim():t.name;i&&(this.taps=this.taps.filter(r=>!(r.name===i&&(!e||r.fn===e))))}_parseOptions(t,e,i){let r;if(typeof e=="string")r={name:e.trim()};else if(typeof e!="object"||e===null)throw new Error("Invalid tap options");if(typeof r.name!="string"||r.name==="")throw new Error("Missing name for tap");return r=Object.assign({type:t,fn:i},r),r}_tap(t,e,i){this._insert(this._parseOptions(t,e,i))}_insert(t){let e;typeof t.before=="string"?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let i=0;typeof t.stage=="number"&&(i=t.stage);let r=this.taps.length;for(;r>0;){r--;const o=this.taps[r];this.taps[r+1]=o;const s=o.stage||0;if(e){if(e.has(o.name)){e.delete(o.name);continue}if(e.size>0)continue}if(!(s>i)){r++;break}}this.taps[r]=t}}class cr extends Qxt{call(...t){this.taps.map(e=>e.fn).forEach(e=>e(...t))}}const QS=Symbol.for("EnvContribution"),RO=Symbol.for("VGlobal"),Nt=new Zxt,BO=Symbol.for("RenderService");class tSt{get renderService(){return this._renderService||(this._renderService=Nt.get(BO)),this._renderService}}const bt=new tSt;let JN=0;class ZY{constructor(){this.nextAnimationFrameCbs=new Map,this._rafHandle=null,this.runAnimationFrame=t=>{this._rafHandle=null;const e=this.nextAnimationFrameCbs;this.nextAnimationFrameCbs=new Map,e.forEach(i=>i(t))},this.tryRunAnimationFrameNextFrame=()=>{this._rafHandle===null&&this.nextAnimationFrameCbs.size!==0&&(this._rafHandle=bt.global.getRequestAnimationFrame()(this.runAnimationFrame))}}addAnimationFrameCb(t){return this.nextAnimationFrameCbs.set(++JN,t),this.tryRunAnimationFrameNextFrame(),JN}removeAnimationFrameCb(t){return!!this.nextAnimationFrameCbs.has(t)&&(this.nextAnimationFrameCbs.delete(t),!0)}}class JY{constructor(){this._listenerMap=new Map,this._eventListenerTransformer=t=>t}setEventListenerTransformer(t){this._eventListenerTransformer=t||(e=>e)}addEventListener(t,e,i){if(!e)return;const r=o=>{const s=this._eventListenerTransformer(o);typeof e=="function"?e(s):e.handleEvent&&e.handleEvent(s)};this._listenerMap.has(t)||this._listenerMap.set(t,new Map),this._listenerMap.get(t).set(e,r),this._nativeAddEventListener(t,r,i)}removeEventListener(t,e,i){var r;if(!e)return;const o=(r=this._listenerMap.get(t))===null||r===void 0?void 0:r.get(e);o&&(this._nativeRemoveEventListener(t,o,i),this._listenerMap.get(t).delete(e),this._listenerMap.get(t).size===0&&this._listenerMap.delete(t))}dispatchEvent(t){return this._nativeDispatchEvent(t)}clearAllEventListeners(){this._listenerMap.forEach((t,e)=>{t.forEach((i,r)=>{this._nativeRemoveEventListener(e,i,void 0)})}),this._listenerMap.clear()}_nativeAddEventListener(t,e,i){throw new Error("_nativeAddEventListener must be implemented by derived classes")}_nativeRemoveEventListener(t,e,i){throw new Error("_nativeRemoveEventListener must be implemented by derived classes")}_nativeDispatchEvent(t){throw new Error("_nativeDispatchEvent must be implemented by derived classes")}}var eSt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},iSt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},QN=function(n,t){return function(e,i){t(e,i,n)}},nSt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};let xP=class extends JY{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(n){this._isImageAnonymous=n}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(n){this._env||this.setEnv("browser"),this.envContribution.supportEvent=n}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(n){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=n}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(n){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=n}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(n){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=n}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(n){this._env||this.setEnv("browser"),this.envContribution.applyStyles=n}constructor(n){super(),this.contributions=n,this._isImageAnonymous=!0,this._performanceRAFList=[],this.eventListenerTransformer=t=>t,this.id=nn.GenAutoIncrementId(),this.hooks={onSetEnv:new cr(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}_nativeAddEventListener(n,t,e){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(n,t,e)}_nativeRemoveEventListener(n,t,e){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(n,t,e)}_nativeDispatchEvent(n){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(n)}bindContribution(n){const t=[];if(this.contributions.getContributions().forEach(e=>{const i=e.configure(this,n);i&&i.then&&t.push(i)}),t.length)return Promise.all(t)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(n,t){if(t&&t.force===!0||this._env!==n)return this.deactiveCurrentEnv(),this.activeEnv(n,t)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(n,t){const e=this._env;this._env=n;const i=this.bindContribution(t);if(i&&i.then)return i.then(()=>{this.envParams=t,this.hooks.onSetEnv.call(e,n,this)});this.envParams=t,this.hooks.onSetEnv.call(e,n,this)}setActiveEnvContribution(n){this.envContribution=n}createCanvas(n){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(n)}createOffscreenCanvas(n){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(n)}releaseCanvas(n){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(n)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getSpecifiedRequestAnimationFrame(n){this._env||this.setEnv("browser"),this._performanceRAFList[n]||(this._performanceRAFList[n]=new ZY);const t=this._performanceRAFList[n];return e=>t.addAnimationFrameCb(e)}getSpecifiedCancelAnimationFrame(n){if(this._env||this.setEnv("browser"),!this._performanceRAFList[n])return()=>!1;const t=this._performanceRAFList[n];return e=>t.removeAnimationFrameCb(e)}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(n){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(n):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(n,t){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(n,t):null}loadImage(n){return this._env||this.setEnv("browser"),this.envContribution.loadImage(n)}loadSvg(n){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(n)}loadJson(n){return this._env||this.setEnv("browser"),this.envContribution.loadJson(n)}loadArrayBuffer(n){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(n)}loadBlob(n){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(n)}loadFont(n,t,e){return nSt(this,void 0,void 0,function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(n,t,e)})}isChrome(){return this._isChrome!=null||(this._env||this.setEnv("browser"),this._isChrome=this._env==="browser"&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return this._isSafari!=null||(this._env||this.setEnv("browser"),this._isSafari=this._env==="browser"&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(n){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(n)}removeDom(n){return this._env||this.setEnv("browser"),this.envContribution.removeDom(n)}createDom(n){return this._env||this.setEnv("browser"),this.envContribution.createDom(n)}updateDom(n,t){return this._env||this.setEnv("browser"),this.envContribution.updateDom(n,t)}getElementTop(n,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(n,t)}getElementLeft(n,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(n,t)}getElementTopLeft(n,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(n,t)}isMacOS(){return this._env||this.setEnv("browser"),this.envContribution.isMacOS()}copyToClipBoard(n){return this._env||this.setEnv("browser"),this.envContribution.copyToClipBoard(n)}};xP=eSt([yt(),QN(0,le(Wi)),QN(0,mn(QS)),iSt("design:paramtypes",[Object])],xP);var $d;(function(n){n[n.estimate=0]="estimate",n[n.actualBounding=1]="actualBounding",n[n.fontBounding=2]="fontBounding"})($d||($d={}));var Dr;(function(n){n[n.INITIAL=0]="INITIAL",n[n.RUNNING=1]="RUNNING",n[n.PAUSE=2]="PAUSE"})(Dr||(Dr={}));var S0;(function(n){n.wait="wait",n.from="from",n.to="to",n.customAnimate="customAnimate"})(S0||(S0={}));var dr;(function(n){n[n.INITIAL=0]="INITIAL",n[n.RUNNING=1]="RUNNING",n[n.PAUSED=2]="PAUSED",n[n.END=3]="END"})(dr||(dr={}));var QY={exports:{}};(function(n){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(l,h,u){this.fn=l,this.context=h,this.once=u||!1}function o(l,h,u,d,c){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,d||l,c),g=e?e+h:h;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],f]:l._events[g].push(f):(l._events[g]=f,l._eventsCount++),l}function s(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],u,d;if(this._eventsCount===0)return h;for(d in u=this._events)t.call(u,d)&&h.push(e?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(u)):h},a.prototype.listeners=function(h){var u=e?e+h:h,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var c=0,f=d.length,g=new Array(f);c<f;c++)g[c]=d[c].fn;return g},a.prototype.listenerCount=function(h){var u=e?e+h:h,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(h,u,d,c,f,g){var p=e?e+h:h;if(!this._events[p])return!1;var v=this._events[p],m=arguments.length,y,b;if(v.fn){switch(v.once&&this.removeListener(h,v.fn,void 0,!0),m){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,c),!0;case 5:return v.fn.call(v.context,u,d,c,f),!0;case 6:return v.fn.call(v.context,u,d,c,f,g),!0}for(b=1,y=new Array(m-1);b<m;b++)y[b-1]=arguments[b];v.fn.apply(v.context,y)}else{var _=v.length,w;for(b=0;b<_;b++)switch(v[b].once&&this.removeListener(h,v[b].fn,void 0,!0),m){case 1:v[b].fn.call(v[b].context);break;case 2:v[b].fn.call(v[b].context,u);break;case 3:v[b].fn.call(v[b].context,u,d);break;case 4:v[b].fn.call(v[b].context,u,d,c);break;default:if(!y)for(w=1,y=new Array(m-1);w<m;w++)y[w-1]=arguments[w];v[b].fn.apply(v[b].context,y)}}return!0},a.prototype.on=function(h,u,d){return o(this,h,u,d,!1)},a.prototype.once=function(h,u,d){return o(this,h,u,d,!0)},a.prototype.removeListener=function(h,u,d,c){var f=e?e+h:h;if(!this._events[f])return this;if(!u)return s(this,f),this;var g=this._events[f];if(g.fn)g.fn===u&&(!c||g.once)&&(!d||g.context===d)&&s(this,f);else{for(var p=0,v=[],m=g.length;p<m;p++)(g[p].fn!==u||c&&!g[p].once||d&&g[p].context!==d)&&v.push(g[p]);v.length?this._events[f]=v.length===1?v[0]:v:s(this,f)}return this},a.prototype.removeAllListeners=function(h){var u;return h?(u=e?e+h:h,this._events[u]&&s(this,u)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,n.exports=a})(QY);var rSt=QY.exports;const Bc=_E(rSt),xy=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,Sm=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||xy(n,"Boolean"),Td=n=>typeof n=="function",gi=n=>n==null,oo=n=>n!=null,gd=n=>{const t=typeof n;return n!==null&&t==="object"||t==="function"},oSt=n=>typeof n=="object"&&n!==null,sSt=function(n){if(!oSt(n)||!xy(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},Pi=n=>n===void 0,Ha=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||xy(n,"String")},ke=n=>Array.isArray?Array.isArray(n):xy(n,"Array"),kn=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||xy(n,"Number")},aSt=n=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(n),lSt=n=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(n),hSt=Object.prototype.hasOwnProperty,uSt=(n,t)=>n!=null&&hSt.call(n,t);function t5(n){return Object.prototype.toString.call(n)}function e5(n){return Object.keys(n)}function SP(n,t,e){if(n===t)return!0;if(typeof n!=typeof t||n==null||t==null)return!1;if(Number.isNaN(n)&&Number.isNaN(t))return!0;if(t5(n)!==t5(t)||Td(n)||typeof n!="object")return!1;if(ke(n)){if(n.length!==t.length)return!1;for(let o=n.length-1;o>=0;o--)if(!SP(n[o],t[o]))return!1;return!0}if(!sSt(n))return!1;const i=e5(n),r=e5(t);if(i.length!==r.length)return!1;i.sort(),r.sort();for(let o=i.length-1;o>=0;o--)if(i[o]!=r[o])return!1;for(let o=i.length-1;o>=0;o--){const s=i[o];if(!SP(n[s],t[s]))return!1}return!0}function Zb(n,t){if(!ke(n)||!ke(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}const dSt=typeof console<"u";function Jb(n,t,e){const i=[t].concat([].slice.call(e))}var Bs;(function(n){n[n.None=0]="None",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug"})(Bs||(Bs={}));let Ir=class no{static getInstance(t,e){return no._instance&&kn(t)?no._instance.level(t):no._instance||(no._instance=new no(t,e)),no._instance}static setInstance(t){return no._instance=t}static setInstanceLevel(t){no._instance?no._instance.level(t):no._instance=new no(t)}static clearInstance(){no._instance=null}constructor(t=Bs.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){const e=this._onErrorHandler.findIndex(i=>i===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=Bs.Info}canLogDebug(){return this._level>=Bs.Debug}canLogError(){return this._level>=Bs.Error}canLogWarn(){return this._level>=Bs.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=Bs.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):Jb((e=this._method)!==null&&e!==void 0?e:"error","ERROR",t)),this}warn(...t){return this._level>=Bs.Warn&&Jb(this._method||"warn","WARN",t),this}info(...t){return this._level>=Bs.Info&&Jb(this._method||"log","INFO",t),this}debug(...t){return this._level>=Bs.Debug&&Jb(this._method||"log","DEBUG",t),this}};Ir._instance=null;const cSt=1e-10,fSt=1e-10;function i5(n,t,e=fSt,i=cSt){const r=i,o=e*Math.max(n,t);return Math.abs(n-t)<=Math.max(r,o)}const gSt=function(n,t,e){return n<t?t:n>e?e:n},ii=1e-12,Fi=Math.PI,es=Fi/2,Zn=2*Fi,Zt=2*Math.PI,De=Math.abs,Le=Math.atan2,hn=Math.cos,Il=Math.max,er=Math.min,xi=Math.sin,js=Math.sqrt,tf=Math.pow;function pSt(n){return n>1?0:n<-1?Fi:Math.acos(n)}function n5(n){return n>=1?es:n<=-1?-es:Math.asin(n)}function r5(n,t,e,i,r){let o=e,s=i;return typeof n=="number"&&typeof e=="number"&&(o=(1-r)*n+r*e),typeof t=="number"&&typeof i=="number"&&(s=(1-r)*t+r*i),{x:o,y:s}}let Je=class tK{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new tK(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return kn(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return kn(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw new Error("")}div(t){throw new Error("")}},Fs=class{static distancePP(t,e){return js(tf(t.x-e.x,2)+tf(t.y-e.y,2))}static distanceNN(t,e,i,r){return js(tf(t-i,2)+tf(e-r,2))}static distancePN(t,e,i){return js(tf(e-t.x,2)+tf(i-t.y,2))}static pointAtPP(t,e,i){return new Je((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}};function Bf(n){return n*(Math.PI/180)}function vSt(n){return 180*n/Math.PI}const mSt=(n=0)=>{if(n<0)for(;n<-Zn;)n+=Zn;else if(n>0)for(;n>Zn;)n-=Zn;return n},ySt=mSt;function bSt(n,t,e){if(n===null)return t;if(t===null)return n;const{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:h,y22:u}=_St(n,t);return i>=l||r<=a||o>=u||s<=h?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(i,a),y1:Math.max(o,h),x2:Math.min(r,l),y2:Math.min(s,u)}}var o5;(function(n){n[n.NONE=0]="NONE",n[n.BBOX1=1]="BBOX1",n[n.BBOX2=2]="BBOX2"})(o5||(o5={}));const _St=(n,t,e)=>{let i=n.x1,r=n.x2,o=n.y1,s=n.y2,a=t.x1,l=t.x2,h=t.y1,u=t.y2;return{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:h,y22:u}};function s5(n,t,e){return n&&t?!(n.x1>t.x2||n.x2<t.x1||n.y1>t.y2||n.y2<t.y1):!0}function _R(n,t){return Math.abs(t[0]*n[0]+t[1]*n[1])}function Pl({x:n,y:t},e,i={x:0,y:0}){return{x:(n-i.x)*Math.cos(e)-(t-i.y)*Math.sin(e)+i.x,y:(n-i.x)*Math.sin(e)+(t-i.y)*Math.cos(e)+i.y}}function AP(n){return{x:(n.x1+n.x2)/2,y:(n.y1+n.y2)/2}}function a5(n,t){const e=t?Bf(n.angle):n.angle,i=AP(n);return[Pl({x:n.x1,y:n.y1},e,i),Pl({x:n.x2,y:n.y1},e,i),Pl({x:n.x2,y:n.y2},e,i),Pl({x:n.x1,y:n.y2},e,i)]}function CSt(n,t,e=!1){const i=a5(n,e),r=a5(t,e),o=(v,m)=>[m.x-v.x,m.y-v.y],s=o(AP(n),AP(t)),a=o(i[0],i[1]),l=o(i[1],i[2]),h=o(r[0],r[1]),u=o(r[1],r[2]),d=e?Bf(n.angle):n.angle;let c=e?Bf(90-n.angle):n.angle+es;const f=e?Bf(t.angle):t.angle;let g=e?Bf(90-t.angle):t.angle+es;c>Zt&&(c-=Zt),g>Zt&&(g-=Zt);const p=(v,m,y,b)=>{const _=[Math.cos(m),Math.sin(m)];return v+(_R(_,y)+_R(_,b))/2>_R(_,s)};return p((n.x2-n.x1)/2,d,h,u)&&p((n.y2-n.y1)/2,c,h,u)&&p((t.x2-t.x1)/2,f,a,l)&&p((t.y2-t.y1)/2,g,a,l)}function Gu(n,t,e,i,r,o){if(o>t&&o>i||o<t&&o<i||i===t)return 0;const s=(o-t)/(i-t);let a=i<t?1:-1;s!==1&&s!==0||(a=i<t?.5:-.5);const l=s*(e-n)+n;return l===r?1/0:l>r?a:0}const l5=n=>{let t=n.charCodeAt(0),e=n.length===2?n.charCodeAt(1):0,i=t;return 55296<=t&&t<=56319&&56320<=e&&e<=57343&&(t&=1023,e&=1023,i=t<<10|e,i+=65536),i===12288||65281<=i&&i<=65376||65504<=i&&i<=65510?"F":i===8361||65377<=i&&i<=65470||65474<=i&&i<=65479||65482<=i&&i<=65487||65490<=i&&i<=65495||65498<=i&&i<=65500||65512<=i&&i<=65518?"H":4352<=i&&i<=4447||4515<=i&&i<=4519||4602<=i&&i<=4607||9001<=i&&i<=9002||11904<=i&&i<=11929||11931<=i&&i<=12019||12032<=i&&i<=12245||12272<=i&&i<=12283||12289<=i&&i<=12350||12353<=i&&i<=12438||12441<=i&&i<=12543||12549<=i&&i<=12589||12593<=i&&i<=12686||12688<=i&&i<=12730||12736<=i&&i<=12771||12784<=i&&i<=12830||12832<=i&&i<=12871||12880<=i&&i<=13054||13056<=i&&i<=19903||19968<=i&&i<=42124||42128<=i&&i<=42182||43360<=i&&i<=43388||44032<=i&&i<=55203||55216<=i&&i<=55238||55243<=i&&i<=55291||63744<=i&&i<=64255||65040<=i&&i<=65049||65072<=i&&i<=65106||65108<=i&&i<=65126||65128<=i&&i<=65131||110592<=i&&i<=110593||127488<=i&&i<=127490||127504<=i&&i<=127546||127552<=i&&i<=127560||127568<=i&&i<=127569||131072<=i&&i<=194367||177984<=i&&i<=196605||196608<=i&&i<=262141?"W":32<=i&&i<=126||162<=i&&i<=163||165<=i&&i<=166||i===172||i===175||10214<=i&&i<=10221||10629<=i&&i<=10630?"Na":i===161||i===164||167<=i&&i<=168||i===170||173<=i&&i<=174||176<=i&&i<=180||182<=i&&i<=186||188<=i&&i<=191||i===198||i===208||215<=i&&i<=216||222<=i&&i<=225||i===230||232<=i&&i<=234||236<=i&&i<=237||i===240||242<=i&&i<=243||247<=i&&i<=250||i===252||i===254||i===257||i===273||i===275||i===283||294<=i&&i<=295||i===299||305<=i&&i<=307||i===312||319<=i&&i<=322||i===324||328<=i&&i<=331||i===333||338<=i&&i<=339||358<=i&&i<=359||i===363||i===462||i===464||i===466||i===468||i===470||i===472||i===474||i===476||i===593||i===609||i===708||i===711||713<=i&&i<=715||i===717||i===720||728<=i&&i<=731||i===733||i===735||768<=i&&i<=879||913<=i&&i<=929||931<=i&&i<=937||945<=i&&i<=961||963<=i&&i<=969||i===1025||1040<=i&&i<=1103||i===1105||i===8208||8211<=i&&i<=8214||8216<=i&&i<=8217||8220<=i&&i<=8221||8224<=i&&i<=8226||8228<=i&&i<=8231||i===8240||8242<=i&&i<=8243||i===8245||i===8251||i===8254||i===8308||i===8319||8321<=i&&i<=8324||i===8364||i===8451||i===8453||i===8457||i===8467||i===8470||8481<=i&&i<=8482||i===8486||i===8491||8531<=i&&i<=8532||8539<=i&&i<=8542||8544<=i&&i<=8555||8560<=i&&i<=8569||i===8585||8592<=i&&i<=8601||8632<=i&&i<=8633||i===8658||i===8660||i===8679||i===8704||8706<=i&&i<=8707||8711<=i&&i<=8712||i===8715||i===8719||i===8721||i===8725||i===8730||8733<=i&&i<=8736||i===8739||i===8741||8743<=i&&i<=8748||i===8750||8756<=i&&i<=8759||8764<=i&&i<=8765||i===8776||i===8780||i===8786||8800<=i&&i<=8801||8804<=i&&i<=8807||8810<=i&&i<=8811||8814<=i&&i<=8815||8834<=i&&i<=8835||8838<=i&&i<=8839||i===8853||i===8857||i===8869||i===8895||i===8978||9312<=i&&i<=9449||9451<=i&&i<=9547||9552<=i&&i<=9587||9600<=i&&i<=9615||9618<=i&&i<=9621||9632<=i&&i<=9633||9635<=i&&i<=9641||9650<=i&&i<=9651||9654<=i&&i<=9655||9660<=i&&i<=9661||9664<=i&&i<=9665||9670<=i&&i<=9672||i===9675||9678<=i&&i<=9681||9698<=i&&i<=9701||i===9711||9733<=i&&i<=9734||i===9737||9742<=i&&i<=9743||9748<=i&&i<=9749||i===9756||i===9758||i===9792||i===9794||9824<=i&&i<=9825||9827<=i&&i<=9829||9831<=i&&i<=9834||9836<=i&&i<=9837||i===9839||9886<=i&&i<=9887||9918<=i&&i<=9919||9924<=i&&i<=9933||9935<=i&&i<=9953||i===9955||9960<=i&&i<=9983||i===10045||i===10071||10102<=i&&i<=10111||11093<=i&&i<=11097||12872<=i&&i<=12879||57344<=i&&i<=63743||65024<=i&&i<=65039||i===65533||127232<=i&&i<=127242||127248<=i&&i<=127277||127280<=i&&i<=127337||127344<=i&&i<=127386||917760<=i&&i<=917999||983040<=i&&i<=1048573||1048576<=i&&i<=1114109?"A":"N"};function eK(n,t={},e){e||(e=1);const{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=t.fontWeight,fontSize:s=t.fontSize,fontFamily:a=t.fontFamily}=n;return(i?i+" ":"")+(r?r+" ":"")+(o?o+" ":"")+s*e+"px "+(a||"sans-serif")}let Kf=class Ju{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'"~`,this._option=t,this._userSpec=e??{},this.textSpec=this._initSpec(),oo(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=oo(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(gi(this._canvas)&&(oo(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),gi(this._canvas)&&typeof window<"u"&&window.document!==void 0&&globalThis&&oo(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),gi(this._context)&&oo(this._canvas)){const t=this._canvas.getContext("2d");oo(t)&&(t.save(),t.font=eK(this.textSpec),this._contextSaved=!0,this._context=t)}return!gi(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;const{defaultFontParams:r={}}=this._option,{fontStyle:o=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:a=(t=r.fontWeight)!==null&&t!==void 0?t:"normal",fontSize:l=(e=r.fontSize)!==null&&e!==void 0?e:12,fontFamily:h=(i=r.fontFamily)!==null&&i!==void 0?i:"sans-serif",align:u,textAlign:d=u??"center",baseline:c,textBaseline:f=c??"middle",ellipsis:g,limit:p}=this._userSpec;let{lineHeight:v=l}=this._userSpec;if(Ha(v)&&v[v.length-1]==="%"){const m=Number.parseFloat(v.substring(0,v.length-1))/100;v=l*m}return{fontStyle:o,fontVariant:s,fontFamily:h,fontSize:l,fontWeight:a,textAlign:d,textBaseline:f,ellipsis:g,limit:p,lineHeight:v}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){if(gi(t))return{width:0,height:0};if(gi(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);const{fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:a,limit:l,lineHeight:h}=this.textSpec;let u;try{const d=this._option.getTextBounds({text:t,fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:!!a,maxLineWidth:l||1/0,lineHeight:h});u={width:d.width(),height:d.height()}}catch{this._notSupportVRender=!0,u=this.measureWithNaiveCanvas(t)}return u}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);const i=this._context.measureText(t),{fontSize:r,lineHeight:o}=this.textSpec;return{width:i.width,height:(e=o)!==null&&e!==void 0?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){const e={width:0,height:0};for(let i=0;i<t.length;i++){const r=t[i];let o=this._measureSpecialChar(r);gi(o)&&Ju.NUMBERS_CHAR_SET.includes(r)&&(o=this._measureNumberChar()),gi(o)&&["F","W"].includes(l5(r))&&(o=this._measureFullSizeChar()),gi(o)&&(o=this._measureLetterChar()),e.width+=o.width,e.height=Math.max(e.height,o.height),!gi(o.fontBoundingBoxAscent)&&(e.fontBoundingBoxAscent=o.fontBoundingBoxAscent),!gi(o.fontBoundingBoxDescent)&&(e.fontBoundingBoxDescent=o.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){var e;const i={width:0,height:0},{fontSize:r,lineHeight:o}=this.textSpec;for(let s=0;s<t.length;s++){const a=t[s],l=["F","W"].includes(l5(a))?1:.53;i.width+=l*r}return i.height=(e=o)!==null&&e!==void 0?e:r,i}_measureReduce(t,e){var i;const{fontSize:r,lineHeight:o}=this.textSpec,s={width:0,height:0};if(gi(t))return s;if(ke(t)){const a=t.filter(oo).map(l=>l.toString());return a.length===0?s:a.length===1?e(a[0]):{width:a.reduce((l,h)=>Math.max(l,e(h).width),0),height:a.length*(((i=o)!==null&&i!==void 0?i:r)+1)+1}}return e(t.toString())}_measureNumberChar(){if(gi(this._numberCharSize)){const t=this._standardMethod(Ju.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/Ju.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return gi(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(Ju.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(gi(this._letterCharSize)){const t=this._standardMethod(Ju.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/Ju.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return oo(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){oo(this._canvas)&&(this._canvas=null),oo(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}};Kf.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",Kf.NUMBERS_CHAR_SET="0123456789",Kf.FULL_SIZE_CHAR="";function PO(n,t,e){const{x1:i,y1:r,x2:o,y2:s}=t;return e.onlyTranslate()?(n!==t&&n.setValue(t.x1,t.y1,t.x2,t.y2),n.translate(e.e,e.f),t):(n.clear(),n.add(e.a*i+e.c*r+e.e,e.b*i+e.d*r+e.f),n.add(e.a*o+e.c*r+e.e,e.b*o+e.d*r+e.f),n.add(e.a*o+e.c*s+e.e,e.b*o+e.d*s+e.f),n.add(e.a*i+e.c*s+e.e,e.b*i+e.d*s+e.f),t)}let Am=class iK{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new iK(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return ke(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){const r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){const o=this.scalePoints(t,e,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return PO(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){const{x1:r,y1:o,x2:s,y2:a}=this,l=Math.cos(t),h=Math.sin(t),u=e-e*l+i*h,d=i-e*h-i*l;return[l*r-h*o+u,h*r+l*o+d,l*r-h*a+u,h*r+l*a+d,l*s-h*o+u,h*s+l*o+d,l*s-h*a+u,h*s+l*a+d]}scalePoints(t,e,i,r){const{x1:o,y1:s,x2:a,y2:l}=this;return[t*o+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}},Fn=class extends Am{};class kO extends Am{constructor(t,e=0){var i;super(t),t&&(this.angle=(i=t.angle)!==null&&i!==void 0?i:e)}intersects(t){return CSt(this,t)}setValue(t=0,e=0,i=0,r=0,o=0){return super.setValue(t,e,i,r),this.angle=o,this}clone(){return new kO(this)}getRotatedCorners(){const t={x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2};return[Pl({x:this.x1,y:this.y1},this.angle,t),Pl({x:this.x2,y:this.y1},this.angle,t),Pl({x:this.x1,y:this.y2},this.angle,t),Pl({x:this.x2,y:this.y2},this.angle,t)]}}let mr=class hC{constructor(t=1,e=0,i=0,r=1,o=0,s=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=o,this.f=s}equalToMatrix(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}equalTo(t,e,i,r,o,s){return!(this.e!==o||this.f!==s||this.a!==t||this.d!==r||this.b!==e||this.c!==i)}setValue(t,e,i,r,o,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=o,this.f=s,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){const t=this.a,e=this.b,i=this.c,r=this.d,o=this.e,s=this.f,a=new hC,l=t*r-e*i;return a.a=r/l,a.b=-e/l,a.c=-i/l,a.d=t/l,a.e=(i*s-r*o)/l,a.f=-(t*s-e*o)/l,a}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,o=this.b*e+this.d*i,s=this.a*-i+this.c*e,a=this.b*-i+this.d*e;return this.a=r,this.b=o,this.c=s,this.d=a,this}rotateByCenter(t,e,i){const r=Math.cos(t),o=Math.sin(t),s=(1-r)*e+o*i,a=(1-r)*i-o*e,l=r*this.a-o*this.b,h=o*this.a+r*this.b,u=r*this.c-o*this.d,d=o*this.c+r*this.d,c=r*this.e-o*this.f+s,f=o*this.e+r*this.f+a;return this.a=l,this.b=h,this.c=u,this.d=d,this.e=c,this.f=f,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,o,s){return this.multiply(t,e,i,r,o,s),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){const{a:t,b:e,c:i,d:r,e:o,f:s}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=s,this.f=o,this}multiply(t,e,i,r,o,s){const a=this.a,l=this.b,h=this.c,u=this.d,d=a*t+h*e,c=l*t+u*e,f=a*i+h*r,g=l*i+u*r,p=a*o+h*s+this.e,v=l*o+u*s+this.f;return this.a=d,this.b=c,this.c=f,this.d=g,this.e=p,this.f=v,this}interpolate(t,e){const i=new hC;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){const{a:i,b:r,c:o,d:s,e:a,f:l}=this,h=i*s-r*o,u=s/h,d=-r/h,c=-o/h,f=i/h,g=(o*l-s*a)/h,p=-(i*l-r*a)/h,{x:v,y:m}=t;e.x=v*u+m*c+g,e.y=v*d+m*f+p}onlyTranslate(t=1){return this.a===t&&this.b===0&&this.c===0&&this.d===t}clone(){return new hC(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){const t=this.a,e=this.b,i=this.c,r=this.d,o=t*r-e*i,s={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!==0||e!==0){const a=Math.sqrt(t*t+e*e);s.rotateDeg=e>0?Math.acos(t/a):-Math.acos(t/a),s.scaleX=a,s.scaleY=o/a,s.skewX=(t*i+e*r)/o,s.skewY=0}else if(i!==0||r!==0){const a=Math.sqrt(i*i+r*r);s.rotateDeg=Math.PI/2-(r>0?Math.acos(-i/a):-Math.acos(i/a)),s.scaleX=o/a,s.scaleY=a,s.skewX=0,s.skewY=(t*i+e*r)/o}return s.rotateDeg=vSt(s.rotateDeg),s}};function wSt(n,t,e,i,r,o,s,a){const l=t.a,h=t.b,u=t.c,d=t.d,c=t.e,f=t.f,g=hn(s),p=xi(s);let v,m;a?(v=a[0],m=a[1]):(v=e,m=i);const y=v-e,b=m-i,_=l*g+u*p,w=h*g+d*p,C=u*g-l*p,x=d*g-h*p;n.a=r*_,n.b=r*w,n.c=o*C,n.d=o*x,n.e=c+l*v+u*m-_*y-C*b,n.f=f+h*v+d*m-w*y-x*b}class xSt{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(t,e){const{CLEAN_THRESHOLD:i=this.CLEAN_THRESHOLD,L_TIME:r=this.L_TIME,R_COUNT:o=this.R_COUNT}=e;if(t.size<i)return 0;let s=0;const a=h=>{s++,t.delete(h)},l=Date.now();return t.forEach((h,u)=>{if(h.timestamp.length<o)return a(u);let d=0;for(;l-h.timestamp[h.timestamp.length-1-d]<r&&(d++,!(d>=o)););if(d<o)return a(u);for(;l-h.timestamp[0]>r;)h.timestamp.shift()}),s}addLimitedTimestamp(t,e,i){const{R_TIMESTAMP_MAX_SIZE:r=this.R_TIMESTAMP_MAX_SIZE}=i;t.timestamp.length>r&&t.timestamp.shift(),t.timestamp.push(e)}clearTimeStamp(t,e){const{L_TIME:i=this.L_TIME}=e,r=Date.now();t.forEach(o=>{for(;r-o.timestamp[0]>i;)o.timestamp.shift()})}clearItemTimestamp(t,e){const{L_TIME:i=this.L_TIME}=e,r=Date.now();for(;r-t.timestamp[0]>i;)t.timestamp.shift()}}function h5(n,t,e){t/=100,e/=100;const i=(1-Math.abs(2*e-1))*t,r=i*(1-Math.abs(n/60%2-1)),o=e-i/2;let s=0,a=0,l=0;return 0<=n&&n<60?(s=i,a=r,l=0):60<=n&&n<120?(s=r,a=i,l=0):120<=n&&n<180?(s=0,a=i,l=r):180<=n&&n<240?(s=0,a=r,l=i):240<=n&&n<300?(s=r,a=0,l=i):300<=n&&n<360&&(s=i,a=0,l=r),s=Math.round(255*(s+o)),a=Math.round(255*(a+o)),l=Math.round(255*(l+o)),{r:s,g:a,b:l}}function nK(n,t,e){n/=255,t/=255,e/=255;const i=Math.min(n,t,e),r=Math.max(n,t,e),o=r-i;let s=0,a=0,l=0;return s=o===0?0:r===n?(t-e)/o%6:r===t?(e-n)/o+2:(n-t)/o+4,s=Math.round(60*s),s<0&&(s+=360),l=(r+i)/2,a=o===0?0:o/(1-Math.abs(2*l-1)),a=+(100*a).toFixed(1),l=+(100*l).toFixed(1),{h:s,s:a,l}}const SSt=/^#([0-9a-f]{3,8})$/,u5={transparent:4294967040},CR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Qb(n){return((n=Math.max(0,Math.min(255,Math.round(n)||0)))<16?"0":"")+n.toString(16)}function rK(n){return kn(n)?new os(n>>16,n>>8&255,255&n,1):ke(n)?new os(n[0],n[1],n[2]):new os(255,255,255)}function ASt(n){return kn(n)?new os(n>>>24,n>>>16&255,n>>>8&255,255&n):ke(n)?new os(n[0],n[1],n[2],n[3]):new os(255,255,255,1)}function wR(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function xR(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const d5=(n,t)=>{const e=SSt.exec(n);if(t||e){const i=parseInt(e[1],16),r=e[1].length;return r===3?new os((i>>8&15)+((i>>8&15)<<4),(i>>4&15)+((i>>4&15)<<4),(15&i)+((15&i)<<4),1):r===6?rK(i):r===8?new os(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):null}};let c5=class Qu{static Brighter(t,e=1){return e===1?t:new Qu(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return e===1?t:new Qu(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){const i=t instanceof Qu?t:new Qu(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if(oo(u5[t]))return ASt(u5[t]);if(oo(CR[t]))return rK(CR[t]);const e=`${t}`.trim().toLowerCase(),i=d5(e);if(i!==void 0)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){const r=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new os(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseFloat(r[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){const r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),o=h5(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new os(o.r,o.g,o.b,parseFloat(r[3]))}}constructor(t){const e=Qu.parseColorString(t);e?this.color=e:this.color=new os(255,255,255)}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){const{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){const r=this.color.opacity,o=nK(this.color.r,this.color.g,this.color.b),s=h5(gi(t)?o.h:gSt(t,0,360),gi(e)?o.s:e>=0&&e<=1?100*e:e,gi(i)?o.l:i<=1&&i>=0?100*i:i);return this.color=new os(s.r,s.g,s.b,r),this}setRGB(t,e,i){return!gi(t)&&(this.color.r=t),!gi(e)&&(this.color.g=e),!gi(i)&&(this.color.b=i),this}setHex(t){const e=`${t}`.trim().toLowerCase(),i=d5(e,!0);return i??this}setColorName(t){const e=CR[t.toLowerCase()];return e!==void 0&&this.setHex(e),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){const t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;let r,o,s;return r=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),o=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),s=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),.2126*r+.7152*o+.0722*s}clone(){return new Qu(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=wR(t.color.r),this.color.g=wR(t.color.g),this.color.b=wR(t.color.b),this}copyLinearToSRGB(t){return this.color.r=xR(t.color.r),this.color.g=xR(t.color.g),this.color.b=xR(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}},os=class{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),oo(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${Qb(this.r)+Qb(this.g)+Qb(this.b)+(this.opacity===1?"":Qb(255*this.opacity))}`}formatRgb(){const t=this.opacity;return`${t===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${t===1?")":`,${t})`}`}formatHsl(){const t=this.opacity,{h:e,s:i,l:r}=nK(this.r,this.g,this.b);return`${t===1?"hsl(":"hsla("}${e},${i}%,${r}%${t===1?")":`,${t})`}`}toString(){return this.formatHex()}};const TSt=Zn-1e-8;class EO{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,i,r,o,s){if(Math.abs(o-r)>TSt)return this.bounds.add(t-i,e-i),void this.bounds.add(t+i,e+i);let a,l,h,u,d=1/0,c=-1/0,f=1/0,g=-1/0;function p(v){h=i*Math.cos(v),u=i*Math.sin(v),h<d&&(d=h),h>c&&(c=h),u<f&&(f=u),u>g&&(g=u)}if(p(r),p(o),o!==r)if((r%=Zn)<0&&(r+=Zn),(o%=Zn)<0&&(o+=Zn),o<r&&(s=!s,a=r,r=o,o=a),s)for(o-=Zn,a=r-r%es,l=0;l<4&&a>o;++l,a-=es)p(a);else for(a=r-r%es+es,l=0;l<4&&a<o;++l,a+=es)p(a);this.bounds.add(t+d,e+f),this.bounds.add(t+c,e+g)}arcTo(t,e,i,r,o){this.bounds.add(t,e)}bezierCurveTo(t,e,i,r,o,s){this.bounds.add(t,e),this.bounds.add(i,r),this.bounds.add(o,s)}closePath(){}ellipse(){throw new Error("ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,i,r){this.bounds.add(t,e),this.bounds.add(i,r)}rect(t,e,i,r){this.bounds.add(t,e),this.bounds.add(t+i,e+r)}clear(){this.bounds.clear()}release(...t){}}class MSt{constructor(){this._curves=[],this.bounds=new Fn}get curves(){return this._curves}getCurveLengths(){return this._curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}const RSt=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,BSt={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},ue={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};let SR,f5,t_,g5,AR,e_;function PSt(n){if(!n)return[];const t=n.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(t===null)return[];let e,i;const r=[];for(let o=0,s=t.length;o<s;o++)if(SR=t[o],f5=SR.slice(1),t_=SR[0],e=[t_],i=f5.match(RSt),i!==null){for(let a=0,l=i.length;a<l;a++)g5=i[a],AR=parseFloat(g5),Number.isNaN(AR)||e.push(AR);if(e_=BSt[t_],e.length-1>e_){let a,l=t_;for(let h=1,u=e.length;h<u;h+=e_){a=[l];for(let d=h,c=h+e_;d<c;d++)a.push(e[d]);r.push(a),l==="m"?l="l":l==="M"&&(l="L")}}else r.push(e)}else r.push(e);return r}var Ye;(function(n){n[n.NONE=0]="NONE",n[n.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",n[n.UPDATE_SHAPE=2]="UPDATE_SHAPE",n[n.CLEAR_SHAPE=253]="CLEAR_SHAPE",n[n.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",n[n.INIT=179]="INIT",n[n.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",n[n.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",n[n.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",n[n.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",n[n.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",n[n.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",n[n.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",n[n.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"})(Ye||(Ye={}));var Tm;(function(n){n[n.GLOBAL=1]="GLOBAL",n[n.LOCAL=16]="LOCAL",n[n.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",n[n.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"})(Tm||(Tm={}));var xr;(function(n){n[n.INIT=0]="INIT",n[n.DEFAULT=1]="DEFAULT",n[n.STATE=2]="STATE",n[n.ANIMATE_BIND=10]="ANIMATE_BIND",n[n.ANIMATE_PLAY=11]="ANIMATE_PLAY",n[n.ANIMATE_START=12]="ANIMATE_START",n[n.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",n[n.ANIMATE_END=14]="ANIMATE_END",n[n.TRANSLATE=20]="TRANSLATE",n[n.TRANSLATE_TO=21]="TRANSLATE_TO",n[n.SCALE=22]="SCALE",n[n.SCALE_TO=23]="SCALE_TO",n[n.ROTATE=24]="ROTATE",n[n.ROTATE_TO=25]="ROTATE_TO"})(xr||(xr={}));var ze;(function(n){n[n.ROW=1]="ROW",n[n.COLUMN=2]="COLUMN"})(ze||(ze={}));var Mm;(function(n){n[n.CubicBezierCurve=0]="CubicBezierCurve",n[n.QuadraticBezierCurve=1]="QuadraticBezierCurve",n[n.ArcCurve=2]="ArcCurve",n[n.LineCurve=3]="LineCurve",n[n.EllipseCurve=4]="EllipseCurve",n[n.MoveCurve=5]="MoveCurve"})(Mm||(Mm={}));var xe;(function(n){n[n.beforeFillStroke=0]="beforeFillStroke",n[n.afterFillStroke=1]="afterFillStroke"})(xe||(xe={}));function kSt(n,t,e,i,r,o,s,a,l){const h=Bf(s),u=Math.sin(h),d=Math.cos(h),c=d*(a-n)*.5+u*(l-t)*.5,f=d*(l-t)*.5-u*(a-n)*.5;let g=c*c/((e=Math.abs(e))*e)+f*f/((i=Math.abs(i))*i);g>1&&(g=Math.sqrt(g),e*=g,i*=g);const p=d/e,v=u/e,m=-u/i,y=d/i,b=p*a+v*l,_=m*a+y*l,w=p*n+v*t,C=m*n+y*t;let x=1/((w-b)*(w-b)+(C-_)*(C-_))-.25;x<0&&(x=0);let S=Math.sqrt(x);o===r&&(S=-S);const A=.5*(b+w)-S*(C-_),T=.5*(_+C)+S*(w-b),M=Math.atan2(_-T,b-A);let R=Math.atan2(C-T,w-A)-M;R<0&&o===1?R+=Zn:R>0&&o===0&&(R-=Zn);const E=Math.ceil(Math.abs(R/(es+.001))),P=[];for(let B=0;B<E;++B){const k=M+B*R/E,L=M+(B+1)*R/E;P[B]=[A,T,k,L,e,i,u,d]}return P}function ESt(n){const t=n[0],e=n[1],i=n[2],r=n[3],o=n[4],s=n[5],a=n[6],l=n[7],h=l*o,u=-a*s,d=a*o,c=l*s,f=Math.cos(i),g=Math.sin(i),p=Math.cos(r),v=Math.sin(r),m=.5*(r-i),y=Math.sin(.5*m),b=8/3*y*y/Math.sin(m),_=t+f-b*g,w=e+g+b*f,C=t+p,x=e+v,S=C+b*v,A=x-b*p;return[h*_+u*w,d*_+c*w,h*S+u*A,d*S+c*A,h*C+u*x,d*C+c*x]}function p5(n,t,e,i){const r=kSt(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,e);for(let o=0;o<r.length;++o){const s=ESt(r[o]);n.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const LSt=(n,t,e,i,r,o,s,a=!1)=>{const l=2*Math.PI,h=(t%l+l)%l;let u,d=(e%l+l)%l;a?(d>=h&&(d-=l),u=d-h):(d<=h&&(d+=l),u=d-h);const c=Math.ceil(Math.abs(u)/(.5*Math.PI)),f=u/c;for(let g=0;g<c;g++){const p=h+f*g,v=h+f*(g+1),m=4/3*Math.tan(Math.abs(f)/4),y=Math.cos(p),b=Math.sin(p),_=Math.cos(v),w=Math.sin(v),C=y*o+i,x=b*s+r,S=_*o+i,A=w*s+r,T=a?-1:1,M=o*m*T,R=s*m*T;n.push(C-M*b,x+R*y,S+M*w,A-R*_,S,A)}},OSt=[(n,t,e,i,r,o,s)=>t.arc(n[1]*r+e,n[2]*o+i,n[3]*(r+o)/2,n[4],n[5],n[6],s),(n,t,e,i,r,o,s)=>t.arcTo(n[1]*r+e,n[2]*o+i,n[3]*r+e,n[4]*o+i,n[5]*(r+o)/2,s),(n,t,e,i,r,o,s)=>t.bezierCurveTo(n[1]*r+e,n[2]*o+i,n[3]*r+e,n[4]*o+i,n[5]*r+e,n[6]*o+i,s),(n,t,e,i)=>t.closePath(),(n,t,e,i,r,o)=>t.ellipse(n[1]*r+e,n[2]*o+i,n[3]*r,n[4]*o,n[5],n[6],n[7],n[8]),(n,t,e,i,r,o,s)=>t.lineTo(n[1]*r+e,n[2]*o+i,s),(n,t,e,i,r,o,s)=>t.moveTo(n[1]*r+e,n[2]*o+i,s),(n,t,e,i,r,o,s)=>t.quadraticCurveTo(n[1]*r+e,n[2]*o+i,n[3]*r+e,n[4]*o+i,s),(n,t,e,i,r,o,s)=>t.rect(n[1]*r+e,n[2]*o+i,n[3]*r,n[4]*o,s)];function Xl(n,t,e=0,i=0,r=1,o=1,s){for(let a=0;a<n.length;a++){const l=n[a];OSt[l[0]](l,t,e,i,r,o,s)}}class LO{getLength(t){return t!=null?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}function oK(n,t){let e=0;const i=n.length;for(let r=0;r<i;r++){const o=n[r],s=t[r],a=n[(r+1)%i],l=t[(r+1)%i];e+=Fs.distanceNN(o,s,a,l)}return e/2}function DSt(n,t,e,i,r){return oK([n.x,t.x,e.x,i.x],[n.y,t.y,e.y,i.y])}function v5(n,t,e,i,r){const o=1-r;return o*o*o*n+3*t*r*o*o+3*e*r*r*o+i*r*r*r}function sK(n,t,e,i,r){const o=v5(n.x,t.x,e.x,i.x,r),s=v5(n.y,t.y,e.y,i.y,r);return new Je(o,s)}function m5(n,t,e,i){const r=1-i;return r*r*n+2*r*i*t+i*i*e}function aK(n,t,e,i){const r=m5(n.x,t.x,e.x,i),o=m5(n.y,t.y,e.y,i);return new Je(r,o)}function ISt(n,t,e,i){return oK([n.x,t.x,e.x],[n.y,t.y,e.y])}function Kg(n,t){const{p0:e,p1:i,p2:r,p3:o}=n,s=sK(e,i,r,o,t),a=Fs.pointAtPP(e,i,t),l=Fs.pointAtPP(i,r,t),h=Fs.pointAtPP(r,o,t),u=Fs.pointAtPP(a,l,t),d=Fs.pointAtPP(l,h,t);return[new Nw(e,a,u,s),new Nw(s,d,h,o)]}class Nw extends LO{constructor(t,e,i,r){super(),this.type=Mm.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(this.defined!==!1)return sK(this.p0,this.p1,this.p2,this.p3,t);throw new Error("definedfalsegetPointAt")}calcLength(){return this._validPoint()?DSt(this.p0,this.p1,this.p2,this.p3):60}calcProjLength(t){return t===ze.ROW?De(this.p0.x-this.p3.x):t===ze.COLUMN?De(this.p0.y-this.p3.y):0}getAngleAt(t){const e=Il(t-.01,0),i=er(t+.01,1),r=this.getPointAt(e),o=this.getPointAt(i);return Le(o.y-r.y,o.x-r.x)}draw(t,e,i,r,o,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*o+i),s>=1)t.bezierCurveTo(this.p1.x*r+e,this.p1.y*o+i,this.p2.x*r+e,this.p2.y*o+i,this.p3.x*r+e,this.p3.y*o+i);else if(s>0){const[a]=Kg(this,s);t.bezierCurveTo(a.p1.x*r+e,a.p1.y*o+i,a.p2.x*r+e,a.p2.y*o+i,a.p3.x*r+e,a.p3.y*o+i)}}includeX(t){const e=er(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=Il(this.p0.x,this.p1.x,this.p2.x,this.p3.x);return t>=e&&t<=i}getYAt(t){const e=er(this.p0.x,this.p1.x,this.p2.x,this.p3.x),i=(t-e)/(Il(this.p0.x,this.p1.x,this.p2.x,this.p3.x)-e);return this.getPointAt(i).y}}function y5(n,t){const{p0:e,p1:i}=n,r=Fs.pointAtPP(e,i,t);return[new Ww(e,r),new Ww(r,i)]}class Ww extends LO{constructor(t,e){super(),this.type=Mm.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(this.defined!==!1)return Fs.pointAtPP(this.p0,this.p1,t);throw new Error("definedfalsegetPointAt")}getAngleAt(t){return this.angle==null&&(this.angle=Le(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?Fs.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===ze.ROW?De(this.p0.x-this.p1.x):t===ze.COLUMN?De(this.p0.y-this.p1.y):0}draw(t,e,i,r,o,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*o+i),s>=1)t.lineTo(this.p1.x*r+e,this.p1.y*o+i);else if(s>0){const a=this.getPointAt(s);t.lineTo(a.x*r+e,a.y*o+i)}}includeX(t){return t>=this.p0.x&&t<=this.p1.x||t>=this.p1.x&&t<=this.p0.x}getYAt(t){if(this.includeX(t)){let e=this.p0,i=this.p1;this.p0.x>this.p1.x&&(e=this.p1,i=this.p0);const r=(t-e.x)/(i.x-e.x);return e.y+r*(i.y-e.y)}return 1/0}}class tA{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,i,r,o,s,a,l){const h=new Nw(new Je(this._lastX,this._lastY),new Je(t,e),new Je(i,r),new Je(o,s));h.originP1=this._lastOriginP,h.originP2=l,h.defined=a,this.curves.push(h),this._lastX=o,this._lastY=s,this._lastOriginP=l}closePath(){if(this.curves.length<2)return;const t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw new Error("SegContextellipse")}lineTo(t,e,i,r){const o=this.addLinearCurve(t,e,i,this._lastOriginP,r);this.curves.push(o),this._lastX=t,this._lastY=e,this._lastOriginP=r}moveTo(t,e,i){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(t,e,i,r){throw new Error("SegContextquadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,i,r,o){const s=new Ww(new Je(this._lastX,this._lastY),new Je(t,e));return s.originP1=r,s.originP2=o,s.defined=i,s}getPointAt(t){throw new Error("")}getCurveLengths(){return[]}getLength(t){var e,i;if(t===ze.COLUMN){if(!this.curves.length)return 0;const r=this.curves[0],o=this.curves[this.curves.length-1],s=(e=o.p3)!==null&&e!==void 0?e:o.p1;return De(r.p0.y-s.y)}if(t===ze.ROW){if(!this.curves.length)return 0;const r=this.curves[0],o=this.curves[this.curves.length-1],s=(i=o.p3)!==null&&i!==void 0?i:o.p1;return De(r.p0.x-s.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((r,o)=>r+o.getLength(),0)),this.length}}class HSt extends tA{bezierCurveTo(t,e,i,r,o,s,a,l){return super.bezierCurveTo(e,t,r,i,s,o,a,l)}lineTo(t,e,i,r){return super.lineTo(e,t,i,r)}moveTo(t,e,i){return super.moveTo(e,t,i)}clear(){return super.clear()}}function Pc(n,t,e=1){let i=!1;for(let r=0,o=t.length;r<=o;r++)r>=o===i&&((i=!i)?n.lineStart():n.lineEnd()),i&&n.point(t[r])}function wp(n,t,e){const i=t??(De(e[e.length-1].x-e[0].x)>De(e[e.length-1].y-e[0].y)?ze.ROW:ze.COLUMN);return n==="monotoneY"?new HSt(n,i):new tA(n,i)}class lK{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function Sy(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;const r=wp("linear",e,n);return FSt(new lK(r,i),n),r}function FSt(n,t){return Pc(n,t,1)}function b5(n,t,e,i,r){n.context.bezierCurveTo((2*n._x0+n._x1)/3,(2*n._y0+n._y1)/3,(n._x0+2*n._x1)/3,(n._y0+2*n._y1)/3,(n._x0+4*n._x1+t)/6,(n._y0+4*n._y1+e)/6,i,n.lastPoint1)}class zSt{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){this._point===2&&b5(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;break;default:b5(this,e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function NSt(n,t){return Pc(n,t,2)}function WSt(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;if(n.length<3-+!!i)return Sy(n,t);const r=wp("basis",e,n);return NSt(new zSt(r,i),n),r}function _5(n){return n<0?-1:1}function C5(n,t,e){const i=n._x1-n._x0,r=t-n._x1,o=(n._y1-n._y0)/(i||Number(r<0&&-0)),s=(e-n._y1)/(r||Number(i<0&&-0)),a=(o*r+s*i)/(i+r);return(_5(o)+_5(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function w5(n,t){const e=n._x1-n._x0;return e?(3*(n._y1-n._y0)/e-t)/2:t}function TR(n,t,e,i,r){const o=n._x0,s=n._y0,a=n._x1,l=n._y1,h=(a-o)/3;n.context.bezierCurveTo(o+h,s+h*t,a-h,l-h*e,a,l,i,n.lastPoint1)}class hK{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:TR(this,this._t0,w5(this,this._t0),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1)}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN;const i=t.x,r=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,this._lastDefined1!==!1&&this._lastDefined2!==!1,t):this.context.moveTo(i,r,t);break;case 1:this._point=2;break;case 2:this._point=3,TR(this,w5(this,e=C5(this,i,r)),e,this._lastDefined1!==!1&&this._lastDefined2!==!1);break;default:TR(this,this._t0,e=C5(this,i,r),this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined!==!1,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class VSt extends hK{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}function GSt(n,t){return Pc(n,t,2)}function $St(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;if(n.length<3-+!!i)return Sy(n,t);const r=wp("monotoneX",e,n);return GSt(new hK(r,i),n),r}function jSt(n,t){return Pc(n,t,2)}function USt(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;if(n.length<3-+!!i)return Sy(n,t);const r=wp("monotoneY",e,n);return jSt(new VSt(r,i),n),r}let uK=class{constructor(t,e=.5,i){this.context=t,this._t=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&this._point===2&&this.context.lineTo(this._x,this._y,this._lastDefined!==!1,this.lastPoint),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){const e=t.x,i=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t):this.context.moveTo(e,i,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,i,this._lastDefined!==!1&&t.defined!==!1,this.lastPoint),this.context.lineTo(e,i,this._lastDefined!==!1&&t.defined!==!1,t);else{const r=this._x*(1-this._t)+e*this._t;this._t===.5?this.context.lineTo(r,this._y,this._lastDefined!==!1,this.lastPoint):this.context.lineTo(r,this._y,this._lastDefined!==!1&&t.defined!==!1,this.lastPoint),this.context.lineTo(r,i,this._lastDefined!==!1&&t.defined!==!1,t)}}this._lastDefined=t.defined,this._x=e,this._y=i,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}};class XSt extends uK{lineEnd(){this.context.closePath()}}function MR(n,t,e={}){const{direction:i,startPoint:r}=e;if(n.length<2-+!!r)return null;const o=new tA("step",i??(De(n[n.length-1].x-n[0].x)>De(n[n.length-1].y-n[0].y)?ze.ROW:ze.COLUMN));return dK(new uK(o,t,r),n),o}function dK(n,t){return Pc(n,t,1)}function YSt(n,t,e={}){const{direction:i,startPoint:r}=e;if(n.length<2-+!!r)return null;const o=new tA("step",i??(De(n[n.length-1].x-n[0].x)>De(n[n.length-1].y-n[0].y)?ze.ROW:ze.COLUMN));return dK(new XSt(o,t,r),n),o}class KSt extends lK{lineEnd(){this.context.closePath()}}function qSt(n,t={}){const{direction:e,startPoint:i}=t;if(n.length<2-+!!i)return null;const r=wp("linear",e,n);return ZSt(new KSt(r,i),n),r}function ZSt(n,t){return Pc(n,t,1)}function cK(n,t,e,i,r){let o=n._x1,s=n._y1,a=n._x2,l=n._y2;if(n._l01_a>ii){const h=2*n._l01_2a+3*n._l01_a*n._l12_a+n._l12_2a,u=3*n._l01_a*(n._l01_a+n._l12_a);o=(o*h-n._x0*n._l12_2a+n._x2*n._l01_2a)/u,s=(s*h-n._y0*n._l12_2a+n._y2*n._l01_2a)/u}if(n._l23_a>ii){const h=2*n._l23_2a+3*n._l23_a*n._l12_a+n._l12_2a,u=3*n._l23_a*(n._l23_a+n._l12_a);a=(a*h+n._x1*n._l23_2a-t*n._l12_2a)/u,l=(l*h+n._y1*n._l23_2a-e*n._l12_2a)/u}n.context.bezierCurveTo(o,s,a,l,n._x2,n._y2,i,n.lastPoint1)}class JSt{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const{x:e,y:i}=t;if(this._point){const r=this._x2-e,o=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+o*o,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1):this.context.moveTo(e,i);break;case 1:this._point=2;break;case 2:this._point=3;default:cK(this,e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function fK(n,t){return function(e,i,r={}){const{direction:o,startPoint:s}=r;if(e.length<2-+!!s)return null;if(e.length<3-+!!s)return Sy(e,r);const a=wp(n,o,e),l=new t(a,i,s);return Pc(l,e,2),a}}const QSt=fK("catmullRom",JSt);class tAt{constructor(t,e=.5,i){this.context=t,this.startPoint=i,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){const{x:e,y:i}=t;if(this._point){const r=this._x2-e,o=this._y2-i;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+o*o,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=i;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=i,t);break;case 2:this._point=3,this._x5=e,this._y5=i;break;default:cK(this,e,i,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}const eAt=fK("catmullRomClosed",tAt);function iAt(n,t){const{p0:e,p1:i,p2:r}=n,o=aK(e,i,r,t),s=Fs.pointAtPP(e,i,t),a=Fs.pointAtPP(i,r,t);return[new TP(e,s,o),new TP(o,a,r)]}class TP extends LO{constructor(t,e,i){super(),this.type=Mm.QuadraticBezierCurve,this.p0=t,this.p1=e,this.p2=i}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y)}getPointAt(t){if(this.defined!==!1)return aK(this.p0,this.p1,this.p2,t);throw new Error("definedfalsegetPointAt")}calcLength(){return this._validPoint()?ISt(this.p0,this.p1,this.p2):60}calcProjLength(t){return t===ze.ROW?De(this.p0.x-this.p2.x):t===ze.COLUMN?De(this.p0.y-this.p2.y):0}getAngleAt(t){const e=Il(t-.01,0),i=er(t+.01,1),r=this.getPointAt(e),o=this.getPointAt(i);return Le(o.y-r.y,o.x-r.x)}draw(t,e,i,r,o,s){if(t.moveTo(this.p0.x*r+e,this.p0.y*o+i),s>=1)t.quadraticCurveTo(this.p1.x*r+e,this.p1.y*o+i,this.p2.x*r+e,this.p2.y*o+i);else if(s>0){const[a]=iAt(this,s);t.quadraticCurveTo(a.p1.x*r+e,a.p1.y*o+i,a.p2.x*r+e,a.p2.y*o+i)}}getYAt(t){throw new Error("QuadraticBezierCurvegetYAt")}includeX(t){throw new Error("QuadraticBezierCurveincludeX")}}class nAt{constructor(t){this.path=t,this._lastX=this._lastY=this._startX=this._startY=0}moveTo(t,e){return this._lastX=this._startX=t,this._lastY=this._startY=e,this}lineTo(t,e){const i=this.addLinearCurve(t,e);this.path.addCurve(i),this._lastX=t,this._lastY=e}addLinearCurve(t,e){return new Ww(new Je(this._lastX,this._lastY),new Je(t,e))}quadraticCurveTo(t,e,i,r){const o=new TP(new Je(this._lastX,this._lastY),new Je(t,e),new Je(i,r));this.path.addCurve(o),this._lastX=i,this._lastY=r}bezierCurveTo(t,e,i,r,o,s){const a=new Nw(new Je(this._lastX,this._lastY),new Je(t,e),new Je(i,r),new Je(o,s));this.path.addCurve(a),this._lastX=o,this._lastY=s}arcTo(t,e,i,r,o){throw new Error("CurveContextarcTo")}ellipse(t,e,i,r,o,s,a,l){throw new Error("CurveContextellipse")}rect(t,e,i,r){throw new Error("CurveContextrect")}arc(t,e,i,r,o,s){throw new Error("CurveContextarc")}closePath(){this.path.curves.length<2||this.lineTo(this._startX,this._startY)}}function Md(n,t,e){var i,r;switch(t){case"linear":default:return Sy(n,e);case"basis":return WSt(n,e);case"monotoneX":return $St(n,e);case"monotoneY":return USt(n,e);case"step":return MR(n,.5,e);case"stepClosed":return YSt(n,.5,e);case"stepBefore":return MR(n,0,e);case"stepAfter":return MR(n,1,e);case"catmullRom":return QSt(n,(i=e?.curveTension)!==null&&i!==void 0?i:.5,e);case"catmullRomClosed":return eAt(n,(r=e?.curveTension)!==null&&r!==void 0?r:.5,e);case"linearClosed":return qSt(n,e)}}class wn extends MSt{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new EO(this.bounds)}get curves(){return this.tryBuildCurves()}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([ue.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([ue.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,i,r){return this.commandList.push([ue.Q,t,e,i,r]),this._ctx&&this._ctx.quadraticCurveTo(t,e,i,r),this}bezierCurveTo(t,e,i,r,o,s){return this.commandList.push([ue.C,t,e,i,r,o,s]),this._ctx&&this._ctx.bezierCurveTo(t,e,i,r,o,s),this}arcTo(t,e,i,r,o){return this.commandList.push([ue.AT,t,e,i,r,o]),this._ctx&&this._ctx.arcTo(t,e,i,r,o),this}ellipse(t,e,i,r,o,s,a,l){return this.commandList.push([ue.E,t,e,i,r,o,s,a,l]),this._ctx&&this._ctx.ellipse(t,e,i,r,o,s,a,l),this}rect(t,e,i,r){return this.commandList.push([ue.R,t,e,i,r]),this._ctx&&this._ctx.rect(t,e,i,r),this}arc(t,e,i,r,o,s){return this.commandList.push([ue.A,t,e,i,r,o,s]),this._ctx&&this._ctx.arc(t,e,i,r,o,s),this}closePath(){return this.commandList.push([ue.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this._curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this._curves.length=0}beginPath(){this.clear()}tryBuildCurves(){if(!this._curves||!this._curves.length){const t=new nAt(this);Xl(this.commandList,t,0,0,1,1)}return this._curves}toString(){if(!this.toStringCbList){const i=[];i[ue.M]=r=>`M${r[1]} ${r[2]}`,i[ue.L]=r=>`L${r[1]} ${r[2]}`,i[ue.Q]=r=>`Q${r[1]} ${r[2]} ${r[3]} ${r[4]}`,i[ue.C]=r=>`C${r[1]} ${r[2]} ${r[3]} ${r[4]} ${r[5]} ${r[6]}`,i[ue.A]=r=>{const o=[],s=r[1],a=r[2],l=r[3],h=r[4],u=r[5],d=r[6];LSt(o,h,u,s,a,l,l,d);let c="";for(let f=0;f<o.length;f+=6)c+=`C${o[f]} ${o[f+1]} ${o[f+2]} ${o[f+3]} ${o[f+4]} ${o[f+5]}`;return c},i[ue.R]=r=>`M${r[1]} ${r[2]} h${r[3]} v${r[4]} H${r[1]}Z`,i[ue.Z]=r=>"Z",this.toStringCbList=i}const t=this.toStringCbList;let e="";return this.commandList.forEach(i=>{e+=t[i[0]](i)}),e}fromString(t,e,i,r,o){this.clear();const s=PSt(t);return this._runCommandStrList(s,e,i,r,o),this._updateBounds(),this}fromLine(t){const{points:e,curveType:i,clipRangeByDimension:r}=t.attribute;if(!e)return;const o=Md(e,i);r==="x"?this.direction=ze.ROW:r==="y"?this.direction=ze.COLUMN:r==="auto"&&(this.direction=o.direction),this._curves=o.curves}fromCustomPath2D(t,e,i,r,o){return this.clear(),this._runCommandList(t.commandList,e,i,r,o),this._updateBounds(),this}transform(t,e,i,r){const o=this.commandList;if(!this.transformCbList){const s=[];s[ue.M]=this.moveToTransform,s[ue.L]=this.lineToTransform,s[ue.Q]=this.quadraticCurveToTransform,s[ue.C]=this.bezierCurveToTransform,s[ue.AT]=this.arcToTransform,s[ue.E]=this.ellipseTransform,s[ue.R]=this.rectTransform,s[ue.A]=this.arcTransform,s[ue.Z]=this.closePathTransform,this.transformCbList=s}o.forEach(s=>{this.transformCbList[s[0]](s,t,e,i,r)}),this._updateBounds()}moveToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i}lineToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i}quadraticCurveToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r+e,t[4]=t[4]*o+i}bezierCurveToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r+e,t[4]=t[4]*o+i,t[5]=t[5]*r+e,t[6]=t[6]*o+i}arcToTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r+e,t[4]=t[4]*o+i,t[5]=t[5]*(r+o)/2}ellipseTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r,t[4]=t[4]*o}rectTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*r,t[4]=t[4]*o}arcTransform(t,e,i,r,o){t[1]=t[1]*r+e,t[2]=t[2]*o+i,t[3]=t[3]*(r+o)/2}closePathTransform(){}_runCommandStrList(t,e=0,i=0,r=1,o=1){let s,a,l,h,u,d=null,c=0,f=0,g=0,p=0;for(let v=0,m=t.length;v<m;++v){switch(s=t[v],r===1&&o===1||(s=rAt(s,r,o)),s[0]){case"l":c+=s[1],f+=s[2],this.lineTo(c+e,f+i);break;case"L":c=s[1],f=s[2],this.lineTo(c+e,f+i);break;case"h":c+=s[1],this.lineTo(c+e,f+i);break;case"H":c=s[1],this.lineTo(c+e,f+i);break;case"v":f+=s[1],this.lineTo(c+e,f+i);break;case"V":f=s[1],this.lineTo(c+e,f+i);break;case"m":c+=s[1],f+=s[2],this.moveTo(c+e,f+i);break;case"M":c=s[1],f=s[2],this.moveTo(c+e,f+i);break;case"c":a=c+s[5],l=f+s[6],g=c+s[3],p=f+s[4],this.bezierCurveTo(c+s[1]+e,f+s[2]+i,g+e,p+i,a+e,l+i),c=a,f=l;break;case"C":c=s[5],f=s[6],g=s[3],p=s[4],this.bezierCurveTo(s[1]+e,s[2]+i,g+e,p+i,c+e,f+i);break;case"s":a=c+s[3],l=f+s[4],d[0].match(/[CcSs]/)===null?(g=c,p=f):(g=2*c-g,p=2*f-p),h=c+s[1],u=f+s[2],this.bezierCurveTo(g+e,p+i,h+e,u+i,a+e,l+i),g=h,p=u,c=a,f=l;break;case"S":a=s[3],l=s[4],d[0].match(/[CcSs]/)===null?(g=c,p=f):(g=2*c-g,p=2*f-p),h=s[1],u=s[2],this.bezierCurveTo(g+e,p+i,h+e,u+i,a+e,l+i),g=h,p=u,c=a,f=l;break;case"q":a=c+s[3],l=f+s[4],g=c+s[1],p=f+s[2],this.quadraticCurveTo(g+e,p+i,a+e,l+i),c=a,f=l;break;case"Q":a=s[3],l=s[4],this.quadraticCurveTo(s[1]+e,s[2]+i,a+e,l+i),c=a,f=l,g=s[1],p=s[2];break;case"t":a=c+s[1],l=f+s[2],d[0].match(/[QqTt]/)===null?(g=c,p=f):d[0]==="t"?(g=2*c-h,p=2*f-u):d[0]==="q"&&(g=2*c-g,p=2*f-p),h=g,u=p,this.quadraticCurveTo(g+e,p+i,a+e,l+i),c=a,f=l,g=c+s[1],p=f+s[2];break;case"T":a=s[1],l=s[2],g=2*c-g,p=2*f-p,this.quadraticCurveTo(g+e,p+i,a+e,l+i),c=a,f=l;break;case"a":p5(this,c+e,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+c+e,s[7]+f+i]),c+=s[6],f+=s[7];break;case"A":p5(this,c+e,f+i,[s[1],s[2],s[3],s[4],s[5],s[6]+e,s[7]+i]),c=s[6],f=s[7];break;case"z":case"Z":this.closePath()}d=s}}_runCommandList(t,e=0,i=0,r=1,o=1){if(e!==0||i!==0||r!==1||o!==1)for(let s=0,a=t.length;s<a;++s){const l=t[s].slice();switch(l[0]){case ue.L:this.lineToTransform(l,e,i,r,o);break;case ue.M:this.moveToTransform(l,e,i,r,o);break;case ue.C:this.bezierCurveToTransform(l,e,i,r,o);break;case ue.Q:this.quadraticCurveToTransform(l,e,i,r,o);break;case ue.A:this.arcToTransform(l,e,i,r,o);break;case ue.E:this.ellipseTransform(l,e,i,r,o);break;case ue.R:this.rectTransform(l,e,i,r,o);break;case ue.AT:this.arcToTransform(l,e,i,r,o);break;case ue.Z:this.closePath()}}else this.commandList=t.map(s=>s.slice())}_updateBounds(){this.bounds.clear(),Xl(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===ze.COLUMN){if(!this._curves.length)return 0;const t=this._curves[0],e=this._curves[this._curves.length-1];return De(t.p0.y-e.p1.y)}if(this.direction===ze.ROW){if(!this._curves.length)return 0;const t=this._curves[0],e=this._curves[this._curves.length-1];return De(t.p0.x-e.p1.x)}return this._curves.reduce((t,e)=>t+e.getLength(),0)}getYAt(t){if(!this.curves)return 1/0;for(let e=0;e<this.curves.length;e++){const i=this.curves[e];if(i.includeX(t))return i.getYAt(t)}return 1/0}getAttrAt(t){if(!this._curves)return{pos:{x:0,y:0},angle:0};let e,i=0;for(let o=0;o<this._curves.length;o++){e=this._curves[o];const s=e.getLength(this.direction);if(i+s>=t)break;i+=s}const r=(t-i)/e.getLength(this.direction);return{pos:e.getPointAt(r),angle:e.getAngleAt(r)}}drawWithClipRange(t,e,i,r,o){this.tryBuildCurves();const s=this.getLength()*o;let a=0;for(let l=0;l<this._curves.length;l++){const h=this._curves[l],u=h.getLength(this.direction);if(!(a+u<=s)){const d=1-(a+u-s)/u;h.draw(t,i,r,e,e,d);break}h.draw(t,i,r,e,e,1),a+=u}}}const Eo=["l",0,0,0,0,0,0,0];function rAt(n,t,e){const i=Eo[0]=n[0];if(i==="a"||i==="A")Eo[1]=t*n[1],Eo[2]=e*n[2],Eo[3]=n[3],Eo[4]=n[4],Eo[5]=n[5],Eo[6]=t*n[6],Eo[7]=e*n[7];else if(i==="h"||i==="H")Eo[1]=t*n[1];else if(i==="v"||i==="V")Eo[1]=e*n[1];else for(let r=1,o=n.length;r<o;++r)Eo[r]=(r%2==1?t:e)*n[r];return Eo}const oAt={alignSelf:"auto"},Rn={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new mr},gK={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},RR={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},pK=Object.assign({outerBorder:Object.assign(Object.assign({},RR),{distance:0}),innerBorder:Object.assign(Object.assign({},RR),{distance:0})},RR),$r={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:`PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,
    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol`,fontWeight:"",ellipsis:"",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:$d.fontBounding,keepCenterInLine:!1},sAt={pickStrokeBuffer:0},aAt=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,autoAnimateTexture:!1,textureRatio:1,textureOptions:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,backgroundKeepAspectRatio:!1,backgroundClip:!0,backgroundScale:1,backgroundOffsetX:0,backgroundOffsetY:0,blur:0,filter:"",cursor:null,html:null,react:null,vue:null},gK),pK),oAt),sAt),vK={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},lAt={_debug_bounds:!1},Li=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1,clipConfig:null,roughStyle:null},lAt),aAt),Rn),hAt=Object.assign(Object.assign({},Li),{startAngle:0,endAngle:Zt,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),uAt=Object.assign(Object.assign(Object.assign({},Li),vK),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),dAt=Object.assign(Object.assign({},Li),{radius:1,startAngle:0,endAngle:Zt}),cAt=Object.assign(Object.assign({},Li),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1,cornerType:"round"}),fAt=Object.assign(Object.assign({},Li),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),gAt=Object.assign(Object.assign(Object.assign({},Li),vK),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),pAt=Object.assign(Object.assign({},Li),{path:new wn,fillStrokeOrder:1,clipRange:1,customPath:()=>{Ir.getInstance().warn("")}}),vAt=Object.assign(Object.assign({},Li),{points:[],cornerRadius:0,closePath:!0}),mAt=Object.assign(Object.assign({},Li),{width:100,height:100,spikes:5,thickness:.5}),yAt=Object.assign(Object.assign({},Li),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0,cornerType:"round",drawStrokeWhenZeroWH:!1});Object.assign(Object.assign({},Li),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0,cornerType:"round",drawStrokeWhenZeroWH:!1});const bAt=Object.assign(Object.assign({},Li),{symbolType:"circle",size:10,keepDirIn3d:!0,clipRange:1}),mK=Object.assign(Object.assign(Object.assign({},Li),$r),{strokeBoundsBuffer:0,keepDirIn3d:!0}),pl=Object.assign(Object.assign(Object.assign({},Li),$r),{upgradeAttrs:null,editable:!1,editOptions:null,ascentDescentMode:"actual",width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),Rm=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0,maxWidth:500,maxHeight:500},Li),{fill:!0,cornerRadius:0,cornerType:"round"}),_At=Object.assign(Object.assign({},Rm),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),CAt=function(){const n={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i};let t="";function e(_){const w=new Error(t+": "+_);throw w.source=t,w}function i(){const _=f(r);return t.length>0&&e("Invalid input not EOF"),_}function r(){return o("linear",n.linearGradient,s)||o("radial",n.radialGradient,l)||o("conic",n.conicGradient,a)}function o(_,w,C){return function(x,S){const A=y(x);if(A){y(n.startCall)||e("Missing (");const T=S(A);return y(n.endCall)||e("Missing )"),T}}(w,function(x){const S=C();return S&&(y(n.comma)||e("Missing comma before color stops")),{type:_,orientation:S,colorStops:f(g)}})}function s(){return m("directional",n.sideOrCorner,1)||m("angular",n.angleValue,1)}function a(){return m("angular",n.fromAngleValue,1)}function l(){let _,w,C=h();return C&&(_=[],_.push(C),w=t,y(n.comma)&&(C=h(),C?_.push(C):t=w)),_}function h(){let _=function(){const w=m("shape",/^(circle)/i,0);return w&&(w.style=v()||u()),w}()||function(){const w=m("shape",/^(ellipse)/i,0);return w&&(w.style=p()||u()),w}();if(_)_.at=d();else{const w=u();if(w){_=w;const C=d();C&&(_.at=C)}else{const C=c();C&&(_={type:"default-radial",at:C})}}return _}function u(){return m("extent-keyword",n.extentKeywords,1)}function d(){if(m("position",/^at/,0)){const _=c();return _||e("Missing positioning value"),_}}function c(){const _={x:p(),y:p()};if(_.x||_.y)return{type:"position",value:_}}function f(_){let w=_();const C=[];if(w)for(C.push(w);y(n.comma);)w=_(),w?C.push(w):e("One extra comma");return C}function g(){const _=m("hex",n.hexColor,1)||m("rgba",n.rgbaColor,1)||m("rgb",n.rgbColor,1)||m("literal",n.literalColor,0);return _||e("Expected color definition"),_.length=p(),_}function p(){return m("%",n.percentageValue,1)||m("position-keyword",n.positionKeywords,1)||v()}function v(){return m("px",n.pixelValue,1)||m("em",n.emValue,1)}function m(_,w,C){const x=y(w);if(x)return{type:_,value:x[C]}}function y(_){const w=/^[\n\r\t\s]+/.exec(t);w&&b(w[0].length);const C=_.exec(t);return C&&b(C[0].length),C}function b(_){t=t.substr(_)}return function(_){return t=_.toString(),i()}}();class ml{static IsGradient(t){return!(typeof t=="string"&&!t.includes("gradient"))}static IsGradientStr(t){return typeof t=="string"&&t.includes("gradient")}static Parse(t){if(ml.IsGradientStr(t))try{const e=CAt(t)[0];if(e){if(e.type==="linear")return ml.ParseLinear(e);if(e.type==="radial")return ml.ParseRadial(e);if(e.type==="conic")return ml.ParseConic(e)}}catch{return t}return t}static processColorStops(t){if(!t||t.length===0)return[];if(t.some(e=>e.length)){const e=t.map(i=>({color:i.value,offset:i.length?parseFloat(i.length.value)/100:-1}));e[0].offset<0&&(e[0].offset=0),e[e.length-1].offset<0&&(e[e.length-1].offset=1);for(let i=1;i<e.length-1;i++)if(e[i].offset<0){const r=i-1;let o=i+1;for(;o<e.length&&e[o].offset<0;)o++;const s=e[r].offset,a=e[o].offset,l=o-r;for(let h=1;h<l;h++)e[r+h].offset=s+(a-s)*h/l;i=o-1}return e}return t.map((e,i)=>{const r=t.length>1?i/(t.length-1):0;return{color:e.value,offset:r}})}static ParseConic(t){const{orientation:e,colorStops:i=[]}=t,r=Fi/2,o=parseFloat(e.value)/180*Fi-r;return{gradient:"conical",x:.5,y:.5,startAngle:o,endAngle:o+Zt,stops:ml.processColorStops(i)}}static ParseRadial(t){const{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:ml.processColorStops(e)}}static ParseLinear(t){const{orientation:e,colorStops:i=[]}=t,r=Fi/2;let o=e.type==="angular"?parseFloat(e.value)/180*Fi:0;for(;o<0;)o+=Zt;for(;o>=Zt;)o-=Zt;let s=0,a=0,l=0,h=0;return o<r?(s=0,a=1,l=Math.sin(o),h=a-Math.cos(o)):o<Fi?(s=0,a=0,l=Math.cos(o-r),h=Math.sin(o-r)):o<Fi+r?(s=1,a=0,l=s-Math.sin(o-Fi),h=Math.cos(o-Fi)):(s=1,l=s-Math.cos(o-r-Fi),h-=Math.sin(o-r-Fi)),{gradient:"linear",x0:s,y0:a,x1:l,y1:h,stops:ml.processColorStops(i)}}}function Ka(n,t,e){let i=t;const{a:r,b:o,c:s,d:a}=n.currentMatrix,l=Math.sign(r)*Math.sqrt(r*r+o*o),h=Math.sign(a)*Math.sqrt(s*s+a*a);return l+h===0?0:(i=i/Math.abs(l+h)*2*e,i)}function Vw(n,t,e,i=0,r=0){var o,s,a,l;if(!t||t===!0)return"black";let h,u;if(ke(t))for(let d=0;d<t.length&&(u=t[d],!u);d++);else u=t;if(u=ml.Parse(u),typeof u=="string")return u;if(e.AABBBounds&&(!e.attribute||e.attribute.scaleX!==0||e.attribute.scaleY!==0)){const d=e.AABBBounds;let c=d.x2-d.x1,f=d.y2-d.y1,g=d.x1-i,p=d.y1-r;if(e.attribute){const{scaleX:v=1,scaleY:m=1,angle:y=0}=e.attribute;c/=v,f/=m,g/=v,p/=m,(y||v!==1||m!==1)&&(g=(o=e.x1WithoutTransform)!==null&&o!==void 0?o:0,p=(s=e.y1WithoutTransform)!==null&&s!==void 0?s:0,c=(a=e.widthWithoutTransform)!==null&&a!==void 0?a:c,f=(l=e.heightWithoutTransform)!==null&&l!==void 0?l:f)}u.gradient==="linear"?h=wAt(n,u,g,p,c,f):u.gradient==="conical"?h=SAt(n,u,g,p,c,f):u.gradient==="radial"&&(h=xAt(n,u,g,p,c,f))}return h||"orange"}function wAt(n,t,e,i,r,o){var s,a,l,h;const u=n.createLinearGradient(e+((s=t.x0)!==null&&s!==void 0?s:0)*r,i+((a=t.y0)!==null&&a!==void 0?a:0)*o,e+((l=t.x1)!==null&&l!==void 0?l:1)*r,i+((h=t.y1)!==null&&h!==void 0?h:0)*o);return t.stops.forEach(d=>{u.addColorStop(d.offset,d.color)}),u}function xAt(n,t,e,i,r,o){var s,a,l,h,u,d;const c=n.createRadialGradient(e+((s=t.x0)!==null&&s!==void 0?s:.5)*r,i+((a=t.y0)!==null&&a!==void 0?a:.5)*o,Math.max(r,o)*((l=t.r0)!==null&&l!==void 0?l:0),e+((h=t.x1)!==null&&h!==void 0?h:.5)*r,i+((u=t.y1)!==null&&u!==void 0?u:.5)*o,Math.max(r,o)*((d=t.r1)!==null&&d!==void 0?d:.5));return t.stops.forEach(f=>{c.addColorStop(f.offset,f.color)}),c}function SAt(n,t,e,i,r,o){var s,a;const l=n.createConicGradient(e+((s=t.x)!==null&&s!==void 0?s:0)*r,i+((a=t.y)!==null&&a!==void 0?a:0)*o,t.startAngle,t.endAngle);return t.stops.forEach(h=>{l.addColorStop(h.offset,h.color)}),l.GetPattern?l.GetPattern(r+e,o+i,void 0):l}const OO={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},yK={fill:!0,stroke:!1},Gw=/\w|\(|\)|-/,bK=/[.?!,;:/]/,AAt=/\S/,_K=(n,t)=>{let e=t.fontSize||16;switch(t.script){case"super":case"sub":e*=.8}n.setTextStyle({textAlign:"left",textBaseline:t.textBaseline||"alphabetic",fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||"",fontSize:e,fontFamily:t.fontFamily})};function TAt(n,t,e){const i=t&&t.fill||yK.fill,{fillOpacity:r=1,opacity:o=1}=t;n.globalAlpha=r*o,n.fillStyle=e?Vw(n,i,{AABBBounds:e}):i,_K(n,t)}function MAt(n,t){const e=t&&t.stroke||yK.stroke;if(!e)return void(n.globalAlpha=0);const{strokeOpacity:i=1,opacity:r=1}=t;n.globalAlpha=i*r,n.lineWidth=t&&typeof t.lineWidth=="number"?t.lineWidth:1,n.strokeStyle=e,_K(n,t)}function uC(n,t,e,i,r){if(n.length<=1||!t||t<=0)return 0;const o=bt.graphicUtil.textMeasure;let s=i,a=n.slice(0,s),l=Math.floor(o.measureText(a,e).width),h=n.slice(0,s+1),u=Math.floor(o.measureText(h,e).width);for(;l>t||u<=t;){if(l>t?s--:s++,s>n.length){s=n.length;break}if(s<0){s=0;break}a=n.slice(0,s),l=Math.floor(o.measureText(a,e).width),h=n.slice(0,s+1),u=Math.floor(o.measureText(h,e).width)}return r&&(s=dC(n,s)),s}function dC(n,t,e=!1){let i=t;for(;Gw.test(n[i-1])&&Gw.test(n[i])||bK.test(n[i]);)if(i--,i<=0)return e?RAt(n,t):t;return i}function RAt(n,t){let e=t;for(;Gw.test(n[e+1])&&Gw.test(n[e])||bK.test(n[e]);)if(e++,e>=n.length)return e;return e+1}function pd(n,t,e="actual"){var i;if(n==="")return{ascent:0,height:0,descent:0,width:0};const r=bt.graphicUtil.textMeasure.measureText(n,t),o={ascent:0,height:0,descent:0,width:0},s=e==="actual"?r.actualBoundingBoxAscent:r.fontBoundingBoxAscent,a=e==="actual"?r.actualBoundingBoxDescent:r.fontBoundingBoxDescent;typeof s!="number"||typeof a!="number"?(o.width=Math.floor(r.width),o.height=t.fontSize||0,o.ascent=o.height,o.descent=0):(o.width=Math.floor(r.width),o.height=Math.floor(s+a),o.ascent=Math.floor(s),o.descent=o.height-o.ascent);const l=(i=t.space)!==null&&i!==void 0?i:0;return o.width+=l,o}var BAt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let MP=class{constructor(){this.id="ATextMeasure"}configure(n,t){this.canvas=n.canvas,this.context=n.context,n.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(n,t,e){this.context.setTextStyleWithoutAlignBaseline(t);const i=this.context.measureText(n);return e?this.compatibleMetrics(i,t):i}_measureTextWithAlignBaseline(n,t,e){this.context.setTextStyle(t);const i=this.context.measureText(n);return e?this.compatibleMetrics(i,t):i}compatibleMetrics(n,t){if(n.actualBoundingBoxAscent==null||n.actualBoundingBoxDescent==null||n.fontBoundingBoxAscent==null||n.fontBoundingBoxDescent==null){n={width:n.width};const{ascent:e,descent:i}=this.measureTextBoundADscentEstimate(t);n.actualBoundingBoxAscent=e,n.actualBoundingBoxDescent=i,n.fontBoundingBoxAscent=e,n.fontBoundingBoxDescent=i}if(n.actualBoundingBoxLeft==null||n.actualBoundingBoxRight==null){n={width:n.width,actualBoundingBoxAscent:n.actualBoundingBoxAscent,actualBoundingBoxDescent:n.actualBoundingBoxDescent,fontBoundingBoxAscent:n.fontBoundingBoxAscent,fontBoundingBoxDescent:n.fontBoundingBoxDescent};const{left:e,right:i}=this.measureTextBoundLeftRightEstimate(t);n.actualBoundingBoxLeft=e,n.actualBoundingBoxRight=i}return n}estimate(n,{fontSize:t=mK.fontSize}){let e=0,i=0;for(let r=0;r<n.length;r++)n.charCodeAt(r)<128?e++:i++;return{width:~~(.8*e*t+i*t),height:t}}measureTextWidth(n,t,e){return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t)).width:this.estimate(n,t).width}measureTextBoundsWidth(n,t,e){return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t)).width:this.estimate(n,t).width}measureTextBoundsLeftRight(n,t,e){return this.context?{left:(e=e??this._measureTextWithAlignBaseline(n,t,!0)).actualBoundingBoxLeft,right:e.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(t)}measureTextPixelHeight(n,t,e){var i;return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t,!0),Math.abs(e.actualBoundingBoxAscent-e.actualBoundingBoxDescent)):(i=t.fontSize)!==null&&i!==void 0?i:$r.fontSize}measureTextPixelADscent(n,t,e){return this.context?{ascent:(e=e??this._measureTextWithAlignBaseline(n,t,!0)).actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundHieght(n,t,e){var i;return this.context?(e=e??this._measureTextWithoutAlignBaseline(n,t,!0),Math.abs(e.fontBoundingBoxAscent-e.fontBoundingBoxDescent)):(i=t.fontSize)!==null&&i!==void 0?i:$r.fontSize}measureTextBoundADscent(n,t,e){return this.context?{ascent:(e=e??this._measureTextWithAlignBaseline(n,t,!0)).fontBoundingBoxAscent,descent:e.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundADscentEstimate(n){var t;const e=(t=n.fontSize)!==null&&t!==void 0?t:$r.fontSize;return{ascent:.79*e,descent:.21*e}}measureTextBoundLeftRightEstimate(n){var t;const e=(t=n.fontSize)!==null&&t!==void 0?t:$r.fontSize,{textAlign:i}=n;return i==="center"?{left:e/2,right:e/2}:i==="right"||i==="end"?{left:e,right:0}:{left:0,right:e}}measureTextPixelADscentAndWidth(n,t,e){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:this.estimate(n,t).width});const i=this._measureTextWithoutAlignBaseline(n,t,!0);if(e===$d.actualBounding)return{ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,width:i.width};if(e===$d.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:i.width});if(e===$d.fontBounding){let r=i.fontBoundingBoxAscent,o=i.fontBoundingBoxDescent;if(i.actualBoundingBoxDescent&&o<i.actualBoundingBoxDescent){const s=i.actualBoundingBoxDescent-o;o+=s,r-=s}else if(i.actualBoundingBoxAscent&&r<i.actualBoundingBoxAscent){const s=i.actualBoundingBoxAscent-r;r+=s,o-=s}return{ascent:r,descent:o,width:i.width}}return{ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,width:i.width}}measureText(n,t){return this.context?(this.context.setTextStyleWithoutAlignBaseline(t),this.context.measureText(n)):this.estimate(n,t)}clipTextVertical(n,t,e,i){if(n.length===0)return{verticalList:n,width:0};const{fontSize:r=12}=t;n.forEach(l=>{l.width=l.direction===0?r:this.measureTextWidth(l.text,t)});const o=[];let s=0,a=0;for(;a<n.length&&s+n[a].width<e;a++)s+=n[a].width,o.push(n[a]);if(n[a]&&n[a].text.length>1){const l=this._clipText(n[a].text,t,e-s,0,n[a].text.length-1,"end",!1);if(i&&l.str!==n[a].text){let h="",u=0;for(let f=0;f<a;f++){const g=n[f];h+=g.text,u+=g.text.length}h+=n[a].text;const d=u+l.str.length;let c=dC(h,d);c-=u,c!==l.str.length-1&&(l.str=l.str.substring(0,c),l.width=this.measureTextWidth(l.str,t))}o.push(Object.assign(Object.assign({},n[a]),{text:l.str,width:l.width})),s+=l.width}return{verticalList:o,width:s}}clipText(n,t,e,i,r){if(n.length===0)return{str:"",width:0};let o=this.measureTextWidth(n,t);if(o<=e)return{str:n,width:o};if(o=this.measureTextWidth(n[0],t),o>e)return{str:"",width:0};const s=this._clipText(n,t,e,0,n.length-1,"end",!1);if(i&&s.str!==n){let a=dC(n,s.str.length,r);a!==s.str.length&&(a>s.str.length&&(s.wordBreaked=a,a=s.str.length),s.str=n.substring(0,a),s.width=this.measureTextWidth(s.str,t))}return s}_clipText(n,t,e,i,r,o,s){let a;if(o==="start")a=this._clipTextStart(n,t,e,i,r),s&&(a.result=s+a.str);else if(o==="middle"){const l=this._clipTextMiddle(n,t,e,"","",0,0,1);a={str:"none",width:l.width,result:l.left+s+l.right}}else a=this._clipTextEnd(n,t,e,i,r),s&&(a.result=a.str+s);return a}_clipTextEnd(n,t,e,i,r){if(i===r){Ir.getInstance().warn(`_clipTextEnd${n}, ${i}, ${r}`);const h=n.substring(0,r+1);return{str:h,width:this.measureTextWidth(h,t)}}const o=Math.floor((i+r)/2),s=n.substring(0,o+1),a=this.measureTextWidth(s,t);let l;if(a>e){if(s.length<=1)return{str:"",width:0};const h=n.substring(0,o);return l=this.measureTextWidth(h,t),l<=e?{str:h,width:l}:this._clipTextEnd(n,t,e,i,o)}if(a<e){if(o>=n.length-1)return{str:n,width:this.measureTextWidth(n,t)};const h=n.substring(0,o+2);return l=this.measureTextWidth(h,t),l>=e?{str:s,width:a}:this._clipTextEnd(n,t,e,o,r)}return{str:s,width:a}}_clipTextStart(n,t,e,i,r){const o=Math.ceil((i+r)/2),s=n.substring(o-1,n.length),a=this.measureTextWidth(s,t);let l;if(a>e){if(s.length<=1)return{str:"",width:0};const h=n.substring(o,n.length);return l=this.measureTextWidth(h,t),l<=e?{str:h,width:l}:this._clipTextStart(n,t,e,o,n.length)}if(a<e){if(o<=0)return{str:n,width:this.measureTextWidth(n,t)};const h=n.substring(o-2,n.length);return l=this.measureTextWidth(h,t),l>=e?{str:s,width:a}:this._clipTextStart(n,t,e,i,o)}return{str:s,width:a}}_clipTextMiddle(n,t,e,i,r,o,s,a){const l=n.substring(0,a),h=this.measureTextWidth(l,t);if(h+s>e)return{left:i,right:r,width:o+s};const u=n.substring(n.length-a,n.length),d=this.measureTextWidth(u,t);return h+d>e?{left:l,right:r,width:h+s}:this._clipTextMiddle(n,t,e,l,u,h,d,a+1)}clipTextWithSuffixVertical(n,t,e,i,r,o){if(i==="")return this.clipTextVertical(n,t,e,r);if(n.length===0)return{verticalList:n,width:0};const s=this.clipTextVertical(n,t,e,r);if(s.verticalList.length===n.length&&s.verticalList[s.verticalList.length-1].width===n[n.length-1].width)return s;const a=this.measureTextWidth(i,t);if(a>e)return s;let l;if(e-=a,o==="start"){const h=this.revertVerticalList(n);l=this.clipTextVertical(h,t,e,r);const u=this.revertVerticalList(l.verticalList);u.unshift({text:i,direction:1,width:a}),l.verticalList=u}else if(o==="middle"){const h=this.clipTextVertical(n,t,e/2,r),u=this.revertVerticalList(n),d=this.clipTextVertical(u,t,e/2,r);h.verticalList.push({text:i,direction:1,width:a}),this.revertVerticalList(d.verticalList).forEach(c=>h.verticalList.push(c)),l={verticalList:h.verticalList,width:h.width+d.width}}else l=this.clipTextVertical(n,t,e,r),l.verticalList.push({text:i,direction:1,width:a});return l.width+=a,l}revertVerticalList(n){return n.reverse().map(t=>{const e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(n,t,e,i,r,o,s=!1){if(i==="")return this.clipText(n,t,e,r);if(n.length===0)return{str:"",width:0};const a=this.measureTextWidth(n,t);if(!s&&a<=e)return{str:n,width:a};const l=this.measureTextWidth(i,t);if(l>e)return{str:"",width:0};if(s&&a+l<=e)return{str:n+i,width:a+l};e-=l;const h=this._clipText(n,t,e,0,n.length-1,o,i);if(r&&h.str!==n){const u=dC(n,h.str.length);u!==h.str.length&&(h.result=n.substring(0,u),h.width=this.measureTextWidth(h.str,t))}else s&&h.str===n&&(h.result=n+i);return h.str=h.result,h.width+=l,h}};MP=BAt([yt()],MP);var PAt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};const Hl=Symbol.for("TextMeasureContribution");let qg=class extends MP{constructor(){super(...arguments),this.id="DefaultTextMeasureContribution"}};qg=PAt([yt()],qg);const CK=Symbol.for("CanvasFactory"),kAt=Symbol.for("Context2dFactory");function RP(n){return Nt.getNamed(CK,bt.global.env)(n)}const wK=1e-4,x5=Math.sqrt(3),i_=1/3;function Ih(n){return n>-Bm&&n<Bm}function xK(n){return n>Bm||n<-Bm}const Ta=[0,0],Qo=[0,0],qf=[0,0];function Zf(n,t){return(n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])}function _l(n,t,e,i){const r=1-i;return r*(r*n+2*i*t)+i*i*e}function Cl(n,t,e,i,r){const o=1-r;return o*o*(o*n+3*r*t)+r*r*(r*i+3*o*e)}function EAt(n,t,e,i,r){const o=n-2*t+e,s=2*(t-n),a=n-i;let l=0;if(Ih(o)){if(xK(s)){const h=-a/s;h>=0&&h<=1&&(r[l++]=h)}}else{const h=s*s-4*o*a;if(Ih(h)){const u=-s/(2*o);u>=0&&u<=1&&(r[l++]=u)}else if(h>0){const u=Math.sqrt(h),d=(-s+u)/(2*o),c=(-s-u)/(2*o);d>=0&&d<=1&&(r[l++]=d),c>=0&&c<=1&&(r[l++]=c)}}return l}function LAt(n,t,e){const i=n+e-2*t;return i===0?.5:(n-t)/i}function OAt(n,t,e,i,r,o,s,a,l){let h=0,u=.005,d=1/0;Ta[0]=s,Ta[1]=a;for(let c=0;c<1;c+=.05){Qo[0]=_l(n,e,r,c),Qo[1]=_l(t,i,o,c);const f=Zf(Ta,Qo);f<d&&(h=c,d=f)}d=1/0;for(let c=0;c<32&&!(u<wK);c++){const f=h-u,g=h+u;Qo[0]=_l(n,e,r,f),Qo[1]=_l(t,i,o,f);const p=Zf(Qo,Ta);if(f>=0&&p<d)h=f,d=p;else{qf[0]=_l(n,e,r,g),qf[1]=_l(t,i,o,g);const v=Zf(qf,Ta);g<=1&&v<d?(h=g,d=v):u*=.5}}return Math.sqrt(d)}function DAt(n,t,e,i,r,o,s,a,l,h,u){let d,c,f,g,p=0,v=.005,m=1/0;Ta[0]=l,Ta[1]=h;for(let y=0;y<1;y+=.05)Qo[0]=Cl(n,e,r,s,y),Qo[1]=Cl(t,i,o,a,y),f=Zf(Ta,Qo),f<m&&(p=y,m=f);m=1/0;for(let y=0;y<32&&!(v<wK);y++)d=p-v,c=p+v,Qo[0]=Cl(n,e,r,s,d),Qo[1]=Cl(t,i,o,a,d),f=Zf(Qo,Ta),d>=0&&f<m?(p=d,m=f):(qf[0]=Cl(n,e,r,s,c),qf[1]=Cl(t,i,o,a,c),g=Zf(qf,Ta),c<=1&&g<m?(p=c,m=g):v*=.5);return Math.sqrt(m)}function n_(n){return(n%=Zt)<0&&(n+=Zt),n}function IAt(n,t,e,i,r,o,s,a,l){if(s===0)return!1;const h=s;return l>t+h&&l>i+h&&l>o+h||l<t-h&&l<i-h&&l<o-h||a>n+h&&a>e+h&&a>r+h||a<n-h&&a<e-h&&a<r-h?!1:OAt(n,t,e,i,r,o,a,l)<=h/2}function HAt(n,t,e,i,r,o,s,a,l,h,u){if(l===0)return!1;const d=l;return u>t+d&&u>i+d&&u>o+d&&u>a+d||u<t-d&&u<i-d&&u<o-d&&u<a-d||h>n+d&&h>e+d&&h>r+d&&h>s+d||h<n-d&&h<e-d&&h<r-d&&h<s-d?!1:DAt(n,t,e,i,r,o,s,a,h,u)<=d/2}function FAt(n,t,e,i,r,o,s,a,l){if(s===0)return!1;const h=s;a-=n,l-=t;const u=Math.sqrt(a*a+l*l);if(u-h>e||u+h<e)return!1;if(Math.abs(i-r)%Zt<1e-4)return!0;if(o){const c=i;i=n_(r),r=n_(c)}else i=n_(i),r=n_(r);i>r&&(r+=Zt);let d=Math.atan2(l,a);return d<0&&(d+=Zt),d>=i&&d<=r||d+Zt>=i&&d+Zt<=r}function ef(n,t,e,i,r,o,s){if(r===0)return!1;const a=r,l=r/2;let h=0,u=n;if(s>t+l&&s>i+l||s<t-l&&s<i-l||o>n+l&&o>e+l||o<n-l&&o<e-l)return!1;if(n===e)return Math.abs(o-n)<=a/2;h=(t-i)/(n-e),u=(n*i-e*t)/(n-e);const d=h*o-s+u;return d*d/(h*h+1)<=a/2*a/2}const Bm=1e-4;function zAt(n,t,e,i,r,o){const s=i+3*(t-e)-n,a=3*(e-2*t+n),l=3*(t-n),h=n-r,u=a*a-3*s*l,d=a*l-9*s*h,c=l*l-3*a*h;let f=0;if(Ih(u)&&Ih(d))if(Ih(a))o[0]=0;else{const g=-l/a;g>=0&&g<=1&&(o[f++]=g)}else{const g=d*d-4*u*c;if(Ih(g)){const p=d/u,v=-a/s+p,m=-p/2;v>=0&&v<=1&&(o[f++]=v),m>=0&&m<=1&&(o[f++]=m)}else if(g>0){const p=Math.sqrt(g);let v=u*a+1.5*s*(-d+p),m=u*a+1.5*s*(-d-p);v=v<0?-Math.pow(-v,i_):Math.pow(v,i_),m=m<0?-Math.pow(-m,i_):Math.pow(m,i_);const y=(-a-(v+m))/(3*s);y>=0&&y<=1&&(o[f++]=y)}else{const p=(2*u*a-3*s*d)/(2*Math.sqrt(u*u*u)),v=Math.acos(p)/3,m=Math.sqrt(u),y=Math.cos(v),b=(-a-2*m*y)/(3*s),_=(-a+m*(y+x5*Math.sin(v)))/(3*s),w=(-a+m*(y-x5*Math.sin(v)))/(3*s);b>=0&&b<=1&&(o[f++]=b),_>=0&&_<=1&&(o[f++]=_),w>=0&&w<=1&&(o[f++]=w)}}return f}function NAt(n,t,e,i,r){const o=6*e-12*t+6*n,s=9*t+3*i-3*n-9*e,a=3*t-3*n;let l=0;if(Ih(s)){if(xK(o)){const h=-a/o;h>=0&&h<=1&&(r[l++]=h)}}else{const h=o*o-4*s*a;if(Ih(h))r[0]=-o/(2*s);else if(h>0){const u=Math.sqrt(h),d=(-o+u)/(2*s),c=(-o-u)/(2*s);d>=0&&d<=1&&(r[l++]=d),c>=0&&c<=1&&(r[l++]=c)}}return l}function WAt(n,t){return Math.abs(n-t)<Bm}const Tr=[-1,-1,-1],jo=[-1,-1];function VAt(){const n=jo[0];jo[0]=jo[1],jo[1]=n}function GAt(n,t,e,i,r,o,s,a,l,h){if(h>t&&h>i&&h>o&&h>a||h<t&&h<i&&h<o&&h<a)return 0;const u=zAt(t,i,o,a,h,Tr);if(u===0)return 0;let d=0,c=-1,f=0,g=0;for(let p=0;p<u;p++){const v=Tr[p],m=v===0||v===1?.5:1;Cl(n,e,r,s,v)<l||(c<0&&(c=NAt(t,i,o,a,jo),jo[1]<jo[0]&&c>1&&VAt(),f=Cl(t,i,o,a,jo[0]),c>1&&(g=Cl(t,i,o,a,jo[1]))),c===2?v<jo[0]?d+=f<t?m:-m:v<jo[1]?d+=g<f?m:-m:d+=a<g?m:-m:v<jo[0]?d+=f<t?m:-m:d+=a<f?m:-m)}return d}function $At(n,t,e,i,r,o,s,a){if(a>t&&a>i&&a>o||a<t&&a<i&&a<o)return 0;const l=EAt(t,i,o,a,Tr);if(l===0)return 0;const h=LAt(t,i,o);if(h>=0&&h<=1){let d=0;const c=_l(t,i,o,h);for(let f=0;f<l;f++){const g=Tr[f]===0||Tr[f]===1?.5:1;_l(n,e,r,Tr[f])<s||(Tr[f]<h?d+=c<t?g:-g:d+=o<c?g:-g)}return d}const u=Tr[0]===0||Tr[0]===1?.5:1;return _l(n,e,r,Tr[0])<s?0:o<t?u:-u}function jAt(n,t,e,i,r,o,s,a){if((a-=t)>e||a<-e)return 0;const l=Math.sqrt(e*e-a*a);Tr[0]=-l,Tr[1]=l;const h=Math.abs(i-r);if(h<1e-4)return 0;if(h>=Zt-1e-4){i=0,r=Zt;const d=o?1:-1;return s>=Tr[0]+n&&s<=Tr[1]+n?d:0}if(i>r){const d=i;i=r,r=d}i<0&&(i+=Zt,r+=Zt);let u=0;for(let d=0;d<2;d++){const c=Tr[d];if(c+n>s){let f=Math.atan2(a,c),g=o?1:-1;f<0&&(f=Zt+f),(f>=i&&f<=r||f+Zt>=i&&f+Zt<=r)&&(f>Fi/2&&f<1.5*Fi&&(g=-g),u+=g)}}return u}function BR(n){return Math.round(n/Fi*1e8)/1e8%2*Fi}function UAt(n,t){let e=BR(n[0]);e<0&&(e+=Zt);const i=e-n[0];let r=n[1];r+=i,!t&&r-e>=Zt?r=e+Zt:t&&e-r>=Zt?r=e-Zt:!t&&e>r?r=e+(Zt-BR(e-r)):t&&e<r&&(r=e-(Zt-BR(r-e))),n[0]=e,n[1]=r}const cv=[0,0];function SK(n,t,e,i,r){const o=n,s=n.length;let a,l,h=0,u=0,d=0,c=0,f=0;for(let g=0;g<s;g++){const p=o[g],v=g===0;p[0]===ue.M&&g>1&&(e||(h+=Gu(u,d,c,f,i,r))),v&&(u=p[1],d=p[2],c=u,f=d);const m=p[0],y=p[1],b=p[2],_=p[3],w=p[4],C=p[5],x=p[6];let S=w,A=C;cv[0]=S,cv[1]=A,UAt(cv,!!p[6]),S=cv[0],A=cv[1];const T=S,M=A-S,R=!!(1-(p[6]?0:1)),E=(i-y)*_/_+y;switch(m){case ue.M:c=y,f=b,u=c,d=f;break;case ue.L:if(e){if(ef(u,d,y,b,t,i,r))return!0}else h+=Gu(u,d,y,b,i,r)||0;u=y,d=b;break;case ue.C:if(e){if(HAt(u,d,y,b,_,w,C,x,t,i,r))return!0}else h+=GAt(u,d,y,b,_,w,C,x,i,r)||0;u=C,d=x;break;case ue.Q:if(e){if(IAt(u,d,y,b,_,w,t,i,r))return!0}else h+=$At(u,d,y,b,_,w,i,r)||0;u=_,d=w;break;case ue.A:if(a=Math.cos(T)*_+y,l=Math.sin(T)*_+b,v?(c=a,f=l):h+=Gu(u,d,a,l,i,r),e){if(FAt(y,b,_,T,T+M,R,t,E,r))return!0}else h+=jAt(y,b,_,T,T+M,R,E,r);u=Math.cos(T+M)*_+y,d=Math.sin(T+M)*_+b;break;case ue.R:if(c=u=y,f=d=b,a=c+_,l=f+w,e){if(ef(c,f,a,f,t,i,r)||ef(a,f,a,l,t,i,r)||ef(a,l,c,l,t,i,r)||ef(c,l,c,f,t,i,r))return!0}else h+=Gu(a,f,a,l,i,r),h+=Gu(c,l,c,f,i,r);break;case ue.Z:if(e){if(ef(u,d,c,f,t,i,r))return!0}else h+=Gu(u,d,c,f,i,r);u=c,d=f}}return e||WAt(d,f)||(h+=Gu(u,d,c,f,i,r)||0),h!==0}function XAt(n,t,e){return SK(n,0,!1,t,e)}function YAt(n,t,e,i){return SK(n,t,!0,e,i)}class KAt{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){const i=RP(Object.assign({nativeCanvas:bt.global.createCanvas(t)},t));return this.allocatedCanvas.push(i),i}const e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){const i={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},r=RP(Object.assign({nativeCanvas:bt.global.createCanvas(i)},i));return this.allocatedCanvas.push(r),r}const e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const jd=new KAt;var qAt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},ZAt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const Pm=Symbol.for("VWindow"),DO=Symbol.for("WindowHandlerContribution");let BP=class extends JY{get width(){if(this._handler){const n=this._handler.getWH();return this._width=n.width}return this._width}get height(){if(this._handler){const n=this._handler.getWH();return this._height=n.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){super(),this.hooks={onChange:new cr(["x","y","width","height"])},this.active=()=>{const n=this.global;!n.env||this.actived||(Nt.getNamed(DO,n.env).configure(this,n),this.actived=!0)},this._uid=nn.GenAutoIncrementId(),this.global=bt.global,this.postInit()}_nativeAddEventListener(n,t,e){return this._handler.addEventListener(n,t,e)}_nativeRemoveEventListener(n,t,e){return this._handler.removeEventListener(n,t,e)}_nativeDispatchEvent(n){return this._handler.dispatchEvent(n)}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var n;return(n=this._handler.getStyle())!==null&&n!==void 0?n:{}}set style(n){this._handler.setStyle(n)}create(n){var t,e;this._handler.createWindow(n);const i=this._handler.getWH();this._width=i.width,this._height=i.height,n.viewBox?this.setViewBox(n.viewBox):n.canvasControled!==!1?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:(t=n.width)!==null&&t!==void 0?t:this._width,y2:(e=n.height)!==null&&e!==void 0?e:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(n){this._handler=n}setDpr(n){return this._handler.setDpr(n)}resize(n,t){return this._handler.resizeWindow(n,t)}configure(){throw new Error("")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this.clearAllEventListeners(),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(n){return this._handler.getImageBuffer?this._handler.getImageBuffer(n):null}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(n){this._handler.clearViewBox(n)}setViewBox(n){this._handler.setViewBox(n)}setViewBoxTransform(n,t,e,i,r,o){this._handler.setViewBoxTransform(n,t,e,i,r,o)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(n,t){const e=this._handler.getViewBox(),i={x:n,y:t};return this._handler.getViewBoxTransform().transformPoint({x:n,y:t},i),i.x-=e.x1,i.y-=e.y1,i}hasSubView(){const n=this._handler.getViewBox();return!(n.x1===0&&n.y1===0&&i5(this.width,n.width())&&i5(this.height,n.height()))}isVisible(n){return this._handler.isVisible(n)}onVisibleChange(n){return this._handler.onVisibleChange(n)}getTopLeft(n){return this._handler.getTopLeft(n)}};BP=qAt([yt(),ZAt("design:paramtypes",[])],BP);var AK=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},TK=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},S5=function(n,t){return function(e,i){t(e,i,n)}};let PP=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(n){this.contributions=n,this.configured=!1,this.global=bt.global,this._textMeasureMap=new Map,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,i)=>{this.configured=!1,this.configure(i,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}getTextMeasureInstance(n){return n?this._textMeasureMap.get(n)||this.textMeasure:this.textMeasure}configure(n,t){this.configured||(this.contributions.getContributions().forEach(e=>{e.configure(this,t)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){const n=jd.shareCanvas();this._canvas=n,this._context=n.getContext("2d")}}bindTextMeasure(n){this._textMeasure&&n.id!=="DefaultTextMeasureContribution"||(this._textMeasure=n),this._textMeasureMap.has(n.id)||this._textMeasureMap.set(n.id,n)}measureText(n,t,e="native"){var i;this.configure(this.global,this.global.env);const r=this.global.measureTextMethod;this.global.measureTextMethod=e;const o={width:this._textMeasure.measureTextWidth(n,t),height:(i=t.fontSize)!==null&&i!==void 0?i:$r.fontSize};return this.global.measureTextMethod=r,o}createTextMeasureInstance(n,t,e){return this.configure(this.global,this.global.env),new Kf(Object.assign({defaultFontParams:{fontFamily:$r.fontFamily,fontSize:$r.fontSize},getCanvasForMeasure:e||(()=>this.canvas),getTextBounds:void 0,specialCharSet:`-/: .,@%'"~`+Kf.ALPHABET_CHAR_SET+Kf.ALPHABET_CHAR_SET.toUpperCase()},t??{}),n)}drawGraphicToCanvas(n,t,e){if(!t.defaultLayer)return null;const i=Nt.get(Pm),r=n.AABBBounds,o=r.width(),s=r.height(),a=-r.x1,l=-r.y1;i.create({viewBox:{x1:a,y1:l,x2:r.x2,y2:r.y2},width:o,height:s,canvas:e,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:""});const h=t.params.optimize.disableCheckGraphicWidthOutRange;t.params.optimize.disableCheckGraphicWidthOutRange=!0,t.defaultLayer.getNativeHandler().drawTo(i,[n],{transMatrix:i.getViewBoxTransform(),viewBox:i.getViewBox(),stage:t,layer:t.defaultLayer,renderService:t.renderService,background:"transparent",clear:!0,updateBounds:!1}),t.params.optimize.disableCheckGraphicWidthOutRange=h;const u=i.getNativeHandler();return u.nativeCanvas?u.nativeCanvas:null}};PP=AK([yt(),S5(0,le(Wi)),S5(0,mn(Hl)),TK("design:paramtypes",[Object])],PP);var xh;(function(n){n[n.transform=0]="transform",n[n.matrix=1]="matrix"})(xh||(xh={}));const on=new mr;let kP=class{constructor(){this.matrix=new mr}init(n){return this.mode=xh.transform,this.originTransform=n,this.matrix.reset(),this}fromMatrix(n,t){return this.mode=xh.matrix,this.outSourceMatrix=n,this.outTargetMatrix=t,this}scaleMatrix(n,t,e){const i=this.outSourceMatrix;if(on.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){const{x:r,y:o}=e;this.outTargetMatrix.translate(r,o),this.outTargetMatrix.scale(n,t),this.outTargetMatrix.translate(-r,-o)}else this.outTargetMatrix.scale(n,t);return this.outTargetMatrix.multiply(on.a,on.b,on.c,on.d,on.e,on.f),this}rotateMatrix(n,t){const e=this.outSourceMatrix;if(on.setValue(e.a,e.b,e.c,e.d,e.e,e.f),this.outTargetMatrix.reset(),t){const{x:i,y:r}=t;this.outTargetMatrix.translate(i,r),this.outTargetMatrix.rotate(n),this.outTargetMatrix.translate(-i,-r)}else this.outTargetMatrix.rotate(n);return this.outTargetMatrix.multiply(on.a,on.b,on.c,on.d,on.e,on.f),this}scale(n,t,e){return this.mode===xh.matrix?this.scaleMatrix(n,t,e):this}rotate(n,t){return this.mode===xh.matrix?this.rotateMatrix(n,t):this}translateMatrix(n,t){const e=this.outSourceMatrix;return on.setValue(e.a,e.b,e.c,e.d,e.e,e.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(n,t),this.outTargetMatrix.multiply(on.a,on.b,on.c,on.d,on.e,on.f),this}translate(n,t){return this.mode===xh.matrix?this.translateMatrix(n,t):this}simplify(n){return this.mode===xh.matrix?this.simplifyMatrix(n):this}simplifyMatrix(n){return this}};kP=AK([yt(),TK("design:paramtypes",[])],kP);const hr={arc:hAt,area:uAt,circle:dAt,line:gAt,path:pAt,symbol:bAt,text:mK,rect:yAt,polygon:vAt,star:mAt,richtext:pl,richtextIcon:_At,image:Rm,group:cAt,glyph:fAt},PR=Object.keys(hr);function JAt(){return{arc:Object.assign({},hr.arc),area:Object.assign({},hr.area),circle:Object.assign({},hr.circle),line:Object.assign({},hr.line),path:Object.assign({},hr.path),symbol:Object.assign({},hr.symbol),text:Object.assign({},hr.text),rect:Object.assign({},hr.rect),polygon:Object.assign({},hr.polygon),star:Object.assign({},hr.star),richtext:Object.assign({},hr.richtext),richtextIcon:Object.assign({},hr.richtextIcon),image:Object.assign({},hr.image),group:Object.assign({},hr.group),glyph:Object.assign({},hr.glyph)}}function r_(n,t){Object.keys(t).forEach(e=>{n[e]=t[e]})}const A5=JAt();class km{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},PR.forEach(t=>{this._defaultTheme[t]=Object.create(A5[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;let e={};const i=this.getParentWithTheme(t);return i&&(e=i.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,i=!1){if(this.dirty){const r=this.getParentWithTheme(t);if(r){const o=r.theme;(o.dirty||i)&&o.applyTheme(r,e,!0)}this.userTheme?this.doCombine(r&&r.theme.combinedTheme):(r?this.combinedTheme=r.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Ir.getInstance().warn("")),this.dirty=!1)}return this.combinedTheme}doCombine(t){const e=this.userTheme,i=this.combinedTheme;PR.forEach(r=>{const o=Object.create(A5[r]);t&&t[r]&&r_(o,t[r]),i[r]&&r_(o,i[r]),e[r]&&r_(o,e[r]),this.combinedTheme[r]=o}),e.common&&PR.forEach(r=>{r_(this.combinedTheme[r],e.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(r=>{i[r]?Object.assign(i[r],t[r]):i[r]=Object.assign({},t[r])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(e=>{e.isContainer&&(e.theme&&(e.theme.dirty=!0),this.dirtyChildren(e))})}}const MK=new km;function te(n,t){return n.glyphHost?te(n.glyphHost):t?(n.isContainer,t):QAt(n)||n.attachedThemeGraphic&&te(n.attachedThemeGraphic)||MK.getTheme()}function QAt(n){let t;if(t=n.isContainer?n:n.parent,t){for(;t&&!t.theme;)t=t.parent;return t?(t.theme||t.createTheme(),t.theme.getTheme(t)):MK.getTheme()}return null}var tTt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};let eTt=class extends Bc{get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=nn.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let i=this._lastChild,r=0;for(;i;){if(t(i,r++))return;i=i._prev}}else{let i=this._firstChild,r=0;for(;i;){if(t(i,r++))return;i=i._next}}}forEachChildrenAsync(t,e=!1){return tTt(this,void 0,void 0,function*(){if(e){let i=this._lastChild,r=0;for(;i;){let o=t(i,r++);if(o.then&&(o=yield o),o)return;i=i._prev}}else{let i=this._firstChild,r=0;for(;i;){let o=t(i,r++);if(o.then&&(o=yield o),o)return;i=i._next}}})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("Node::appendChildappend");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("Node::insertBeforeinsert");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("Node::insertAfterinsert");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&Ir.getInstance().warn("insertIntoKeepIdxinsertInto"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw new Error("Node::insertBeforeinsert");if(t.parent&&t.parent.removeChild(t),t.parent=this,e===0)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let i=this._firstChild;for(let r=0;r<e;r++){if(!i)return null;r>0&&(i=i._next)}if(!i)return null;t._next=i._next,t._prev=i,i._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){const o=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,o)}let i;this._nodeList[e]=t;for(let o=e-1;o>=0&&(i=this._nodeList[o],!i);o--);if(i)return i._next?this.insertBefore(t,i._next):this.appendChild(t);this._ignoreWarn=!0;const r=this.insertInto(t,0);return this._ignoreWarn=!1,r}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){const e=this._nodeList.findIndex(i=>i===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){const i=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=i}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw new Error("")}find(t,e=!1){let i=null;return this.forEachChildren((r,o)=>!(r===this||!t(r,o))&&(i=r,!0)),e&&this.forEachChildren(r=>{if(r.isContainer){const o=r.find(t,!0);if(o)return i=o,!0}return!1}),i}findAll(t,e=!1){let i=[];return this.forEachChildren((r,o)=>{r!==this&&t(r,o)&&i.push(r)}),e&&this.forEachChildren(r=>{if(r.isContainer){const o=r.findAll(t,!0);o.length&&(i=i.concat(o))}}),i}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(i=>i.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<t;i++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;t?.parent;)t=t.parent;return t||this}hasChildNodes(){return this._firstChild!==null}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){const t=[];let e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(e!==null);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw new Error("")}setAllDescendantsProps(t,e){let i=this._firstChild;for(;i;)i[t]=e,i.setAllDescendantsProps(t,e),i=i._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(e!==null)}clone(){throw new Error("")}cloneTo(t){throw new Error("")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,i){const r=Sm(i,!0)&&i||gd(i)&&i.capture,o=gd(i)&&i.once,s=Td(e)?void 0:e;return t=r?`${t}capture`:t,e=Td(e)?e:e.handleEvent,o?super.once(t,e,s):super.on(t,e,s),this}on(t,e,i){return this.addEventListener(t,e,i)}removeEventListener(t,e,i){const r=Sm(i,!0)&&i||gd(i)&&i.capture,o=Td(e)?void 0:e;t=r?`${t}capture`:t,e=Td(e)?e:e.handleEvent;const s=gd(i)&&i.once;return super.off(t,e,o,s),this}off(t,e,i){return this.removeEventListener(t,e,i)}once(t,e,i){return gd(i)?(i.once=!0,this.addEventListener(t,e,i)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}};class Ay{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Ay.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){const e=t.graphic;if(e.stage){const i=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(i),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch{this.nativeEvent.preventDefault&&Td(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch{this.nativeEvent.stopPropagation&&Td(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw new Error("Method not implemented.")}}class $w extends Ay{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,r,o,s,a,l,h,u,d,c,f,g,p){throw new Error("Method not implemented.")}}class so extends $w{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}clone(){var t,e,i;const r=new so(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,(t=this.manager)===null||t===void 0||t.copyPointerData(this,r),(e=this.manager)===null||e===void 0||e.copyMouseData(this,r),(i=this.manager)===null||i===void 0||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();const o=this.composedDetailPath();return r.detailPath=o&&o.slice(),r.type=this.type,r}}class Gh extends $w{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,i;const r=new Gh(this.manager);r.eventPhase=r.NONE,r.currentTarget=null,r.path=[],r.detailPath=[],r.target=null,r.nativeEvent=this.nativeEvent,r.originalEvent=this.originalEvent,(t=this.manager)===null||t===void 0||t.copyWheelData(this,r),(e=this.manager)===null||e===void 0||e.copyMouseData(this,r),(i=this.manager)===null||i===void 0||i.copyData(this,r),r.target=this.target,r.path=this.composedPath().slice();const o=this.composedDetailPath();return r.detailPath=o&&o.slice(),r.type=this.type,r}}Gh.DOM_DELTA_PIXEL=0,Gh.DOM_DELTA_LINE=1,Gh.DOM_DELTA_PAGE=2;class IO extends Ay{constructor(t,e){super(),this.type=t,this.detail=e}}const RK="*",Rd=typeof performance=="object"&&performance.now?performance:Date;function dh(n){return n==="mouse"||n==="pen"}let iTt=class{constructor(t,e){this.dispatch=new Bc,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(i,r)=>{if(!(i instanceof so))return void Ir.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const o=this.createPointerEvent(i,i.type,r);if(this.dispatchEvent(o,"pointerdown"),o.pointerType==="touch")this.dispatchEvent(o,"touchstart");else if(dh(o.pointerType)){const s=o.button===2;this.dispatchEvent(o,s?"rightdown":"mousedown")}this.trackingData(i.pointerId).pressTargetsByButton[i.button]=o.composedPath(),this.freeEvent(o)},this.onPointerMove=(i,r)=>{var o,s;if(!(i instanceof so))return void Ir.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const a=this.createPointerEvent(i,i.type,r),l=dh(a.pointerType),h=this.trackingData(i.pointerId),u=this.findMountedTarget(h.overTargets);if(h.overTargets&&u&&u!==this.rootTarget&&u!==a.target){const d=i.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(i,d,u||void 0);if(this.dispatchEvent(c,"pointerout"),l&&this.dispatchEvent(c,"mouseout"),!a.composedPath().includes(u)){const f=this.createPointerEvent(i,"pointerleave",u||void 0);for(f.eventPhase=f.AT_TARGET;f.target&&!a.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),l&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}if(u!==a.target){const d=i.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(a,d);this.dispatchEvent(c,"pointerover"),l&&this.dispatchEvent(c,"mouseover");let f=u?.parent;for(;f&&f!==this.rootTarget.parent&&f!==a.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const g=this.clonePointerEvent(a,"pointerenter");g.eventPhase=g.AT_TARGET;let p=g.target;const v=new Set;let m=u;for(;m&&m!==this.rootTarget;)v.add(m),m=m.parent;for(;p&&p!==u&&p!==this.rootTarget.parent;)v.has(p)||(g.currentTarget=p,this.notifyTarget(g),l&&this.notifyTarget(g,"mouseenter")),p=p.parent;this.freeEvent(g)}this.freeEvent(c)}this.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&this.dispatchEvent(a,"touchmove"),l&&(this.dispatchEvent(a,"mousemove"),this.cursorTarget=a.target,this.cursor=((s=(o=a.target)===null||o===void 0?void 0:o.attribute)===null||s===void 0?void 0:s.cursor)||this.rootTarget.getCursor()),h.overTargets=a.composedPath(),this.freeEvent(a)},this.onPointerOver=(i,r)=>{var o,s;if(!(i instanceof so))return void Ir.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const a=this.trackingData(i.pointerId),l=this.createPointerEvent(i,i.type,r),h=dh(l.pointerType);this.dispatchEvent(l,"pointerover"),h&&this.dispatchEvent(l,"mouseover"),l.pointerType==="mouse"&&(this.cursorTarget=l.target,this.cursor=((s=(o=l.target)===null||o===void 0?void 0:o.attribute)===null||s===void 0?void 0:s.cursor)||this.rootTarget.getCursor());const u=this.clonePointerEvent(l,"pointerenter");for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==this.rootTarget.parent;)u.currentTarget=u.target,this.notifyTarget(u),h&&this.notifyTarget(u,"mouseenter"),u.target=u.target.parent;a.overTargets=l.composedPath(),this.freeEvent(l),this.freeEvent(u)},this.onPointerOut=(i,r)=>{if(!(i instanceof so))return void Ir.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const o=this.trackingData(i.pointerId);if(o.overTargets){const s=dh(i.pointerType),a=this.findMountedTarget(o.overTargets),l=this.createPointerEvent(i,"pointerout",a||void 0);this.dispatchEvent(l),s&&this.dispatchEvent(l,"mouseout");const h=this.createPointerEvent(i,"pointerleave",a||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),s&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;o.overTargets=[],this.freeEvent(l),this.freeEvent(h)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(i,r)=>{var o;if(!(i instanceof so))return void Ir.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const s=Rd.now(),a=this.createPointerEvent(i,i.type,r);if(this.dispatchEvent(a,"pointerup"),a.pointerType==="touch")this.dispatchEvent(a,"touchend");else if(dh(a.pointerType)){const d=a.button===2;this.dispatchEvent(a,d?"rightup":"mouseup")}const l=this.trackingData(i.pointerId),h=this.findMountedTarget(l.pressTargetsByButton[i.button]);let u=h;if(h&&!a.composedPath().includes(h)){let d=h;for(;d&&!a.composedPath().includes(d);){if(a.currentTarget=d,this.notifyTarget(a,"pointerupoutside"),a.pointerType==="touch")this.notifyTarget(a,"touchendoutside");else if(dh(a.pointerType)){const c=a.button===2;this.notifyTarget(a,c?"rightupoutside":"mouseupoutside")}d=d.parent}delete l.pressTargetsByButton[i.button],u=d}if(u){const d=this.clonePointerEvent(a,"click");d.target=u,d.path=[],d.detailPath=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:s});const c=l.clicksByButton[i.button];c.target===d.target&&s-c.timeStamp<((o=this._config.clickInterval)!==null&&o!==void 0?o:200)?++c.clickCount:c.clickCount=1,c.target=d.target,c.timeStamp=s,d.detail=c.clickCount,dh(d.pointerType)?(this.dispatchEvent(d,"click"),c.clickCount===2&&this.dispatchEvent(d,"dblclick")):d.pointerType==="touch"&&this._config.supportsTouchEvents&&(this.dispatchEvent(d,"tap"),c.clickCount===2&&this.dispatchEvent(d,"dbltap")),this.dispatchEvent(d,"pointertap"),this.freeEvent(d)}this.freeEvent(a)},this.onPointerUpOutside=(i,r)=>{if(!(i instanceof so))return void Ir.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const o=this.trackingData(i.pointerId),s=this.findMountedTarget(o.pressTargetsByButton[i.button]),a=this.createPointerEvent(i,i.type,r);if(s){let l=s;for(;l;)a.currentTarget=l,this.notifyTarget(a,"pointerupoutside"),a.pointerType==="touch"?this.notifyTarget(a,"touchendoutside"):dh(a.pointerType)&&this.notifyTarget(a,a.button===2?"rightupoutside":"mouseupoutside"),l=l.parent;delete o.pressTargetsByButton[i.button]}this.freeEvent(a)},this.onWheel=(i,r)=>{if(!(i instanceof Gh))return void Ir.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");const o=this.createWheelEvent(i,r);this.dispatchEvent(o),this.freeEvent(o)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,r)=>i.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,i,r,o,s,a,l;if(!this.rootTarget)return;const h=this.mappingTable[t.type];let u;const d=`${t.canvasX}-${t.canvasY}`;if(!((e=this._prePointTargetCache)===null||e===void 0)&&e[d]&&(!((r=(i=this._prePointTargetCache)===null||i===void 0?void 0:i[d])===null||r===void 0)&&r.stage)&&((s=(o=this._prePointTargetCache)===null||o===void 0?void 0:o[d])===null||s===void 0?void 0:s.stage.renderCount)===((a=this._prePointTargetCache)===null||a===void 0?void 0:a.stageRenderCount)?u=this._prePointTargetCache[d]:(u=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[d]:u,stageRenderCount:(l=u?.stage.renderCount)!==null&&l!==void 0?l:-1})),h)for(let c=0,f=h.length;c<f;c++)h[c].fn(t,u);else Ir.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,o=i.length-1;r<o;r++)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let r=i.length-2;r>=0;r--)if(t.currentTarget=i[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){const e=[t];for(let i=0;i<2048&&t!==this.rootTarget&&t.parent;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=e??t.type;const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){var r,o;const s=this.allocateEvent(so);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i||this.pickTarget((r=s.viewX)!==null&&r!==void 0?r:s.global.x,(o=s.viewY)!==null&&o!==void 0?o:s.global.y,s),typeof e=="string"&&(s.type=e),s}createWheelEvent(t,e){var i,r;const o=this.allocateEvent(Gh);return this.copyWheelData(t,o),this.copyMouseData(t,o),this.copyData(t,o),o.nativeEvent=t.nativeEvent,o.originalEvent=t,o.target=e||this.pickTarget((i=o.viewX)!==null&&i!==void 0?i:o.global.x,(r=o.viewY)!==null&&r!==void 0?r:o.global.y,o),o}clonePointerEvent(t,e){const i=this.allocateEvent(so);i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice();const r=t.composedDetailPath();return i.detailPath=r&&r.slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof so&&e instanceof so&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof $w&&e instanceof $w&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(i=>{e[i].x=t[i].x,e[i].y=t[i].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=Rd.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);const i=((e=this.eventPool.get(t))===null||e===void 0?void 0:e.pop())||new t(this);return i.eventPhase=i.NONE,i.currentTarget=null,i.path=[],i.detailPath=[],i.target=null,i}freeEvent(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");const i=t.constructor;this.eventPool.has(i)||this.eventPool.set(i,[]),(e=this.eventPool.get(i))===null||e===void 0||e.push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i)if("fn"in i)i.once&&t.currentTarget.removeEventListener(e,i.fn,{once:!0}),i.fn.call(i.context,t);else for(let r=0,o=i.length;r<o&&!t.propagationImmediatelyStopped;r++)i[r].once&&t.currentTarget.removeEventListener(e,i[r].fn,{once:!0}),i[r].fn.call(i[r].context,t);this.emitDelegation(t,e)}emitDelegation(t,e){const i=t.currentTarget._events[RK];if(i)if("fn"in i)i.fn.call(i.context,t,e);else for(let r=0,o=i.length;r<o&&!t.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,t,e)}pickTarget(t,e,i){let r;const o=this.rootTarget.pick(t,e);return r=o&&o.graphic?o.graphic:o&&o.group?o.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,i&&(i.pickParams=o.params),r}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}};const nTt={dispatchEvent(n){var t;if(!(n instanceof Ay))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return n.defaultPrevented=!1,n.path=[],n.detailPath&&(n.detailPath=[]),n.target=this,(t=n?.manager)===null||t===void 0||t.dispatchEvent(n),!n.defaultPrevented},emit(n,t){return this.dispatchEvent(new IO(n,t))}},rTt={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class oTt{constructor(t){this.resolution=1,this.onPointerDown=u=>{if(this.supportsTouchEvents&&u.pointerType==="touch")return;const d=this.normalizeToPointerData(u);this.autoPreventDefault&&d[0].isNormalized&&(u.cancelable||!("cancelable"in u))&&u.preventDefault();for(let c=0,f=d.length;c<f;c++){const g=d[c],p=this.bootstrapEvent(this.rootPointerEvent,g);this.manager.mapEvent(p)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=u=>{if(this.supportsTouchEvents&&u.pointerType==="touch"||this.isEventOutsideOfTargetElement(u))return;const d=this.normalizeToPointerData(u);for(let c=0,f=d.length;c<f;c++){const g=this.bootstrapEvent(this.rootPointerEvent,d[c]);this.manager.mapEvent(g)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=u=>{if(this.supportsTouchEvents&&u.pointerType==="touch")return;const d=this.isEventOutsideOfTargetViewPort(u)?"outside":"",c=this.normalizeToPointerData(u);for(let f=0,g=c.length;f<g;f++){const p=this.bootstrapEvent(this.rootPointerEvent,c[f]);p.type+=d,this.manager.mapEvent(p)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=u=>{if(this.supportsTouchEvents&&u.pointerType==="touch")return;const d=this.normalizeToPointerData(u);for(let c=0,f=d.length;c<f;c++){const g=this.bootstrapEvent(this.rootPointerEvent,d[c]);this.manager.mapEvent(g)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=u=>{const d=this.normalizeWheelEvent(u);this.manager.mapEvent(d)};const{targetElement:e,resolution:i,rootNode:r,global:o,autoPreventDefault:s=!1,clickInterval:a,supportsTouchEvents:l=o.supportsTouchEvents,supportsPointerEvents:h=o.supportsPointerEvents}=t;this.manager=new iTt(r,{clickInterval:a,supportsTouchEvents:l}),this.globalObj=o,this.supportsPointerEvents=h,this.supportsTouchEvents=l,this.supportsMouseEvents=o.supportsMouseEvents,this.applyStyles=o.applyStyles,this.autoPreventDefault=s,this.eventsAdded=!1,this.rootPointerEvent=new so,this.rootWheelEvent=new Gh,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=i,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");const{applyStyles:i,domElement:r}=this;if(this.currentCursor===t)return;this.currentCursor=t;const o=this.cursorStyles[t];o?typeof o=="string"&&i?r.style.cursor=o:typeof o=="function"?o(t):typeof o=="object"&&i&&Object.assign(r.style,o):i&&Ha(t)&&!uSt(this.cursorStyles,t)&&(r.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.addEventListener("mousemove",this.onPointerMove,!0),t.addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.removeEventListener("mousemove",this.onPointerMove,!0),t.removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,i;const r=(e=this.globalObj)===null||e===void 0?void 0:e.mapToCanvasPoint(t,this.domElement);if(r)return r;let o=0,s=0;if(t.changedTouches){const l=(i=t.changedTouches[0])!==null&&i!==void 0?i:{};o=l.clientX||0,s=l.clientY||0}else o=t.clientX||0,s=t.clientY||0;const a=this.domElement.getBoundingClientRect();return{x:o-a.left,y:s-a.top}}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let i=0,r=t.changedTouches.length;i<r;i++){const o=t.changedTouches[i];Pi(o.button)&&(o.button=0),Pi(o.buttons)&&(o.buttons=1),Pi(o.isPrimary)&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),Pi(o.width)&&(o.width=o.radiusX||1),Pi(o.height)&&(o.height=o.radiusY||1),Pi(o.tiltX)&&(o.tiltX=0),Pi(o.tiltY)&&(o.tiltY=0),Pi(o.pointerType)&&(o.pointerType="touch"),Pi(o.pointerId)&&(o.pointerId=o.identifier||0),Pi(o.pressure)&&(o.pressure=o.force||.5),Pi(o.twist)&&(o.twist=0),Pi(o.tangentialPressure)&&(o.tangentialPressure=0),Pi(o.layerX)&&(o.layerX=o.offsetX=o.clientX),Pi(o.layerY)&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=t.type,e.push(o)}else if(this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent))e.push(t);else{const i=t;Pi(i.isPrimary)&&(i.isPrimary=!0),Pi(i.width)&&(i.width=1),Pi(i.height)&&(i.height=1),Pi(i.tiltX)&&(i.tiltX=0),Pi(i.tiltY)&&(i.tiltY=0),Pi(i.pointerType)&&(i.pointerType="mouse"),Pi(i.pointerId)&&(i.pointerId=1),Pi(i.pressure)&&(i.pressure=.5),Pi(i.twist)&&(i.twist=0),Pi(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;const{x:i,y:r}=this.mapToCanvasPoint(t);e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r;const{x:o,y:s}=this.mapToViewportPoint(e);return e.viewport.x=o,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:i,y:r}=this.mapToCanvasPoint(e);t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r;const{x:o,y:s}=this.mapToViewportPoint(t);return t.viewport.x=o,t.viewport.y=s,t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=rTt[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=Rd.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){const e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),i=this.domElement.getViewBox(),r=i.width(),o=i.height();return!(e.x<r&&e.y<o&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}class Xe{static GetImage(t,e){var i;const r=Xe.cache.get(t);r?r.loadState==="fail"?bt.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):r.loadState==="init"||r.loadState==="loading"?(i=r.waitingMark)===null||i===void 0||i.push(e):e&&e.imageLoadSuccess(t,r.data):Xe.loadImage(t,e)}static GetSvg(t,e){var i;let r=Xe.cache.get(t);r?r.loadState==="fail"?bt.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):r.loadState==="init"||r.loadState==="loading"?(i=r.waitingMark)===null||i===void 0||i.push(e):e&&e.imageLoadSuccess(t,r.data):(r={type:"image",loadState:"init"},Xe.cache.set(t,r),r.dataPromise=bt.global.loadSvg(t),r.dataPromise?(r.waitingMark=[e],r.dataPromise.then(o=>{var s;r.loadState=o?.data?"success":"fail",r.data=o?.data,(s=r.waitingMark)===null||s===void 0||s.map((a,l)=>{o?.data?(r.loadState="success",r.data=o.data,a.imageLoadSuccess(t,o.data)):(r.loadState="fail",a.imageLoadFail(t))}),r.waitingMark&&(r.waitingMark=[])})):(r.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let i=Xe.cache.get(t);return i?i.loadState==="fail"?Promise.reject():i.loadState==="init"||i.loadState==="loading"?i.dataPromise.then(r=>r.data):Promise.resolve(i.data):(i={type:e,loadState:"init"},Xe.cache.set(t,i),e==="arrayBuffer"?i.dataPromise=bt.global.loadArrayBuffer(t):e==="blob"?i.dataPromise=bt.global.loadBlob(t):e==="json"&&(i.dataPromise=bt.global.loadJson(t)),i.dataPromise.then(r=>r.data))}static loading(){setTimeout(()=>{if(!Xe.isLoading&&Xe.toLoadAueue.length){Xe.isLoading=!0;const t=Xe.toLoadAueue.splice(0,10),e=[];t.forEach(i=>{const{url:r,marks:o}=i,s={type:"image",loadState:"init"};if(Xe.cache.set(r,s),s.dataPromise=bt.global.loadImage(r),s.dataPromise){s.waitingMark=o;const a=s.dataPromise.then(l=>{var h;s.loadState=l?.data?"success":"fail",s.data=l?.data,(h=s.waitingMark)===null||h===void 0||h.map((u,d)=>{l?.data?(s.loadState="success",s.data=l.data,u.imageLoadSuccess(r,l.data)):(s.loadState="fail",u.imageLoadFail(r))}),s.waitingMark&&(s.waitingMark=[])});e.push(a)}else s.loadState="fail",o.forEach(a=>a.imageLoadFail(r))}),Promise.all(e).then(()=>{Xe.isLoading=!1,this.onLoadSuccessCb.forEach(i=>i()),Xe.loading()}).catch(i=>{Xe.isLoading=!1,this.onLoadSuccessCb.forEach(r=>r()),Xe.loading()})}},0)}static loadImage(t,e){const i=T5(t,Xe.toLoadAueue);if(i!==-1)return Xe.toLoadAueue[i].marks.push(e),void Xe.loading();Xe.toLoadAueue.push({url:t,marks:[e]}),Xe.loading()}static improveImageLoading(t){const e=T5(t,Xe.toLoadAueue);if(e!==-1){const i=Xe.toLoadAueue.splice(e,1);Xe.toLoadAueue.unshift(i[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function T5(n,t){for(let e=0;e<t.length;e++)if(t[e].url===n)return e;return-1}Xe.cache=new Map,Xe.isLoading=!1,Xe.toLoadAueue=[],Xe.onLoadSuccessCb=[];var M5;(function(n){n[n.Top=1]="Top",n[n.Right=2]="Right",n[n.Bottom=4]="Bottom",n[n.Left=8]="Left",n[n.ALL=15]="ALL"})(M5||(M5={}));const ol=[!1,!1,!1,!1],sTt=n=>{var t;let e=!0;if(Sm(n,!0)){for(let i=0;i<4;i++)ol[i]=n,e&&(e=!((t=ol[i])!==null&&t!==void 0&&!t));e=n}else if(Array.isArray(n))for(let i=0;i<4;i++)ol[i]=!!n[i],e&&(e=!!ol[i]);else ol[0]=!1,ol[1]=!1,ol[2]=!1,ol[3]=!1;return{isFullStroke:e,stroke:ol}},fv=[0,0,0,0],jw=n=>n?ke(n)?n.length===0?0:n.length===1?n[0]:n.length===2?(fv[0]=n[0],fv[2]=n[0],fv[1]=n[1],fv[3]=n[1],fv):n:n:0,nf=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],o_=[1,2,3,0,1,2,3,0];function EP(n,t,e,i){for(;n>=Zt;)n-=Zt;for(;n<0;)n+=Zt;for(;n>t;)t+=Zt;nf[0].x=e,nf[1].y=e,nf[2].x=-e,nf[3].y=-e;const r=Math.ceil(n/es)%4,o=Math.ceil(t/es)%4;if(i.add(hn(n)*e,xi(n)*e),i.add(hn(t)*e,xi(t)*e),r!==o||t-n>Fi){let s=!1;for(let a=0;a<o_.length;a++)if(s||r!==o_[a]){if(s&&o===o_[a])break;if(s){const l=nf[o_[a]];i.add(l.x,l.y)}}else{s=!0;const l=nf[r];i.add(l.x,l.y)}}}function LP(n,t,e){const{x:i,y:r}=r5(n.x,n.y,t.x,t.y,e),{x:o,y:s}=r5(n.x1,n.y1,t.x1,t.y1,e),a=new Je(i,r,o,s);return a.defined=t.defined,a}function HO(n,t,e){if(!n||!t)return[];Array.isArray(n)||(n=[n]),Array.isArray(t)||(t=[t]);let i=[];if(n.length>t.length){i=t.map(r=>{const o=new Je(r.x,r.y,r.x1,r.y1);return o.defined=r.defined,o});for(let r=0;r<t.length;r++)i[r]=LP(n[r],t[r],e)}else{i=t.map(r=>{const o=new Je(r.x,r.y,r.x1,r.y1);return o.defined=r.defined,o});for(let r=0;r<n.length;r++)i[r]=LP(n[r],t[r],e)}return i}function s_(n,t){if(ke(n)){let e;for(let i=0;i<n.length&&e===void 0;i++)e=n[i][t];return e}return n[t]}class eA{constructor(t=eA.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((e,i)=>e+i,0)/this.durations.length,1e3/60),1e3/30)}}eA.TimeOut=1e3/60;const R5=new eA,aTt=(n,t)=>Ha(n)&&n[n.length-1]==="%"?t*(Number.parseFloat(n.substring(0,n.length-1))/100):n,Ty=(n,t)=>{const e=aTt(n,t);return isNaN(e)?e:Math.max(t,e)};class rn{bounds(t,e){if(kn(t)){const i=t/2;e.x1=-i,e.x2=i,e.y1=-i,e.y2=i}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}parseSize(t){return kn(t)?t:Math.min(t[0],t[1])}}function B5(n,t,e,i,r){return r?n.arc(e,i,t,0,Zn,!1,r):n.arc(e,i,t,0,Zn),!1}class lTt extends rn{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,i,r,o){return B5(t,this.parseSize(e)/2,i,r,o)}drawOffset(t,e,i,r,o,s){return B5(t,this.parseSize(e)/2+o,i,r,s)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e-o}, ${i} a ${o},${o} 0 1,0 ${2*o},0 a ${o},${o} 0 1,0 -${2*o},0`}}const hTt=new lTt;function uTt(n,t,e,i,r){return n.moveTo(-3*t+e,-t+i,r),n.lineTo(-t+e,-t+i,r),n.lineTo(-t+e,-3*t+i,r),n.lineTo(t+e,-3*t+i,r),n.lineTo(t+e,-t+i,r),n.lineTo(3*t+e,-t+i,r),n.lineTo(3*t+e,t+i,r),n.lineTo(t+e,t+i,r),n.lineTo(t+e,3*t+i,r),n.lineTo(-t+e,3*t+i,r),n.lineTo(-t+e,t+i,r),n.lineTo(-3*t+e,t+i,r),n.closePath(),!0}function dTt(n,t,e,i,r,o){return n.moveTo(-3*t+e-r,-t+i-r,o),n.lineTo(-t+e-r,-t+i-r,o),n.lineTo(-t+e-r,-3*t+i-r,o),n.lineTo(t+e+r,-3*t+i-r,o),n.lineTo(t+e+r,-t+i-r,o),n.lineTo(3*t+e+r,-t+i-r,o),n.lineTo(3*t+e+r,t+i+r,o),n.lineTo(t+e+r,t+i+r,o),n.lineTo(t+e+r,3*t+i+r,o),n.lineTo(-t+e-r,3*t+i+r,o),n.lineTo(-t+e-r,t+i+r,o),n.lineTo(-3*t+e-r,t+i+r,o),n.closePath(),!0}class cTt extends rn{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,i,r,o){return uTt(t,this.parseSize(e)/6,i,r,o)}drawOffset(t,e,i,r,o,s){return dTt(t,this.parseSize(e)/6,i,r,o,s)}}const fTt=new cTt;function kR(n,t,e,i,r){return n.moveTo(e,i-t,r),n.lineTo(t+e,i,r),n.lineTo(e,i+t,r),n.lineTo(e-t,i,r),n.closePath(),!0}class gTt extends rn{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,i,r,o){return kR(t,this.parseSize(e)/2,i,r,o)}drawFitDir(t,e,i,r,o){return kR(t,this.parseSize(e)/2,i,r,o)}drawOffset(t,e,i,r,o,s){return kR(t,this.parseSize(e)/2+o,i,r,s)}}const pTt=new gTt;function P5(n,t,e,i){const r=2*t;return n.rect(e-t,i-t,r,r),!1}class vTt extends rn{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,i,r){return P5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return P5(t,this.parseSize(e)/2+o,i,r)}}const mTt=new vTt;function k5(n,t,e,i,r=0){return n.moveTo(e+t+2*r,t+i+r),n.lineTo(e-t-2*r,t+i+r),n.lineTo(e,i-t-2*r),n.closePath(),!0}class BK extends rn{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,i,r){return k5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return k5(t,this.parseSize(e)/2,i,r,o)}}const yTt=new BK;class bTt extends BK{constructor(){super(...arguments),this.type="triangle"}}const _Tt=new bTt,PK=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),CTt=Math.sin(Zn/10)*PK,wTt=-Math.cos(Zn/10)*PK;function E5(n,t,e,i){const r=CTt*t,o=wTt*t;n.moveTo(e,-t+i),n.lineTo(r+e,o+i);for(let s=1;s<5;++s){const a=Zn*s/5,l=Math.cos(a),h=Math.sin(a);n.lineTo(h*t+e,-l*t+i),n.lineTo(l*r-h*o+e,h*r+l*o+i)}return n.closePath(),!0}class xTt extends rn{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,i,r){return E5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return E5(t,this.parseSize(e)/2+o,i,r)}}const STt=new xTt,ATt=js(3);function L5(n,t,e,i){const r=t,o=r/ATt,s=o/5,a=t;return n.moveTo(0+e,-r+i),n.lineTo(o/2+e,i),n.lineTo(s/2+e,i),n.lineTo(s/2+e,a+i),n.lineTo(-s/2+e,a+i),n.lineTo(-s/2+e,i),n.lineTo(-o/2+e,i),n.closePath(),!0}class TTt extends rn{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,i,r){return L5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return L5(t,this.parseSize(e)/2+o,i,r)}}const MTt=new TTt;function O5(n,t,e,i){const r=2*t;return n.moveTo(e,-t+i),n.lineTo(r/3/2+e,t+i),n.lineTo(-r/3/2+e,t+i),n.closePath(),!0}class RTt extends rn{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,i,r){return O5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return O5(t,this.parseSize(e)/2+o,i,r)}}const BTt=new RTt;function D5(n,t,e,i){return n.moveTo(-t+e,i),n.lineTo(e,t+i),!1}class PTt extends rn{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,i,r){return D5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return D5(t,this.parseSize(e)/2+o,i,r)}}const kTt=new PTt,Lo=-.5,Oo=js(3)/2,I5=1/js(12);function H5(n,t,e,i){const r=t/2,o=t*I5,s=r,a=t*I5+t,l=-s,h=a;return n.moveTo(r+e,o+i),n.lineTo(s+e,a+i),n.lineTo(l+e,h+i),n.lineTo(Lo*r-Oo*o+e,Oo*r+Lo*o+i),n.lineTo(Lo*s-Oo*a+e,Oo*s+Lo*a+i),n.lineTo(Lo*l-Oo*h+e,Oo*l+Lo*h+i),n.lineTo(Lo*r+Oo*o+e,Lo*o-Oo*r+i),n.lineTo(Lo*s+Oo*a+e,Lo*a-Oo*s+i),n.lineTo(Lo*l+Oo*h+e,Lo*h-Oo*l+i),n.closePath(),!1}class ETt extends rn{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,i,r){return H5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return H5(t,this.parseSize(e)/2+o,i,r)}}const LTt=new ETt;function F5(n,t,e,i,r){return n.moveTo(-t+e-2*r,i),n.lineTo(t+e+r,t+i+2*r),n.lineTo(t+e+r,i-t-2*r),n.closePath(),!0}class OTt extends rn{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,i,r){return F5(t,this.parseSize(e)/2,i,r,0)}drawOffset(t,e,i,r,o){return F5(t,this.parseSize(e)/2,i,r,o)}}const DTt=new OTt;function z5(n,t,e,i,r=0){return n.moveTo(e-t-r,t+i+2*r),n.lineTo(t+e+2*r,i),n.lineTo(e-t-r,i-t-2*r),n.closePath(),!0}class ITt extends rn{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,i,r){return z5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return z5(t,this.parseSize(e)/2,i,r,o)}}const HTt=new ITt;function N5(n,t,e,i,r=0){return n.moveTo(e-t-2*r,i-t-r),n.lineTo(e+t+2*r,i-t-r),n.lineTo(e,i+t+2*r),n.closePath(),!0}class FTt extends rn{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,i,r){return N5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o){return N5(t,this.parseSize(e)/2,i,r,o)}}const zTt=new FTt,OP=js(3);function W5(n,t,e,i){const r=t*OP;return n.moveTo(e,i+-r/3*2),n.lineTo(t+e,i+r),n.lineTo(e-t,i+r),n.closePath(),!0}class NTt extends rn{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,i,r){return W5(t,this.parseSize(e)/2/OP,i,r)}drawOffset(t,e,i,r,o){return W5(t,this.parseSize(e)/2/OP+o,i,r)}}const WTt=new NTt;function V5(n,t,e,i){const r=2*t;return n.moveTo(t+e,i-r),n.lineTo(e-t,i),n.lineTo(t+e,r+i),!0}class VTt extends rn{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,i,r){return V5(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return V5(t,this.parseSize(e)/4+o,i,r)}}const GTt=new VTt;function G5(n,t,e,i){const r=2*t;return n.moveTo(e-t,i-r),n.lineTo(e+t,i),n.lineTo(e-t,r+i),!0}class $Tt extends rn{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,i,r){return G5(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return G5(t,this.parseSize(e)/4+o,i,r)}}const jTt=new $Tt;function $5(n,t,e,i){const r=2*t;return n.moveTo(e-r,i+t),n.lineTo(e,i-t),n.lineTo(e+r,i+t),!0}class UTt extends rn{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,i,r){return $5(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return $5(t,this.parseSize(e)/4+o,i,r)}}const XTt=new UTt;function j5(n,t,e,i){const r=2*t;return n.moveTo(e-r,i-t),n.lineTo(e,i+t),n.lineTo(e+r,i-t),!0}class YTt extends rn{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,i,r){return j5(t,this.parseSize(e)/4,i,r)}drawOffset(t,e,i,r,o){return j5(t,this.parseSize(e)/4+o,i,r)}}const KTt=new YTt;function U5(n,t,e,i,r){return n.moveTo(e,i-t),n.lineTo(e,i+t),!0}class qTt extends rn{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,i,r,o){return U5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o,s){return U5(t,this.parseSize(e)/2+o,i,r)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e}, ${i-o} L ${e},${i+o}`}}const ZTt=new qTt;function X5(n,t,e,i,r){return n.moveTo(e-t,i),n.lineTo(e+t,i),!0}class JTt extends rn{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,i,r,o){return X5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o,s){return X5(t,this.parseSize(e)/2+o,i,r)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e-o}, ${i} L ${e+o},${i}`}}const QTt=new JTt;function Y5(n,t,e,i,r){return n.moveTo(e-t,i-t),n.lineTo(e+t,i+t),n.moveTo(e+t,i-t),n.lineTo(e-t,i+t),!0}class tMt extends rn{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,i,r,o){return Y5(t,this.parseSize(e)/2,i,r)}drawOffset(t,e,i,r,o,s){return Y5(t,this.parseSize(e)/2+o,i,r)}drawToSvgPath(t,e,i,r){const o=this.parseSize(t)/2;return`M ${e-o}, ${i-o} L ${e+o},${i+o} M ${e+o}, ${i-o} L ${e-o},${i+o}`}}const eMt=new tMt;function K5(n,t,e,i){return n.rect(e-t[0]/2,i-t[1]/2,t[0],t[1]),!1}function q5(n,t,e,i){const r=t,o=t/2;return n.rect(e-r/2,i-o/2,r,o),!1}class iMt extends rn{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,i,r){return kn(e)?q5(t,e,i,r):K5(t,e,i,r)}drawWithClipRange(t,e,i,r,o,s,a){kn(e)&&(e=[e,e/2]);const l=2*(e[0]+e[1])*o,h=[{x:i+e[0]/2,y:r-e[1]/2},{x:i+e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r+e[1]/2},{x:i-e[0]/2,y:r-e[1]/2}];let u=0,d=h[3];t.moveTo(d.x,d.y);for(let c=0;c<h.length;c++){const f=h[c],g=Math.sqrt((f.x-d.x)*(f.x-d.x)+(f.y-d.y)*(f.y-d.y));if(u+g>l){const p=(f.x-d.x)*(l-u)/g,v=(f.y-d.y)*(l-u)/g;t.lineTo(d.x+p,d.y+v);break}t.lineTo(f.x,f.y),d=f,u+=g}return!1}drawOffset(t,e,i,r,o){return kn(e)?q5(t,e+2*o,i,r):K5(t,[e[0]+2*o,e[1]+2*o],i,r)}}const nMt=new iMt,gv=new Fn;class Z5{constructor(t,e,i=!1){this.pathStr="",this.type=t,ke(e)?this.svgCache=e:this.path=e,this.isSvg=i}drawOffset(t,e,i,r,o,s,a){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(l=>{t.beginPath(),Xl(l.path.commandList,t,i,r,e,e),a&&a(l.path,l.attribute)}),!1):(Xl(this.path.commandList,t,i,r,e+o,e+o),!1)}draw(t,e,i,r,o,s){return e=this.parseSize(e),this.drawOffset(t,e,i,r,0,o,s)}parseSize(t){return kn(t)?t:Math.min(t[0],t[1])}drawWithClipRange(t,e,i,r,o,s,a){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(l=>{l.path.drawWithClipRange(t,e,i,r,o),a&&a(l.path,l.attribute)}),!1):(this.path.drawWithClipRange(t,e,i,r,o),!1)}bounds(t,e){if(t=this.parseSize(t),this.isSvg)return this.svgCache?(e.clear(),void this.svgCache.forEach(({path:i})=>{gv.x1=i.bounds.x1*t,gv.y1=i.bounds.y1*t,gv.x2=i.bounds.x2*t,gv.y2=i.bounds.y2*t,e.union(gv)})):void 0;this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}const rMt=[hTt,fTt,pTt,mTt,WTt,_Tt,STt,MTt,BTt,kTt,LTt,DTt,HTt,yTt,zTt,GTt,jTt,XTt,KTt,nMt,ZTt,QTt,eMt],kK={};rMt.forEach(n=>{kK[n.type]=n});const oMt={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"};function sMt(n,t){const e=[];let i=t.exec(n);for(;i;){const r=[];r.startIndex=t.lastIndex-i[0].length;const o=i.length;for(let s=0;s<o;s++)r.push(i[s]);e.push(r),i=t.exec(n)}return e}class ER{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function J5(n,t,e,i){const r=n.indexOf(t,e);if(r===-1)throw new Error(i);return r+t.length-1}function aMt(n,t,e=">"){let i,r="";for(let o=t;o<n.length;o++){let s=n[o];if(i)s===i&&(i="");else if(s==='"'||s==="'")i=s;else if(s===e[0]){if(!e[1])return{data:r,index:o};if(n[o+1]===e[1])return{data:r,index:o}}else s==="	"&&(s=" ");r+=s}}function Q5(n,t,e,i=">"){const r=aMt(n,t+1,i);if(!r)return;let o=r.data;const s=r.index,a=o.search(/\s/);let l=o,h=!0;return a!==-1&&(l=o.substr(0,a).replace(/\s\s*$/,""),o=o.substr(a+1)),{tagName:l,tagExp:o,closeIndex:s,attrExpPresent:h,rawTagName:l}}const lMt=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");class hMt{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,i){const r=e.tagname;typeof r=="string"&&(e.tagname=r),t.addChild(e)}buildAttributesMap(t,e,i){const r={};if(!t)return;const o=sMt(t,lMt),s=o.length;for(let a=0;a<s;a++){const l=o[a][1],h=o[a][4],u=l;l&&(r[u]=h===void 0||(isNaN(h)?h:Number(h)))}return r}parseXml(t){t=t.replace(/\r\n?/g,`
`);const e=new ER("!xml");let i=e,r="",o="";for(let s=0;s<t.length;s++)if(t[s]==="<")if(t[s+1]==="/"){const a=J5(t,">",s,"Closing Tag is not closed."),l=o.lastIndexOf(".");o=o.substring(0,l),i=this.tagsNodeStack.pop(),i&&i.child&&r&&i.child[i.child.length-1][":@"]&&(i.child[i.child.length-1][":@"].text=r),r="",s=a}else if(t[s+1]==="?")s=Q5(t,s,!1,"?>").closeIndex+1;else if(t.substr(s+1,3)==="!--")s=J5(t,"-->",s+4,"Comment is not closed.");else{const a=Q5(t,s);let l=a.tagName,h=a.tagExp;const u=a.attrExpPresent,d=a.closeIndex;if(l!==e.tagname&&(o+=o?"."+l:l),h.length>0&&h.lastIndexOf("/")===h.length-1){l[l.length-1]==="/"?(l=l.substr(0,l.length-1),o=o.substr(0,o.length-1),h=l):h=h.substr(0,h.length-1);const c=new ER(l);l!==h&&u&&(c[":@"]=this.buildAttributesMap(h,o,l)),this.addChild(i,c,o),o=o.substr(0,o.lastIndexOf("."))}else{const c=new ER(l);this.tagsNodeStack.push(i),l!==h&&u&&(c[":@"]=this.buildAttributesMap(h,o,l)),this.addChild(i,c,o),i=c}r="",s=d}else r+=t[s];return e.child}}function uMt(n,t){return EK(n)}function EK(n,t){const e={};for(let i=0;i<n.length;i++){const r=n[i],o=dMt(r);if(o!==void 0&&r[o]){const s=EK(r[o]);fMt(s),r[":@"]&&cMt(s,r[":@"]),e[o]!==void 0&&e.hasOwnProperty(o)?(Array.isArray(e[o])||(e[o]=[e[o]]),e[o].push(s)):e[o]=s}}return e}function dMt(n){const t=Object.keys(n);for(let e=0;e<t.length;e++){const i=t[e];if(i!==":@")return i}}function cMt(n,t,e){if(t){const i=Object.keys(t),r=i.length;for(let o=0;o<r;o++){const s=i[o];n[s]=t[s]}}}function fMt(n){return Object.keys(n).length===0}class iA{constructor(t){this.options=Object.assign({},iA.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){if(!this.valid)return!1;const e=new hMt(this.options).parseXml(t);return uMt(e,this.options)}}iA.defaultOptions={};function gMt(n){return n.startsWith("<svg")||n.startsWith("<?xml")}function Uw(n,t,e,i=0){return n.expand(t+(i/2+(e?pMt(e,t):0))),n}function pMt(n,t){return n?t:0}let vMt=0;function Wn(){return vMt++}var Jf;(function(n){n[n.HORIZONTAL=0]="HORIZONTAL",n[n.VERTICAL=1]="VERTICAL"})(Jf||(Jf={}));function mMt(n){const t=[];let e=0,i="";for(let r=0;r<n.length;r++)_Mt(n[r])?e?i+=n[r]:(e=1,i=n[r]):(e&&(t.push({text:i,direction:Jf.VERTICAL}),i="",e=0),t.push({text:n[r],direction:Jf.HORIZONTAL}));return i&&t.push({text:i,direction:Jf.VERTICAL}),t}const yMt=["","","","","","","","","",""],LK=new Map;yMt.forEach(n=>LK.set(n,!0));const bMt=[""],OK=new Map;function _Mt(n){if(LK.has(n))return!0;if(OK.has(n))return!1;let t=!1;return n.codePointAt(0)<256&&(t=!0),t}bMt.forEach(n=>OK.set(n,!0));const nA=Wn(),CMt=Wn(),DK=Wn(),rA=Wn();Wn();const FO=Wn(),oA=Wn(),My=Wn(),sA=Wn(),aA=Wn();Wn();const zO=Wn();Wn();const NO=Wn();Wn();const lA=Wn(),hA=Wn(),WO=Symbol.for("GraphicService"),IK=Symbol.for("GraphicCreator"),HK={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},wMt=Object.keys(HK),xMt={duration:200,easing:"cubicOut"};function FK(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function SMt(n,t,e){const i=Math.sin(e),r=Math.cos(e),o=t[4],s=t[5],a=t[6],l=t[7],h=t[8],u=t[9],d=t[10],c=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=o*r+h*i,n[5]=s*r+u*i,n[6]=a*r+d*i,n[7]=l*r+c*i,n[8]=h*r-o*i,n[9]=u*r-s*i,n[10]=d*r-a*i,n[11]=c*r-l*i,n}function AMt(n,t,e){const i=Math.sin(e),r=Math.cos(e),o=t[0],s=t[1],a=t[2],l=t[3],h=t[8],u=t[9],d=t[10],c=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=o*r-h*i,n[1]=s*r-u*i,n[2]=a*r-d*i,n[3]=l*r-c*i,n[8]=o*i+h*r,n[9]=s*i+u*r,n[10]=a*i+d*r,n[11]=l*i+c*r,n}function TMt(n,t,e){const i=Math.sin(e),r=Math.cos(e),o=t[0],s=t[1],a=t[2],l=t[3],h=t[4],u=t[5],d=t[6],c=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=o*r+h*i,n[1]=s*r+u*i,n[2]=a*r+d*i,n[3]=l*r+c*i,n[4]=h*r-o*i,n[5]=u*r-s*i,n[6]=d*r-a*i,n[7]=c*r-l*i,n}function pv(n,t,e){const i=e[0],r=e[1],o=e[2];let s,a,l,h,u,d,c,f,g,p,v,m;return t===n?(n[12]=t[0]*i+t[4]*r+t[8]*o+t[12],n[13]=t[1]*i+t[5]*r+t[9]*o+t[13],n[14]=t[2]*i+t[6]*r+t[10]*o+t[14],n[15]=t[3]*i+t[7]*r+t[11]*o+t[15]):(s=t[0],a=t[1],l=t[2],h=t[3],u=t[4],d=t[5],c=t[6],f=t[7],g=t[8],p=t[9],v=t[10],m=t[11],n[0]=s,n[1]=a,n[2]=l,n[3]=h,n[4]=u,n[5]=d,n[6]=c,n[7]=f,n[8]=g,n[9]=p,n[10]=v,n[11]=m,n[12]=s*i+u*r+g*o+t[12],n[13]=a*i+d*r+p*o+t[13],n[14]=l*i+c*r+v*o+t[14],n[15]=h*i+f*r+m*o+t[15]),n}function DP(n,t){n[0]=t.a,n[1]=t.b,n[2]=0,n[3]=0,n[4]=t.c,n[5]=t.d,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=t.e,n[13]=t.f,n[14]=0,n[15]=1}function MMt(n,t,e){const i=e[0],r=e[1],o=e[2];return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*i,n[4]=t[4]*r,n[5]=t[5]*r,n[6]=t[6]*r,n[7]=t[7]*r,n[8]=t[8]*o,n[9]=t[9]*o,n[10]=t[10]*o,n[11]=t[11]*o,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Ry(n,t,e){const i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],h=t[6],u=t[7],d=t[8],c=t[9],f=t[10],g=t[11],p=t[12],v=t[13],m=t[14],y=t[15];let b=e[0],_=e[1],w=e[2],C=e[3];return n[0]=b*i+_*a+w*d+C*p,n[1]=b*r+_*l+w*c+C*v,n[2]=b*o+_*h+w*f+C*m,n[3]=b*s+_*u+w*g+C*y,b=e[4],_=e[5],w=e[6],C=e[7],n[4]=b*i+_*a+w*d+C*p,n[5]=b*r+_*l+w*c+C*v,n[6]=b*o+_*h+w*f+C*m,n[7]=b*s+_*u+w*g+C*y,b=e[8],_=e[9],w=e[10],C=e[11],n[8]=b*i+_*a+w*d+C*p,n[9]=b*r+_*l+w*c+C*v,n[10]=b*o+_*h+w*f+C*m,n[11]=b*s+_*u+w*g+C*y,b=e[12],_=e[13],w=e[14],C=e[15],n[12]=b*i+_*a+w*d+C*p,n[13]=b*r+_*l+w*c+C*v,n[14]=b*o+_*h+w*f+C*m,n[15]=b*s+_*u+w*g+C*y,n}function xs(n,t,e){const i=t[0],r=t[1],o=t[2];let s=e[3]*i+e[7]*r+e[11]*o+e[15];return s=s||1,n[0]=(e[0]*i+e[4]*r+e[8]*o+e[12])/s,n[1]=(e[1]*i+e[5]*r+e[9]*o+e[13])/s,n[2]=(e[2]*i+e[6]*r+e[10]*o+e[14])/s,n}function tW(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}class RMt{constructor(){this.pools=[]}allocate(t,e,i,r,o,s){if(!this.pools.length)return new mr(t,e,i,r,o,s);const a=this.pools.pop();return a.a=t,a.b=e,a.c=i,a.d=r,a.e=o,a.f=s,a}allocateByObj(t){if(!this.pools.length)return new mr(t.a,t.b,t.c,t.d,t.e,t.f);const e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}class VO{constructor(){this.pools=[]}static identity(t){return FK(t)}allocate(){if(!this.pools.length)return tW();const t=this.pools.pop();return VO.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():tW();for(let i=0;i<e.length;i++)e[i]=t[i];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const Hn=new RMt,fn=new VO;var BMt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},PMt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const kMt=new mr(1,0,0,1,0,0),rf={x:0,y:0};let IP=class{get nativeContext(){return this.path}constructor(n,t){this.matrix=new mr(1,0,0,1,0,0),this.stack=[],this.dpr=t,this.applyedMatrix=new mr(1,0,0,1,0,0),this.path=new wn,this._clearMatrix=new mr(1,0,0,1,0,0)}getCanvas(){throw new Error("getCanvas")}getContext(){throw new Error("getContext")}setTransformForCurrent(n=!1){!n&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix=this.cloneMatrix(this.matrix))}get currentMatrix(){return this.matrix}cloneMatrix(n){return Hn.allocateByObj(n)}clear(){this.save(),this.resetTransform(),this.restore()}reset(){this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new mr(1,0,0,1,0,0),this.stack.length=0}restore(){this.stack.length>0&&(Hn.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent())}highPerformanceRestore(){this.stack.length>0&&(Hn.free(this.matrix),this.matrix=this.stack.pop())}rotate(n,t=!0){this.matrix.rotate(n),t&&this.setTransformForCurrent()}save(){const n=this.cloneMatrix(this.matrix);this.stack.push(n)}highPerformanceSave(){const n=this.cloneMatrix(this.matrix);this.stack.push(n)}scale(n,t,e=!0){this.matrix.scale(n,t),e&&this.setTransformForCurrent()}setScale(n,t,e=!0){this.matrix.setScale(n,t),e&&this.setTransformForCurrent()}scalePoint(n,t,e,i,r=!0){this.translate(e,i,!1),this.scale(n,t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}setTransform(n,t,e,i,r,o,s=!0,a=this.dpr){this.matrix.setValue(a*n,a*t,a*e,a*i,a*r,a*o),s&&this.setTransformForCurrent()}setTransformFromMatrix(n,t=!0,e=this.dpr){this.matrix.setValue(n.a*e,n.b*e,n.c*e,n.d*e,n.e*e,n.f*e),t&&this.setTransformForCurrent()}resetTransform(n=!0,t=this.dpr){this.setTransform(t,0,0,t,0,0),n&&this.setTransformForCurrent()}transform(n,t,e,i,r,o,s=!0){this.matrix.multiply(n,t,e,i,r,o),s&&this.setTransformForCurrent()}transformFromMatrix(n,t){this.matrix.multiply(n.a,n.b,n.c,n.d,n.e,n.f),t&&this.setTransformForCurrent()}translate(n,t,e=!0){this.matrix.translate(n,t),e&&this.setTransformForCurrent()}rotateDegrees(n,t=!0){const e=n*Math.PI/180;this.rotate(e,t)}rotateAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotate(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}rotateDegreesAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotateDegrees(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}beginPath(){this.path.clear()}clip(n,t){}arc(n,t,e,i,r,o){this.path.arc(n,t,e,i,r,o)}arcTo(n,t,e,i,r){this.path.arcTo(n,t,e,i,r)}bezierCurveTo(n,t,e,i,r,o){this.path.bezierCurveTo(n,t,e,i,r,o)}closePath(){this.path.closePath()}ellipse(n,t,e,i,r,o,s,a){}lineTo(n,t){this.path.lineTo(n,t)}moveTo(n,t){this.path.moveTo(n,t)}quadraticCurveTo(n,t,e,i){this.path.quadraticCurveTo(n,t,e,i)}rect(n,t,e,i){this.path.rect(n,t,e,i)}createImageData(n,t){return null}createLinearGradient(n,t,e,i){throw new Error("createLinearGradient")}createPattern(n,t){throw new Error("createPattern")}createRadialGradient(n,t,e,i,r,o){throw new Error("createRadialGradient")}createConicGradient(n,t,e,i){return null}fill(n,t){}fillRect(n,t,e,i){this.path.rect(n,t,e,i)}clearRect(n,t,e,i){}fillText(n,t,e){}getImageData(n,t,e,i){return null}getLineDash(){return[]}isPointInPath(n,t){return this.matrix.transformPoint({x:n,y:t},rf),XAt(this.path.commandList,rf.x,rf.y)}isPointInStroke(n,t){if(!this.lineWidth)return!1;this.matrix.transformPoint({x:n,y:t},rf);const e=Ka(this,this.lineWidth,this.dpr);return YAt(this.path.commandList,e,rf.x,rf.y)}measureText(n){throw new Error("measureText")}putImageData(n,t,e){throw new Error("measureText")}setLineDash(n){}stroke(n){}strokeRect(n,t,e,i){this.path.rect(n,t,e,i)}strokeText(n,t,e){}drawImage(){}setCommonStyle(n,t,e,i,r){}_setCommonStyle(n,t,e,i){}setStrokeStyle(n,t,e,i,r){}_setStrokeStyle(n,t,e,i){}setTextStyleWithoutAlignBaseline(n,t){}setTextStyle(n,t){}draw(){}clearMatrix(n=!0,t=this.dpr){this.setTransformFromMatrix(kMt,n,t)}setClearMatrix(n,t,e,i,r,o){this._clearMatrix.setValue(n,t,e,i,r,o)}onlyTranslate(n=this.dpr){return this.matrix.a===n&&this.matrix.b===0&&this.matrix.c===0&&this.matrix.d===n}release(...n){this.stack.forEach(t=>Hn.free(t)),this.stack.length=0}};IP=BMt([yt(),PMt("design:paramtypes",[Object,Number])],IP);const LR={WIDTH:500,HEIGHT:500,DPR:1};class GO{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}set nativeCanvas(t){this._nativeCanvas=t}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;const{nativeCanvas:i,width:r=LR.WIDTH,height:o=LR.HEIGHT,dpr:s=LR.DPR,x:a,y:l,id:h,canvasControled:u=!0}=t;this._x=a??0,this._y=l??0,this._pixelWidth=r*s,this._pixelHeight=o*s,this._visiable=t.visiable!==!1,this.controled=u,this._displayWidth=r,this._displayHeight=o,this._dpr=s,this._nativeCanvas=i,this._id=(e=i.id)!==null&&e!==void 0?e:h,h&&(i.id=h),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,i,r){return this._context.getImageData(t,e,i,r)}convertToBlob(t){throw new Error("")}transferToImageBitmap(){throw new Error("")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}GO.env="browser";var Us;(function(n){n[n.Color255=0]="Color255",n[n.Color1=1]="Color1"})(Us||(Us={}));class an{static Get(t,e=Us.Color1,i=[0,0,0,1]){if(e===Us.Color1){const s=an.store1[t];if(s)return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i;const a=c5.parseColorString(t);if(a){const l=[a.r/255,a.g/255,a.b/255,a.opacity];an.store1[t]=l,an.store255[t]=[a.r,a.g,a.b,a.opacity],i[0]=l[0],i[1]=l[1],i[2]=l[2],i[3]=l[3]}return i}const r=an.store255[t];if(r)return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i;const o=c5.parseColorString(t);return o&&(an.store1[t]=[o.r/255,o.g/255,o.b/255,o.opacity],an.store255[t]=[o.r,o.g,o.b,o.opacity],i[0]=o.r,i[1]=o.g,i[2]=o.b,i[3]=o.opacity),i}static Set(t,e,i){if(e===Us.Color1){if(an.store1[t])return;an.store1[t]=i,an.store255[t]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]}else{if(an.store255[t])return;an.store255[t]=i,an.store1[t]=[i[0]/255,i[1]/255,i[2]/255,i[3]]}}}an.store255={},an.store1={};function a_(n,t=!1){return Array.isArray(n)&&kn(n[0])?t?`rgb(${Math.round(n[0])},${Math.round(n[1])},${Math.round(n[2])},${n[3].toFixed(2)})`:`rgb(${Math.round(n[0])},${Math.round(n[1])},${Math.round(n[2])})`:n}function pc(n,t,e,i,r){return Array.isArray(n)&&!kn(n[0])||Array.isArray(t)&&!kn(t[0])?new Array(4).fill(0).map((o,s)=>{var a,l;return eW(ke(n)?(a=n[s])!==null&&a!==void 0?a:n[0]:n,ke(t)?(l=t[s])!==null&&l!==void 0?l:t[0]:t,e,i)}):eW(n,t,e,i)}function eW(n,t,e,i,r){if(!n||!t)return n&&a_(n)||t&&a_(t)||!1;let o,s,a=!1,l=!1;if(Array.isArray(n)?o=n:typeof n=="string"?o=an.Get(n,Us.Color255):a=!0,Array.isArray(t)?s=t:typeof t=="string"?s=an.Get(t,Us.Color255):l=!0,a!==l){const h=a?n:t,u=a?t:n,d=Object.assign(Object.assign({},h),{stops:h.stops.map(c=>Object.assign(Object.assign({},c),{color:a_(u)}))});return a?pc(h,d,e,i):pc(d,h,e,i)}if(a){if(n.gradient===t.gradient){const h=n,u=t,d=h.stops,c=u.stops;if(d.length!==c.length)return!1;if(h.gradient==="linear")return EMt(h,u,e);if(h.gradient==="radial")return LMt(h,u,e);if(h.gradient==="conical")return OMt(h,u,e)}return!1}return a_(DMt(o,s,e),i)}function EMt(n,t,e){const i=n.stops,r=t.stops;return{gradient:"linear",x0:n.x0+(t.x0-n.x0)*e,x1:n.x1+(t.x1-n.x1)*e,y0:n.y0+(t.y0-n.y0)*e,y1:n.y1+(t.y1-n.y1)*e,stops:new Array(i.length).fill(0).map((o,s)=>({color:$O(i[s].color,r[s].color,e),offset:i[s].offset+(r[s].offset-i[s].offset)*e}))}}function LMt(n,t,e){const i=n.stops,r=t.stops;return{gradient:"radial",x0:n.x0+(t.x0-n.x0)*e,x1:n.x1+(t.x1-n.x1)*e,y0:n.y0+(t.y0-n.y0)*e,y1:n.y1+(t.y1-n.y1)*e,r0:n.r0+(t.r0-n.r0)*e,r1:n.r1+(t.r1-n.r1)*e,stops:new Array(i.length).fill(0).map((o,s)=>({color:$O(i[s].color,r[s].color,e),offset:i[s].offset+(r[s].offset-i[s].offset)*e}))}}function OMt(n,t,e){const i=n.stops,r=t.stops;return{gradient:"conical",startAngle:n.startAngle+(t.startAngle-n.startAngle)*e,endAngle:n.endAngle+(t.endAngle-n.endAngle)*e,x:n.x+(t.x-n.x)*e,y:n.y+(t.y-n.y)*e,stops:new Array(i.length).fill(0).map((o,s)=>({color:$O(i[s].color,r[s].color,e),offset:i[s].offset+(r[s].offset-i[s].offset)*e}))}}function DMt(n,t,e){return[n[0]+(t[0]-n[0])*e,n[1]+(t[1]-n[1])*e,n[2]+(t[2]-n[2])*e,n[3]+(t[3]-n[3])*e]}function iW(n,t,e){return`rgba(${n[0]+(t[0]-n[0])*e},${n[1]+(t[1]-n[1])*e},${n[2]+(t[2]-n[2])*e},${n[3]+(t[3]-n[3])*e})`}const sl=[0,0,0,0],vv=[0,0,0,0];function $O(n,t,e){return an.Get(n,Us.Color255,sl),an.Get(t,Us.Color255,vv),`rgba(${Math.round(sl[0]+(vv[0]-sl[0])*e)},${Math.round(sl[1]+(vv[1]-sl[1])*e)},${Math.round(sl[2]+(vv[2]-sl[2])*e)},${sl[3]+(vv[3]-sl[3])*e})`}class Xo{static GetCanvas(){try{return Xo.canvas||(Xo.canvas=bt.global.createCanvas({})),Xo.canvas}catch{return null}}static GetCtx(){if(!Xo.ctx){const t=Xo.GetCanvas();Xo.ctx=t.getContext("2d")}return Xo.ctx}}class vd extends xSt{static getInstance(){return vd._instance||(vd._instance=new vd),vd._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;const i=Xo.GetCanvas(),r=Xo.GetCtx();if(i.width=e,i.height=1,!r)return;if(r.translate(0,0),!r)throw new Error("ctx");const o=r.createLinearGradient(0,0,e,0);t.forEach(s=>{o.addColorStop(s[0],s[1])}),r.fillStyle=o,r.fillRect(0,0,e,1),this.rgbaSet=r.getImageData(0,0,e,1).data}getColor(t){const e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,i,r,o=[],s=100){let a=`${t}${e}${i}${r}`;o.forEach(h=>a+=h.join()),a+=s;let l=this.dataMap.get(a);return l||(l={data:new vd(o,s),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(a,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}}class fr{static GetSize(t){for(let e=0;e<fr.ImageSize.length;e++)if(fr.ImageSize[e]>=t)return fr.ImageSize[e];return t}static Get(t,e,i,r,o,s,a){const l=fr.GenKey(t,e,i,r,o),h=fr.cache[l];if(!h||h.length===0)return null;for(let u=0;u<h.length;u++)if(h[u].width>=s&&h[u].height>=a)return h[u].pattern;return null}static Set(t,e,i,r,o,s,a,l){const h=fr.GenKey(t,e,i,r,o);fr.cache[h]?fr.cache[h].push({width:a,height:l,pattern:s}):fr.cache[h]=[{width:a,height:l,pattern:s}]}static GenKey(t,e,i,r,o){return`${e},${i},${r},${o},${t.join()}`}}fr.cache={},fr.ImageSize=[20,40,80,160,320,640,1280,2560];function IMt(n,t,e,i){const{stops:r,startAngle:o,endAngle:s}=i;for(;e<0;)e+=Zt;for(;e>Zt;)e-=Zt;if(e<o||e>s)return r[0].color;let a,l,h=(e-o)/(s-o);for(let u=0;u<r.length;u++)if(r[u].offset>=h){a=r[u-1],l=r[u];break}return h=(h-a.offset)/(l.offset-a.offset),pc(a.color,l.color,h,!1)}function HMt(n,t,e,i,r,o,s,a,l){const h=Math.floor(180*r/Math.PI),u=Xo.GetCanvas(),d=Xo.GetCtx();if(!d)return null;const c=fr.GetSize(a),f=fr.GetSize(l);let g=fr.Get(t,e,i,o,s,c,f);if(g)return g;const p=Math.sqrt(Math.max(Math.max(Math.pow(e,2)+Math.pow(i,2),Math.pow(c-e,2)+Math.pow(i,2)),Math.max(Math.pow(c-e,2)+Math.pow(f-i,2),Math.pow(e,2)+Math.pow(f-i,2)))),v=h+1,m=r/Math.max(1,v-1),y=vd.getInstance().GetOrCreate(e,i,c,f,t,v),b=2*Math.PI*p/360;u.width=c,u.height=f,d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,c,f),d.translate(e,i),d.rotate(o);for(let w=0,C=v-1;w<C&&!(o+w*m>s);w++){const x=y.getColor(w);d.beginPath(),d.rotate(m),d.moveTo(0,0),d.lineTo(p,-2*b),d.lineTo(p,0),d.fillStyle=x,d.closePath(),d.fill()}const _=d.getImageData(0,0,c,f);return u.width=_.width,u.height=_.height,d.putImageData(_,0,0),g=n.createPattern(u,"no-repeat"),g&&fr.Set(t,e,i,o,s,g,c,f),g}const l_=new Fn,FMt=new mr;new Fn;const vs=["lineWidth","scaleX","scaleY","angle","anchor","visible"],nW=["x","y"],rW=["scaleX","scaleY"],oW=["angle"],mv=new Je,sa={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class An extends eTt{static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const r=e[i];Object.defineProperty(An.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get AABBBounds(){return this.tryUpdateAABBBounds()}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new Fn,this._updateTag=Ye.INIT,this.attribute=t,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,t.background?this.loadImage((e=t.background.background)!==null&&e!==void 0?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}getGraphicService(){var t,e;return(e=(t=this.stage)===null||t===void 0?void 0:t.graphicService)!==null&&e!==void 0?e:bt.graphicService}getAttributes(){return this.attribute}setMode(t){t==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var i,r;const{dx:o=t.dx,dy:s=t.dy}=this.attribute;if(e&&this.parent){const a=this.parent.attribute;mv.x=o+((i=a.scrollX)!==null&&i!==void 0?i:0),mv.y=s+((r=a.scrollY)!==null&&r!==void 0?r:0)}else mv.x=o,mv.y=s;return mv}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(){const t=this.attribute.boundsMode==="imprecise";if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const e=this.doUpdateAABBBounds(t);return this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),this.attribute.boundsMode==="empty"&&e.clear(),e}tryUpdateOBBBounds(){return this._OBBBounds||(this._OBBBounds=new kO),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}combindShadowAABBBounds(t){if(this.shadowRoot){const e=this.shadowRoot.AABBBounds.clone();t.union(e)}}doUpdateOBBBounds(){return this._OBBBounds}getClipPath(){const{clipConfig:t}=this.attribute;if(!t)return null;this.clipPathMap||(this.clipPathMap=new Map);const{shape:e}=t;let i=this.clipPathMap.get(e)||null;return i||(this.clipPathMap.size>10&&this.clipPathMap.clear(),i=this.parsePath(e),i&&this.clipPathMap.set(e,i)),i}parsePath(t){if(!t)return null;let e=kK[t];if(e||(e=An.userSymbolMap[t],e))return e;const i=oMt[t];if(gMt(t=i||t)===!0){const h=new iA,{svg:u}=h.parse(t);if(!u)return null;const d=ke(u.path)?u.path:[u.path];l_.clear();const c=[];d.forEach(m=>{const y=new wn().fromString(m.d),b={};wMt.forEach(_=>{m[_]&&(b[HK[_]]=m[_])}),c.push({path:y,attribute:b}),l_.union(y.bounds)});const f=l_.width(),g=l_.height(),p=1/Il(f,g);c.forEach(m=>m.path.transform(0,0,p,p));const v=new Z5(t,c,!0);return An.userSymbolMap[t]=v,v}const r=new wn().fromString(t),o=r.bounds.width(),s=r.bounds.height(),a=1/Il(o,s);r.transform(0,0,a,a);const l=new Z5(t,r);return An.userSymbolMap[t]=l,l}doUpdateAABBBounds(t){this.updateAABBBoundsStamp++;const e=this.getGraphicTheme();this._AABBBounds.clear();const i=this.attribute,r=this.updateAABBBounds(i,e,this._AABBBounds,t),{boundsPadding:o=e.boundsPadding}=i,s=jw(o);return s&&r.expand(s),this.clearUpdateBoundTag(),r}updatePathProxyAABBBounds(t){const e=typeof this.pathProxy=="function"?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;const i=new EO(t);return Xl(e.commandList,i,0,0),!0}tryUpdateGlobalAABBBounds(){const t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){const e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new mr),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&Ye.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&Ye.UPDATE_BOUNDS)&&this.getGraphicService().validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&Ye.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&Ye.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&Ye.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;const i=this.attribute;return Number.isFinite(((t=i.x)!==null&&t!==void 0?t:0)+((e=i.y)!==null&&e!==void 0?e:0))}_validNumber(t){return t==null||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&Ye.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=Ye.CLEAR_SHAPE}containsPoint(t,e,i,r){if(!r)return!1;if(i===Tm.GLOBAL){const o=new Je(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(o,o),t=o.x,e=o.y}return r.containsPoint(this,{x:t,y:e})}setWidthHeightWithoutTransform(t){this.widthWithoutTransform=t.x2-t.x1,this.heightWithoutTransform=t.y2-t.y1}setAttributesAndPreventAnimate(t,e=!1,i,r){this.setAttributes(t,e,i),this.animates&&this.animates.forEach(o=>{(o.priority!==1/0||r)&&Object.keys(t).forEach(s=>{o.preventAttr(s)})})}setAttributes(t,e=!1,i){t&&((t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,i))}_setAttributes(t,e=!1,i){const r=Object.keys(t);for(let o=0;o<r.length;o++){const s=r[o];this.attribute[s]=t[s]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(r)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(t,e,i,r){var o;const s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);s?this._setAttributes(s,i,r):gi((o=this.normalAttrs)===null||o===void 0?void 0:o[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[t]=e,t==="background"?this.loadImage(e,!0):t==="shadowGraphic"&&this.setShadowGraphic(e)}needUpdateTags(t,e=vs){for(let i=0;i<e.length;i++){const r=e[i];if(t.indexOf(r)!==-1)return!0}return!1}needUpdateTag(t,e=vs){for(let i=0;i<e.length;i++)if(t===e[i])return!0;return!1}initAttributes(t){const e={type:xr.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=Ye.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var i,r;if(t===0&&e===0)return this;const o={type:xr.TRANSLATE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,nW,o);s&&(t=s.x,e=s.y,delete s.x,delete s.y,this._setAttributes(s));const a=this.attribute,l=a.postMatrix;return l?bt.transformUtil.fromMatrix(l,l).translate(t,e):(a.x=((i=a.x)!==null&&i!==void 0?i:Rn.x)+t,a.y=((r=a.y)!==null&&r!==void 0?r:Rn.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this}translateTo(t,e){const i=this.attribute;if(i.x===t&&i.y===e)return this;const r={type:xr.TRANSLATE_TO},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,nW,r);return o?(this._setAttributes(o,!1,r),this):(i.x=t,i.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this)}scale(t,e,i){var r,o;if(t===1&&e===1)return this;const s={type:xr.SCALE},a=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:i},this.attribute,rW,s);a&&(t=a.scaleX,e=a.scaleY,delete a.scaleX,delete a.scaleY,this._setAttributes(a));const l=this.attribute;if(i){let{postMatrix:h}=this.attribute;h||(h=new mr,l.postMatrix=h),bt.transformUtil.fromMatrix(h,h).scale(t,e,i)}else l.scaleX=((r=l.scaleX)!==null&&r!==void 0?r:Rn.scaleX)*t,l.scaleY=((o=l.scaleY)!==null&&o!==void 0?o:Rn.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(s),this}scaleTo(t,e){const i=this.attribute;if(i.scaleX===t&&i.scaleY===e)return this;const r={type:xr.SCALE_TO},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,rW,r);return o?(this._setAttributes(o,!1,r),this):(i.scaleX=t,i.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this)}rotate(t,e){var i;if(t===0)return this;const r={type:xr.ROTATE},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,oW,r);o&&(delete o.angle,this._setAttributes(o,!1,r));const s=this.attribute;if(e){let{postMatrix:a}=this.attribute;a||(a=new mr,s.postMatrix=a),bt.transformUtil.fromMatrix(a,a).rotate(t,e)}else s.angle=((i=s.angle)!==null&&i!==void 0?i:Rn.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}rotateTo(t){const e=this.attribute;if(e.angle===t)return this;const i={type:xr.ROTATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,oW,i);return r?(this._setAttributes(r,!1,i),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i),this)}skewTo(t,e){return this}onAttributeUpdate(t){t&&t.skipUpdateCallback||(this.getGraphicService().onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds(),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!gi(t)||this.currentStates.includes(t))}getState(t){var e;return(e=this.states)===null||e===void 0?void 0:e[t]}applyStateAttrs(t,e,i,r){var o,s;if(i){const a=Object.keys(t),l=this.getNoWorkAnimateAttr(),h={};let u;a.forEach(c=>{l[c]?(u||(u={}),u[c]=t[c]):h[c]=r&&t[c]===void 0?this.getDefaultAttribute(c):t[c]});const d=(s=(o=this.context&&this.context.stateAnimateConfig)!==null&&o!==void 0?o:this.stateAnimateConfig)!==null&&s!==void 0?s:xMt;this.applyAnimationState(["state"],[{name:"state",animation:{type:"state",to:h,duration:d.duration,easing:d.easing}}]),u&&this.setAttributesAndPreventAnimate(u,!1,{type:xr.STATE})}else this.stopStateAnimates(),this.setAttributesAndPreventAnimate(t,!1,{type:xr.STATE}),this.finalAttribute&&Object.assign(this.finalAttribute,t);this._emitCustomEvent("afterStateUpdate",{type:xr.STATE})}updateNormalAttrs(t){const e={};this.normalAttrs?(Object.keys(t).forEach(i=>{i in this.normalAttrs?(e[i]=this.normalAttrs[i],delete this.normalAttrs[i]):e[i]=this.getNormalAttribute(i)}),Object.keys(this.normalAttrs).forEach(i=>{t[i]=this.normalAttrs[i]})):Object.keys(t).forEach(i=>{e[i]=this.getNormalAttribute(i)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){var e,i;const r=this.attribute[t];return this.animates?(e=this.finalAttribute)===null||e===void 0?void 0:e[t]:r??((i=this.finalAttribute)===null||i===void 0?void 0:i[t])}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if(this.currentStates){const i=ke(t)?o=>!t.includes(o):o=>o!==t,r=this.currentStates.filter(i);r.length!==this.currentStates.length&&this.useStates(r,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){const i=this.currentStates?this.currentStates.slice():[];i.push(t),this.useStates(i,e)}}addState(t,e,i){var r;if(this.currentStates&&this.currentStates.includes(t)&&(e||this.currentStates.length===1))return;const o=e&&(!((r=this.currentStates)===null||r===void 0)&&r.length)?this.currentStates.concat([t]):[t];this.useStates(o,i)}useStates(t,e){var i;if(!t.length)return void this.clearStates(e);if(!(((i=this.currentStates)===null||i===void 0?void 0:i.length)!==t.length||t.some((o,s)=>this.currentStates[s]!==o)))return;const r={};t.forEach(o=>{var s;const a=this.stateProxy?this.stateProxy(o,t):(s=this.states)===null||s===void 0?void 0:s[o];a&&Object.assign(r,a)}),this.updateNormalAttrs(r),this.currentStates=t,this.applyStateAttrs(r,t,e)}addUpdateBoundTag(){this._updateTag|=Ye.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=Ye.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=Ye.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&Ye.UPDATE_SHAPE_AND_BOUNDS)===Ye.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=Ye.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=Ye.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=Ye.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=Ye.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=Ye.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=Ye.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=Ye.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&Ye.UPDATE_LAYOUT)}getAnchor(t,e,i){const r=[0,0],o=()=>{if(e.b)return e.b;const s=this.clone();return s.attribute.angle=0,s.attribute.scaleCenter=null,i&&(s.attribute.scaleX=1,s.attribute.scaleY=1),e.b=s.AABBBounds,e.b};if(typeof t[0]=="string"){const s=parseFloat(t[0])/100,a=o();r[0]=a.x1+(a.x2-a.x1)*s}else r[0]=t[0];if(typeof t[1]=="string"){const s=parseFloat(t[1])/100,a=o();r[1]=a.y1+(a.y2-a.y1)*s}else r[1]=t[1];return r}doUpdateLocalMatrix(){const{x:t=Rn.x,y:e=Rn.y,scaleX:i=Rn.scaleX,scaleY:r=Rn.scaleY,angle:o=Rn.angle,scaleCenter:s,anchor:a,postMatrix:l}=this.attribute;let h=[0,0];const u={};if(a&&o&&(h=this.getAnchor(a,u)),!s||i===1&&r===1)wSt(this._transMatrix,this._transMatrix.reset(),t,e,i,r,o,a&&h);else{const c=this._transMatrix;c.reset(),c.translate(h[0],h[1]),c.rotate(o),c.translate(-h[0],-h[1]),c.translate(t,e),h=this.getAnchor(s,u,!0),bt.transformUtil.fromMatrix(c,c).scale(i,r,{x:h[0],y:h[1]})}const d=this.getOffsetXY(Rn);if(this._transMatrix.e+=d.x,this._transMatrix.f+=d.y,l){const c=FMt.setValue(l.a,l.b,l.c,l.d,l.e,l.f),f=this._transMatrix;c.multiply(f.a,f.b,f.c,f.d,f.e,f.f),f.setValue(c.a,c.b,c.c,c.d,c.e,c.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);const{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){const i=t.getTimeline();this.animates.forEach(r=>{r.timeline.isGlobal&&(r.setTimeline(i),i.addAnimate(r))})}this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:xr.ANIMATE_END})}getDefaultAttribute(t){return this.getGraphicTheme()[t]}getComputedAttribute(t){var e;return(e=this.attribute[t])!==null&&e!==void 0?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=t??bt.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot.release(!0),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return Ha(t,!0)?this.pathProxy=new wn().fromString(t):this.pathProxy=new wn,this.pathProxy}loadImage(t,e=!1){if(!t||e&&zMt(t))return;const i=t;this.resources||(this.resources=new Map);const r={data:"init",state:null};this.resources.set(i,r),typeof t=="string"?(r.state="loading",t.startsWith("<svg")?(Xe.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(aSt(t)||t.includes("/")||lSt(t))&&(Xe.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):gd(t)?(r.state="success",r.data=t,this.backgroundImg=this.backgroundImg||e):r.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,i){if(!this.resources)return;const r=this.resources.get(t);r&&(r.state="success",r.data=e,i&&i(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;const i=this.resources.get(t);i&&(i.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(e=>{e.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",this.stopAnimates(),bt.graphicService.onRelease(this)}_emitCustomEvent(t,e){var i,r;if(this._events&&t in this._events){const o=new IO(t,e);o.bubbles=!1,o.manager=(r=(i=this.stage)===null||i===void 0?void 0:i.eventSystem)===null||r===void 0?void 0:r.manager,this.dispatchEvent(o)}}toCustomPath(){var t,e,i;const r=(i=(e=((t=this.stage)===null||t===void 0?void 0:t.renderService)||bt.renderService)===null||e===void 0?void 0:e.drawContribution)===null||i===void 0?void 0:i.getRenderContribution(this);if(r){const o=new IP(null,1);return r.drawShape(this,o,0,0,{},{}),o.path}return null}}function zMt(n){return!(!n.fill&&!n.stroke)}An.userSymbolMap={},An.mixin(nTt);var sW;(function(n){n[n.LESS_GROUP=0]="LESS_GROUP",n[n.MORE_GROUP=1]="MORE_GROUP"})(sW||(sW={}));let ge=class HP extends An{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=FO,this._childUpdateTag=Ye.UPDATE_BOUNDS}setMode(t){t==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new km),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new km)}visibleAll(t){this.setAttribute("visible",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(t,e,i){if(i===Tm.GLOBAL){const r=new Je(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),this.AABBBounds.contains(r.x,r.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&Ye.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.getGraphicService().beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),this.getGraphicService().afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),this.attribute.boundsMode==="empty"&&e.clear(),e}doUpdateLocalMatrix(){const{x:t=Rn.x,y:e=Rn.y,dx:i=Rn.dx,dy:r=Rn.dy,scaleX:o=Rn.scaleX,scaleY:s=Rn.scaleY,angle:a=Rn.angle,postMatrix:l}=this.attribute;if(t!==0||e!==0||i!==0||r!==0||o!==1||s!==1||a!==0||l)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return te(this).group}updateAABBBounds(t,e,i){const r=i;i=i.clone();const{width:o,height:s,path:a,clip:l=e.clip}=t;if(a&&a.length?a.forEach(h=>{i.union(h.AABBBounds)}):o!=null&&s!=null&&i.set(0,0,Math.max(0,o),Math.max(0,s)),!l){this.forEachChildren(d=>{i.union(d.AABBBounds)});const{scrollX:h=0,scrollY:u=0}=t;i.translate(h,u)}return bt.graphicService.updateTempAABBBounds(i),bt.graphicService.transformAABBBounds(t,i,e,!1,this),r.copy(i),r}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;const t=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}clearUpdateBoundTag(){this._updateTag&=Ye.CLEAR_BOUNDS,this._childUpdateTag&=Ye.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=Ye.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&Ye.UPDATE_BOUNDS||(this._childUpdateTag|=Ye.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){const e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),this.getGraphicService().onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),this.getGraphicService().onClearIncremental(this,this.stage)}_updateChildToStage(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}appendChild(t,e=!0){const i=super.appendChild(t);return e&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(t,e){return this._updateChildToStage(super.insertBefore(t,e))}insertAfter(t,e){return this._updateChildToStage(super.insertAfter(t,e))}insertInto(t,e){return this._updateChildToStage(super.insertInto(t,e))}removeChild(t){const e=super.removeChild(t);return this.getGraphicService().onRemove(t),t.stage=null,this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{this.getGraphicService().onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),this.getGraphicService().onSetStage(this,t),this.forEachChildren(i=>{i.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){const e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&Ye.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(i=>i.name===t,e)}createOrUpdateChild(t,e,i){let r=this._getChildByName(t);return r?r.setAttributes(e):(r=bt.graphicService.creator[i](e),r.name=t,this.add(r)),r}clone(){return new HP(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return HP.NOWORK_ANIMATE_ATTR}release(t){t&&this.forEachChildren(e=>{e.release(t)}),super.release()}};ge.NOWORK_ANIMATE_ATTR=sa;function Xw(n){return new ge(n)}class NMt extends ge{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw new Error("")}get dpr(){return this._dpr}constructor(t,e,i,r){var o;super({}),this.stage=t,this.global=e,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:(o=r.zIndex)!==null&&o!==void 0?o:0}),this.layer=this,this.subLayers=new Map,this.theme=new km,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){const e=Array.from(this.subLayers.values()).sort((i,r)=>i.zIndex-r.zIndex);this.layerHandler.merge(e.map(i=>(i.layer.subLayers.size&&i.layer.combineSubLayer(t),i.layer.getNativeHandler()))),t&&e.forEach(i=>{i.group&&(i.group.incremental=0)}),e.forEach(i=>{bt.layerService.releaseLayer(this.stage,i.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw new Error("")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(i=>{i.layer.renderCount=this.renderCount,i.layer.render(t,e)})}render(t,e){var i;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:(i=t.background)!==null&&i!==void 0?i:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(r=>r(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw new Error("")}setToFrame(t){throw new Error("")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{bt.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var i;this.layerHandler.drawTo(t,[this],Object.assign({background:(i=e.background)!==null&&i!==void 0?i:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(r=>r(this))}}const zK=Symbol.for("TransformUtil"),NK=Symbol.for("GraphicUtil"),jO=Symbol.for("LayerService"),WK=Symbol.for("StaticLayerHandlerContribution"),WMt=Symbol.for("DynamicLayerHandlerContribution"),VMt=Symbol.for("VirtualLayerHandlerContribution");var $v,GMt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},$Mt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let jv=$v=class{static GenerateLayerId(){return`${$v.idprefix}_${$v.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=bt.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(n){return this.layerMap.get(n)}getRecommendedLayerType(n){return n||(this.staticLayerCountInEnv!==0?"static":this.dynamicLayerCountInEnv!==0?"dynamic":"virtual")}getLayerHandler(n){let t;return t=n==="static"?Nt.get(WK):n==="dynamic"?Nt.get(WMt):Nt.get(VMt),t}createLayer(n,t={main:!1}){var e;this.tryInit();let i=this.getRecommendedLayerType(t.layerMode);i=t.main||t.canvasId?"static":i;const r=this.getLayerHandler(i),o=new NMt(n,this.global,n.window,Object.assign(Object.assign({main:!1},t),{layerMode:i,canvasId:(e=t.canvasId)!==null&&e!==void 0?e:$v.GenerateLayerId(),layerHandler:r})),s=this.layerMap.get(n)||[];return s.push(o),this.layerMap.set(n,s),this.staticLayerCountInEnv--,o}prepareStageLayer(n){let t;n.forEachChildren(e=>{const i=e.getNativeHandler();i.type==="virtual"?(i.mainHandler=t,t.secondaryHandlers.push(i)):(t=i,t.secondaryHandlers=[])})}releaseLayer(n,t){t.release();const e=this.layerMap.get(n)||[];this.layerMap.set(n,e.filter(i=>i!==t))}layerCount(n){return(this.layerMap.get(n)||[]).length}restLayerCount(n){return this.global.env==="browser"?10:0}releaseStage(n){this.layerMap.delete(n)}};jv.idprefix="visactor_layer",jv.prefix_count=0,jv=$v=GMt([yt(),$Mt("design:paramtypes",[])],jv);const jMt=new Ut(n=>{n(RO).to(xP).inSingletonScope(),n(Pm).to(BP),n(NK).to(PP).inSingletonScope(),n(zK).to(kP).inSingletonScope(),n(jO).to(jv).inSingletonScope()});function Zg(n,t){return!(!n&&!t)}function Em(n,t){let e;return e=ke(n)?n.some(i=>i||i===void 0):!!n,e&&t>0}function vc(n,t,e){return e&&n*t>0}function VK(n,t,e,i,r){return r&&n*t>0&&e!==0&&i!==0}function FP(n,t){return n*t>0}function GK(n,t,e,i,r){return r?n*t>0:n*t>0&&e!==0&&i!==0}function UMt(n,t,e,i,r,o,s,a){const l=e-n,h=i-t,u=s-r,d=a-o;let c=d*l-u*h;return c*c<ii?[]:(c=(u*(t-o)-d*(n-r))/c,[n+c*l,t+c*h])}function Hh(n,t,e,i,r,o,s){const a=n-e,l=t-i,h=(s?o:-o)/Math.sqrt(a*a+l*l),u=h*l,d=-h*a,c=n+u,f=t+d,g=e+u,p=i+d,v=(c+g)/2,m=(f+p)/2,y=g-c,b=p-f,_=y*y+b*b,w=r-o,C=c*p-g*f,x=(b<0?-1:1)*Math.sqrt(Math.max(0,w*w*_-C*C));let S=(C*b-y*x)/_,A=(-C*y-b*x)/_;const T=(C*b+y*x)/_,M=(-C*y+b*x)/_,R=S-v,E=A-m,P=T-v,B=M-m;return R*R+E*E>P*P+B*B&&(S=T,A=M),{cx:S,cy:A,x01:-u,y01:-d,x11:S*(r/w-1),y11:A*(r/w-1)}}function $K(n,t,e,i,r){const o=De(e-t),s=n.getParsedCornerRadius(),a=ke(s),{outerDeltaAngle:l,innerDeltaAngle:h,outerStartAngle:u,outerEndAngle:d,innerEndAngle:c,innerStartAngle:f}=n.getParsePadAngle(t,e),g=a?s[0]:s,p=a?s[1]:s,v=a?s[2]:s,m=a?s[3]:s,y=Math.max(p,g),b=Math.max(v,m);let _=y,w=b;const C=r*hn(u),x=r*xi(u),S=i*hn(c),A=i*xi(c);let T,M,R,E;if((b>ii||y>ii)&&(T=r*hn(d),M=r*xi(d),R=i*hn(f),E=i*xi(f),o<Fi)){const P=UMt(C,x,R,E,T,M,S,A);if(P){const B=C-P[0],k=x-P[1],L=T-P[0],O=M-P[1],D=1/xi(pSt((B*L+k*O)/(js(B*B+k*k)*js(L*L+O*O)))/2),I=js(P[0]*P[0]+P[1]*P[1]);w=er(b,(i-I)/(D-1)),_=er(y,(r-I)/(D+1))}}return{outerDeltaAngle:l,xors:C,yors:x,xirs:R,yirs:E,xore:T,yore:M,xire:S,yire:A,limitedOcr:_,limitedIcr:w,outerCornerRadiusStart:g,outerCornerRadiusEnd:p,maxOuterCornerRadius:y,maxInnerCornerRadius:b,outerStartAngle:u,outerEndAngle:d,innerDeltaAngle:h,innerEndAngle:c,innerStartAngle:f,innerCornerRadiusStart:m,innerCornerRadiusEnd:v}}function zP(n,t,e,i,r,o,s){const{startAngle:a,endAngle:l}=n.getParsedAngle(),h=De(l-a),u=l>a;let d=!1;if(r<o){const c=r;r=o,o=c}if(r<=ii)t.moveTo(e,i);else if(h>=Zt-ii)t.moveTo(e+r*hn(a),i+r*xi(a)),t.arc(e,i,r,a,l,!u),o>ii&&(t.moveTo(e+o*hn(l),i+o*xi(l)),t.arc(e,i,o,l,a,u));else{const{outerDeltaAngle:c,xors:f,yors:g,xirs:p,yirs:v,limitedOcr:m,outerCornerRadiusStart:y,outerCornerRadiusEnd:b,maxOuterCornerRadius:_,xore:w,yore:C,xire:x,yire:S,outerStartAngle:A,outerEndAngle:T,limitedIcr:M,innerDeltaAngle:R,innerEndAngle:E,innerStartAngle:P,innerCornerRadiusStart:B,innerCornerRadiusEnd:k,maxInnerCornerRadius:L}=$K(n,a,l,o,r);if(c<.001)s&&(s[3]||s[1])&&t.moveTo(e+f,i+g),d=!0;else if(m>ii){const O=er(y,m),D=er(b,m),I=Hh(p,v,f,g,r,O,Number(u)),H=Hh(w,C,x,S,r,D,Number(u));m<_&&O===D?!s||s[0]?(t.moveTo(e+I.cx+I.x01,i+I.cy+I.y01),t.arc(e+I.cx,i+I.cy,m,Le(I.y01,I.x01),Le(H.y01,H.x01),!u)):t.moveTo(e+I.cx+m*hn(Le(H.y01,H.x01)),i+I.cy+m*xi(Le(H.y01,H.x01))):!s||s[0]?(t.moveTo(e+I.cx+I.x01,i+I.cy+I.y01),O>0&&t.arc(e+I.cx,i+I.cy,O,Le(I.y01,I.x01),Le(I.y11,I.x11),!u),t.arc(e,i,r,Le(I.cy+I.y11,I.cx+I.x11),Le(H.cy+H.y11,H.cx+H.x11),!u),D>0&&t.arc(e+H.cx,i+H.cy,D,Le(H.y11,H.x11),Le(H.y01,H.x01),!u)):D>0?t.moveTo(e+H.cx+D*hn(Le(H.y01,H.x01)),i+H.cy+D*xi(Le(H.y01,H.x01))):t.moveTo(e+w,i+r*xi(T))}else!s||s[0]?(t.moveTo(e+f,i+g),t.arc(e,i,r,A,T,!u)):t.moveTo(e+r*hn(T),i+r*xi(T));if(!(o>ii)||R<.001)!s||s[1]?t.lineTo(e+x,i+S):t.moveTo(e+x,i+S),d=!0;else if(M>ii){const O=er(B,M),D=er(k,M),I=Hh(x,S,w,C,o,-D,Number(u)),H=Hh(f,g,p,v,o,-O,Number(u));if(!s||s[1]?t.lineTo(e+I.cx+I.x01,i+I.cy+I.y01):t.moveTo(e+I.cx+I.x01,i+I.cy+I.y01),M<L&&O===D){const F=Le(H.y01,H.x01);!s||s[2]?t.arc(e+I.cx,i+I.cy,M,Le(I.y01,I.x01),F,!u):t.moveTo(e+I.cx+hn(F),i+I.cy+xi(F))}else!s||s[2]?(D>0&&t.arc(e+I.cx,i+I.cy,D,Le(I.y01,I.x01),Le(I.y11,I.x11),!u),t.arc(e,i,o,Le(I.cy+I.y11,I.cx+I.x11),Le(H.cy+H.y11,H.cx+H.x11),u),O>0&&t.arc(e+H.cx,i+H.cy,O,Le(H.y11,H.x11),Le(H.y01,H.x01),!u)):O>0?t.moveTo(e+H.cx+O*hn(Le(H.y01,H.x01)),i+H.cy+O*xi(Le(H.y01,H.x01))):t.moveTo(e+p,i+v)}else!s||s[1]?t.lineTo(e+x,i+S):t.moveTo(e+x,i+S),!s||s[2]?t.arc(e,i,o,E,P,u):t.moveTo(e+o*hn(P),i+o*xi(P))}return s?s[3]&&t.lineTo(e+r*hn(a),i+r*xi(a)):t.closePath(),d}const NP=Symbol.for("ArcRenderContribution"),XMt=Symbol.for("AreaRenderContribution"),WP=Symbol.for("CircleRenderContribution"),No=Symbol.for("GroupRenderContribution"),Bd=Symbol.for("ImageRenderContribution"),VP=Symbol.for("PathRenderContribution"),GP=Symbol.for("PolygonRenderContribution"),Pd=Symbol.for("RectRenderContribution"),$P=Symbol.for("SymbolRenderContribution"),Yw=Symbol.for("TextRenderContribution"),UO=Symbol.for("InteractiveSubRenderContribution");function Jg(n,t){return n==="end"||n==="right"?-t:n==="center"?-t/2:0}function Lm(n,t,e,i=0){return n==="middle"?-t/2:n==="top"?0:n==="bottom"?i-t:n&&n!=="alphabetic"?0:(e||(e=t),-(t-e)/2-.79*e)}var YMt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},KMt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},qMt=function(n,t){return function(e,i){t(e,i,n)}};function jK(n,t,e){var i;const{x:r=e.x,y:o=e.y,z:s=e.z,dx:a=e.dx,dy:l=e.dy,dz:h=e.dz,scaleX:u=e.scaleX,scaleY:d=e.scaleY,scaleZ:c=e.scaleZ,alpha:f=e.alpha,beta:g=e.beta,angle:p=e.angle,anchor3d:v=t.attribute.anchor,anchor:m}=t.attribute,y=[0,0,0];if(v){if(typeof v[0]=="string"){const b=parseFloat(v[0])/100,_=t.AABBBounds;y[0]=_.x1+(_.x2-_.x1)*b}else y[0]=v[0];if(typeof v[1]=="string"){const b=parseFloat(v[1])/100,_=t.AABBBounds;y[1]=_.x1+(_.x2-_.x1)*b}else y[1]=v[1];y[2]=(i=v[2])!==null&&i!==void 0?i:0}if(FK(n),pv(n,n,[r+a,o+l,s+h]),pv(n,n,[y[0],y[1],y[2]]),SMt(n,n,g),AMt(n,n,f),pv(n,n,[-y[0],-y[1],y[2]]),MMt(n,n,[u,d,c]),p){const b=fn.allocate(),_=[0,0];if(m){if(typeof v[0]=="string"){const w=parseFloat(v[0])/100,C=t.AABBBounds;_[0]=C.x1+(C.x2-C.x1)*w}else _[0]=v[0];if(typeof v[1]=="string"){const w=parseFloat(v[1])/100,C=t.AABBBounds;_[1]=C.x1+(C.x2-C.x1)*w}else _[1]=v[1]}pv(b,b,[_[0],_[1],0]),TMt(b,b,p),pv(b,b,[-_[0],-_[1],0]),Ry(n,n,b)}}function ZMt(n){const{alpha:t,beta:e}=n.attribute;return t||e}let jP=class{constructor(n){this.creator=n,this.hooks={onAttributeUpdate:new cr(["graphic"]),onSetStage:new cr(["graphic","stage"]),onRemove:new cr(["graphic"]),onRelease:new cr(["graphic"]),onAddIncremental:new cr(["graphic","group","stage"]),onClearIncremental:new cr(["graphic","group","stage"]),beforeUpdateAABBBounds:new cr(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new cr(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new cr(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new Fn,this.tempAABBBounds2=new Fn}onAttributeUpdate(n){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(n)}onSetStage(n,t){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(n,t)}onRemove(n){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(n)}onRelease(n){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(n)}onAddIncremental(n,t,e){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(n,t,e)}onClearIncremental(n,t){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(n,t)}beforeUpdateAABBBounds(n,t,e,i){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(n,t,e,i)}afterUpdateAABBBounds(n,t,e,i,r){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(n,t,e,i,r)}clearAABBBounds(n,t,e){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(n,t,e)}updatePathProxyAABBBounds(n,t){const e=typeof t.pathProxy=="function"?t.pathProxy(t.attribute):t.pathProxy;if(!e)return!1;const i=new EO(n);return Xl(e.commandList,i,0,0),!0}updateHTMLTextAABBBounds(n,t,e,i){const{textAlign:r,textBaseline:o}=n;if(n.forceBoundsHeight!=null){const s=kn(n.forceBoundsHeight)?n.forceBoundsHeight:n.forceBoundsHeight(),a=Lm(o,s,s);e.set(e.x1,a,e.x2,a+s)}if(n.forceBoundsWidth!=null){const s=kn(n.forceBoundsWidth)?n.forceBoundsWidth:n.forceBoundsWidth(),a=Jg(r,s);e.set(a,e.y1,a+s,e.y2)}}combindShadowAABBBounds(n,t){if(t&&t.shadowRoot){const e=t.shadowRoot.AABBBounds;n.union(e)}}transformAABBBounds(n,t,e,i,r){if(!t.empty()){const{scaleX:a=e.scaleX,scaleY:l=e.scaleY,stroke:h=e.stroke,shadowBlur:u=e.shadowBlur,lineWidth:d=e.lineWidth,pickStrokeBuffer:c=e.pickStrokeBuffer,strokeBoundsBuffer:f=e.strokeBoundsBuffer}=n,g=this.tempAABBBounds1,p=this.tempAABBBounds2;if(h&&d){const v=(d+c)/Math.abs(a+l);Uw(g,v,i,f),t.union(g),g.setValue(p.x1,p.y1,p.x2,p.y2)}if(u){const{shadowOffsetX:v=e.shadowOffsetX,shadowOffsetY:m=e.shadowOffsetY}=n,y=u/Math.abs(a+l)*2;Uw(g,y,!1,f+1),g.translate(v,m),t.union(g)}}if(this.combindShadowAABBBounds(t,r),t.empty())return;let o=!0;const s=r.transMatrix;r&&r.isContainer&&(o=!(s.a===1&&s.b===0&&s.c===0&&s.d===1&&s.e===0&&s.f===0)),o&&PO(t,t,s)}validCheck(n,t,e,i){if(!i||n.forceBoundsHeight!=null||n.forceBoundsWidth!=null||i.shadowRoot||i.isContainer)return!0;const{visible:r=t.visible}=n;return!(!i.valid||!r)||(e.empty()||(i.parent&&e.transformWithMatrix(i.parent.globalTransMatrix),this.clearAABBBounds(i,i.stage,e),e.clear()),!1)}updateTempAABBBounds(n){const t=this.tempAABBBounds1,e=this.tempAABBBounds2;return t.setValue(n.x1,n.y1,n.x2,n.y2),e.setValue(n.x1,n.y1,n.x2,n.y2),{tb1:t,tb2:e}}};jP=YMt([yt(),qMt(0,le(IK)),KMt("design:paramtypes",[Object])],jP);const By=(n,t,e)=>{const{outerBorder:i,shadowBlur:r=t.shadowBlur}=n;if(i){const o=t.outerBorder,{distance:s=o.distance,lineWidth:a=o.lineWidth}=i;e.expand(s+(r+a)/2)}return e},aW=["radius","startAngle","endAngle",...vs];class ru extends An{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=rA}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:t,endAngle:e,radius:i}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)}getGraphicTheme(){return te(this).circle}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateCircleAABBBoundsImprecise(t,e,i):this.updateCircleAABBBoundsAccurate(t,e,i));const{tb1:o,tb2:s}=bt.graphicService.updateTempAABBBounds(i);return By(t,e,o),i.union(o),o.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,bt.graphicService.transformAABBBounds(t,i,e,!1,this),i}updateCircleAABBBoundsImprecise(t,e,i){const{radius:r=e.radius}=t;return i.set(-r,-r,r,r),i}updateCircleAABBBoundsAccurate(t,e,i){const{startAngle:r=e.startAngle,endAngle:o=e.endAngle,radius:s=e.radius}=t;return o-r>Zt-ii?i.set(-s,-s,s,s):EP(r,o,s,i),i}needUpdateTags(t){return super.needUpdateTags(t,aW)}needUpdateTag(t){return super.needUpdateTag(t,aW)}toCustomPath(){var t,e,i;let r=super.toCustomPath();if(r)return r;const o=this.attribute,s=(t=o.radius)!==null&&t!==void 0?t:this.getDefaultAttribute("radius"),a=(e=o.startAngle)!==null&&e!==void 0?e:this.getDefaultAttribute("startAngle"),l=(i=o.endAngle)!==null&&i!==void 0?i:this.getDefaultAttribute("endAngle");return r=new wn,r.arc(0,0,s,a,l),r}clone(){return new ru(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return ru.NOWORK_ANIMATE_ATTR}}ru.NOWORK_ANIMATE_ATTR=sa;function UK(n){return new ru(n)}class UP{constructor(t,e,i){this.fontFamily=t,this.textOptions=e,this.textMeasure=i}LayoutBBox(t,e,i,r){if(t.xOffset=e==="left"||e==="start"?0:e==="center"?t.width/-2:e==="right"||e==="end"?-t.width:0,i==="top")t.yOffset=0;else if(i==="middle")t.yOffset=t.height/-2;else if(i==="alphabetic"){let o=.79;if(r.length===1){const s=r[0];o=s.ascent/(s.ascent+s.descent)}t.yOffset=t.height*-o}else t.yOffset=-t.height;return t}GetLayoutByLines(t,e,i,r,o="",s,a){const{lineWidth:l,suffixPosition:h="end",measureMode:u=$d.actualBounding,keepCenterInLine:d=!1}=a??{};t=t.map(p=>p.toString());const c=[],f=[0,0];if(typeof l=="number"&&l!==1/0){let p;for(let v=0,m=t.length;v<m;v++){const y=this.textMeasure.measureTextPixelADscentAndWidth(t[v],this.textOptions,u);let b=t[v].toString();if(y.width>l){const _=this.textMeasure.clipTextWithSuffix(t[v],this.textOptions,l,o,s,h);b=_.str,p=_.width}else p=y.width;c.push({str:b,width:p,ascent:y.ascent,descent:y.descent,keepCenterInLine:d})}f[0]=l}else{let p,v,m=0;for(let y=0,b=t.length;y<b;y++){v=t[y];const _=this.textMeasure.measureTextPixelADscentAndWidth(t[y],this.textOptions,u);p=_.width,m=Math.max(m,p),c.push({str:v,width:p,ascent:_.ascent,descent:_.descent,keepCenterInLine:d})}f[0]=m}f[1]=c.length*r,f[0]=c.reduce((p,v)=>Math.max(p,v.width),0);const g={xOffset:0,yOffset:0,width:f[0],height:f[1]};return this.LayoutBBox(g,e,i,c),this.layoutWithBBox(g,c,e,i,r)}layoutWithBBox(t,e,i,r,o){const s=[0,0],a=e.length*o;r==="top"||(r==="middle"?s[1]=(t.height-a)/2:r==="bottom"&&(s[1]=t.height-a));for(let l=0;l<e.length;l++)this.lineOffset(t,e[l],i,r,o,s);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:o,textAlign:i,textBaseline:r}}lineOffset(t,e,i,r,o,s){if(i==="left"||i==="start"?e.leftOffset=0:i==="center"?e.leftOffset=(t.width-e.width)/2:i!=="right"&&i!=="end"||(e.leftOffset=t.width-e.width),e.topOffset=o/2+(e.ascent-e.descent)/2+s[1],!e.keepCenterInLine){const l=e.ascent+e.descent+0;if(l<o-0&&(r==="bottom"?e.topOffset+=(o-l)/2:r==="top"&&(e.topOffset-=(o-l)/2)),r==="alphabetic"){const h=o/(e.ascent+e.descent);e.topOffset=o/2+(e.ascent-e.descent)/2*h+s[1]}}return s[1]+=o,e}}const lW=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...vs];class si extends An{get font(){const t=this.getGraphicTheme();return this._font||(this._font=eK(this.attribute,t)),this._font}get clipedText(){var t;const e=this.attribute,i=this.getGraphicTheme(),r=this.getMaxWidth(i);return Number.isFinite(r)?(this.tryUpdateAABBBounds(),this.cache.clipedText):((t=e.text)!==null&&t!==void 0?t:i.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var t,e;const i=this.getGraphicTheme(),r=this.attribute,o=this.getMaxWidth(i);if(!Number.isFinite(o))return!1;const{text:s}=this.attribute;if(this.tryUpdateAABBBounds(),(e=(t=this.cache)===null||t===void 0?void 0:t.layoutData)===null||e===void 0?void 0:e.lines){let a="";return this.cache.layoutData.lines.forEach(l=>{a+=l.str}),(Array.isArray(s)?s.join(""):s).toString()!==a}return r.direction==="vertical"&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(a=>a.text).join("")!==r.text.toString():this.clipedText!=null&&this.clipedText!==r.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||this.attribute.whiteSpace==="normal"}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=hA,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{text:t}=this.attribute;return ke(t)?!t.every(e=>e==null||e===""):t!=null&&t!==""}getGraphicTheme(){return te(this).text}doUpdateOBBBounds(){const t=this.getGraphicTheme();this._OBBBounds.clear();const e=this.attribute,{angle:i=t.angle}=e;if(!i){const h=this.AABBBounds;return this._OBBBounds.setValue(h.x1,h.y1,h.x2,h.y2),this._OBBBounds}this.obbText||(this.obbText=new si({})),this.obbText.setAttributes(Object.assign(Object.assign({},e),{angle:0}));const r=this.obbText.AABBBounds,{x:o,y:s}=e,a={x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2},l=Pl(a,i,{x:o,y:s});return this._OBBBounds.copy(r),this._OBBBounds.translate(l.x-a.x,l.y-a.y),this._OBBBounds.angle=i,this._OBBBounds}updateAABBBounds(t,e,i){const{text:r=e.text}=this.attribute;Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r);const{tb1:o}=bt.graphicService.updateTempAABBBounds(i),{scaleX:s=e.scaleX,scaleY:a=e.scaleY,shadowBlur:l=e.shadowBlur,strokeBoundsBuffer:h=e.strokeBoundsBuffer}=t;if(l){const u=l/Math.abs(s+a);Uw(o,u,!0,h),i.union(o)}return bt.graphicService.combindShadowAABBBounds(i,this),t.forceBoundsHeight==null&&t.forceBoundsWidth==null||bt.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,PO(i,i,this.transMatrix),i}updateSingallineAABBBounds(t){this.updateMultilineAABBBounds([t]);const e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){const i=e.lines[0];this.cache.clipedText=i.str,this.cache.clipedWidth=i.width}return this._AABBBounds}updateMultilineAABBBounds(t){const e=this.getGraphicTheme(),{direction:i=e.direction,underlineOffset:r=e.underlineOffset}=this.attribute,o=i==="horizontal"?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return i==="horizontal"&&r&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+r),o}guessLineHeightBuf(t){return t?.1*t:0}updateHorizontalMultilineAABBBounds(t){var e,i;const r=this.getGraphicTheme(),o=this.attribute,{fontFamily:s=r.fontFamily,textAlign:a=r.textAlign,textBaseline:l=r.textBaseline,fontSize:h=r.fontSize,fontWeight:u=r.fontWeight,ellipsis:d=r.ellipsis,maxLineWidth:c,stroke:f=r.stroke,wrap:g=r.wrap,measureMode:p=r.measureMode,lineWidth:v=r.lineWidth,whiteSpace:m=r.whiteSpace,suffixPosition:y=r.suffixPosition,ignoreBuf:b=r.ignoreBuf,keepCenterInLine:_=r.keepCenterInLine}=o,w=b?0:this.guessLineHeightBuf(h),C=this.getLineHeight(o,r,w);if(m==="normal"||g)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(!((e=this.cache)===null||e===void 0)&&e.layoutData)){const T=this.cache.layoutData.bbox;return this._AABBBounds.set(T.xOffset,T.yOffset,T.xOffset+T.width,T.yOffset+T.height),f&&this._AABBBounds.expand(v/2),this._AABBBounds}const x=bt.graphicUtil.getTextMeasureInstance(this.textMeasureId||((i=this.stage)===null||i===void 0?void 0:i.textMeasureId)),S=new UP(s,{fontSize:h,fontWeight:u,fontFamily:s,lineHeight:C},x).GetLayoutByLines(t,a,l,C,d===!0?r.ellipsis:d||void 0,!1,{lineWidth:c,suffixPosition:y,measureMode:p,keepCenterInLine:_}),{bbox:A}=S;return this.cache.layoutData=S,this.clearUpdateShapeTag(),this._AABBBounds.set(A.xOffset,A.yOffset,A.xOffset+A.width,A.yOffset+A.height),f&&this._AABBBounds.expand(v/2),this._AABBBounds}updateWrapAABBBounds(t){var e,i,r,o;const s=this.getGraphicTheme(),{fontFamily:a=s.fontFamily,textAlign:l=s.textAlign,textBaseline:h=s.textBaseline,fontSize:u=s.fontSize,ellipsis:d=s.ellipsis,maxLineWidth:c,stroke:f=s.stroke,lineWidth:g=s.lineWidth,wordBreak:p=s.wordBreak,fontWeight:v=s.fontWeight,ignoreBuf:m=s.ignoreBuf,measureMode:y=s.measureMode,suffixPosition:b=s.suffixPosition,heightLimit:_=0,lineClamp:w,keepCenterInLine:C=s.keepCenterInLine}=this.attribute,x=m?0:this.guessLineHeightBuf(u),S=this.getLineHeight(this.attribute,s,x);if(!this.shouldUpdateShape()&&(!((e=this.cache)===null||e===void 0)&&e.layoutData)){const O=this.cache.layoutData.bbox;return this._AABBBounds.set(O.xOffset,O.yOffset,O.xOffset+O.width,O.yOffset+O.height),f&&this._AABBBounds.expand(g/2),this._AABBBounds}const A=bt.graphicUtil.getTextMeasureInstance(this.textMeasureId||((i=this.stage)===null||i===void 0?void 0:i.textMeasureId)),T={fontSize:u,fontWeight:v,fontFamily:a,lineHeight:S},M=new UP(a,T,A),R=ke(t)?t.map(O=>O.toString()):[t.toString()],E=[],P=[0,0];let B=1/0;if(_>0&&(B=Math.max(Math.floor(_/S),1)),w&&(B=Math.min(B,w)),typeof c=="number"&&c!==1/0){if(c>0)for(let D=0;D<R.length;D++){const I=R[D];let H=!0;if(D===B-1){const W=A.clipTextWithSuffix(I,T,c,d,!1,b,D!==R.length-1),K=A.measureTextPixelADscentAndWidth(W.str,T,y);E.push({str:W.str,width:W.width,ascent:K.ascent,descent:K.descent,keepCenterInLine:C});break}const F=A.clipText(I,T,c,p!=="break-all",p==="keep-all");if(I!==""&&F.str===""||F.wordBreaked){if(d){const W=A.clipTextWithSuffix(I,T,c,d,!1,b);F.str=(r=W.str)!==null&&r!==void 0?r:"",F.width=(o=W.width)!==null&&o!==void 0?o:0}else F.str="",F.width=0;H=!1}const G=A.measureTextPixelADscentAndWidth(F.str,T,y);E.push({str:F.str,width:F.width,ascent:G.ascent,descent:G.descent,keepCenterInLine:C});let j=F.str.length;if(!F.wordBreaked||I!==""&&F.str===""||(H=!0,j=F.wordBreaked),F.str.length!==I.length){if(H){let W=I.substring(j);p==="keep-all"&&(W=W.replace(/^\s+/g,"")),R.splice(D+1,0,W)}}}let O=0;E.forEach(D=>{O=Math.max(O,D.width)}),P[0]=O}else{let O,D,I=0;for(let H=0,F=R.length;H<F;H++){if(H===B-1){const j=A.clipTextWithSuffix(R[H],T,c,d,!1,b),W=A.measureTextPixelADscentAndWidth(j.str,T,y);E.push({str:j.str,width:j.width,ascent:W.ascent,descent:W.descent,keepCenterInLine:C}),I=Math.max(I,j.width);break}D=R[H],O=A.measureTextWidth(D,T),I=Math.max(I,O);const G=A.measureTextPixelADscentAndWidth(D,T,y);E.push({str:D,width:O,ascent:G.ascent,descent:G.descent,keepCenterInLine:C})}P[0]=I}P[1]=E.length*S;const k={xOffset:0,yOffset:0,width:P[0],height:P[1]};M.LayoutBBox(k,l,h,E);const L=M.layoutWithBBox(k,E,l,h,S);return this.cache.layoutData=L,this.clearUpdateShapeTag(),this._AABBBounds.set(k.xOffset,k.yOffset,k.xOffset+k.width,k.yOffset+k.height),f&&this._AABBBounds.expand(g/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,i,r;const o=this.getGraphicTheme(),s=bt.graphicUtil.getTextMeasureInstance(this.textMeasureId||((e=this.stage)===null||e===void 0?void 0:e.textMeasureId));let a;const l=this.attribute,{maxLineWidth:h=o.maxLineWidth,ellipsis:u=o.ellipsis,fontFamily:d=o.fontFamily,fontSize:c=o.fontSize,fontWeight:f=o.fontWeight,stroke:g=o.stroke,lineWidth:p=o.lineWidth,verticalMode:v=o.verticalMode,suffixPosition:m=o.suffixPosition}=l,y=this.getLineHeight(l,o,0);let{textAlign:b=o.textAlign,textBaseline:_=o.textBaseline}=l;if(!v){const A=b;b=(i=si.baselineMapAlign[_])!==null&&i!==void 0?i:"left",_=(r=si.alignMapBaseline[A])!==null&&r!==void 0?r:"top"}if(a=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(R=>{const E=R.reduce((P,B)=>P+B.width,0);a=Il(E,a)});const A=Jg(b,a),T=this.cache.verticalList.length*y,M=Lm(_,T,c);return this._AABBBounds.set(M,A,M+T,A+a),g&&this._AABBBounds.expand(p/2),this._AABBBounds}const w=t.map(A=>mMt(A.toString()));w.forEach((A,T)=>{if(Number.isFinite(h))if(u){const M=u===!0?o.ellipsis:u,R=s.clipTextWithSuffixVertical(A,{fontSize:c,fontWeight:f,fontFamily:d},h,M,!1,m);w[T]=R.verticalList,a=R.width}else{const M=s.clipTextVertical(A,{fontSize:c,fontWeight:f,fontFamily:d},h,!1);w[T]=M.verticalList,a=M.width}else a=0,A.forEach(M=>{const R=M.direction===Jf.HORIZONTAL?c:s.measureTextWidth(M.text,{fontSize:c,fontWeight:f,fontFamily:d});a+=R,M.width=R})}),this.cache.verticalList=w,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(A=>{const T=A.reduce((M,R)=>M+R.width,0);a=Il(T,a)});const C=Jg(b,a),x=this.cache.verticalList.length*y,S=Lm(_,x,c);return this._AABBBounds.set(S,C,S+x,C+a),g&&this._AABBBounds.expand(p/2),this._AABBBounds}getMaxWidth(t){var e,i;const r=this.attribute;return(i=(e=r.maxLineWidth)!==null&&e!==void 0?e:r.maxWidth)!==null&&i!==void 0?i:t.maxWidth}getLineHeight(t,e,i){var r;return(r=Ty(t.lineHeight,t.fontSize||e.fontSize))!==null&&r!==void 0?r:(t.fontSize||e.fontSize)+i}needUpdateTags(t,e=lW){return super.needUpdateTags(t,e)}needUpdateTag(t,e=lW){return super.needUpdateTag(t,e)}_interpolate(t,e,i,r,o){t==="text"&&(o.text=r)}clone(){return new si(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return si.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return si.baselineMapAlign}getAlignMapBaseline(){return si.alignMapBaseline}}si.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},sa),si.baselineMapAlign={top:"left",bottom:"right",middle:"center"},si.alignMapBaseline={left:"top",right:"bottom",center:"middle"};function Om(n){return new si(n)}const h_=["heightLimit","lineClamp"];class XO extends si{constructor(t){super(Object.assign(Object.assign({},t),{wrap:!0}))}_isValid(){const{text:t}=this.attribute;return ke(t)?!t.every(e=>e==null||e===""):t!=null&&t!==""}updateMultilineAABBBounds(t){var e,i,r,o,s;const a=this.getGraphicTheme(),{fontFamily:l=a.fontFamily,textAlign:h=a.textAlign,textBaseline:u=a.textBaseline,fontSize:d=a.fontSize,ellipsis:c=a.ellipsis,maxLineWidth:f,stroke:g=a.stroke,lineWidth:p=a.lineWidth,wordBreak:v=a.wordBreak,fontWeight:m=a.fontWeight,ignoreBuf:y=a.ignoreBuf,heightLimit:b=0,suffixPosition:_=a.suffixPosition,lineClamp:w}=this.attribute,C=(e=Ty(this.attribute.lineHeight,this.attribute.fontSize||a.fontSize))!==null&&e!==void 0?e:this.attribute.fontSize||a.fontSize,x=y?0:2;if(!this.shouldUpdateShape()&&(!((i=this.cache)===null||i===void 0)&&i.layoutData)){const k=this.cache.layoutData.bbox;return this._AABBBounds.set(k.xOffset,k.yOffset,k.xOffset+k.width,k.yOffset+k.height),g&&this._AABBBounds.expand(p/2),this._AABBBounds}const S=bt.graphicUtil.getTextMeasureInstance(this.textMeasureId||((r=this.stage)===null||r===void 0?void 0:r.textMeasureId)),A=new UP(l,{fontSize:d,fontWeight:m,fontFamily:l},S),T=t.map(k=>k.toString()),M=[],R=[0,0];let E=1/0;if(b>0&&(E=Math.max(Math.floor(b/C),1)),w&&(E=Math.min(E,w)),typeof f=="number"&&f!==1/0){if(f>0)for(let L=0;L<T.length;L++){const O=T[L];let D=!0;if(L===E-1){const H=A.textMeasure.clipTextWithSuffix(O,A.textOptions,f,c,!1,_);M.push({str:H.str,width:H.width,ascent:0,descent:0,keepCenterInLine:!1});break}const I=A.textMeasure.clipText(O,A.textOptions,f,v==="break-word");if(O!==""&&I.str===""){if(c){const H=A.textMeasure.clipTextWithSuffix(O,A.textOptions,f,c,!1,_);I.str=(o=H.str)!==null&&o!==void 0?o:"",I.width=(s=H.width)!==null&&s!==void 0?s:0}else I.str="",I.width=0;D=!1}if(M.push({str:I.str,width:I.width,ascent:0,descent:0,keepCenterInLine:!1}),I.str.length!==O.length){if(D){const H=O.substring(I.str.length);T.splice(L+1,0,H)}}}let k=0;M.forEach(L=>{k=Math.max(k,L.width)}),R[0]=k}else{let k,L,O=0;for(let D=0,I=T.length;D<I;D++){if(D===E-1){const H=A.textMeasure.clipTextWithSuffix(T[D],A.textOptions,f,c,!1,_);M.push({str:H.str,width:H.width,ascent:0,descent:0,keepCenterInLine:!1}),O=Math.max(O,H.width);break}L=T[D],k=A.textMeasure.measureTextWidth(L,A.textOptions,v==="break-word"),O=Math.max(O,k),M.push({str:L,width:k,ascent:0,descent:0,keepCenterInLine:!1})}R[0]=O}R[1]=M.length*(C+x);const P={xOffset:0,yOffset:0,width:R[0],height:R[1]};A.LayoutBBox(P,h,u);const B=A.layoutWithBBox(P,M,h,u,C);return this.cache.layoutData=B,this.clearUpdateShapeTag(),this._AABBBounds.set(P.xOffset,P.yOffset,P.xOffset+P.width,P.yOffset+P.height),g&&this._AABBBounds.expand(p/2),this._AABBBounds}needUpdateTags(t){for(let e=0;e<h_.length;e++){const i=h_[e];if(t.indexOf(i)!==-1)return!0}return super.needUpdateTags(t)}needUpdateTag(t){for(let e=0;e<h_.length;e++)if(t===h_[e])return!0;return super.needUpdateTag(t)}getNoWorkAnimateAttr(){return XO.NOWORK_ANIMATE_ATTR}}function JMt(n){return new XO(n)}const QMt=(n,t,e)=>{const{outerBorder:i,shadowBlur:r=t.shadowBlur,strokeBoundsBuffer:o=t.strokeBoundsBuffer}=n;if(i){const s=t.outerBorder,{distance:a=s.distance,lineWidth:l=s.lineWidth}=i;Uw(e,a+(r+l)/2,!0,o)}return e},hW=["symbolType","size",...vs];let XK=class XP extends An{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=lA}getParsedPath(){return this.shouldUpdateShape()&&(this._parsedPath=this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}getParsedPath2D(t=0,e=0,i=1){let r=null;try{r=new Path2D}catch{return null}const o=this.getParsedPath();if(!o)return null;o.draw(r,i,t,e)}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{size:t}=this.attribute;return ke(t)?t.length===2&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){const{symbolType:t="circle"}=this.attribute;return super.parsePath(t)}getGraphicTheme(){return te(this).symbol}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateSymbolAABBBoundsImprecise(t,e,i):this.updateSymbolAABBBoundsAccurate(t,e,i));const{tb1:o,tb2:s}=bt.graphicService.updateTempAABBBounds(i);QMt(t,e,o),i.union(o),o.setValue(s.x1,s.y1,s.x2,s.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,this.x1WithoutTransform=i.x1,this.y1WithoutTransform=i.y1;const{lineJoin:a=e.lineJoin}=t;return bt.graphicService.transformAABBBounds(t,i,e,a==="miter",this),i}updateSymbolAABBBoundsImprecise(t,e,i){const{size:r=e.size}=t;if(ke(r))i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2);else{const o=r/2;i.set(-o,-o,o,o)}return i}updateSymbolAABBBoundsAccurate(t,e,i){const{size:r=e.size}=t;return this.getParsedPath().bounds(r,i),i}needUpdateTags(t){return super.needUpdateTags(t,hW)}needUpdateTag(t){return super.needUpdateTag(t,hW)}toCustomPath(){const t=this.getParsedPath(),e=this.attribute.size,i=ke(e)?e:[e,e];return t.path?new wn().fromCustomPath2D(t.path,0,0,i[0],i[1]):new wn().fromString(t.pathStr,0,0,i[0],i[1])}clone(){return new XP(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return XP.NOWORK_ANIMATE_ATTR}};XK.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},sa);function Qg(n){return new XK(n)}const uW=["segments","points","curveType","curveTension",...vs];let YO=class YP extends An{constructor(t={}){super(t),this.type="line",this.numberType=My}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;const{points:t,segments:e}=this.attribute;return e?e.length!==0:!!t&&!(t.length<=1)}_interpolate(t,e,i,r,o){t==="points"&&(o.points=HO(i,r,e))}getGraphicTheme(){return te(this).line}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,i):this.updateLineAABBBoundsByPoints(t,e,i)),bt.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;const{lineJoin:r=e.lineJoin}=t;return bt.graphicService.transformAABBBounds(t,i,e,r==="miter",this),i}updateLineAABBBoundsByPoints(t,e,i,r){const{points:o=e.points,connectedType:s}=t,a=i;return o.forEach(l=>{l.defined===!1&&s!=="connect"||a.add(l.x,l.y)}),a}updateLineAABBBoundsBySegments(t,e,i,r){const{segments:o=e.segments,connectedType:s}=t,a=i;return o.forEach(l=>{l.points.forEach(h=>{h.defined===!1&&s!=="connect"||a.add(h.x,h.y)})}),a}needUpdateTags(t){return super.needUpdateTags(t,uW)}needUpdateTag(t){return super.needUpdateTag(t,uW)}toCustomPath(){let t=super.toCustomPath();if(t)return t;const e=this.attribute;t=new wn;const i=e.segments,r=o=>{if(o&&o.length){let s=!0;o.forEach(a=>{a.defined!==!1&&(s?t.moveTo(a.x,a.y):t.lineTo(a.x,a.y),s=!1)})}};return i&&i.length?i.forEach(o=>{r(o.points)}):e.points&&r(e.points),t}clone(){return new YP(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return YP.NOWORK_ANIMATE_ATTR}};YO.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},sa);function Ri(n){return new YO(n)}const tRt=n=>{if(!n)return{x:0,y:0,width:0,height:0};let t=gi(n.width)?n.x1-n.x:n.width,e=gi(n.height)?n.y1-n.y:n.height,i=0,r=0;return t<0?(i=t,t=-t):Number.isNaN(t)&&(t=0),e<0?(r=e,e=-e):Number.isNaN(e)&&(e=0),{x:i,y:r,width:t,height:e}},dW=["width","x1","y1","height","cornerRadius",...vs];let Py=class KP extends An{constructor(t){super(t),this.type="rect",this.numberType=zO}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return te(this).rect}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){let{width:s,height:a}=t;const{x1:l,y1:h,x:u,y:d}=t;s=s??l-u,a=a??h-d,(isFinite(s)||isFinite(a)||isFinite(u)||isFinite(d))&&i.set(0,0,s||0,a||0)}const{tb1:r,tb2:o}=bt.graphicService.updateTempAABBBounds(i);return By(t,e,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,bt.graphicService.transformAABBBounds(t,i,e,!1,this),i}needUpdateTags(t){return super.needUpdateTags(t,dW)}needUpdateTag(t){return super.needUpdateTag(t,dW)}toCustomPath(){let t=super.toCustomPath();if(t)return t;const e=this.attribute,{x:i,y:r,width:o,height:s}=tRt(e);return t=new wn,t.moveTo(i,r),t.rect(i,r,o,s),t}clone(){return new KP(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return KP.NOWORK_ANIMATE_ATTR}};Py.NOWORK_ANIMATE_ATTR=sa;function Ne(n){return new Py(n)}class eRt{constructor(t,e,i,r,o,s,a,l,h,u,d,c,f,g){this.left=t,this.top=e,this.width=i,this.height=r,this.actualHeight=0,this.bottom=e+r,this.right=t+i,this.ellipsis=o,this.wordBreak=s,this.verticalDirection=a,this.lines=[],this.globalAlign=l,this.globalBaseline=h,this.layoutDirection=u,this.directionKey=OO[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=c,this.singleLine=f,g?(g.clear(),this.icons=g):this.icons=new Map}draw(t,e){const{width:i,height:r}=this.getActualSize(),o=this.isWidthMax?Math.min(this.width,i):this.width||i||0;let s=this.isHeightMax?Math.min(this.height,r):this.height||r||0;s=Math.min(s,r);let a=0;switch(this.globalBaseline){case"top":a=0;break;case"middle":a=-s/2;break;case"bottom":a=-s}let l=0;this.globalAlign==="right"||this.globalAlign==="end"?l=-o:this.globalAlign==="center"&&(l=-o/2);let h=this[this.directionKey.height];this.singleLine&&(h=this.lines[0].height+1);let u=!1;if(this.verticalDirection==="middle")if(this.actualHeight>=h&&h!==0)for(let d=0;d<this.lines.length;d++){const{top:c,height:f}=this.lines[d];if(c+f<this[this.directionKey.top]||c+f>this[this.directionKey.top]+h)return u;let g=!1;this.ellipsis&&this.lines[d+1]&&this.lines[d+1].top+this.lines[d+1].height>this[this.directionKey.top]+h&&(g=!0,u=!0),this.lines[d].draw(t,g,this.lines[d][this.directionKey.left]+l,this.lines[d][this.directionKey.top]+a,this.ellipsis,e)}else{const d=Math.floor((h-this.actualHeight)/2);this.layoutDirection==="vertical"?l+=d:a+=d;for(let c=0;c<this.lines.length;c++)this.lines[c].draw(t,!1,this.lines[c][this.directionKey.left]+l,this.lines[c][this.directionKey.top]+a,this.ellipsis,e)}else if(this.verticalDirection==="bottom"&&this.layoutDirection!=="vertical")for(let d=0;d<this.lines.length;d++){const{top:c,height:f}=this.lines[d],g=h-this.lines[d].top-this.lines[d].height;if(h===0)this.lines[d].draw(t,!1,l,g+a,this.ellipsis,e);else{if(g+f>this[this.directionKey.top]+h||g<this[this.directionKey.top])return u;{let p=!1;this.ellipsis&&this.lines[d+1]&&g-this.lines[d+1].height<this[this.directionKey.top]&&(p=!0,u=!0),this.lines[d].draw(t,p,l,g+a,this.ellipsis,e)}}}else{this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&this.singleLine&&this.isWidthMax&&(l+=this.lines[0].height+1);for(let d=0;d<this.lines.length;d++){this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&(l-=this.lines[d].height+this.lines[d].top);const{top:c,height:f}=this.lines[d];if(h===0)this.lines[d].draw(t,!1,this.lines[d][this.directionKey.left]+l,this.lines[d][this.directionKey.top]+a,this.ellipsis,e);else{if(c+f<this[this.directionKey.top]||c+f>this[this.directionKey.top]+h)return u;{let g=!1;this.ellipsis&&this.lines[d+1]&&this.lines[d+1].top+this.lines[d+1].height>this[this.directionKey.top]+h&&(g=!0,u=!0),this.lines[d].draw(t,g,this.lines[d][this.directionKey.left]+l,this.lines[d][this.directionKey.top]+a,this.ellipsis,e)}}}}return u}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let i=0;i<this.lines.length;i++){const r=this.lines[i];r.actualWidth>t&&(t=r.actualWidth),e+=r.height}return{width:this.layoutDirection==="vertical"?e:t,height:this.layoutDirection==="vertical"?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0;const{width:i,height:r}=this.getRawActualSize();this.width,this.height;let o=this[this.directionKey.height];if(this.singleLine&&(o=this.lines[0].height+1),this.verticalDirection==="middle")if(this.actualHeight>=o&&o!==0)for(let s=0;s<this.lines.length;s++){const{top:a,height:l}=this.lines[s];if(!(a+l<this[this.directionKey.top]||a+l>this[this.directionKey.top]+o))if(this.ellipsis&&this.lines[s+1]&&this.lines[s+1].top+this.lines[s+1].height>this[this.directionKey.top]+o){const h=this.ellipsis===!0?"...":this.ellipsis||"",u=this.lines[s].getWidthWithEllips(h);u>t&&(t=u),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else{Math.floor((o-this.actualHeight)/2);for(let s=0;s<this.lines.length;s++)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else if(this.verticalDirection==="bottom")for(let s=0;s<this.lines.length;s++){const{top:a,height:l}=this.lines[s],h=o-this.lines[s].top-this.lines[s].height;if(o===0)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height;else if(!(h+l>this[this.directionKey.top]+o||h<this[this.directionKey.top]))if(this.ellipsis&&this.lines[s+1]&&h-this.lines[s+1].height<this[this.directionKey.top]){const u=this.ellipsis===!0?"...":this.ellipsis||"",d=this.lines[s].getWidthWithEllips(u);d>t&&(t=d),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else for(let s=0;s<this.lines.length;s++){const{top:a,height:l}=this.lines[s];if(o===0)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height;else if(!(a+l<this[this.directionKey.top]||a+l>this[this.directionKey.top]+o))if(this.ellipsis&&this.lines[s+1]&&this.lines[s+1].top+this.lines[s+1].height>this[this.directionKey.top]+o){const h=this.ellipsis===!0?"...":this.ellipsis||"",u=this.lines[s].getWidthWithEllips(h);u>t&&(t=u),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}return{width:this.layoutDirection==="vertical"?e:t,height:this.layoutDirection==="vertical"?t:e}}}function yv(n,t,e,i){const r=Math.round(n),o=Math.round(e),s=Math.round(t),a=Math.round(i);return{left:n>r?r:r-.5,top:e>o?o:o-.5,right:s>t?s:s+.5,bottom:a>i?a:a+.5}}class kd{constructor(t,e,i,r){var o,s;this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||"alphabetic",this.ascentDescentMode=r;const a=Ty(i.lineHeight,this.fontSize);this.lineHeight=typeof a=="number"?a>this.fontSize?a:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;const{ascent:l,height:h,descent:u,width:d}=pd(t,i,this.ascentDescentMode);let c=0,f=0,g=0;this.height>h&&(c=(this.height-h)/2,f=Math.ceil(c),g=Math.floor(c)),this.textBaseline==="top"?(this.ascent=c,this.descent=h-c):this.textBaseline==="bottom"?(this.ascent=h-c,this.descent=c):this.textBaseline==="middle"?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=l+f,this.descent=u+g),this.length=t.length,this.width=d||0,this.text=t||"",this.newLine=e||!1,this.character=i,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,this.space=i.space,this.dx=(o=i.dx)!==null&&o!==void 0?o:0,this.dy=(s=i.dy)!==null&&s!==void 0?s:0,i.direction==="vertical"&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){const{width:t}=pd(this.text,this.character,this.ascentDescentMode);this.width=t,this.direction==="vertical"&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}drawBackground(t,e,i,r,o,s,a){if(this.text===""||this.text===`
`||!this.character.background||this.character.backgroundOpacity&&!(this.character.backgroundOpacity>0))return;let l=e+i,h=this.text,u=this.left+r;l+=this.top;let d=this.direction;if(this.verticalEllipsis)h=this.ellipsisStr,d="vertical",l-=this.ellipsisWidth/2;else{if(this.ellipsis==="hide")return;if(this.ellipsis==="add")h+=this.ellipsisStr,s!=="right"&&s!=="end"||(u-=this.ellipsisWidth);else if(this.ellipsis==="replace"){const f=uC(h,(d==="vertical"?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,h.length-1);if(h=h.slice(0,f),h+=this.ellipsisStr,(s==="right"||s==="end")&&d!=="vertical"){const{width:g}=pd(this.text.slice(f),this.character,this.ascentDescentMode);u-=this.ellipsisWidth-g}}}const c=yv(u,u+(this.widthOrigin||this.width),e,e+a);return Object.assign(Object.assign({},c),{fillStyle:this.character.background,globalAlpha:this.character.backgroundOpacity})}draw(t,e,i,r,o,s,a){var l;let h=e+i,u=this.text,d=this.left+r+((l=this.space)!==null&&l!==void 0?l:0)/2;h+=this.top;let c=this.direction;if(this.verticalEllipsis)u=this.ellipsisStr,c="vertical",h-=this.ellipsisWidth/2;else{if(this.ellipsis==="hide")return;if(this.ellipsis==="add")u+=this.ellipsisStr,s!=="right"&&s!=="end"||(d-=this.ellipsisWidth);else if(this.ellipsis==="replace"){const g=uC(u,(c==="vertical"?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,u.length-1);if(u=u.slice(0,g),u+=this.ellipsisStr,(s==="right"||s==="end")&&c!=="vertical"){const{width:p}=pd(this.text.slice(g),this.character,this.ascentDescentMode);d-=this.ellipsisWidth-p}}}switch(this.character.script){case"super":h-=this.ascent*(1/3);break;case"sub":h+=this.descent/2}c==="vertical"&&(t.save(),t.rotateAbout(Math.PI/2,d,h),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(d,h),d=0,h=0);const{lineWidth:f=1}=this.character;if(this.character.stroke&&f&&t.strokeText(u,d+this.dx,h+this.dy),this.character.fill&&t.fillText(u,d+this.dx,h+this.dy),this.character.fill){if(this.character.lineThrough||this.character.underline){if(this.character.underline){const g=1+h,p=yv(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(p.left,1+h,p.right-p.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}if(this.character.lineThrough){const g=1+h-this.ascent/2,p=yv(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(p.left,1+h-this.ascent/2,p.right-p.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}else if(this.character.textDecoration==="underline"){const g=1+h,p=yv(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(p.left,1+h,p.right-p.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}else if(this.character.textDecoration==="line-through"){const g=1+h-this.ascent/2,p=yv(d,d+(this.widthOrigin||this.width),g,g+(this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1));t.fillRect(p.left,1+h-this.ascent/2,p.right-p.left,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)}}c==="vertical"&&t.restore()}getWidthWithEllips(t){let e=this.text;const i=t==="vertical"?this.height:this.width;if(this.ellipsis==="hide")return i;if(this.ellipsis==="add")return i+this.ellipsisWidth;if(this.ellipsis==="replace"){const r=uC(e,i-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,r),e+=this.ellipsisStr;const{width:o}=pd(this.text.slice(r),this.character,this.ascentDescentMode);return i+this.ellipsisWidth-o}return i}}function iRt(n,t){const e=n.text.slice(0,t),i=n.text.slice(t);return[new kd(e,n.newLine,n.character,n.ascentDescentMode),new kd(i,!0,n.character,n.ascentDescentMode)]}const cW=["width","height","image",...vs];let Ga=class qP extends An{constructor(t){super(t),this.type="image",this.numberType=oA,this.loadImage(this.attribute.image)}getImageElement(){const{image:t}=this.attribute;if(!t||!this.resources)return null;const e=this.resources.get(t);return e.state!=="success"?null:e.data}get width(){return this.tryUpdateAABBBounds(),this._actualWidth}get height(){return this.tryUpdateAABBBounds(),this._actualHeight}get repeatX(){var t;return(t=this.attribute.repeatX)!==null&&t!==void 0?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return(t=this.attribute.repeatY)!==null&&t!==void 0?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,i){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()}),this.addUpdateBoundTag()}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,i){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,i)}setAttribute(t,e,i,r){return t==="image"&&this.loadImage(e),super.setAttribute(t,e,i,r)}getGraphicTheme(){return te(this).image}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){const{maxWidth:s=e.maxWidth,maxHeight:a=e.maxHeight}=t;let{width:l,height:h}=t;if(l==null||h==null){const u=this.getImageElement();if(u){const d=u.width,c=u.height;if(l!=null)h=l*(c/d);else if(h!=null)l=h*(d/c);else{const f=d/c;f>s/a?(l=s,h=s/f):(h=a,l=a*f)}}else l=s,h=a}this._actualWidth=l,this._actualHeight=h,i.set(0,0,l,h)}const{tb1:r,tb2:o}=bt.graphicService.updateTempAABBBounds(i);return By(t,e,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,bt.graphicService.transformAABBBounds(t,i,e,!1,this),i}getDefaultAttribute(t){return Rm[t]}needUpdateTags(t){return super.needUpdateTags(t,cW)}needUpdateTag(t){return super.needUpdateTag(t,cW)}clone(){return new qP(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return qP.NOWORK_ANIMATE_ATTR}};Ga.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},sa);function uA(n){return new Ga(n)}class Ca extends Ga{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],t.backgroundShowMode==="always"&&(this._hovered=!0),t.margin){const e=jw(t.margin);this._marginArray=typeof e=="number"?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(e,i,r)=>{if(ke(r)&&r.indexOf("margin")!==-1||r==="margin")if(i.margin){const o=jw(i.margin);this._marginArray=typeof o=="number"?[o,o,o,o]:o}else this._marginArray=[0,0,0,0]}}get width(){var t;return((t=this.attribute.width)!==null&&t!==void 0?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return((t=this.attribute.height)!==null&&t!==void 0?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();const{width:t=Rm.width,height:e=Rm.height}=this.attribute,{backgroundWidth:i=t,backgroundHeight:r=e}=this.attribute,o=(i-t)/2,s=(r-e)/2;return this._AABBBounds.expand([0,2*o,2*s,0]),this._AABBBounds}setHoverState(t){this.attribute.backgroundShowMode==="hover"&&this._hovered!==t&&(this._hovered=t)}}class nRt{constructor(t,e,i,r,o,s,a,l){this.left=t,this.width=e,this.baseline=i,this.ascent=r,this.descent=o,this.top=i-r,this.paragraphs=s.map(u=>u),this.textAlign=(this.paragraphs[0]instanceof Ca?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=a,this.directionKey=OO[this.direction],this.actualWidth=0;let h=0;this.paragraphs.forEach((u,d)=>{if(d===0&&u instanceof kd){const c=AAt.exec(u.text);c?.index!==0&&(u.text=u.text.slice(c?.index),u.updateWidth())}this.actualWidth+=u[this.directionKey.width],h=Math.max(u[this.directionKey.height],h)}),this.height=h,this.blankWidth=l?0:this.width-this.actualWidth,this.calcOffset(e,l)}calcOffset(t,e){const i=this.directionKey,r=this.height;let o=this.left,s=0;this.actualWidth<t&&!e&&(this.textAlign==="right"||this.textAlign==="end"?o=t-this.actualWidth:this.textAlign==="center"?o=(t-this.actualWidth)/2:this.textAlign==="justify"&&(this.paragraphs.length<2?o=(t-this.actualWidth)/2:s=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(a){a instanceof Ca?(a["_"+i.x]=o,o+=a[i.width]+s,a["_"+i.y]=a.attribute.textBaseline==="top"?0:a.attribute.textBaseline==="bottom"?r-a.height:(r-a.height)/2):(a[i.left]=o,o+=a[i.width]+s)})}draw(t,e,i,r,o,s){if(o&&(e||this.paragraphs.some(d=>d.overflow))){let d=!0,c=!1;for(let g=this.paragraphs.length-1;g>=0;g--){const p=this.paragraphs[g];if(p.overflow)d=d&&p.text==="";else if(d){c=!0;break}}let f=0;if(!c)for(let g=this.paragraphs.length-1;g>=0;g--){const p=this.paragraphs[g];if(p.overflow){if(p.text==="")break;continue}if(p instanceof Ca)break;if(this.direction==="vertical"&&p.direction!=="vertical"){p.verticalEllipsis=!0;break}const v=o===!0?"...":o||"";p.ellipsisStr=v;const{width:m}=pd(v,p.character,p.ascentDescentMode),y=m||0;if(y<=this.blankWidth+f){e&&(p.ellipsis="add");break}if(y<=this.blankWidth+f+p.width){p.ellipsis="replace",p.ellipsisWidth=y,p.ellipsisOtherParagraphWidth=this.blankWidth+f;break}p.ellipsis="hide",f+=p.width}}let a="",l=-1,h=[];const u=[h];this.paragraphs.forEach((d,c)=>{if(d instanceof Ca)return;const f=d.drawBackground(t,r,this.ascent,i,c===0,this.textAlign,this.height);f&&(a===f.fillStyle&&l===f.globalAlpha||(h=[],u.push(h),a=f.fillStyle,l=f.globalAlpha),h.push(f))}),u.forEach(d=>{if(d.length===0)return;const c=d[0],f=d[d.length-1];t.fillStyle=c.fillStyle,t.globalAlpha=c.globalAlpha,t.fillRect(c.left,c.top,f.right-c.left,f.bottom-c.top)}),this.paragraphs.forEach((d,c)=>{if(d instanceof Ca)return d.setAttributes({x:i+d._x,y:r+d._y}),void s(d,t,i+d._x,r+d._y,this.ascent);const f={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};MAt(t,d.character),TAt(t,d.character,f),d.draw(t,r,this.ascent,i,c===0,this.textAlign,this.height)})}getWidthWithEllips(t){let e=0;for(let r=this.paragraphs.length-1;r>=0;r--){const o=this.paragraphs[r];if(o instanceof Ca)break;const{width:s}=pd(t,o.character,o.ascentDescentMode),a=s||0;if(a<=this.blankWidth+e){o.ellipsis="add",o.ellipsisWidth=a;break}if(a<=this.blankWidth+e+o.width){o.ellipsis="replace",o.ellipsisWidth=a,o.ellipsisOtherParagraphWidth=this.blankWidth+e;break}o.ellipsis="hide",e+=o.width}let i=0;return this.paragraphs.forEach((r,o)=>{i+=r instanceof Ca?r.width:r.getWidthWithEllips(this.direction)}),i}}class rRt{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=OO[this.direction]}store(t){if(t instanceof Ca){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,i=0;t.attribute.textBaseline==="top"?(e=0,i=t.height):t.attribute.textBaseline==="bottom"?(e=t.height,i=0):(e=t.height/2,i=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,i)}else this.lineBuffer.push(t),t.text.length!==0?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(this.lineBuffer.length===0)return;const t=this.maxAscent===0?this.maxAscentForBlank:this.maxAscent,e=this.maxDescent===0?this.maxDescentForBlank:this.maxDescent,i=new nRt(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,this.direction==="horizontal"?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(i),this.frame.actualHeight+=i.height,this.y+=i.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t,e=!1){t instanceof Ca?this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineBuffer.length===0?(this.store(t),this.send()):(this.send(),this.deal(t)):typeof this.width!="number"||this.width<0||(t.newLine&&this.send(),(t.text.length!==0||this.newLine)&&(this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}cut(t,e){const i=this[this.directionKey.width]-this.lineWidth||0,r=Math.ceil(i/t[this.directionKey.width]*t.length)||0,o=uC(t.text,i,t.character,r,this.frame.wordBreak==="break-word");if(o!==0){const[s,a]=iRt(t,o);this.store(s),e?this.send():this.deal(a)}else this.lineBuffer.length!==0&&(this.send(),this.deal(t))}}let ZP=!1;try{ZP=Intl&&typeof Intl.Segmenter=="function"}catch{ZP=!1}const fW=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...vs];class Ei extends An{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=NO,this.onBeforeAttributeUpdate=(e,i,r)=>{for(const o in e)if(o==="hoverIconId"){if(e[o]===i[o])continue;const s=this._frameCache.icons.get(e[o]);this.updateHoverIconState(s)}}}get width(){var t;return(t=this.attribute.width)!==null&&t!==void 0?t:pl.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return(t=this.attribute.height)!==null&&t!==void 0?t:pl.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return(t=this.attribute.ellipsis)!==null&&t!==void 0?t:pl.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return(t=this.attribute.wordBreak)!==null&&t!==void 0?t:pl.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return(t=this.attribute.verticalDirection)!==null&&t!==void 0?t:pl.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return(t=this.attribute.textAlign)!==null&&t!==void 0?t:pl.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return(t=this.attribute.textBaseline)!==null&&t!==void 0?t:pl.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return(t=this.attribute.textConfig)!==null&&t!==void 0?t:pl.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return te(this).richtext}static AllSingleCharacter(t){return t.lines?t.lines.every(e=>e.paragraphs.every(i=>!(i.text&&Ha(i.text)&&Ei.splitText(i.text).length>1))):t.every(e=>e.isComposing||!(e.text&&Ha(e.text)&&Ei.splitText(e.text).length>1))}static splitText(t){if(ZP){const e=new Intl.Segmenter(void 0,{granularity:"grapheme"}),i=[];for(const{segment:r}of e.segment(t))i.push(r);return i}return Array.from(t)}static TransformTextConfig2SingleCharacter(t){const e=[];return t.forEach(i=>{const r=Ei.splitText(i.text.toString());if(Ha(i.text)&&r.length>1)for(let o=0;o<r.length;o++){const s=r[o];e.push(Object.assign(Object.assign({},i),{text:s}))}else e.push(i)}),e}updateAABBBounds(t,e,i){var r,o,s,a;const{width:l=e.width,height:h=e.height,maxWidth:u=e.maxWidth,maxHeight:d=e.maxHeight,textAlign:c=e.textAlign,textBaseline:f=(o=(r=t.textBaseline)!==null&&r!==void 0?r:e.textBaseline)!==null&&o!==void 0?o:"top",editOptions:g}=t;if(l>0&&h>0)i.set(0,0,l,h);else{const m=this.getFrameCache(),{width:y,height:b}=m.getActualSize();let _=l||y||0,w=h||b||0;w=typeof d=="number"&&w>d?d:w||0,_=typeof u=="number"&&_>u?u:_||0,i.set(0,0,_,w)}g&&g.keepHeightWhileEmpty&&!i.height()&&!(!((s=t.textConfig)===null||s===void 0)&&s.length)&&(i.y2=i.y1+((a=t.fontSize)!==null&&a!==void 0?a:12),i.x2=i.x1+2);let p=0;switch(f){case"top":p=0;break;case"middle":p=-i.height()/2;break;case"bottom":p=-i.height()}let v=0;switch(c){case"left":v=0;break;case"center":v=-i.width()/2;break;case"right":v=-i.width()}return h||(this.verticalDirection==="middle"?p-=i.height()/2:this.verticalDirection==="bottom"&&(p-=i.height())),i.translate(v,p),bt.graphicService.updateTempAABBBounds(i),t.forceBoundsHeight==null&&t.forceBoundsWidth==null||bt.graphicService.updateHTMLTextAABBBounds(t,e,i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1,bt.graphicService.transformAABBBounds(t,i,e,!1,this),i.width()===0&&i.height()===0&&i.clear(),i}needUpdateTags(t){return super.needUpdateTags(t,fW)}needUpdateTag(t){return super.needUpdateTag(t,fW)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){const t=this.getFrameCache();if(t.actualHeight>t.height)return!0;const{disableAutoWrapLine:e}=this.attribute;if(e)for(let i=0;i<t.lines.length;i++){const r=t.lines[i];for(let o=0;o<r.paragraphs.length;o++){const s=r.paragraphs[o];if(s.overflow&&s.text!=="")return!0}}return!1}combinedStyleToCharacter(t){const{fill:e,stroke:i,fontSize:r,fontFamily:o,fontStyle:s,fontWeight:a,lineWidth:l,opacity:h,fillOpacity:u,lineHeight:d,strokeOpacity:c,upgradeAttrs:f}=this.attribute,g=Object.assign({fill:e,stroke:i,fontSize:r,fontFamily:o,fontStyle:s,fontWeight:a,lineWidth:l,opacity:h,fillOpacity:u,strokeOpacity:c},t);return f?.lineHeight&&(g.lineHeight=d),g}doUpdateFrameCache(t){var e;const{maxWidth:i,maxHeight:r,width:o,height:s,ellipsis:a,wordBreak:l,verticalDirection:h,textAlign:u,textBaseline:d,layoutDirection:c,singleLine:f,disableAutoWrapLine:g,editable:p,ascentDescentMode:v,upgradeAttrs:m}=this.attribute,y=m&&m.multiBreakLine;let{textConfig:b=[]}=this.attribute;p&&b.length>0&&!Ei.AllSingleCharacter(b)&&(b=Ei.TransformTextConfig2SingleCharacter(b),this.attribute.textConfig=b);const _=[],w=t??b;for(let R=0;R<w.length;R++)if("image"in w[R]){const E=this.combinedStyleToCharacter(w[R]);E.lineWidth=void 0;const P=E.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(E.id);if(P)_.push(P);else{const B=new Ca(E);B.successCallback=()=>{var k;this.addUpdateBoundTag(),(k=this.stage)===null||k===void 0||k.renderNextFrame()},B.richtextId=E.id,_.push(B)}}else{const E=this.combinedStyleToCharacter(w[R]);if(kn(E.text)&&(E.text=`${E.text}`),E.text&&E.text.includes(`
`)){const P=E.text.split(`
`);for(let B=0;B<P.length;B++)if(B===0)_.push(new kd(P[B],!1,E,v));else if(P[B]||R===w.length-1)_.push(new kd(P[B],!0,E,v));else{const k=this.combinedStyleToCharacter(w[R+1]);_.push(new kd(P[B],!0,k,v))}}else E.text&&_.push(new kd(E.text,!1,E,v))}const C=typeof i=="number"&&Number.isFinite(i)&&i>0,x=typeof r=="number"&&Number.isFinite(r)&&r>0,S=typeof o=="number"&&Number.isFinite(o)&&o>0&&(!C||o<=i),A=typeof s=="number"&&Number.isFinite(s)&&s>0&&(!x||s<=r),T=new eRt(0,0,(S?o:C?i:0)||0,(A?s:x?r:0)||0,a,l,h,u,d,c||"horizontal",!S&&C,!A&&x,f||!1,(e=this._frameCache)===null||e===void 0?void 0:e.icons),M=new rRt(T);if(M.newLine=y,g){let R=0,E=!1;for(let P=0;P<_.length;P++){const B=_[P];E?(B.overflow=!0,B.left=1/0,B.top=1/0,!B.newLine&&T.lines[T.lines.length-1].paragraphs.push(B)):M.deal(B,!0),T.lines.length!==R&&(R=T.lines.length,M.lineBuffer.length=0,B.overflow=!0,B.left=1e3,B.top=1e3,T.lines[T.lines.length-1].paragraphs.push(B),E=!0),B.newLine&&(E=!1,M.lineWidth=0),M.send()}}else for(let R=0;R<_.length;R++)M.deal(_[R]);if(M.send(),!(T.layoutDirection==="horizontal"?S:A)){const R=T.getActualSizeWidthEllipsis();let E=T.layoutDirection==="horizontal"?R.width:R.height;(T.layoutDirection==="horizontal"?C:x)&&(E=Math.min(E,T.layoutDirection==="horizontal"?i:r)),T.lines.forEach(function(P){P.calcOffset(E,!1)})}y&&T.lines.forEach(R=>{const E=R.paragraphs;R.paragraphs=R.paragraphs.filter(P=>P.text!==""),R.paragraphs.length===0&&E.length&&(E[0].text=`
`,R.paragraphs.push(E[0]))}),this._frameCache=T}clone(){return new Ei(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(i=>{i.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{const e=this.pickIcon(t.global);e&&e===this._currentHoverIcon||(e?this.setAttribute("hoverIconId",e.richtextId):!e&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",t=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(t){var e,i,r,o,s;t?((e=this._currentHoverIcon)===null||e===void 0||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),(i=this.stage)===null||i===void 0||i.setCursor(t.attribute.cursor),(r=this.stage)===null||r===void 0||r.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,(o=this.stage)===null||o===void 0||o.setCursor(),(s=this.stage)===null||s===void 0||s.renderNextFrame())}pickIcon(t){const e=this.getFrameCache(),{e:i,f:r}=this.globalTransMatrix;let o;return e.icons.forEach((s,a)=>{var l,h;const u=s.AABBBounds.clone();u.translate(s._marginArray[3],s._marginArray[0]),u.containsPoint({x:t.x-i,y:t.y-r})&&(o=s,o.globalX=((l=o.attribute.x)!==null&&l!==void 0?l:0)+i+s._marginArray[3],o.globalY=((h=o.attribute.y)!==null&&h!==void 0?h:0)+r+s._marginArray[0])}),o}getNoWorkAnimateAttr(){return Ei.NOWORK_ANIMATE_ATTR}}Ei.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},sa);function oRt(n){return new Ei(n)}const gW=["path","customPath",...vs];class Dm extends An{constructor(t){super(t),this.type="path",this.numberType=sA}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{path:t}=this.attribute;return t!=null&&t!==""}getParsedPathShape(){const t=this.getGraphicTheme();if(!this.valid)return t.path;const e=this.attribute;return e.path instanceof wn?e.path:(gi(this.cache)&&this.doUpdatePathShape(),this.cache instanceof wn?this.cache:t.path)}getGraphicTheme(){return te(this).path}updateAABBBounds(t,e,i){if(!this.updatePathProxyAABBBounds(i)){const a=this.getParsedPathShape();i.union(a.getBounds())}const{tb1:r,tb2:o}=bt.graphicService.updateTempAABBBounds(i);By(t,e,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;const{lineJoin:s=e.lineJoin}=t;return bt.graphicService.transformAABBBounds(t,i,e,s==="miter",this),i}doUpdateAABBBounds(t){return this.doUpdatePathShape(),super.doUpdateAABBBounds(t)}doUpdatePathShape(){const t=this.attribute;Ha(t.path,!0)?this.cache=new wn().fromString(t.path):t.customPath&&(this.cache=new wn,t.customPath(this.cache,this))}needUpdateTags(t){return super.needUpdateTags(t,gW)}needUpdateTag(t){return super.needUpdateTag(t,gW)}toCustomPath(){return new wn().fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new Dm(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Dm.NOWORK_ANIMATE_ATTR}}Dm.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},sa);function sRt(n){return new Dm(n)}const pW=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...vs];class tp extends An{constructor(t){super(t),this.type="arc",this.numberType=nA}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:t,endAngle:e,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){const t=this.getGraphicTheme(),{cornerRadius:e=t.cornerRadius,innerPadding:i=t.innerPadding,outerPadding:r=t.outerPadding}=this.attribute;let{outerRadius:o=t.outerRadius,innerRadius:s=t.innerRadius}=this.attribute;if(o+=r,s-=i,e===0||e==="0%")return 0;const a=Math.abs(o-s),l=h=>Math.min(kn(h,!0)?h:a*parseFloat(h)/100,a/2);if(ke(e)){const h=e.map(u=>l(u)||0);return h.length===0?[h[0],h[0],h[0],h[0]]:h.length===2?[h[0],h[1],h[0],h[1]]:(h.length===3&&h.push(0),h)}return l(e)}getParsedAngle(){const t=this.getGraphicTheme();let{startAngle:e=t.startAngle,endAngle:i=t.endAngle}=this.attribute;const{cap:r=t.cap}=this.attribute,o=i-e>=0?1:-1,s=i-e;if(e=ySt(e),i=e+s,r&&De(s)<Zt-ii){let a=1,l=1;r.length&&(a=Number(r[0]),l=Number(r[1]));let{outerRadius:h=t.outerRadius,innerRadius:u=t.innerRadius}=this.attribute;const{outerPadding:d=t.outerPadding,innerPadding:c=t.innerPadding}=this.attribute;h+=d,u-=c;const f=Math.abs(h-u)/2,g=f/h;if(f>ii&&h>ii)return{startAngle:e-o*g*a,endAngle:i+o*g*l,sc:o*g*a,ec:o*g*l}}return{startAngle:e,endAngle:i}}getParsePadAngle(t,e){const i=this.getGraphicTheme(),{innerPadding:r=i.innerPadding,outerPadding:o=i.outerPadding,padAngle:s=i.padAngle}=this.attribute;let{outerRadius:a=i.outerRadius,innerRadius:l=i.innerRadius}=this.attribute;a+=o,l-=r;const{padRadius:h=js(a*a+l*l)}=this.attribute,u=De(e-t);let d=t,c=e,f=t,g=e;const p=s/2;let v=u,m=u;if(p>ii&&h>ii){const y=e>t?1:-1;let b=n5(Number(h)/l*xi(p)),_=n5(Number(h)/a*xi(p));return(v-=2*b)>ii?(b*=y,f+=b,g-=b):(v=0,f=g=(t+e)/2),(m-=2*_)>ii?(_*=y,d+=_,c-=_):(m=0,d=c=(t+e)/2),{outerStartAngle:d,outerEndAngle:c,innerStartAngle:f,innerEndAngle:g,innerDeltaAngle:v,outerDeltaAngle:m}}return{outerStartAngle:d,outerEndAngle:c,innerStartAngle:f,innerEndAngle:g,innerDeltaAngle:v,outerDeltaAngle:m}}getGraphicTheme(){return te(this).arc}updateAABBBounds(t,e,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateArcAABBBoundsImprecise(t,e,i):this.updateArcAABBBoundsAccurate(t,e,i));const{tb1:o,tb2:s}=bt.graphicService.updateTempAABBBounds(i);By(t,e,o),i.union(o),o.setValue(s.x1,s.y1,s.x2,s.y2),this.setWidthHeightWithoutTransform(i);const{lineJoin:a=e.lineJoin}=t;return bt.graphicService.transformAABBBounds(t,i,e,a==="miter",this),i}updateArcAABBBoundsImprecise(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:o=e.innerRadius}=t;const{outerPadding:s=e.outerPadding,innerPadding:a=e.innerPadding}=t;return r+=s,o-=a,r<o&&(r=o),i.set(-r,-r,r,r),i}updateArcAABBBoundsAccurate(t,e,i){let{outerRadius:r=e.outerRadius,innerRadius:o=e.innerRadius}=t;const{outerPadding:s=e.outerPadding,innerPadding:a=e.innerPadding}=t;if(r+=s,o-=a,r<o){const u=r;r=o,o=u}let{endAngle:l=e.endAngle,startAngle:h=e.startAngle}=t;if(h>l){const u=h;h=l,l=u}return r<=ii?i.set(0,0,0,0):Math.abs(l-h)>Zt-ii?i.set(-r,-r,r,r):(EP(h,l,r,i),EP(h,l,o,i)),i}needUpdateTags(t){return super.needUpdateTags(t,pW)}needUpdateTag(t){return super.needUpdateTag(t,pW)}toCustomPath(){var t,e,i,r;let o=super.toCustomPath();if(o)return o;const s=this.attribute,{startAngle:a,endAngle:l}=this.getParsedAngle();let h=((t=s.innerRadius)!==null&&t!==void 0?t:0)-((e=s.innerPadding)!==null&&e!==void 0?e:0),u=((i=s.outerRadius)!==null&&i!==void 0?i:0)-((r=s.outerPadding)!==null&&r!==void 0?r:0);const d=De(l-a),c=l>a;if(u<h){const f=u;u=h,h=f}if(o=new wn,u<=ii)o.moveTo(0,0);else if(d>=Zt-ii)o.moveTo(0+u*hn(a),0+u*xi(a)),o.arc(0,0,u,a,l,!c),h>ii&&(o.moveTo(0+h*hn(l),0+h*xi(l)),o.arc(0,0,h,l,a,c));else{const f=u*hn(a),g=u*xi(a),p=h*hn(l),v=h*xi(l);o.moveTo(0+f,0+g),o.arc(0,0,u,a,l,!c),o.lineTo(0+p,0+v),o.arc(0,0,h,l,a,c),o.closePath()}return o}clone(){return new tp(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return tp.NOWORK_ANIMATE_ATTR}}tp.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},sa);function Kw(n){return new tp(n)}const vW=["points","cornerRadius",...vs];class mc extends An{constructor(t){super(t),this.type="polygon",this.numberType=aA}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{points:t}=this.attribute;return t&&t.length>=2}getGraphicTheme(){return te(this).polygon}updateAABBBounds(t,e,i){this.updatePathProxyAABBBounds(i)||this.updatePolygonAABBBoundsImprecise(t,e,i),bt.graphicService.updateTempAABBBounds(i),this.widthWithoutTransform=i.x2-i.x1,this.heightWithoutTransform=i.y2-i.y1;const{lineJoin:r=e.lineJoin}=t;return bt.graphicService.transformAABBBounds(t,i,e,r==="miter",this),i}updatePolygonAABBBoundsImprecise(t,e,i){const{points:r=e.points}=t;return r.forEach(o=>{i.add(o.x,o.y)}),i}_interpolate(t,e,i,r,o){t==="points"&&(o.points=HO(i,r,e))}needUpdateTags(t){return super.needUpdateTags(t,vW)}needUpdateTag(t){return super.needUpdateTag(t,vW)}toCustomPath(){let t=super.toCustomPath();if(t)return t;const e=this.attribute.points;return t=new wn,e.forEach((i,r)=>{r===0?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y)}),t.closePath(),t}clone(){return new mc(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return mc.NOWORK_ANIMATE_ATTR}}mc.NOWORK_ANIMATE_ATTR=sa;function YK(n){return new mc(n)}class aRt extends ge{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){const e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){const t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function lRt(n){return new aRt(n)}class hRt{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){const i=this.store.get(t);return i?i(e):null}}const kt=new hRt;let u_;function dA(n){return u_||(u_=kt.CreateGraphic("text",{})),u_.initAttributes(n),u_.AABBBounds}var uRt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},dRt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},mW=function(n,t){return function(e,i){t(e,i,n)}};class cA{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){var g;const{background:p,backgroundOpacity:v=(g=t.attribute.fillOpacity)!==null&&g!==void 0?g:h.backgroundOpacity,opacity:m=h.opacity,backgroundMode:y=h.backgroundMode,backgroundFit:b=h.backgroundFit,backgroundKeepAspectRatio:_=h.backgroundKeepAspectRatio,backgroundScale:w=h.backgroundScale,backgroundOffsetX:C=h.backgroundOffsetX,backgroundOffsetY:x=h.backgroundOffsetY,backgroundClip:S=h.backgroundClip}=t.attribute;if(p)if(t.backgroundImg&&t.resources){const A=t.resources.get(p);if(A.state!=="success"||!A.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){const M=te(t.parent).group,{scrollX:R=M.scrollX,scrollY:E=M.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(R,E)}S&&e.clip();const T=t.AABBBounds;e.setCommonStyle(t,t.attribute,i,r,h),e.globalAlpha=v*m,this.doDrawImage(e,A.data,T,{backgroundMode:y,backgroundFit:b,backgroundKeepAspectRatio:_,backgroundScale:w,backgroundOffsetX:C,backgroundOffsetY:x}),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,h),e.globalAlpha=v*m,e.fillStyle=p,e.fill(),e.highPerformanceRestore()}doDrawImage(t,e,i,r){const{backgroundMode:o,backgroundFit:s,backgroundKeepAspectRatio:a,backgroundScale:l=1,backgroundOffsetX:h=0,backgroundOffsetY:u=0}=r,d=i.width(),c=i.height();let f=d,g=c;if(o==="no-repeat")if(s)if(a){const p=Math.max(d/e.width,c/e.height);t.drawImage(e,i.x1+h,i.y1+u,e.width*p*l,e.height*p*l)}else t.drawImage(e,i.x1,i.y1,i.width(),i.height());else{const p=e.width*l,v=e.height*l;t.drawImage(e,i.x1+h,i.y1+u,p,v)}else{if(s&&o!=="repeat"&&(e.width||e.height)){const m=e.width,y=e.height;o==="repeat-x"?(f=m*(c/y),g=c):o==="repeat-y"&&(g=y*(d/m),f=d);const b=t.dpr,_=jd.allocate({width:f,height:g,dpr:b}),w=_.getContext("2d");w&&(w.inuse=!0,w.clearMatrix(),w.setTransformForCurrent(!0),w.clearRect(0,0,f,g),w.drawImage(e,0,0,f,g),e=_.nativeCanvas),jd.free(_)}const p=t.dpr,v=t.createPattern(e,o);v.setTransform&&v.setTransform(new DOMMatrix([1/p,0,0,1/p,0,0])),t.fillStyle=v,t.translate(i.x1,i.y1),t.fillRect(0,0,d,c),t.translate(-i.x1,-i.y1)}}}const pu=new cA;let Zs=class{constructor(n){this.subRenderContribitions=n,this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(f=>{f.render(n,t,e,i,r,o,s,a,l,h,u,d,c)})}};Zs=uRt([yt(),mW(0,le(Wi)),mW(0,mn(UO)),dRt("design:paramtypes",[Object])],Zs);class cRt{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){var g,p;const{clipConfig:v}=t.attribute;if(!v)return;const m=t.getClipPath();if(!m)return;const y=!(d||c),b=t.AABBBounds,_=(g=t.attribute.width)!==null&&g!==void 0?g:b.width(),w=(p=t.attribute.height)!==null&&p!==void 0?p:b.height();y&&e.save(),e.beginPath(),m.draw(e,[_,w],i+_/2,r+w/2,0)===!1&&e.closePath(),d&&d(e,t.attribute,h,!0),y&&e.clip()}}const fRt=new cRt;class gRt{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){const{clipConfig:g}=t.attribute;g&&t.getClipPath()&&(d||c||e.restore())}}const pRt=new gRt;function vRt(n){return n<=.5?4*n-1:-4*n+3}function mRt(n,t,e,i,r,o,s){const{fill:a="orange",percent:l=.6,frequency:h=4,opacity:u,phi:d=0}=r;let{amplitude:c=10}=r;c*=vRt(t);const f=i*(1-l),g=e,p=Math.max(Math.round(g/70),2);n.beginPath(),n.moveTo(0+o,i+s),n.lineTo(0+o,f+s);const v=g/h*t,m=g/Math.PI/(2*h);for(let y=0;y<g;y+=p){const b=c*Math.sin((y+v+d)/m+d);n.lineTo(y+o,f+b+s)}n.lineTo(g+o,i+s),n.closePath(),n.fillStyle=a,isFinite(u)&&(n.globalAlpha=u),n.fill()}class KO{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=10,this._tempSymbolGraphic=null}createCommonPattern(t,e,i,r,o){const s=(t-2*e)/2,a=r.dpr,l=jd.allocate({width:t,height:t,dpr:a}),h=l.getContext("2d");if(!h)return null;h.inuse=!0,h.clearMatrix(),h.setTransformForCurrent(!0),h.clearRect(0,0,t,t),o(s,h);const u=r.createPattern(l.nativeCanvas,"repeat");return u.setTransform&&u.setTransform(new DOMMatrix([1/a,0,0,1/a,0,0])),jd.free(l),u}createCirclePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{s.fillStyle=i,s.arc(o,o,o,0,Zt),s.fill()})}createDiamondPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=t/2,l=a;s.fillStyle=i,s.moveTo(a,l-o),s.lineTo(o+a,l),s.lineTo(a,l+o),s.lineTo(a-o,l),s.closePath(),s.fill()})}createRectPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e,l=a;s.fillStyle=i,s.fillRect(a,l,2*o,2*o)})}createVerticalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e;s.fillStyle=i,s.fillRect(a,0,2*o,t)})}createHorizontalLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e;s.fillStyle=i,s.fillRect(0,a,t,2*o)})}createBiasLRLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{s.strokeStyle=i,s.lineWidth=o,s.moveTo(0,0),s.lineTo(t,t);const a=t/2,l=-a;s.moveTo(a,l),s.lineTo(a+t,l+t),s.moveTo(-a,-l),s.lineTo(-a+t,-l+t),s.stroke()})}createBiasRLLinePattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{s.strokeStyle=i,s.lineWidth=o,s.moveTo(t,0),s.lineTo(0,t);const a=t/2,l=a;s.moveTo(t+a,l),s.lineTo(a,l+t),s.moveTo(t-a,-l),s.lineTo(-a,-l+t),s.stroke()})}createGridPattern(t,e,i,r){return this.createCommonPattern(t,e,i,r,(o,s)=>{const a=e,l=a;s.fillStyle=i,s.fillRect(a,l,o,o),s.fillRect(a+o,l+o,o,o)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){this.textureMap||this.initTextureMap(e,t.stage);const{texture:g=h.texture,textureColor:p=h.textureColor,textureSize:v=h.textureSize,texturePadding:m=h.texturePadding}=t.attribute;g&&this.drawTexture(g,t,e,i,r,h,p,v,m)}drawTexture(t,e,i,r,o,s,a,l,h){var u;const{textureRatio:d=s.textureRatio,textureOptions:c=null}=e.attribute;let f=this.textureMap.get(t);if(!f)switch(t){case"circle":f=this.createCirclePattern(l,h,a,i);break;case"diamond":f=this.createDiamondPattern(l,h,a,i);break;case"rect":f=this.createRectPattern(l,h,a,i);break;case"vertical-line":f=this.createVerticalLinePattern(l,h,a,i);break;case"horizontal-line":f=this.createHorizontalLinePattern(l,h,a,i);break;case"bias-lr":f=this.createBiasLRLinePattern(l,h,a,i);break;case"bias-rl":f=this.createBiasRLLinePattern(l,h,a,i);break;case"grid":f=this.createGridPattern(l,h,a,i)}if(c&&c.dynamicTexture){const{gridConfig:g={},useNewCanvas:p}=c,v=e.AABBBounds;r=v.x1,o=v.y1;const m=i;let y;if(p){y=jd.allocate({width:v.width(),height:v.height(),dpr:i.dpr});const P=y.getContext("2d");P.clearRect(0,0,v.width(),v.height()),r=0,o=0,i=P}if(m.save(),e.parent&&!e.transMatrix.onlyTranslate()){const{scrollX:P=0,scrollY:B=0}=e.parent.attribute;m.setTransformFromMatrix(e.parent.globalTransMatrix),m.translate(P,B,!0)}m.setCommonStyle(e,e.attribute,r,o,s),m.clip();const b=v.width(),_=v.height(),w=h,C=l,x=g.columns?g.columns:Math.ceil(b/C),S=g.rows?g.rows:Math.ceil(_/C),A=g.gutterColumn?g.gutterColumn:2*w,T=g.gutterRow?g.gutterRow:2*w;this._tempSymbolGraphic||(this._tempSymbolGraphic=Qg({}));const M=g.columns?b/g.columns:C,R=g.rows?_/g.rows:C;this._tempSymbolGraphic.setAttributes({size:[M-A,R-T],symbolType:t});const E=this._tempSymbolGraphic.getParsedPath();for(let P=0;P<S;P++)for(let B=0;B<x;B++){const k=r+C/2+B*C,L=o+C/2+P*C;(u=c.beforeDynamicTexture)===null||u===void 0||u.call(c,i,P,B,S,x,d,e,v.width(),v.height()),i.beginPath(),E.draw(i,Math.min(M-A,R-T),k,L,0)===!1&&i.closePath(),i.fillStyle=a,c.dynamicTexture(i,P,B,S,x,d,e,v.width(),v.height())}p&&(m.globalAlpha=1,m.drawImage(y.nativeCanvas,0,0,y.nativeCanvas.width,y.nativeCanvas.height,v.x1,v.y1,v.width()*m.dpr,v.height()*m.dpr)),m.restore()}else if(f)i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,r,o,s),i.fillStyle=f,i.fill(),i.highPerformanceRestore();else if(t==="wave"){i.save(),i.setCommonStyle(e,e.attribute,r,o,s),i.clip();const g=e.AABBBounds;mRt(i,d,g.width(),g.height(),Object.assign(Object.assign({},c||{}),{fill:a}),r+g.x1-r,o+g.y1-o),i.restore()}}}const xp=new KO;class yRt{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){const{outerBorder:f,innerBorder:g}=t.attribute,p=f&&f.visible!==!1,v=g&&g.visible!==!1;if(!p&&!v)return;const{innerPadding:m=h.innerPadding,outerPadding:y=h.outerPadding,startAngle:b=h.startAngle,endAngle:_=h.endAngle,opacity:w=h.opacity,x:C=h.x,y:x=h.y,scaleX:S=h.scaleX,scaleY:A=h.scaleY,keepStrokeScale:T=h.keepStrokeScale}=t.attribute;let{innerRadius:M=h.innerRadius,outerRadius:R=h.outerRadius}=t.attribute;R+=y,M-=m;const E=(P,B)=>{const k=!(!P||!P.stroke),{distance:L=h[B].distance}=P,O=T?L:Ka(e,L,e.dpr),D=L/R,I=B==="outerBorder"?1:-1;if(t.setAttributes({outerRadius:R+I*O,innerRadius:M-I*O,startAngle:b-I*D,endAngle:_+I*D}),e.beginPath(),zP(t,e,i,r,R+I*O,M-I*O),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,P,h[B]);else if(k){const H=h[B].opacity;h[B].opacity=w,e.setStrokeStyle(t,P,(C-i)/S,(x-r)/A,h[B]),h[B].opacity=H,e.stroke()}};p&&E(f,"outerBorder"),v&&E(g,"innerBorder"),t.setAttributes({outerRadius:R,innerRadius:M,startAngle:b,endAngle:_})}}const bRt=new yRt,_Rt=xp,CRt=pu;class wRt{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){const{outerBorder:f,innerBorder:g}=t.attribute,p=f&&f.visible!==!1,v=g&&g.visible!==!1;if(!p&&!v)return;const{radius:m=h.radius,startAngle:y=h.startAngle,endAngle:b=h.endAngle,opacity:_=h.opacity,x:w=h.x,y:C=h.y,scaleX:x=h.scaleX,scaleY:S=h.scaleY,keepStrokeScale:A=h.keepStrokeScale}=t.attribute,T=(M,R)=>{const E=!(!M||!M.stroke),{distance:P=h[R].distance}=M,B=A?P:Ka(e,P,e.dpr),k=R==="outerBorder"?1:-1;if(e.beginPath(),e.arc(i,r,m+k*B,y,b),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,M,h[R]);else if(E){const L=h[R].opacity;h[R].opacity=_,e.setStrokeStyle(t,M,(w-i)/x,(C-r)/S,h[R]),h[R].opacity=L,e.stroke()}};p&&T(f,"outerBorder"),v&&T(g,"innerBorder")}}const xRt=new wRt,SRt=xp,ARt=pu;class TRt extends cA{constructor(){super(...arguments),this.time=xe.beforeFillStroke}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){const{background:f,backgroundMode:g=h.backgroundMode,backgroundFit:p=h.backgroundFit,backgroundKeepAspectRatio:v=h.backgroundKeepAspectRatio,backgroundScale:m=h.backgroundScale,backgroundOffsetX:y=h.backgroundOffsetX,backgroundOffsetY:b=h.backgroundOffsetY}=t.attribute;if(f)if(t.backgroundImg&&t.resources){const _=t.resources.get(f);if(_.state!=="success"||!_.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);const w=t.AABBBounds;this.doDrawImage(e,_.data,w,{backgroundMode:g,backgroundFit:p,backgroundKeepAspectRatio:v,backgroundScale:m,backgroundOffsetX:y,backgroundOffsetY:b}),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=f,e.fill(),e.highPerformanceRestore()}}const yW=new TRt,d_=Fi/2;function qa(n,t,e,i,r,o,s=!0,a){let l;if(Array.isArray(s)&&(a=s,s=!0),i<0&&(t+=i,i=-i),r<0&&(e+=r,r=-r),kn(o,!0))l=[o=De(o),o,o,o];else if(Array.isArray(o)){const x=o;let S,A;switch(x.length){case 0:l=[0,0,0,0];break;case 1:S=De(x[0]),l=[S,S,S,S];break;case 2:case 3:S=De(x[0]),A=De(x[1]),l=[S,A,S,A];break;default:l=x,l[0]=De(l[0]),l[1]=De(l[1]),l[2]=De(l[2]),l[3]=De(l[3])}}else l=[0,0,0,0];if(i<0||l[0]+l[1]+l[2]+l[3]<1e-12)return n.rect(t,e,i,r);const[h,u,d,c]=[[t,e],[t+i,e],[t+i,e+r],[t,e+r]],f=Math.min(i/2,r/2),g=[Math.min(f,l[0]),Math.min(f,l[1]),Math.min(f,l[2]),Math.min(f,l[3])],p=[h[0]+g[0],h[1]],v=[h[0],h[1]+g[0]],m=[u[0]-g[1],u[1]],y=[u[0],u[1]+g[1]],b=[d[0]-g[2],d[1]],_=[d[0],d[1]-g[2]],w=[c[0]+g[3],c[1]],C=[c[0],c[1]-g[3]];if(n.moveTo(p[0],p[1]),s){if(a&&a[0]?a[0](p[0],p[1],m[0],m[1]):n.lineTo(m[0],m[1]),!Zb(m,y)){a&&a[0]&&n.moveTo(m[0],m[1]);const x=m[0],S=m[1]+g[1];n.arc(x,S,g[1],-d_,0,!1)}if(a&&a[1]?a[1](y[0],y[1],_[0],_[1]):n.lineTo(_[0],_[1]),!Zb(b,_)){const x=_[0]-g[2],S=_[1];a&&a[1]&&n.moveTo(_[0],_[1]),n.arc(x,S,g[2],0,d_,!1)}if(a&&a[2]?a[2](b[0],b[1],w[0],w[1]):n.lineTo(w[0],w[1]),!Zb(w,C)){const x=w[0],S=w[1]-g[3];a&&a[2]&&n.moveTo(w[0],w[1]),n.arc(x,S,g[3],d_,Fi,!1)}if(a&&a[3]?a[3](C[0],C[1],v[0],v[1]):n.lineTo(v[0],v[1]),!Zb(p,v)){const x=p[0],S=p[1]+g[0];a&&a[3]&&n.moveTo(v[0],v[1]),n.arc(x,S,g[0],Fi,Fi+d_,!1)}}else a&&a[0]?a[0](p[0],p[1],m[0],m[1]):n.lineTo(m[0],m[1]),a&&a[1]?a[1](m[0],m[1],b[0],b[1]):n.lineTo(b[0],b[1]),a&&a[2]?a[2](b[0],b[1],w[0],w[1]):n.lineTo(w[0],w[1]),a&&a[2]?a[2](w[0],w[1],p[0],p[1]):n.lineTo(p[0],p[1]);return!a&&n.closePath(),n}var KK=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class qK{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){const{outerBorder:f,innerBorder:g}=t.attribute,p=f&&f.visible!==!1,v=g&&g.visible!==!1;if(!p&&!v)return;const{cornerRadius:m=h.cornerRadius,cornerType:y=h.cornerType,opacity:b=h.opacity,x:_=h.x,y:w=h.y,scaleX:C=h.scaleX,scaleY:x=h.scaleY,x1:S,y1:A,keepStrokeScale:T=h.keepStrokeScale}=t.attribute;let{width:M,height:R}=t.attribute;M=(M??S-i)||0,R=(R??A-r)||0;const E=(P,B)=>{const k=!(!P||!P.stroke),L=B==="outerBorder"?-1:1,{distance:O=h[B].distance}=P,D=T?O:Ka(e,O,e.dpr),I=i+L*D,H=r+L*D,F=2*D;if(m===0||ke(m)&&m.every(G=>G===0)?(e.beginPath(),e.rect(I,H,M-L*F,R-L*F)):(e.beginPath(),qa(e,I,H,M-L*F,R-L*F,m,y!=="bevel")),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,P,h[B]);else if(k){const G=h[B].opacity;h[B].opacity=b,e.setStrokeStyle(t,P,(_-i)/C,(w-r)/x,h[B]),h[B].opacity=G,e.stroke()}};p&&E(f,"outerBorder"),v&&E(g,"innerBorder")}}let ep=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){const{stroke:g=h.stroke}=t.attribute;Array.isArray(g)&&g.some(p=>p===!1)&&(f.doStroke=!1)}};ep=KK([yt()],ep);let ip=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){const{x1:f,y1:g,x:p=h.x,y:v=h.y,stroke:m=h.stroke,cornerRadius:y=h.cornerRadius,cornerType:b=h.cornerType}=t.attribute;let{width:_,height:w}=t.attribute;if(_=(_??f-p)||0,w=(w??g-v)||0,Array.isArray(m)&&m.some(C=>C===!1)){if(e.setStrokeStyle(t,t.attribute,i,r,h),!(y===0||ke(y)&&y.every(C=>C===0))){let C,x=0;return qa(e,i,r,_,w,y,b!=="bevel",new Array(4).fill(0).map((S,A)=>(T,M,R,E)=>{m[A]&&(x===A-1&&m[A]===C||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:m[A]}),i,r,h),e.beginPath(),e.moveTo(T,M),C=m[A]),x=A,e.lineTo(R,E),e.stroke(),A===3&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(i,r),m[0]?e.lineTo(i+_,r):e.moveTo(i+_,r),m[1]?e.lineTo(i+_,r+w):e.moveTo(i+_,r+w),m[2]?e.lineTo(i,r+w):e.moveTo(i,r+w),m[3]){const C=m[0]?r-e.lineWidth/2:r;e.lineTo(i,C)}else e.moveTo(i,r);e.stroke()}}};ip=KK([yt()],ip);const MRt=new qK,RRt=xp,BRt=pu;class PRt extends qK{constructor(){super(...arguments),this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){return super.drawShape(t,e,i,r,o,s,a,l,h,u,d,c)}}const kRt=new PRt,ERt=pu;class LRt{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){const f=t.getParsedPath();if(!f)return;const{outerBorder:g,innerBorder:p}=t.attribute,v=g&&g.visible!==!1,m=p&&p.visible!==!1;if(!v&&!m)return;const{size:y=h.size,opacity:b=h.opacity,x:_=h.x,y:w=h.y,scaleX:C=h.scaleX,scaleY:x=h.scaleY,keepStrokeScale:S=h.keepStrokeScale}=t.attribute,A=(T,M)=>{const R=!(!T||!T.stroke),{distance:E=h[M].distance}=T,P=S?E:Ka(e,E,e.dpr),B=M==="outerBorder"?1:-1;if(e.beginPath(),f.drawOffset(e,y,i,r,B*P)===!1&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,T,h[M]);else if(R){const k=h[M].opacity;h[M].opacity=b,e.setStrokeStyle(t,T,(_-i)/C,(w-r)/x,h[M]),h[M].opacity=k,e.stroke()}};v&&A(g,"outerBorder"),m&&A(p,"innerBorder")}}class ORt{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){const{clipRange:g=h.clipRange,x:p=h.x,y:v=h.y,z:m=h.z,size:y=h.size,scaleX:b=h.scaleX,scaleY:_=h.scaleY}=t.attribute,w=t.getParsedPath();w&&g<1&&g>0&&(e.beginPath(),w.drawWithClipRange&&w.drawWithClipRange(e,y,i,r,g,m,(C,x)=>{var S,A,T,M;if(t._parsedPath.svgCache){const R=Object.assign({},x);R.fill=(S=x.fill)!==null&&S!==void 0?S:t.attribute.fill,R.opacity=(A=x.opacity)!==null&&A!==void 0?A:t.attribute.opacity,R.fillOpacity=t.attribute.fillOpacity,R.stroke=(T=x.stroke)!==null&&T!==void 0?T:t.attribute.stroke,R.lineWidth=(M=x.lineWidth)!==null&&M!==void 0?M:t.attribute.lineWidth,x=R}x.stroke&&(c?c(e,t.attribute,h):l&&(e.setStrokeStyle(t,x,(p-i)/b,(v-r)/_,h),e.stroke()))}),s&&!w.isSvg&&(c?c(e,t.attribute,h):l&&(e.setStrokeStyle(t,t.attribute,(p-i)/b,(v-r)/_,h),e.stroke())))}}const DRt=new LRt,IRt=new ORt,HRt=xp,FRt=pu;class zRt extends KO{constructor(){super(...arguments),this.time=xe.afterFillStroke}drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f){var g,p,v,m;this.textureMap||this.initTextureMap(e,t.stage);const{attribute:y=t.attribute}=f||{},{texture:b=(g=t.attribute.texture)!==null&&g!==void 0?g:s_(h,"texture"),textureColor:_=(p=t.attribute.textureColor)!==null&&p!==void 0?p:s_(h,"textureColor"),textureSize:w=(v=t.attribute.textureSize)!==null&&v!==void 0?v:s_(h,"textureSize"),texturePadding:C=(m=t.attribute.texturePadding)!==null&&m!==void 0?m:s_(h,"texturePadding")}=y;b&&this.drawTexture(b,t,e,i,r,h,_,w,C)}}const $i={x:0,y:0,z:0,lastModelMatrix:null};class to{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions||(this.builtinContributions=[]),this.builtinContributions.push(fRt),this.builtinContributions.push(pRt),this.builtinContributions.forEach(e=>this._renderContribitions.push(e)),this._renderContribitions.length&&(this._renderContribitions.sort((e,i)=>i.order-e.order),this._beforeRenderContribitions=this._renderContribitions.filter(e=>e.time===xe.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(e=>e.time===xe.afterFillStroke))}reInit(){this.init(this.graphicRenderContributions)}beforeRenderStep(t,e,i,r,o,s,a,l,h,u,d,c,f){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(g=>{g.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(g.supportedAppName)?g.supportedAppName:[g.supportedAppName]).includes(t.stage.params.context.appName)||g.drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f)})}afterRenderStep(t,e,i,r,o,s,a,l,h,u,d,c,f){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(g=>{g.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(g.supportedAppName)?g.supportedAppName:[g.supportedAppName]).includes(t.stage.params.context.appName)||g.drawShape(t,e,i,r,o,s,a,l,h,u,d,c,f)})}drawPathProxy(t,e,i,r,o,s,a,l){if(!t.pathProxy)return!1;const h=te(t,s?.theme)[t.type.replace("3d","")],{fill:u=h.fill,stroke:d=h.stroke,opacity:c=h.opacity,fillOpacity:f=h.fillOpacity,lineWidth:g=h.lineWidth,strokeOpacity:p=h.strokeOpacity,visible:v=h.visible,x:m=h.x,y=h.y}=t.attribute,b=vc(c,f,u),_=FP(c,p),w=Zg(u),C=Em(d,g);if(!v||!w&&!C||!(b||_||a||l))return!0;e.beginPath();const x=typeof t.pathProxy=="function"?t.pathProxy(t.attribute):t.pathProxy;return Xl(x.commandList,e,i,r),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),this.beforeRenderStep(t,e,i,r,w,C,b,_,h,o,a,l),C&&(l?l(e,t.attribute,h):_&&(e.setStrokeStyle(t,t.attribute,i-m,r-y,h),e.stroke())),w&&(a?a(e,t.attribute,h):b&&(e.setCommonStyle(t,t.attribute,i-m,r-y,h),e.fill())),this.afterRenderStep(t,e,i,r,w,C,b,_,h,o,a,l),!0}valid(t,e,i,r){const{fill:o=e.fill,background:s,stroke:a=e.stroke,opacity:l=e.opacity,fillOpacity:h=e.fillOpacity,lineWidth:u=e.lineWidth,strokeOpacity:d=e.strokeOpacity,visible:c=e.visible}=t.attribute,f=vc(l,h,o),g=FP(l,d),p=Zg(o,s),v=Em(a,u);return!(!t.valid||!c)&&!(!p&&!v)&&!!(f||g||i||r||s)&&{fVisible:f,sVisible:g,doFill:p,doStroke:v}}transform(t,e,i,r=!1){const{x:o=e.x,y:s=e.y,z:a=e.z,scaleX:l=e.scaleX,scaleY:h=e.scaleY,angle:u=e.angle,postMatrix:d}=t.attribute,c=i.modelMatrix,f=i.camera;$i.x=o,$i.y=s,$i.z=a,$i.lastModelMatrix=c;const g=f&&(r||ZMt(t)),p=g?t.transMatrix.onlyTranslate()&&!d:l===1&&h===1&&u===0&&!d;if(g){const v=fn.allocate(),m=fn.allocate();jK(m,t,e),Ry(v,c||v,m),$i.x=0,$i.y=0,$i.z=0,i.modelMatrix=v,i.setTransform(1,0,0,1,0,0,!0),fn.free(m)}if(p&&!c){const v=t.getOffsetXY(e);$i.x+=v.x,$i.y+=v.y,$i.z=a,i.setTransformForCurrent()}else if(g)$i.x=0,$i.y=0,$i.z=0,i.setTransform(1,0,0,1,0,0,!0);else if(f&&i.project){const v=t.getOffsetXY(e);$i.x+=v.x,$i.y+=v.y,this.transformWithoutTranslate(i,$i.x,$i.y,$i.z,l,h,u)}else i.transformFromMatrix(t.transMatrix,!0),$i.x=0,$i.y=0,$i.z=0;return $i}transformUseContext2d(t,e,i,r){const o=r.camera;if(this.camera=o,o){const s=t.AABBBounds,a=s.x2-s.x1,l=s.y2-s.y1,h=r.project(0,0,i),u=r.project(a,0,i),d=r.project(a,l,i),c={x:0,y:0},f={x:a,y:0},g={x:a,y:l};r.camera=null;const p=1/(c.x*(g.y-f.y)-f.x*g.y+g.x*f.y+(f.x-g.x)*c.y),v=-(c.y*(d.x-u.x)-f.y*d.x+g.y*u.x+(f.y-g.y)*h.x)*p,m=(f.y*d.y+c.y*(u.y-d.y)-g.y*u.y+(g.y-f.y)*h.y)*p,y=(c.x*(d.x-u.x)-f.x*d.x+g.x*u.x+(f.x-g.x)*h.x)*p,b=-(f.x*d.y+c.x*(u.y-d.y)-g.x*u.y+(g.x-f.x)*h.y)*p,_=(c.x*(g.y*u.x-f.y*d.x)+c.y*(f.x*d.x-g.x*u.x)+(g.x*f.y-f.x*g.y)*h.x)*p,w=(c.x*(g.y*u.y-f.y*d.y)+c.y*(f.x*d.y-g.x*u.y)+(g.x*f.y-f.x*g.y)*h.y)*p;r.setTransform(v,m,y,b,_,w,!0)}}restoreTransformUseContext2d(t,e,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(t,e,i,r,o,s,a){const l=t.project(e,i,r);t.translate(l.x,l.y,!1),t.scale(o,s,!1),t.rotate(a,!1),t.translate(-l.x,-l.y,!1),t.setTransformForCurrent()}_draw(t,e,i,r,o,s){const{context:a}=r;if(!a)return;const{renderable:l}=t.attribute;if(l===!1)return;a.highPerformanceSave();const h=this.transform(t,e,a,i),{x:u,y:d,z:c,lastModelMatrix:f}=h;this.z=c,this.drawPathProxy(t,a,u,d,r,o)||(this.drawShape(t,a,u,d,r,o,null,null,s),this.z=0,a.modelMatrix!==f&&fn.free(a.modelMatrix),a.modelMatrix=f),a.highPerformanceRestore()}}var NRt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},WRt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},bW=function(n,t){return function(e,i){t(e,i,n)}};let qw=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=nA,this.builtinContributions=[bRt,CRt,_Rt],this.init(n)}drawArcTailCapPath(n,t,e,i,r,o,s,a){const l=a-s,h=n.getParsedAngle(),u=h.startAngle;let d=h.endAngle;d=a;const c=d>u;let f=!1;if(r<o){const k=r;r=o,o=k}const{xors:g,yors:p,xirs:v,yirs:m,limitedOcr:y,outerCornerRadiusStart:b,outerCornerRadiusEnd:_,maxOuterCornerRadius:w,xore:C,yore:x,xire:S,yire:A,limitedIcr:T,innerDeltaAngle:M,innerStartAngle:R,innerCornerRadiusStart:E,innerCornerRadiusEnd:P,maxInnerCornerRadius:B}=$K(n,u,d,o,r);if(y>ii){const k=er(b,y),L=er(_,y),O=Hh(v,m,g,p,r,k,Number(c)),D=Hh(C,x,S,A,r,L,Number(c));if(y<w&&k===L)t.moveTo(e+O.cx+O.x01,i+O.cy+O.y01),t.arc(e+O.cx,i+O.cy,y,Le(O.y01,O.x01),Le(D.y01,D.x01),!c);else{const I=d-l-.03,H=Le(D.y11,D.x11);t.arc(e,i,r,I,H,!c),L>0&&t.arc(e+D.cx,i+D.cy,L,Le(D.y11,D.x11),Le(D.y01,D.x01),!c)}}else t.moveTo(e+g,i+p);if(!(o>ii)||M<.001)t.lineTo(e+S,i+A),f=!0;else if(T>ii){const k=er(E,T),L=er(P,T),O=Hh(S,A,C,x,o,-L,Number(c)),D=Hh(g,p,v,m,o,-k,Number(c));if(t.lineTo(e+O.cx+O.x01,i+O.cy+O.y01),T<B&&k===L){const I=Le(D.y01,D.x01);t.arc(e+O.cx,i+O.cy,T,Le(O.y01,O.x01),I,!c)}else{L>0&&t.arc(e+O.cx,i+O.cy,L,Le(O.y01,O.x01),Le(O.y11,O.x11),!c);const I=Le(O.cy+O.y11,O.cx+O.x11),H=d-l-.03;t.arc(e,i,o,I,H,c)}}else t.lineTo(e+o*hn(R),i+o*xi(R));return f}drawShape(n,t,e,i,r,o,s,a,l){l=l??te(n,o?.theme).arc;const{fill:h=l.fill,stroke:u=l.stroke,x:d=l.x,y:c=l.y,fillStrokeOrder:f=l.fillStrokeOrder}=n.attribute,g=this.valid(n,l,s,a);if(!g)return;const{fVisible:p,sVisible:v,doFill:m,doStroke:y}=g,{outerPadding:b=l.outerPadding,innerPadding:_=l.innerPadding,cap:w=l.cap,forceShowCap:C=l.forceShowCap}=n.attribute;let{outerRadius:x=l.outerRadius,innerRadius:S=l.innerRadius}=n.attribute;x+=b,S-=_;let A=0;const T=(Sm(w)&&w||w[0])&&h.gradient==="conical";if(T){const{sc:P,startAngle:B,endAngle:k}=n.getParsedAngle();De(k-B)<Zt-ii&&(A=P||0,h.startAngle-=A,h.endAngle-=A)}let M=!1;const{isFullStroke:R,stroke:E}=sTt(u);if((m||R)&&(t.beginPath(),zP(n,t,e,i,x,S),M=!0,t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,m,y,p,v,l,r,s,a),f?(this._runStroke(n,t,e,i,l,y,R,v,a),this._runFill(n,t,e,i,l,m,p,d,c,s)):(this._runFill(n,t,e,i,l,m,p,d,c,s),this._runStroke(n,t,e,i,l,y,R,v,a))),!R&&y&&(t.beginPath(),zP(n,t,e,i,x,S,E),M||this.beforeRenderStep(n,t,e,i,m,y,p,v,l,r,s,a),a?a(t,n.attribute,l):v&&(t.setStrokeStyle(n,n.attribute,e,i,l),t.stroke())),(Sm(w)&&w||w[1])&&C){const{startAngle:P,endAngle:B}=n.getParsedAngle();if(De(B-P)>=Zt-ii){t.beginPath();const k=Math.abs(x-S)/2/x,{endAngle:L=l.endAngle,fill:O=l.fill}=n.attribute,D=L;this.drawArcTailCapPath(n,t,e,i,x,S,D,D+k),M||this.beforeRenderStep(n,t,e,i,m,y,p,v,l,r,s,a);const I=()=>{if(m){const F=O;if(F.gradient==="conical"){const G=IMt(0,0,L,F);s||vc&&(t.setCommonStyle(n,n.attribute,e,i,l),t.fillStyle=G,t.fill())}}},H=()=>{y&&(a||v&&(t.setStrokeStyle(n,n.attribute,e,i,l),t.stroke()))};I(),H()}}this.afterRenderStep(n,t,e,i,m,y,p,v,l,r,s,a),T&&(h.startAngle+=A,h.endAngle+=A)}_runFill(n,t,e,i,r,o,s,a,l,h){o&&(h?h(t,n.attribute,r):s&&(t.setCommonStyle(n,n.attribute,a-e,l-i,r),t.fill()))}_runStroke(n,t,e,i,r,o,s,a,l){o&&s&&(l?l(t,n.attribute,r):a&&(t.setStrokeStyle(n,n.attribute,e,i,r),t.stroke()))}draw(n,t,e,i){const r=te(n,i?.theme).arc;this._draw(n,r,!1,e,i,r)}};qw=NRt([yt(),bW(0,le(Wi)),bW(0,mn(NP)),WRt("design:paramtypes",[Object])],qw);var VRt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},GRt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},_W=function(n,t){return function(e,i){t(e,i,n)}};let Zw=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=rA,this.builtinContributions=[xRt,ARt,SRt],this.init(n)}drawShape(n,t,e,i,r,o,s,a){const l=te(n,o?.theme).circle,{radius:h=l.radius,startAngle:u=l.startAngle,endAngle:d=l.endAngle,x:c=l.x,y:f=l.y,fillStrokeOrder:g=l.fillStrokeOrder}=n.attribute,p=this.valid(n,l,s,a);if(!p)return;const{fVisible:v,sVisible:m,doFill:y,doStroke:b}=p;t.beginPath(),t.arc(e,i,h,u,d),t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,y,b,v,m,l,r,s,a);const _=()=>{y&&(s?s(t,n.attribute,l):v&&(t.setCommonStyle(n,n.attribute,c-e,f-i,l),t.fill()))},w=()=>{b&&(a?a(t,n.attribute,l):m&&(t.setStrokeStyle(n,n.attribute,c-e,f-i,l),t.stroke()))};g?(w(),_()):(_(),w()),this.afterRenderStep(n,t,e,i,y,b,v,m,l,r,s,a)}draw(n,t,e,i){const r=te(n,i?.theme).circle;this._draw(n,r,!1,e,i)}};Zw=VRt([yt(),_W(0,le(Wi)),_W(0,mn(WP)),GRt("design:paramtypes",[Object])],Zw);function Jw(n,t,e,i){if(!t.p1)return;const{offsetX:r=0,offsetY:o=0,offsetZ:s=0}=i||{};if(e===1)t.p2&&t.p3?n.bezierCurveTo(r+t.p1.x,o+t.p1.y,r+t.p2.x,o+t.p2.y,r+t.p3.x,o+t.p3.y,s):n.lineTo(r+t.p1.x,o+t.p1.y,s);else if(t.p2&&t.p3){const[a]=Kg(t,e);n.bezierCurveTo(r+a.p1.x,o+a.p1.y,r+a.p2.x,o+a.p2.y,r+a.p3.x,o+a.p3.y,s)}else{const a=t.getPointAt(e);n.lineTo(r+a.x,o+a.y,s)}}function CW(n,t,e,i,r,o,s){var a;let l=t.p0,h=i;if(e&&e.originP1===e.originP2&&(l=e.p0),t.defined)i||(n.lineTo(l.x+r,l.y+o,s),h=!i);else{const{originP1:u,originP2:d}=t;let c;if(u&&u.defined!==!1&&!e?c=l:u&&d.defined!==!1&&(c=(a=t.p3)!==null&&a!==void 0?a:t.p1),i){h=!i;const f=c?c.x:t.p0.x,g=c?c.y:t.p0.y;n.moveTo(f+r,g+o,s)}else c&&(h=!i,n.lineTo(c.x+r,c.y+o,s))}return h}function ZK(n,t,e,i,r){const{offsetX:o=0,offsetY:s=0,offsetZ:a=0,mode:l="none",drawConnect:h=!1}=r||{};if(h&&l==="none"||!t)return;let u=!0;const{curves:d}=t;if(e>=1){if(h){let m,y=!0;d.forEach((b,_)=>{b.originP1!==b.originP2&&(y=CW(n,b,m,y,o,s,a)),m=b})}else d.forEach(m=>{m.defined?(u&&n.moveTo(m.p0.x+o,m.p0.y+s,a),Jw(n,m,1,r),u=!1):u=!0});return}if(e<=0)return;let c;i==="x"?c=ze.ROW:i==="y"?c=ze.COLUMN:i==="auto"&&(c=t.direction);const f=e*t.tryUpdateLength(c);let g=0,p=!0,v=null;for(let m=0,y=d.length;m<y;m++){const b=d[m],_=b.getLength(c),w=(f-g)/_;if(g+=_,w<0)break;if(h){if(b.originP1===b.originP2){v=b;continue}p=CW(n,b,v,p,o,s,a),v=b}else{if(!b.defined){u=!0;continue}u&&n.moveTo(b.p0.x+o,b.p0.y+s,a),Jw(n,b,er(w,1),r),u=!1}}}function $Rt(n,t,e,i){const{offsetX:r=0,offsetY:o=0}=i||{},s=t?t.points[t.points.length-1]:e.points[0];n.moveTo(s.x+r,s.y+o),e.points.forEach(a=>{a.defined!==!1?n.lineTo(a.x+r,a.y+o):n.moveTo(a.x+r,a.y+o)})}function jRt(n,t,e,i){const{offsetX:r=0,offsetY:o=0}=i||{},{points:s}=e,a=[];for(let l=0;l<s.length;l++)s[l].defined;a.push(s),a.forEach((l,h)=>{var u,d,c,f;const g=t&&h===0?t.points[t.points.length-1]:l[0];n.moveTo(g.x+r,g.y+o),l.forEach(p=>{p.defined!==!1?n.lineTo(p.x+r,p.y+o):n.moveTo(p.x+r,p.y+o)});for(let p=l.length-1;p>=0;p--){const v=l[p];n.lineTo((u=v.x1)!==null&&u!==void 0?u:v.x,(d=v.y1)!==null&&d!==void 0?d:v.y)}n.lineTo((c=g.x1)!==null&&c!==void 0?c:g.x,(f=g.y1)!==null&&f!==void 0?f:g.y),n.closePath()})}var URt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Im=class extends to{constructor(){super(...arguments),this.numberType=My}draw(n,t,e,i){const r=te(n,i?.theme).line;this._draw(n,r,!1,e,i)}drawSegmentItem(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){var p;if(!t)return;n.beginPath();const v=(p=this.z)!==null&&p!==void 0?p:0;ZK(n,t,l,h,{offsetX:u,offsetY:d,offsetZ:v}),c.cache&&!ke(c.cache)&&c.cache.curves.every(b=>b.defined)&&c.attribute.curveType&&c.attribute.curveType.includes("Closed")&&n.closePath(),n.setShadowBlendStyle&&n.setShadowBlendStyle(c,s,a);const{x:m=0,x:y=0}=s;return e!==!1&&(f?f(n,s,a):r&&(n.setCommonStyle(c,s,m-u,y-d,a),n.fill())),i!==!1&&(g?g(n,s,a):o&&(n.setStrokeStyle(c,s,m-u,y-d,a),n.stroke())),!1}drawLinearLineHighPerformance(n,t,e,i,r,o,s,a,l,h,u,d,c){var f;t.beginPath();const g=(f=this.z)!==null&&f!==void 0?f:0,{points:p}=n.attribute,v=p[0];t.moveTo(v.x+s,v.y+a,g);for(let b=1;b<p.length;b++){const _=p[b];t.lineTo(_.x+s,_.y+a,g)}t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l);const{x:m=0,x:y=0}=n.attribute;e!==!1&&(d?d(t,n.attribute,l):r&&(t.setCommonStyle(n,n.attribute,m-s,y-a,l),t.fill())),i!==!1&&(c?c(t,n.attribute,l):o&&(t.setStrokeStyle(n,n.attribute,m-s,y-a,l),t.stroke()))}drawShape(n,t,e,i,r,o,s,a){const l=te(n,o?.theme).line,{fill:h=l.fill,stroke:u=l.stroke,fillOpacity:d=l.fillOpacity,strokeOpacity:c=l.strokeOpacity,segments:f,points:g,closePath:p,curveTension:v=l.curveTension,connectedType:m=l.connectedType}=n.attribute;if(!this.valid(n,l,s,a))return;let{curveType:y=l.curveType}=n.attribute;p&&y==="linear"&&(y="linearClosed");const{clipRange:b=l.clipRange,clipRangeByDimension:_=l.clipRangeByDimension}=n.attribute;if(b===1&&!f&&!g.some(C=>C.defined===!1)&&y==="linear")return this.drawLinearLineHighPerformance(n,t,!!h,!!u,d,c,e,i,l,r,o,s,a);function w(C,x){return x==="none"?C:C.filter(S=>S.defined!==!1)}if(n.shouldUpdateShape()){const{points:C,segments:x}=n.attribute,S=C;if(x&&x.length){let A,T;if(n.cache=x.map((M,R)=>{if(M.points.length<=1&&R===0)return M.points[0]&&(T={endX:M.points[0].x,endY:M.points[0].y,curves:[{defined:M.points[0].defined!==!1}]}),null;R===1?A={x:T.endX,y:T.endY,defined:T.curves[T.curves.length-1].defined}:R>1&&(A.x=T.endX,A.y=T.endY,A.defined=T.curves[T.curves.length-1].defined);const E=Md(w(M.points,m),y,{startPoint:A,curveTension:v});return T=E,E}).filter(M=>!!M),y==="linearClosed"){let M;for(let R=0;R<n.cache.length;R++){const E=n.cache[R];for(let P=0;P<E.curves.length;P++)if(E.curves[P].defined){M=E.curves[P].p0;break}if(M)break}n.cache[n.cache.length-1]&&n.cache[n.cache.length-1].lineTo(M.x,M.y,!0)}}else{if(!C||!C.length)return n.cache=null,void n.clearUpdateShapeTag();n.cache=Md(w(S,m),y,{curveTension:v})}n.clearUpdateShapeTag()}if(Array.isArray(n.cache)){const C=n.attribute.segments.filter(x=>x.points.length);if(C[0].points.length===1&&C.shift(),b===1){let x=!1;n.cache.forEach((S,A)=>{x||(x=this.drawSegmentItem(t,S,!!h,!!u,d,c,C[A],[l,n.attribute],b,_,e,i,n,s,a))})}else{const x=n.cache.reduce((M,R)=>M+R.getLength(),0),S=b*x;let A=0,T=!1;n.cache.forEach((M,R)=>{if(T)return;const E=M.getLength(),P=(S-A)/E;A+=E,P>0&&(T=this.drawSegmentItem(t,M,!!h,!!u,d,c,C[R],[l,n.attribute],er(P,1),_,e,i,n,s,a))})}}else this.drawSegmentItem(t,n.cache,!!h,!!u,d,c,n.attribute,l,b,_,e,i,n,s,a)}};Im=URt([yt()],Im);function XRt(n,t,e,i){var r;const{top:o,bottom:s}=t;if(o.curves.length!==s.curves.length)return;if(e>=1){const m=[],y=[];let b=!0;for(let _=0,w=o.curves.length;_<w;_++){const C=o.curves[_];b!==C.defined?(b?(c_(n,m,y,i),m.length=0,y.length=0):(m.push(C),y.push(s.curves[w-_-1])),b=!b):b&&(m.push(C),y.push(s.curves[w-_-1]))}return void c_(n,m,y,i)}if(e<=0)return;let{direction:a}=i||{};const{curves:l}=o,h=(r=l[l.length-1].p3)!==null&&r!==void 0?r:l[l.length-1].p1,u=De(h.x-l[0].p0.x),d=De(h.y-l[0].p0.y);a=a??(u>d?ze.ROW:ze.COLUMN),Number.isFinite(u)||(a=ze.COLUMN),Number.isFinite(d)||(a=ze.ROW);const c=e*(a===ze.ROW?u:d);let f=0,g=!0;const p=[],v=[];for(let m=0,y=o.curves.length;m<y;m++){const b=o.curves[m],_=b.getLength(a),w=(c-f)/_;if(w<0)break;f+=_;let C=null,x=null;g!==b.defined?(g?(c_(n,p,v,i),p.length=0,v.length=0):(C=b,x=s.curves[y-m-1]),g=!g):g&&(C=b,x=s.curves[y-m-1]),C&&x&&(w<1&&(C=C.p2&&C.p3?Kg(C,w)[0]:y5(C,w)[0],x=x.p2&&x.p3?Kg(x,1-w)[1]:y5(x,1-w)[1]),C.defined=g,x.defined=g,p.push(C),v.push(x)),C=null,x=null}c_(n,p,v,i)}function c_(n,t,e,i){const{offsetX:r=0,offsetY:o=0,offsetZ:s=0}=i||{};let a=!0;t.forEach(l=>{l.defined?(a&&n.moveTo(l.p0.x+r,l.p0.y+o,s),Jw(n,l,1,i),a=!1):a=!0}),a=!0;for(let l=e.length-1;l>=0;l--){const h=e[l];h.defined?(a&&n.lineTo(h.p0.x+r,h.p0.y+o,s),Jw(n,h,1,i),a=!1):a=!0}n.closePath()}const YRt=new zRt,KRt=pu;var qRt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},ZRt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},wW=function(n,t){return function(e,i){t(e,i,n)}};let JP=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=DK,this.builtinContributions=[YRt,KRt],this.init(n)}drawLinearAreaHighPerformance(n,t,e,i,r,o,s,a,l,h,u,d,c){var f,g,p;const{points:v}=n.attribute;if(v.length<2)return;t.beginPath();const m=(f=this.z)!==null&&f!==void 0?f:0,y=v[0];t.moveTo(y.x+s,y.y+a,m);for(let w=1;w<v.length;w++){const C=v[w];t.lineTo(C.x+s,C.y+a,m)}for(let w=v.length-1;w>=0;w--){const C=v[w];t.lineTo(((g=C.x1)!==null&&g!==void 0?g:C.x)+s,((p=C.y1)!==null&&p!==void 0?p:C.y)+a,m)}t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,s,a,!!r,!1,e,!1,l,h,d,null,{attribute:n.attribute});const{x:b=0,x:_=0}=n.attribute;e!==!1&&(d?d(t,n.attribute,l):r&&(t.setCommonStyle(n,n.attribute,b-s,_-a,l),t.fill())),this.afterRenderStep(n,t,s,a,!!r,!1,e,!1,l,h,d,null,{attribute:n.attribute}),(()=>{var w,C;if(i){const{stroke:x=l&&l.stroke}=n.attribute;if(ke(x)&&(x[0]||x[2])&&x[1]===!1){if(t.beginPath(),x[0]){t.moveTo(y.x+s,y.y+a,m);for(let S=1;S<v.length;S++){const A=v[S];t.lineTo(A.x+s,A.y+a,m)}}else if(x[2]){const S=v[v.length-1];t.moveTo(S.x+s,S.y+a,m);for(let A=v.length-2;A>=0;A--){const T=v[A];t.lineTo(((w=T.x1)!==null&&w!==void 0?w:T.x)+s,((C=T.y1)!==null&&C!==void 0?C:T.y)+a,m)}}}c?c(t,n.attribute,l):(t.setStrokeStyle(n,n.attribute,b-s,_-a,l),t.stroke())}})()}drawShape(n,t,e,i,r,o,s,a){var l,h,u,d,c,f;const g=te(n,o?.theme).area,{fill:p=g.fill,stroke:v=g.stroke,fillOpacity:m=g.fillOpacity,z:y=g.z,strokeOpacity:b=g.strokeOpacity,curveTension:_=g.curveTension,connectedType:w=g.connectedType}=n.attribute,C=this.valid(n,g,s,a);if(!C)return;const{doFill:x}=C,S=C.doStroke&&C.sVisible,{clipRange:A=g.clipRange,closePath:T,points:M,segments:R}=n.attribute;let{curveType:E=g.curveType}=n.attribute;function P(B,k){return k!=="connect"?B:B.filter(L=>L.defined!==!1)}if(T&&E==="linear"&&(E="linearClosed"),A===1&&!R&&!M.some(B=>B.defined===!1)&&E==="linear")return this.drawLinearAreaHighPerformance(n,t,!!p,S,m,b,e,i,g,r,o,s,a);if(n.shouldUpdateShape()){if(R&&R.length){let B,k;const L=R.map((I,H)=>{if(I.points.length<=1&&H===0)return I.points[0]&&(k={endX:I.points[0].x,endY:I.points[0].y}),null;H===1?B={x:k.endX,y:k.endY}:H>1&&(B.x=k.endX,B.y=k.endY);const F=Md(P(I.points,w),E,{startPoint:B,curveTension:_});return k=F,F}).filter(I=>!!I);let O;const D=[];for(let I=R.length-1;I>=0;I--){const H=R[I].points,F=[];for(let G=H.length-1;G>=0;G--)F.push({x:(l=H[G].x1)!==null&&l!==void 0?l:H[G].x,y:(h=H[G].y1)!==null&&h!==void 0?h:H[G].y});if(I!==0){const G=R[I-1].points,j=G[G.length-1];j&&F.push({x:(u=j.x1)!==null&&u!==void 0?u:j.x,y:(d=j.y1)!==null&&d!==void 0?d:j.y})}F.length>1&&(O=Md(P(F,w),E==="stepBefore"?"stepAfter":E==="stepAfter"?"stepBefore":E,{curveTension:_}),D.unshift(O))}n.cacheArea=D.map((I,H)=>({top:L[H],bottom:I}))}else{if(!M||!M.length)return n.cacheArea=null,void n.clearUpdateShapeTag();{const B=P(M,w),k=[];for(let D=B.length-1;D>=0;D--)k.push({x:(c=B[D].x1)!==null&&c!==void 0?c:B[D].x,y:(f=B[D].y1)!==null&&f!==void 0?f:B[D].y});const L=Md(B,E,{curveTension:_}),O=Md(k,E==="stepBefore"?"stepAfter":E==="stepAfter"?"stepBefore":E,{curveTension:_});n.cacheArea={top:L,bottom:O}}}n.clearUpdateShapeTag()}if(Array.isArray(n.cacheArea)){const B=n.attribute.segments.filter(k=>k.points.length);if(B[0].points.length===1&&B.shift(),A===1){let k=!1;n.cacheArea.forEach((L,O)=>{k||(k=this.drawSegmentItem(t,L,x,m,S,b,B[O],[g,n.attribute],A,e,i,y,n,r,s,a))})}else{const k=n.cacheArea.reduce((I,H)=>I+H.top.getLength(),0),L=A*k;let O=0,D=!1;n.cacheArea.forEach((I,H)=>{if(D)return;const F=I.top.getLength(),G=(L-O)/F;O+=F,G>0&&(D=this.drawSegmentItem(t,I,x,m,S,b,B[H],[g,n.attribute],er(G,1),e,i,y,n,r,s,a))})}}else this.drawSegmentItem(t,n.cacheArea,x,m,S,b,n.attribute,g,A,e,i,y,n,r,s,a)}draw(n,t,e,i){const r=te(n,i?.theme).area;this._draw(n,r,!1,e,i)}drawSegmentItem(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p){return this._drawSegmentItem(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p)}_drawSegmentItem(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p){if(!(t&&t.top&&t.bottom&&t.top.curves&&t.top.curves.length&&t.bottom.curves&&t.bottom.curves.length))return;n.beginPath();const{points:v,segments:m}=c.attribute;let y,b,_=ze.ROW;if(m){const A=m[m.length-1];b=m[0].points[0],y=A.points[A.points.length-1]}else b=v[0],y=v[v.length-1];const w=De(y.x-b.x),C=De(y.y-b.y);_=y.x1==null?ze.ROW:y.y1==null?ze.COLUMN:Number.isFinite(w+C)?w>C?ze.ROW:ze.COLUMN:ze.ROW,XRt(n,t,l,{offsetX:h,offsetY:u,offsetZ:d,direction:_}),this.beforeRenderStep(c,n,h,u,!!i,!1,e,!1,a,f,g,null,{attribute:s}),n.setShadowBlendStyle&&n.setShadowBlendStyle(c,s,a);const{x=0,x:S=0}=s;return e!==!1&&(g?g(n,s,a):i&&(n.setCommonStyle(c,s,x-h,S-u,a),n.fill())),this.afterRenderStep(c,n,h,u,!!i,!1,e,!1,a,f,g,null,{attribute:s}),(()=>{if(r!==!1)if(p)p(n,s,a);else{const{stroke:A=a&&a[1]&&a[1].stroke}=s;ke(A)&&(A[0]||A[2])&&A[1]===!1&&(n.beginPath(),ZK(n,A[0]?t.top:t.bottom,l,_===ze.ROW?"x":"y",{offsetX:h,offsetY:u,offsetZ:d})),n.setStrokeStyle(c,s,x-h,S-u,a),n.stroke()}})(),!1}};JP=qRt([yt(),wW(0,le(Wi)),wW(0,mn(XMt)),ZRt("design:paramtypes",[Object])],JP);const JRt=xp,QRt=pu;var t2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},e2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},xW=function(n,t){return function(e,i){t(e,i,n)}};let Qw=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=sA,this.builtinContributions=[QRt,JRt],this.init(n)}drawShape(n,t,e,i,r,o,s,a){var l,h,u;const d=(l=this.tempTheme)!==null&&l!==void 0?l:te(n,o?.theme).path,{x:c=d.x,y:f=d.y,fillStrokeOrder:g=d.fillStrokeOrder}=n.attribute,p=(h=this.z)!==null&&h!==void 0?h:0,v=this.valid(n,d,s,a);if(!v)return;const{fVisible:m,sVisible:y,doFill:b,doStroke:_}=v;if(t.beginPath(),n.pathShape)Xl(n.pathShape.commandList,t,e,i,1,1,p);else{const x=(u=n.attribute.path)!==null&&u!==void 0?u:d.path;Xl(x.commandList,t,e,i,1,1,p)}t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,d),this.beforeRenderStep(n,t,e,i,b,_,m,y,d,r,s,a);const w=()=>{_&&(a?a(t,n.attribute,d):y&&(t.setStrokeStyle(n,n.attribute,c-e,f-i,d),t.stroke()))},C=()=>{b&&(s?s(t,n.attribute,d):m&&(t.setCommonStyle(n,n.attribute,c-e,f-i,d),t.fill()))};g?(w(),C()):(C(),w()),this.afterRenderStep(n,t,e,i,b,_,m,y,d,r,s,a)}draw(n,t,e,i){const r=te(n,i?.theme).path;this.tempTheme=r,this._draw(n,r,!1,e,i),this.tempTheme=null}};Qw=t2t([yt(),xW(0,le(Wi)),xW(0,mn(VP)),e2t("design:paramtypes",[Object])],Qw);var i2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},n2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},SW=function(n,t){return function(e,i){t(e,i,n)}};let t1=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.type="rect",this.numberType=zO,this.builtinContributions=[MRt,BRt,RRt],this.init(n)}drawShape(n,t,e,i,r,o,s,a,l){l=l??te(n,o?.theme).rect;const{fill:h=l.fill,background:u,stroke:d=l.stroke,cornerRadius:c=l.cornerRadius,cornerType:f=l.cornerType,opacity:g=l.opacity,fillOpacity:p=l.fillOpacity,lineWidth:v=l.lineWidth,strokeOpacity:m=l.strokeOpacity,visible:y=l.visible,x1:b,y1:_,x:w=l.x,y:C=l.y,fillStrokeOrder:x=l.fillStrokeOrder,drawStrokeWhenZeroWH:S=l.drawStrokeWhenZeroWH}=n.attribute;let{width:A,height:T}=n.attribute;A=(A??b-w)||0,T=(T??_-C)||0;const M=VK(g,p,A,T,h),R=GK(g,m,A,T,S),E=Zg(h,u),P=Em(d,v);if(!n.valid||!y||!E&&!P||!(M||R||s||a||u))return;c===0||ke(c)&&c.every(k=>k===0)?(t.beginPath(),t.rect(e,i,A,T)):(t.beginPath(),qa(t,e,i,A,T,c,f!=="bevel"));const B={doFill:E,doStroke:P};t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,E,P,M,R,l,r,s,a,B),x?(this._runStroke(n,t,e,i,l,B,R,w,C,a),this._runFill(n,t,e,i,l,B,M,w,C,s)):(this._runFill(n,t,e,i,l,B,M,w,C,s),this._runStroke(n,t,e,i,l,B,R,w,C,a)),this.afterRenderStep(n,t,e,i,E,P,M,R,l,r,s,a)}_runFill(n,t,e,i,r,o,s,a,l,h){o.doFill&&(h?h(t,n.attribute,r):s&&(t.setCommonStyle(n,n.attribute,a-e,l-i,r),t.fill()))}_runStroke(n,t,e,i,r,o,s,a,l,h){o.doStroke&&(h?h(t,n.attribute,r):s&&(t.setStrokeStyle(n,n.attribute,a-e,l-i,r),t.stroke()))}draw(n,t,e,i){const r=te(n,i?.theme).rect;this._draw(n,r,!1,e,i,r)}};t1=i2t([yt(),SW(0,le(Wi)),SW(0,mn(Pd)),n2t("design:paramtypes",[Object])],t1);var r2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},o2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},AW=function(n,t){return function(e,i){t(e,i,n)}};let e1=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=lA,this.builtinContributions=[DRt,FRt,HRt,IRt],this.init(n)}drawShape(n,t,e,i,r,o,s,a,l){var h;l=l??te(n,o?.theme).symbol;const{size:u=l.size,x:d=l.x,y:c=l.y,scaleX:f=l.scaleX,scaleY:g=l.scaleY,fillStrokeOrder:p=l.fillStrokeOrder,clipRange:v=l.clipRange}=n.attribute,m=this.valid(n,l,s,a);if(!m)return;const{fVisible:y,sVisible:b,doFill:_,doStroke:w}=m,C=n.getParsedPath();if(!C)return;const{keepDirIn3d:x=l.keepDirIn3d}=n.attribute,S=(h=this.z)!==null&&h!==void 0?h:0;t.beginPath();let A=e,T=i,M=S;const R=t.camera;if(x&&R&&t.project){const E=t.project(e,i,S);t.camera=null,ke(u)?(u[0]*f,u[1]*g):u*f,A=E.x,T=E.y,M=void 0}C.draw(t,u,A,T,M,(E,P)=>{var B,k,L,O;if(n._parsedPath.svgCache){const H=Object.assign({},P);H.fill=(B=P.fill)!==null&&B!==void 0?B:n.attribute.fill,H.opacity=(k=P.opacity)!==null&&k!==void 0?k:n.attribute.opacity,H.fillOpacity=n.attribute.fillOpacity,H.stroke=(L=P.stroke)!==null&&L!==void 0?L:n.attribute.stroke,H.lineWidth=(O=P.lineWidth)!==null&&O!==void 0?O:n.attribute.lineWidth,P=H}const D=()=>{P.fill&&(s?s(t,n.attribute,l):(t.setCommonStyle(n,P,d-e,c-i,l),t.fill()))},I=()=>{P.stroke&&(a?a(t,n.attribute,l):b&&v>=1&&(t.setStrokeStyle(n,P,(d-e)/f,(c-i)/g,l),t.stroke()))};p?(I(),D()):(D(),I())})===!1&&t.closePath(),t.camera=R,t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,_,w,y,b,l,r,s,a),p?(this._runStroke(n,t,e,i,l,w,b,d,c,C,v,f,g,a),this._runFill(n,t,e,i,l,_,y,d,c,C,s)):(this._runFill(n,t,e,i,l,_,y,d,c,C,s),this._runStroke(n,t,e,i,l,w,b,d,c,C,v,f,g,a)),this.afterRenderStep(n,t,e,i,_,w,y,b,l,r,s,a)}_runFill(n,t,e,i,r,o,s,a,l,h,u){o&&!h.isSvg&&(u?u(t,n.attribute,r):s&&(t.setCommonStyle(n,n.attribute,a-e,l-i,r),t.fill()))}_runStroke(n,t,e,i,r,o,s,a,l,h,u,d,c,f){o&&!h.isSvg&&(f?f(t,n.attribute,r):s&&u>=1&&(t.setStrokeStyle(n,n.attribute,(a-e)/d,(l-i)/c,r),t.stroke()))}draw(n,t,e,i){const r=te(n,i?.theme).symbol;this._draw(n,r,!1,e,i)}};e1=r2t([yt(),AW(0,le(Wi)),AW(0,mn($P)),o2t("design:paramtypes",[Object])],e1);class s2t{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new Fn)}allocate(t,e,i,r){if(!this.pools.length)return new Fn().setValue(t,e,i,r);const o=this.pools.pop();return o.x1=t,o.y1=e,o.x2=i,o.y2=r,o}allocateByObj(t){if(!this.pools.length)return new Fn(t);const e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const i1=new s2t;class a2t extends cA{constructor(){super(...arguments),this.time=xe.beforeFillStroke}drawShape(t,e,i,r,o,s,a,l,h,u,d,c){var f,g,p,v,m,y,b,_,w,C;const{backgroundMode:x=h.backgroundMode,backgroundFit:S=h.backgroundFit,backgroundKeepAspectRatio:A=h.backgroundKeepAspectRatio}=t.attribute;let T,{background:M}=t.attribute;if(!M)return;const R=()=>{t.type==="richtext"&&(e.restore(),e.save(),T&&e.setTransformFromMatrix(T,!0,1))};let E;t.type==="richtext"&&(T=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());const P=gd(M)&&M.background,B=t.transMatrix.onlyTranslate();if(P){const k=t.AABBBounds,L=((f=M.x)!==null&&f!==void 0?f:k.x1)+((g=M.dx)!==null&&g!==void 0?g:0),O=((p=M.y)!==null&&p!==void 0?p:k.y1)+((v=M.dy)!==null&&v!==void 0?v:0),D=(m=M.width)!==null&&m!==void 0?m:k.width(),I=(y=M.height)!==null&&y!==void 0?y:k.height();if(E=i1.allocate(L,O,L+D,O+I),M=M.background,!B){const H=E.width(),F=E.height();E.set(((b=M.x)!==null&&b!==void 0?b:0)+((_=M.dx)!==null&&_!==void 0?_:0),((w=M.y)!==null&&w!==void 0?w:0)+((C=M.dy)!==null&&C!==void 0?C:0),H,F)}}else E=t.AABBBounds,B||(E=dA(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){const k=t.resources.get(M);if(k.state!=="success"||!k.data)return void R();e.highPerformanceSave(),B&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,i,r,h),this.doDrawImage(e,k.data,E,{backgroundMode:x,backgroundFit:S,backgroundKeepAspectRatio:A}),e.highPerformanceRestore(),e.setTransformForCurrent()}else{const{backgroundCornerRadius:k}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,i,r,h),e.fillStyle=M,k?(qa(e,E.x1,E.y1,E.width(),E.height(),k,!0),e.fill()):e.fillRect(E.x1,E.y1,E.width(),E.height()),e.highPerformanceRestore()}P&&i1.free(E),R()}}const JK=new a2t;var l2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},h2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},TW=function(n,t){return function(e,i){t(e,i,n)}};let QP=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=hA,this.builtinContributions=[JK],this.init(n)}drawShape(n,t,e,i,r,o,s,a){var l,h,u;const d=te(n,o?.theme).text,{text:c,underline:f=d.underline,lineThrough:g=d.lineThrough,keepDirIn3d:p=d.keepDirIn3d,direction:v=d.direction,fontSize:m=d.fontSize,verticalMode:y=d.verticalMode,x:b=d.x,y:_=d.y}=n.attribute,w=(l=Ty(n.attribute.lineHeight,m))!==null&&l!==void 0?l:m,C=this.valid(n,d,s,a);if(!C)return;const{fVisible:x,sVisible:S,doFill:A,doStroke:T}=C,M=!p,R=this.z||0;t.beginPath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,d),this.beforeRenderStep(n,t,e,i,A,T,x,S,d,r,s,a),M&&this.transformUseContext2d(n,d,R,t);const E=(P,B,k,L)=>{let O=e+B;const D=i+k;if(L){t.highPerformanceSave(),O+=m;const I=Hn.allocate(1,0,0,1,0,0);I.rotateByCenter(Math.PI/2,O,D),t.transformFromMatrix(I,!0),Hn.free(I)}T&&(a?a(t,n.attribute,d):S&&(t.setStrokeStyle(n,n.attribute,b-e,_-i,d),t.strokeText(P,O,D,R))),A&&(s?s(t,n.attribute,d):x&&(t.setCommonStyle(n,n.attribute,b-e,_-i,d),t.fillText(P,O,D,R))),L&&(t.highPerformanceRestore(),t.setTransformForCurrent())};if(t.setTextStyleWithoutAlignBaseline(n.attribute,d,R),v==="horizontal"){const{multilineLayout:P}=n;if(!P)return void t.highPerformanceRestore();const{xOffset:B,yOffset:k}=P.bbox;T&&(a?a(t,n.attribute,d):S&&(t.setStrokeStyle(n,n.attribute,b-e,_-i,d),P.lines.forEach(L=>{t.strokeText(L.str,(L.leftOffset||0)+B+e,(L.topOffset||0)+k+i,R)}))),A&&(s?s(t,n.attribute,d):x&&(t.setCommonStyle(n,n.attribute,b-e,_-i,d),P.lines.forEach(L=>{t.fillText(L.str,(L.leftOffset||0)+B+e,(L.topOffset||0)+k+i,R),this.drawUnderLine(f,g,n,(L.leftOffset||0)+B+e,(L.topOffset||0)+k+i,L.descent,(L.descent-L.ascent)/2,R,d,t,{width:L.width})})))}else{let{textAlign:P=d.textAlign,textBaseline:B=d.textBaseline}=n.attribute;if(!y){const F=P;P=(h=n.getBaselineMapAlign()[B])!==null&&h!==void 0?h:"left",B=(u=n.getAlignMapBaseline()[F])!==null&&u!==void 0?u:"top"}n.tryUpdateAABBBounds();const k=n.cache,{verticalList:L}=k;t.textAlign="left",t.textBaseline="top";const O=w*L.length;let D=0;L.forEach(F=>{const G=F.reduce((j,W)=>j+(W.width||0),0);D=Il(G,D)});let I=0,H=0;B==="bottom"?H=-O:B==="middle"&&(H=-O/2),P==="center"?I-=D/2:P==="right"&&(I-=D),L.forEach((F,G)=>{const j=F.reduce((J,q)=>J+(q.width||0),0),W=D-j;let K=I;P==="center"?K+=W/2:P==="right"&&(K+=W),F.forEach(J=>{const{text:q,width:X,direction:it}=J;E(q,O-(G+1)*w+H,K,it),K+=X})})}M&&this.restoreTransformUseContext2d(n,d,R,t),this.afterRenderStep(n,t,e,i,A,T,x,S,d,r,s,a)}draw(n,t,e,i){const r=te(n,i?.theme).text,{keepDirIn3d:o=r.keepDirIn3d}=n.attribute,s=!o;this._draw(n,r,s,e,i)}drawUnderLine(n,t,e,i,r,o,s,a,l,h,u){if(t+n<=0)return;const{textAlign:d=l.textAlign,fill:c=l.fill,opacity:f=l.opacity,underlineOffset:g=l.underlineOffset,underlineDash:p=l.underlineDash,fillOpacity:v=l.fillOpacity}=e.attribute,m=!gi(u),y=m?u.width:e.clipedWidth,b=m?0:Jg(d,y),_={lineWidth:0,stroke:c,opacity:f,strokeOpacity:v};if(n){_.lineWidth=n,h.setStrokeStyle(e,_,i,r,l),p&&h.setLineDash(p),h.beginPath();const w=r+o+g;h.moveTo(i+b,w,a),h.lineTo(i+b+y,w,a),h.stroke()}if(t){_.lineWidth=t,h.setStrokeStyle(e,_,i,r,l),h.beginPath();const w=r+s;h.moveTo(i+b,w,a),h.lineTo(i+b+y,w,a),h.stroke()}}};QP=l2t([yt(),TW(0,le(Wi)),TW(0,mn(Yw)),h2t("design:paramtypes",[Object])],QP);function QK(n,t,e,i){if(t&&t.length){n.moveTo(t[0].x+e,t[0].y+i);for(let r=1;r<t.length;r++)n.lineTo(t[r].x+e,t[r].y+i)}}function u2t(n,t,e,i,r,o=!0){var s;if(t.length<3)return void QK(n,t,e,i);let a=0,l=t.length-1;o||(a+=1,l-=1,n.moveTo(t[0].x+e,t[0].y+i));for(let h=a;h<=l;h++){const u=t[h===0?l:(h-1)%t.length],d=t[h%t.length],c=t[(h+1)%t.length],f=d.x-u.x,g=d.y-u.y,p=d.x-c.x,v=d.y-c.y,m=(Math.atan2(g,f)-Math.atan2(v,p))/2,y=Math.abs(Math.tan(m));let b=Array.isArray(r)?(s=r[h%t.length])!==null&&s!==void 0?s:0:r,_=b/y;const w=f_(f,g),C=f_(p,v),x=Math.min(w,C);_>x&&(_=x,b=x*y);const S=OR(d,_,w,f,g),A=OR(d,_,C,p,v),T=2*d.x-S.x-A.x,M=2*d.y-S.y-A.y,R=f_(T,M),E=OR(d,f_(_,b),R,T,M);let P=Math.atan2(S.y-E.y,S.x-E.x);const B=Math.atan2(A.y-E.y,A.x-E.x);let k=B-P;k<0&&(P=B,k=-k),k>Math.PI&&(k-=Math.PI),h===0?n.moveTo(S.x+e,S.y+i):n.lineTo(S.x+e,S.y+i),k&&n.arcTo(d.x+e,d.y+i,A.x+e,A.y+i,b),n.lineTo(A.x+e,A.y+i)}o||n.lineTo(t[l+1].x+e,t[l+1].y+i)}function f_(n,t){return Math.sqrt(n*n+t*t)}function OR(n,t,e,i,r){const o=t/e;return{x:n.x-i*o,y:n.y-r*o}}const d2t=xp,c2t=pu;var f2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},g2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},MW=function(n,t){return function(e,i){t(e,i,n)}};let tk=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=aA,this.builtinContributions=[c2t,d2t],this.init(n)}drawShape(n,t,e,i,r,o,s,a){const l=te(n,o?.theme).polygon,{points:h=l.points,cornerRadius:u=l.cornerRadius,x:d=l.x,y:c=l.y,closePath:f=l.closePath,fillStrokeOrder:g=l.fillStrokeOrder}=n.attribute,p=this.valid(n,l,s,a);if(!p)return;const{fVisible:v,sVisible:m,doFill:y,doStroke:b}=p;t.beginPath(),u<=0||ke(u)&&u.every(C=>C===0)?QK(t.camera?t:t.nativeContext,h,e,i):u2t(t.camera?t:t.nativeContext,h,e,i,u,f),f&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this.beforeRenderStep(n,t,e,i,y,b,v,m,l,r,s,a);const _=()=>{y&&(s?s(t,n.attribute,l):v&&(t.setCommonStyle(n,n.attribute,d-e,c-i,l),t.fill()))},w=()=>{b&&(a?a(t,n.attribute,l):m&&(t.setStrokeStyle(n,n.attribute,d-e,c-i,l),t.stroke()))};g?(w(),_()):(_(),w()),this.afterRenderStep(n,t,e,i,y,b,v,m,l,r,s,a)}draw(n,t,e,i){const r=te(n,i?.theme).polygon;this._draw(n,r,!1,e,i)}};tk=f2t([yt(),MW(0,le(Wi)),MW(0,mn(GP)),g2t("design:paramtypes",[Object])],tk);var p2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},v2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},RW=function(n,t){return function(e,i){t(e,i,n)}};let ek=class{constructor(n){this.groupRenderContribitions=n,this.numberType=FO}reInit(){this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(yW)}drawShape(n,t,e,i,r,o,s,a,l){const{clip:h,fill:u,stroke:d,background:c}=n.attribute;if(!(h||u||d||c))return;l=l??te(n,o?.theme).group;const{opacity:f=l.opacity,width:g=l.width,height:p=l.height,fillOpacity:v=l.fillOpacity,strokeOpacity:m=l.strokeOpacity,cornerRadius:y=l.cornerRadius,path:b=l.path,lineWidth:_=l.lineWidth,visible:w=l.visible,fillStrokeOrder:C=l.fillStrokeOrder,cornerType:x=l.cornerType,x:S=l.x,y:A=l.y}=n.attribute,T=VK(f,v,g,p,u),M=GK(f,m,g,p),R=Zg(u,c),E=Em(d,_);if(!n.valid||!w||!h&&(!R&&!E||!(T||M||s||a||c)))return;if(b&&b.length&&r.drawContribution){const L=t.disableFill,O=t.disableStroke,D=t.disableBeginPath;t.disableFill=!0,t.disableStroke=!0,t.disableBeginPath=!0,b.forEach(I=>{r.drawContribution.getRenderContribution(I).draw(I,r.renderService,r,o)}),t.disableFill=L,t.disableStroke=O,t.disableBeginPath=D}else y===0||ke(y)&&y.every(L=>L===0)?(t.beginPath(),t.rect(e,i,g,p)):(t.beginPath(),qa(t,e,i,g,p,y,x!=="bevel"));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(yW));const P={doFill:R,doStroke:E};t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l),this._groupRenderContribitions.forEach(L=>{L.time===xe.beforeFillStroke&&L.drawShape(n,t,e,i,R,E,T,M,l,r,s,a,P)}),h&&t.clip();const B=()=>{P.doFill&&(s?s(t,n.attribute,l):T&&(t.setCommonStyle(n,n.attribute,S-e,A-i,l),t.fill()))},k=()=>{P.doStroke&&(a?a(t,n.attribute,l):M&&(t.setStrokeStyle(n,n.attribute,S-e,A-i,l),t.stroke()))};C?(k(),B()):(B(),k()),this._groupRenderContribitions.forEach(L=>{L.time===xe.afterFillStroke&&L.drawShape(n,t,e,i,R,E,T,M,l,r,s,a)})}draw(n,t,e,i){var r,o;const{context:s}=e;if(!s)return;const{clip:a,baseOpacity:l=1,drawMode:h}=n.attribute,u=s.nativeContext,d=s.canvas.nativeCanvas;if(h>0){const{x:m,y,width:b,height:_}=n.attribute,w=s.canvas,C=bt.global.createCanvas({width:w.width,height:w.height,dpr:1}),x=C.getContext("2d"),S=s.nativeContext.getTransform();x.setTransform(S.a,S.b,S.c,S.d,S.e,S.f),h===1&&(x.save(),x.clearRect(0,0,w.width,w.height),x.beginPath(),x.rect(m,y,b,_),x.clip(),x.drawImage(w.nativeCanvas,0,0,w.width,w.height,0,0,w.displayWidth,w.displayHeight),x.restore()),s.nativeContext=x,w.nativeCanvas=C}a?s.save():s.highPerformanceSave();const c=s.baseGlobalAlpha;s.baseGlobalAlpha*=l;const f=s.modelMatrix;if(s.camera){const m=te(n,i?.theme).group,y=fn.allocate(),b=fn.allocate();jK(b,n,m),Ry(y,f||y,b),s.modelMatrix=y,fn.free(b),s.setTransform(1,0,0,1,0,0,!0)}else s.transformFromMatrix(n.transMatrix,!0);s.beginPath(),i.skipDraw?this.drawShape(n,s,0,0,e,i,()=>!1,()=>!1):this.drawShape(n,s,0,0,e,null,null,null);const{scrollX:g,scrollY:p}=n.attribute;let v;if((g||p)&&s.translate(g,p),i&&i.renderInGroup&&(v=i.renderInGroup((r=i.renderInGroupParams)===null||r===void 0?void 0:r.skipSort,n,e,(o=i.renderInGroupParams)===null||o===void 0?void 0:o.nextM)),s.modelMatrix!==f&&fn.free(s.modelMatrix),s.modelMatrix=f,s.baseGlobalAlpha=c,h>0){const{x:m,y,width:b,height:_}=n.attribute,w=s.nativeContext,C=s.canvas.nativeCanvas;u.save(),u.setTransform(s.dpr,0,0,s.dpr,0,0,!0),h===1&&w.rect(m,y,b,_),u.drawImage(C,0,0,C.width,C.height,0,0,s.canvas.displayWidth,s.canvas.displayHeight);const x=w.getTransform();u.setTransform(x.a,x.b,x.c,x.d,x.e,x.f),s.nativeContext=u,s.canvas.nativeCanvas=d,u.restore()}v&&v.then?v.then(()=>{a?s.restore():s.highPerformanceRestore()}):a?s.restore():s.highPerformanceRestore()}};ek=p2t([yt(),RW(0,le(Wi)),RW(0,mn(No)),v2t("design:paramtypes",[Object])],ek);var m2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},y2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},BW=function(n,t){return function(e,i){t(e,i,n)}};const b2t=["","repeat-x","repeat-y","repeat"];let ik=class extends to{constructor(n){super(),this.graphicRenderContributions=n,this.numberType=oA,this.builtinContributions=[kRt,ERt],this.init(n)}drawShape(n,t,e,i,r,o,s,a){const l=te(n).image,{repeatX:h=l.repeatX,repeatY:u=l.repeatY,x:d=l.x,y:c=l.y,cornerRadius:f=l.cornerRadius,fillStrokeOrder:g=l.fillStrokeOrder,cornerType:p=l.cornerType,image:v}=n.attribute,m=this.valid(n,l,s);if(!m)return;const{fVisible:y,sVisible:b,doFill:_,doStroke:w}=m;if(!v||!n.resources)return;const C=n.resources.get(v);if(C.state!=="success")return;const x=n.width,S=n.height;t.beginPath();let A=!1;f===0||ke(f)&&f.every(R=>R===0)?t.rect(e,i,x,S):(qa(t,e,i,x,S,f,p!=="bevel"),A=!0),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,l);const T=()=>{if(_){if(s)s(t,n.attribute,l);else if(y){t.setCommonStyle(n,n.attribute,e,i,l);let R=0;if(h==="repeat"&&(R|=1),u==="repeat"&&(R|=2),R){const E=t.createPattern(C.data,b2t[R]);t.fillStyle=E,t.translate(e,i,!0),t.fillRect(0,0,x,S),t.translate(-e,-i,!0)}else t.drawImage(C.data,e,i,x,S)}}},M=()=>{w&&(a?a(t,n.attribute,l):b&&(t.setStrokeStyle(n,n.attribute,d-e,c-i,l),t.stroke()))};g?(M(),A&&(t.save(),t.clip()),this.beforeRenderStep(n,t,e,i,_,!1,y,!1,l,r,s),T(),A&&t.restore()):(A&&(t.save(),t.clip()),this.beforeRenderStep(n,t,e,i,_,!1,y,!1,l,r,s),T(),A&&t.restore(),M()),this.afterRenderStep(n,t,e,i,_,!1,y,!1,l,r,s)}draw(n,t,e){const{image:i}=n.attribute;if(!i||!n.resources)return;const r=n.resources.get(i);if(r.state==="loading"&&Ha(i))return void Xe.improveImageLoading(i);if(r.state!=="success")return;const{context:o}=t.drawParams;if(!o)return;const s=te(n).image;this._draw(n,s,!1,e)}};ik=m2t([yt(),BW(0,le(Wi)),BW(0,mn(Bd)),y2t("design:paramtypes",[Object])],ik);const tq=Symbol.for("IncrementalDrawContribution"),n1=Symbol.for("ArcRender"),r1=Symbol.for("CircleRender"),kr=Symbol.for("GraphicRender"),PW=Symbol.for("GroupRender"),o1=Symbol.for("LineRender"),s1=Symbol.for("PathRender"),a1=Symbol.for("PolygonRender"),l1=Symbol.for("RectRender"),h1=Symbol.for("SymbolRender"),nk=Symbol.for("TextRender"),rk=Symbol.for("RichTextRender"),ok=Symbol.for("ImageRender"),qO=Symbol.for("DrawContribution"),eq=(n,t,e,i)=>{let r,o=!1,s=!1;if(t.forEachChildren(a=>(o=a.numberType===CMt,!o)),t.forEachChildren(a=>(s=!!a.findFace,!s)),o){const a=t.getChildren(),l=[...a];l.sort((h,u)=>{var d,c,f,g;let p=((c=(d=h.attribute.startAngle)!==null&&d!==void 0?d:0+h.attribute.endAngle)!==null&&c!==void 0?c:0)/2,v=((g=(f=u.attribute.startAngle)!==null&&f!==void 0?f:0+u.attribute.endAngle)!==null&&g!==void 0?g:0)/2;for(;p<0;)p+=Zt;for(;v<0;)v+=Zt;return v-p}),l.forEach(h=>{h._next=null,h._prev=null}),t.removeAllChild(),t.update(),l.forEach(h=>{t.appendChild(h)}),i.hack_pieFace="outside",r=e(o,s),r&&r.graphic||(i.hack_pieFace="inside",r=e(o,s)),r&&r.graphic||(i.hack_pieFace="top",r=e(o,s)),t.removeAllChild(),a.forEach(h=>{h._next=null,h._prev=null}),a.forEach(h=>{t.appendChild(h)})}else if(s){const a=t.getChildren(),l=a.map(h=>({ave_z:h.findFace().vertices.map(u=>{var d;return n.view(u[0],u[1],(d=u[2]+h.attribute.z)!==null&&d!==void 0?d:0)[2]}).reduce((u,d)=>u+d,0),g:h}));l.sort((h,u)=>u.ave_z-h.ave_z),t.removeAllChild(),l.forEach(h=>{h.g._next=null,h.g._prev=null}),t.update(),l.forEach(h=>{t.add(h.g)}),r=e(o,s),t.removeAllChild(),a.forEach(h=>{h._next=null,h._prev=null}),t.update(),a.forEach(h=>{t.add(h)})}else r=e(o,s);return r};var _2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},C2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const Hm=Symbol.for("DrawItemInterceptor"),kW=new Fn,EW=new Fn;class w2t{constructor(){this.order=1}afterDrawItem(t,e,i,r,o){return t.attribute.shadowRootIdx==null&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,i,r,o),!1}beforeDrawItem(t,e,i,r,o){return t.attribute.shadowRootIdx==null&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,i,r,o),!1}drawItem(t,e,i,r,o){if(!t.shadowRoot)return!1;const{context:s}=i;if(s.highPerformanceSave(),s.transformFromMatrix(t.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds){kW.copy(r.dirtyBounds),EW.copy(r.backupDirtyBounds);const a=t.globalTransMatrix.getInverse();r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(a),r.backupDirtyBounds.copy(r.dirtyBounds)}return r.renderGroup(t.shadowRoot,i,Hn.allocate(1,0,0,1,0,0)),s.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(kW),r.backupDirtyBounds.copy(EW)),!0}}class x2t{constructor(){this.order=1}afterDrawItem(t,e,i,r,o){return t.attribute._debug_bounds&&this.drawItem(t,e,i,r,o),!1}drawItem(t,e,i,r,o){if(!t.attribute._debug_bounds)return!1;const{context:s}=i;s.highPerformanceSave(),t.parent&&s.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&s.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);const a=t.AABBBounds;return t.attribute._debug_bounds!==!0&&t.attribute._debug_bounds(s,t),s.strokeRect(a.x1,a.y1,a.width(),a.height()),s.highPerformanceRestore(),!0}}let u1=class{constructor(){this.order=1,this.interceptors=[new w2t,new A2t,new S2t,new x2t]}afterDrawItem(n,t,e,i,r){if((!n.in3dMode||e.in3dInterceptor)&&!n.shadowRoot&&!n.attribute._debug_bounds&&!(n.baseGraphic||n.attribute.globalZIndex||n.interactiveGraphic))return!1;for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].afterDrawItem&&this.interceptors[o].afterDrawItem(n,t,e,i,r))return!0;return!1}beforeDrawItem(n,t,e,i,r){if((!n.in3dMode||e.in3dInterceptor)&&!n.shadowRoot&&!n.attribute._debug_bounds&&!(n.baseGraphic||n.attribute.globalZIndex||n.interactiveGraphic))return!1;for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].beforeDrawItem&&this.interceptors[o].beforeDrawItem(n,t,e,i,r))return!0;return!1}};u1=_2t([yt(),C2t("design:paramtypes",[])],u1);class S2t{constructor(){this.order=1}beforeDrawItem(t,e,i,r,o){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,i,r,o):this.beforeSetInteractive(t,e,i,r,o))}beforeSetInteractive(t,e,i,r,o){let s=t.interactiveGraphic;if(t.attribute.globalZIndex){s||(s=t.clone(),t.interactiveGraphic=s,s.baseGraphic=t),s.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer();const a=i.stage.getLayer("_builtin_interactive");return a&&this.getShadowRoot(a).add(s),!0}if(s){i.stage.tryInitInteractiveLayer();const a=i.stage.getLayer("_builtin_interactive");a&&this.getShadowRoot(a).removeChild(s),t.interactiveGraphic=null,s.baseGraphic=null}return!1}beforeDrawInteractive(t,e,i,r,o){const s=t.baseGraphic;let a=!!s.stage,l=s.parent;for(;a&&l&&l.stage!==l;)a=!!l.stage,l=l.parent;if(!a){const h=i.stage.getLayer("_builtin_interactive");return h&&this.getShadowRoot(h).removeChild(t),!0}if(s){this.processing=!0;const{context:h}=i;return h.highPerformanceSave(),h.setTransformFromMatrix(s.parent.globalTransMatrix,!0),s.isContainer?r.renderGroup(s,i,s.parent.globalTransMatrix):r.renderItem(s,i),h.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let i=t.getElementById("_interactive_group");return i||(i=kt.CreateGraphic("group",{}),i.id="_interactive_group",t.add(i)),(e=i.shadowRoot)!==null&&e!==void 0?e:i.attachShadow()}}class A2t{constructor(){this.order=1}beforeDrawItem(t,e,i,r,o){if(!t.in3dMode||i.in3dInterceptor)return!1;i.in3dInterceptor=!0;const{context:s,stage:a}=e.drawParams;s.canvas,s.save(),this.initCanvasCtx(s),s.camera=a.camera;const l=s.currentMatrix;l.a/=s.dpr,l.b/=s.dpr,l.c/=s.dpr,l.d/=s.dpr,l.e/=s.dpr,l.f/=s.dpr;const h=fn.allocate();DP(h,l);const u=s.modelMatrix;if(u){if(h){const d=fn.allocate();s.modelMatrix=Ry(d,u,h)}}else s.modelMatrix=h;return s.setTransform(1,0,0,1,0,0,!0),t.isContainer?eq(s,t,(d,c)=>r.renderGroup(t,i,t.parent.globalTransMatrix,!d&&c),i):r.renderItem(t,i),s.camera=null,s.restore(),s.modelMatrix!==u&&fn.free(s.modelMatrix),s.modelMatrix=u,i.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}var T2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},M2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},R2t=function(n,t){return function(e,i){t(e,i,n)}};let sk=class{constructor(n){this.drawContribution=n}prepare(n){n&&this.renderTreeRoots.forEach(t=>{this._prepare(t,n)})}_prepare(n,t){n.forEachChildren(e=>{this._prepare(e,t)}),n.update({bounds:t,trans:!0})}prepareRenderList(){}beforeDraw(n){}draw(n){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(n){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}reInit(){this.drawContribution.reInit()}render(n,t){this.renderTreeRoots=n,this.drawParams=t;const e=t.updateBounds;this.prepare(e),this.prepareRenderList(),this.beforeDraw(t),this.draw(t),this.afterDraw(t),this.drawParams=null}};sk=T2t([yt(),R2t(0,le(qO)),M2t("design:paramtypes",[Object])],sk);const B2t=new Ut(n=>{n(BO).to(sk)}),Qf=Symbol.for("PickerService"),LW=Symbol.for("GlobalPickerService"),Pf=Symbol.for("PickItemInterceptor"),d1=Symbol.for("PickServiceInterceptor");var fA=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let c1=class{constructor(){this.order=1}afterPickItem(n,t,e,i,r){if(n.graphic){let o=n.graphic;for(;o.parent;)o=o.parent;o.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=o.shadowHost)}return n}};c1=fA([yt()],c1);let f1=class{constructor(){this.order=1}afterPickItem(n,t,e,i,r){return n.attribute.shadowRootIdx>0||!n.attribute.shadowRootIdx?this._pickItem(n,t,e,i,r):null}beforePickItem(n,t,e,i,r){return n.attribute.shadowRootIdx<0?this._pickItem(n,t,e,i,r):null}_pickItem(n,t,e,i,r){var o;if(!n.shadowRoot)return null;const{parentMatrix:s}=r||{};if(!s)return null;const a=t.pickContext;a.highPerformanceSave();const l=(o=te(n))===null||o===void 0?void 0:o[n.type],{shadowPickMode:h=l?.shadowPickMode}=n.attribute,u=n.shadowRoot,d=Hn.allocateByObj(s),c=new Je(d.a*e.x+d.c*e.y+d.e,d.b*e.x+d.d*e.y+d.f),f=t.pickGroup(u,c,d,i);return a.highPerformanceRestore(),!f.graphic&&f.group&&h==="full"&&(f.graphic=f.group),f}};f1=fA([yt()],f1);let g1=class{constructor(){this.order=1}beforePickItem(n,t,e,i,r){const o=n.baseGraphic;if(o&&o.parent){const s=new Je(e.x,e.y),a=t.pickContext;a.highPerformanceSave();const l=o.parent.globalTransMatrix;l.transformPoint(s,s);const h=o.isContainer?t.pickGroup(o,s.clone(),l,i):t.pickItem(o,s.clone(),l,i);return a.highPerformanceRestore(),h}return null}};g1=fA([yt()],g1);let p1=class{constructor(){this.order=1}beforePickItem(n,t,e,i,r){if(!n.in3dMode||i.in3dInterceptor)return null;const o=t.pickContext,s=n.stage;if(!o||!s)return null;if(i.in3dInterceptor=!0,o.save(),this.initCanvasCtx(o),o.camera=s.camera,n.isContainer){const a=eq(o,n,()=>t.pickGroup(n,e,r.parentMatrix,i),i);return o.camera=null,i.in3dInterceptor=!1,o.restore(),a}return o.restore(),null}initCanvasCtx(n){n.setTransformForCurrent()}};p1=fA([yt()],p1);const P2t=new Ut((n,t,e)=>{e(Qf)||(n(LW).toSelf(),n(Qf).toService(LW)),n(p1).toSelf().inSingletonScope(),n(Pf).toService(p1),n(f1).toSelf().inSingletonScope(),n(Pf).toService(f1),n(g1).toSelf().inSingletonScope(),n(Pf).toService(g1),tr(n,Pf),n(c1).toSelf().inSingletonScope(),n(d1).toService(c1),tr(n,d1)}),k2t=new Ut(n=>{n(WO).to(jP),n(IK).toConstantValue(kt)}),Fm=Symbol.for("AutoEnablePlugins"),iq=Symbol.for("PluginService");var E2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},L2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},OW=function(n,t){return function(e,i){t(e,i,n)}};let ak=class{constructor(n){this.autoEnablePlugins=n,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(n,t){this.stage=n,this.actived=!0;const{pluginList:e}=t;e&&Nt.isBound(Fm)&&this.autoEnablePlugins.getContributions().forEach(i=>{e.includes(i.name)&&this.register(i)})}findPluginsByName(n){const t=[];return this.onStartupFinishedPlugin.forEach(e=>{e.name===n&&t.push(e)}),this.onRegisterPlugin.forEach(e=>{e.name===n&&t.push(e)}),t}register(n){n.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.push(n):n.activeEvent==="onRegister"&&(this.onRegisterPlugin.push(n),n.activate(this))}unRegister(n){n.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(n),1):n.activeEvent==="onRegister"&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(n),1),n.deactivate(this)}release(...n){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};ak=E2t([yt(),OW(0,le(Wi)),OW(0,mn(Fm)),L2t("design:paramtypes",[Object])],ak);const O2t=new Ut(n=>{n(iq).to(ak),Jxt(n,Fm)}),D2t=new Ut(n=>{tr(n,QS)}),I2t=new Ut(n=>{n(Hl).to(qg).inSingletonScope(),tr(n,Hl)});var H2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},F2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let v1=class{constructor(){this.type="static",this.offscreen=!1,this.global=bt.global}setDpr(n){this.canvas.dpr=n}init(n,t,e){if(this.layer=n,this.window=t,e.main)this.main=!0,this.context=t.getContext(),this.canvas=this.context.getCanvas();else{let i;this.main=!1,e.canvasId&&(i=this.global.getElementById(e.canvasId)),i||(i=this.global.createCanvas({width:t.width,height:t.height})),i.style&&(i.style["pointer-events"]="none");const r=t.getContext().getCanvas().nativeCanvas,o=RP({nativeCanvas:i,width:t.width,height:t.height,dpr:t.dpr,id:e.canvasId,canvasControled:!0,container:t.getContainer(),x:r.offsetLeft,y:r.offsetTop});o.applyPosition(),this.canvas=o,this.context=o.getContext()}}resize(n,t){this.canvas.resize(n,t)}resizeView(n,t){}render(n,t,e){var i;if(!this.main){const r=this.window.getContext().getCanvas().nativeCanvas;!r||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition())}t.renderService.render(n,Object.assign(Object.assign({context:this.context,clear:(i=t.background)!==null&&i!==void 0?i:"#ffffff"},t),e))}merge(n){n.forEach(t=>{const e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(n,t){}drawTo(n,t,e){var i;const r=n.getContext();e.renderService.render(t,Object.assign(Object.assign({context:r},e),{clear:e.clear?(i=e.background)!==null&&i!==void 0?i:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};v1=H2t([yt(),F2t("design:paramtypes",[])],v1);const z2t=new Ut(n=>{n(v1).toSelf(),n(WK).toService(v1)});function N2t(n){n.load(D2t),n.load(I2t),n.load(z2t)}var W2t=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function nq(n,t,e){const i={},r=[];return n.forEachChildren(o=>{const{zIndex:s=t}=o.attribute;i[s]?i[s].push(o):(i[s]=[o],r.push(s))},e),r.sort((o,s)=>e?s-o:o-s),{childMap:i,zIdxArray:r}}function rq(n,t,e,i=!1,r=!1){let o=!1;if(r)o=!0;else{let s;n.forEachChildren((a,l)=>{const{zIndex:h=t}=a.attribute;if(l===0)s=h;else if(s!==h)return o=!0,!0;return!1},i)}if(o){const{childMap:s,zIdxArray:a}=nq(n,t,i);let l=!1;for(let h=0;h<a.length&&!l;h++){const u=s[a[h]];r&&u.sort((d,c)=>{var f,g;return(i?-1:1)*(((f=c.attribute.z)!==null&&f!==void 0?f:0)-((g=d.attribute.z)!==null&&g!==void 0?g:0))});for(let d=0;d<u.length;d++)if(e(u[d],d)){l=!0;break}}}else n.forEachChildren(e,i)}function DW(n,t,e,i=!1){return W2t(this,void 0,void 0,function*(){yield n.forEachChildrenAsync(e,i)})}function V2t(n,t,e,i=!1){let r=!1;n.forEachChildren((a,l)=>{const{zIndex:h=e}=a.attribute;if(l!==0){if(h!==void 0)return r=!0,!0}return!1},i);let o=null,s=!1;if(r){const{childMap:a,zIdxArray:l}=nq(n,e,i);let h=!1;for(let u=0;u<l.length&&!h;u++){const d=a[l[u]];for(let c=0;c<d.length;c++){if(s){h=!0,o=d[c];break}d[c]._uid!==t||(s=!0)}}}else n.forEachChildren(a=>s?(o=a,!0):(a._uid===t&&(s=!0),!1),i);return o}var G2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},$2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},DR=function(n,t){return function(e,i){t(e,i,n)}};let m1=class{constructor(n,t){this.contributions=n,this.drawItemInterceptorContributions=t,this._renderInGroup=(e,i,r,o)=>{var s;e?i.forEachChildren(a=>{r.break||(a.isContainer?this.renderGroup(a,r,o):this.renderItem(a,r))}):rq(i,Li.zIndex,a=>{r.break||(a.isContainer?this.renderGroup(a,r,o):this.renderItem(a,r))},!1,!!(!((s=r.context)===null||s===void 0)&&s.camera))},this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new Am,this.backupDirtyBounds=new Am,this.global=bt.global,this.layerService=bt.layerService,ke(this.contributions)||(this.contributions=[this.contributions]),this.init()}reInit(){this.init(),this.contributions.forEach(n=>{n.reInit()})}init(){this.contributions.forEach(n=>{if(n.style){const t=this.styleRenderMap.get(n.style)||new Map;t.set(n.numberType,n),this.styleRenderMap.set(n.style,t)}else this.defaultRenderMap.set(n.numberType,n)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((n,t)=>n.order-t.order)}prepareForDraw(n,t){t.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!t.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(n,t){var e;this.prepareForDraw(n,t),t.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(t.renderStyle)||this.defaultRenderMap,this.currentRenderService=n;const{context:i,stage:r,viewBox:o,transMatrix:s}=t;if(!i)return;const a=this.dirtyBounds.setValue(0,0,o.width(),o.height());if(r.dirtyBounds&&!r.dirtyBounds.empty()){const h=bSt(a,r.dirtyBounds);a.x1=Math.floor(h.x1),a.y1=Math.floor(h.y1),a.x2=Math.ceil(h.x2),a.y2=Math.ceil(h.y2)}const l=i.dpr%1;(l||l!==.5)&&(a.x1=Math.floor(a.x1*i.dpr)/i.dpr,a.y1=Math.floor(a.y1*i.dpr)/i.dpr,a.x2=Math.ceil(a.x2*i.dpr)/i.dpr,a.y2=Math.ceil(a.y2*i.dpr)/i.dpr),this.backupDirtyBounds.copy(a),i.reset(!1),i.save(),i.setClearMatrix(s.a,s.b,s.c,s.d,s.e,s.f),i.clearMatrix(!1),i.translate(o.x1,o.y1,!0),i.beginPath(),i.rect(a.x1,a.y1,a.width(),a.height()),i.clip(),r.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(n,i,t),!((e=n.drawParams)===null||e===void 0)&&e.stage&&n.drawParams.stage.hooks.afterClearScreen.call(n.drawParams),n.renderTreeRoots.sort((h,u)=>{var d,c;return((d=h.attribute.zIndex)!==null&&d!==void 0?d:Li.zIndex)-((c=u.attribute.zIndex)!==null&&c!==void 0?c:Li.zIndex)}).forEach(h=>{h.isContainer?this.renderGroup(h,t,Hn.allocate(1,0,0,1,0,0)):this.renderItem(h,t)}),i.restore(),i.draw()}doRegister(){throw new Error("")}_findNextGraphic(n){let t=n.parent,e=n._uid;for(;t;){const i=V2t(t,e,Li.zIndex);if(i)return i;e=t._uid,t=t.parent}return null}renderGroup(n,t,e,i){if(t.break||n.attribute.visibleAll===!1)return;if(n.incremental&&(t.startAtId==null||t.startAtId===n._uid))return t.break=!0,void this._increaseRender(n,t);if(this.useDirtyBounds&&!s5(n.AABBBounds,this.dirtyBounds)&&n.attribute.boundsMode!=="empty")return;let r,o=e;if(this.useDirtyBounds){r=i1.allocateByObj(this.dirtyBounds);const s=n.transMatrix;o=Hn.allocateByObj(e).multiply(s.a,s.b,s.c,s.d,s.e,s.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(o.getInverse())}t.isGroupScroll=!(!n.attribute.scrollX&&!n.attribute.scrollY),this.renderItem(n,t,{renderInGroupParams:{skipSort:i,nextM:o},renderInGroup:this._renderInGroup}),this.useDirtyBounds&&(this.dirtyBounds.copy(r),i1.free(r),Hn.free(o))}_increaseRender(n,t){const{layer:e,stage:i}=t,{subLayers:r}=e;let o=r.get(n._uid);o||(o={layer:this.layerService.createLayer(i),zIndex:r.size,group:n},r.set(n._uid,o));const s=o.layer.getNativeHandler().getContext(),a=o.drawContribution||Nt.get(tq);a.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:a,clear:"transparent",layer:o.layer,context:s,startAtId:n._uid,break:!1})),o.drawContribution=a;const l=this._findNextGraphic(n);if(l)if(l.isContainer&&l.incremental)this._increaseRender(l,t);else{let h=r.get(l._uid);h||(h={layer:this.layerService.createLayer(i),zIndex:r.size},r.set(l._uid,h));const u=h.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:a,clear:"transparent",layer:h.layer,context:u,startAtId:l._uid,break:!1}))}}getRenderContribution(n){let t;return t||(t=this.selectRenderByNumberType(n.numberType,n)),t||(t=this.selectRenderByType(n.type)),t}renderItem(n,t,e){if(this.InterceptorContributions.length)for(let a=0;a<this.InterceptorContributions.length;a++){const l=this.InterceptorContributions[a];if(l.beforeDrawItem&&l.beforeDrawItem(n,this.currentRenderService,t,this,e))return}const i=this.getRenderContribution(n);if(!i)return;let r,o=!1;if(t.isGroupScroll){const{scrollX:a=0,scrollY:l=0}=n.parent.attribute;o=!0,this.scrollMatrix||(this.scrollMatrix=Hn.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-a,-l)}if(o&&(r=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!n.isContainer&&n.attribute.boundsMode!=="empty"&&!s5(n.AABBBounds,r??this.dirtyBounds)){if(o&&n.parent){const{scrollX:a=0,scrollY:l=0}=n.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(a,l)}return}const s=t.startAtId!=null&&n._uid!==t.startAtId;if(n._uid===t.startAtId&&(t.startAtId=null),e&&(e.skipDraw=s),s?n.isContainer&&i.draw(n,this.currentRenderService,t,e):i.draw(n,this.currentRenderService,t,e),o&&n.parent){const{scrollX:a=0,scrollY:l=0}=n.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(a,l)}if(this.InterceptorContributions.length)for(let a=0;a<this.InterceptorContributions.length;a++){const l=this.InterceptorContributions[a];if(l.afterDrawItem&&l.afterDrawItem(n,this.currentRenderService,t,this))return}}selectRenderByType(n){return Ir.getInstance().warn(""),null}selectRenderByNumberType(n,t){let e;if(t.attribute.renderStyle){const i=this.styleRenderMap.get(t.attribute.renderStyle);e=i&&i.get(n)}return e||this.currentRenderMap.get(n)||this.defaultRenderMap.get(n)}clearScreen(n,t,e){var i,r,o;const{clear:s,viewBox:a}=e,l=a.width(),h=a.height();if(s){t.clearRect(0,0,l,h),!((i=n.drawParams)===null||i===void 0)&&i.stage&&n.drawParams.stage.hooks.afterClearRect.call(n.drawParams);const u=(r=n.drawParams)===null||r===void 0?void 0:r.stage;if(u&&(t.globalAlpha=(o=u.attribute.opacity)!==null&&o!==void 0?o:1),u&&u.backgroundImg&&u.resources){const d=u.resources.get(s);d&&d.state==="success"&&d.data&&t.drawImage(d.data,0,0,l,h)}else t.fillStyle=Vw(t,s,{AABBBounds:{x1:0,y1:0,x2:0+l,y2:0+h}},0,0),t.fillRect(0,0,l,h)}}afterDraw(n,t){}};m1=G2t([yt(),DR(0,YY(kr)),DR(1,le(Wi)),DR(1,mn(Hm)),$2t("design:paramtypes",[Array,Object])],m1);var j2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let y1=class extends Im{constructor(){super(...arguments),this.numberType=My}drawShape(n,t,e,i,r,o,s,a){if(n.incremental&&r.multiGraphicOptions){const{startAtIdx:l,length:h}=r.multiGraphicOptions,{segments:u=[]}=n.attribute;if(l>u.length)return;const d=te(n).line,{fill:c=d.fill,stroke:f=d.stroke,opacity:g=d.opacity,fillOpacity:p=d.fillOpacity,strokeOpacity:v=d.strokeOpacity,lineWidth:m=d.lineWidth,visible:y=d.visible}=n.attribute,b=vc(g,p,c),_=FP(g,v),w=Zg(c),C=Em(f,m);if(!n.valid||!y||!w&&!C||!(b||_||s||a))return;const{context:x}=r;for(let S=l;S<l+h;S++)this.drawIncreaseSegment(n,x,u[S-1],u[S],n.attribute.segments[S],[d,n.attribute],e,i)}else super.drawShape(n,t,e,i,r,o,s,a)}drawIncreaseSegment(n,t,e,i,r,o,s,a){i&&(t.beginPath(),$Rt(t.nativeContext,e,i,{offsetX:s,offsetY:a}),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,r,o),t.setStrokeStyle(n,r,s,a,o),t.stroke())}};y1=j2t([yt()],y1);var U2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let lk=class extends JP{constructor(){super(...arguments),this.numberType=DK}drawShape(n,t,e,i,r,o,s){if(n.incremental&&r.multiGraphicOptions){const{startAtIdx:a,length:l}=r.multiGraphicOptions,{segments:h=[]}=n.attribute;if(a>h.length)return;const u=te(n).area,{fill:d=u.fill,fillOpacity:c=u.fillOpacity,opacity:f=u.opacity,visible:g=u.visible}=n.attribute,p=vc(f,c,d),v=Zg(d);if(!n.valid||!g||!v||!p&&!s)return;for(let m=a;m<a+l;m++)this.drawIncreaseSegment(n,t,h[m-1],h[m],n.attribute.segments[m],[u,n.attribute],e,i)}else super.drawShape(n,t,e,i,r,o,s)}drawIncreaseSegment(n,t,e,i,r,o,s,a){i&&(t.beginPath(),jRt(t.camera?t:t.nativeContext,e,i,{offsetX:s,offsetY:a}),t.setShadowBlendStyle&&t.setShadowBlendStyle(n,r,o),t.setCommonStyle(n,r,s,a,o),t.fill())}};lk=U2t([yt()],lk);var kf,X2t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Y2t=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},bv=function(n,t){return function(e,i){t(e,i,n)}},pa=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};(function(n){n[n.NORMAL=0]="NORMAL",n[n.STOP=1]="STOP"})(kf||(kf={}));let hk=class extends m1{constructor(n,t,e,i){super(n,i),this.contributions=n,this.lineRender=t,this.areaRender=e,this.drawItemInterceptorContributions=i,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=kf.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new cr([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(n,t){return pa(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=n,this.lastDrawContext=t,this.checkingForDrawPromise=this.checkForDraw(t);const e=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,e)return;this.currentRenderService=n;const{context:i,viewBox:r}=t;i&&(i.inuse=!0,i.clearMatrix(),i.setTransformForCurrent(!0),i.save(),t.restartIncremental&&this.clearScreen(this.currentRenderService,i,t),i.translate(r.x1,r.y1,!0),i.save(),n.renderTreeRoots.sort((o,s)=>{var a,l;return((a=o.attribute.zIndex)!==null&&a!==void 0?a:Li.zIndex)-((l=s.attribute.zIndex)!==null&&l!==void 0?l:Li.zIndex)}).forEach(o=>{this.renderGroup(o,t)}),this.hooks.completeDraw.tap("top-draw",()=>{i.restore(),i.restore(),i.draw(),i.inuse=!1,this.rendering=!1}))})}_increaseRender(n,t){return pa(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(n,t)})}_renderIncrementalGroup(n,t){return pa(this,void 0,void 0,function*(){this.count=n.count,yield new Promise(e=>{this.renderItem(n,t,{drawingCb:()=>pa(this,void 0,void 0,function*(){if(n.count!==2)yield DW(n,Li.zIndex,(i,r)=>{if(this.status===kf.STOP)return!0;if(i.isContainer||r<this.currentIdx)return!1;const o=this.currFrameStartAt+n.incremental;return r<o&&(this.currentIdx=r+1,this.renderItem(i,t)),r===o-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),e(!1);else{const i=n.getChildAt(0);if(i.incremental&&i.attribute.segments)for(i.incrementalAt||(i.incrementalAt=0);i.incrementalAt<i.attribute.segments.length;)t.multiGraphicOptions={startAtIdx:i.incrementalAt,length:i.incremental},this.renderItem(i,t),i.incrementalAt+=i.incremental,yield this.waitToNextFrame();else this.renderItem(i,t);e(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return pa(this,void 0,void 0,function*(){return new Promise(n=>{this.global.getRequestAnimationFrame()(()=>{n(!1)})})})}checkForDraw(n){return pa(this,void 0,void 0,function*(){let t=this.rendering;return n.restartIncremental&&(t=!1,yield this.forceStop(),this.resetToInit()),t})}forceStop(){return pa(this,void 0,void 0,function*(){this.rendering&&(this.status=kf.STOP,yield new Promise(n=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=kf.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>t.name!=="stopCb"),n(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(n,t){return pa(this,void 0,void 0,function*(){if(!t.break&&n.attribute.visibleAll!==!1)return n.incremental&&t.startAtId===n._uid?(yield this._increaseRender(n,t),void(t.break=!0)):void(yield new Promise(e=>{this.renderItem(n,t,{drawingCb:()=>pa(this,void 0,void 0,function*(){yield DW(n,Li.zIndex,i=>pa(this,void 0,void 0,function*(){t.break||i.isContainer&&(yield this.renderGroup(i,t))})),e(!1)})})}))})}};hk=X2t([yt(),bv(0,YY(kr)),bv(1,le(y1)),bv(2,le(lk)),bv(3,le(Wi)),bv(3,mn(Hm)),Y2t("design:paramtypes",[Array,Object,Object,Object])],hk);const K2t=new Ut(n=>{n(cA).toSelf().inSingletonScope(),n(KO).toSelf().inSingletonScope(),n(qO).to(m1),n(tq).to(hk),n(PW).to(ek).inSingletonScope(),n(kr).toService(PW),tr(n,No),n(Zs).toSelf().inSingletonScope(),tr(n,UO),tr(n,kr),n(u1).toSelf().inSingletonScope(),n(Hm).toService(u1),tr(n,Hm)});function q2t(n){n.load(K2t)}function zm(){zm.__loaded||(zm.__loaded=!0,Nt.load(jMt),Nt.load(k2t),Nt.load(B2t),Nt.load(P2t),Nt.load(O2t),N2t(Nt),q2t(Nt))}zm.__loaded=!1,zm();const Dt=Nt.get(RO);bt.global=Dt;const Z2t=Nt.get(NK);bt.graphicUtil=Z2t;const J2t=Nt.get(zK);bt.transformUtil=J2t;const Q2t=Nt.get(WO);bt.graphicService=Q2t;const tBt=Nt.get(jO);bt.layerService=tBt;class eBt{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=nn.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&t.stage!=null&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t;const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),e.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),e.graphicService.hooks.onRemove.tap(this.key,this.handleChange))}deactivate(t){const e=r=>r.filter(o=>o.name!==this.key),i=this.pluginService.stage;i&&(i.graphicService.hooks.onAttributeUpdate.taps=e(i.graphicService.hooks.onAttributeUpdate.taps),i.graphicService.hooks.onSetStage.taps=e(i.graphicService.hooks.onSetStage.taps),i.graphicService.hooks.onRemove.taps=e(i.graphicService.hooks.onRemove.taps))}}class iBt{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=nn.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&t.stage!=null&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,this.dpr=bt.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){const t=bt.global.getRequestAnimationFrame();this.rafId=t(()=>{bt.global.devicePixelRatio!==this.dpr&&(this.dpr=bt.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{const t=`(resolution: ${window.devicePixelRatio}dppx)`,e=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))},i=matchMedia(t);i&&i.addEventListener("change",e),this.autoRefreshCbs||(this.autoRefreshCbs=[]),this.autoRefreshCbs.push(()=>{i&&i.removeEventListener("change",e)})}catch{return!1}return!0}deactivate(t){var e;const i=bt.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId),(e=this.autoRefreshCbs)===null||e===void 0||e.forEach(r=>{r()}),this.autoRefreshCbs=void 0}}class nBt{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=nn.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t;const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.tap(this.key,(i,r,o)=>{i.glyphHost&&(i=i.glyphHost),i.stage===t.stage&&i.stage!=null&&(this.nextUserParams.startAtId=r._uid,this.renderNextFrame(r))}),e.graphicService.hooks.onClearIncremental.tap(this.key,(i,r)=>{i.stage===t.stage&&i.stage!=null&&(this.nextUserParams.startAtId=i._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(i))}))}deactivate(t){const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAddIncremental.taps=e.graphicService.hooks.onAddIncremental.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.onClearIncremental.taps=e.graphicService.hooks.onClearIncremental.taps.filter(i=>i.name!==this.key))}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,bt.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){const t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{const i=e.layer;if(!i||!e.layer.subLayers)return;const r=e.layer.subLayers.get(e._uid);r&&r.drawContribution&&r.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:i,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:r.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}const IW=new Fn;class rBt{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=nn.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,i=>{i&&i===this.pluginService.stage&&i.dirtyBounds.clear()});const e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(i,r,o,s)=>{i.glyphHost&&(i=i.glyphHost),r&&r===this.pluginService.stage&&r.renderCount&&(i.isContainer&&!i.shouldSelfChangeUpdateAABBBounds()||o&&(IW.setValue(s.x1,s.y1,s.x2,s.y2),r.dirty(IW,i.parent&&i.parent.globalTransMatrix)))}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(i,r,o,s,a)=>{r&&r===this.pluginService.stage&&r.renderCount&&(i.isContainer&&!a||r.dirty(s.globalAABBBounds))}),e.graphicService.hooks.clearAABBBounds.tap(this.key,(i,r,o)=>{r&&r===this.pluginService.stage&&r.renderCount&&r&&r.dirty(o)}),e.graphicService.hooks.onRemove.tap(this.key,i=>{const r=i.stage;r&&r===this.pluginService.stage&&r.renderCount&&r&&r.dirty(i.globalAABBBounds)}))}deactivate(t){const e=this.pluginService.stage;e&&(e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.clearAABBBounds.taps=e.graphicService.hooks.clearAABBBounds.taps.filter(i=>i.name!==this.key),e.hooks.afterRender.taps=e.hooks.afterRender.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.onRemove.taps=e.graphicService.hooks.onRemove.taps.filter(i=>i.name!==this.key))}}let md;function oq(){if(md==null)try{const n=document.createElement("canvas"),t=n.getContext("2d");md=!!(window&&n.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&t&&t.isPointInPath&&t.isPointInStroke),md&&(md=!!document.createElement)}catch{md=!1}}function ZO(){oq();const n=bt.global&&bt.global.env;return n?n==="browser":md}function oBt(){oq();const n=bt.global&&bt.global.env;return n?n==="node":!md}let Sh=class uk{static registerPlugin(t,e){uk._pluginClasses[t]=e}static getPlugin(t){return uk._pluginClasses[t]}};Sh._pluginClasses={};const HW={BACKGROUND:"white"};class sBt extends ge{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){const e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){const e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return(t=this._background)!==null&&t!==void 0?t:HW.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}get ticker(){return this._ticker}set ticker(t){t.bindStage(this),this._ticker&&this._ticker.removeListener("tick",this.afterTickCb),t.addTimeline(this.timeline),this._ticker=t,this._ticker.on("tick",this.afterTickCb)}constructor(t={}){var e,i;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=r=>{if(!(this._skipRender<0))if(r){if(this.dirtyBounds){const o=this.window.getViewBox();this.dirtyBounds.setValue(o.x1,o.y1,o.width(),o.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=r=>{this._beforeRenderList.forEach(o=>o(r))},this.afterClearScreen=r=>{this._afterClearScreen&&this._afterClearScreen(r)},this.afterClearRect=r=>{this._afterClearRect&&this._afterClearRect(r)},this.afterRender=r=>{this.renderCount++,this._afterRenderList.forEach(o=>o(r)),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(o=>o(r)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{this.tickedBeforeRender=!0,this.state!=="rendering"&&this.renderNextFrame()},this.params=t,this.theme=new km,this.hooks={beforeRender:new cr(["stage"]),afterRender:new cr(["stage"]),afterClearScreen:new cr(["stage"]),afterClearRect:new cr(["stage"])},this.global=bt.global,!this.global.env&&ZO()&&this.global.setEnv("browser"),this.window=Nt.get(Pm),this.renderService=Nt.get(BO),this.pluginService=Nt.get(iq),this.layerService=Nt.get(jO),this.graphicService=Nt.get(WO),this.pluginService.active(this,t),this._beforeRenderList=[],this._afterRenderList=[],this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:t.canvasControled!==!1,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=(e=t.background)!==null&&e!==void 0?e:HW.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),t.autoRefresh&&this.enableAutoRefresh(),t.disableDirtyBounds===!1&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),t.beforeRender&&this._beforeRenderList.push(t.beforeRender),t.afterRender&&this._afterRenderList.push(t.afterRender),this.hooks.afterClearScreen.tap("constructor",this.afterClearScreen),this.hooks.afterClearRect.tap("constructor",this.afterClearRect),this._afterClearScreen=t.afterClearScreen,this._afterClearRect=t.afterClearRect,this.supportInteractiveLayer=t.interactiveLayer!==!1,t.optimize||(t.optimize={tickRenderMode:"effect"}),this.optmize(t.optimize),t.background&&Ha(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.initAnimate(t),this.rafId=(i=t.rafId)!==null&&i!==void 0?i:Math.floor(6*Math.random())}initAnimate(t){var e;this.createTicker&&this.createTimeline&&(this._ticker=t.ticker||this.createTicker(this),this._ticker.bindStage(this),((e=this.params.optimize)===null||e===void 0?void 0:e.tickRenderMode)==="performance"&&this._ticker.setFPS(30),this.timeline=this.createTimeline(),this._ticker.addTimeline(this.timeline),this._ticker.on("tick",this.afterTickCb))}startAnimate(){this._ticker&&this.timeline&&(this._ticker.start(),this.timeline.resume())}pauseRender(t=-1){this._skipRender=t}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new oTt(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-1/0:this.params.optimize.skipRenderWithOutRange!==!1?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){const{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:o=0,camera:s,fieldRatio:a=1,fieldDepth:l}=t;return Object.assign(Object.assign({},t),{center:e,light:i,alpha:r,beta:o,camera:s,fieldRatio:a,fieldDepth:l})}set3dOptions(t){var e,i,r,o,s,a;this.option3d=t;const l=this.get3dOptions(t),{light:h,center:u,camera:d,alpha:c,beta:f,fieldRatio:g,fieldDepth:p}=l,{dir:v=[1,1,-1],color:m="white",ambient:y}=h,b=((e=u.x)!==null&&e!==void 0?e:this.width/2)+((i=u.dx)!==null&&i!==void 0?i:0),_=((r=u.y)!==null&&r!==void 0?r:this.height/2)+((o=u.dy)!==null&&o!==void 0?o:0),w=[b,_,((s=u.z)!==null&&s!==void 0?s:0)+((a=u.dz)!==null&&a!==void 0?a:0)];let C=0,x=0,S=0;d||(C=Math.sin(c)+b,x=Math.sin(f)+_,S=Math.cos(c)*Math.cos(f)*1);const A=Sh.getPlugin("DirectionalLight");A&&(this.light=new A(v,m,y));const T={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:g,fieldDepth:p,viewParams:{pos:[C,x,S],center:w,up:[0,1,0]}};if(this.camera)this.camera.params=T;else{const M=Sh.getPlugin("OrthoCamera");M&&(this.camera=new M(T))}t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRenderList.push(t)}removeBeforeRender(t){this._beforeRenderList=this._beforeRenderList.filter(e=>e!==t)}setAfterRender(t){this._afterRenderList.push(t)}removeAfterRender(t){this._afterRenderList=this._afterRenderList.filter(e=>e!==t)}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;const t=Sh.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new eBt))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new iBt))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new nBt))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new Am;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new rBt,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;const t=Sh.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){if(this.htmlAttribute)return;const e=Sh.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){if(this.reactAttribute)return;const e=Sh.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){const t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw new Error("")}createLayer(t,e){if(this.releaseStatus==="released")return;const i=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(i),i}sortLayer(t){const e=this.children;e.sort(t),this.removeAllChild(),e.forEach(i=>{this.appendChild(i)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){this.releaseStatus!=="released"&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if(this.releaseStatus==="released")return;this.startAnimate();const i=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender&&this._skipRender++}combineLayersToWindow(){if(this.global.env==="harmony"){const t=this.window.getContext().nativeContext;this.forEachChildren((e,i)=>{if(i>0){const r=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(r)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(i=>{this.nextFrameRenderLayerSet.add(i)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getSpecifiedRequestAnimationFrame(this.rafId)(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if(this.releaseStatus==="released")return;this.startAnimate();const t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){const i=[];for(let r=0;r<t.length;r++){let o=t[r];o.layerMode==="virtual"&&(o=o.getNativeHandler().mainHandler.layer),i.includes(o)||i.push(o)}i.forEach(r=>{r.renderCount>this.renderCount||(r.renderCount=this.renderCount+1,r===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),r.render({renderService:this.renderService,background:r===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}resizeWindow(t,e,i=!0){this.window.resize(t,e),i&&this.render()}resize(t,e,i=!0){this.releaseStatus!=="released"&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(r=>{r.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),i&&this.render())}resizeView(t,e,i=!0){this.releaseStatus!=="released"&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(r=>{r.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),i&&this.render())}setViewBox(t,e,i,r,o){let s=!0;typeof t=="object"?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),e===!1&&(s=!1)):(this.viewBox.setValue(t,e,t+i,e+r),o===!1&&(s=!1)),this.forEachChildren(a=>{a.resizeView(this.viewBox.width(),this.viewBox.height())}),s&&this.render()}setDpr(t,e=!0){this.forEachChildren(i=>{i.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw new Error("")}export(t){throw new Error("")}pick(t,e){if(this.releaseStatus==="released")return;const i=this.getPickerService().pick(this.children,new Je(t,e),{bounds:this.AABBBounds});return!(!i?.graphic&&!i?.group)&&i}setToFrame(t){throw new Error("")}release(){var t,e;super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(i=>{i.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(i=>{i.setStage&&i.setStage(null,null),this.interactiveLayer.removeChild(i)}),this.interactiveLayer.release()),this.window.release(),(t=this._ticker)===null||t===void 0||t.remTimeline(this==null?void 0:this.timeline),(e=this._ticker)===null||e===void 0||e.removeListener("tick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){this.releaseStatus!=="released"&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){this.releaseStatus!=="released"&&this.forEachChildren((e,i)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:i===0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if(this.releaseStatus==="released")return;const i=Nt.get(Pm),r=e?-e.x1:0,o=e?-e.y1:0,s=e?e.x2:this.viewWidth,a=e?e.y2:this.viewHeight,l=e?e.width():this.viewWidth,h=e?e.height():this.viewHeight;return i.create({viewBox:{x1:r,y1:o,x2:s,y2:a},width:l,height:h,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(i),i}toCanvas(t=!0,e){if(this.releaseStatus==="released")return;const i=this.renderToNewWindow(t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){const e=this.global.mapToCanvasPoint(t,this.window);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=Nt.get(Qf)),this.pickerService}reInit(){this.renderService.reInit(),this.pickerService.reInit()}}function sq(n){return new sBt(n)}var aBt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},lBt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};let b1=class{configure(n,...t){n.env===this.type&&n.setActiveEnvContribution(this)}getNativeAABBBounds(n){return new Fn}removeDom(n){return!1}createDom(n){return null}updateDom(n,t){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(n){return document.getElementById(n)}getRootElement(){return document.body}loadJson(n){const t=fetch(n).then(e=>e.json());return t.then(e=>({data:e,state:"success"})).catch(()=>({data:null,state:"fail"})),t}loadArrayBuffer(n){return fetch(n).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(n){return fetch(n).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(n,t){return 0}getElementLeft(n,t){return 0}getElementTopLeft(n,t){return{top:0,left:0}}loadFont(n,t,e){return lBt(this,void 0,void 0,function*(){return{loadState:"fail"}})}isMacOS(){return!1}copyToClipBoard(n){return Promise.resolve(null)}};b1=aBt([yt()],b1);var hBt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},uBt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let _1=class{constructor(){this._uid=nn.GenAutoIncrementId(),this.viewBox=new Fn,this.modelMatrix=new mr(1,0,0,1,0,0)}onChange(n){this._onChangeCb=n}configure(n,t){t.env===this.type&&n.setWindowHandler(this)}release(...n){this.releaseWindow()}isVisible(n){return!0}onVisibleChange(n){}getTopLeft(n){return{top:0,left:0}}setViewBox(n){this.viewBox.setValue(n.x1,n.y1,n.x2,n.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(n,t,e,i,r,o){this.modelMatrix.setValue(n,t,e,i,r,o)}getViewBoxTransform(){return this.modelMatrix}};_1=hBt([yt(),uBt("design:paramtypes",[])],_1);var dBt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},cBt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},g_=function(n,t){return function(e,i){t(e,i,n)}};let dk=class{constructor(n,t){this.pickItemInterceptorContributions=n,this.pickServiceInterceptorContributions=t,this.type="default",this.global=bt.global}reInit(){this._init()}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((n,t)=>n.order-t.order),this.pickerServiceInterceptorContributions=this.pickServiceInterceptorContributions.getContributions().sort((n,t)=>n.order-t.order)}pick(n,t,e){let i={graphic:null,group:null};e.pickerService=this;const r=e.bounds.width(),o=e.bounds.height();if(!new Fn().setValue(0,0,r,o).containsPoint(t))return i;this.pickContext&&(this.pickContext.inuse=!0),e.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);const s=new mr(1,0,0,1,0,0);let a;for(let l=n.length-1;l>=0&&(i=n[l].isContainer?this.pickGroup(n[l],t,s,e):this.pickItem(n[l],t,s,e),!i.graphic);l--)a||(a=i.group);if(i.graphic||(i.group=a),this.pickContext&&(this.pickContext.inuse=!1),this.pickerServiceInterceptorContributions.length)for(let l=0;l<this.pickerServiceInterceptorContributions.length;l++){const h=this.pickerServiceInterceptorContributions[l];h.afterPickItem&&(i=h.afterPickItem(i,this,t,e,{parentMatrix:s}))}return i}containsPoint(n,t,e){var i;return!!(!((i=this.pickItem(n,t,null,e??{pickContext:this.pickContext,pickerService:this}))===null||i===void 0)&&i.graphic)}pickGroup(n,t,e,i){let r={group:null,graphic:null};if(n.attribute.visibleAll===!1)return r;const o=i.pickContext,s=o.modelMatrix;if(o.camera){const f=n.transMatrix,g=fn.allocate();if(DP(g,f),s){if(g){const p=fn.allocate();o.modelMatrix=Ry(p,s,g),fn.free(g)}}else DP(g,n.globalTransMatrix),o.modelMatrix=g}if(this.InterceptorContributions.length)for(let f=0;f<this.InterceptorContributions.length;f++){const g=this.InterceptorContributions[f];if(g.beforePickItem){const p=g.beforePickItem(n,this,t,i,{parentMatrix:e});if(p)return o.modelMatrix!==s&&fn.free(o.modelMatrix),o.modelMatrix=s,p}}const a=n.transMatrix,l=Hn.allocateByObj(e),h=new Je(t.x,t.y);l.transformPoint(h,h);const u=n.AABBBounds.containsPoint(h);if(!u&&!n.stage.camera)return r;const d=this.pickItem(n,h.clone(),e,i);d&&d.graphic&&(r.graphic=d.graphic,r.params=d.params);const c=n.attribute.pickable!==!1&&u;return l.multiply(a.a,a.b,a.c,a.d,a.e,a.f),n.attribute.childrenPickable===!1||d&&d.graphic||rq(n,Li.zIndex,f=>{if(f.isContainer){const g=new Je(t.x,t.y),p=te(n).group,{scrollX:v=p.scrollX,scrollY:m=p.scrollY}=n.attribute;g.x-=v,g.y-=m,r=this.pickGroup(f,g,l,i)}else{const g=new Je(t.x,t.y);l.transformPoint(g,g);const p=te(n).group,{scrollX:v=p.scrollX,scrollY:m=p.scrollY}=n.attribute;g.x-=v,g.y-=m;const y=this.pickItem(f,g,e,i);y&&y.graphic&&(r.graphic=y.graphic,r.params=y.params)}return!!r.graphic||!!r.group},!0,!!o.camera),o.modelMatrix!==s&&fn.free(o.modelMatrix),o.modelMatrix=s,r.graphic||r.group||!c||n.stage.camera||(r.group=n),Hn.free(l),r}selectPicker(n){return this.pickerMap.get(n.numberType)||null}};dk=dBt([yt(),g_(0,le(Wi)),g_(0,mn(Pf)),g_(1,le(Wi)),g_(1,mn(d1)),cBt("design:paramtypes",[Object,Object])],dk);function fBt(n,t,e){const i={};for(const r in t)r in n&&SP(n[r],t[r])||(i[r]=t[r]);return i}let FW=!1;const gBt=new Ut(n=>{FW||(FW=!0,n(qw).toSelf().inSingletonScope(),n(n1).to(qw).inSingletonScope(),n(kr).toService(n1),n(NP).toService(Zs),tr(n,NP))});let zW=!1;const pBt=new Ut(n=>{zW||(zW=!0,n(t1).toSelf().inSingletonScope(),n(l1).to(t1).inSingletonScope(),n(kr).toService(l1),n(ip).toSelf(),n(ep).toSelf(),n(Pd).toService(ip),n(Pd).toService(ep),n(Pd).toService(Zs),tr(n,Pd))});let NW=!1;const vBt=new Ut(n=>{NW||(NW=!0,n(Im).toSelf().inSingletonScope(),n(y1).toSelf().inSingletonScope(),n(o1).to(Im).inSingletonScope(),n(kr).toService(o1))});let WW=!1;const mBt=new Ut(n=>{WW||(WW=!0,n(e1).toSelf().inSingletonScope(),n(h1).to(e1).inSingletonScope(),n(kr).toService(h1),n($P).toService(Zs),tr(n,$P))});let VW=!1;const yBt=new Ut(n=>{VW||(VW=!0,n(Zw).toSelf().inSingletonScope(),n(r1).to(Zw).inSingletonScope(),n(kr).toService(r1),n(WP).toService(Zs),tr(n,WP))});let GW=!1;const bBt=new Ut(n=>{GW||(GW=!0,n(nk).to(QP).inSingletonScope(),n(kr).toService(nk),n(Yw).toService(Zs),tr(n,Yw))});let $W=!1;const _Bt=new Ut(n=>{$W||($W=!0,n(Qw).toSelf().inSingletonScope(),n(s1).to(Qw).inSingletonScope(),n(kr).toService(s1),n(VP).toService(Zs),tr(n,VP))});let jW=!1;const CBt=new Ut(n=>{jW||(jW=!0,n(a1).to(tk).inSingletonScope(),n(kr).toService(a1),n(GP).toService(Zs),tr(n,GP))});var wBt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},xBt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let ck=class extends to{constructor(){super(),this.numberType=NO,this.builtinContributions=[JK],this.init()}drawShape(n,t,e,i,r){const o=te(n).richtext,{strokeOpacity:s=o.strokeOpacity,opacity:a=o.opacity,fillOpacity:l=o.fillOpacity,visible:h=o.visible}=n.attribute;if(!n.valid||!h)return;const u=vc(a,l,!0),d=vc(a,s,!0);u&&(t.setShadowBlendStyle&&t.setShadowBlendStyle(n,n.attribute,o),t.translate(e,i),this.beforeRenderStep(n,t,e,i,u,d,u,d,o,r),n.getFrameCache().draw(t,this.drawIcon),this.afterRenderStep(n,t,e,i,u,d,u,d,o,r))}drawIcon(n,t,e,i,r){var o;const s=te(n).richtextIcon,{width:a=s.width,height:l=s.height,opacity:h=s.opacity,image:u,backgroundFill:d=s.backgroundFill,backgroundFillOpacity:c=s.backgroundFillOpacity,backgroundStroke:f=s.backgroundStroke,backgroundStrokeOpacity:g=s.backgroundStrokeOpacity,backgroundRadius:p=s.backgroundRadius,margin:v}=n.attribute,{backgroundWidth:m=a,backgroundHeight:y=l}=n.attribute;if(v&&(e+=n._marginArray[3],i+=n._marginArray[0]),n._hovered){const _=(m-a)/2,w=(y-l)/2;p===0?(t.beginPath(),t.rect(e-_,i-w,m,y)):(t.beginPath(),qa(t,e-_,i-w,m,y,p,!0)),d&&(t.globalAlpha=c,t.fillStyle=d,t.fill()),f&&(t.globalAlpha=g,t.strokeStyle=f,t.stroke())}const b=u&&((o=n?.resources)===null||o===void 0?void 0:o.get(u));b&&b.state==="success"&&(t.globalAlpha=h,t.drawImage(b.data,e,i,a,l))}draw(n,t,e){const i=te(n).richtext;this._draw(n,i,!1,e)}};ck=wBt([yt(),xBt("design:paramtypes",[])],ck);let UW=!1;const SBt=new Ut(n=>{UW||(UW=!0,n(rk).to(ck).inSingletonScope(),n(kr).toService(rk))});let XW=!1;const ABt=new Ut(n=>{XW||(XW=!0,n(ok).to(ik).inSingletonScope(),n(kr).toService(ok),n(Bd).toService(Zs),tr(n,Bd))});function TBt(){kt.RegisterGraphicCreator("arc",Kw)}function MBt(){kt.RegisterGraphicCreator("circle",UK)}function RBt(){kt.RegisterGraphicCreator("group",Xw)}function BBt(){kt.RegisterGraphicCreator("image",uA)}function PBt(){kt.RegisterGraphicCreator("line",Ri)}function kBt(){kt.RegisterGraphicCreator("path",sRt)}function EBt(){kt.RegisterGraphicCreator("polygon",YK)}function LBt(){kt.RegisterGraphicCreator("rect",Ne)}function OBt(){kt.RegisterGraphicCreator("richtext",oRt)}function DBt(){kt.RegisterGraphicCreator("symbol",Qg)}function IBt(){kt.RegisterGraphicCreator("text",Om)}function HBt(){kt.RegisterGraphicCreator("shadowRoot",lRt)}function FBt(){kt.RegisterGraphicCreator("wrapText",JMt)}const YW=new Fn;class zBt{constructor(){this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=nn.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new Fn}pauseLayout(t){this.pause=t}tryLayoutChildren(t){t.firstChild&&this.tryLayout(t.firstChild)}tryLayout(t,e=!0){if(this.pause)return;const i=t.parent;if(!(e||i&&t.needUpdateLayout()))return;const r=te(i).group,{display:o=r.display}=i.attribute;if(o!=="flex")return;const{flexDirection:s=r.flexDirection,flexWrap:a=r.flexWrap,alignItems:l=r.alignItems,clip:h=r.clip}=i.attribute,{alignContent:u=l??r.alignContent}=i.attribute;let{width:d,height:c,justifyContent:f=r.justifyContent}=i.attribute;const g=i.getChildren();if(d==null||c==null){let S=0,A=0,T=0;if(g.forEach(M=>{const R=this.getAABBBounds(M);R.empty()||(s==="column"||s==="column-reverse"?(A+=R.height(),S=Math.max(S,R.width())):(S+=R.width(),A=Math.max(A,R.height())),T+=R.x1,T+=R.y1,T+=R.x2,T+=R.y2)}),!isFinite(T))return;d=S,c=A}i.attribute.width==null?i.attribute.width=d:d=i.attribute.width,i.attribute.height==null?i.attribute.height=c:c=i.attribute.height,this.tempBounds.copy(i._AABBBounds);const p={main:{len:d,field:"x"},cross:{len:c,field:"y"}},v=p.main,m=p.cross;s!=="column"&&s!=="column-reverse"||(v.len=c,m.len=d,v.field="y",m.field="x"),s!=="row-reverse"&&s!=="column-reverse"||(f==="flex-start"?f="flex-end":f==="flex-end"?f="flex-start":g.reverse());let y=0,b=0;const _=[];g.forEach(S=>{const A=this.getAABBBounds(S);if(A.empty())return;const T=v.field==="x"?A.width():A.height(),M=m.field==="x"?A.width():A.height();_.push({mainLen:T,crossLen:M}),y+=T,b=Math.max(b,M)});const w=[];if(y>v.len&&a==="wrap"){let S=0,A=0;_.forEach(({mainLen:T,crossLen:M},R)=>{S+T>v.len?S===0?(w.push({idx:R,mainLen:S+T,crossLen:M}),S=0,A=0):(w.push({idx:R-1,mainLen:S,crossLen:A}),S=T,A=M):(S+=T,A=Math.max(A,M))}),w.push({idx:_.length-1,mainLen:S,crossLen:A})}else w.push({idx:_.length-1,mainLen:y,crossLen:b});let C=0;if(w.forEach(S=>{this.layoutMain(i,g,f,v,_,C,S),C=S.idx+1}),b=w.reduce((S,A)=>S+A.crossLen,0),w.length===1){const S={"flex-start":0,"flex-end":m.len,center:m.len/2};this.layoutCross(g,l,m,S,_,w[0],0)}else if(u==="flex-start"){C=0;let S=0;w.forEach((A,T)=>{const M={"flex-start":S,"flex-end":S+A.crossLen,center:S+A.crossLen/2};this.layoutCross(g,"flex-start",m,M,_,w[T],C),C=A.idx+1,S+=A.crossLen})}else if(u==="center"){C=0;let S=Math.max(0,(m.len-b)/2);w.forEach((A,T)=>{const M={"flex-start":S,"flex-end":S+A.crossLen,center:S+A.crossLen/2};this.layoutCross(g,"center",m,M,_,w[T],C),C=A.idx+1,S+=A.crossLen})}else if(u==="space-around"){C=0;const S=Math.max(0,(m.len-b)/w.length/2);let A=S;w.forEach((T,M)=>{const R={"flex-start":A,"flex-end":A+T.crossLen,center:A+T.crossLen/2};this.layoutCross(g,"flex-start",m,R,_,w[M],C),C=T.idx+1,A+=T.crossLen+2*S})}else if(u==="space-between"){C=0;const S=Math.max(0,(m.len-b)/(2*w.length-2));let A=0;w.forEach((T,M)=>{const R={"flex-start":A,"flex-end":A+T.crossLen,center:A+T.crossLen/2};this.layoutCross(g,"flex-start",m,R,_,w[M],C),C=T.idx+1,A+=T.crossLen+2*S})}g.forEach((S,A)=>{S.addUpdateBoundTag(),S.addUpdatePositionTag(),S.clearUpdateLayoutTag()}),i.addUpdateLayoutTag();const x=this.getAABBBounds(i);h||this.tempBounds.equals(x)||this.tryLayout(i,!1)}getAABBBounds(t){this.skipBoundsTrigger=!0;const e=t.AABBBounds;return this.skipBoundsTrigger=!1,e}updateChildPos(t,e,i){return t+(e??0)-i}layoutMain(t,e,i,r,o,s,a){if(i==="flex-start"){let l=0;for(let h=s;h<=a.idx;h++){const u=l+va(e[h],r.field),d=this.getAABBBounds(e[h]);!d.empty()&&(e[h].attribute[r.field]=this.updateChildPos(u,e[h].attribute[r.field],d[`${r.field}1`])),l+=o[h].mainLen}}else if(i==="flex-end"){let l=r.len;for(let h=a.idx;h>=s;h--){l-=o[h].mainLen;const u=l+va(e[h],r.field),d=this.getAABBBounds(e[h]);!d.empty()&&(e[h].attribute[r.field]=this.updateChildPos(u,e[h].attribute[r.field],d[`${r.field}1`]))}}else if(i==="space-around")if(a.mainLen>=r.len){let l=0;for(let h=s;h<=a.idx;h++){const u=l+va(e[h],r.field),d=this.getAABBBounds(e[h]);!d.empty()&&(e[h].attribute[r.field]=this.updateChildPos(u,e[h].attribute[r.field],d[`${r.field}1`])),l+=o[h].mainLen}}else{const l=a.idx-s+1,h=(r.len-a.mainLen)/l/2;let u=h;for(let d=s;d<=a.idx;d++){const c=u+va(e[d],r.field),f=this.getAABBBounds(e[d]);!f.empty()&&(e[d].attribute[r.field]=this.updateChildPos(c,e[d].attribute[r.field],f[`${r.field}1`])),u+=o[d].mainLen+2*h}}else if(i==="space-between")if(a.mainLen>=r.len){let l=0;for(let h=s;h<=a.idx;h++){const u=l+va(e[h],r.field),d=this.getAABBBounds(e[h]);!d.empty()&&(e[h].attribute[r.field]=this.updateChildPos(u,e[h].attribute[r.field],d[`${r.field}1`])),l+=o[h].mainLen}}else{const l=a.idx-s+1,h=(r.len-a.mainLen)/(2*l-2);let u=0;for(let d=s;d<=a.idx;d++){const c=u+va(e[d],r.field),f=this.getAABBBounds(e[d]);!f.empty()&&(e[d].attribute[r.field]=this.updateChildPos(c,e[d].attribute[r.field],f[`${r.field}1`])),u+=o[d].mainLen+2*h}}else if(i==="center"){let l=(r.len-a.mainLen)/2;for(let h=s;h<=a.idx;h++){const u=l+va(e[h],r.field),d=this.getAABBBounds(e[h]);!d.empty()&&(e[h].attribute[r.field]=this.updateChildPos(u,e[h].attribute[r.field],d[`${r.field}1`])),l+=o[h].mainLen}}}layoutCross(t,e,i,r,o,s,a){var l;for(let h=a;h<=s.idx;h++){const u=t[h];let{alignSelf:d}=u.attribute;d&&d!=="auto"||(d=e);const c=this.getAABBBounds(u),f=(l=r[d])!==null&&l!==void 0?l:r["flex-start"];d==="flex-end"?!c.empty()&&(u.attribute[i.field]=this.updateChildPos(f-o[h].crossLen+va(u,i.field),u.attribute[i.field],c[`${i.field}1`])):d==="center"?!c.empty()&&(u.attribute[i.field]=this.updateChildPos(f-o[h].crossLen/2+va(u,i.field),u.attribute[i.field],c[`${i.field}1`])):!c.empty()&&(u.attribute[i.field]=this.updateChildPos(f+va(u,i.field),u.attribute[i.field],c[`${i.field}1`]))}}activate(t){this.pluginService=t;const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.tap(this.key,i=>{i.glyphHost&&(i=i.glyphHost),i.stage&&i.stage===this.pluginService.stage&&this.tryLayout(i,!1)}),e.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(i,r,o,s)=>{i.glyphHost&&(i=i.glyphHost),r&&r===this.pluginService.stage&&i.isContainer&&!this.skipBoundsTrigger&&YW.copy(s)}),e.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(i,r,o,s,a)=>{r&&r===this.pluginService.stage&&i.isContainer&&!this.skipBoundsTrigger&&(YW.equals(o)||this.tryLayout(i,!1))}),e.graphicService.hooks.onSetStage.tap(this.key,i=>{i.glyphHost&&(i=i.glyphHost),this.tryLayout(i,!1)}))}deactivate(t){const e=this.pluginService.stage;e&&(e.graphicService.hooks.onAttributeUpdate.taps=e.graphicService.hooks.onAttributeUpdate.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.beforeUpdateAABBBounds.taps=e.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.afterUpdateAABBBounds.taps=e.graphicService.hooks.afterUpdateAABBBounds.taps.filter(i=>i.name!==this.key),e.graphicService.hooks.onSetStage.taps=e.graphicService.hooks.onSetStage.taps.filter(i=>i.name!==this.key))}}function va(n,t){return 0}const KW=()=>{Sh.registerPlugin("FlexLayoutPlugin",zBt)},Sp=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,C1=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||Sp(n,"Boolean"),zi=n=>typeof n=="function",ee=n=>n==null,Tt=n=>n!=null,Js=n=>{const t=typeof n;return n!==null&&t==="object"||t==="function"},NBt=n=>typeof n=="object"&&n!==null,A0=function(n){if(!NBt(n)||!Sp(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},JO=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||Sp(n,"String")},Ge=n=>Array.isArray?Array.isArray(n):Sp(n,"Array"),QO=function(n){return n!==null&&typeof n!="function"&&Number.isFinite(n.length)},WBt=n=>Sp(n,"Date"),jn=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||Sp(n,"Number")},Zi=n=>jn(n)&&Number.isFinite(n),VBt=n=>({}).toString.call(n).replace(/^\[object /,"").replace(/]$/,""),GBt=Object.prototype,$Bt=function(n){const t=n&&n.constructor;return n===(typeof t=="function"&&t.prototype||GBt)},jBt=Object.prototype.hasOwnProperty;function Qe(n){if(ee(n))return!0;if(QO(n))return!n.length;const t=VBt(n);if(t==="Map"||t==="Set")return!n.size;if($Bt(n))return!Object.keys(n).length;for(const e in n)if(jBt.call(n,e))return!1;return!0}const Mr=(n,t,e)=>{const i=JO(t)?t.split("."):t;for(let r=0;r<i.length;r++)n=n?n[i[r]]:void 0;return n===void 0?e:n};function aq(n,t,e){let i;if(!Tt(n)||typeof n!="object"||t)return n;const r=Ge(n),o=n.length;i=r?new Array(o):typeof n=="object"?{}:C1(n)||jn(n)||JO(n)?n:WBt(n)?new Date(+n):void 0;const s=r?void 0:Object.keys(Object(n));let a=-1;if(i)for(;++a<(s||n).length;){const l=s?s[a]:a,h=n[l];i[l]=aq(h,t)}return i}function lq(n,t,e=!1,i=!1){if(t){if(n===t)return;if(Tt(t)&&typeof t=="object"){const r=Object(t),o=[];for(const l in r)o.push(l);let{length:s}=o,a=-1;for(;s--;){const l=o[++a];!Tt(r[l])||typeof r[l]!="object"||i&&Ge(n[l])?hq(n,l,r[l]):UBt(n,t,l,e,i)}}}}function UBt(n,t,e,i=!1,r=!1){const o=n[e],s=t[e];let a=t[e],l=!0;if(Ge(s)){if(i)a=[];else if(Ge(o))a=o;else if(QO(o)){a=new Array(o.length);let h=-1;const u=o.length;for(;++h<u;)a[h]=o[h]}}else A0(s)?(a=o??{},typeof o!="function"&&typeof o=="object"||(a={})):l=!1;l&&lq(a,s,i,r),hq(n,e,a)}function hq(n,t,e){(e!==void 0&&!XBt(n[t],e)||e===void 0&&!(t in n))&&(n[t]=e)}function XBt(n,t){return n===t||Number.isNaN(n)&&Number.isNaN(t)}function Wt(n,...t){let e=-1;const i=t.length;for(;++e<i;)lq(n,t[e],!0);return n}function YBt(n){if(!n)return[];if(Object.keys)return Object.keys(n);const t=[];for(const e in n)n.hasOwnProperty(e)&&t.push(e);return t}function KBt(n,t,e){const i=YBt(t);for(let r=0;r<i.length;r++){const o=i[r];(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}return n}function qBt(n,t,e=!0){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){const i=Object.getOwnPropertyNames(t);for(let r=0;r<i.length;r++){const o=i[r];o!=="constructor"&&(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}}else KBt(n,t,e)}function w1(n){return Tt(n)?Ge(n)?n:[n]:[]}function Ef(n){if(QO(n))return n[n.length-1]}const uq=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)>0&&(i=o)}return i},tD=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)<0&&(i=o)}return i};function fk(n){if(!Ge(n))return[n];const t=[];for(const e of n)t.push(...fk(e));return t}function ZBt(n,t,e){Tt(t)||(t=n,n=0),Tt(e)||(e=1);let i=-1;const r=0|Math.max(0,Math.ceil((t-n)/e)),o=new Array(r);for(;++i<r;)o[i]=n+i*e;return o}function JBt(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function QBt(n){return Number(n)}function tPt(n,t,e=0,i){for(ee(i)&&(i=n.length);e<i;){const r=e+i>>>1;JBt(n[r],t)>0?i=r:e=r+1}return e}const ePt=(n,t,e)=>{let i=n,r=t;for(;i<r;){const o=Math.floor((i+r)/2);e(o)>=0?r=o:i=o+1}return i},iPt=1e-10,nPt=1e-10;function Ed(n,t,e=nPt,i=iPt){const r=i,o=e*Math.max(n,t);return Math.abs(n-t)<=Math.max(r,o)}const dq=n=>{let t=null,e=null;return(...i)=>(t&&i.every((r,o)=>r===t[o])||(t=i,e=n(...i)),e)},ho=function(n,t,e){return n<t?t:n>e?e:n},td=(n,t,e)=>{let[i,r]=n;r<i&&(i=n[1],r=n[0]);const o=r-i;return o>=e-t?[t,e]:(i=Math.min(Math.max(i,t),e-o),[i,i+o])};function rPt(n,t){let e;return n>t&&(e=n,n=t,t=e),i=>Math.max(n,Math.min(t,i))}let x1=!1;try{x1=typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"}catch{x1=!1}function cq(n,t,e){let i,r,o,s,a,l,h=0,u=!1,d=!1,c=!0;const f=!t&&t!==0&&x1;if(typeof n!="function")throw new TypeError("Expected a function");function g(_){const w=i,C=r;return i=r=void 0,h=_,s=n.apply(C,w),s}function p(_,w){return f?(cancelAnimationFrame(a),requestAnimationFrame(_)):setTimeout(_,w)}function v(_){const w=_-l;return l===void 0||w>=t||w<0||d&&_-h>=o}function m(){const _=Date.now();if(v(_))return y(_);a=p(m,function(w){const C=w-h,x=t-(w-l);return d?Math.min(x,o-C):x}(_))}function y(_){return a=void 0,c&&i?g(_):(i=r=void 0,s)}function b(..._){const w=Date.now(),C=v(w);if(i=_,r=this,l=w,C){if(a===void 0)return function(x){return h=x,a=p(m,t),u?g(x):s}(l);if(d)return a=p(m,t),g(l)}return a===void 0&&(a=p(m,t)),s}return t=+t||0,Js(e)&&(u=!!e.leading,d="maxWait"in e,d&&(o=Math.max(Zi(e.maxWait)?e.maxWait:0,t)),c="trailing"in e?!!e.trailing:c),b.cancel=function(){a!==void 0&&function(_){if(f)return cancelAnimationFrame(_);clearTimeout(_)}(a),h=0,i=l=r=a=void 0},b.flush=function(){return a===void 0?s:y(Date.now())},b.pending=function(){return a!==void 0},b}x1=!1;function fq(n,t,e){let i=!0,r=!0;if(typeof n!="function")throw new TypeError("Expected a function");return Js(e)&&(i="leading"in e?!!e.leading:i,r="trailing"in e?!!e.trailing:r),cq(n,t,{leading:i,trailing:r,maxWait:t})}function cC(n,t){return e=>n*(1-e)+t*e}function oPt(n,t){return function(e){return Math.round(n*(1-e)+t*e)}}function sPt(n,t){const e=n.valueOf(),i=t.valueOf(),r=new Date;return o=>(r.setTime(e*(1-o)+i*o),r)}const Wo=Math.PI,qW=Wo/2,p_=2*Math.PI,ZW=Math.abs,v_=Math.max,S1=Math.min;function aPt(n,t){return n[0]*t[1]-n[1]*t[0]}function Ld(n){return n*(Math.PI/180)}function lPt(n,t,e){return t?{x:n.x+t*Math.cos(e),y:n.y+t*Math.sin(e)}:{x:n.x,y:n.y}}function JW(n){for(;n<0;)n+=2*Math.PI;for(;n>=2*Math.PI;)n-=2*Math.PI;return n}function hPt(n,t,e){if(n===null)return t;if(t===null)return n;const{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:h,y22:u}=gq(n,t);return i>=l||r<=a||o>=u||s<=h?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(i,a),y1:Math.max(o,h),x2:Math.min(r,l),y2:Math.min(s,u)}}var Lf;(function(n){n[n.NONE=0]="NONE",n[n.BBOX1=1]="BBOX1",n[n.BBOX2=2]="BBOX2"})(Lf||(Lf={}));const gq=(n,t,e)=>{let i=n.x1,r=n.x2,o=n.y1,s=n.y2,a=t.x1,l=t.x2,h=t.y1,u=t.y2;return{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:h,y22:u}};function uPt(n,t,e){if(!n||!t)return Lf.NONE;const{x11:i,x12:r,y11:o,y12:s,x21:a,x22:l,y21:h,y22:u}=gq(n,t);return i>a&&r<l&&o>h&&s<u?Lf.BBOX1:a>i&&l<r&&h>o&&u<s?Lf.BBOX2:Lf.NONE}function dPt(n,t,e){return n&&t?!(n.x1>t.x2||n.x2<t.x1||n.y1>t.y2||n.y2<t.y1):!0}function IR(n,t){return Math.abs(t[0]*n[0]+t[1]*n[1])}function Uv({x:n,y:t},e,i={x:0,y:0}){return{x:(n-i.x)*Math.cos(e)-(t-i.y)*Math.sin(e)+i.x,y:(n-i.x)*Math.sin(e)+(t-i.y)*Math.cos(e)+i.y}}function gk(n){return{x:(n.x1+n.x2)/2,y:(n.y1+n.y2)/2}}function QW(n,t){const e=t?Ld(n.angle):n.angle,i=gk(n);return[Uv({x:n.x1,y:n.y1},e,i),Uv({x:n.x2,y:n.y1},e,i),Uv({x:n.x2,y:n.y2},e,i),Uv({x:n.x1,y:n.y2},e,i)]}function cPt(n,t,e=!1){const i=QW(n,e),r=QW(t,e),o=(v,m)=>[m.x-v.x,m.y-v.y],s=o(gk(n),gk(t)),a=o(i[0],i[1]),l=o(i[1],i[2]),h=o(r[0],r[1]),u=o(r[1],r[2]),d=e?Ld(n.angle):n.angle;let c=e?Ld(90-n.angle):n.angle+qW;const f=e?Ld(t.angle):t.angle;let g=e?Ld(90-t.angle):t.angle+qW;c>p_&&(c-=p_),g>p_&&(g-=p_);const p=(v,m,y,b)=>{const _=[Math.cos(m),Math.sin(m)];return v+(IR(_,y)+IR(_,b))/2>IR(_,s)};return p((n.x2-n.x1)/2,d,h,u)&&p((n.y2-n.y1)/2,c,h,u)&&p((t.x2-t.x1)/2,f,a,l)&&p((t.y2-t.y1)/2,g,a,l)}const t4=n=>{let t=n.charCodeAt(0),e=n.length===2?n.charCodeAt(1):0,i=t;return 55296<=t&&t<=56319&&56320<=e&&e<=57343&&(t&=1023,e&=1023,i=t<<10|e,i+=65536),i===12288||65281<=i&&i<=65376||65504<=i&&i<=65510?"F":i===8361||65377<=i&&i<=65470||65474<=i&&i<=65479||65482<=i&&i<=65487||65490<=i&&i<=65495||65498<=i&&i<=65500||65512<=i&&i<=65518?"H":4352<=i&&i<=4447||4515<=i&&i<=4519||4602<=i&&i<=4607||9001<=i&&i<=9002||11904<=i&&i<=11929||11931<=i&&i<=12019||12032<=i&&i<=12245||12272<=i&&i<=12283||12289<=i&&i<=12350||12353<=i&&i<=12438||12441<=i&&i<=12543||12549<=i&&i<=12589||12593<=i&&i<=12686||12688<=i&&i<=12730||12736<=i&&i<=12771||12784<=i&&i<=12830||12832<=i&&i<=12871||12880<=i&&i<=13054||13056<=i&&i<=19903||19968<=i&&i<=42124||42128<=i&&i<=42182||43360<=i&&i<=43388||44032<=i&&i<=55203||55216<=i&&i<=55238||55243<=i&&i<=55291||63744<=i&&i<=64255||65040<=i&&i<=65049||65072<=i&&i<=65106||65108<=i&&i<=65126||65128<=i&&i<=65131||110592<=i&&i<=110593||127488<=i&&i<=127490||127504<=i&&i<=127546||127552<=i&&i<=127560||127568<=i&&i<=127569||131072<=i&&i<=194367||177984<=i&&i<=196605||196608<=i&&i<=262141?"W":32<=i&&i<=126||162<=i&&i<=163||165<=i&&i<=166||i===172||i===175||10214<=i&&i<=10221||10629<=i&&i<=10630?"Na":i===161||i===164||167<=i&&i<=168||i===170||173<=i&&i<=174||176<=i&&i<=180||182<=i&&i<=186||188<=i&&i<=191||i===198||i===208||215<=i&&i<=216||222<=i&&i<=225||i===230||232<=i&&i<=234||236<=i&&i<=237||i===240||242<=i&&i<=243||247<=i&&i<=250||i===252||i===254||i===257||i===273||i===275||i===283||294<=i&&i<=295||i===299||305<=i&&i<=307||i===312||319<=i&&i<=322||i===324||328<=i&&i<=331||i===333||338<=i&&i<=339||358<=i&&i<=359||i===363||i===462||i===464||i===466||i===468||i===470||i===472||i===474||i===476||i===593||i===609||i===708||i===711||713<=i&&i<=715||i===717||i===720||728<=i&&i<=731||i===733||i===735||768<=i&&i<=879||913<=i&&i<=929||931<=i&&i<=937||945<=i&&i<=961||963<=i&&i<=969||i===1025||1040<=i&&i<=1103||i===1105||i===8208||8211<=i&&i<=8214||8216<=i&&i<=8217||8220<=i&&i<=8221||8224<=i&&i<=8226||8228<=i&&i<=8231||i===8240||8242<=i&&i<=8243||i===8245||i===8251||i===8254||i===8308||i===8319||8321<=i&&i<=8324||i===8364||i===8451||i===8453||i===8457||i===8467||i===8470||8481<=i&&i<=8482||i===8486||i===8491||8531<=i&&i<=8532||8539<=i&&i<=8542||8544<=i&&i<=8555||8560<=i&&i<=8569||i===8585||8592<=i&&i<=8601||8632<=i&&i<=8633||i===8658||i===8660||i===8679||i===8704||8706<=i&&i<=8707||8711<=i&&i<=8712||i===8715||i===8719||i===8721||i===8725||i===8730||8733<=i&&i<=8736||i===8739||i===8741||8743<=i&&i<=8748||i===8750||8756<=i&&i<=8759||8764<=i&&i<=8765||i===8776||i===8780||i===8786||8800<=i&&i<=8801||8804<=i&&i<=8807||8810<=i&&i<=8811||8814<=i&&i<=8815||8834<=i&&i<=8835||8838<=i&&i<=8839||i===8853||i===8857||i===8869||i===8895||i===8978||9312<=i&&i<=9449||9451<=i&&i<=9547||9552<=i&&i<=9587||9600<=i&&i<=9615||9618<=i&&i<=9621||9632<=i&&i<=9633||9635<=i&&i<=9641||9650<=i&&i<=9651||9654<=i&&i<=9655||9660<=i&&i<=9661||9664<=i&&i<=9665||9670<=i&&i<=9672||i===9675||9678<=i&&i<=9681||9698<=i&&i<=9701||i===9711||9733<=i&&i<=9734||i===9737||9742<=i&&i<=9743||9748<=i&&i<=9749||i===9756||i===9758||i===9792||i===9794||9824<=i&&i<=9825||9827<=i&&i<=9829||9831<=i&&i<=9834||9836<=i&&i<=9837||i===9839||9886<=i&&i<=9887||9918<=i&&i<=9919||9924<=i&&i<=9933||9935<=i&&i<=9953||i===9955||9960<=i&&i<=9983||i===10045||i===10071||10102<=i&&i<=10111||11093<=i&&i<=11097||12872<=i&&i<=12879||57344<=i&&i<=63743||65024<=i&&i<=65039||i===65533||127232<=i&&i<=127242||127248<=i&&i<=127277||127280<=i&&i<=127337||127344<=i&&i<=127386||917760<=i&&i<=917999||983040<=i&&i<=1048573||1048576<=i&&i<=1114109?"A":"N"};function fPt(n,t={},e){e||(e=1);const{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=t.fontWeight,fontSize:s=t.fontSize,fontFamily:a=t.fontFamily}=n;return(i?i+" ":"")+(r?r+" ":"")+(o?o+" ":"")+s*e+"px "+(a||"sans-serif")}let tg=class ed{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'"~`,this._option=t,this._userSpec=e??{},this.textSpec=this._initSpec(),Tt(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=Tt(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(ee(this._canvas)&&(Tt(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),ee(this._canvas)&&typeof window<"u"&&window.document!==void 0&&globalThis&&Tt(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),ee(this._context)&&Tt(this._canvas)){const t=this._canvas.getContext("2d");Tt(t)&&(t.save(),t.font=fPt(this.textSpec),this._contextSaved=!0,this._context=t)}return!ee(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;const{defaultFontParams:r={}}=this._option,{fontStyle:o=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:a=(t=r.fontWeight)!==null&&t!==void 0?t:"normal",fontSize:l=(e=r.fontSize)!==null&&e!==void 0?e:12,fontFamily:h=(i=r.fontFamily)!==null&&i!==void 0?i:"sans-serif",align:u,textAlign:d=u??"center",baseline:c,textBaseline:f=c??"middle",ellipsis:g,limit:p}=this._userSpec;let{lineHeight:v=l}=this._userSpec;if(JO(v)&&v[v.length-1]==="%"){const m=Number.parseFloat(v.substring(0,v.length-1))/100;v=l*m}return{fontStyle:o,fontVariant:s,fontFamily:h,fontSize:l,fontWeight:a,textAlign:d,textBaseline:f,ellipsis:g,limit:p,lineHeight:v}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){if(ee(t))return{width:0,height:0};if(ee(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);const{fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:a,limit:l,lineHeight:h}=this.textSpec;let u;try{const d=this._option.getTextBounds({text:t,fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:!!a,maxLineWidth:l||1/0,lineHeight:h});u={width:d.width(),height:d.height()}}catch{this._notSupportVRender=!0,u=this.measureWithNaiveCanvas(t)}return u}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);const i=this._context.measureText(t),{fontSize:r,lineHeight:o}=this.textSpec;return{width:i.width,height:(e=o)!==null&&e!==void 0?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){const e={width:0,height:0};for(let i=0;i<t.length;i++){const r=t[i];let o=this._measureSpecialChar(r);ee(o)&&ed.NUMBERS_CHAR_SET.includes(r)&&(o=this._measureNumberChar()),ee(o)&&["F","W"].includes(t4(r))&&(o=this._measureFullSizeChar()),ee(o)&&(o=this._measureLetterChar()),e.width+=o.width,e.height=Math.max(e.height,o.height),!ee(o.fontBoundingBoxAscent)&&(e.fontBoundingBoxAscent=o.fontBoundingBoxAscent),!ee(o.fontBoundingBoxDescent)&&(e.fontBoundingBoxDescent=o.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){var e;const i={width:0,height:0},{fontSize:r,lineHeight:o}=this.textSpec;for(let s=0;s<t.length;s++){const a=t[s],l=["F","W"].includes(t4(a))?1:.53;i.width+=l*r}return i.height=(e=o)!==null&&e!==void 0?e:r,i}_measureReduce(t,e){var i;const{fontSize:r,lineHeight:o}=this.textSpec,s={width:0,height:0};if(ee(t))return s;if(Ge(t)){const a=t.filter(Tt).map(l=>l.toString());return a.length===0?s:a.length===1?e(a[0]):{width:a.reduce((l,h)=>Math.max(l,e(h).width),0),height:a.length*(((i=o)!==null&&i!==void 0?i:r)+1)+1}}return e(t.toString())}_measureNumberChar(){if(ee(this._numberCharSize)){const t=this._standardMethod(ed.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/ed.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return ee(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(ed.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(ee(this._letterCharSize)){const t=this._standardMethod(ed.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/ed.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return Tt(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){Tt(this._canvas)&&(this._canvas=null),Tt(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}};tg.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",tg.NUMBERS_CHAR_SET="0123456789",tg.FULL_SIZE_CHAR="";const e4=(n,t)=>Math.max(t.x1-n.x2,n.x1-t.x2,t.y1-n.y2,n.y1-t.y2),gPt=(n,t)=>{const e=[{x:Math.cos(n.angle),y:Math.sin(n.angle)},{x:-Math.sin(n.angle),y:Math.cos(n.angle)},{x:Math.cos(t.angle),y:Math.sin(n.angle)},{x:-Math.sin(t.angle),y:Math.cos(n.angle)}];function i(o,s,a){const l=o.getRotatedCorners().map(h=>h.x*s+h.y*a);return{min:Math.min(...l),max:Math.max(...l)}}let r=0;for(const o of e){const s=i(n,o.x,o.y),a=i(t,o.x,o.y);let l;l=s.max<a.min?a.min-s.max:a.max<s.min?s.min-a.max:0,r=Math.max(r,l)}return r};function pPt(n,t,e){const{x1:i,y1:r,x2:o,y2:s}=t;return e.onlyTranslate()?(n!==t&&n.setValue(t.x1,t.y1,t.x2,t.y2),n.translate(e.e,e.f),t):(n.clear(),n.add(e.a*i+e.c*r+e.e,e.b*i+e.d*r+e.f),n.add(e.a*o+e.c*r+e.e,e.b*o+e.d*r+e.f),n.add(e.a*o+e.c*s+e.e,e.b*o+e.d*s+e.f),n.add(e.a*i+e.c*s+e.e,e.b*i+e.d*s+e.f),t)}let pq=class vq{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new vq(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return Ge(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){const r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){const o=this.scalePoints(t,e,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return pPt(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){const{x1:r,y1:o,x2:s,y2:a}=this,l=Math.cos(t),h=Math.sin(t),u=e-e*l+i*h,d=i-e*h-i*l;return[l*r-h*o+u,h*r+l*o+d,l*r-h*a+u,h*r+l*a+d,l*s-h*o+u,h*s+l*o+d,l*s-h*a+u,h*s+l*a+d]}scalePoints(t,e,i,r){const{x1:o,y1:s,x2:a,y2:l}=this;return[t*o+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}},Nm=class extends pq{};function pk(n,t,e){t/=100,e/=100;const i=(1-Math.abs(2*e-1))*t,r=i*(1-Math.abs(n/60%2-1)),o=e-i/2;let s=0,a=0,l=0;return 0<=n&&n<60?(s=i,a=r,l=0):60<=n&&n<120?(s=r,a=i,l=0):120<=n&&n<180?(s=0,a=i,l=r):180<=n&&n<240?(s=0,a=r,l=i):240<=n&&n<300?(s=r,a=0,l=i):300<=n&&n<360&&(s=i,a=0,l=r),s=Math.round(255*(s+o)),a=Math.round(255*(a+o)),l=Math.round(255*(l+o)),{r:s,g:a,b:l}}function eD(n,t,e){n/=255,t/=255,e/=255;const i=Math.min(n,t,e),r=Math.max(n,t,e),o=r-i;let s=0,a=0,l=0;return s=o===0?0:r===n?(t-e)/o%6:r===t?(e-n)/o+2:(n-t)/o+4,s=Math.round(60*s),s<0&&(s+=360),l=(r+i)/2,a=o===0?0:o/(1-Math.abs(2*l-1)),a=+(100*a).toFixed(1),l=+(100*l).toFixed(1),{h:s,s:a,l}}const vPt=/^#([0-9a-f]{3,8})$/,i4={transparent:4294967040},fC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function m_(n){return((n=Math.max(0,Math.min(255,Math.round(n)||0)))<16?"0":"")+n.toString(16)}function mq(n){return jn(n)?new Br(n>>16,n>>8&255,255&n,1):Ge(n)?new Br(n[0],n[1],n[2]):new Br(255,255,255)}function mPt(n){return jn(n)?new Br(n>>>24,n>>>16&255,n>>>8&255,255&n):Ge(n)?new Br(n[0],n[1],n[2],n[3]):new Br(255,255,255,1)}function HR(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function FR(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const n4=(n,t)=>{const e=vPt.exec(n);if(t||e){const i=parseInt(e[1],16),r=e[1].length;return r===3?new Br((i>>8&15)+((i>>8&15)<<4),(i>>4&15)+((i>>4&15)<<4),(15&i)+((15&i)<<4),1):r===6?mq(i):r===8?new Br(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):null}};let gC=class id{static Brighter(t,e=1){return e===1?t:new id(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return e===1?t:new id(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){const i=t instanceof id?t:new id(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3();case"wcag":return i.getLuminanceWCAG()}}static parseColorString(t){if(Tt(i4[t]))return mPt(i4[t]);if(Tt(fC[t]))return mq(fC[t]);const e=`${t}`.trim().toLowerCase(),i=n4(e);if(i!==void 0)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){const r=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Br(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseFloat(r[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){const r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),o=pk(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new Br(o.r,o.g,o.b,parseFloat(r[3]))}}constructor(t){const e=id.parseColorString(t);e?this.color=e:this.color=new Br(255,255,255)}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){const{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){const r=this.color.opacity,o=eD(this.color.r,this.color.g,this.color.b),s=pk(ee(t)?o.h:ho(t,0,360),ee(e)?o.s:e>=0&&e<=1?100*e:e,ee(i)?o.l:i<=1&&i>=0?100*i:i);return this.color=new Br(s.r,s.g,s.b,r),this}setRGB(t,e,i){return!ee(t)&&(this.color.r=t),!ee(e)&&(this.color.g=e),!ee(i)&&(this.color.b=i),this}setHex(t){const e=`${t}`.trim().toLowerCase(),i=n4(e,!0);return i??this}setColorName(t){const e=fC[t.toLowerCase()];return e!==void 0&&this.setHex(e),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){const t=this.color.r/255,e=this.color.g/255,i=this.color.b/255;let r,o,s;return r=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),o=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),s=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),.2126*r+.7152*o+.0722*s}clone(){return new id(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=HR(t.color.r),this.color.g=HR(t.color.g),this.color.b=HR(t.color.b),this}copyLinearToSRGB(t){return this.color.r=FR(t.color.r),this.color.g=FR(t.color.g),this.color.b=FR(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}},Br=class{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),Tt(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${m_(this.r)+m_(this.g)+m_(this.b)+(this.opacity===1?"":m_(255*this.opacity))}`}formatRgb(){const t=this.opacity;return`${t===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${t===1?")":`,${t})`}`}formatHsl(){const t=this.opacity,{h:e,s:i,l:r}=eD(this.r,this.g,this.b);return`${t===1?"hsl(":"hsla("}${e},${i}%,${r}%${t===1?")":`,${t})`}`}toString(){return this.formatHex()}};function yPt(n){let t="",e="",i="";const r=n[0]==="#"?1:0;for(let o=r;o<n.length;o++)n[o]!=="#"&&(o<r+2?t+=n[o]:o<r+4?e+=n[o]:o<r+6&&(i+=n[o]));return[parseInt(t,16),parseInt(e,16),parseInt(i,16)]}function bPt(n,t,e){return Number((1<<24)+(n<<16)+(t<<8)+e).toString(16).slice(1)}function _Pt(n,t){const e=n.r,i=t.r,r=n.g,o=t.g,s=n.b,a=t.b,l=n.opacity,h=t.opacity;return u=>{const d=Math.round(e*(1-u)+i*u),c=Math.round(r*(1-u)+o*u),f=Math.round(s*(1-u)+a*u);return new Br(d,c,f,l*(1-u)+h*u)}}const CPt=Object.freeze(Object.defineProperty({__proto__:null,Color:gC,DEFAULT_COLORS:fC,RGB:Br,hexToRgb:yPt,hslToRgb:pk,interpolateRgb:_Pt,rgbToHex:bPt,rgbToHsl:eD},Symbol.toStringTag,{value:"Module"}));function $a(n){if(Zi(n))return[n,n,n,n];if(Ge(n)){const t=n.length;if(t===1){const e=n[0];return[e,e,e,e]}if(t===2){const[e,i]=n;return[e,i,e,i]}if(t===3){const[e,i,r]=n;return[e,i,r,i]}if(t===4)return n}if(Js(n)){const{top:t=0,right:e=0,bottom:i=0,left:r=0}=n;return[t,e,i,r]}return[0,0,0,0]}const wPt=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class Ro extends ge{constructor(t,e){super(t),this._skipRenderAttributes=wPt,e?.mode&&(this.mode=e.mode,this.setMode(e.mode)),e?.skipDefault&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,i,r){const o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,r);if(o)return this._setAttributes(o,i);A0(this.attribute[t])&&A0(e)&&!zi(this.attribute[t])&&!zi(e)?Wt(this.attribute[t],e):this.attribute[t]=e,this._skipRenderAttributes.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e,i){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,i)||t,this._setAttributes(t,e)}_setAttributes(t,e){const i=Object.keys(t);this._mergeAttributes(t,i),i.every(r=>this._skipRenderAttributes.includes(r))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(i)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){ee(e)&&(e=Object.keys(t));for(let i=0;i<e.length;i++){const r=e[i];!A0(this.attribute[r])||zi(this.attribute[r])||zi(t[r])?this.attribute[r]=t[r]:Wt(this.attribute[r],t[r])}}bindEvents(){}_getNodeId(t){var e;return`${(e=this.id)!==null&&e!==void 0?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var i;const r=new IO(t,e);r.manager=(i=this.stage)===null||i===void 0?void 0:i.eventSystem.manager,this.dispatchEvent(r)}eventPosToStagePos(t){var e,i;const r={x:0,y:0},o=(i=(e=this.stage)===null||e===void 0?void 0:e.eventPointTransform(t))!==null&&i!==void 0?i:{x:0,y:0};return this.globalTransMatrix.transformPoint(o,r),r}}const vu=Symbol.for("MathPickerContribution"),r4=Symbol.for("MathArcPicker"),o4=Symbol.for("MathCirclePicker"),A1=Symbol.for("MathImagePicker"),s4=Symbol.for("MathLinePicker"),a4=Symbol.for("MathPathPicker"),l4=Symbol.for("MathRectPicker"),h4=Symbol.for("MathSymbolPicker"),u4=Symbol.for("MathTextPicker"),d4=Symbol.for("MathPolygonPicker"),c4=Symbol.for("CanvasArcPicker"),f4=Symbol.for("CanvasCirclePicker"),g4=Symbol.for("CanvasImagePicker"),p4=Symbol.for("CanvasLinePicker"),v4=Symbol.for("CanvasPathPicker"),m4=Symbol.for("CanvasRectPicker"),y4=Symbol.for("CanvasSymbolPicker"),b4=Symbol.for("CanvasTextPicker"),_4=Symbol.for("CanvasPolygonPicker"),C4=Symbol.for("CanvasRichTextPicker"),w4=Symbol.for("CanvasGroupPicker"),Qr=Symbol.for("CanvasPickerContribution"),iD=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,xPt=n=>typeof n=="function",zR=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||iD(n,"String")},yq=n=>Array.isArray?Array.isArray(n):iD(n,"Array"),nD=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||iD(n,"Number")},x4=n=>nD(n)&&Number.isFinite(n),SPt=typeof console<"u";function y_(n,t,e){const i=[t].concat([].slice.call(e))}var Ps;(function(n){n[n.None=0]="None",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug"})(Ps||(Ps={}));let bq=class ro{static getInstance(t,e){return ro._instance&&nD(t)?ro._instance.level(t):ro._instance||(ro._instance=new ro(t,e)),ro._instance}static setInstance(t){return ro._instance=t}static setInstanceLevel(t){ro._instance?ro._instance.level(t):ro._instance=new ro(t)}static clearInstance(){ro._instance=null}constructor(t=Ps.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){const e=this._onErrorHandler.findIndex(i=>i===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=Ps.Info}canLogDebug(){return this._level>=Ps.Debug}canLogError(){return this._level>=Ps.Error}canLogWarn(){return this._level>=Ps.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=Ps.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):y_((e=this._method)!==null&&e!==void 0?e:"error","ERROR",t)),this}warn(...t){return this._level>=Ps.Warn&&y_(this._method||"warn","WARN",t),this}info(...t){return this._level>=Ps.Info&&y_(this._method||"log","INFO",t),this}debug(...t){return this._level>=Ps.Debug&&y_(this._method||"log","DEBUG",t),this}};bq._instance=null;const APt=Math.PI,S4=2*Math.PI;function TPt(n){return 180*n/Math.PI}function A4(n,t={},e){e||(e=1);const{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=t.fontWeight,fontSize:s=t.fontSize,fontFamily:a=t.fontFamily}=n;return(i?i+" ":"")+(r?r+" ":"")+(o?o+" ":"")+s*e+"px "+(a||"sans-serif")}function MPt(n,t,e){const{x1:i,y1:r,x2:o,y2:s}=t;return e.onlyTranslate()?(n!==t&&n.setValue(t.x1,t.y1,t.x2,t.y2),n.translate(e.e,e.f),t):(n.clear(),n.add(e.a*i+e.c*r+e.e,e.b*i+e.d*r+e.f),n.add(e.a*o+e.c*r+e.e,e.b*o+e.d*r+e.f),n.add(e.a*o+e.c*s+e.e,e.b*o+e.d*s+e.f),n.add(e.a*i+e.c*s+e.e,e.b*i+e.d*s+e.f),t)}let RPt=class _q{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new _q(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return yq(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){const r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){const o=this.scalePoints(t,e,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return MPt(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){const{x1:r,y1:o,x2:s,y2:a}=this,l=Math.cos(t),h=Math.sin(t),u=e-e*l+i*h,d=i-e*h-i*l;return[l*r-h*o+u,h*r+l*o+d,l*r-h*a+u,h*r+l*a+d,l*s-h*o+u,h*s+l*o+d,l*s-h*a+u,h*s+l*a+d]}scalePoints(t,e,i,r){const{x1:o,y1:s,x2:a,y2:l}=this;return[t*o+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}},rD=class extends RPt{};class Ea{constructor(t=1,e=0,i=0,r=1,o=0,s=0){this.a=t,this.b=e,this.c=i,this.d=r,this.e=o,this.f=s}equalToMatrix(t){return!(this.e!==t.e||this.f!==t.f||this.a!==t.a||this.d!==t.d||this.b!==t.b||this.c!==t.c)}equalTo(t,e,i,r,o,s){return!(this.e!==o||this.f!==s||this.a!==t||this.d!==r||this.b!==e||this.c!==i)}setValue(t,e,i,r,o,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.e=o,this.f=s,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){const t=this.a,e=this.b,i=this.c,r=this.d,o=this.e,s=this.f,a=new Ea,l=t*r-e*i;return a.a=r/l,a.b=-e/l,a.c=-i/l,a.d=t/l,a.e=(i*s-r*o)/l,a.f=-(t*s-e*o)/l,a}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a*e+this.c*i,o=this.b*e+this.d*i,s=this.a*-i+this.c*e,a=this.b*-i+this.d*e;return this.a=r,this.b=o,this.c=s,this.d=a,this}rotateByCenter(t,e,i){const r=Math.cos(t),o=Math.sin(t),s=(1-r)*e+o*i,a=(1-r)*i-o*e,l=r*this.a-o*this.b,h=o*this.a+r*this.b,u=r*this.c-o*this.d,d=o*this.c+r*this.d,c=r*this.e-o*this.f+s,f=o*this.e+r*this.f+a;return this.a=l,this.b=h,this.c=u,this.d=d,this.e=c,this.f=f,this}scale(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this}setScale(t,e){return this.b=this.b/this.a*t,this.c=this.c/this.d*e,this.a=t,this.d=e,this}transform(t,e,i,r,o,s){return this.multiply(t,e,i,r,o,s),this}translate(t,e){return this.e+=this.a*t+this.c*e,this.f+=this.b*t+this.d*e,this}transpose(){const{a:t,b:e,c:i,d:r,e:o,f:s}=this;return this.a=e,this.b=t,this.c=r,this.d=i,this.e=s,this.f=o,this}multiply(t,e,i,r,o,s){const a=this.a,l=this.b,h=this.c,u=this.d,d=a*t+h*e,c=l*t+u*e,f=a*i+h*r,g=l*i+u*r,p=a*o+h*s+this.e,v=l*o+u*s+this.f;return this.a=d,this.b=c,this.c=f,this.d=g,this.e=p,this.f=v,this}interpolate(t,e){const i=new Ea;return i.a=this.a+(t.a-this.a)*e,i.b=this.b+(t.b-this.b)*e,i.c=this.c+(t.c-this.c)*e,i.d=this.d+(t.d-this.d)*e,i.e=this.e+(t.e-this.e)*e,i.f=this.f+(t.f-this.f)*e,i}transformPoint(t,e){const{a:i,b:r,c:o,d:s,e:a,f:l}=this,h=i*s-r*o,u=s/h,d=-r/h,c=-o/h,f=i/h,g=(o*l-s*a)/h,p=-(i*l-r*a)/h,{x:v,y:m}=t;e.x=v*u+m*c+g,e.y=v*d+m*f+p}onlyTranslate(t=1){return this.a===t&&this.b===0&&this.c===0&&this.d===t}clone(){return new Ea(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){const t=this.a,e=this.b,i=this.c,r=this.d,o=t*r-e*i,s={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!==0||e!==0){const a=Math.sqrt(t*t+e*e);s.rotateDeg=e>0?Math.acos(t/a):-Math.acos(t/a),s.scaleX=a,s.scaleY=o/a,s.skewX=(t*i+e*r)/o,s.skewY=0}else if(i!==0||r!==0){const a=Math.sqrt(i*i+r*r);s.rotateDeg=Math.PI/2-(r>0?Math.acos(-i/a):-Math.acos(i/a)),s.scaleX=o/a,s.scaleY=a,s.skewX=0,s.skewY=(t*i+e*r)/o}return s.rotateDeg=TPt(s.rotateDeg),s}}const BPt={onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerUpOutside:"pointerupoutside",onPointerTap:"pointertap",onPointerOver:"pointerover",onPointerMove:"pointermove",onPointerEnter:"pointerenter",onPointerLeave:"pointerleave",onPointerOut:"pointerout",onMouseDown:"mousedown",onMouseUp:"mouseup",onMouseUpOutside:"mouseupoutside",onMouseMove:"mousemove",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onPinch:"pinch",onPinchStart:"pinchstart",onPinchEnd:"pinchend",onPan:"pan",onPanStart:"panstart",onPanEnd:"panend",onDrag:"drag",onDragStart:"dragstart",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragEnd:"dragend",onRightDown:"rightdown",onRightUp:"rightup",onRightUpOutside:"rightupoutside",onTouchStart:"touchstart",onTouchEnd:"touchend",onTouchEndOutside:"touchendoutside",onTouchMove:"touchmove",onTouchCancel:"touchcancel",onPress:"press",onPressUp:"pressup",onPressEnd:"pressend",onSwipe:"swipe",onDrop:"drop",onWeel:"wheel",onClick:"click",onDblClick:"dblclick"},T4=(n,t)=>{const e=t.x-n.x,i=t.y-n.y;return Math.abs(e)>Math.abs(i)?e>0?"right":"left":i>0?"down":"up"},b_=(n,t)=>{const e=Math.abs(t.x-n.x),i=Math.abs(t.y-n.y);return Math.sqrt(e*e+i*i)},PPt=n=>{const t=n.length;if(t===1)return{x:Math.round(n[0].x),y:Math.round(n[0].y)};let e=0,i=0,r=0;for(;r<t;)e+=n[r].x,i+=n[r].y,r++;return{x:Math.round(e/t),y:Math.round(i/t)}};class kPt extends Bc{constructor(t,e={}){var i,r,o,s,a,l,h,u,d,c;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=f=>{this.startTime=Rd.now();const{cachedEvents:g,startPoints:p}=this;f&&g.push(f.clone()),p.length=g.length;for(let v=0;v<g.length;v++){const{x:m,y}=g[v],b={x:m,y};p[v]=b}if(p.length!==1)this.startDistance=b_(p[0],p[1]),this.center=PPt([p[0],p[1]]);else{const v=g[0];this.pressTimeout=setTimeout(()=>{v.direction="none",v.deltaX=0,v.deltaY=0,v.points=p,this.triggerStartEvent("press",v),this.triggerEvent("press",v),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=f=>{this.clearPressTimeout();const{startPoints:g,cachedEvents:p}=this;if(!g.length)return;const v=f.clone(),{x:m,y,pointerId:b}=v;for(let A=0,T=p.length;A<T;A++)if(b===p[A].pointerId){p[A]=v;break}const _={x:m,y},w=p.map(A=>({x:A.x,y:A.y})),C=Rd.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=C,this.lastMovePoint=_,g.length===1){const A=g[0],T=m-A.x,M=y-A.y,R=this.direction||T4(A,_);this.direction=R;const E=this.getEventType(_);return v.direction=R,v.deltaX=T,v.deltaY=M,v.points=w,this.triggerStartEvent(E,v),void this.triggerEvent(E,v)}const{startDistance:x}=this,S=b_(w[0],w[1]);v.scale=S/x,v.center=this.center,v.points=w,this.triggerStartEvent("pinch",v),this.triggerEvent("pinch",v)},this.onEnd=f=>{const g=f.clone(),{cachedEvents:p,startPoints:v}=this,m=p.map(y=>({x:y.x,y:y.y}));if(g.points=m,this.triggerEndEvent(g),p.length===1){const y=Rd.now(),b=this.lastMoveTime;if(y-b<100){const _=b-(this.prevMoveTime||this.startTime);if(_>0){const w=this.prevMovePoint||v[0],C=this.lastMovePoint||v[0],x=b_(w,C),S=x/_;if(S>this.config.swipe.velocity&&x>this.config.swipe.threshold)return g.velocity=S,g.direction=T4(w,C),this.triggerEvent("swipe",g),this.cachedEvents=[],this.startPoints=[],void this.reset()}}y-this.startTime<this.config.press.time&&(y-this.lastTapTime<this.config.tap.interval&&f.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=y,this.lastTapTarget=f.target,this.tapCount===1?this.triggerEvent("tap",g):this.tapCount===2&&(this.triggerEvent("doubletap",g),this.tapCount=0))}for(let y=0,b=p.length;y<b;y++)if(p[y].pointerId===g.pointerId){p.splice(y,1),v.splice(y,1);break}this.reset(),p.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:(r=(i=e?.press)===null||i===void 0?void 0:i.time)!==null&&r!==void 0?r:251,threshold:(s=(o=e?.press)===null||o===void 0?void 0:o.threshold)!==null&&s!==void 0?s:9},swipe:{threshold:(l=(a=e?.swipe)===null||a===void 0?void 0:a.threshold)!==null&&l!==void 0?l:10,velocity:(u=(h=e?.swipe)===null||h===void 0?void 0:h.velocity)!==null&&u!==void 0?u:.3},tap:{interval:(c=(d=e?.tap)===null||d===void 0?void 0:d.interval)!==null&&c!==void 0?c:300}},this.initEvents()}initEvents(){const{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerleave",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){const{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerleave",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){const{eventType:e,startTime:i,startPoints:r}=this;if(e==="press")return e;let o;return o=Rd.now()-i>this.config.press.time&&b_(r[0],t)<this.config.press.threshold?"press":"pan",this.eventType=o,o}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){const{emitThrottles:i}=this,r={type:t,ev:e};for(let o=0,s=i.length;o<s;o++)if(i[o].type===t)return void i.splice(o,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);const{throttleTimer:i,emitThrottles:r}=this;i||(this.throttleTimer=bt.global.getRequestAnimationFrame()(()=>{bt.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let o=0,s=r.length;o<s;o++){const{type:a,ev:l}=r[o];this.emitEvent(a,l)}this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){const e=this.processEvent;Object.keys(e).forEach(i=>{this.triggerEvent(`${i}end`,t),i==="press"&&this.triggerEvent(`${i}up`,t),delete e[i]})}emitEvent(t,e){if(!this.element)return;const i=this.element._events[RK];if(i)if("fn"in i)i.fn.call(i.context,e,t);else for(let r=0,o=i.length;r<o&&!e.propagationImmediatelyStopped;r++)i[r].fn.call(i[r].context,e,t);this.emit(t,e)}}var EPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},LPt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};const se=[0,0,0],OPt=(n,t,e,i,r,o,s,a)=>{if(a)for(;e>t;)e-=S4;else for(;e<t;)e+=S4;const l=APt/3*(e>t?1:-1);let h=t,u=h;for(;u!==e;){u=l>0?Math.min(u+l,e):Math.max(u+l,e);const d=Math.abs(u-h),c=4*Math.tan(d/4)/3,f=u<h?-1:1,g=Math.cos(h),p=Math.sin(h),v=Math.cos(u),m=Math.sin(u),y=g*o+i,b=p*s+r,_=v*o+i,w=m*s+r,C=o*c*f,x=s*c*f;n.push([y-C*p,b+x*g,_+C*m,w-x*v,_,w]),h=u}};let eg=class{set fillStyle(n){this.nativeContext.fillStyle=n}get fillStyle(){return this.nativeContext.fillStyle}set font(n){n!==this._font&&(this._font=n,this.nativeContext.font=n)}get font(){var n;return(n=this._font)!==null&&n!==void 0?n:this.nativeContext.font}set globalAlpha(n){this.nativeContext.globalAlpha=n*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(n){this.nativeContext.lineCap=n}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(n){this.nativeContext.lineDashOffset=n}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(n){this.nativeContext.lineJoin=n}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(n){this.nativeContext.lineWidth=n}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(n){this.nativeContext.miterLimit=n}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(n){this.nativeContext.shadowBlur=n}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(n){this.nativeContext.shadowColor=n}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(n){this.nativeContext.shadowOffsetX=n}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(n){this.nativeContext.shadowOffsetY=n}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(n){this.nativeContext.strokeStyle=n}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(n){this.nativeContext.textAlign=n}get textAlign(){return this.nativeContext.textAlign}set textBaseline(n){this.nativeContext.textBaseline=n}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(n){n!==!!this._inuse&&(this._inuse=n,n?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(n,t){this.fillAttributes=Object.assign(Object.assign({},gK),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},pK),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},$r),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;const e=n.nativeCanvas.getContext("2d");if(!e)throw new Error("2d");this.nativeContext=e,this.canvas=n,this.matrix=new Ea(1,0,0,1,0,0),this.stack=[],this.dpr=t,this.applyedMatrix=new Ea(1,0,0,1,0,0),this._clearMatrix=new Ea(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(n=!0){this.stack.length&&bq.getInstance().warn("bugmatrix"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Ea(1,0,0,1,0,0),this.stack.length=0,n&&this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(n=!1){!n&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(n){return Hn.allocateByObj(n)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(Hn.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0)),this.font="",this._clearFilterStyle=!1,this._clearShadowStyle=!1}highPerformanceRestore(){this.stack.length>0&&(Hn.free(this.matrix),this.matrix=this.stack.pop())}rotate(n,t=!0){this.matrix.rotate(n),t&&this.setTransformForCurrent()}save(){const n=this.cloneMatrix(this.matrix);this.stack.push(n),this.nativeContext.save()}highPerformanceSave(){const n=this.cloneMatrix(this.matrix);this.stack.push(n)}scale(n,t,e=!0){this.matrix.scale(n,t),e&&this.setTransformForCurrent()}setScale(n,t,e=!0){this.matrix.setScale(n,t),e&&this.setTransformForCurrent()}scalePoint(n,t,e,i,r=!0){this.translate(e,i,!1),this.scale(n,t,!1),this.translate(-e,-i,!1),r&&this.setTransformForCurrent()}setTransform(n,t,e,i,r,o,s=!0,a=this.dpr){this.matrix.setValue(a*n,a*t,a*e,a*i,a*r,a*o),s&&this.setTransformForCurrent()}setTransformFromMatrix(n,t=!0,e=this.dpr){this.matrix.setValue(n.a*e,n.b*e,n.c*e,n.d*e,n.e*e,n.f*e),t&&this.setTransformForCurrent()}resetTransform(n=!0,t=this.dpr){this.setTransform(t,0,0,t,0,0),n&&this.setTransformForCurrent()}transform(n,t,e,i,r,o,s=!0){this.matrix.multiply(n,t,e,i,r,o),s&&this.setTransformForCurrent()}transformFromMatrix(n,t){this.matrix.multiply(n.a,n.b,n.c,n.d,n.e,n.f),t&&this.setTransformForCurrent()}translate(n,t,e=!0){this.matrix.translate(n,t),e&&this.setTransformForCurrent()}rotateDegrees(n,t=!0){const e=n*Math.PI/180;this.rotate(e,t)}rotateAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotate(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}rotateDegreesAbout(n,t,e,i=!0){this.translate(t,e,!1),this.rotateDegrees(n,!1),this.translate(-t,-e,!1),i&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(n,t){n?typeof n=="string"?this.nativeContext.clip(n):this.nativeContext.clip(n,t):this.nativeContext.clip()}arc(n,t,e,i,r,o,s){if(s=s||0,this.camera){const a=[];OPt(a,i,r,n,t,e,e,o);for(let l=0;l<a.length;++l){const h=a[l];this.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5],s)}}else this.nativeContext.arc(n,t,Math.max(0,e),i,r,o)}arcTo(n,t,e,i,r){this.nativeContext.arcTo(n,t,e,i,r)}bezierCurveTo(n,t,e,i,r,o,s){if(s=s||0,this.camera){let a=s,l=s;this.modelMatrix&&(xs(se,[n,t,s],this.modelMatrix),n=se[0],t=se[1],a=se[2],xs(se,[e,i,s],this.modelMatrix),e=se[0],i=se[1],l=se[2],xs(se,[r,o,s],this.modelMatrix),r=se[0],o=se[1],s=se[2]);let h=this.camera.vp(r,o,s);r=h.x,o=h.y,h=this.camera.vp(n,t,a),n=h.x,t=h.y,h=this.camera.vp(e,i,l),e=h.x,i=h.y}this.nativeContext.bezierCurveTo(n,t,e,i,r,o)}closePath(){this.nativeContext.closePath()}ellipse(n,t,e,i,r,o,s,a){a==null?this.nativeContext.ellipse(n,t,e,i,r,o,s):this.nativeContext.ellipse(n,t,e,i,r,o,s,a)}lineTo(n,t,e){if(e=e||0,this.camera){this.modelMatrix&&(xs(se,[n,t,e],this.modelMatrix),n=se[0],t=se[1],e=se[2]);const i=this.camera.vp(n,t,e);n=i.x,t=i.y}this.nativeContext.lineTo(n,t)}moveTo(n,t,e){if(e=e||0,this.camera){this.modelMatrix&&(xs(se,[n,t,e],this.modelMatrix),n=se[0],t=se[1],e=se[2]);const i=this.camera.vp(n,t,e);n=i.x,t=i.y}this.nativeContext.moveTo(n,t)}quadraticCurveTo(n,t,e,i,r){if(r=r||0,this.camera){let o=r;this.modelMatrix&&(xs(se,[n,t,r],this.modelMatrix),n=se[0],t=se[1],o=se[2],xs(se,[e,i,r],this.modelMatrix),e=se[0],i=se[1],r=se[2]);let s=this.camera.vp(e,i,r);e=s.x,i=s.y,s=this.camera.vp(n,t,o),n=s.x,t=s.y}this.nativeContext.quadraticCurveTo(n,t,e,i)}rect(n,t,e,i,r){r=r||0,this.camera?(this.moveTo(n,t,r),this.lineTo(n+e,t,r),this.lineTo(n+e,t+i,r),this.lineTo(n,t+i,r),this.closePath()):this.nativeContext.rect(n,t,e,i)}createImageData(){const n=arguments;return n.length===2?this.nativeContext.createImageData(n[0],n[1]):n.length===1?this.nativeContext.createImageData(n[0]):null}createLinearGradient(n,t,e,i){return isFinite(n+t+e+i)||(n=0,t=0,e=0,i=0),this.nativeContext.createLinearGradient(n,t,e,i)}createPattern(n,t){return n.width===0||n.height===0?null:this.nativeContext.createPattern(n,t)}createRadialGradient(n,t,e,i,r,o){return this.nativeContext.createRadialGradient(n,t,e,i,r,o)}createConicGradient(n,t,e,i){if(this.nativeContext.createConicGradient&&Math.abs(i-e-2*Math.PI)<.001)return this.nativeContext.createConicGradient(e,n,t);let r,o=!1;const s=this;return{stops:[],addColorStop(a,l){this.stops.push([a,l]),o=!0},GetPattern(a,l,h){return o&&(h||(h=i-e),r=HMt(s,this.stops,n,t,h,e,i,a,l),o=!1),r}}}fill(n,t){this.disableFill||(n?this.nativeContext.fill(n):this.nativeContext.fill())}fillRect(n,t,e,i){this.nativeContext.fillRect(n,t,e,i)}clearRect(n,t,e,i){this.nativeContext.clearRect(n,t,e,i)}project(n,t,e){if(e=e||0,this.camera){this.modelMatrix&&(xs(se,[n,t,e],this.modelMatrix),n=se[0],t=se[1],e=se[2]);const i=this.camera.vp(n,t,e);n=i.x,t=i.y}return{x:n,y:t}}view(n,t,e){return e=e||0,this.camera?(this.modelMatrix&&(xs(se,[n,t,e],this.modelMatrix),n=se[0],t=se[1],e=se[2]),this.camera.view(n,t,e)):[n,t,e]}fillText(n,t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(xs(se,[t,e,i],this.modelMatrix),t=se[0],e=se[1],i=se[2]);const r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.fillText(n,t,e)}getImageData(n,t,e,i){return this.nativeContext.getImageData(n,t,e,i)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(n,t){return this.nativeContext.isPointInPath(n,t)}isPointInStroke(n,t){return this.nativeContext.isPointInStroke(n,t)}measureText(n,t=bt.global.measureTextMethod){var e,i;if(!t||t==="native")return this.nativeContext.measureText(n);this.mathTextMeasure||(this.mathTextMeasure=bt.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));const r=(e=this.fontFamily)!==null&&e!==void 0?e:$r.fontFamily,o=(i=this.fontSize)!==null&&i!==void 0?i:$r.fontSize;return this.mathTextMeasure.textSpec.fontFamily===r&&this.mathTextMeasure.textSpec.fontSize===o||(this.mathTextMeasure.textSpec.fontFamily=r,this.mathTextMeasure.textSpec.fontSize=o,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(n,t)}putImageData(n,t,e){this.nativeContext.putImageData(n,t,e)}setLineDash(n){const t=arguments,e=this.nativeContext;this.nativeContext.setLineDash?t[0]&&e.setLineDash(t[0]):"mozDash"in e?e.mozDash=t[0]:"webkitLineDash"in e&&(e.webkitLineDash=t[0])}stroke(n){this.disableStroke||(n?this.nativeContext.stroke(n):this.nativeContext.stroke())}strokeRect(n,t,e,i){this.nativeContext.strokeRect(n,t,e,i)}strokeText(n,t,e,i){if(i=i||0,this.camera){this.modelMatrix&&(xs(se,[t,e,i],this.modelMatrix),t=se[0],e=se[1],i=se[2]);const r=this.camera.vp(t,e,i);t=r.x,e=r.y}this.nativeContext.strokeText(n,t,e)}drawImage(){const n=this.nativeContext,t=arguments;t.length===3?n.drawImage(t[0],t[1],t[2]):t.length===5?n.drawImage(t[0],t[1],t[2],t[3],t[4]):t.length===9&&n.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}setCommonStyle(n,t,e,i,r){if(Array.isArray(r)){if(r.length<=1)return this._setCommonStyle(n,t,e,i,r[0]);const o=Object.create(r[0]);return r.forEach((s,a)=>{a!==0&&Object.assign(o,s)}),this._setCommonStyle(n,t,e,i,o)}return this._setCommonStyle(n,t,e,i,r)}_setCommonStyle(n,t,e,i,r){const o=this.nativeContext;r||(r=this.fillAttributes);const{fillOpacity:s=r.fillOpacity,opacity:a=r.opacity,fill:l=r.fill}=t;o.globalAlpha=s*a*this.baseGlobalAlpha,s>1e-12&&a>1e-12&&(o.fillStyle=Vw(this,l,n,e,i))}setShadowBlendStyle(n,t,e){if(Array.isArray(e)){if(e.length<=1)return this._setShadowBlendStyle(n,e[0]);const i=Object.create(e[0]);return e.forEach((r,o)=>{o!==0&&Object.assign(i,r)}),this._setShadowBlendStyle(n,t,i)}return this._setShadowBlendStyle(n,t,e)}_setShadowBlendStyle(n,t,e){const i=this.nativeContext;e||(e=this.fillAttributes);const{opacity:r=e.opacity,shadowBlur:o=e.shadowBlur,shadowOffsetX:s=e.shadowOffsetX,shadowOffsetY:a=e.shadowOffsetY,blur:l=e.blur,globalCompositeOperation:h=e.globalCompositeOperation}=t;if(!(r<=1e-12)){if(s||a||o){const{shadowColor:u=e.shadowColor,shadowOffsetX:d=e.shadowOffsetX,shadowOffsetY:c=e.shadowOffsetY}=t;i.shadowBlur=o*this.dpr,i.shadowColor=u,i.shadowOffsetX=d*this.dpr,i.shadowOffsetY=c*this.dpr,this._clearShadowStyle=!0}else this._clearShadowStyle&&(i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0);l?(i.filter=`blur(${l}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(i.filter="blur(0px)",this._clearFilterStyle=!1),h?(i.globalCompositeOperation=h,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(i.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1)}}setStrokeStyle(n,t,e,i,r){if(Array.isArray(r)){if(r.length<=1)return this._setStrokeStyle(n,t,e,i,r[0]);const o=Object.create(r[0]);return r.forEach((s,a)=>{a!==0&&Object.assign(o,s)}),this._setStrokeStyle(n,t,e,i,o)}return this._setStrokeStyle(n,t,e,i,r)}_setStrokeStyle(n,t,e,i,r){const o=this.nativeContext;r||(r=this.strokeAttributes);const{strokeOpacity:s=r.strokeOpacity,opacity:a=r.opacity}=t;if(o.globalAlpha=s*a*this.baseGlobalAlpha,s>1e-12&&a>1e-12){const{lineWidth:l=r.lineWidth,stroke:h=r.stroke,lineJoin:u=r.lineJoin,lineDash:d=r.lineDash,lineDashOffset:c=r.lineDashOffset,lineCap:f=r.lineCap,miterLimit:g=r.miterLimit,keepStrokeScale:p=r.keepStrokeScale}=t;o.lineWidth=p?l:Ka(this,l,this.dpr),o.strokeStyle=Vw(this,h,n,e,i),o.lineJoin=u,d&&(o.setLineDash(d),o.lineDashOffset=c),o.lineCap=f,o.miterLimit=g}}setTextStyleWithoutAlignBaseline(n,t,e){const i=this.nativeContext;t||(t=this.textAttributes);const{scaleIn3d:r=t.scaleIn3d}=n;n.font?this.font=n.font:this.font=A4(n,t,r&&this.camera&&this.camera.getProjectionScale(e));const{fontFamily:o=t.fontFamily,fontSize:s=t.fontSize}=n;this.fontFamily=o,this.fontSize=s,i.textAlign="left",i.textBaseline="alphabetic"}setTextStyle(n,t,e){var i,r;const o=this.nativeContext;t||(t=this.textAttributes),n.font?this.font=n.font:this.font=A4(n,t,this.camera&&this.camera.getProjectionScale(e));const{fontFamily:s=t.fontFamily,fontSize:a=t.fontSize}=n;this.fontFamily=s,this.fontSize=a,o.textAlign=(i=n.textAlign)!==null&&i!==void 0?i:t.textAlign,o.textBaseline=(r=n.textBaseline)!==null&&r!==void 0?r:t.textBaseline}draw(){}clearMatrix(n=!0,t=this.dpr){this.setTransformFromMatrix(this._clearMatrix,n,t)}setClearMatrix(n,t,e,i,r,o){this._clearMatrix.setValue(n,t,e,i,r,o)}onlyTranslate(n=this.dpr){return this.matrix.a===n&&this.matrix.b===0&&this.matrix.c===0&&this.matrix.d===n}release(...n){this.stack.forEach(t=>Hn.free(t)),this.stack.length=0}};eg.env="browser",eg=EPt([yt(),LPt("design:paramtypes",[Object,Number])],eg);var DPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},IPt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let ig=class extends GO{constructor(n){super(n)}init(n){const{container:t}=n;if(typeof t=="string"){const e=bt.global.getElementById(t);e&&(this._container=e)}else this._container=t;this._context=new eg(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;const{nativeCanvas:n}=this;n.width=this._pixelWidth,n.height=this._pixelHeight,!n.style||this.setCanvasStyle(n,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(n),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){const n=this._nativeCanvas;n.style.position="absolute",n.style.top=`${this._y}px`,n.style.left=`${this._x}px`}resetStyle(n){if(!this.controled)return;const{width:t=this._displayWidth,height:e=this._displayHeight,dpr:i=this._dpr,x:r=this._x,y:o=this._y}=n,{nativeCanvas:s}=this;s.width=t*i,s.height=e*i,!s.style||this.setCanvasStyle(s,r,o,t,e),n.id&&(s.id=n.id),this.visiable||this.hide()}setCanvasStyle(n,t,e,i,r){this.controled&&(n.style.width=`${i}px`,n.style.height=`${r}px`)}toDataURL(n,t){return n==="image/jpeg"?this._nativeCanvas.toDataURL(n,t):n==="image/png"?this._nativeCanvas.toDataURL(n):this._nativeCanvas.toDataURL(n,t)}resize(n,t){this.controled&&(this._pixelWidth=n*this._dpr,this._pixelHeight=t*this._dpr,this._displayWidth=n,this._displayHeight=t,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${n}px`,this._nativeCanvas.style.height=`${t}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};ig.env="browser",ig=DPt([yt(),IPt("design:paramtypes",[Object])],ig);function Cq(n,t){return new Ut(e=>{e(CK).toDynamicValue(()=>i=>new n(i)).whenTargetNamed(n.env),e(kAt).toDynamicValue(()=>(i,r)=>new t(i,r)).whenTargetNamed(t.env)})}const HPt=Cq(ig,eg);var FPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},zPt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},$u=function(n,t){return function(e,i){t(e,i,n)}};let Of=class extends dk{constructor(n,t,e,i){super(e,i),this.contributions=n,this.drawContribution=t,this.pickItemInterceptorContributions=e,this.pickServiceInterceptorContributions=i,this.global.hooks.onSetEnv.tap("canvas-picker-service",(r,o,s)=>{this.configure(s,o)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(n=>{this.pickerMap.set(n.numberType,n)}),super._init()}configure(n,t){this.pickCanvas=jd.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(n,t,e,i){if(n.attribute.pickable===!1)return null;if(this.InterceptorContributions.length)for(let l=0;l<this.InterceptorContributions.length;l++){const h=this.InterceptorContributions[l];if(h.beforePickItem){const u=h.beforePickItem(n,this,t,i,{parentMatrix:e});if(u)return u}}const r=this.pickerMap.get(n.numberType);if(!r)return null;const o=r.contains(n,t,i),s=o?n:null,a={graphic:s,params:o};if(s)return a;if(this.InterceptorContributions.length)for(let l=0;l<this.InterceptorContributions.length;l++){const h=this.InterceptorContributions[l];if(h.afterPickItem){const u=h.afterPickItem(n,this,t,i,{parentMatrix:e});if(u)return u}}return a}};Of=FPt([yt(),$u(0,le(Wi)),$u(0,mn(Qr)),$u(1,le(qO)),$u(2,le(Wi)),$u(2,mn(Pf)),$u(3,le(Wi)),$u(3,mn(d1)),zPt("design:paramtypes",[Object,Object,Object,Object])],Of);var NPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let vk=class{constructor(){this.type="group",this.numberType=FO}contains(n,t,e){return!1}};vk=NPt([yt()],vk);const T1=new Ut((n,t,e,i)=>{T1.__vloaded||(T1.__vloaded=!0,n(w4).to(vk).inSingletonScope(),n(Qr).toService(w4),tr(n,Qr))});T1.__vloaded=!1;const WPt=new Ut((n,t,e,i)=>{e(Of)||n(Of).toSelf().inSingletonScope(),e(Qf)?i(Qf).toService(Of):n(Qf).toService(Of)});function VPt(n){n.load(T1),n.load(WPt)}var Xv,GPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},$Pt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let Th=Xv=class extends _1{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${Xv.idprefix}_${Xv.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=bt.global,this.viewBox=new rD,this.modelMatrix=new Ea(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(n){n.canvas?this.createWindowByCanvas(n):this.createWindowByConfig(n),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch{}}isElementVisible(n){const t=n.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight;return!(t.right<0||t.bottom<0||t.left>e||t.top>i)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);const n=new IntersectionObserver((t,e)=>{t.forEach(i=>{this._canvasIsIntersecting!==i.isIntersecting?(this._canvasIsIntersecting=i.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(i.isIntersecting)):this._canvasIsIntersecting=i.isIntersecting})});n&&n.observe(this.canvas.nativeCanvas)}createWindowByConfig(n){const t=this.global.createCanvas({width:n.width,height:n.height});let e;if(e=typeof n.container=="string"?this.global.getElementById(n.container):n.container?n.container:this.global.getRootElement(),!e)throw new Error("containerId");n.offscreen?e=null:e.appendChild(t);const i={width:n.width,height:n.height,dpr:n.dpr,nativeCanvas:t,container:e,id:Xv.GenerateCanvasId(),canvasControled:!0};this.canvas=new ig(i)}createWindowByCanvas(n){var t;let e;if(typeof n.canvas=="string"){if(e=this.global.getElementById(n.canvas),!e)throw new Error("canvasId canvasdom")}else e=n.canvas;if(!e)throw new Error("canvas");let i=n.width,r=n.height;if(i==null||r==null||!n.canvasControled){const s=e.getBoundingClientRect();i=s.width,r=s.height}let o=n.dpr;o==null&&(o=(t=e.getContext("2d").pixelRatio)!==null&&t!==void 0?t:e.width/i),this.canvas=new ig({width:i,height:r,dpr:o,nativeCanvas:e,canvasControled:n.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(n,t){this.canvas.resize(n,t)}setDpr(n){this.canvas.dpr=n}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(n,t,e){return this.canvas.nativeCanvas.addEventListener(n,t,e)}removeEventListener(n,t,e){return this.canvas.nativeCanvas.removeEventListener(n,t,e)}dispatchEvent(n){return this.canvas.nativeCanvas.dispatchEvent(n)}getStyle(){var n;return(n=this.canvas.nativeCanvas.style)!==null&&n!==void 0?n:{}}setStyle(n){this.canvas.nativeCanvas.style=n}getBoundingClientRect(){const n=this.canvas.nativeCanvas,t=this.getWH();return n.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(n){const t=this.viewBox,e=this.getContext(),i=this.getDpr();e.nativeContext.save(),e.nativeContext.setTransform(i,0,0,i,0,0),e.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),n&&(e.fillStyle=n,e.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),e.nativeContext.restore()}isVisible(n){return this._canvasIsIntersecting}onVisibleChange(n){this._onVisibleChangeCb=n}getTopLeft(n){return this.global.getElementTopLeft(this.canvas.nativeCanvas,n)}};Th.env="browser",Th.idprefix="visactor_window",Th.prefix_count=0,Th=Xv=GPt([yt(),$Pt("design:paramtypes",[])],Th);const jPt=new Ut(n=>{n(Th).toSelf(),n(DO).toDynamicValue(t=>t.container.get(Th)).whenTargetNamed(Th.env)});var UPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},XPt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},YPt=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};class KPt{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function M4(n,t=!1){const e=document.createElement("img");if(bt.global.isImageAnonymous&&(e.crossOrigin="anonymous"),t){const i=new Blob([n],{type:"image/svg+xml"});n=window.URL.createObjectURL(i)}return e.src=n,e.complete?Promise.resolve(e):new Promise((i,r)=>{e.onload=()=>{i(e)},e.onerror=()=>{r(new Error(""))}})}let M1=class extends b1{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch{this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(n,t){var e,i;let r=0,o=0,s=0,a=0;if(n.changedTouches){const l=(e=n.changedTouches[0])!==null&&e!==void 0?e:{};r=l.clientX||0,o=l.clientY||0,s=r,a=o}else r=n.clientX||0,o=n.clientY||0,s=n.offsetX||0,a=n.offsetY||0;if(t){const l=r,h=o,u=t.getBoundingClientRect(),d=(i=t.getNativeHandler)===null||i===void 0?void 0:i.call(t).nativeCanvas;let c,f;return d&&(c=u.width/d.offsetWidth,f=u.height/d.offsetHeight),{x:(l-u.left)/(x4(c)?c:1),y:(h-u.top)/(x4(f)?f:1)}}return{x:s,y:a}}getNativeAABBBounds(n){let t=n;if(typeof n=="string"&&(t=new DOMParser().parseFromString(n,"text/html").firstChild,t.lastChild&&(t=t.lastChild.firstChild)),t.getBoundingClientRect){const e=t.getBoundingClientRect();return new KPt(e)}return new rD}removeDom(n){return n.parentElement.removeChild(n),!0}updateDom(n,t){const{width:e,height:i,style:r}=t;return r&&(zR(r)?n.setAttribute("style",r):Object.keys(r).forEach(o=>{n.style[o]=r[o]})),e!=null&&(n.style.width=`${e}px`),i!=null&&(n.style.height=`${i}px`),!0}createDom(n){const{tagName:t="div",parent:e}=n,i=document.createElement(t);if(this.updateDom(i,n),e){const r=zR(e)?this.getElementById(e):e;r&&r.appendChild&&r.appendChild(i)}return i}loadImage(n){return M4(n,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(n){return M4(n,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(n){var t,e;const i=document.createElement("canvas");n.id&&(i.id=(t=n.id)!==null&&t!==void 0?t:nn.GenAutoIncrementId().toString());const r=(e=n.dpr)!==null&&e!==void 0?e:window.devicePixelRatio;return n.width&&n.height&&(i.style.width=`${n.width}px`,i.style.height=`${n.height}px`,i.width=n.width*r,i.height=n.height*r),i}createOffscreenCanvas(n){var t;const e=(t=n.dpr)!==null&&t!==void 0?t:window.devicePixelRatio;return new OffscreenCanvas(n.width*e,n.height*e)}releaseCanvas(n){let t;t=typeof n=="string"?document.getElementById(n):n,t&&t.parentElement&&t.parentElement.removeChild(t)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(n,t,e){return document.addEventListener(n,t,e)}removeEventListener(n,t,e){return document.removeEventListener(n,t,e)}dispatchEvent(n){return document.dispatchEvent(n)}getElementById(n){return document.getElementById(n)}getRootElement(){return document.body}getDocument(){return document}release(...n){}getElementTop(n,t){let e=n.offsetTop,i=n.offsetParent;for(;i!==null;)e+=i.offsetTop,i=i.offsetParent;return e}getElementLeft(n,t){let e=n.offsetLeft,i=n.offsetParent;for(;i!==null;)e+=i.offsetLeft,i=i.offsetParent;return e}getElementTopLeft(n,t){let e=n.offsetTop,i=n.offsetLeft,r=n.offsetParent;for(;r!==null;)e+=r.offsetTop,i+=r.offsetLeft,r=r.offsetParent;return{top:e,left:i}}loadFont(n,t,e){return YPt(this,void 0,void 0,function*(){return new FontFace(n,zR(t)?`url(${t})`:t,e).load().then(function(i){return document.fonts.add(i),{loadState:"success"}}).catch(function(i){return{loadState:"fail"}})})}isMacOS(){if(this._isMacOS===void 0)try{this._isMacOS=navigator.platform.toUpperCase().indexOf("MAC")>=0}catch{this._isMacOS=!1}return this._isMacOS}copyToClipBoard(n){return navigator.clipboard.writeText(n).then(()=>{}).catch(t=>{})}};M1=UPt([yt(),XPt("design:paramtypes",[])],M1);const R1=new Ut(n=>{R1.isBrowserBound||(R1.isBrowserBound=!0,n(M1).toSelf().inSingletonScope(),n(QS).toService(M1))});R1.isBrowserBound=!1;function B1(n,t=!0){B1.__loaded||(B1.__loaded=!0,n.load(R1),n.load(HPt),n.load(jPt),t&&VPt(n))}B1.__loaded=!1;class Za{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise"||!this.canvasRenderer)return!0;const{pickContext:r}=i??{};if(!r)return!1;const o=t.getGraphicTheme();r.highPerformanceSave();let{x:s=o.x,y:a=o.y}=t.attribute;if(t.transMatrix.onlyTranslate()){const u=t.getOffsetXY(o);s+=u.x,a+=u.y,r.setTransformForCurrent()}else s=0,a=0,r.transformFromMatrix(t.transMatrix,!0);let l=!1,h=!1;return this.canvasRenderer.drawShape(t,r,s,a,{},null,(u,d,c,f)=>!(!l&&!h)||(l=u.isPointInPath(e.x,e.y),h=f||h,l),(u,d,c,f)=>{if(l||h)return!0;const g=d.lineWidth||c.lineWidth,p=d.pickStrokeBuffer||c.pickStrokeBuffer,v=d.keepStrokeScale||c.keepStrokeScale;return r.lineWidth=v?g+p:Ka(r,g+p,r.dpr),l=u.isPointInStroke(e.x,e.y),h=f||h,l}),r.highPerformanceRestore(),l}}var qPt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},ZPt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},JPt=function(n,t){return function(e,i){t(e,i,n)}};let mk=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="arc",this.numberType=nA}};mk=qPt([yt(),JPt(0,le(n1)),ZPt("design:paramtypes",[Object])],mk);let R4=!1;const QPt=new Ut((n,t,e,i)=>{R4||(R4=!0,n(r4).to(mk).inSingletonScope(),n(vu).toService(r4))});var tkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},ekt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},ikt=function(n,t){return function(e,i){t(e,i,n)}};let yk=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="circle",this.numberType=rA}};yk=tkt([yt(),ikt(0,le(r1)),ekt("design:paramtypes",[Object])],yk);let B4=!1;const nkt=new Ut((n,t,e,i)=>{B4||(B4=!0,n(o4).to(yk).inSingletonScope(),n(vu).toService(o4))});var rkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let np=class{constructor(){this.type="image",this.numberType=oA}contains(n,t,e){const{pickContext:i}=e??{};return!!i&&!!n.AABBBounds.containsPoint(t)}};np=rkt([yt()],np);let P4=!1;const okt=new Ut((n,t,e,i)=>{P4||(P4=!0,n(A1).to(np).inSingletonScope(),n(np).toService(A1))});var skt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},akt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},lkt=function(n,t){return function(e,i){t(e,i,n)}};let bk=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="line",this.numberType=My}};bk=skt([yt(),lkt(0,le(o1)),akt("design:paramtypes",[Object])],bk);let k4=!1;const hkt=new Ut((n,t,e,i)=>{k4||(k4=!0,n(s4).to(bk).inSingletonScope(),n(vu).toService(s4))});var ukt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},dkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},ckt=function(n,t){return function(e,i){t(e,i,n)}};let _k=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="polygon",this.numberType=aA}};_k=ukt([yt(),ckt(0,le(a1)),dkt("design:paramtypes",[Object])],_k);let E4=!1;const fkt=new Ut((n,t,e,i)=>{E4||(E4=!0,n(d4).to(_k).inSingletonScope(),n(vu).toService(d4))});var gkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},pkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},vkt=function(n,t){return function(e,i){t(e,i,n)}};let Ck=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="path",this.numberType=sA}};Ck=gkt([yt(),vkt(0,le(s1)),pkt("design:paramtypes",[Object])],Ck);let L4=!1;const mkt=new Ut((n,t,e,i)=>{L4||(L4=!0,n(a4).to(Ck).inSingletonScope(),n(vu).toService(a4))}),NR=new rD;class wq{constructor(){this.type="rect",this.numberType=zO}contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:r}=i??{};if(!r)return!1;const o=t.getGraphicTheme(),{cornerRadius:s=o.cornerRadius}=t.attribute;let{x:a=o.x,y:l=o.y}=t.attribute;r.highPerformanceSave();let h=!0;if(t.transMatrix.onlyTranslate()){const d=t.getOffsetXY(o);a+=d.x,l+=d.y,r.setTransformForCurrent()}else a=0,l=0,h=!1,r.transformFromMatrix(t.transMatrix,!0);let u=!0;if(!h||t.shadowRoot||nD(s,!0)&&s!==0||yq(s)&&s.some(d=>d!==0))u=!1,this.canvasRenderer.drawShape(t,r,a,l,{},null,(d,c,f)=>!!u||(u=d.isPointInPath(e.x,e.y),u),(d,c,f)=>{if(u)return!0;const g=c.lineWidth||f.lineWidth,p=c.pickStrokeBuffer||f.pickStrokeBuffer,v=c.keepStrokeScale||f.keepStrokeScale;return r.lineWidth=v?g+p:Ka(r,g+p,r.dpr),u=d.isPointInStroke(e.x,e.y),u});else{const{fill:d=o.fill,stroke:c=o.stroke,lineWidth:f=o.lineWidth}=t.attribute;if(d)u=!0;else if(c){const g=t.AABBBounds;NR.setValue(g.x1,g.y1,g.x2,g.y2),NR.expand(-f/2),u=!NR.containsPoint(e)}}return r.highPerformanceRestore(),u}}var ykt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},bkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},_kt=function(n,t){return function(e,i){t(e,i,n)}};let wk=class extends wq{constructor(n){super(),this.canvasRenderer=n}};wk=ykt([yt(),_kt(0,le(l1)),bkt("design:paramtypes",[Object])],wk);let O4=!1;const Ckt=new Ut((n,t,e,i)=>{O4||(O4=!0,n(l4).to(wk).inSingletonScope(),n(vu).toService(l4))});let D4=!1;const wkt=new Ut((n,t,e,i)=>{D4||(D4=!0,n(A1).to(np).inSingletonScope(),n(np).toService(A1))});var xkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Skt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Akt=function(n,t){return function(e,i){t(e,i,n)}};let xk=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="symbol",this.numberType=lA}};xk=xkt([yt(),Akt(0,le(h1)),Skt("design:paramtypes",[Object])],xk);let I4=!1;const Tkt=new Ut((n,t,e,i)=>{I4||(I4=!0,n(h4).to(xk).inSingletonScope(),n(vu).toService(h4))});var Mkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Sk=class{constructor(){this.type="text",this.numberType=hA}contains(n,t,e){return!!n.AABBBounds.containsPoint(t)}};Sk=Mkt([yt()],Sk);let H4=!1;const Rkt=new Ut((n,t,e,i)=>{H4||(H4=!0,n(u4).to(Sk).inSingletonScope(),n(vu).toService(u4))});var Bkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Pkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let T0=class extends eg{constructor(n,t){super(n,t);const e=n.nativeCanvas.getContext("2d");if(!e)throw new Error("2d");this.nativeContext=e,this.canvas=n,this.matrix=new Ea(1,0,0,1,0,0),this.stack=[],this.dpr=t??1}release(...n){}};T0.env="node",T0=Bkt([yt(),Pkt("design:paramtypes",[Object,Number])],T0);var kkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Ekt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)};let ng=class extends GO{constructor(n){super(n)}init(){this._context=new T0(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...n){this._nativeCanvas.release&&xPt(this._nativeCanvas.release)&&this._nativeCanvas.release()}};ng.env="node",ng=kkt([yt(),Ekt("design:paramtypes",[Object])],ng);const Lkt=Cq(ng,T0);var Okt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Dkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Ikt=function(n,t){return function(e,i){t(e,i,n)}};let rg=class extends _1{get container(){return null}constructor(n){super(),this.global=n,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(n){n.canvas?this.createWindowByCanvas(n):this.createWindowByConfig(n)}createWindowByConfig(n){const t=this.global.createCanvas({width:n.width,height:n.height}),e={width:n.width,height:n.height,dpr:n.dpr,nativeCanvas:t,id:nn.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new ng(e)}createWindowByCanvas(n){var t;const e=n.canvas,i=(t=n.dpr)!==null&&t!==void 0?t:1;let r=n.width,o=n.height;r!=null&&o!=null&&n.canvasControled||(r=e.width/i,o=e.height/i),this.canvas=new ng({width:r,height:o,dpr:i,nativeCanvas:e,canvasControled:n.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(n,t){this.canvas.resize(n,t)}setDpr(n){this.canvas.dpr=n}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(n="image/png"){return this.canvas.nativeCanvas.toBuffer(n)}addEventListener(n,t,e){}dispatchEvent(n){return!0}removeEventListener(n,t,e){}getStyle(){}setStyle(n){}getBoundingClientRect(){return null}clearViewBox(n){}};rg.env="node",rg=Okt([yt(),Ikt(0,le(RO)),Dkt("design:paramtypes",[Object])],rg);const Hkt=new Ut(n=>{n(rg).toSelf(),n(DO).toDynamicValue(t=>t.container.get(rg)).whenTargetNamed(rg.env)});var Fkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let P1=class extends b1{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(n,t){n.env===this.type&&(n.setActiveEnvContribution(this),this.pkg=t)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(n){const t=fetch(n).then(e=>e.json());return t.then(e=>({data:e,state:"success"})).catch(()=>({data:null,state:"fail"})),t}loadArrayBuffer(n){return fetch(n).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(n){const{loadImage:t}=this.pkg;return t?t(n).then(e=>({loadState:e?"success":"fail",data:e})).catch(()=>({loadState:"fail",data:null})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}loadSvg(n){const t=this.pkg.Resvg;if(!t)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));const e=new t(n).render().asPng();return this.loadImage(e)}createCanvas(n){return this.pkg.createCanvas(n.width,n.height)}releaseCanvas(n){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(n){return R5.call(n)}}getCancelAnimationFrame(){return n=>{R5.clear(n)}}addEventListener(n,t,e){}removeEventListener(n,t,e){}getElementById(n){return null}getRootElement(){return null}dispatchEvent(n){}release(...n){}createOffscreenCanvas(n){}};P1=Fkt([yt()],P1);const k1=new Ut(n=>{k1.isNodeBound||(k1.isNodeBound=!0,n(P1).toSelf().inSingletonScope(),n(QS).toService(P1))});k1.isNodeBound=!1;function E1(n,t=!0){E1.__loaded||(E1.__loaded=!0,n.load(k1),n.load(Lkt),n.load(Hkt))}E1.__loaded=!1;var zkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Nkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Wkt=function(n,t){return function(e,i){t(e,i,n)}};let Ak=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="arc",this.numberType=nA}};Ak=zkt([yt(),Wkt(0,le(n1)),Nkt("design:paramtypes",[Object])],Ak);let F4=!1;const Vkt=new Ut((n,t,e,i)=>{F4||(F4=!0,n(c4).to(Ak).inSingletonScope(),n(Qr).toService(c4))});var Gkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},$kt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},jkt=function(n,t){return function(e,i){t(e,i,n)}};let Tk=class extends wq{constructor(n){super(),this.canvasRenderer=n}};Tk=Gkt([yt(),jkt(0,le(l1)),$kt("design:paramtypes",[Object])],Tk);let z4=!1;const Ukt=new Ut((n,t,e,i)=>{z4||(z4=!0,n(m4).to(Tk).inSingletonScope(),n(Qr).toService(m4))});class xq extends to{contains(t,e,i){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:r}=i??{};if(!r)return!1;r.highPerformanceSave();const o=t.getGraphicTheme(),s=this.transform(t,o,r),{x:a,y:l,z:h,lastModelMatrix:u}=s;let d=e;if(r.camera){d=e.clone();const f=t.parent.globalTransMatrix;d.x=f.a*e.x+f.c*e.y+f.e,d.y=f.b*e.x+f.d*e.y+f.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(t,r,a,l,{},null,f=>!!c||(c=f.isPointInPath(d.x,d.y),c),(f,g,p)=>{if(c)return!0;const v=g.lineWidth||p.lineWidth,m=g.pickStrokeBuffer||p.pickStrokeBuffer,y=g.keepStrokeScale||p.keepStrokeScale;return r.lineWidth=y?v+m:Ka(r,v+m,r.dpr),c=f.isPointInStroke(d.x,d.y),c}),this.canvasRenderer.z=0,r.modelMatrix!==u&&fn.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}}var Xkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Ykt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Kkt=function(n,t){return function(e,i){t(e,i,n)}};let Mk=class extends xq{constructor(n){super(),this.canvasRenderer=n,this.type="line",this.numberType=My}};Mk=Xkt([yt(),Kkt(0,le(o1)),Ykt("design:paramtypes",[Object])],Mk);let N4=!1;const qkt=new Ut((n,t,e,i)=>{N4||(N4=!0,n(p4).to(Mk).inSingletonScope(),n(Qr).toService(p4))});class Sq extends to{contains(t,e,i){const{pickContext:r}=i??{};if(!r)return!1;const o=t.getGraphicTheme();r.highPerformanceSave();const s=this.transform(t,o,r),{x:a,y:l,z:h,lastModelMatrix:u}=s;let d=e;if(r.camera){d=e.clone();const f=t.parent.globalTransMatrix;d.x=f.a*e.x+f.c*e.y+f.e,d.y=f.b*e.x+f.d*e.y+f.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(t,r,a,l,i,null,(f,g,p)=>!!c||(c=f.isPointInPath(d.x,d.y),c)),this.canvasRenderer.z=0,r.modelMatrix!==u&&fn.free(r.modelMatrix),r.modelMatrix=u,r.highPerformanceRestore(),c}}var Zkt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},Jkt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},Qkt=function(n,t){return function(e,i){t(e,i,n)}};let Rk=class extends Sq{constructor(n){super(),this.canvasRenderer=n,this.type="symbol",this.numberType=lA}contains(n,t,e){const{pickContext:i}=e??{};if(!i)return!1;const r=n.getParsedPath();if(!i.camera){if(!n.AABBBounds.containsPoint(t))return!1;if(r.isSvg||n.attribute.pickMode==="imprecise")return!0}i.highPerformanceSave();const o=n.getGraphicTheme(),s=this.transform(n,o,i),{x:a,y:l,z:h,lastModelMatrix:u}=s;let d=t;if(i.camera){d=t.clone();const f=n.parent.globalTransMatrix;d.x=f.a*t.x+f.c*t.y+f.e,d.y=f.b*t.x+f.d*t.y+f.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(n,i,a,l,{},null,(f,g,p)=>!!c||(c=f.isPointInPath(d.x,d.y),c),(f,g,p)=>{if(c)return!0;const v=g.lineWidth||p.lineWidth,m=g.pickStrokeBuffer||p.pickStrokeBuffer,y=g.keepStrokeScale||p.keepStrokeScale;return i.lineWidth=y?v+m:Ka(i,v+m,i.dpr),c=f.isPointInStroke(d.x,d.y),c}),this.canvasRenderer.z=0,i.modelMatrix!==u&&fn.free(i.modelMatrix),i.modelMatrix=u,i.highPerformanceRestore(),c}};Rk=Zkt([yt(),Qkt(0,le(h1)),Jkt("design:paramtypes",[Object])],Rk);let W4=!1;const tEt=new Ut((n,t,e,i)=>{W4||(W4=!0,n(y4).to(Rk).inSingletonScope(),n(Qr).toService(y4))});var eEt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},iEt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},nEt=function(n,t){return function(e,i){t(e,i,n)}};let Bk=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="circle",this.numberType=rA}};Bk=eEt([yt(),nEt(0,le(r1)),iEt("design:paramtypes",[Object])],Bk);let V4=!1;const rEt=new Ut((n,t,e,i)=>{V4||(V4=!0,n(f4).to(Bk).inSingletonScope(),n(Qr).toService(f4))});var oEt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},sEt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},aEt=function(n,t){return function(e,i){t(e,i,n)}};let Pk=class extends Sq{constructor(n){super(),this.canvasRenderer=n,this.type="text",this.numberType=hA}contains(n,t,e){const{pickContext:i}=e??{};if(!i)return!1;const r=n.AABBBounds;if(!i.camera)return!!r.containsPoint(t);i.highPerformanceSave();const o=n.getGraphicTheme(),{keepDirIn3d:s=o.keepDirIn3d}=n.attribute,a=!s,l=this.transform(n,o,i,a),{x:h,y:u,z:d,lastModelMatrix:c}=l;this.canvasRenderer.z=d;let f=t;if(i.camera){f=t.clone();const p=n.parent.globalTransMatrix;f.x=p.a*t.x+p.c*t.y+p.e,f.y=p.b*t.x+p.d*t.y+p.f}let g=!1;return this.canvasRenderer.drawShape(n,i,h,u,{},null,(p,v,m)=>{if(g)return!0;const{fontSize:y=o.fontSize,textBaseline:b=o.textBaseline,textAlign:_=o.textAlign}=n.attribute,w=n.AABBBounds,C=w.height(),x=w.width(),S=Lm(b,C,y),A=Jg(_,x);return p.rect(A+h,S+u,x,C,d),g=p.isPointInPath(f.x,f.y),g},(p,v,m)=>g),this.canvasRenderer.z=0,i.modelMatrix!==c&&fn.free(i.modelMatrix),i.modelMatrix=c,i.highPerformanceRestore(),g}};Pk=oEt([yt(),aEt(0,le(nk)),sEt("design:paramtypes",[Object])],Pk);let G4=!1;const lEt=new Ut((n,t,e,i)=>{G4||(G4=!0,n(b4).to(Pk).inSingletonScope(),n(Qr).toService(b4))});var hEt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},uEt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},dEt=function(n,t){return function(e,i){t(e,i,n)}};let kk=class extends xq{constructor(n){super(),this.canvasRenderer=n,this.type="path",this.numberType=sA}};kk=hEt([yt(),dEt(0,le(s1)),uEt("design:paramtypes",[Object])],kk);let $4=!1;const cEt=new Ut((n,t,e,i)=>{$4||($4=!0,n(v4).to(kk).inSingletonScope(),n(Qr).toService(v4))});var fEt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},gEt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},pEt=function(n,t){return function(e,i){t(e,i,n)}};let Ek=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="polygon",this.numberType=aA}};Ek=fEt([yt(),pEt(0,le(a1)),gEt("design:paramtypes",[Object])],Ek);let j4=!1;const vEt=new Ut((n,t,e,i)=>{j4||(j4=!0,n(_4).to(Ek).inSingletonScope(),n(Qr).toService(_4))});var mEt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},yEt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},bEt=function(n,t){return function(e,i){t(e,i,n)}};let Lk=class{constructor(n){this.canvasRenderer=n,this.type="richtext",this.numberType=NO}contains(n,t,e){return!!n.AABBBounds.containsPoint(t)}};Lk=mEt([yt(),bEt(0,le(rk)),yEt("design:paramtypes",[Object])],Lk);let U4=!1;const _Et=new Ut((n,t,e,i)=>{U4||(U4=!0,n(C4).to(Lk).inSingletonScope(),n(Qr).toService(C4))});var CEt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s},wEt=function(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)},xEt=function(n,t){return function(e,i){t(e,i,n)}};let Ok=class extends Za{constructor(n){super(),this.canvasRenderer=n,this.type="image",this.numberType=oA}};Ok=CEt([yt(),xEt(0,le(ok)),wEt("design:paramtypes",[Object])],Ok);let X4=!1;const SEt=new Ut((n,t,e,i)=>{X4||(X4=!0,n(g4).to(Ok).inSingletonScope(),n(Qr).toService(g4))});var Ud={},Aq={},Fl={};Object.defineProperty(Fl,"__esModule",{value:!0});Fl.loop=Fl.conditional=Fl.parse=void 0;var AEt=function n(t,e){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:i;if(Array.isArray(e))e.forEach(function(s){return n(t,s,i,r)});else if(typeof e=="function")e(t,i,r,n);else{var o=Object.keys(e)[0];Array.isArray(e[o])?(r[o]={},n(t,e[o],i,r[o])):r[o]=e[o](t,i,r,n)}return i};Fl.parse=AEt;var TEt=function(t,e){return function(i,r,o,s){e(i,r,o)&&s(i,t,r,o)}};Fl.conditional=TEt;var MEt=function(t,e){return function(i,r,o,s){for(var a=[],l=i.pos;e(i,r,o);){var h={};if(s(i,t,r,h),i.pos===l)break;l=i.pos,a.push(h)}return a}};Fl.loop=MEt;var un={};Object.defineProperty(un,"__esModule",{value:!0});un.readBits=un.readArray=un.readUnsigned=un.readString=un.peekBytes=un.readBytes=un.peekByte=un.readByte=un.buildStream=void 0;var REt=function(t){return{data:t,pos:0}};un.buildStream=REt;var Tq=function(){return function(t){return t.data[t.pos++]}};un.readByte=Tq;var BEt=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(e){return e.data[e.pos+t]}};un.peekByte=BEt;var gA=function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}};un.readBytes=gA;var PEt=function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}};un.peekBytes=PEt;var kEt=function(t){return function(e){return Array.from(gA(t)(e)).map(function(i){return String.fromCharCode(i)}).join("")}};un.readString=kEt;var EEt=function(t){return function(e){var i=gA(2)(e);return t?(i[1]<<8)+i[0]:(i[0]<<8)+i[1]}};un.readUnsigned=EEt;var LEt=function(t,e){return function(i,r,o){for(var s=typeof e=="function"?e(i,r,o):e,a=gA(t),l=new Array(s),h=0;h<s;h++)l[h]=a(i);return l}};un.readArray=LEt;var OEt=function(t,e,i){for(var r=0,o=0;o<i;o++)r+=t[e+o]&&Math.pow(2,i-o-1);return r},DEt=function(t){return function(e){for(var i=Tq()(e),r=new Array(8),o=0;o<8;o++)r[7-o]=!!(i&1<<o);return Object.keys(t).reduce(function(s,a){var l=t[a];return l.length?s[a]=OEt(r,l.index,l.length):s[a]=r[l.index],s},{})}};un.readBits=DEt;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t=Fl,e=un,i={blocks:function(c){for(var f=0,g=[],p=c.data.length,v=0,m=(0,e.readByte)()(c);m!==f&&m;m=(0,e.readByte)()(c)){if(c.pos+m>=p){var y=p-c.pos;g.push((0,e.readBytes)(y)(c)),v+=y;break}g.push((0,e.readBytes)(m)(c)),v+=m}for(var b=new Uint8Array(v),_=0,w=0;w<g.length;w++)b.set(g[w],_),_+=g[w].length;return b}},r=(0,t.conditional)({gce:[{codes:(0,e.readBytes)(2)},{byteSize:(0,e.readByte)()},{extras:(0,e.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,e.readUnsigned)(!0)},{transparentColorIndex:(0,e.readByte)()},{terminator:(0,e.readByte)()}]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===249}),o=(0,t.conditional)({image:[{code:(0,e.readByte)()},{descriptor:[{left:(0,e.readUnsigned)(!0)},{top:(0,e.readUnsigned)(!0)},{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{lct:(0,e.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,t.conditional)({lct:(0,e.readArray)(3,function(d,c,f){return Math.pow(2,f.descriptor.lct.size+1)})},function(d,c,f){return f.descriptor.lct.exists}),{data:[{minCodeSize:(0,e.readByte)()},i]}]},function(d){return(0,e.peekByte)()(d)===44}),s=(0,t.conditional)({text:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{preData:function(c,f,g){return(0,e.readBytes)(g.text.blockSize)(c)}},i]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===1}),a=(0,t.conditional)({application:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{id:function(c,f,g){return(0,e.readString)(g.blockSize)(c)}},i]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===255}),l=(0,t.conditional)({comment:[{codes:(0,e.readBytes)(2)},i]},function(d){var c=(0,e.peekBytes)(2)(d);return c[0]===33&&c[1]===254}),h=[{header:[{signature:(0,e.readString)(3)},{version:(0,e.readString)(3)}]},{lsd:[{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{gct:(0,e.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,e.readByte)()},{pixelAspectRatio:(0,e.readByte)()}]},(0,t.conditional)({gct:(0,e.readArray)(3,function(d,c){return Math.pow(2,c.lsd.gct.size+1)})},function(d,c){return c.lsd.gct.exists}),{frames:(0,t.loop)([r,a,l,o,s],function(d){var c=(0,e.peekByte)()(d);return c===33||c===44})}],u=h;n.default=u})(Aq);var pA={};Object.defineProperty(pA,"__esModule",{value:!0});pA.deinterlace=void 0;var IEt=function(t,e){for(var i=new Array(t.length),r=t.length/e,o=function(c,f){var g=t.slice(f*e,(f+1)*e);i.splice.apply(i,[c*e,e].concat(g))},s=[0,4,2,1],a=[8,8,4,2],l=0,h=0;h<4;h++)for(var u=s[h];u<r;u+=a[h])o(u,l),l++;return i};pA.deinterlace=IEt;var vA={};Object.defineProperty(vA,"__esModule",{value:!0});vA.lzw=void 0;var HEt=function(t,e,i){var r=4096,o=-1,s=i,a,l,h,u,d,c,f,C,g,p,w,v,x,S,T,A,m=new Array(i),y=new Array(r),b=new Array(r),_=new Array(r+1);for(v=t,l=1<<v,d=l+1,a=l+2,f=o,u=v+1,h=(1<<u)-1,g=0;g<l;g++)y[g]=0,b[g]=g;var w,C,x,S,A,T;for(w=C=x=S=A=T=0,p=0;p<s;){if(S===0){if(C<u){w+=e[T]<<C,C+=8,T++;continue}if(g=w&h,w>>=u,C-=u,g>a||g==d)break;if(g==l){u=v+1,h=(1<<u)-1,a=l+2,f=o;continue}if(f==o){_[S++]=b[g],f=g,x=g;continue}for(c=g,g==a&&(_[S++]=x,g=f);g>l;)_[S++]=b[g],g=y[g];x=b[g]&255,_[S++]=x,a<r&&(y[a]=f,b[a]=x,a++,!(a&h)&&a<r&&(u++,h+=a)),f=c}S--,m[A++]=_[S],p++}for(p=A;p<s;p++)m[p]=0;return m};vA.lzw=HEt;Object.defineProperty(Ud,"__esModule",{value:!0});var Mq=Ud.decompressFrames=Ud.decompressFrame=Rq=Ud.parseGIF=void 0,FEt=GEt(Aq),zEt=Fl,NEt=un,WEt=pA,VEt=vA;function GEt(n){return n&&n.__esModule?n:{default:n}}var $Et=function(t){var e=new Uint8Array(t);return(0,zEt.parse)((0,NEt.buildStream)(e),FEt.default)},Rq=Ud.parseGIF=$Et,jEt=function(t){for(var e=t.pixels.length,i=new Uint8ClampedArray(e*4),r=0;r<e;r++){var o=r*4,s=t.pixels[r],a=t.colorTable[s]||[0,0,0];i[o]=a[0],i[o+1]=a[1],i[o+2]=a[2],i[o+3]=s!==t.transparentIndex?255:0}return i},Bq=function(t,e,i){if(t.image){var r=t.image,o=r.descriptor.width*r.descriptor.height,s=(0,VEt.lzw)(r.data.minCodeSize,r.data.blocks,o);r.descriptor.lct.interlaced&&(s=(0,WEt.deinterlace)(s,r.descriptor.width));var a={pixels:s,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?a.colorTable=r.lct:a.colorTable=e,t.gce&&(a.delay=(t.gce.delay||10)*10,a.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(a.transparentIndex=t.gce.transparentColorIndex)),i&&(a.patch=jEt(a)),a}};Ud.decompressFrame=Bq;var UEt=function(t,e){return t.frames.filter(function(i){return i.image}).map(function(i){return Bq(i,t.gct,e)})};Mq=Ud.decompressFrames=UEt;const Ja=ZO();function L1(){L1.__loaded||(L1.__loaded=!0,TBt(),Nt.load(gBt),Nt.load(Ja?Vkt:QPt))}L1.__loaded=!1;const XEt=L1;function O1(){O1.__loaded||(O1.__loaded=!0,MBt(),Nt.load(yBt),Nt.load(Ja?rEt:nkt))}O1.__loaded=!1;const Pq=O1;function D1(){D1.__loaded||(D1.__loaded=!0,RBt())}D1.__loaded=!1;const eo=D1;function I1(){I1.__loaded||(I1.__loaded=!0,BBt(),Nt.load(ABt),Nt.load(Ja?SEt:okt))}I1.__loaded=!1;const mA=I1;function H1(){H1.__loaded||(H1.__loaded=!0,PBt(),Nt.load(vBt),Nt.load(Ja?qkt:hkt))}H1.__loaded=!1;const oD=H1;function F1(){F1.__loaded||(F1.__loaded=!0,kBt(),Nt.load(_Bt),Nt.load(Ja?cEt:mkt))}F1.__loaded=!1;const YEt=F1;function z1(){z1.__loaded||(z1.__loaded=!0,EBt(),Nt.load(CBt),Nt.load(Ja?vEt:fkt))}z1.__loaded=!1;const KEt=z1;function N1(){N1.__loaded||(N1.__loaded=!0,LBt(),Nt.load(pBt),Nt.load(Ja?Ukt:Ckt))}N1.__loaded=!1;const Ql=N1;function W1(){W1.__loaded||(W1.__loaded=!0,OBt(),Nt.load(SBt),Nt.load(Ja?_Et:wkt))}W1.__loaded=!1;const yA=W1;function V1(){V1.__loaded||(V1.__loaded=!0,HBt())}V1.__loaded=!1;const qEt=V1;function G1(){G1.__loaded||(G1.__loaded=!0,DBt(),Nt.load(mBt),Nt.load(Ja?tEt:Tkt))}G1.__loaded=!1;const Ap=G1;function $1(){$1.__loaded||($1.__loaded=!0,IBt(),Nt.load(bBt),Nt.load(Ja?lEt:Rkt))}$1.__loaded=!1;const Qa=$1;function j1(){j1.__loaded||(j1.__loaded=!0,FBt())}j1.__loaded=!1;const ZEt=j1;function kq(){eo(),Ql()}const Eq="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",JEt=14;var Rr;(function(n){n.selected="selected",n.selectedReverse="selected_reverse",n.hover="hover",n.hoverReverse="hover_reverse"})(Rr||(Rr={}));const of={[Rr.selectedReverse]:{},[Rr.selected]:{},[Rr.hover]:{},[Rr.hoverReverse]:{}},Y4={container:"",width:30,height:30,style:{}},QEt="scrollDown",tLt="scrollDrag",eLt="scrollUp";function M0(){return Dt.env==="browser"?["pointerup","pointerleave","pointercancel"]:["pointerup","pointerleave","pointerupoutside"]}const K4={debounce:cq,throttle:fq};kq();class Yl extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},Yl.defaultAttributes,t)),this.name="scrollbar",this._handleTouchMove=i=>{Tt(this._prePos)&&i.preventDefault()},this._onRailPointerDown=i=>{const{viewX:r,viewY:o}=i,{direction:s,width:a,height:l,range:h}=this.attribute,u=this._sliderSize,[d,c]=this._getScrollRange();let f;if(s==="vertical"){const g=o-this._viewPosition.y,p=ho(g-u/2,d,c);f=g/l,this._slider.setAttribute("y",p,!0)}else{const g=r-this._viewPosition.x,p=ho(g-u/2,d,c);f=g/a,this._slider.setAttribute("x",p,!0)}this.setScrollRange([f-(h[1]-h[0])/2,f+(h[1]-h[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=i=>{this._clearDragEvents();const{stopSliderDownPropagation:r=!0}=this.attribute;r&&i.stopPropagation();const{direction:o}=this.attribute,{x:s,y:a}=this.stage.eventPointTransform(i);this._prePos=o==="horizontal"?s:a,this._dispatchEvent(QEt,{pos:this._prePos,event:i});const l=M0(),h=Dt.env==="browser"?Dt:this.stage;h.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),l.forEach(u=>{h.addEventListener(u,this._onSliderPointerUp)})},this._computeScrollValue=i=>{const{direction:r}=this.attribute,{x:o,y:s}=this.stage.eventPointTransform(i);let a,l,h=0;const{width:u,height:d}=this.getSliderRenderBounds();return r==="vertical"?(l=s,h=l-this._prePos,a=h/d):(l=o,h=l-this._prePos,a=h/u),[l,a]},this._onSliderPointerMove=i=>{const{stopSliderMovePropagation:r=!0}=this.attribute;r&&i.stopPropagation();const o=this.getScrollRange(),[s,a]=this._computeScrollValue(i);this.setScrollRange([o[0]+a,o[1]+a],!0),this._prePos=s},this._onSliderPointerMoveWithDelay=this.attribute.delayTime===0?this._onSliderPointerMove:K4[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=i=>{const{range:r,limitRange:o=[0,1]}=this.attribute,s=this.getScrollRange(),[a,l]=this._computeScrollValue(i),h=[s[0]+l,s[1]+l];this._prePos=null,this._dispatchEvent(eLt,{pre:r,value:td(h,o[0],o[1])}),this._clearDragEvents()}}setScrollRange(t,e=!0){const{direction:i="horizontal",limitRange:r=[0,1],range:o,realTime:s=!0}=this.attribute,a=td(t,r[0],r[1]);if(e){const l=this._getSliderPos(a);if(this._slider){const h=l[1]-l[0];this._sliderSize=h,i==="horizontal"?this._slider.setAttributes({x:l[0],width:h},!0):this._slider.setAttributes({y:l[0],height:h},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=a,s&&this._dispatchEvent(tLt,{pre:o,value:a})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;const{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",K4[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown),(Dt.env==="browser"?Dt:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1})}render(){this._reset();const{direction:t="horizontal",width:e,height:i,range:r,limitRange:o=[0,1],railStyle:s,sliderStyle:a,padding:l=2}=this.attribute,h=this.createOrUpdateChild("scrollbar-container",{},"group"),u=h.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:e,height:i},s),"rect");this._rail=u;const d=this.getSliderRenderBounds(),c=this._getSliderPos(td(r,o[0],o[1])),f=c[1]-c[0];let g;this._sliderSize=f,g=t==="horizontal"?{x:c[0],y:d.y1,width:f,height:d.height}:{x:d.x1,y:c[0],width:d.width,height:f};const p=h.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},g),{cornerRadius:this._getDefaultSliderCornerRadius()}),a),{boundsPadding:$a(l),pickMode:"imprecise"}),"rect");this._slider=p,this._container=h;const v=this._container.AABBBounds;this._viewPosition={x:v.x1,y:v.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;const{width:t,height:e,padding:i=2}=this.attribute,[r,o,s,a]=$a(i),l={x1:a,y1:r,x2:t-o,y2:e-s,width:Math.max(0,t-(a+o)),height:Math.max(0,e-(r+s))};return this._sliderRenderBounds=l,l}_getDefaultSliderCornerRadius(){const{direction:t,round:e}=this.attribute;if(e){const{width:i,height:r}=this.getSliderRenderBounds();return t==="horizontal"?r:i}return 0}_getSliderPos(t){const{direction:e}=this.attribute,{width:i,height:r,x1:o,y1:s}=this.getSliderRenderBounds();return e==="horizontal"?[i*t[0]+o,i*t[1]+o]:[r*t[0]+s,r*t[1]+s]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;const{limitRange:t=[0,1],direction:e}=this.attribute,[i,r]=td(t,0,1),{width:o,height:s,x1:a,y1:l}=this.getSliderRenderBounds(),h=this._sliderSize;return e==="horizontal"?td([a+i*o,a+r*o],a,o-h):td([l+i*s,l+r*s],l,s-h)}_clearDragEvents(){const t=M0(),e=Dt.env==="browser"?Dt:this.stage;e.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),t.forEach(i=>{e.removeEventListener(i,this._onSliderPointerUp)})}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}release(t){super.release(t),(Dt.env==="browser"?Dt:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearDragEvents()}}Yl.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};function yc(n,t){n.forEachChildren(e=>{const i=t(e);e.isContainer&&!i&&yc(e,t)})}function Lq(n,t){return[n[0]*t,n[1]*t]}function Oq(n){const[t,e]=n;return Math.sqrt(t*t+e*e)}function iLt(n){let t=Oq(n);return t>0&&(t=1/t),[n[0]*t,n[1]*t]}function nLt(n,t){const[e,i]=n,[r,o]=t,s=Math.sqrt((e*e+i*i)*(r*r+o*o)),a=s&&(e*r+i*o)/s;return Math.acos(Math.min(Math.max(a,-1),1))}function rLt(n,t,e){const i=nLt(n,t),r=aPt(n,t)>=0;return e?r?2*Math.PI-i:i:r?i:2*Math.PI-i}const Dq=(n,t,e,i)=>new tg(Object.assign({defaultFontParams:Object.assign({fontFamily:Eq,fontSize:JEt},i),getTextBounds:dA,specialCharSet:`-/: .,@%'"~`+tg.ALPHABET_CHAR_SET+tg.ALPHABET_CHAR_SET.toUpperCase()},{}),n);function bA(n,t,e={}){if(!n)return{width:0,height:0};const i=dA({text:n,fontFamily:t.fontFamily||e.fontFamily||Eq,fontSize:t.fontSize||e.fontSize||12,fontWeight:t.fontWeight||e.fontWeight,textAlign:t.textAlign||"center",textBaseline:t.textBaseline,ellipsis:!!t.ellipsis,maxLineWidth:t.maxLineWidth||1/0,lineHeight:t.fontSize||e.fontSize||12});return{width:i.width(),height:i.height()}}function oLt(n,t="type"){return Iq(n,t)==="rich"}function Iq(n,t="type"){var e,i;return Js(n.text)&&"type"in n.text?(e=n.text.type)!==null&&e!==void 0?e:"text":t in n&&(i=n[t])!==null&&i!==void 0?i:"text"}function Hq(n){var t,e;return Tt(n.maxLineWidth)&&(n.maxWidth=n.maxLineWidth,delete n.maxLineWidth),n.width=(t=n.width)!==null&&t!==void 0?t:0,n.height=(e=n.height)!==null&&e!==void 0?e:0,n.textConfig=n.text.text||n.text,n}function sLt(n){const{text:t,_originText:e}=n,{text:i}=t;return n.html=i,n.text=e,n.renderable=!1,n}function aLt(n){const{text:t,_originText:e}=n,{text:i}=t;return n.react=i,n.text=e,n.renderable=!1,n}function Dk(n,t="type"){const e=Iq(n,t);return e==="rich"?kt.richtext(Hq(n)):(e==="html"?n=sLt(n):e==="react"&&(n=aLt(n)),kt.text(n))}function Fq(){eo(),Ql(),Ap(),yA(),Qa()}var q4=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};Fq();class ou extends Ro{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super(e?.skipDefault?t:Wt({},ou.defaultAttributes,t)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var t,e,i;this.cacheStates();const{text:r="",textStyle:o={},shape:s={},panel:a={},space:l=4,minWidth:h,maxWidth:u,padding:d=4,visible:c,state:f,type:g,textAlwaysCenter:p,containerTextAlign:v}=this.attribute,m=$a(d),y=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group");let b,_=-m[3],w=-m[0],C=m[1]+m[3],x=m[0]+m[2],S=0,A=0;const{visible:T}=s,M=q4(s,["visible"]);if(C1(T)){const W=M?.size||10,K=jn(W)?W:Math.max(W[0],W[1]);b=y.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:W,strokeBoundsBuffer:0},M),{visible:T,x:K/2,y:K/2}),"symbol"),Qe(f?.shape)||(b.states=f.shape),T&&(A=K+l)}let R,E,P;if(C+=A,S+=A,oLt({text:r})||g==="rich"){const W=Object.assign(Object.assign(Object.assign({},Hq(Object.assign({type:g,text:r},o))),o),{visible:Tt(r)&&c!==!1,x:S,y:0});ee(W.lineHeight)&&(W.lineHeight=o.fontSize),R=y.createOrUpdateChild("tag-text",W,"richtext"),E=R.AABBBounds.width(),P=R.AABBBounds.height()}else{const W=Object.assign(Object.assign({text:Js(r)&&"type"in r&&r.type==="text"?r.text:r,visible:Tt(r)&&c!==!1,lineHeight:o?.fontSize},o),{x:S,y:0});ee(W.lineHeight)&&(W.lineHeight=o.fontSize),R=y.createOrUpdateChild("tag-text",W,"text");const K=bA(W.text,o,(e=(t=this.stage)===null||t===void 0?void 0:t.getTheme())===null||e===void 0?void 0:e.text);E=K.width,P=K.height}C+=E;const B=(i=s.size)!==null&&i!==void 0?i:10,k=jn(B)?B:Math.max(B[0],B[1]);x+=Math.max(P,s.visible?k:0);const{textAlign:L,textBaseline:O}=o;(Tt(h)||Tt(u))&&(Tt(h)&&C<h&&(C=h),Tt(u)&&C>u&&(C=u,R.setAttribute("maxLineWidth",u-m[1]-m[2]))),_=0,w=0;let D=0;L==="left"||L==="start"?D=1:L==="right"||L==="end"?D=-1:L==="center"&&(D=0),D?D<0?(_-=C,b&&b.setAttribute("x",(b.attribute.x||0)-E),y.setAttribute("x",-m[1]-A)):D>0&&y.setAttribute("x",m[3]):(_-=C/2,b&&b.setAttribute("x",(b.attribute.x||0)-E/2),y.setAttribute("x",-A/2));const I=v==="right"||v==="end",H=v==="left"||v==="start",F=(W,K)=>{R.type==="richtext"?R.setAttributes({x:W,textAlign:K,textConfig:w1(R.attribute.textConfig).map(J=>Object.assign(Object.assign({},J),{textAlign:K}))}):R.setAttributes({x:W,textAlign:K})};if((v?v==="center":p)&&D){const W=C-m[1]-m[3],K=E+A,J=D===1?(W-K)/2+A+E/2:m[0]+A-(C/2+K/2-A)+E/2;if(F(J,"center"),b){const q=J-E/2-A+k/2;b.setAttributes({x:q})}}if(H&&D!==1){const W=C-m[1]-m[3],K=D===0?-W/2+A/2:-C+m[3]+m[1]+A;if(F(K+A,"left"),b){const J=K+k/2;b.setAttributes({x:J})}}if(I&&D!==-1){const W=C-m[1]-m[3],K=D===0?W/2+A/2:W;if(F(K,"right"),b){const J=K-E-A+k/2;b.setAttributes({x:J})}}O==="middle"?(w-=x/2,b&&b.setAttribute("y",0)):O==="bottom"?(w-=x,b&&b.setAttribute("y",-P/2),y.setAttribute("y",-m[2])):O==="top"&&(y.setAttribute("y",m[0]),b&&b.setAttribute("y",P/2)),Qe(f?.text)||(R.states=f.text);const{visible:G}=a,j=q4(a,["visible"]);if(c&&C1(G)){const W=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},j),{visible:G&&!!r,width:C,height:x,x:_,y:w}),"rect");if(Qe(f?.panel)||(W.states=f.panel),j.customShape){const K=j.customShape;W.pathProxy=J=>K(this,J,new wn)}this._bgRect=W}this._textShape=R,this._symbol=b,this.resetStates()}initAttributes(t,e){t=e?.skipDefault?t:Wt({},ou.defaultAttributes,t),super.initAttributes(t),this.render()}addState(t,e,i){super.addState(t,e,i),this._textShape&&this._textShape.addState(t,e,i),this._bgRect&&this._bgRect.addState(t,e,i),this._symbol&&this._symbol.addState(t,e,i)}removeState(t,e){super.removeState(t,e),this._textShape&&this._textShape.removeState(t,e),this._bgRect&&this._bgRect.removeState(t,e),this._symbol&&this._symbol.removeState(t,e)}cacheStates(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g;this._tagStates=(e=(t=this.currentStates)===null||t===void 0?void 0:t.slice())!==null&&e!==void 0?e:[],this._rectStates=(o=(r=(i=this._bgRect)===null||i===void 0?void 0:i.currentStates)===null||r===void 0?void 0:r.slice())!==null&&o!==void 0?o:[],this._symbolStates=(l=(a=(s=this._symbol)===null||s===void 0?void 0:s.currentStates)===null||a===void 0?void 0:a.slice())!==null&&l!==void 0?l:[],this._textStates=(d=(u=(h=this._textShape)===null||h===void 0?void 0:h.currentStates)===null||u===void 0?void 0:u.slice())!==null&&d!==void 0?d:[],this.clearStates(),(c=this._bgRect)===null||c===void 0||c.clearStates(),(f=this._symbol)===null||f===void 0||f.clearStates(),(g=this._textShape)===null||g===void 0||g.clearStates()}resetStates(){var t,e,i;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&((t=this._bgRect)===null||t===void 0||t.useStates(this._rectStates)),this._symbolStates.length&&((e=this._symbol)===null||e===void 0||e.useStates(this._symbolStates)),this._textStates.length&&((i=this._textShape)===null||i===void 0||i.useStates(this._textStates))}}ou.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};const zq={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},Nq={poptip:Wt({},zq)};function lLt(){eo(),Qa(),Ap(),Ql()}function hLt(n){Wt(Nq.poptip,zq,n)}var uLt=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const Z4=new Nm;lLt();const J4="M -0.5 -0.5, L -0.5 0.5, L 0.5 -0.5, Z",Q4="M -0.5 -0.5, L -0.5 0.5, L 0.5 0.5, Z",t6="M -0.5 -0.5, L 0.5 -0.5, L 0.5 0.5, Z",e6="M 0.5 -0.5, L 0.5 0.5, L -0.5 0.5, Z",dLt={tl:J4,tr:t6,bl:Q4,br:e6,lt:J4,lb:Q4,rt:t6,rb:e6};class rp extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},rp.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,i,r,o,s,a,l,h;const{titleStyle:u={},position:d,contentStyle:c={},panel:f,logoSymbol:g,poptipAnchor:p="position",logoText:v,logoTextStyle:m={},triangleMode:y="default",space:b=4,minWidth:_=0,maxWidth:w=1/0,padding:C=4,maxWidthPercent:x,visible:S,state:A,dx:T=0,dy:M=0,positionBounds:R}=this.attribute;let{title:E="",content:P=""}=this.attribute;E=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(E):E,P=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(P):P;const B=$a(C),k=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group");this.group=k;const L=w-B[1]-B[3],O=Tt(E)&&S!==!1,D=Object.assign(Object.assign({text:Ge(E)?E:[E],visible:O,wrap:!0},u),{x:B[3],y:B[0],maxLineWidth:L,textAlign:"left",textBaseline:"top"}),I=k.createOrUpdateChild("poptip-title",D,"text");Qe(A?.title)||(I.states=A.title);const H=I.AABBBounds,F=H.height(),G=H.width();let j=F+b;O||(j=0);const W=Tt(P)&&S!==!1,K=Object.assign(Object.assign({text:Ge(P)?P:[P],visible:W,wrap:!0},c),{x:B[3],y:B[0]+j,maxLineWidth:L,textAlign:"left",textBaseline:"top"}),J=k.createOrUpdateChild("poptip-content",K,"text");Qe(A?.content)||(J.states=A.content);const q=J.AABBBounds,X=q.height(),it=q.width();W&&(j+=X),this.titleShape=I,this.contentShape=J;let Z=v_(G+B[1]+B[3],it+B[1]+B[3]);Z>w?Z=w:Z<_&&(Z=_);let et=B[0]+B[2]+j;const{visible:nt,square:z}=f,V=uLt(f,["visible","square"]);if(z){const dt=v_(Z,et);Z=dt;const vt=dt-et;et=dt,I.setAttributes({dy:vt/2}),J.setAttributes({dy:vt/2})}const $=(t=V.size)!==null&&t!==void 0?t:12,U=Ge($)?[$[0]+((e=V.space)!==null&&e!==void 0?e:0),$[1]+((i=V.space)!==null&&i!==void 0?i:0)]:$+((r=V.space)!==null&&r!==void 0?r:0),Q=(o=V.lineWidth)!==null&&o!==void 0?o:1,rt=this.stage?[(s=this.stage.viewWidth)!==null&&s!==void 0?s:this.stage.width,(a=this.stage.viewHeight)!==null&&a!==void 0?a:this.stage.height]:void 0;if(rt){const dt=this.AABBBounds,vt=(l=this.attribute.x)!==null&&l!==void 0?l:dt.x1,oe=rt[0]-dt.x1;let Se=Math.max(vt,oe);const fi=(Ge($)?$[0]:12)+3;if(Se=Math.min(Se-fi,Se*x),Se<Z){Z=Se;const me=B[1]+B[3];I.setAttribute("maxLineWidth",Se-me),J.setAttribute("maxLineWidth",Se-me),et=B[0]+B[2],O&&(et+=I.AABBBounds.height()+b),et+=J.AABBBounds.height()}}const st=d==="auto"||Ge(d),at=Ge(d)?d:this.positionList;let ht,gt=-1/0;for(let dt=0;dt<at.length+1;dt++){const vt=st?at[dt===at.length?ht:dt]:d;let oe="arrow2Left",Se=(Ge($)?$[0]:$)/4,fi=0;vt==="top"||vt==="bottom"||vt==="left"||vt==="right"?oe="arrow2Left":y==="concise"&&(oe=dLt[vt],Se=["tl","bl","rt","rb"].includes(vt)?(Ge($)?$[0]:$)/2:-(Ge($)?$[0]:$)/2,fi=["tl","tr","lb","rb"].includes(vt)?-(Ge($)?$[1]:$)/2:(Ge($)?$[1]:$)/2);const{angle:me,offset:bn}=this.getAngleAndOffset(vt,Z,et,Ge(U)?U:[U,U-Q],oe);let Gi,Ii={x:0,y:0};if(p==="bounds"&&R&&(Ii=this.calculateAnchorPoint(vt,R)),C1(nt)){let Yt;Gi=k.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},V),{visible:nt&&(W||O),x:Se,y:fi,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:oe,angle:me,dx:bn[0],dy:bn[1]-((h=V.space)!==null&&h!==void 0?h:0),size:$,zIndex:9}),"symbol"),Qe(A?.panel)||(Gi.states=A.panel),Yt=f.panelSymbolType?k.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},V),{visible:nt&&(W||O),x:0,y:0,symbolType:"rect",size:[Z,et],zIndex:-8}),"symbol"):k.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},V),{visible:nt&&(W||O),x:0,y:0,width:Z,height:et,zIndex:-8}),"rect"),Qe(A?.panel)||(Yt.states=A.panel)}if(k.setAttributes({x:-bn[0]+T+Ii.x,y:-bn[1]+M+Ii.y,anchor:[Se,fi]}),g){const{size:Yt=12}=g,ai=Ge(Yt)?Yt:[Yt,Yt];ai[1]==="auto"&&(ai[1]=et),ai[0]==="auto"&&(ai[0]=et);const We=ai[0];k.createOrUpdateChild("poptip-logo",Object.assign(Object.assign({},g),{x:0,y:et/2,visible:nt&&(W||O),zIndex:10,size:ai}),"symbol"),k.setAttributes({x:-bn[0]+T+We/2,y:-bn[1]+M}),v&&k.createOrUpdateChild("poptip-logo-text",Object.assign(Object.assign({},m),{x:0,y:et/2,visible:nt&&(W||O),text:v,textAlign:"center",textBaseline:"middle",zIndex:10}),"text")}if(!rt)break;{Z4.setValue(0,0,Z,et).transformWithMatrix(k.globalTransMatrix);const Yt=Z4,ai=new pq().setValue(0,0,rt[0],rt[1]);if(st){if(uPt(Yt,ai))break;{const We=hPt(Yt,ai),Hi=(We.x2-We.x1)*(We.y2-We.y1);Hi>gt&&(gt=Hi,ht=dt)}}if(["top","bottom","left","right"].includes(vt)){const We=vt==="top"||vt==="bottom",Hi=vt==="left"||vt==="right";let br=!1;if(We?br=vt==="top"&&Yt.y1<0||vt==="bottom"&&Yt.y2>ai.y2:Hi&&(br=vt==="left"&&Yt.x1<0||vt==="right"&&Yt.x2>ai.x2),!br){let At=0;const _i=(Ge($)?$[1]:$)/2;We?(Yt.x1<0?At=-Yt.x1:Yt.x2>ai.x2&&(At=ai.x2-Yt.x2),k.setAttribute("x",k.attribute.x+At),Gi.setAttribute("dx",S1(v_(Gi.attribute.dx-At,_i),Yt.width()-_i))):Hi&&(Yt.y1<0?At=-Yt.y1:Yt.y2>ai.y2&&(At=ai.y2-Yt.y2),k.setAttribute("y",k.attribute.y+At),Gi.setAttribute("dy",S1(v_(Gi.attribute.dy-At,_i),Yt.height()-_i)));break}}if(!st)break}}}calculateAnchorPoint(t,e){if(!e)return{x:0,y:0};const{x:i,y:r}=this.attribute,{x1:o,y1:s,x2:a,y2:l}=e,h=a-o,u=l-s;switch(t){case"top":case"tl":case"tr":return{x:o+h/2-i,y:s-r};case"bottom":case"bl":case"br":return{x:o+h/2-i,y:l-r};case"left":case"lt":case"lb":return{x:o-i,y:s+u/2-r};case"right":case"rt":case"rb":return{x:a-i,y:s+u/2-r};default:return{x:0,y:0}}}getAngleAndOffset(t,e,i,r,o){const s=o==="arrow2Left"?r[1]/2:r[1];switch(t){case"tl":return{angle:o==="arrow2Left"?Wo/2*3:0,offset:o==="arrow2Left"?[e/4,i+s]:[0,i+s]};case"top":return{angle:Wo/2*3,offset:[e/2,i+s]};case"tr":return{angle:o==="arrow2Left"?Wo/2*3:0,offset:o==="arrow2Left"?[e/4*3,i+s]:[e,i+s]};case"rt":return{angle:0,offset:o==="arrow2Left"?[-s,i/5]:[-s,0]};case"right":return{angle:0,offset:[-s,i/2]};case"rb":return{angle:0,offset:o==="arrow2Left"?[-s,i/5*4]:[-s,i]};case"bl":return{angle:o==="arrow2Left"?Wo/2:0,offset:o==="arrow2Left"?[e/4,-s]:[0,-s]};case"bottom":return{angle:Wo/2,offset:[e/2,-s]};case"br":return{angle:o==="arrow2Left"?Wo/2:0,offset:o==="arrow2Left"?[e/4*3,-s]:[e,-s]};case"lt":return{angle:o==="arrow2Left"?Wo:0,offset:o==="arrow2Left"?[e+s,i/5]:[e+s,0]};case"left":return{angle:Wo,offset:[e+s,i/2]};case"lb":return{angle:o==="arrow2Left"?Wo:0,offset:o==="arrow2Left"?[e+s,i/5*4]:[e+s,i]}}}}rp.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},panel:{},maxWidthPercent:.8,space:8,padding:10};var cLt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};function fLt(n,t){return Wt(n,Nq.poptip,t),n}let R0=class{render(n,t,e,i,r,o,s,a,l,h,u,d,c){var f,g;if(n._showPoptip===1){const{visible:p,visibleCb:v}=n.attribute.poptip||{};if(p===!1||v&&v(n)===!1)return;const m={};Wt(m,rp.defaultAttributes,n.attribute.poptip?n.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(m):this.poptipComponent=new rp(m);let y=n.attribute.poptip||{};if(n.type==="text"&&y.title==null&&y.content==null){const w={};fLt(w,y),y=w,y.content=(f=y.content)!==null&&f!==void 0?f:n.attribute.text}const b=n.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1,poptipAnchor:"bounds"},y),{x:b.e,y:b.f,positionBounds:n.globalAABBBounds})),h.stage.tryInitInteractiveLayer();const _=h.stage.getLayer("_builtin_interactive");_&&_.add(this.poptipComponent)}else n._showPoptip===2&&(n._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),(g=this.poptipComponent.parent)===null||g===void 0||g.removeChild(this.poptipComponent),this.poptipComponent=null))}};R0=cLt([yt()],R0);var Wq=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};class Vq{constructor(){this.activeEvent="onRegister",this._uid=nn.GenAutoIncrementId(),this.poptip=t=>{const e=t.target;this.needHide(e)?this.unpoptip(t):e!==this.activeGraphic&&(this.needShow(e)&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0))},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;const{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}needHide(t){return t.isContainer||!t.attribute}needShow(t){return!!t.attribute.poptip}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){const{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}}let B0=class extends Vq{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};B0=Wq([yt()],B0);let P0=class extends Vq{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=n=>{const{stage:t}=this.pluginService;n.target===t&&this.unpoptip(n)}}activate(n){super.activate(n);const{stage:t}=this.pluginService;t.addEventListener("pointerleave",this.pointerlave)}needHide(n){return n.type!=="text"||!n.cliped||n.isContainer||!n.attribute||n.attribute.disableAutoClipedPoptip}needShow(n){return!0}deactivate(n){const{stage:t}=this.pluginService;super.deactivate(n),t.removeEventListener("pointerleave",this.pointerlave)}};P0=Wq([yt()],P0);const gLt=new Ut((n,t,e,i)=>{e(R0)||(n(R0).toSelf().inSingletonScope(),n(UO).toService(R0)),e(B0)||(n(B0).toSelf(),n(Fm).toService(B0)),e(P0)||(n(P0).toSelf(),n(Fm).toService(P0))});function pLt(){Nt.load(gLt)}function vLt(){eo(),oD(),KEt(),Ap()}vLt();class _A extends Ro{getStartAngle(){return JW(this._startAngle)}getEndAngle(){return JW(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super(e?.skipDefault?t:Wt({},_A.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();const{startSymbol:t,endSymbol:e,lineStyle:i,state:r,visible:o=!0,multiSegment:s,mainSegmentIndex:a}=this.attribute;if(!o)return;this._computeLineAngle();const l=this._getMainSegmentPoints(),h=this._renderSymbol(t,l,"start"),u=this._renderSymbol(e,l,"end");if(this.startSymbol=h,this.endSymbol=u,s){const d=[...this.attribute.points];if(Zi(a))d[a]=this._clipPoints(d[a]);else{const c=this._clipPoints(fk(d));d[0][0]=c[0],d[d.length-1][d[d.length-1].length-1]=c[c.length-1]}d.forEach((c,f)=>{var g,p;const v=kt.line(Object.assign(Object.assign({points:c},Ge(i)?(g=i[f])!==null&&g!==void 0?g:i[i.length-1]:i),{fill:!1}));v.name=`${this.name}-line`,v.id=this._getNodeId("line"+f),Qe(r?.line)||(v.states=Ge(r.line)?(p=r.line[f])!==null&&p!==void 0?p:r.line[r.line.length-1]:r.line),this.add(v),this.lines.push(v)})}else{let d=kt.line;w1(i)[0].cornerRadius&&(d=kt.polygon);const c=d(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},w1(i)[0]),{fill:!1,closePath:!1}));c.name=`${this.name}-line`,c.id=this._getNodeId("line"),Qe(r?.line)||(c.states=[].concat(r.line)[0]),this.add(c),this.lines.push(c)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,i){if(!e.length)return;const{autoRotate:r=!0}=t;let o;if(t&&t.visible){const s=this.getStartAngle(),a=this.getEndAngle(),{state:l}=this.attribute,h=e[0],u=e[e.length-1],{refX:d=0,refY:c=0,refAngle:f=0,style:g,symbolType:p,size:v=12}=t;let m,y;i==="start"?(m={x:h.x+(Zi(s)?d*Math.cos(s)+c*Math.cos(s-Math.PI/2):0),y:h.y+(Zi(s)?d*Math.sin(s)+c*Math.sin(s-Math.PI/2):0)},y=this._computeStartRotate(this._startAngle)):(m={x:u.x+(Zi(a)?d*Math.cos(a)+c*Math.cos(a-Math.PI/2):0),y:u.y+(Zi(a)?d*Math.sin(a)+c*Math.sin(a-Math.PI/2):0)},y=this._computeEndRotate(this._endAngle)),o=kt.symbol(Object.assign(Object.assign(Object.assign({},m),{symbolType:p,size:v,angle:r?y+f:0,strokeBoundsBuffer:0}),g)),o.name=`${this.name}-${i}-symbol`,o.id=this._getNodeId(`${i}-symbol`),Qe(l?.symbol)||(o.states=l.symbol),i==="start"?Qe(l?.startSymbol)||(o.states=l.startSymbol):Qe(l?.endSymbol)||(o.states=l.endSymbol),this.add(o)}return o}_getMainSegmentPoints(){if(this._mainSegmentPoints)return this._mainSegmentPoints;const{points:t,multiSegment:e,mainSegmentIndex:i}=this.attribute;let r;return r=e?Zi(i)?t[i]:fk(t):t,this._mainSegmentPoints=r,r}_clipPoints(t){const{startSymbol:e={},endSymbol:i={}}=this.attribute;let r=t;if(e.visible){const o=e.clip?e.size||10:0;r=[{x:t[0].x-o/2*(Math.cos(this._startAngle)||0),y:t[0].y-o/2*(Math.sin(this._startAngle)||0)},...r.slice(1)]}if(i.visible){const o=i.clip?i.size||10:0,s={x:t[t.length-1].x-o/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-o/2*(Math.sin(this._endAngle)||0)};r=[...r.slice(0,r.length-1),s]}return r}_computeLineAngle(){const t=this._getMainSegmentPoints();if(t.length<=1)return;const e=t[0],i=t[1],r=t[t.length-2],o=t[t.length-1],s=[e.x-i.x,e.y-i.y],a=Math.atan2(s[1],s[0]),l=[o.x-r.x,o.y-r.y],h=Math.atan2(l[1],l[0]);this._startAngle=a,this._endAngle=h}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}_A.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}};var Yn;(function(n){n.innerView="inner-view",n.axisContainer="axis-container",n.labelContainer="axis-label-container",n.tickContainer="axis-tick-container",n.tick="axis-tick",n.subTick="axis-sub-tick",n.label="axis-label",n.title="axis-title",n.gridContainer="axis-grid-container",n.grid="axis-grid",n.gridRegion="axis-grid-region",n.line="axis-line",n.background="axis-background",n.axisLabelBackground="axis-label-background",n.axisBreak="axis-break",n.axisBreakSymbol="axis-break-symbol"})(Yn||(Yn={}));var Df;(function(n){n.selected="selected",n.selectedReverse="selected_reverse",n.hover="hover",n.hoverReverse="hover_reverse"})(Df||(Df={}));const sf={[Df.selectedReverse]:{},[Df.selected]:{},[Df.hover]:{},[Df.hoverReverse]:{}},mLt=999,Ik={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},i6={size:8,stroke:"#000",lineWidth:1,zIndex:1};function yLt(n){const t=n.AABBBounds;return{x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,centerX:n.attribute.x,centerY:n.attribute.y,angle:n.attribute.angle}}function bLt(n){n.forEach(t=>{if(t.rotatedBounds||!t.attribute.angle)return;const e=yLt(t),i=Uv({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),r=i.x-e.centerX,o=i.y-e.centerY;e.x1+=r,e.x2+=r,e.y1+=o,e.y2+=o,e.centerX+=r,e.centerY+=o,t.rotatedBounds=e})}function _Lt(n,t){var e,i;return!((e=n.OBBBounds)===null||e===void 0)&&e.empty()||!((i=t.OBBBounds)===null||i===void 0)&&i.empty()?dPt(n.AABBBounds,t.AABBBounds)&&(!n.rotatedBounds||!t.rotatedBounds||cPt(n.rotatedBounds,t.rotatedBounds,!0)):n.OBBBounds.intersects(t.OBBBounds)}const Gq=Math.sin(Math.PI/10);function $q(n,t=Gq){const e=!ee(n)&&n!==0,i=e?Math.cos(n):1;return e&&Math.abs(i)<=t}function sD(n,t=Gq){const e=!ee(n)&&n!==0,i=e?Math.sin(n):0;return!e||Math.abs(i)<=t}function CLt(n,t){return{x:n.x+t[0],y:n.y+t[1]}}function wLt(n={}){var t,e;const{style:i={},angle:r=.5*Math.PI}=n,o=Wt({},i6,i),s=(t=o.size)!==null&&t!==void 0?t:i6.size;return Object.assign(Object.assign({},o),{symbolType:(e=o.symbolType)!==null&&e!==void 0?e:`M ${-s/2} ${s*Math.sin(r)} L ${s/2} ${-s*Math.sin(r)}`,symbolSize:s})}function xLt(n){const t={};return yc(n,e=>{e.type!=="group"&&e.id&&(t[e.id]=e)}),t}function jq(n,t){return{x:n.x+t[0],y:n.y+t[1]}}function n6(n,t,e,i=!1,r=!1){const o=[t.x-e.x,t.y-e.y];return Lq(o,(i?-1:1)*(r?-1:1)*n/Oq(o))}function SLt(n,t,e,i,r){const o=lPt({x:0,y:0},e,n),s=jq(o,n6(i,o,t,r));return CLt(s,n6(i||1,s,t,r))}function Ws(n,t,e){var i;const r=(i=n.attribute)===null||i===void 0?void 0:i.angle;if(sD(r,Number.EPSILON))return e>e4(n.AABBBounds,t.AABBBounds);const o=n.OBBBounds,s=t.OBBBounds;return!o||!s||o.empty()||s.empty()?e>e4(n.AABBBounds,t.AABBBounds):o.intersects(s)||e>gPt(o,s)}function Hk(n,t){for(let e,i=1,r=n.length,o=n[0];i<r;o=e,++i)if(e=n[i],Ws(o,e,t))return!0;return!1}const ALt=(n,t,e)=>{const i=n.target;return i!==e&&i.name&&!Qe(i.states)?(i.addState(Rr.hover,!0),yc(t,r=>{r!==i&&r.name&&!Qe(r.states)&&r.addState(Rr.hoverReverse,!0)}),i):e},TLt=(n,t,e)=>e&&(yc(t,i=>{i.name&&!Qe(i.states)&&(i.removeState(Rr.hoverReverse),i.removeState(Rr.hover))}),null),MLt=(n,t,e)=>{const i=n.target;return e===i&&i.hasState(Rr.selected)?(yc(t,r=>{r.name&&!Qe(r.states)&&(r.removeState(Rr.selectedReverse),r.removeState(Rr.selected))}),null):i.name&&!Qe(i.states)?(i.addState(Rr.selected,!0),yc(t,r=>{r!==i&&r.name&&!Qe(r.states)&&r.addState(Rr.selectedReverse,!0)}),i):e};class RLt extends Ro{_prepareAnimate(t){if(this.attribute.animation!==!1){const{animation:e,animationEnter:i,animationExit:r,animationUpdate:o}=this.attribute,s=Js(e)?e:{};this._animationConfig={enter:i!==!1&&Wt({},t,s,i??{}),exit:r!==!1&&Wt({},t,s,r??{}),update:o!==!1&&(Ge(o)?o:Wt({},t,s,o??{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}const BLt={type:"default",duration:300,easing:"linear"};class PLt extends RLt{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=ALt(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=TLt(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=MLt(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){const e=aq(this.attribute);e.scale=this.attribute.scale,this.attribute=t;const i=kt.group({x:this.attribute.x,y:this.attribute.y});return this.add(i),this._renderInner(i),this.removeChild(i),this.attribute=e,i.AABBBounds}render(){this._prepare(),this._prevInnerView=this._innerView&&xLt(this._innerView),this.removeAllChild(!0),this._innerView=kt.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent(),this.runAnimation()}_prepare(){this._prepareAnimate(BLt)}_bindEvent(){if(this.attribute.disableTriggerEvent)return;const{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){const{title:e,label:i,tick:r,line:o,items:s}=this.attribute,a=kt.group({x:0,y:0,zIndex:1,pickable:!1});if(a.name=Yn.axisContainer,a.id=this._getNodeId("container"),a.setMode(this.mode),this.axisContainer=a,t.add(a),o&&o.visible&&this.renderLine(a),s&&s.length&&(this.data=this._transformItems(s[0]),r&&r.visible&&this.renderTicks(a),i&&i.visible)){const l=kt.group({x:0,y:0,pickable:!1});l.name=Yn.labelContainer,l.id=this._getNodeId("label-container"),this.axisLabelsContainer=l,a.add(l),s.forEach((h,u)=>{const d=this.renderLabels(l,h,u),c=d.getChildren();this.beforeLabelsOverlap(c,h,d,u,s.length),this.handleLabelsOverlap(c,h,d,u,s.length),this.afterLabelsOverlap(c,h,d,u,s.length);let f=0,g=0,p="center",v="middle",m=0;c.forEach((y,b)=>{var _;const w=y.attribute,C=(_=w.angle)!==null&&_!==void 0?_:0,x=y.AABBBounds;let S=x.width(),A=x.height();C&&(S=Math.abs(S*Math.cos(C)),A=Math.abs(A*Math.sin(C))),f=Math.max(f,S),g=Math.max(g,A),p=w.textAlign,v=w.textBaseline,b===0&&(m=w.x)}),this.axisLabelLayerSize[u]={width:f,height:g,labelPos:m,textAlign:p,textBaseline:v}})}e&&e.visible&&this.renderTitle(a)}renderTicks(t){const e=this.getTickLineItems(),i=kt.group({x:0,y:0,pickable:!1});i.name=Yn.tickContainer,i.id=this._getNodeId("tick-container"),t.add(i),e.forEach((o,s)=>{var a;const l=kt.line(Object.assign({},this._getTickLineAttribute("tick",o,s,e)));if(l.name=Yn.tick,l.id=this._getNodeId(o.id),Qe((a=this.attribute.tick)===null||a===void 0?void 0:a.state))l.states=of;else{const h=this.data[s],u=Wt({},of,this.attribute.tick.state);Object.keys(u).forEach(d=>{zi(u[d])&&(u[d]=u[d](h.rawValue,s,h,this.data))}),l.states=u}i.add(l)}),this.tickLineItems=e;const{subTick:r}=this.attribute;if(r&&r.visible){const o=this.getSubTickLineItems();o.length&&o.forEach((s,a)=>{const l=kt.line(Object.assign({},this._getTickLineAttribute("subTick",s,a,e)));if(l.name=Yn.subTick,l.id=this._getNodeId(`${a}`),Qe(r.state))l.states=of;else{const h=Wt({},of,r.state);Object.keys(h).forEach(u=>{zi(h[u])&&(h[u]=h[u](s.value,a,s,e))}),l.states=h}i.add(l)}),this.subTickLineItems=o}}renderLabels(t,e,i){const{dataFilter:r}=this.attribute.label;r&&zi(r)&&(e=r(e,i));const o=this._transformItems(e),s=kt.group({x:0,y:0,pickable:!1});return s.name=`${Yn.labelContainer}-layer-${i}`,s.id=this._getNodeId(`label-container-layer-${i}`),t.add(s),o.forEach((a,l)=>{var h;const u=this._getLabelAttribute(a,l,o,i),d=Dk(u);if(d.name=Yn.label,d.id=this._getNodeId(`layer${i}-label-${a.id}`),Qe((h=this.attribute.label)===null||h===void 0?void 0:h.state))d.states=of;else{const c=Wt({},of,this.attribute.label.state);Object.keys(c).forEach(f=>{zi(c[f])&&(c[f]=c[f](a,l,o,i))}),d.states=c}d.data=Object.assign(Object.assign({},a),{index:l,layer:i}),s.add(d)}),s}renderTitle(t){const e=this.getTitleAttribute(),i=new ou(Object.assign({},e));i.name=Yn.title,i.id=this._getNodeId("title"),t.add(i)}getVerticalCoord(t,e,i){return jq(t,this.getVerticalVector(e,i,t))}getTickLineItems(){const{tick:t}=this.attribute,e=this.data,i=[],{alignWithLabel:r,inside:o=!1,length:s,dataFilter:a}=t;let l=1;return e.length>=2&&(l=e[1].value-e[0].value),(a&&zi(a)?a(e):e).forEach(h=>{let u=h.point,d=h.value;if(!r){const f=h.value-l/2;if(this.isInValidValue(f))return;u=this.getTickCoord(f),d=f}const c=this.getVerticalCoord(u,s,o);if(this.mode==="3d"){const f=this.getVerticalVector(s,o,u);let g=0,p=0;ZW(f[0])>ZW(f[1])?g=Wo/2*(c.x>u.x?1:-1):p=Wo/2*(c.y>u.y?-1:1),i.push({start:u,end:c,value:d,id:`tick-${h.id}`,anchor:[u.x,u.y],alpha:g,beta:p})}else i.push({start:u,end:c,value:d,id:`tick-${h.id}`})}),i}getSubTickLineItems(){const{subTick:t}=this.attribute,e=[],{count:i=4,inside:r=!1,length:o=2}=t,s=this.tickLineItems,a=s.length;if(a>=2)for(let l=0;l<a-1;l++){const h=s[l],u=s[l+1];for(let d=0;d<i;d++){const c=(d+1)/(i+1),f=(1-c)*h.value+c*u.value,g=this.getTickCoord(f),p=this.getVerticalCoord(g,o,r);e.push({start:g,end:p,value:f,id:`sub-tick-${f}`})}}return e}_getTickLineAttribute(t,e,i,r){let o=Mr(this.attribute,`${t}.style`);const s=this.data[i];o=zi(o)?Wt({},Mr(Ik,`${t}.style`),t==="tick"?o(s.rawValue,i,s,this.data):o(e.value,i,e,r)):o;const{start:a,end:l,anchor:h,alpha:u,beta:d}=e;return Object.assign({points:[a,l],anchor:h,alpha:u,beta:d},o)}_getLabelAttribute(t,e,i,r){var o,s;const{space:a=4,inside:l=!1,formatMethod:h,type:u="text",text:d}=this.attribute.label;let c=a,f=0;!((o=this.attribute.tick)===null||o===void 0)&&o.visible&&this.attribute.tick.inside===l&&(f=this.attribute.tick.length||4),!((s=this.attribute.subTick)===null||s===void 0)&&s.visible&&this.attribute.subTick.inside===l&&(f=Math.max(f,this.attribute.subTick.length||2)),c+=f;const g=this.getRelativeVector(t.point);r>0&&(g[1]===0?c+=(this.axisLabelLayerSize[r-1].height+Mr(this.attribute,"label.space",4))*r:c+=(this.axisLabelLayerSize[r-1].width+Mr(this.attribute,"label.space",4))*r);const p=this.getVerticalCoord(t.point,c,l),v=this.getVerticalVector(c||1,l,p),m=h?h(`${t.label}`,t,e,i,r):t.label;let{style:y}=this.attribute.label;y=zi(y)?Wt({},Ik.label.style,y(t,e,i,r)):y;const b=this.getLabelAlign(v,l,y.angle);return y=Wt(b,y),zi(y.text)&&(y.text=y.text({label:t.label,value:t.rawValue,index:t.index,layer:r})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(p,v,m,y)),{text:d??m,_originText:t.label,lineHeight:y?.fontSize,type:u}),y)}getLabelPosition(t,e,i,r){return t}_transformItems(t){const e=[];return t.forEach(i=>{var r;e.push(Object.assign(Object.assign({},i),{point:this.getTickCoord(i.value),id:(r=i.id)!==null&&r!==void 0?r:i.label}))}),e}runAnimation(){const t=this.lastScale;if(this.attribute.scale){const e=this.attribute.scale;this.lastScale=e.clone(),this.lastScale.range([0,1])}if(this.attribute.animation&&this.applyAnimationState){const e=this.getInnerView(),i=this.getPrevInnerView();if(!i)return;const r=this._animationConfig;this._newElementAttrMap={},yc(e,o=>{var s;if(o.type!=="group"&&o.id){const a=i[o.id];if(o.setFinalAttributes(o.attribute),a){a.release();const l=a.attribute,h=o.getFinalAttribute(),u=fBt(l,h);let d=Object.keys(u).length>0;if("opacity"in l&&h.opacity!==l.opacity&&(u.opacity=(s=h.opacity)!==null&&s!==void 0?s:1,d=!0),r.update&&d){this._newElementAttrMap[o.id]={state:"update",node:o,attrs:o.attribute};const c=a.attribute;o.setAttributes(c),o.applyAnimationState(["update"],[{name:"update",animation:Object.assign(Object.assign({selfOnly:!0},r.update),{type:"axisUpdate",customParameters:{config:r.update,diffAttrs:u,lastScale:t}})}])}}else r.enter&&(this._newElementAttrMap[o.id]={state:"enter",node:o,attrs:o.attribute},o.applyAnimationState(["enter"],[{name:"enter",animation:Object.assign(Object.assign({},r.enter),{type:"axisEnter",selfOnly:!0,customParameters:{config:r.enter,lastScale:t,getTickCoord:this.getTickCoord.bind(this)}})}]))}})}}release(){super.release(),this._prevInnerView=null,this._innerView=null}}const r6={parity:function(n){return n.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(n,t){let e;return n.filter((i,r)=>r&&Ws(e,i,t)?i.setAttribute("opacity",0):(e=i,1))}};function kLt(n){let t;return t=n.OBBBounds.empty()?n.AABBBounds:n.OBBBounds,t.width()>1&&t.height()>1}function ELt(n){return n.forEach(t=>t.setAttribute("opacity",1)),n}function o6(n,t,e,i,r=!1){if(e&&!n.attribute.opacity){const o=t.length;if(o>1){n.setAttribute("opacity",1);for(let s=0;s<o;s++){const a=r?t[o-1-s]:t[s];if(!i(a))break;a.setAttribute("opacity",0)}}}}function LLt(n,t){if(Qe(n))return;const e=n.filter(kLt);if(Qe(e))return;let i;i=ELt(e);const{method:r="parity",separation:o=0}=t,s=zi(r)?r:r6[r]||r6.parity;if(i.length>=3&&Hk(i,o)){do i=s(i,o);while(i.length>=3&&Hk(i,o));const a=(c,f,g=!0)=>g&&c<3||f,l=a(i.length,t.firstVisible,!1);let h=a(i.length,t.lastVisible);const u=e[0],d=Ef(e);Ws(u,d,o)&&l&&h&&(d.setAttribute("opacity",0),h=!1),o6(u,i,l,c=>Ws(c,u,o)),o6(d,i,h,c=>Ws(c,d,o)||!(!l||c===u)&&Ws(c,u,o),!0)}e.forEach(a=>{a.setAttribute("visible",!!a.attribute.opacity)})}function OLt(n,t){if(Qe(n))return;const{orient:e,labelRotateAngle:i=[0,45,90]}=t;if(i.length===0||n.some(s=>!!s.attribute.angle))return;let r=0,o=0;for(i&&i.length>0&&(o=i.length);r<o;){const s=i[r++];if(n.forEach(a=>{a.attribute.angle=Ld(s)}),ILt(e,n),!DLt(n))break}}function DLt(n){for(let t=1;t<n.length;t++)if(_Lt(n[t-1],n[t]))return!0;return!1}function ILt(n,t){n!=="bottom"&&n!=="top"||FLt(n,t),n!=="left"&&n!=="right"||HLt(n,t),bLt(t)}function CA(n=0){if(n<0)for(;n<0;)n+=2*Math.PI;if(n>0)for(;n>=2*Math.PI;)n-=2*Math.PI;return n}function HLt(n,t){t.forEach((e,i)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},Xq(n,e.attribute.angle)),{angle:CA(e.attribute.angle)}))})}function FLt(n,t){t.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},Uq(n,e.attribute.angle)),{angle:CA(e.attribute.angle)}))})}function Uq(n,t=0){let e=["center","left","left","left","center","right","right","right","left"],i=["top","top","middle","bottom","bottom","bottom","middle","top","top"];n==="top"&&(e=["center","right","right","right","center","left","left","left","right"],i=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);const r=(t=CA(t))/(.5*Math.PI);let o;return o=r===Math.floor(r)?2*Math.floor(r):2*Math.floor(r)+1,{textAlign:e[o],textBaseline:i[o]}}function Xq(n,t=0){let e=["right","right","center","left","left","left","center","right","right"],i=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];n==="right"&&(e=["left","left","center","right","right","right","center","left","left"],i=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);const r=(t=CA(t))/(.5*Math.PI);let o;return o=r===Math.floor(r)?2*Math.floor(r):2*Math.floor(r)+1,{textAlign:e[o],textBaseline:i[o]}}function zLt(n){return Zi(n)?{left:n,right:n}:Js(n)?{left:n.left||0,right:n.right||0}:{left:0,right:0}}function NLt(n,t){const{limitLength:e,verticalLimitLength:i,ellipsis:r="...",orient:o,axisLength:s}=t;if(Qe(n)||!Zi(e))return;const a=zLt(t.overflowLimitLength),l=n[0],h=l.attribute.angle,u=!ee(h),d=u?Math.cos(h):1,c=u?Math.sin(h):0,f=sD(h),g=$q(h),p=o==="top"||o==="bottom",v=l.attribute.direction,m=!f&&!g&&p&&(n.length<2||n.some(y=>Math.abs(y.AABBBounds.width()-l.AABBBounds.width())>=2))&&l.AABBBounds.width()>Math.abs(e/c);n.forEach(y=>{var b;if(p&&(g&&Math.floor(y.AABBBounds.height())<=e||f&&Math.floor(y.AABBBounds.width())<=i)||!p&&(v==="vertical"&&Math.floor(y.AABBBounds.height())<=i||v!=="vertical"&&(f&&Math.floor(y.AABBBounds.width())<=e||g&&Math.floor(y.AABBBounds.height())<=i)))return;let _=null;if(f||g)_=p?f?i:e:v==="vertical"||g?i:e;else if(p){const{x1:w,x2:C}=y.AABBBounds,x=c/d,S=Math.abs(e/c);if(m&&x>0&&w<=s+a.right&&e/x+w>s+a.right){const A=(s-w+a.right)/Math.abs(d);_=Math.min(A,S)}else if(m&&x<0&&C>=-a.left&&e/x+C<-a.left){const A=(C+a.left)/Math.abs(d);_=Math.min(A,S)}else _=S}else _=Math.abs(e/d);Zi(y.attribute.maxLineWidth)&&(_=Zi(_)?Math.min(y.attribute.maxLineWidth,_):y.attribute.maxLineWidth),y.setAttributes({maxLineWidth:_,ellipsis:(b=y.attribute.ellipsis)!==null&&b!==void 0?b:r})})}function WLt(n,t){const{limitLength:e,axisLength:i,ellipsis:r="...",orient:o}=t;if(Qe(n)||!Zi(e))return;const s=n[0].attribute.angle,a=sD(s),l=$q(s),h=o==="top"||o==="bottom";let u=i/n.length;n.forEach((d,c)=>{var f,g,p,v,m;if(h){if(l&&Math.floor(d.AABBBounds.height())<=e)return;if(a){const _=s6(d.attribute.x,(f=n[c+1])===null||f===void 0?void 0:f.attribute.x,(g=n[c-1])===null||g===void 0?void 0:g.attribute.x);Zi(_)&&(u=S1(u,_))}}else{if(l){const _=s6(d.attribute.y,(p=n[c+1])===null||p===void 0?void 0:p.attribute.y,(v=n[c-1])===null||v===void 0?void 0:v.attribute.y);Zi(_)&&(u=S1(u,_))}if(a&&Math.floor(d.AABBBounds.width())<=e)return}let y=null,b=null;h?l?(y=e,b=u):(y=u,b=e):l?(y=u,b=e):(y=e,b=u),d.setAttributes({maxLineWidth:y,ellipsis:(m=d.attribute.ellipsis)!==null&&m!==void 0?m:r,whiteSpace:"normal",heightLimit:b})})}function s6(n,t,e){let i;return Zi(t)&&(i=Math.abs(t-n)),Zi(e)&&(i=Zi(i)?Math.min(Math.abs(n-e),i):Math.abs(n-e)),i}function VLt(n,t,e,i,r){i==="left"||i==="right"?r==="left"?n.forEach(o=>{var s;o.setAttributes({dx:((s=o.attribute.dx)!==null&&s!==void 0?s:0)+t-o.AABBBounds.x1})}):r==="right"?n.forEach(o=>{var s;o.setAttributes({dx:((s=o.attribute.dx)!==null&&s!==void 0?s:0)+t+e-o.AABBBounds.x2})}):r==="center"&&n.forEach(o=>{var s;o.setAttributes({dx:((s=o.attribute.dx)!==null&&s!==void 0?s:0)+t+e/2-(o.AABBBounds.x1+o.AABBBounds.x2)/2})}):i!=="bottom"&&i!=="top"||(r==="top"?n.forEach(o=>{var s;o.setAttributes({dy:((s=o.attribute.dy)!==null&&s!==void 0?s:0)+t-o.AABBBounds.y1})}):r==="bottom"?n.forEach(o=>{var s;o.setAttributes({dy:((s=o.attribute.dy)!==null&&s!==void 0?s:0)+t+e-o.AABBBounds.y2})}):r==="middle"&&n.forEach(o=>{var s;o.setAttributes({dy:((s=o.attribute.dy)!==null&&s!==void 0?s:0)+t+e/2-(o.AABBBounds.y1+o.AABBBounds.y2)/2})}))}class GLt{isInValidValue(t){return t<0||t>1}getTickCoord(t){const{start:e}=this.attribute,i=this.getRelativeVector();return{x:e.x+i[0]*t,y:e.y+i[1]*t}}getRelativeVector(t){const{start:e,end:i}=this.attribute;return[i.x-e.x,i.y-e.y]}getVerticalVector(t,e=!1,i){const{verticalFactor:r=1}=this.attribute,o=this.getRelativeVector(),s=iLt(o),a=[s[1],-1*s[0]];return Lq(a,t*(e?1:-1)*r)}}const aD=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,yl=n=>typeof n=="function",Oi=n=>n==null,yr=n=>n!=null,a6=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||aD(n,"String")},Fk=n=>Array.isArray?Array.isArray(n):aD(n,"Array"),rr=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||aD(n,"Number")},su=n=>rr(n)&&Number.isFinite(n);function $Lt(n){if(!n)return[];if(Object.keys)return Object.keys(n);const t=[];for(const e in n)n.hasOwnProperty(e)&&t.push(e);return t}function jLt(n,t,e){const i=$Lt(t);for(let r=0;r<i.length;r++){const o=i[r];(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}return n}function l6(n,t,e=!0){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){const i=Object.getOwnPropertyNames(t);for(let r=0;r<i.length;r++){const o=i[r];o!=="constructor"&&(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}}else jLt(n,t,e)}const ULt=1e-10,XLt=1e-10;function Yq(n,t,e=XLt,i=ULt){const r=i,o=e*Math.max(n,t);return Math.abs(n-t)<=Math.max(r,o)}const ju=2*Math.PI,WR=Math.sqrt,af=Math.pow;class lD{constructor(t=0,e=0,i,r){this.x=0,this.y=0,this.x=t,this.y=e,this.x1=i,this.y1=r}clone(){return new lD(this.x,this.y)}copyFrom(t){return this.x=t.x,this.y=t.y,this.x1=t.x1,this.y1=t.y1,this.defined=t.defined,this.context=t.context,this}set(t,e){return this.x=t,this.y=e,this}add(t){return rr(t)?(this.x+=t,void(this.y+=t)):(this.x+=t.x,this.y+=t.y,this)}sub(t){return rr(t)?(this.x-=t,void(this.y-=t)):(this.x-=t.x,this.y-=t.y,this)}multi(t){throw new Error("")}div(t){throw new Error("")}}class __{static distancePP(t,e){return WR(af(t.x-e.x,2)+af(t.y-e.y,2))}static distanceNN(t,e,i,r){return WR(af(t-i,2)+af(e-r,2))}static distancePN(t,e,i){return WR(af(e-t.x,2)+af(i-t.y,2))}static pointAtPP(t,e,i){return new lD((e.x-t.x)*i+t.x,(e.y-t.y)*i+t.y)}}class Kt{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return t===0?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return t===0?0:Math.pow(2,10*t-10)}static expoOut(t){return t===1?1:1-Math.pow(2,-10*t)}static expoInOut(t){return t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-Kt.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*Kt.bounceIn(2*t):.5*Kt.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(i){if(i===0||i===1)return i;const r=e/ju*Math.asin(1/t);return-t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*ju/e)}}static getElasticOut(t,e){return function(i){if(i===0||i===1)return i;const r=e/ju*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-r)*ju/e)+1}}static getElasticInOut(t,e){return function(i){const r=e/ju*Math.asin(1/t);return(i*=2)<1?t*Math.pow(2,10*(i-=1))*Math.sin((i-r)*ju/e)*-.5:t*Math.pow(2,-10*(i-=1))*Math.sin((i-r)*ju/e)*.5+1}}static registerFunc(t,e){Kt[t]=e}}function YLt(n,t){const e=1/t;let i=1;for(;n>e;)n-=e,i*=-1;const r=i*n/e;return r>0?r:1+r}Kt.quadIn=Kt.getPowIn(2),Kt.quadOut=Kt.getPowOut(2),Kt.quadInOut=Kt.getPowInOut(2),Kt.cubicIn=Kt.getPowIn(3),Kt.cubicOut=Kt.getPowOut(3),Kt.cubicInOut=Kt.getPowInOut(3),Kt.quartIn=Kt.getPowIn(4),Kt.quartOut=Kt.getPowOut(4),Kt.quartInOut=Kt.getPowInOut(4),Kt.quintIn=Kt.getPowIn(5),Kt.quintOut=Kt.getPowOut(5),Kt.quintInOut=Kt.getPowInOut(5),Kt.backIn=Kt.getBackIn(1.7),Kt.backOut=Kt.getBackOut(1.7),Kt.backInOut=Kt.getBackInOut(1.7),Kt.elasticIn=Kt.getElasticIn(1,.3),Kt.elasticOut=Kt.getElasticOut(1,.3),Kt.elasticInOut=Kt.getElasticInOut(1,.3*1.5),Kt.easeInOutQuad=n=>(n/=.5)<1?.5*Math.pow(n,2):-.5*((n-=2)*n-2),Kt.easeOutElastic=n=>{const t=2*Math.PI/3;return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((10*n-.75)*t)+1},Kt.easeInOutElastic=n=>{const t=2*Math.PI/4.5;return n===0?0:n===1?1:n<.5?-Math.pow(2,20*n-10)*Math.sin((20*n-11.125)*t)/2:Math.pow(2,-20*n+10)*Math.sin((20*n-11.125)*t)/2+1};for(let n=0;n<10;n++)Kt[`flicker${n}`]=t=>YLt(t,n);for(let n=2;n<10;n++)Kt[`aIn${n}`]=t=>n*t*t+(1-n)*t;function Ci(n,t,e){return n+(t-n)*e}class KLt{constructor(){this.opacity=(t,e,i,r,o,s)=>{s.attribute.opacity=Ci(e,i,r)},this.baseOpacity=(t,e,i,r,o,s)=>{s.attribute.baseOpacity=Ci(e,i,r)},this.fillOpacity=(t,e,i,r,o,s)=>{s.attribute.fillOpacity=Ci(e,i,r)},this.strokeOpacity=(t,e,i,r,o,s)=>{s.attribute.strokeOpacity=Ci(e,i,r)},this.zIndex=(t,e,i,r,o,s)=>{s.attribute.zIndex=Ci(e,i,r)},this.backgroundOpacity=(t,e,i,r,o,s)=>{s.attribute.backgroundOpacity=Ci(e,i,r)},this.shadowOffsetX=(t,e,i,r,o,s)=>{s.attribute.shadowOffsetX=Ci(e,i,r)},this.shadowOffsetY=(t,e,i,r,o,s)=>{s.attribute.shadowOffsetY=Ci(e,i,r)},this.shadowBlur=(t,e,i,r,o,s)=>{s.attribute.shadowBlur=Ci(e,i,r)},this.fill=(t,e,i,r,o,s)=>{s.attribute.fill=pc(e,i,r,!1)},this.fillPure=(t,e,i,r,o,s)=>{s.attribute.fill=o.fromParsedProps.fill?iW(o.fromParsedProps.fill,o.toParsedProps.fill,r):o.toParsedProps.fill},this.stroke=(t,e,i,r,o,s)=>{s.attribute.stroke=pc(e,i,r,!1)},this.strokePure=(t,e,i,r,o,s)=>{s.attribute.stroke=o.fromParsedProps.stroke?iW(o.fromParsedProps.stroke,o.toParsedProps.stroke,r):o.toParsedProps.stroke},this.width=(t,e,i,r,o,s)=>{s.attribute.width=Ci(e,i,r),s.addUpdateBoundTag()},this.height=(t,e,i,r,o,s)=>{s.attribute.height=Ci(e,i,r),s.addUpdateBoundTag()},this.x=(t,e,i,r,o,s)=>{s.attribute.x=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.y=(t,e,i,r,o,s)=>{s.attribute.y=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.dx=(t,e,i,r,o,s)=>{s.attribute.dx=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.dy=(t,e,i,r,o,s)=>{s.attribute.dy=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.angle=(t,e,i,r,o,s)=>{s.attribute.angle=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.scaleX=(t,e,i,r,o,s)=>{s.attribute.scaleX=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.scaleY=(t,e,i,r,o,s)=>{s.attribute.scaleY=Ci(e,i,r),s.addUpdateBoundTag(),s.addUpdatePositionTag()},this.lineWidth=(t,e,i,r,o,s)=>{s.attribute.lineWidth=Ci(e,i,r),s.addUpdateBoundTag()},this.startAngle=(t,e,i,r,o,s)=>{s.attribute.startAngle=Ci(e,i,r),s.addUpdateBoundTag()},this.endAngle=(t,e,i,r,o,s)=>{s.attribute.endAngle=Ci(e,i,r),s.addUpdateBoundTag()},this.radius=(t,e,i,r,o,s)=>{s.attribute.radius=Ci(e,i,r),s.addUpdateBoundTag()},this.outerRadius=(t,e,i,r,o,s)=>{s.attribute.outerRadius=Ci(e,i,r),s.addUpdateBoundTag()},this.innerRadius=(t,e,i,r,o,s)=>{s.attribute.innerRadius=Ci(e,i,r),s.addUpdateBoundTag()},this.size=(t,e,i,r,o,s)=>{s.attribute.size=Ci(e,i,r),s.addUpdateBoundTag()},this.points=(t,e,i,r,o,s)=>{s.attribute.points=HO(e,i,r),s.addUpdateBoundTag()}}}const _v=new KLt;function h6(n,t,e,i,r,o){if(Number.isFinite(e)&&Number.isFinite(t))return o.attribute[n]=t+(e-t)*i,!0;if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){const s=[];let a=!0;for(let l=0;l<e.length;l++){const h=t[l],u=h+(e[l]-h)*i;if(!Number.isFinite(u)){a=!1;break}s.push(u)}return a&&(o.attribute[n]=s),!0}return!1}function u6(){}class U1{constructor(t,e,i,r){var o;this._startTime=0,this._hasFirstRun=!1,this._syncAttributeUpdate=()=>{this.target.setAttributes(this.target.attribute)},this.type=t,this.props=e,this.duration=i,this.easing=r?typeof r=="function"?r:(o=Kt[r])!==null&&o!==void 0?o:Kt.linear:Kt.linear,t==="wait"&&(this.onUpdate=u6),this.id=nn.GenAutoIncrementId(),this.syncAttributeUpdate=u6}bind(t,e){this.target=t,this.animate=e,this.onBind(),this.syncAttributeUpdate()}append(t){this.next=t,t.prev=this,t.setStartTime(this.getStartTime()+this.duration,!1)}updateDownstreamStartTimes(){let t=this.next,e=this._startTime+this.duration;for(;t;)t.setStartTime(e,!1),e+=t.duration,t=t.next;this.animate.updateDuration()}getLastProps(){return this.prev?this.prev.props||{}:this.animate.getStartProps()}setDuration(t,e=!0){this.duration=t,e&&this.updateDownstreamStartTimes()}getDuration(){return this.duration}determineInterpolateUpdateFunction(){if(!this.props)return;const t=[];this.propKeys.forEach(e=>{if(e==="fill"||e==="stroke"){const i=this.fromProps[e],r=this.props[e];if(a6(i)&&a6(r)){const o=an.Get(i,Us.Color255),s=an.Get(r,Us.Color255);this.fromParsedProps||(this.fromParsedProps={}),this.toParsedProps||(this.toParsedProps={}),this.fromParsedProps[e]=o,this.toParsedProps[e]=s,t.push(_v[e==="fill"?"fillPure":"strokePure"])}else _v[e]?t.push(_v[e]):t.push(h6)}else _v[e]?t.push(_v[e]):t.push(h6)}),this.interpolateUpdateFunctions=t}setStartTime(t,e=!0){this._startTime=t,e&&this.updateDownstreamStartTimes()}getStartTime(){return this._startTime}onBind(){this.target.type==="glyph"&&(this.syncAttributeUpdate=this._syncAttributeUpdate)}onFirstRun(){}onStart(){if(!this._hasFirstRun){this._hasFirstRun=!0,this.fromProps=this.getLastProps();const t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.fromProps[e]=(i=this.fromProps[e])!==null&&i!==void 0?i:t[e]}),this.determineInterpolateUpdateFunction(),this.tryPreventConflict(),this.trySyncStartProps(),this.onFirstRun()}}tryPreventConflict(){const t=this.animate;this.target.animates.forEach(e=>{if(e===t||e.priority>t.priority||e.priority===1/0)return;const i=e.getStartProps();this.propKeys.forEach(r=>{i[r]!=null&&e.preventAttr(r)})})}deleteSelfAttr(t){var e;delete this.props[t],this.fromProps&&delete this.fromProps[t];const i=this.propKeys.indexOf(t);i!==-1&&(this.propKeys.splice(i,1),(e=this.interpolateUpdateFunctions)===null||e===void 0||e.splice(i,1))}trySyncStartProps(){this.propKeys.forEach(t=>{this.fromProps[t]=this.animate.target.getComputedAttribute(t)})}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.fromProps[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}onUpdate(t,e,i){}onEnd(t){this.target.setAttributes(this.props),t?this._endCb=t:this._endCb&&this._endCb(this.animate,this)}getEndProps(){return this.props}getFromProps(){return this.fromProps}getMergedEndProps(){return this.getEndProps()}stop(){}release(){}}class qLt extends U1{constructor(t,e,i,r){super(t,e,i,r)}onStart(){super.onStart();const t=this.getFromProps();this.target.setAttributes(t)}update(t,e,i){this.onStart()}determineInterpolateUpdateFunction(){}}class hD extends Bc{get animateCount(){return this._animateCount}constructor(){super(),this.head=null,this.tail=null,this.animateMap=new Map,this._animateCount=0,this._playSpeed=1,this._totalDuration=0,this._startTime=0,this._currentTime=0,this._animationEndFlag=!0,this.id=nn.GenAutoIncrementId(),this.paused=!1}isRunning(){return!this.paused&&this._animateCount>0}forEachAccessAnimate(t){let e=this.head,i=0;for(;e;){const r=e.next;t(e.animate,i),i++,e=r}}addAnimate(t){const e={animate:t,next:null,prev:null};this.head?this.tail&&(this.tail.next=e,e.prev=this.tail,this.tail=e):(this.head=e,this.tail=e),this.animateMap.set(t,e),this._animateCount++,this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;this._animationEndFlag&&(this._animationEndFlag=!1,this.emit("animationStart"));const e=t*this._playSpeed;this._currentTime+=e,this.forEachAccessAnimate((i,r)=>{i.status===dr.END?this.removeAnimate(i,!0):i.status!==dr.RUNNING&&i.status!==dr.INITIAL||i.advance(e)}),this._animateCount===0&&(this._animationEndFlag=!0,this.emit("animationEnd"))}clear(){this.forEachAccessAnimate(t=>{t.release()}),this.head=null,this.tail=null,this.animateMap.clear(),this._animateCount=0,this._totalDuration=0}removeAnimate(t,e=!0){const i=this.animateMap.get(t);i&&(e&&(t._onRemove&&t._onRemove.forEach(r=>r()),t.release()),i.prev?i.prev.next=i.next:this.head=i.next,i.next?i.next.prev=i.prev:this.tail=i.prev,this.animateMap.delete(t),this._animateCount--,t.getStartTime()+t.getDuration()>=this._totalDuration&&this.recalculateTotalDuration())}recalculateTotalDuration(){this._totalDuration=0,this.forEachAccessAnimate(t=>{this._totalDuration=Math.max(this._totalDuration,t.getStartTime()+t.getDuration())})}getTotalDuration(){return this._totalDuration}getPlaySpeed(){return this._playSpeed}setPlaySpeed(t){this._playSpeed=t}getPlayState(){return this.paused?"paused":this.animateCount===0?"stopped":"playing"}setStartTime(t){this._startTime=t}getStartTime(){return this._startTime}getCurrentTime(){return this._currentTime}setCurrentTime(t){this._currentTime=t}}const uD=new hD;uD.isGlobal=!0;class Kq{constructor(t=nn.GenAutoIncrementId(),e=uD,i){this.id=t,this.status=dr.INITIAL,this._timeline=e,e.addAnimate(this),this.slience=i,this._startTime=0,this._duration=0,this._totalDuration=0,this._loopCount=0,this._currentLoop=0,this._bounce=!1,this._firstStep=null,this._lastStep=null,this._startProps={},this._endProps={},this._preventAttrs=new Set,this.currentTime=0,this.interpolateUpdateFunction=null,this.priority=0}getStartProps(){return this._startProps}getEndProps(){return this._endProps}setTimeline(t){this._timeline=t}getTimeline(){return this._timeline}get timeline(){return this._timeline}bind(t){return this.target=t,this.target.animates||(this.target.animates=new Map),this.target.animates.set(this.id,this),this.onRemove(()=>{this.stop(),this.target.animates.delete(this.id)}),this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.target.animationAttribute||(this.target.animationAttribute={}),this}to(t,e=300,i="linear"){const r=new U1(S0.to,t,e,i);return r.bind(this.target,this),this.updateStepAfterAppend(r),this}wait(t){const e=new qLt(S0.wait,{},t,"linear");return e.bind(this.target,this),this.updateStepAfterAppend(e),this}updateStepAfterAppend(t){this._firstStep?(this._lastStep.append(t),this._lastStep=t):(this._firstStep=t,this._lastStep=t),this.parseStepProps(t),this.updateDuration()}parseStepProps(t){this._lastStep&&(t.propKeys=t.propKeys||Object.keys(t.props),Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=(i=t.props[e])!==null&&i!==void 0?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}))}reSyncProps(){if(!this._lastStep)return;this._endProps={};let t=this._firstStep;for(;t;)Object.keys(this._endProps).forEach(e=>{var i;t.props[e]=(i=t.props[e])!==null&&i!==void 0?i:this._endProps[e]}),t.propKeys.forEach(e=>{this._endProps[e]=t.props[e]}),t=t.next}from(t,e=300,i="linear"){const r=new U1(S0.from,t,e,i);return this._firstStep?(this._lastStep.append(r),this._lastStep=r):(this._firstStep=r,this._lastStep=r),this.updateDuration(),this}play(t){return t.bind(this.target,this),this.updateStepAfterAppend(t),this}pause(){this.status===dr.RUNNING&&(this.status=dr.PAUSED)}resume(){this.status===dr.PAUSED&&(this.status=dr.RUNNING)}onStart(t){var e;t?(this._onStart||(this._onStart=[]),this._onStart.push(t)):((e=this._onStart)===null||e===void 0||e.forEach(i=>i()),Object.keys(this._endProps).forEach(i=>{this._startProps[i]=this.target.getComputedAttribute(i)}))}onEnd(t){var e;t?(this._onEnd||(this._onEnd=[]),this._onEnd.push(t)):(e=this._onEnd)===null||e===void 0||e.forEach(i=>i())}onFrame(t){t&&(this._onFrame||(this._onFrame=[]),this._onFrame.push(t))}onRemove(t){var e;t?(this._onRemove||(this._onRemove=[]),this._onRemove.push(t)):(e=this._onRemove)===null||e===void 0||e.forEach(i=>i())}preventAttr(t){this._preventAttrs.add(t),delete this._startProps[t],delete this._endProps[t];let e=this._firstStep;for(;e;)e.deleteSelfAttr(t),e=e.next}preventAttrs(t){t.forEach(e=>this._preventAttrs.add(e))}validAttr(t){return!this._preventAttrs.has(t)}runCb(t){var e;return(e=this._lastStep)===null||e===void 0||e.onEnd(t),this}startAt(t){return this._startTime=t,this}customInterpolate(t,e,i,r,o,s){return!1}getFromValue(){return this._startProps}getToValue(){return this._endProps}stop(t){let e=this._firstStep;for(;e;)e.stop(),e=e.next;this.status!==dr.END&&this.onEnd(),this.status=dr.END,this.target&&(t==="start"?this.target.setAttributes(this._startProps):t==="end"?this.target.setAttributes(this._endProps):t&&this.target.setAttributes(t))}release(){this.status=dr.END,this._onRemove&&this._onRemove.forEach(t=>t()),this._onStart=[],this._onFrame=[],this._onEnd=[],this._onRemove=[],this.forEachStep(t=>{t.release()})}getDuration(){return this._duration}getStartTime(){return this._startTime}afterAll(t){if(!t||t.length===0)return this;let e=0;return t.forEach(i=>{const r=i.getStartTime()+i.getTotalDuration();e=Math.max(e,r)}),this.startAt(e)}after(t){if(!t)return this;const e=t.getStartTime()+t.getTotalDuration();return this.startAt(e)}parallel(t){return t?(this.startAt(t.getStartTime()),this):this}loop(t){return t===!0?t=1/0:t===!1&&(t=0),this._loopCount=t,this.updateDuration(),this}bounce(t){return this._bounce=t,this}advance(t){var e,i,r;if(this.status===dr.END)return;const o=this.currentTime+t;if(o<this._startTime)return void(this.currentTime=o);if(o>=this._startTime+this._totalDuration)return(e=this._lastStep)===null||e===void 0||e.onUpdate(!0,1,{}),(i=this._lastStep)===null||i===void 0||i.onEnd(),this.onEnd(),void(this.status=dr.END);this.status=dr.RUNNING,this.currentTime<=this._startTime&&this.onStart(),this.currentTime=o;let s=o-this._startTime,a=!1,l=!1;if(this._loopCount>0){s=(o-this._startTime)%this._duration;const c=Math.floor((o-this._startTime)/this._duration);a=c>this._currentLoop,this._currentLoop=c,l=this._bounce&&c%2==1,l&&(s=this._duration-s)}a&&!l&&this.target.setAttributes(this._startProps);let h=null;if(this._lastStep===this._firstStep)h=this._firstStep;else{let c=this._firstStep;for(;c;){const f=c.getStartTime(),g=c.getDuration();if(s>=f&&s<=f+g){h=c;break}c=c.next}}if(!h)return;h!==this.lastRunStep&&((r=this.lastRunStep)===null||r===void 0||r.onEnd()),this.lastRunStep=h;const u=(s-h.getStartTime())/h.getDuration(),d=u>=1;h.update(d,u,{}),d&&(h.onEnd(),this.lastRunStep=null)}updateDuration(){this._lastStep?(this._duration=this._lastStep.getStartTime()+this._lastStep.getDuration(),this._totalDuration=this._duration*(this._loopCount+1)):this._duration=0}getTotalDuration(){return this._totalDuration}getLoop(){return this._loopCount}forEachStep(t){let e=this._firstStep;for(;e;)t(e),e=e.next}}const ZLt=new ZY;class JLt{constructor(){this.released=!1}tick(t,e){ZLt.addAnimationFrameCb(()=>{if(!this.released)return e(this)})}release(){this.released=!0}getTime(){return Date.now()}}class qq extends Bc{constructor(t){super(),this.timelines=[],this.frameTimeHistory=[],this.handleTick=(e,i)=>{const{once:r=!1}=i??{};if(this.ifCanStop())return this.stop(),!1;const o=e.getTime();this._lastTickTime=o,this.lastFrameTime<0&&(this.lastFrameTime=o-this.interval+this.timeOffset,this.frameTimeHistory.push(this.lastFrameTime));const s=o-this.lastFrameTime,a=this.checkSkip(s);return a||(this._handlerTick(s),this.lastFrameTime=o,this.frameTimeHistory.push(this.lastFrameTime)),r||e.tick(this.interval,this.handleTick),!a},this._handlerTick=e=>{this.status===Dr.RUNNING&&(this.tickCounts++,this.timelines.forEach(i=>{i.tick(e)}),this.emit("tick",e))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.stage=t,this.autoStop=!0,this.interval=16,this.computeTimeOffsetAndJitter()}bindStage(t){this.stage=t}computeTimeOffsetAndJitter(){this.timeOffset=Math.floor(Math.random()*this.interval),this._jitter=Math.min(Math.max(.2*this.interval,6),.7*this.interval)}init(){this.interval=16,this.status=Dr.INITIAL,bt.global.hooks.onSetEnv.tap("graph-ticker",()=>{this.initHandler(!1)}),bt.global.env&&this.initHandler(!1)}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}getTimelines(){return this.timelines}initHandler(t=!1){this.setupTickHandler(t)}setupTickHandler(t=!1){if(!t&&this.tickerHandler)return!0;const e=new JLt;return this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0}setInterval(t){this.interval=t,this.computeTimeOffsetAndJitter()}getInterval(){return this.interval}setFPS(t){this.setInterval(Math.floor(1e3/t))}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,e=>this.handleTick(e,{once:!0}))}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,e=>{this.handleTick(e,{once:!0})})}pause(){return this.status!==Dr.INITIAL&&(this.status=Dr.PAUSE,!0)}resume(){return this.status!==Dr.INITIAL&&(this.status=Dr.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.every(t=>!t.isRunning())))}start(t=!1){return this.status===Dr.RUNNING||!this.tickerHandler||!t&&(this.status===Dr.PAUSE||this.ifCanStop())?!1:(this.status=Dr.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=Dr.INITIAL,this.setupTickHandler(!0),this.lastFrameTime=-1}trySyncTickStatus(){this.status===Dr.INITIAL&&this.timelines.some(t=>t.isRunning())?this.start():this.status===Dr.RUNNING&&this.timelines.every(t=>!t.isRunning())&&this.stop()}release(){var t;this.stop(),this.timelines=[],(t=this.tickerHandler)===null||t===void 0||t.release(),this.tickerHandler=null,this.lastFrameTime=-1}checkSkip(t){var e,i,r;return((r=(i=(e=this.stage)===null||e===void 0?void 0:e.params)===null||i===void 0?void 0:i.optimize)===null||r===void 0?void 0:r.tickRenderMode)==="performance"?!1:t<this.interval+2*(Math.random()-.5)*this._jitter}}class Od{constructor(){this.transitions=new Map,this.registerDefaultTransitions()}static getInstance(){return Od.instance||(Od.instance=new Od),Od.instance}registerDefaultTransitions(){this.registerTransition("appear","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("appear","appear",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("appear","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("appear","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("normal","normal",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("normal","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("normal","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("exit","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","enter",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("exit","exit",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("enter","enter",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("enter","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("enter","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("disappear","*",()=>({allowTransition:!1,stopOriginalTransition:!1})),this.registerTransition("disappear","appear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("update","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("update","exit",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","*",()=>({allowTransition:!0,stopOriginalTransition:!1})),this.registerTransition("state","disappear",()=>({allowTransition:!0,stopOriginalTransition:!0})),this.registerTransition("state","exit",()=>({allowTransition:!0,stopOriginalTransition:!0}))}isTransitionAllowed(t,e,i){var r,o,s,a;let l=(r=this.transitions.get(t))===null||r===void 0?void 0:r.get(e);return l?l(i,t):(l=(o=this.transitions.get(t))===null||o===void 0?void 0:o.get("*"),l?l(i,t):(l=(s=this.transitions.get("*"))===null||s===void 0?void 0:s.get(e),l?l(i,t):(l=(a=this.transitions.get("*"))===null||a===void 0?void 0:a.get("*"),l?l(i,t):{allowTransition:!0,stopOriginalTransition:!0})))}registerTransition(t,e,i){let r=this.transitions.get(t);r||(r=new Map,this.transitions.set(t,r)),r.set(e,i)}}Od.getInstance();class xt{static registerBuiltInAnimate(t,e){xt.builtInAnimateMap[t]=e}constructor(t){this._animates=[],this._startCallbacks=[],this._endCallbacks=[],this._started=!1,this._activeCount=0,this._target=t}get started(){return this._started}onStart(t){t?(this._startCallbacks.push(t),this._started&&this._activeCount>0&&t()):this._startCallbacks.forEach(e=>{e()})}onEnd(t){t?this._endCallbacks.push(t):this._endCallbacks.forEach(e=>{e()})}_trackAnimation(t){this._animates.push(t),this._activeCount++,this._activeCount!==1||this._started||(this._started=!0,this.onStart()),t.onEnd(()=>{this._activeCount--;const e=this._animates.indexOf(t);e>=0&&this._animates.splice(e,1),this._activeCount===0&&this._started&&(this._started=!1,this.onEnd())})}parseParams(t,e,i){var r,o;const s=this.resolveValue(t.totalTime,void 0,void 0),a=this.resolveValue(t.startTime,void 0,0),l=Object.assign({},t);l.oneByOneDelay=0,l.startTime=a,l.totalTime=s;const h=this.resolveValue(t.oneByOne,i,!1);if(e){const u=l.timeSlices;Fk(u)||(l.timeSlices=[u]);let d=0;l.timeSlices=l.timeSlices.map(g=>{const p=this.resolveValue(g.delay,i,0),v=this.resolveValue(g.delayAfter,i,0),m=this.resolveValue(g.duration,i,300);return d+=p+m+v,Object.assign(Object.assign({},g),{delay:p,delayAfter:v,duration:m})});let c=0;h&&(c=typeof h=="number"?h:h?d:0),l.oneByOneDelay=c;let f=1;if(s){const g=d+c*(this._target.count-2);f=s?s/g:1}l.timeSlices=l.timeSlices.map(g=>{let p=g.effects;return Array.isArray(p)||(p=[p]),Object.assign(Object.assign({},g),{delay:g.delay*f,delayAfter:g.delayAfter*f,duration:g.duration*f,effects:p.map(v=>{var m,y;const b=(m=v.custom)!==null&&m!==void 0?m:xt.builtInAnimateMap[(y=v.type)!==null&&y!==void 0?y:"fromTo"],_=b&&yl(b)?/^class\s/.test(Function.prototype.toString.call(b))?1:2:0;return Object.assign(Object.assign({},v),{custom:b,customType:_})})})}),l.oneByOneDelay=c*f,l.startTime=a*f}else{const u=this.resolveValue(t.delay,i,0),d=this.resolveValue(t.delayAfter,i,0),c=this.resolveValue(t.duration,i,300);let f=0;h&&(f=typeof h=="number"?h:h?u+d+c:0),l.oneByOneDelay=f,l.custom=(r=t.custom)!==null&&r!==void 0?r:xt.builtInAnimateMap[(o=t.type)!==null&&o!==void 0?o:"fromTo"];const g=l.custom&&yl(l.custom)?/^class\s/.test(Function.prototype.toString.call(l.custom))?1:2:0;if(l.customType=g,s){const p=u+d+c+f*(this._target.count-2),v=s?s/p:1;l.delay=u*v,l.delayAfter=d*v,l.duration=c*v,l.oneByOneDelay=f*v,l.startTime=a}}return l}execute(t){Array.isArray(t)?t.forEach(e=>this._execute(e)):this._execute(t)}_execute(t){if(t.selfOnly)return this._executeItem(t,this._target,0,1);const e="timeSlices"in t;let i;e&&t.partitioner&&(i=(i??this._target.getChildren()).filter(o=>{var s,a;return t.partitioner((a=(s=o.context)===null||s===void 0?void 0:s.data)===null||a===void 0?void 0:a[0],o,{})})),e&&t.sort&&(i=i??this._target.getChildren(),i.sort((o,s)=>{var a,l,h,u;return t.sort((l=(a=o.context)===null||a===void 0?void 0:a.data)===null||l===void 0?void 0:l[0],(u=(h=s.context)===null||h===void 0?void 0:h.data)===null||u===void 0?void 0:u[0],o,s,{})}));const r=e?(o,s,a)=>{const l=this.parseParams(t,e,o),h=this.executeTimelineItem(l,o,s,a);h&&this._trackAnimation(h)}:(o,s,a)=>{const l=this.parseParams(t,e,o),h=this.executeTypeConfigItem(l,o,s,a);h&&this._trackAnimation(h)};i?i.forEach((o,s)=>r(o,s,i.length)):this._target.count<=1?r(this._target,0,1):this._target.forEachChildren((o,s)=>r(o,s,this._target.count-1))}executeTypeConfigItem(t,e,i,r){var o,s,a,l,h,u,d,c;const{type:f="fromTo",channel:g,customParameters:p,easing:v="linear",delay:m=0,delayAfter:y=0,duration:b=300,startTime:_=0,oneByOneDelay:w=0,loop:C,bounce:x,priority:S=0,options:A,custom:T,customType:M,controlOptions:R}=t,E=e.animate();E.priority=S;const P=yl(m)?m((s=(o=e.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],e,{}):m,B=(l=(a=e.context)===null||a===void 0?void 0:a.data)===null||l===void 0?void 0:l[0],k=(h=e.context)===null||h===void 0?void 0:h.indexKey;B&&k&&(i=(u=B[k])!==null&&u!==void 0?u:i),E.startAt(_);const L=i*w+P;L>0&&E.wait(L);let O=null,D=t.to,I=t.from;D||(O||(O=this.createPropsFromChannel(g,e)),D=O.props),I||(O||(O=this.createPropsFromChannel(g,e)),I=O.from),this._handleRunAnimate(E,T,M,I,D,b,v,p,R,A,f,e);let H=0;w&&(H=w*(r-i-1));const F=yl(y)?y((c=(d=e.context)===null||d===void 0?void 0:d.data)===null||c===void 0?void 0:c[0],e,{}):y;return F>0&&(H+=F),H>0&&E.wait(H),C&&C>0&&E.loop(C),x&&E.bounce(!0),E}_handleRunAnimate(t,e,i,r,o,s,a,l,h,u,d,c){var f,g,p,v,m,y;if(e&&i){const b=Object.assign({width:((f=c.stage)===null||f===void 0?void 0:f.width)||0,height:((g=c.stage)===null||g===void 0?void 0:g.height)||0,group:this._target.parent},this.resolveValue(l,c)),_=yl(u)?u.call(null,(v=b&&((p=b.data)===null||p===void 0?void 0:p[0]))!==null&&v!==void 0?v:(y=(m=c.context)===null||m===void 0?void 0:m.data)===null||y===void 0?void 0:y[0],c,b):u;b.options=_,b.controlOptions=h,i===1?this.createCustomAnimation(t,e,r,o,s,a,b):i===2&&this.createCustomInterpolatorAnimation(t,e,o,s,a,b)}else d==="to"?t.to(o,s,a):d==="from"&&t.from(o,s,a)}executeTimelineItem(t,e,i,r){var o,s,a,l;const{timeSlices:h,startTime:u=0,loop:d,bounce:c,oneByOneDelay:f,priority:g,controlOptions:p}=t,v=(s=(o=e.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],m=(a=e.context)===null||a===void 0?void 0:a.indexKey;v&&m&&(i=(l=v[m])!==null&&l!==void 0?l:i);const y=e.animate();return y.priority=g,y.startAt(u),y.wait(i*f),d&&d>0&&y.loop(d),c&&y.bounce(!0),(Array.isArray(h)?h:[h]).forEach(b=>{this.applyTimeSliceToAnimate(b,y,e,p)}),f&&y.wait(f*(r-i-1)),y}applyTimeSliceToAnimate(t,e,i,r){var o,s,a,l;const{effects:h,duration:u=300,delay:d=0,delayAfter:c=0}=t,f=yl(d)?d((s=(o=i.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],i,{}):d,g=yl(c)?c((l=(a=i.context)===null||a===void 0?void 0:a.data)===null||l===void 0?void 0:l[0],i,{}):c;f>0&&e.wait(f),(Array.isArray(h)?h:[h]).forEach(p=>{var v;const{type:m="fromTo",channel:y,customParameters:b,easing:_="linear",options:w}=p;let C=null,x=p.to,S=p.from;x||(C||(C=this.createPropsFromChannel(y,i)),x=C.props),S||(C||(C=this.createPropsFromChannel(y,i)),S=C.from);const A=(v=p.custom)!==null&&v!==void 0?v:xt.builtInAnimateMap[m],T=p.customType;this._handleRunAnimate(e,A,T,S,x,u,_,b,r,w,m,i)}),g>0&&e.wait(g)}createCustomInterpolatorAnimation(t,e,i,r,o,s){Object.keys(i).forEach(l=>{t.target.getComputedAttribute(l)}),t.interpolateUpdateFunction=(l,h,u,d,c)=>{e(u,l,h,d,c,t.target,s)},t.to(i,r,o)}createCustomAnimation(t,e,i,r,o,s,a){const l=new e(i,r,o,s,a);t.play(l)}createPropsFromChannel(t,e){const i={};let r=null;return t?(Array.isArray(t)?t.forEach(o=>{var s,a;const l=(a=(s=e.context)===null||s===void 0?void 0:s.diffAttrs)===null||a===void 0?void 0:a[o];l!==void 0&&(i[o]=l)}):Object.keys(t).forEach(o=>{var s,a,l,h;const u=t[o];u.to!==void 0&&(typeof u.to=="function"?i[o]=u.to((a=(s=e.context)===null||s===void 0?void 0:s.data)===null||a===void 0?void 0:a[0],e,{}):i[o]=u.to),u.from!==void 0&&(r||(r={}),typeof u.from=="function"?r[o]=u.from((h=(l=e.context)===null||l===void 0?void 0:l.data)===null||h===void 0?void 0:h[0],e,{}):r[o]=u.from)}),{from:r,props:i}):{from:r,props:i}}resolveValue(t,e,i){var r,o;return t===void 0?i:typeof t=="function"&&e?t((o=(r=e.context)===null||r===void 0?void 0:r.data)===null||o===void 0?void 0:o[0],e,{}):t}executeItem(t,e,i=0,r=1){return Array.isArray(t)?t.map(o=>this._executeItem(o,e,i,r)).filter(Boolean):[this._executeItem(t,e,i,r)].filter(Boolean)}_executeItem(t,e,i=0,r=1){if(!e)return null;const o="timeSlices"in t;let s=null;const a=this.parseParams(t,o);return s=o?this.executeTimelineItem(a,e,i,r):this.executeTypeConfigItem(a,e,i,r),s&&this._trackAnimation(s),s}stop(t){for(;this._animates.length>0;){const e=this._animates.pop();e?.stop(t)}this._animates=[],this._activeCount=0,this._started&&(this._started=!1,this.onEnd())}}xt.builtInAnimateMap={};const ma={APPEAR:"appear",DISAPPEAR:"disappear",UPDATE:"update",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight"};class QLt{constructor(t){this.graphic=t}registerState(t){this.states||(this.states=new Map),this.states.set(t.name,t)}clearStates(){var t;(t=this.states)===null||t===void 0||t.clear()}}class tOt{constructor(t){this.stateList=null,this.graphic=t}applyState(t,e,i){const r=Od.getInstance(),o=[],s=[];if(this.stateList&&this.stateList.length?t.forEach((a,l)=>{const h={allowTransition:!0};this.stateList.forEach(u=>{const d=r.isTransitionAllowed(u.state,a,this.graphic);h.allowTransition=h.allowTransition&&d.allowTransition}),h.allowTransition&&(s.push({state:a,animationConfig:Fk(e[l])?e[l].map(u=>u.animation):e[l].animation,executor:new xt(this.graphic)}),this.stateList.forEach(u=>{r.isTransitionAllowed(u.state,a,this.graphic).stopOriginalTransition&&o.push(u)}))}):t.forEach((a,l)=>{s.push({state:a,animationConfig:Fk(e[l])?e[l].map(h=>h.animation):e[l].animation,executor:new xt(this.graphic)})}),o.forEach(a=>{a.executor.stop()}),s.length){s[0].executor.execute(s[0].animationConfig);for(let a=0;a<s.length;a++){const l=s[a+1],h=s[a];h.executor.onEnd(()=>{l&&l.executor.execute(l.animationConfig),this.stateList=this.stateList.filter(u=>u!==h),a===s.length-1&&i&&i(!1)})}}else i&&i(!0);this.stateList?this.stateList=this.stateList.filter(a=>!o.includes(a)):this.stateList=[],this.stateList.push(...s)}applyAppearState(t,e){this.applyState([ma.APPEAR],[{name:ma.APPEAR,animation:t}],e)}applyDisappearState(t,e){this.applyState([ma.DISAPPEAR],[{name:ma.DISAPPEAR,animation:t}],e)}applyUpdateState(t,e){this.applyState([ma.UPDATE],[{name:ma.UPDATE,animation:t}],e)}applyHighlightState(t,e){this.applyState([ma.HIGHLIGHT],[{name:ma.HIGHLIGHT,animation:t}],e)}applyUnhighlightState(t,e){this.applyState([ma.UNHIGHLIGHT],[{name:ma.UNHIGHLIGHT,animation:t}],e)}stopState(t,e){var i;const r=(i=this.stateList)===null||i===void 0?void 0:i.find(o=>o.state===t);r&&r.executor.stop(e)}clearState(){var t;(t=this.stateList)===null||t===void 0||t.forEach(e=>{e.executor.stop()}),this.stateList=null}reApplyState(t){var e;const i=(e=this.stateList)===null||e===void 0?void 0:e.find(r=>r.state===t);if(i&&i.executor.started){const r=this.stateList.slice();i.executor.stop(),this.stateList=r,i.executor.execute(i.animationConfig)}}}class dD{_getAnimationStateManager(t){return t._animationStateManager||(t._animationStateManager=new tOt(t)),t._animationStateManager}_getAnimationStateStore(t){return t._animationStateStore||(t._animationStateStore=new QLt(t)),t._animationStateStore}registerAnimationState(t){return this._getAnimationStateStore(this).registerState(t),this}applyAnimationState(t,e,i){return this._getAnimationStateManager(this).applyState(t,e,i),this}applyAppearState(t,e){return this._getAnimationStateManager(this).applyAppearState(t,e),this}applyDisappearState(t,e){return this._getAnimationStateManager(this).applyDisappearState(t,e),this}applyUpdateState(t,e){return this._getAnimationStateManager(this).applyUpdateState(t,e),this}applyHighlightState(t,e){return this._getAnimationStateManager(this).applyHighlightState(t,e),this}applyUnhighlightState(t,e){return this._getAnimationStateManager(this).applyUnhighlightState(t,e),this}stopAnimationState(t,e,i=!1){return this._getAnimationStateManager(this).stopState(t,e),i&&this.isContainer&&this.forEachChildren(r=>{r.stopAnimationState(t,e,i)}),this}clearAnimationStates(){const t=this._animationStateManager;return t&&t.clearState(),this}reApplyAnimationState(t,e=!1){const i=this._animationStateManager;return i&&i.reApplyState(t),e&&this.isContainer&&this.forEachChildren(r=>{r.reApplyAnimationState(t,e)}),this}static extend(t){return new dD()._getAnimationStateManager(t),t}}class eOt{getAttributes(t=!1){return t&&this.finalAttribute?this.finalAttribute:this.attribute}animate(t){var e,i,r;const o=new Kq(t?.id,(i=(e=t?.timeline)!==null&&e!==void 0?e:this.stage&&this.stage.getTimeline())!==null&&i!==void 0?i:uD,t?.slience);if(o.bind(this),t){const{onStart:s,onEnd:a,onRemove:l}=t;s!=null&&o.onStart(s),a!=null&&o.onEnd(a),l!=null&&o.onRemove(l)}return(r=this.stage)===null||r===void 0||r.ticker.start(),o}createTimeline(){return new hD}createTicker(t){return new qq(t)}setFinalAttributes(t){this.finalAttribute||(this.finalAttribute={}),Object.assign(this.finalAttribute,t)}initFinalAttributes(t){this.finalAttribute=t}initAnimateExecutor(){this._animateExecutor||(this._animateExecutor=new xt(this))}executeAnimation(t){return this.initAnimateExecutor(),this._animateExecutor.execute(t),this}executeAnimations(t){return this.initAnimateExecutor(),t.forEach(e=>{this._animateExecutor.execute(e)}),this}getFinalAttribute(){return this.finalAttribute}getGraphicAttribute(t,e=!1){return!e&&this.finalAttribute?this.finalAttribute[t]:this.attribute[t]}pauseAnimation(t=!1){this.animates&&this.animates.forEach(e=>e.pause()),t&&this.isContainer&&this.forEachChildren(e=>{e.pauseAnimation(t)})}resumeAnimation(t=!1){this.animates&&this.animates.forEach(e=>e.resume()),t&&this.isContainer&&this.forEachChildren(e=>{e.resumeAnimation(t)})}stopAnimation(t=!1){this.animates&&this.animates.forEach(e=>e.stop()),t&&this.isContainer&&this.forEachChildren(e=>{e.stopAnimation(t)})}}function iOt(){l6(An,dD),l6(An,eOt)}class fe extends U1{constructor(t,e,i,r,o){super("customAnimate",e,i,r),this.type="customAnimate",this.customFrom=t,this.params=o,this.from=t,this.to=e}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.onUpdate(t,r,i),this.syncAttributeUpdate()}setProps(t){this.props=t,this.propKeys=Object.keys(t),this.animate.reSyncProps()}}class Tp extends fe{completeBind(t){this.setStartTime(0),this._animator&&this._animator.start(),this.setDuration(t.getDuration())}stop(){this._animator&&this._animator.stop()}}class Zq extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0,this._beforeStageRender=()=>{if(!this.willCallBeforeStageRender)return;this.willCallBeforeStageRender=!1;const s=this.target.stage,a=s.window.getContext().canvas.nativeCanvas,l=this.beforeStageRender(s,a);l&&this.renderToStage(s,l)},this._afterStageRender=()=>{if(!this.willCallAfterStageRender)return;this.willCallAfterStageRender=!1;const s=this.target.stage,a=s.window.getContext().canvas.nativeCanvas,l=this.afterStageRender(s,a);l&&this.renderToStage(s,l)},this.props={}}beforeStageRender(t,e){return!1}afterStageRender(t,e){return!1}onFirstRun(){super.onFirstRun(),this.target.stage.setBeforeRender(this._beforeStageRender),this.target.stage.setAfterRender(this._afterStageRender),this.target.stage.disableDirtyBounds()}stop(){super.stop(),this.target.stage.removeBeforeRender(this._beforeStageRender),this.target.stage.removeAfterRender(this._afterStageRender)}onUpdate(t,e,i){super.onUpdate(t,e,i),this.willCallBeforeStageRender=!0,this.willCallAfterStageRender=!0}renderToStage(t,e){const i=t.window.getContext().canvas.nativeCanvas,r=i.getContext("2d");return!!r&&(r.clearRect(0,0,i.width,i.height),r.drawImage(e,0,0),i)}}class nOt{constructor(t){this.tasks=[],this.started=!1,this.completed=0,this.totalDuration=0,this.onStartCallbacks=[],this.onEndCallbacks=[],this.onUpdateCallbacks=[],this.component=t}animate(t,e){return this.started?this:(this.tasks.push({graphic:t,config:e}),this)}onStart(t){return this.onStartCallbacks.push(t),this}onEnd(t){return this.onEndCallbacks.push(t),this}onUpdate(t){return this.onUpdateCallbacks.push(t),this}start(){return this.started?this:(this.started=!0,this.completed=0,this.onStartCallbacks.forEach(t=>t()),this.tasks.length===0?(setTimeout(()=>{this.onEndCallbacks.forEach(t=>t())},0),this):(this.tasks.forEach(t=>{const e=new xt(t.graphic);e.onEnd(()=>{this.completed++,this.completed===this.tasks.length&&this.onEndCallbacks.forEach(r=>r())});const i=e.executeItem(t.config,t.graphic);t.animate=i,i.forEach(r=>{this.totalDuration=Math.max(this.totalDuration,r.getStartTime()+r.getDuration())})}),this))}deleteSelfAttr(t){this.tasks.forEach(e=>{e.animate&&e.animate.forEach(i=>i.preventAttr(t))})}stop(t){return this.tasks.forEach(e=>{e.animate&&e.animate.forEach(i=>i.stop(t))}),this.started&&this.completed!==this.tasks.length&&(this.onEndCallbacks.forEach(e=>e()),this.completed=this.tasks.length),this}getDuration(){return this.totalDuration}}function Mp(n){return new nOt(n)}class rOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.formatTemplate=null,this.decimalLength=o?.decimalLength,o?.formatTemplate&&o.formatTemplate.includes("{{var}}")&&(this.formatTemplate=o.formatTemplate)}onFirstRun(){var t,e,i;const r=this.getLastProps(),o=this.getEndProps(),s=(t=r.text)!==null&&t!==void 0?t:0,a=(e=o.text)!==null&&e!==void 0?e:0;this.valid=!0;let l=0,h=0,u="",d="",c=0;if(typeof s=="number"){l=s;const f=s.toString().split(".")[1]||"";c=Math.max(c,f.length)}else{if(typeof s!="string")return void(this.valid=!1);if(s.endsWith("%")){u="%";const f=s.substring(0,s.length-1).replace(/,/g,"");if(l=parseFloat(f)/100,isNaN(l))return void(this.valid=!1);const g=f.split(".")[1]||"";c=Math.max(c,g.length+2)}else{const f=s.replace(/,/g,"");if(l=parseFloat(f),isNaN(l))return void(this.valid=!1);s.includes(",")&&(u=",");const g=f.split(".")[1]||"";c=Math.max(c,g.length)}}if(typeof a=="number"){h=a;const f=a.toString().split(".")[1]||"";c=Math.max(c,f.length)}else{if(typeof a!="string")return void(this.valid=!1);if(a.endsWith("%")){d="%";const f=a.substring(0,a.length-1).replace(/,/g,"");if(h=parseFloat(f)/100,isNaN(h))return void(this.valid=!1);const g=f.split(".")[1]||"";c=Math.max(c,g.length+2)}else{const f=a.replace(/,/g,"");if(h=parseFloat(f),isNaN(h))return void(this.valid=!1);a.includes(",")&&(d=",");const g=f.split(".")[1]||"";c=Math.max(c,g.length)}}if(!((i=this.params)===null||i===void 0)&&i.format){switch(this.params.format){case"percent":this.format="%";break;case"thousandth":this.format=",";break;case"none":this.format="";break;default:this.format=d||u}this.format==="%"&&d!=="%"&&u!=="%"&&this.decimalLength===void 0&&(this.decimalLength=2),this.format==="%"||d!=="%"&&u!=="%"||(l*=100,h*=100)}else this.format=d||u;this.fromNumber=l,this.toNumber=h,this.decimalLength===void 0&&(this.decimalLength=c)}onEnd(t){super.onEnd(t),t||this.props&&this.target.setAttributes(this.props)}onUpdate(t,e,i){if(!this.valid)return;const r=this.fromNumber+(this.toNumber-this.fromNumber)*e;let o="";const s=this.format,a=(s==="%"?100*r:r).toFixed(this.decimalLength);let l,h=a;if(parseFloat(a)===Math.floor(parseFloat(a))&&(h=Math.floor(parseFloat(a))),s==="%")l=`${h}%`;else if(s===","){const u=h.toString().split(".");u[0]=u[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),l=u.join(".")}else l=h;o=this.formatTemplate?this.formatTemplate.replace("{{var}}",l.toString()):l,this.target.setAttribute("text",o)}}class Wm extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromText="",this.toText="",this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",o?.showCursor!==void 0&&(this.showCursor=o.showCursor),o?.cursorChar!==void 0&&(this.cursorChar=o.cursorChar),o?.blinkCursor!==void 0&&(this.blinkCursor=o.blinkCursor),o?.beforeText!==void 0&&(this.beforeText=o.beforeText),o?.afterText!==void 0&&(this.afterText=o.afterText)}onFirstRun(){var t,e;const i=this.getLastProps(),r=this.getEndProps(),o=(t=i.text)!==null&&t!==void 0?t:"",s=(e=r.text)!==null&&e!==void 0?e:"";this.valid=!0,this.fromText=o.toString(),this.toText=s.toString(),this.toText||this.toText===""||(this.valid=!1)}onEnd(t){super.onEnd(t),t||(this.showCursor&&!this.blinkCursor?this.target.setAttribute("text",this.beforeText+this.toText+this.cursorChar+this.afterText):this.target.setAttribute("text",this.beforeText+this.toText+this.afterText))}onUpdate(t,e,i){if(!this.valid)return;const r=this.toText.length,o=this.fromText.length;let s,a;o>r?(s=Math.round(o-(o-r)*e),a=this.fromText.substring(0,s)):(s=Math.round(o+(r-o)*e),a=this.toText.startsWith(this.fromText)?this.toText.substring(0,s):s<=o?this.fromText.substring(0,s):this.toText.substring(0,s-o+Math.min(o,s)));let l=this.beforeText+a+this.afterText;this.showCursor&&(this.blinkCursor?Math.floor(e/.1)%2==0&&(l=this.beforeText+a+this.cursorChar+this.afterText):l=this.beforeText+a+this.cursorChar+this.afterText),this.target.setAttribute("text",l)}}class Jq extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i;super.onBind();const r=this.target.getFinalAttribute(),o=(t=this.target.attribute)!==null&&t!==void 0?t:{},s={},a=(e=this.from)!==null&&e!==void 0?e:{};this.keys.forEach(h=>{var u,d,c;s[h]=(u=r?.[h])!==null&&u!==void 0?u:1,a[h]=(c=(d=a[h])!==null&&d!==void 0?d:o[h])!==null&&c!==void 0?c:0});const l=this.target.getFinalAttribute();l&&this.target.setAttributes(l),this.props=s,this.propKeys=this.keys,this.from=a,this.to=s,((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(a)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class Qq extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const t=this.target.attribute,e={},i={};this.keys.forEach(r=>{var o;e[r]=0,i[r]=(o=t[r])!==null&&o!==void 0?o:1}),this.props=e,this.propKeys=this.keys,this.from=i,this.to=e,Object.assign(this.target.attribute,i),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class oOt extends Jq{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["clipRange"],this.from={clipRange:0}}onFirstRun(){var t;super.onFirstRun();const{clipDimension:e}=((t=this.params)===null||t===void 0?void 0:t.options)||{};e&&(this.target.attribute.clipRangeByDimension=e)}}class sOt extends Qq{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["clipRange"]}}class aOt extends Jq{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["opacity","fillOpacity","strokeOpacity"],this.from={opacity:0,fillOpacity:0,strokeOpacity:0}}}class lOt extends Qq{constructor(t,e,i,r,o){super(t,e,i,r,o),this.keys=["opacity","fillOpacity","strokeOpacity"]}}const hOt=(n,t,e)=>{const i=n.getFinalAttribute();return t&&t.orient==="anticlockwise"?{from:{startAngle:i?.endAngle},to:{startAngle:i?.startAngle}}:{from:{endAngle:i?.startAngle},to:{endAngle:i?.endAngle}}},uOt=(n,t,e)=>{const i=n.getFinalAttribute();if(t&&t.orient==="anticlockwise"){const o=rr(t.overall)?t.overall:2*Math.PI;return{from:{startAngle:o,endAngle:o},to:{startAngle:i?.startAngle,endAngle:i?.endAngle}}}const r=rr(t?.overall)?t.overall:0;return{from:{startAngle:r,endAngle:r},to:{startAngle:i?.startAngle,endAngle:i?.endAngle}}},dOt=(n,t,e)=>{var i;return((i=t?.overall)!==null&&i!==void 0&&i)!==!1?uOt(n,t):hOt(n,t)},cOt=(n,t,e)=>{const i=n.attribute;return t&&t.orient==="anticlockwise"?{from:{startAngle:i.startAngle},to:{startAngle:i?.endAngle}}:{from:{endAngle:i.endAngle},to:{endAngle:i?.startAngle}}},fOt=(n,t,e)=>{const i=n.attribute;if(t&&t.orient==="anticlockwise"){const o=rr(t.overall)?t.overall:2*Math.PI;return{from:{startAngle:i.startAngle,endAngle:i.endAngle},to:{startAngle:o,endAngle:o}}}const r=rr(t?.overall)?t.overall:0;return{from:{startAngle:i.startAngle,endAngle:i.endAngle},to:{startAngle:r,endAngle:r}}};class tZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}determineUpdateFunction(){this.propKeys?this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:this.propKeys[0]==="startAngle"?this._updateFunction=this.updateStartAngle:this.propKeys[0]==="endAngle"?this._updateFunction=this.updateEndAngle:this.valid=!1:this.valid=!1}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];const e=this.propKeys.indexOf(t);e!==-1&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateAngle:this.propKeys[0]==="startAngle"?this._updateFunction=this.updateStartAngle:this.propKeys[0]==="endAngle"?this._updateFunction=this.updateEndAngle:this._updateFunction=null}updateStartAngle(t){this.target.attribute.startAngle=this.from.startAngle+(this.to.startAngle-this.from.startAngle)*t}updateEndAngle(t){this.target.attribute.endAngle=this.from.endAngle+(this.to.endAngle-this.from.endAngle)*t}updateAngle(t){this.updateStartAngle(t),this.updateEndAngle(t)}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdateShapeAndBoundsTag())}}class gOt extends tZ{onBind(){var t,e,i;super.onBind();const{from:r,to:o}=dOt(this.target,this.params.options,this.params),s=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:r;this.props=o,this.propKeys=Object.keys(o).filter(l=>o[l]!=null),this.from=s,this.to=o;const a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(s),this.determineUpdateFunction()}}class pOt extends tZ{onBind(){super.onBind();const{from:t,to:e}=(i=this.target,r=this.params.options,this.params,((o=r?.overall)!==null&&o!==void 0&&o)!==!1?fOt(i,r):cOt(i,r));var i,r,o;const s=t;this.props=e,this.propKeys=Object.keys(e).filter(a=>e[a]!=null),this.from=s??this.target.attribute,this.to=e,this.determineUpdateFunction()}}const vOt=(n,t,e)=>{const i=n.getFinalAttribute();switch(t?.direction){case"x":{const r=i.x,o=i.x1,s=i.width;return{from:yr(s)?{x:r+s/2,x1:void 0,width:0}:{x:(r+o)/2,x1:(r+o)/2,width:void 0},to:{x:r,x1:o,width:s}}}case"y":{const r=i.y,o=i.y1,s=i.height;return{from:yr(s)?{y:r+s/2,y1:void 0,height:0}:{y:(r+o)/2,y1:(r+o)/2,height:void 0},to:{y:r,y1:o,height:s}}}default:{const r=i.x,o=i.x1,s=i.width,a=i.y,l=i.y1,h=i.height,u={};return yr(s)?(u.x=r+s/2,u.width=0,u.x1=void 0):(u.x=(r+o)/2,u.x1=(r+o)/2,u.width=void 0),yr(h)?(u.y=a+h/2,u.height=0,u.y1=void 0):(u.y=(a+l)/2,u.y1=(a+l)/2,u.height=void 0),{from:u,to:{x:r,y:a,x1:o,y1:l,width:s,height:h}}}}},mOt=(n,t,e)=>{const i=n.attribute;switch(t?.direction){case"x":{const r=i.x,o=i.x1,s=i.width;return{to:yr(s)?{x:r+s/2,x1:void 0,width:0}:{x:(r+o)/2,x1:(r+o)/2,width:void 0}}}case"y":{const r=i.y,o=i.y1,s=i.height;return{to:yr(s)?{y:r+s/2,y1:void 0,height:0}:{y:(r+o)/2,y1:(r+o)/2,height:void 0}}}default:{const r=i.x,o=i.y,s=i.x1,a=i.y1,l=i.width,h=i.height,u={};return yr(l)?(u.x=r+l/2,u.width=0,u.x1=void 0):(u.x=(r+s)/2,u.x1=(r+s)/2,u.width=void 0),yr(h)?(u.y=o+h/2,u.height=0,u.y1=void 0):(u.y=(o+a)/2,u.y1=(o+a)/2,u.height=void 0),{to:u}}}};class yOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i;super.onBind();const{from:r,to:o}=vOt(this.target,this.params.options,this.params),s=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:r;this.props=o,this.propKeys=Object.keys(o).filter(l=>o[l]!=null),this.from=s,this.to=o;const a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(s)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class bOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const{from:t,to:e}=mOt(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(i=>e[i]!=null),this.from=t??this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}function _Ot(n,t,e){const i=n.getFinalAttribute(),r=i.y,o=i.y1,s=i.height;if(t&&t.orient==="negative"){const l=yr(s)?Math.max(r,r+s):Math.max(r,o);return{from:{y:l,y1:Oi(o)?void 0:l,height:Oi(s)?void 0:0},to:{y:r,y1:o,height:s}}}const a=yr(s)?Math.min(r,r+s):Math.min(r,o);return{from:{y:a,y1:Oi(o)?void 0:a,height:Oi(s)?void 0:0},to:{y:r,y1:o,height:s}}}function COt(n,t,e){var i,r,o;const s=n.getFinalAttribute(),a=s.y,l=s.y1,h=s.height;let u;return t&&t.orient==="negative"?rr(t.overall)?u=t.overall:e.group?(u=(o=(i=e.groupHeight)!==null&&i!==void 0?i:(r=t.layoutRect)===null||r===void 0?void 0:r.height)!==null&&o!==void 0?o:e.group.getBounds().height(),e.groupHeight=u):u=e.height:u=rr(t?.overall)?t.overall:0,{from:{y:u,y1:Oi(l)?void 0:u,height:Oi(h)?void 0:0},to:{y:a,y1:l,height:h}}}const wOt=(n,t,e)=>{var i;return((i=t?.overall)!==null&&i!==void 0&&i)!==!1?COt(n,t,e):_Ot(n,t)};class xOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i;super.onBind();const{from:r,to:o}=wOt(this.target,this.params.options,this.params),s=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:r;this.props=o,this.propKeys=Object.keys(o).filter(l=>o[l]!=null),this.from=s,this.to=o;const a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(s)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}function SOt(n,t,e){const i=n.getFinalAttribute(),r=i.y,o=i.y1,s=i.height;if(t&&t.orient==="negative"){const l=yr(s)?Math.max(r,r+s):Math.max(r,o);return{to:{y:l,y1:Oi(o)?void 0:l,height:Oi(s)?void 0:0}}}const a=yr(s)?Math.min(r,r+s):Math.min(r,o);return{to:{y:a,y1:Oi(o)?void 0:a,height:Oi(s)?void 0:0}}}function AOt(n,t,e){var i,r,o;const s=n.getFinalAttribute(),a=s.y1,l=s.height;let h;return t&&t.orient==="negative"?rr(t.overall)?h=t.overall:e.group?(h=(o=(i=e.groupHeight)!==null&&i!==void 0?i:(r=t.layoutRect)===null||r===void 0?void 0:r.height)!==null&&o!==void 0?o:e.group.getBounds().height(),e.groupHeight=h):h=e.height:h=rr(t?.overall)?t.overall:0,{to:{y:h,y1:Oi(a)?void 0:h,height:Oi(l)?void 0:0}}}class TOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const{from:t,to:e}=(i=this.target,r=this.params.options,o=this.params,((s=r?.overall)!==null&&s!==void 0&&s)!==!1?AOt(i,r,o):SOt(i,r));var i,r,o,s;this.props=e,this.propKeys=Object.keys(e).filter(a=>e[a]!=null),this.from=t??this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}const eZ=(n,t,e)=>{const i=n.getFinalAttribute().points,r={x:0,y:0};return i.forEach(o=>{r.x+=o.x,r.y+=o.y}),r.x/=i.length,r.y/=i.length,t&&t.center&&(su(t.center.x)&&(r.x=t.center.x),su(t.center.y)&&(r.y=t.center.y)),n.type==="area"&&(r.x1=r.x,r.y1=r.y),i.map(o=>Object.assign({},o,r))},MOt=(n,t,e)=>{const i=n.getFinalAttribute();return{from:{points:eZ(n,t)},to:{points:i.points}}};class Rp extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){var r,o;const s=(r=this.from)===null||r===void 0?void 0:r.points,a=(o=this.to)===null||o===void 0?void 0:o.points;s&&a&&(this.target.attribute.points=s.map((l,h)=>LP(s[h],a[h],e)),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag())}}class ROt extends Rp{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:e,to:i}=MOt(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}else this.valid=!1}}class BOt extends Rp{onBind(){if(super.onBind(),["area","line"].includes(this.target.type)){const i=this.target.getFinalAttribute(),{from:r,to:o}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:eZ(t,e)}});this.props=o,this.propKeys=Object.keys(o).filter(s=>o[s]!=null),this.from=r||i,this.to=o}else this.valid=!1;var t,e}}const iZ=(n,t,e)=>n.getFinalAttribute().points.map(i=>{if(t&&t.orient==="negative"){let r=n.stage.viewWidth;return n.parent.parent.parent&&(r=n.parent.parent.parent.AABBBounds.width()),Object.assign(Object.assign({},i),{x:r,y:i.y,x1:r,y1:i.y1,defined:i.defined!==!1})}return Object.assign(Object.assign({},i),{x:0,y:i.y,x1:0,y1:i.y1,defined:i.defined!==!1})}),POt=(n,t,e)=>{const i=n.getFinalAttribute();return{from:{points:iZ(n,t)},to:{points:i.points}}};class kOt extends Rp{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:e,to:i}=POt(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}else this.valid=!1}}class EOt extends Rp{onBind(){if(super.onBind(),["area","line"].includes(this.target.type)){const i=this.target.getFinalAttribute(),{from:r,to:o}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:iZ(t,e)}});this.props=o,this.propKeys=Object.keys(o).filter(s=>o[s]!=null),this.from=r||i,this.to=o}else this.valid=!1;var t,e}}const nZ=(n,t,e)=>n.getFinalAttribute().points.map(i=>{if(t&&t.orient==="negative"){let r=n.stage.viewHeight;return n.parent.parent.parent&&(r=n.parent.parent.parent.AABBBounds.height()),Object.assign(Object.assign({},i),{x:i.x,y:r,x1:i.x1,y1:r,defined:i.defined!==!1})}return Object.assign(Object.assign({},i),{x:i.x,y:0,x1:i.x1,y1:0,defined:i.defined!==!1})}),LOt=(n,t,e)=>{const i=n.getFinalAttribute();return{from:{points:nZ(n,t)},to:{points:i.points}}};class OOt extends Rp{onBind(){var t;if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:e,to:i}=LOt(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}else this.valid=!1}}class DOt extends Rp{onBind(){if(super.onBind(),["area","line","polygon"].includes(this.target.type)){const{from:i,to:r}=(t=this.target,e=this.params.options,this.params,{from:{points:t.getFinalAttribute().points},to:{points:nZ(t,e)}});this.props=r,this.propKeys=Object.keys(r).filter(o=>r[o]!=null),this.from=i??this.target.attribute,this.to=r}else this.valid=!1;var t,e}}const IOt=(n,t,e)=>{const i=n.getFinalAttribute();return t&&t.orient==="inside"?{from:{innerRadius:i?.outerRadius},to:{innerRadius:i?.innerRadius}}:{from:{outerRadius:i?.innerRadius},to:{outerRadius:i?.outerRadius}}},HOt=(n,t,e)=>{const i=n.getFinalAttribute(),r=rr(t?.overall)?t.overall:0;return{from:{innerRadius:r,outerRadius:r},to:{innerRadius:i?.innerRadius,outerRadius:i?.outerRadius}}},FOt=(n,t,e)=>{var i;return((i=t?.overall)!==null&&i!==void 0&&i)!==!1?HOt(n,t):IOt(n,t)},zOt=(n,t,e)=>{const i=n.getFinalAttribute();return t&&t.orient==="inside"?{from:{innerRadius:i?.innerRadius},to:{innerRadius:i?.outerRadius}}:{from:{outerRadius:i?.outerRadius},to:{outerRadius:i?.innerRadius}}},NOt=(n,t,e)=>{const i=n.getFinalAttribute(),r=rr(t?.overall)?t.overall:0;return{from:{innerRadius:i?.innerRadius,outerRadius:i?.outerRadius},to:{innerRadius:r,outerRadius:r}}};class rZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class WOt extends rZ{onBind(){var t,e,i;super.onBind();const{from:r,to:o}=FOt(this.target,this.params.options,this.params),s=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:r;this.props=o,this.propKeys=Object.keys(o).filter(l=>o[l]!=null),this.from=s,this.to=o;const a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(s)}}class VOt extends rZ{onBind(){super.onBind();const{to:t}=(e=this.target,i=this.params.options,this.params,((r=i?.overall)!==null&&r!==void 0&&r)!==!1?NOt(e,i):zOt(e,i));var e,i,r;this.props=t,this.propKeys=Object.keys(t).filter(o=>t[o]!=null),this.from=this.target.attribute,this.to=t}}function GOt(n,t,e){const i=n.getFinalAttribute(),r=i.x,o=i.x1,s=i.width;if(t&&t.orient==="negative"){const l=yr(s)?Math.max(r,r+s):Math.max(r,o);return{from:{x:l,x1:Oi(o)?void 0:l,width:Oi(s)?void 0:0},to:{x:r,x1:o,width:s}}}const a=yr(s)?Math.min(r,r+s):Math.min(r,o);return{from:{x:a,x1:Oi(o)?void 0:a,width:Oi(s)?void 0:0},to:{x:r,x1:o,width:s}}}function $Ot(n,t,e){var i;const r=n.getFinalAttribute(),o=r.x,s=r.x1,a=r.width;let l;return t&&t.orient==="negative"?rr(t.overall)?l=t.overall:e.group?(l=(i=e.groupWidth)!==null&&i!==void 0?i:e.group.getBounds().width(),e.groupWidth=l):l=e.width:l=rr(t?.overall)?t?.overall:0,{from:{x:l,x1:Oi(s)?void 0:l,width:Oi(a)?void 0:0},to:{x:o,x1:s,width:a}}}const jOt=(n,t,e)=>{var i;return((i=t?.overall)!==null&&i!==void 0&&i)!==!1?$Ot(n,t,e):GOt(n,t)};function UOt(n,t,e){const i=n.getFinalAttribute(),r=i.x,o=i.x1,s=i.width;if(t&&t.orient==="negative"){const l=yr(s)?Math.max(r,r+s):Math.max(r,o);return{to:{x:l,x1:Oi(o)?void 0:l,width:Oi(s)?void 0:0}}}const a=yr(s)?Math.min(r,r+s):Math.min(r,o);return{to:{x:a,x1:Oi(o)?void 0:a,width:Oi(s)?void 0:0}}}function XOt(n,t,e){var i;const r=n.getFinalAttribute(),o=r.x1,s=r.width;let a;return t&&t.orient==="negative"?rr(t.overall)?a=t.overall:e.group?(a=(i=e.groupWidth)!==null&&i!==void 0?i:e.group.getBounds().width(),e.groupWidth=a):a=e.width:a=rr(t?.overall)?t.overall:0,{to:{x:a,x1:Oi(o)?void 0:a,width:Oi(s)?void 0:0}}}class YOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i;super.onBind();const{from:r,to:o}=jOt(this.target,this.params.options,this.params),s=(e=(t=this.target.context)===null||t===void 0?void 0:t.lastAttrs)!==null&&e!==void 0?e:r;this.props=o,this.propKeys=Object.keys(o).filter(l=>o[l]!=null),this.from=s,this.to=o;const a=this.target.getFinalAttribute();a&&this.target.setAttributes(a),((i=this.params.controlOptions)===null||i===void 0?void 0:i.immediatelyApply)!==!1&&this.target.setAttributes(s)}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class KOt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){super.onBind();const{from:t,to:e}=(i=this.target,r=this.params.options,o=this.params,((s=r?.overall)!==null&&s!==void 0&&s)!==!1?XOt(i,r,o):UOt(i,r));var i,r,o,s;this.props=e,this.propKeys=Object.keys(e).filter(a=>e[a]!=null),this.from=t??this.target.attribute,this.to=e}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class qOt extends Tp{onBind(){super.onBind();const t=Mp(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target,{symbolStartOuterType:o="scale",titleType:s="typewriter",titlePanelType:a="scale"}=this.params,l=e/10;let h,u;if(r._symbolStart.setAttributes({scaleX:0,scaleY:0}),t.animate(r._symbolStart,{type:"to",to:{scaleX:1,scaleY:1},duration:5*l,easing:i}),o==="scale"?(h={scaleX:0,scaleY:0},u={scaleX:1,scaleY:1}):(h={clipRange:0},u={clipRange:1}),r._symbolStartOuter.setAttributes(h),t.animate(r._symbolStartOuter,{type:"to",to:u,duration:5*l,easing:i}),r._symbolEnd.setAttributes({scaleX:0,scaleY:0}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:1,scaleY:1},duration:2*l,delay:8*l,easing:i}),r._line.setAttributes({clipRange:0}),t.animate(r._line,{type:"to",to:{clipRange:1},duration:9*l,easing:i}),s==="typewriter"){const d=r._titleTop.attribute.text;r._titleTop.setAttributes({text:""}),t.animate(r._titleTop,{type:"custom",delay:5*l,duration:4*l,easing:"linear",to:{text:d},custom:Wm});const c=r._titleBottom.attribute.text;r._titleBottom.setAttributes({text:""}),t.animate(r._titleBottom,{type:"custom",delay:5*l,duration:4*l,easing:"linear",to:{text:c},custom:Wm})}else r._titleTop.setAttributes({dy:r._titleTop.AABBBounds.height()+10}),t.animate(r._titleTop,{type:"to",to:{dy:0},delay:5*l,duration:4*l,easing:"linear"}),r._titleBottom.setAttributes({dy:-(10+r._titleBottom.AABBBounds.height())}),t.animate(r._titleBottom,{type:"to",to:{dy:0},delay:5*l,duration:4*l,easing:"linear"});a==="scale"?[r._titleTopPanel,r._titleBottomPanel].forEach(d=>{var c;const f=(c=d.attribute.scaleX)!==null&&c!==void 0?c:1;d.setAttributes({scaleX:0}),t.animate(d,{type:"to",to:{scaleX:f},duration:e,easing:i})}):a==="stroke"&&[r._titleTopPanel,r._titleBottomPanel].forEach(d=>{const c=d.AABBBounds,f=2*(c.width()+c.height());d.setAttributes({lineDash:[0,10*f]}),t.animate(d,{type:"to",to:{lineDash:[f,10*f]},duration:e,easing:i})}),this.completeBind(t)}}class ZOt extends Tp{onBind(){super.onBind();const t=Mp(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target,{mode:o}=this.params;o==="scale"?t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}):(t.animate(r._line,{type:"to",to:{clipRange:0},duration:e,easing:i}),t.animate(r._symbolStart,{type:"to",to:{scaleX:0,scaleY:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._symbolEnd,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),t.animate(r._titleTop,{type:"to",to:{dy:r._titleTop.AABBBounds.height()+10},duration:e/2,easing:i}),t.animate(r._titleBottom,{type:"to",to:{dy:-(10+r._titleBottom.AABBBounds.height())},duration:e/2,easing:i}),t.animate(r._symbolStartOuter,{type:"to",to:{clipRange:0},duration:e/2,delay:e/2,easing:i}),t.animate(r._titleTopPanel,{type:"to",to:{scaleX:0},duration:e,easing:i}),t.animate(r._titleBottomPanel,{type:"to",to:{scaleX:0},duration:e,easing:i})),this.completeBind(t)}}class JOt extends Tp{onBind(){super.onBind();const t=Mp(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target,{wave:o}=this.params;if(r.setAttributes({scaleX:0,scaleY:0}),t.animate(r,{type:"to",to:{scaleX:1,scaleY:1},duration:e/3*2,easing:i}),r.titleShape&&t.animate(r.titleShape,{type:"custom",to:{text:r.titleShape.attribute.text},duration:e,easing:i,custom:Wm}),r.contentShape&&t.animate(r.contentShape,{type:"custom",to:{text:r.contentShape.attribute.text},duration:e,easing:i,custom:Wm}),o){const s=e/6;t.animate(r.group,{timeSlices:[{duration:s,effects:{type:"to",to:{angle:o},easing:i}},{duration:2*s,effects:{type:"to",to:{angle:-o},easing:i}},{duration:2*s,effects:{type:"to",to:{angle:o},easing:i}},{duration:s,effects:{type:"to",to:{angle:0},easing:i}}]})}this.completeBind(t)}}class QOt extends Tp{onBind(){super.onBind();const t=Mp(this.target);this._animator=t;const e=this.duration,i=this.easing,r=this.target;t.animate(r,{type:"to",to:{scaleX:0,scaleY:0},duration:e,easing:i}),this.completeBind(t)}}class tDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.fadeInChars=!1,this.fadeInDuration=.3,this.strokeFirst=!1,this.strokeToFillRatio=.3,o?.showCursor!==void 0&&(this.showCursor=o.showCursor),o?.cursorChar!==void 0&&(this.cursorChar=o.cursorChar),o?.blinkCursor!==void 0&&(this.blinkCursor=o.blinkCursor),o?.fadeInChars!==void 0&&(this.fadeInChars=o.fadeInChars),o?.fadeInDuration!==void 0&&(this.fadeInDuration=o.fadeInDuration),o?.strokeFirst!==void 0&&(this.strokeFirst=o.strokeFirst),o?.strokeToFillRatio!==void 0&&(this.strokeToFillRatio=o.strokeToFillRatio)}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?Ei.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=Ei.TransformTextConfig2SingleCharacter(this.originalTextConfig)):this.valid=!1}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){if(!this.valid)return;const r=this.toTextConfig.length,o=this.fromTextConfig.length,s=this.fadeInChars?1-this.fadeInDuration:1;let a,l;if(o>r)a=Math.round(o-(o-r)*e);else if(this.fadeInChars){const h=Math.min(1,e/s);a=Math.round(o+(r-o)*h)}else a=Math.round(o+(r-o)*e);if(l=o>r?this.fromTextConfig.slice(0,a):this.toTextConfig.slice(0,a).map((h,u)=>{if("text"in h){const d=Object.assign({},h);if(this.strokeFirst){const c=u/r*s,f=Math.max(0,e-c),g=1-c,p=Math.min(1,f/(this.strokeToFillRatio*g));if("fill"in d&&d.fill&&(d.stroke=d.fill,p<1&&(d.fillOpacity=p)),this.fadeInChars){const v=Math.min(1,f/(this.fadeInDuration*g));d.opacity=Math.max(0,Math.min(1,v))}}else if(this.fadeInChars){const c=(e-u/r*s)/this.fadeInDuration;d.opacity=Math.max(0,Math.min(1,c))}return d}return h}),this.showCursor&&a<r){let h=!0;if(this.blinkCursor&&(h=Math.floor(e/.1)%2==0),h&&l.length>0){const u=l.length-1,d=l[u];if("text"in d)l[u]=Object.assign(Object.assign({},d),{text:String(d.text)+this.cursorChar});else{const c={text:this.cursorChar,fontSize:16};l.push(c)}}}this.target.setAttribute("textConfig",l)}}class eDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.showCursor=!1,this.cursorChar="|",this.blinkCursor=!0,this.beforeText="",this.afterText="",this.fadeOutChars=!1,this.fadeOutDuration=.3,this.direction="backward",o?.showCursor!==void 0&&(this.showCursor=o.showCursor),o?.cursorChar!==void 0&&(this.cursorChar=o.cursorChar),o?.blinkCursor!==void 0&&(this.blinkCursor=o.blinkCursor),o?.beforeText!==void 0&&(this.beforeText=o.beforeText),o?.afterText!==void 0&&(this.afterText=o.afterText),o?.fadeOutChars!==void 0&&(this.fadeOutChars=o.fadeOutChars),o?.fadeOutDuration!==void 0&&(this.fadeOutDuration=o.fadeOutDuration),o?.direction!==void 0&&(this.direction=o.direction),this.propKeys=["textConfig"]}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=Ei.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?Ei.TransformTextConfig2SingleCharacter(e.textConfig):[]):this.valid=!1}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){if(!this.valid)return;const r=this.fromTextConfig.length,o=this.fadeOutChars?1-this.fadeOutDuration:1;let s;if(this.direction==="forward"){if(this.fadeOutChars){const l=Math.min(1,e/o);s=Math.round(r*(1-l))}else s=Math.round(r*(1-e));let a=this.direction==="forward"?this.fromTextConfig.slice(r-s):this.fromTextConfig.slice(0,s);this.fadeOutChars&&(a=this.applyFadeEffect(a,e,r,s)),this.showCursor&&s>0&&(a=this.addCursor(a,e)),this.target.setAttribute("textConfig",a)}else{if(this.fadeOutChars){const l=Math.min(1,e/o);s=Math.round(r*(1-l))}else s=Math.round(r*(1-e));let a=this.fromTextConfig.slice(0,s);this.fadeOutChars&&(a=this.applyFadeEffect(a,e,r,s)),this.showCursor&&s>0&&(a=this.addCursor(a,e)),this.target.setAttribute("textConfig",a)}}applyFadeEffect(t,e,i,r){this.direction==="forward"&&i-r;const o=(e-(1-this.fadeOutDuration))/this.fadeOutDuration,s=Math.max(0,1-Math.min(1,o));return t.map((a,l)=>{if(this.direction==="forward"){if(l===0&&"text"in a)return Object.assign(Object.assign({},a),{opacity:s})}else if(l===t.length-1&&"text"in a)return Object.assign(Object.assign({},a),{opacity:s});return a})}addCursor(t,e){let i=!0;if(this.blinkCursor&&(i=Math.floor(e/.1)%2==0),i&&t.length>0){const r=this.direction==="forward"?0:t.length-1,o=t[r];if("text"in o){const s=[...t];return this.direction==="forward"?s[r]=Object.assign(Object.assign({},o),{text:this.cursorChar+String(o.text)}):s[r]=Object.assign(Object.assign({},o),{text:String(o.text)+this.cursorChar}),s}}return t}}class iDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeInDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],o?.fadeInDuration!==void 0&&(this.fadeInDuration=o.fadeInDuration),o?.slideDirection!==void 0&&(this.slideDirection=o.slideDirection),o?.slideDistance!==void 0&&(this.slideDistance=o.slideDistance),o?.wordByWord!==void 0&&(this.wordByWord=o.wordByWord),o?.wordRegex!==void 0&&(this.wordRegex=o.wordRegex)}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=e.textConfig?[...e.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=t.textConfig&&t.textConfig.length>0?Ei.TransformTextConfig2SingleCharacter(t.textConfig):[],this.toTextConfig=Ei.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.singleCharConfig=this.toTextConfig.map(i=>"text"in i?Object.assign(Object.assign({},i),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}):Object.assign(Object.assign({},i),{opacity:0})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="";const e={};let i,r=0;for(this.toTextConfig.forEach((s,a)=>{if("text"in s){const l=String(s.text);t+=l,e[r]=a,r++}}),this.wordRegex.lastIndex=0;(i=this.wordRegex.exec(t))!==null;){const s=i.index,a=i.index+i[0].length,l=[];for(let h=s;h<a;h++)e[h]!==void 0&&l.push(e[h]);l.length>0&&this.wordGroups.push(l)}const o=new Set;this.wordGroups.forEach(s=>{s.forEach(a=>o.add(a))});for(let s=0;s<this.toTextConfig.length;s++)"text"in this.toTextConfig[s]&&!o.has(s)&&this.wordGroups.push([s])}getInitialDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getInitialDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||this.target.setAttribute("textConfig",this.originalTextConfig)}onUpdate(t,e,i){if(!this.valid)return;const r=1-this.fadeInDuration;let o;o=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",o)}updateByWord(t,e){const i=this.wordGroups.length,r=[...this.singleCharConfig];for(let o=0;o<this.wordGroups.length;o++){let s;if(s=this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<s){for(const d of this.wordGroups[o]){const c=r[d];"text"in c&&(r[d]=Object.assign(Object.assign({},c),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()}))}continue}const a=(t-s)/this.fadeInDuration,l=Math.max(0,Math.min(1,a)),h=this.getInitialDx()*(1-l),u=this.getInitialDy()*(1-l);for(const d of this.wordGroups[o]){const c=r[d];"text"in c&&(r[d]=Object.assign(Object.assign({},c),{opacity:l,dx:h,dy:u}))}}return r}updateByCharacter(t,e){const i=this.toTextConfig.length,r=[...this.singleCharConfig];for(let o=0;o<r.length;o++){const s=r[o];if("text"in s){let a;if(a=this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<a){r[o]=Object.assign(Object.assign({},s),{opacity:0,dx:this.getInitialDx(),dy:this.getInitialDy()});continue}const l=(t-a)/this.fadeInDuration,h=Math.max(0,Math.min(1,l)),u=this.getInitialDx()*(1-h),d=this.getInitialDy()*(1-h);r[o]=Object.assign(Object.assign({},s),{opacity:h,dx:u,dy:d})}}return r}}class nDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.fromTextConfig=[],this.toTextConfig=[],this.originalTextConfig=[],this.singleCharConfig=[],this.fadeOutDuration=.3,this.slideDirection="right",this.slideDistance=30,this.wordByWord=!1,this.wordRegex=/[a-zA-Z]+(-[a-zA-Z]+)*|[\u4e00-\u9fa5]+|[0-9]+|[^\s\w\u4e00-\u9fa5]/g,this.wordGroups=[],this.reverseOrder=!1,o?.fadeOutDuration!==void 0&&(this.fadeOutDuration=o.fadeOutDuration),o?.slideDirection!==void 0&&(this.slideDirection=o.slideDirection),o?.slideDistance!==void 0&&(this.slideDistance=o.slideDistance),o?.wordByWord!==void 0&&(this.wordByWord=o.wordByWord),o?.wordRegex!==void 0&&(this.wordRegex=o.wordRegex),o?.reverseOrder!==void 0&&(this.reverseOrder=o.reverseOrder),this.propKeys=["textConfig"]}onFirstRun(){const t=this.getLastProps(),e=this.getEndProps();this.originalTextConfig=t.textConfig?[...t.textConfig]:[],this.valid=!0,this.originalTextConfig&&this.originalTextConfig.length!==0?(this.fromTextConfig=Ei.TransformTextConfig2SingleCharacter(this.originalTextConfig),this.toTextConfig=e.textConfig&&e.textConfig.length>0?Ei.TransformTextConfig2SingleCharacter(e.textConfig):[],this.singleCharConfig=this.fromTextConfig.map(i=>"text"in i?Object.assign(Object.assign({},i),{opacity:1,dx:0,dy:0}):Object.assign(Object.assign({},i),{opacity:1})),this.wordByWord&&this.calculateWordGroups()):this.valid=!1}calculateWordGroups(){this.wordGroups=[];let t="";const e={};let i,r=0;for(this.fromTextConfig.forEach((s,a)=>{if("text"in s){const l=String(s.text);t+=l,e[r]=a,r++}}),this.wordRegex.lastIndex=0;(i=this.wordRegex.exec(t))!==null;){const s=i.index,a=i.index+i[0].length,l=[];for(let h=s;h<a;h++)e[h]!==void 0&&l.push(e[h]);l.length>0&&this.wordGroups.push(l)}const o=new Set;this.wordGroups.forEach(s=>{s.forEach(a=>o.add(a))});for(let s=0;s<this.fromTextConfig.length;s++)"text"in this.fromTextConfig[s]&&!o.has(s)&&this.wordGroups.push([s])}getTargetDx(){switch(this.slideDirection){case"left":return-this.slideDistance;case"right":return this.slideDistance;default:return 0}}getTargetDy(){switch(this.slideDirection){case"up":return-this.slideDistance;case"down":return this.slideDistance;default:return 0}}onEnd(t){super.onEnd(t),t||(this.toTextConfig.length>0?this.target.setAttribute("textConfig",this.toTextConfig):this.target.setAttribute("textConfig",[]))}onUpdate(t,e,i){if(!this.valid)return;const r=1-this.fadeOutDuration;let o;o=this.wordByWord&&this.wordGroups.length>0?this.updateByWord(e,r):this.updateByCharacter(e,r),this.target.setAttribute("textConfig",o)}updateByWord(t,e){const i=this.wordGroups.length,r=[...this.singleCharConfig];for(let o=0;o<this.wordGroups.length;o++){let s;if(s=this.reverseOrder?this.slideDirection==="left"?o/i*e:(i-1-o)/i*e:this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<s){for(const c of this.wordGroups[o]){const f=r[c];"text"in f&&(r[c]=Object.assign(Object.assign({},f),{opacity:1,dx:0,dy:0}))}continue}const a=(t-s)/this.fadeOutDuration,l=Math.max(0,Math.min(1,a)),h=this.getTargetDx()*l,u=this.getTargetDy()*l,d=1-l;for(const c of this.wordGroups[o]){const f=r[c];"text"in f&&(r[c]=Object.assign(Object.assign({},f),{opacity:d,dx:h,dy:u}))}}return r}updateByCharacter(t,e){const i=this.fromTextConfig.length,r=[...this.singleCharConfig];for(let o=0;o<r.length;o++){const s=r[o];if("text"in s){let a;if(a=this.reverseOrder?this.slideDirection==="left"?o/i*e:(i-1-o)/i*e:this.slideDirection==="left"?(i-1-o)/i*e:o/i*e,t<a){r[o]=Object.assign(Object.assign({},s),{opacity:1,dx:0,dy:0});continue}const l=(t-a)/this.fadeOutDuration,h=Math.max(0,Math.min(1,l)),u=this.getTargetDx()*h,d=this.getTargetDy()*h,c=1-h;r[o]=Object.assign(Object.assign({},s),{opacity:c,dx:u,dy:d})}}return r}}class rDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a,l,h,u,d;let c,f;super.onBind();const g=this.target.getFinalAttribute(),p=(t=this.target.attribute)!==null&&t!==void 0?t:{};switch((e=this.params)===null||e===void 0?void 0:e.direction){case"x":c={scaleX:(i=p.scaleX)!==null&&i!==void 0?i:0},f={scaleX:(r=g?.scaleX)!==null&&r!==void 0?r:1},this._updateFunction=this.updateX;break;case"y":c={scaleY:(o=p.scaleY)!==null&&o!==void 0?o:0},f={scaleY:(s=g?.scaleY)!==null&&s!==void 0?s:1},this._updateFunction=this.updateY;break;default:c={scaleX:(a=p.scaleX)!==null&&a!==void 0?a:0,scaleY:(l=p.scaleY)!==null&&l!==void 0?l:0},f={scaleX:(h=g?.scaleX)!==null&&h!==void 0?h:1,scaleY:(u=g?.scaleY)!==null&&u!==void 0?u:1},this._updateFunction=this.updateXY}const v=this.target.getFinalAttribute();v&&this.target.setAttributes(v),this.props=f,this.from=c,this.to=f,((d=this.params.controlOptions)===null||d===void 0?void 0:d.immediatelyApply)!==!1&&this.target.setAttributes(c)}onEnd(t){super.onEnd(t)}updateX(t){this.target.attribute.scaleX=this.from.scaleX+(this.to.scaleX-this.from.scaleX)*t}updateY(t){this.target.attribute.scaleY=this.from.scaleY+(this.to.scaleY-this.from.scaleY)*t}updateXY(t){this.updateX(t),this.updateY(t)}deleteSelfAttr(t){delete this.props[t],this.fromProps&&delete this.fromProps[t];const e=this.propKeys.indexOf(t);e!==-1&&this.propKeys.splice(e,1),this.propKeys&&this.propKeys.length>1?this._updateFunction=this.updateXY:this.propKeys[0]==="scaleX"?this._updateFunction=this.updateX:this.propKeys[0]==="scaleY"?this._updateFunction=this.updateY:this._updateFunction=null}onUpdate(t,e,i){this._updateFunction&&(this._updateFunction(e),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag())}}class oDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o;let s,a;super.onBind();const l=this.target.attribute;switch((t=this.params)===null||t===void 0?void 0:t.direction){case"x":s={scaleX:(e=l?.scaleX)!==null&&e!==void 0?e:1},a={scaleX:0};break;case"y":s={scaleY:(i=l?.scaleY)!==null&&i!==void 0?i:1},a={scaleY:0};break;default:s={scaleX:(r=l?.scaleX)!==null&&r!==void 0?r:1,scaleY:(o=l?.scaleY)!==null&&o!==void 0?o:1},a={scaleX:0,scaleY:0}}this.props=a,this.from=s,this.to=a}onEnd(t){super.onEnd(t)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateBoundTag()}}class sDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.fromProps[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}class cD extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a,l,h,u,d,c;super.onBind();const f=this.target.getFinalAttribute(),g=((t=this.params)===null||t===void 0?void 0:t.direction)||"right",p=((e=this.params)===null||e===void 0?void 0:e.distance)||50,v=(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:0,m={opacity:v,baseOpacity:v},y={opacity:1,baseOpacity:1};g==="top"?(m.y=((o=f.y)!==null&&o!==void 0?o:0)-p,y.y=(s=f.y)!==null&&s!==void 0?s:0,this.propKeys=["opacity","baseOpacity","y"]):g==="bottom"?(m.y=((a=f.y)!==null&&a!==void 0?a:0)+p,y.y=(l=f.y)!==null&&l!==void 0?l:0,this.propKeys=["opacity","baseOpacity","y"]):g==="left"?(m.x=((h=f.x)!==null&&h!==void 0?h:0)-p,y.x=(u=f.x)!==null&&u!==void 0?u:0,this.propKeys=["opacity","baseOpacity","x"]):(m.x=((d=f.x)!==null&&d!==void 0?d:0)+p,y.x=(c=f.x)!==null&&c!==void 0?c:0,this.propKeys=["opacity","baseOpacity","x"]),this.from=m,this.to=y,this.props=y,this.target.setAttributes(m)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class oZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a;super.onBind();const l=this.target.getFinalAttribute(),h=(e=(t=this.params)===null||t===void 0?void 0:t.fromScale)!==null&&e!==void 0?e:0,u=((i=this.params)===null||i===void 0?void 0:i.direction)||"xy",d=(o=(r=this.params)===null||r===void 0?void 0:r.fromOpacity)!==null&&o!==void 0?o:0,c={opacity:d,baseOpacity:d},f={opacity:1,baseOpacity:1};this.propKeys=["opacity","baseOpacity"],u!=="x"&&u!=="xy"||(c.scaleX=h,f.scaleX=(s=l.scaleX)!==null&&s!==void 0?s:1,this.propKeys.push("scaleX")),u!=="y"&&u!=="xy"||(c.scaleY=h,f.scaleY=(a=l.scaleY)!==null&&a!==void 0?a:1,this.propKeys.push("scaleY")),this.from=c,this.to=f,this.props=f,this.target.setAttributes(c)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class sZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e,i,r,o,s,a,l,h;super.onBind();const u=this.target.getFinalAttribute(),d=(e=(t=this.params)===null||t===void 0?void 0:t.fromAngle)!==null&&e!==void 0?e:2*Math.PI,c=(r=(i=this.params)===null||i===void 0?void 0:i.fromScale)!==null&&r!==void 0?r:0,f=(s=(o=this.params)===null||o===void 0?void 0:o.fromOpacity)!==null&&s!==void 0?s:0,g={opacity:f,baseOpacity:f,angle:d,scaleX:c,scaleY:c},p={opacity:1,baseOpacity:1,angle:(a=u.angle)!==null&&a!==void 0?a:0,scaleX:(l=u.scaleX)!==null&&l!==void 0?l:1,scaleY:(h=u.scaleY)!==null&&h!==void 0?h:1};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=g,this.to=p,this.props=p,this.target.setAttributes(g)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class aDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.perimeter=0,this.originalAttributes={}}onBind(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y;if(super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.target.type==="rect"){const A=this.target.attribute,T=(t=A.width)!==null&&t!==void 0?t:100,M=(e=A.height)!==null&&e!==void 0?e:100;this.perimeter=2*(T+M)}else if(this.target.type==="circle"){const A=(i=this.target.attribute.radius)!==null&&i!==void 0?i:50;this.perimeter=2*Math.PI*A}else if(this.target.type==="ellipse"){const A=this.target.attribute,T=(r=A.radiusX)!==null&&r!==void 0?r:50,M=(o=A.radiusY)!==null&&o!==void 0?o:50;this.perimeter=2*Math.PI*Math.sqrt((T*T+M*M)/2)}else this.perimeter=1e3;const b=(a=(s=this.params)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:2,_=(h=(l=this.params)===null||l===void 0?void 0:l.strokeColor)!==null&&h!==void 0?h:"black",w=(d=(u=this.params)===null||u===void 0?void 0:u.fromOpacity)!==null&&d!==void 0?d:1,C=(f=(c=this.params)===null||c===void 0?void 0:c.dashLength)!==null&&f!==void 0?f:this.perimeter,x=(p=(g=this.params)===null||g===void 0?void 0:g.showFill)!==null&&p!==void 0&&p,S=(m=(v=this.params)===null||v===void 0?void 0:v.fillOpacity)!==null&&m!==void 0?m:0;this.from={lineDash:[C,C],lineDashOffset:C,lineWidth:b,stroke:_,strokeOpacity:w},this.to={lineDash:[C,C],lineDashOffset:0,lineWidth:b,stroke:_,strokeOpacity:w},x?(this.from.fillOpacity=S,this.to.fillOpacity=(y=this.originalAttributes.fillOpacity)!==null&&y!==void 0?y:1):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;const o=this.target.attribute;o.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,!((r=this.params)===null||r===void 0)&&r.showFill&&(o.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}onEnd(){var t;if(super.onEnd(),!(!((t=this.params)===null||t===void 0)&&t.showFill)){const e=Object.assign({},this.originalAttributes);e.fillOpacity=0,this.target.setAttributes(e)}}}class lDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.perimeter=0,this.originalAttributes={}}onFirstRun(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v;if(this.originalAttributes=Object.assign({},this.target.getAttributes()),this.target.type==="rect"){const C=this.target.attribute,x=(t=C.width)!==null&&t!==void 0?t:100,S=(e=C.height)!==null&&e!==void 0?e:100;this.perimeter=2*(x+S)}else if(this.target.type==="circle"){const C=(i=this.target.attribute.radius)!==null&&i!==void 0?i:50;this.perimeter=2*Math.PI*C}else if(this.target.type==="ellipse"){const C=this.target.attribute,x=(r=C.radiusX)!==null&&r!==void 0?r:50,S=(o=C.radiusY)!==null&&o!==void 0?o:50;this.perimeter=2*Math.PI*Math.sqrt((x*x+S*S)/2)}else this.perimeter=1e3;const m=(a=(s=this.params)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:2,y=(h=(l=this.params)===null||l===void 0?void 0:l.strokeColor)!==null&&h!==void 0?h:"black",b=(d=(u=this.params)===null||u===void 0?void 0:u.fromOpacity)!==null&&d!==void 0?d:1,_=(f=(c=this.params)===null||c===void 0?void 0:c.dashLength)!==null&&f!==void 0?f:this.perimeter,w=(p=(g=this.params)===null||g===void 0?void 0:g.showFill)!==null&&p!==void 0&&p;this.from={lineDash:[_,_],lineDashOffset:0,lineWidth:m,stroke:y,strokeOpacity:b},this.to={lineDash:[_,_],lineDashOffset:-_,lineWidth:m,stroke:y,strokeOpacity:b},w?(this.from.fillOpacity=(v=this.originalAttributes.fillOpacity)!==null&&v!==void 0?v:1,this.to.fillOpacity=0):(this.from.fillOpacity=0,this.to.fillOpacity=0),this.propKeys=["lineDash","lineDashOffset","lineWidth","stroke","strokeOpacity","fillOpacity"],this.props=this.to,this.target.setAttributes(this.from)}onUpdate(t,e,i){var r;const o=this.target.attribute;o.lineDashOffset=this.from.lineDashOffset+(this.to.lineDashOffset-this.from.lineDashOffset)*e,!((r=this.params)===null||r===void 0)&&r.showFill&&(o.fillOpacity=this.from.fillOpacity+(this.to.fillOpacity-this.from.fillOpacity)*e)}}class hDt extends fe{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o?.slideRatio)!==null&&s!==void 0?s:.5;this.slideInDuration=i*a,this.growInDuration=i*(1-a)}onBind(){var t,e,i,r,o,s;super.onBind();const a=new xt(this.target);a.execute({type:"custom",custom:cD,customParameters:{direction:((t=this.params)===null||t===void 0?void 0:t.slideDirection)||"right",distance:((e=this.params)===null||e===void 0?void 0:e.slideDistance)||50,fromOpacity:(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:0},duration:this.slideInDuration,easing:this.easing}),a.execute({type:"custom",custom:oZ,customParameters:{fromScale:((o=this.params)===null||o===void 0?void 0:o.fromScale)||.5,direction:((s=this.params)===null||s===void 0?void 0:s.scaleDirection)||"xy",fromOpacity:1},duration:this.growInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class uDt extends fe{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o?.slideRatio)!==null&&s!==void 0?s:.5;this.slideInDuration=i*a,this.spinInDuration=i*(1-a)}onBind(){var t,e,i,r,o,s;super.onBind();const a=new xt(this.target);a.execute({type:"custom",custom:cD,customParameters:{direction:((t=this.params)===null||t===void 0?void 0:t.slideDirection)||"right",distance:((e=this.params)===null||e===void 0?void 0:e.slideDistance)||50,fromOpacity:(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:0},duration:this.slideInDuration,easing:this.easing}),a.execute({type:"custom",custom:sZ,customParameters:{fromAngle:((o=this.params)===null||o===void 0?void 0:o.fromAngle)||Math.PI,fromScale:((s=this.params)===null||s===void 0?void 0:s.fromScale)||.5,fromOpacity:1},duration:this.spinInDuration,easing:this.easing,delay:this.slideInDuration})}onUpdate(t,e,i){}}class fD extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onFirstRun(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g;const p=this.target.getAttributes(),v=((t=this.params)===null||t===void 0?void 0:t.direction)||"right",m=((e=this.params)===null||e===void 0?void 0:e.distance)||50,y=(r=(i=this.params)===null||i===void 0?void 0:i.fromOpacity)!==null&&r!==void 0?r:1,b=(s=(o=this.params)===null||o===void 0?void 0:o.toOpacity)!==null&&s!==void 0?s:0,_={opacity:y,baseOpacity:y},w={opacity:b,baseOpacity:b};v==="top"?(_.y=(a=p.y)!==null&&a!==void 0?a:0,w.y=((l=p.y)!==null&&l!==void 0?l:0)-m,this.propKeys=["opacity","baseOpacity","y"]):v==="bottom"?(_.y=(h=p.y)!==null&&h!==void 0?h:0,w.y=((u=p.y)!==null&&u!==void 0?u:0)+m,this.propKeys=["opacity","baseOpacity","y"]):v==="left"?(_.x=(d=p.x)!==null&&d!==void 0?d:0,w.x=((c=p.x)!==null&&c!==void 0?c:0)-m,this.propKeys=["opacity","baseOpacity","x"]):(_.x=(f=p.x)!==null&&f!==void 0?f:0,w.x=((g=p.x)!==null&&g!==void 0?g:0)+m,this.propKeys=["opacity","baseOpacity","x"]),this.from=_,this.to=w,this.props=w}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class aZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onFirstRun(){var t,e,i,r,o,s,a,l,h;const u=this.target.getAttributes(),d=(e=(t=this.params)===null||t===void 0?void 0:t.fromScale)!==null&&e!==void 0?e:0,c=((i=this.params)===null||i===void 0?void 0:i.direction)||"xy",f=(o=(r=this.params)===null||r===void 0?void 0:r.fromOpacity)!==null&&o!==void 0?o:1,g=(a=(s=this.params)===null||s===void 0?void 0:s.toOpacity)!==null&&a!==void 0?a:0,p={opacity:f,baseOpacity:f},v={opacity:g,baseOpacity:g};this.propKeys=["opacity","baseOpacity"],c!=="x"&&c!=="xy"||(p.scaleX=(l=u.scaleX)!==null&&l!==void 0?l:1,v.scaleX=d,this.propKeys.push("scaleX")),c!=="y"&&c!=="xy"||(p.scaleY=(h=u.scaleY)!==null&&h!==void 0?h:1,v.scaleY=d,this.propKeys.push("scaleY")),this.from=p,this.to=v,this.props=v}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class lZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onFirstRun(){var t,e,i,r,o,s,a,l,h,u,d;const c=this.target.getAttributes(),f=(e=(t=this.params)===null||t===void 0?void 0:t.fromAngle)!==null&&e!==void 0?e:2*Math.PI,g=(r=(i=this.params)===null||i===void 0?void 0:i.fromScale)!==null&&r!==void 0?r:0,p=(s=(o=this.params)===null||o===void 0?void 0:o.fromOpacity)!==null&&s!==void 0?s:1,v=(l=(a=this.params)===null||a===void 0?void 0:a.toOpacity)!==null&&l!==void 0?l:0,m={opacity:p,baseOpacity:p,angle:(h=c.angle)!==null&&h!==void 0?h:0,scaleX:(u=c.scaleX)!==null&&u!==void 0?u:1,scaleY:(d=c.scaleY)!==null&&d!==void 0?d:1},y={opacity:v,baseOpacity:v,angle:f,scaleX:g,scaleY:g};this.propKeys=["opacity","baseOpacity","angle","scaleX","scaleY"],this.from=m,this.to=y,this.props=y}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class dDt extends fe{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o?.slideRatio)!==null&&s!==void 0?s:.5;this.growOutDuration=i*(1-a),this.slideOutDuration=i*a}onFirstRun(){var t,e,i,r;const o=new xt(this.target);o.execute({type:"custom",custom:aZ,customParameters:{fromScale:((t=this.params)===null||t===void 0?void 0:t.fromScale)||.5,direction:((e=this.params)===null||e===void 0?void 0:e.scaleDirection)||"xy",fromOpacity:1,toOpacity:1},duration:this.growOutDuration,easing:this.easing}),o.execute({type:"custom",custom:fD,customParameters:{direction:((i=this.params)===null||i===void 0?void 0:i.slideDirection)||"right",distance:((r=this.params)===null||r===void 0?void 0:r.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.growOutDuration})}onUpdate(t,e,i){}}class cDt extends fe{constructor(t,e,i,r,o){var s;super(t,e,i,r,o);const a=(s=o?.slideRatio)!==null&&s!==void 0?s:.5;this.spinOutDuration=i*(1-a),this.slideOutDuration=i*a}onFirstRun(){var t,e,i,r;const o=new xt(this.target);o.execute({type:"custom",custom:lZ,customParameters:{fromAngle:((t=this.params)===null||t===void 0?void 0:t.fromAngle)||Math.PI,fromScale:((e=this.params)===null||e===void 0?void 0:e.fromScale)||.5,fromOpacity:1,toOpacity:1},duration:this.spinOutDuration,easing:this.easing}),o.execute({type:"custom",custom:fD,customParameters:{direction:((i=this.params)===null||i===void 0?void 0:i.slideDirection)||"right",distance:((r=this.params)===null||r===void 0?void 0:r.slideDistance)||50,fromOpacity:1},duration:this.slideOutDuration,easing:this.easing,delay:this.spinOutDuration})}onUpdate(t,e,i){}}class fDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.originalAttributes={},this.pulseCount=3,this.pulseOpacity=.3,this.pulseScale=1.05,this.pulseColor=null,this.pulseColorIntensity=.2,this.strokeOnly=!1,this.fillOnly=!1,this.useScale=!0,this.useOpacity=!0,this.useStroke=!0,this.useFill=!0,this.useColor=!1,this.originalFill=null,this.originalStroke=null,o?.pulseCount!==void 0&&(this.pulseCount=o.pulseCount),o?.pulseScale!==void 0&&(this.pulseScale=o.pulseScale),o?.pulseColor!==void 0&&(this.pulseColor=o.pulseColor),o?.pulseColorIntensity!==void 0&&(this.pulseColorIntensity=o.pulseColorIntensity),o?.strokeOnly!==void 0&&(this.strokeOnly=o.strokeOnly),o?.fillOnly!==void 0&&(this.fillOnly=o.fillOnly),o?.useScale!==void 0&&(this.useScale=o.useScale),o?.useOpacity!==void 0&&(this.useOpacity=o.useOpacity),o?.useStroke!==void 0&&(this.useStroke=o.useStroke),o?.useFill!==void 0&&(this.useFill=o.useFill),o?.useColor!==void 0&&(this.useColor=o.useColor)}onBind(){super.onBind(),this.originalAttributes=Object.assign({},this.target.getAttributes()),this.useColor&&(this.originalFill=this.originalAttributes.fill||null,this.originalStroke=this.originalAttributes.stroke||null,this.pulseColor||(this.fillOnly&&this.originalFill?this.pulseColor=this.originalFill:this.strokeOnly&&this.originalStroke?this.pulseColor=this.originalStroke:this.originalFill?this.pulseColor=this.originalFill:this.originalStroke?this.pulseColor=this.originalStroke:this.pulseColor="#FFFFFF"))}onUpdate(t,e,i){const r=e*Math.PI*this.pulseCount,o=Math.abs(Math.sin(r)),s=this.target.attribute;if(this.useOpacity){const a=1+(this.pulseOpacity-1)*o;this.useStroke&&(s.strokeOpacity=(this.originalAttributes.strokeOpacity||1)*a),this.useFill&&(s.fillOpacity=(this.originalAttributes.fillOpacity||1)*a)}if(this.useScale){const a=1+(this.pulseScale-1)*o;s.scaleX=(this.originalAttributes.scaleX||1)*a,s.scaleY=(this.originalAttributes.scaleY||1)*a}this.useColor&&this.pulseColor&&this.applyColorPulse(s,o),this.target.addUpdateShapeAndBoundsTag(),this.target.addUpdatePositionTag()}applyColorPulse(t,e){const i=this.pulseColorIntensity*e;this.useFill&&this.originalFill&&this.pulseColor&&(t.fill=pc(this.originalFill,this.pulseColor,i,!0)),this.useStroke&&this.originalStroke&&this.pulseColor&&(t.stroke=pc(this.originalStroke,this.pulseColor,i,!0))}onEnd(){super.onEnd(),this.target.setAttributes(this.originalAttributes)}}class gDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onBind(){var t,e;super.onBind();let{diffAttrs:i={}}=(t=this.target.context)!==null&&t!==void 0?t:{};const{options:r}=this.params;i=Object.assign({},i),!((e=r?.excludeChannels)===null||e===void 0)&&e.length&&r.excludeChannels.forEach(o=>{delete i[o]}),this.props=i}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.fromProps,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.fromProps[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i)}}const pDt=(n,t,e)=>{var i,r,o,s;const{offset:a=0,orient:l,direction:h,point:u,excludeChannels:d=[],layoutRect:c={}}=t??{};let f=0,g=0;l==="negative"&&(f=(i=c.width)!==null&&i!==void 0?i:n.stage.viewWidth,g=(r=c.height)!==null&&r!==void 0?r:n.stage.viewHeight),f+=a,g+=a;const p=yl(u)?u.call(null,(s=(o=n.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],n,e):u,v=n.getGraphicAttribute("x"),m=n.getGraphicAttribute("y"),y=d.includes("x")?v:p&&su(p.x)?p.x:f,b=d.includes("y")?m:p&&su(p.y)?p.y:g;switch(h){case"x":return{from:{x:d.includes("x")?v:y},to:{x:v}};case"y":return{from:{y:b},to:{y:m}};default:return{from:{x:y,y:b},to:{x:v,y:m}}}},vDt=(n,t,e)=>{var i,r,o,s;const{offset:a=0,orient:l,direction:h,point:u}=t??{},d=e.group?e.group.AABBBounds:null,c=(i=d.width())!==null&&i!==void 0?i:e.width,f=(r=d.height())!==null&&r!==void 0?r:e.height,g=(l==="negative"?c:0)+a,p=(l==="negative"?f:0)+a,v=yl(u)?u.call(null,(s=(o=n.context)===null||o===void 0?void 0:o.data)===null||s===void 0?void 0:s[0],n,e):u,m=v&&su(v.x)?v.x:g,y=v&&su(v.y)?v.y:p;switch(h){case"x":return{from:{x:n.getGraphicAttribute("x")},to:{x:m}};case"y":return{from:{y:n.getGraphicAttribute("y")},to:{y}};default:return{from:{x:n.getGraphicAttribute("x"),y:n.getGraphicAttribute("y")},to:{x:m,y}}}};class hZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class mDt extends hZ{onBind(){var t;super.onBind();const{from:e,to:i}=pDt(this.target,this.params.options,this.params);this.props=i,this.propKeys=Object.keys(i).filter(o=>i[o]!=null),this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}}class yDt extends hZ{onBind(){super.onBind();const{from:t,to:e}=vDt(this.target,this.params.options,this.params);this.props=e,this.propKeys=Object.keys(e).filter(i=>e[i]!=null),this.from=t,this.to=e}}const bDt=(n,t)=>{var e;const i=(e=n.getFinalAttribute().angle)!==null&&e!==void 0?e:0;let r=0;return r=Yq(i/(2*Math.PI),0)?Math.round(i/(2*Math.PI))*Math.PI*2:su(t?.angle)?t.angle:t?.orient==="anticlockwise"?Math.ceil(i/(2*Math.PI))*Math.PI*2:Math.floor(i/(2*Math.PI))*Math.PI*2,{from:{angle:r},to:{angle:i}}},_Dt=(n,t)=>{var e;const i=(e=n.getFinalAttribute().angle)!==null&&e!==void 0?e:0;let r=0;return r=Yq(i/(2*Math.PI),0)?Math.round(i/(2*Math.PI))*Math.PI*2:su(t?.angle)?t.angle:t?.orient==="anticlockwise"?Math.ceil(i/(2*Math.PI))*Math.PI*2:Math.floor(i/(2*Math.PI))*Math.PI*2,{from:{angle:i},to:{angle:r}}};class uZ extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}onUpdate(t,e,i){const r=this.target.attribute;this.propKeys.forEach(o=>{r[o]=this.from[o]+(this.to[o]-this.from[o])*e}),this.target.addUpdatePositionTag(),this.target.addUpdateShapeAndBoundsTag()}}class CDt extends uZ{onBind(){var t;super.onBind();const{from:e,to:i}=bDt(this.target,this.params.options);this.props=i,this.propKeys=["angle"],this.from=e,this.to=i;const r=this.target.getFinalAttribute();r&&this.target.setAttributes(r),((t=this.params.controlOptions)===null||t===void 0?void 0:t.immediatelyApply)!==!1&&this.target.setAttributes(e)}}class wDt extends uZ{onBind(){super.onBind();const{from:t,to:e}=_Dt(this.target,this.params.options);this.props=e,this.propKeys=["angle"],this.from=t,this.to=e}}class xDt extends fe{constructor(t,e,i,r,o){var s;super(t,e,i,r,o),o&&(this.pathLength=o.path.getLength(),this.path=o.path,this.distance=o.distance,this.totalLength=this.distance*this.pathLength,this.initAngle=(s=o.initAngle)!==null&&s!==void 0?s:0,this.changeAngle=!!o.changeAngle,this.cb=o.cb)}onBind(){this.from={x:0,y:0},this.to=this.path.getAttrAt(this.totalLength).pos,this.props=this.to}onUpdate(t,e,i){const r={},o=this.totalLength*e,{pos:s,angle:a}=this.path.getAttrAt(o);r.x=s.x,r.y=s.y,this.changeAngle&&(r.angle=a+this.initAngle),this.cb&&this.cb(this.from,this.to,e,this.target),this.target.setAttributes(r)}}class SDt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o),this.from=t??{}}onBind(){var t,e;super.onBind(),Object.keys(this.from).forEach(r=>{this.props[r]==null&&(this.props[r]=this.target.getGraphicAttribute(r))});const i=this.target.getFinalAttribute();((t=this.target.context)===null||t===void 0?void 0:t.animationState)==="appear"&&i&&this.target.setAttributes(i),((e=this.params.controlOptions)===null||e===void 0?void 0:e.immediatelyApply)!==!1&&this.target.setAttributes(this.from)}onFirstRun(){this.from=Object.assign(Object.assign({},this.getLastProps()),this.from);const t=this.animate.getStartProps();this.propKeys&&this.propKeys.forEach(e=>{var i;this.from[e]=(i=this.from[e])!==null&&i!==void 0?i:t[e]}),this.target.setAttributes(this.from)}deleteSelfAttr(t){super.deleteSelfAttr(t),delete this.from[t]}update(t,e,i){if(this.onStart(),!this.props||!this.propKeys)return;const r=this.easing(e);this.animate.interpolateUpdateFunction?this.animate.interpolateUpdateFunction(this.from,this.props,r,this,this.target):this.interpolateUpdateFunctions.forEach((o,s)=>{if(!this.animate.validAttr(this.propKeys[s]))return;const a=this.propKeys[s];o(a,this.from[a],this.props[a],r,this,this.target)}),this.onUpdate(t,r,i),this.syncAttributeUpdate()}}class ADt extends fe{constructor(t,e,i,r,o){super(t,e,i,r,o)}getEndProps(){return{}}onStart(){this.target&&(this.target.type==="rect"?this.onStartRect():this.target.type==="line"?this.onStartLineOrArea("line"):this.target.type==="area"&&this.onStartLineOrArea("area"))}onStartLineOrArea(t){var e;const i=this.target.attachShadow(),r=bt.graphicService.creator[t](Object.assign({},(e=this.params)===null||e===void 0?void 0:e.attribute));this[t]=r,r.pathProxy=new wn,i.add(r)}onStartRect(){var t,e,i;const r=this.target.attachShadow(),o=(e=(t=this.params)===null||t===void 0?void 0:t.isHorizontal)===null||e===void 0||e,s=o?"height":"width",a=o?"width":"height",l=this.target.AABBBounds[s](),h=o?0:this.target.AABBBounds.y1,u=bt.graphicService.creator.rect(Object.assign(Object.assign({[s]:l,fill:"#bcdeff",shadowBlur:30,shadowColor:"#bcdeff"},(i=this.params)===null||i===void 0?void 0:i.attribute),{x:0,y:h,[a]:0}));this.rect=u,r.add(u)}onBind(){}onEnd(){this.target.detachShadow()}onUpdate(t,e,i){return this.rect?this.onUpdateRect(t,e,i):this.line||this.area?this.onUpdateLineOrArea(t,e,i):void 0}onUpdateRect(t,e,i){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b;const _=(o=(r=this.params)===null||r===void 0?void 0:r.isHorizontal)===null||o===void 0||o,w=this.target.attribute;if(_){const C=(a=(s=w.width)!==null&&s!==void 0?s:Math.abs(w.x1-w.x))!==null&&a!==void 0?a:250,x=(h=(l=this.params)===null||l===void 0?void 0:l.streamLength)!==null&&h!==void 0?h:C,S=(c=(d=(u=this.params)===null||u===void 0?void 0:u.attribute)===null||d===void 0?void 0:d.width)!==null&&c!==void 0?c:60,A=-S,T=A+(x-A)*e,M=Math.max(T,0),R=Math.min(Math.min(T+S,S),x-T),E=R+M>C?Math.max(C-M,0):R;this.rect.setAttributes({x:M+Math.min(w.x1-w.x,0),width:E},!1,{type:xr.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}else{const C=(g=(f=w.height)!==null&&f!==void 0?f:Math.abs(w.y1-w.y))!==null&&g!==void 0?g:250,x=(v=(p=this.params)===null||p===void 0?void 0:p.streamLength)!==null&&v!==void 0?v:C,S=(b=(y=(m=this.params)===null||m===void 0?void 0:m.attribute)===null||y===void 0?void 0:y.height)!==null&&b!==void 0?b:60,A=C-(x+S)*e;let T=Math.min(A,C);const M=Math.min(C-A,S);let R;T<=0?(R=Math.max(T+M,0),T=0):R=M,this.rect.setAttributes({y:T+Math.min(w.y1-w.y,0),height:R},!1,{type:xr.ANIMATE_PLAY,animationState:{ratio:e,end:t}})}}onUpdateLineOrArea(t,e,i){const r=this.line||this.area;if(!r)return;const o=r.pathProxy,s=this.target;s.cache||s.cacheArea?this._onUpdateLineOrAreaWithCache(o,s,t,e,i):this._onUpdateLineWithoutCache(o,s,t,e,i);const a=s.attribute;r.setAttributes(Object.assign({stroke:a.stroke},r.attribute)),r.addUpdateBoundTag()}_onUpdateLineOrAreaWithCache(t,e,i,r,o){var s,a;if(t.clear(),e.type==="line"){let l=e.cache;Array.isArray(l)||(l=[l]);const h=l.reduce((d,c)=>d+c.getLength(),0),u=[];return l.forEach(d=>{d.curves.forEach(c=>u.push(c))}),this._updateCurves(t,u,h,r)}if(e.type==="area"&&(!((a=(s=e.cacheArea)===null||s===void 0?void 0:s.top)===null||a===void 0)&&a.curves)){const l=e.cacheArea,h=l.top.curves.reduce((u,d)=>u+d.getLength(),0);return this._updateCurves(t,l.top.curves,h,r)}}_updateCurves(t,e,i,r){var o,s;const a=i*r,l=Math.min(a+((s=(o=this.params)===null||o===void 0?void 0:o.streamLength)!==null&&s!==void 0?s:10),i);let h=0,u=!1;for(let d=0;d<e.length;d++)if(e[d].defined!==!1){const c=e[d],f=c.getLength(),g=1-(h+f-a)/f;let p,v=1-(h+f-l)/f;if(h<a&&h+f>a)if(u=!0,c.p2&&c.p3){const[m,y]=Kg(c,g);t.moveTo(y.p0.x,y.p0.y),p=y}else{const m=c.getPointAt(g);t.moveTo(m.x,m.y)}if(h<l&&h+f>l){if(c.p2&&c.p3){p&&(v=(l-a)/p.getLength());const[m]=Kg(p||c,v);t.bezierCurveTo(m.p1.x,m.p1.y,m.p2.x,m.p2.y,m.p3.x,m.p3.y)}else{const m=c.getPointAt(v);t.lineTo(m.x,m.y)}break}if(u)if(c.p2&&c.p3){const m=p||c;t.bezierCurveTo(m.p1.x,m.p1.y,m.p2.x,m.p2.y,m.p3.x,m.p3.y)}else t.lineTo(c.p1.x,c.p1.y);h+=f}}_onUpdateLineWithoutCache(t,e,i,r,o){var s,a;const{points:l,curveType:h}=e.attribute;if(!l||l.length<2||h!=="linear")return;let u=0;for(let p=1;p<l.length;p++)u+=__.distancePP(l[p],l[p-1]);const d=u*r,c=Math.min(d+((a=(s=this.params)===null||s===void 0?void 0:s.streamLength)!==null&&a!==void 0?a:10),u),f=[];let g=0;for(let p=1;p<l.length;p++){const v=__.distancePP(l[p],l[p-1]);if(g<d&&g+v>d&&f.push(__.pointAtPP(l[p-1],l[p],1-(g+v-d)/v)),g<c&&g+v>c){f.push(__.pointAtPP(l[p-1],l[p],1-(g+v-c)/v));break}f.length&&f.push(l[p]),g+=v}if(f.length&&!(f.length<2)){t.clear(),t.moveTo(f[0].x,f[0].y);for(let p=1;p<f.length;p++)t.lineTo(f[p].x,f[p].y)}}}class ky extends Zq{constructor(t,e,i,r,o){super(t,e,i,r,o),this.webglCanvas=null,this.gl=null,this.program=null,this.currentAnimationRatio=0,this.animationTime=0}onUpdate(t,e,i){super.onUpdate(t,e,i),this.currentAnimationRatio=e,this.animationTime=e*Math.PI*2}getAnimationTime(){return this.currentAnimationRatio>0?this.animationTime:Date.now()/1e3}getDurationFromParent(){return this.duration||1e3}initWebGL(t){try{if(this.webglCanvas=Dt.createCanvas({width:t.width,height:t.height,dpr:Dt.devicePixelRatio}),!this.webglCanvas)return!1;this.webglCanvas.style.width=t.style.width||`${t.width}px`,this.webglCanvas.style.height=t.style.height||`${t.height}px`;let e=null;try{e=this.webglCanvas.getContext("webgl"),e||(e=this.webglCanvas.getContext("experimental-webgl"))}catch{}if(this.gl=e,!this.gl)return!1;const i=this.getShaderSources();return this.program=this.createShaderProgram(i.vertex,i.fragment),this.program!==null}catch{return!1}}createShaderProgram(t,e){if(!this.gl)return null;const i=this.createShader(this.gl.VERTEX_SHADER,t),r=this.createShader(this.gl.FRAGMENT_SHADER,e);if(!i||!r)return null;const o=this.gl.createProgram();return o?(this.gl.attachShader(o,i),this.gl.attachShader(o,r),this.gl.linkProgram(o),this.gl.getProgramParameter(o,this.gl.LINK_STATUS)?o:null):null}createShader(t,e){if(!this.gl)return null;const i=this.gl.createShader(t);return i?(this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(this.gl.deleteShader(i),null)):null}setupWebGLState(t){this.gl&&this.webglCanvas&&(this.webglCanvas.width===t.width&&this.webglCanvas.height===t.height||(this.webglCanvas.width=t.width,this.webglCanvas.height=t.height),this.gl.viewport(0,0,this.webglCanvas.width,this.webglCanvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT))}createFullScreenQuad(){if(!this.gl)return null;const t=new Float32Array([-1,-1,0,1,1,-1,1,1,-1,1,0,0,1,1,1,0]),e=this.gl.createBuffer();return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),e}createTextureFromCanvas(t){if(!this.gl)return null;const e=this.gl.createTexture();return this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),e}setupVertexAttributes(){if(!this.gl||!this.program)return;const t=this.gl.getAttribLocation(this.program,"a_position"),e=this.gl.getAttribLocation(this.program,"a_texCoord");this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(e),this.gl.vertexAttribPointer(e,2,this.gl.FLOAT,!1,16,8)}createOutputCanvas(t){const e=Dt.createCanvas({width:t.width,height:t.height,dpr:Dt.devicePixelRatio}),i=e.getContext("2d");return i?(i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),{canvas:e,ctx:i}):null}getShaderSources(){return null}applyWebGLEffect(t){return null}applyCanvas2DEffect(t){return null}supportsWebGL(){return this.getShaderSources()!==null}supportsCanvas2D(){return this.applyCanvas2DEffect!==ky.prototype.applyCanvas2DEffect}release(){super.release(),this.gl&&(this.program&&(this.gl.deleteProgram(this.program),this.program=null),this.gl=null),this.webglCanvas&&(this.webglCanvas=null),this.currentAnimationRatio=0,this.animationTime=0}afterStageRender(t,e){let i=null;return this.supportsWebGL()&&(this.gl||this.initWebGL(e),this.gl)&&(i=this.applyWebGLEffect(e),i)||this.supportsCanvas2D()&&(i=this.applyCanvas2DEffect(e),i)?i:(this.supportsWebGL()||this.supportsCanvas2D(),e)}}class TDt extends ky{constructor(t,e,i,r,o){super(t,e,i,r,o)}getShaderSources(){return null}applyWebGLEffect(t){return null}}class bc extends ky{constructor(t,e,i,r,o){super(t,e,i,r,o)}getShaderSources(){return null}applyWebGLEffect(t){return null}applyCanvas2DEffect(t){return null}supportsWebGL(){return this.getShaderSources!==bc.prototype.getShaderSources&&this.getShaderSources()!==null}supportsCanvas2D(){return this.applyCanvas2DEffect!==bc.prototype.applyCanvas2DEffect}afterStageRender(t,e){var i,r;let o=null;if(((r=(i=this.params)===null||i===void 0?void 0:i.options)===null||r===void 0?void 0:r.useWebGL)!==!1){if(this.supportsWebGL()&&(this.gl||this.initWebGL(e),this.gl)&&(o=this.applyWebGLEffect(e),o)||this.supportsCanvas2D()&&(o=this.applyCanvas2DEffect(e),o))return o}else if(this.supportsCanvas2D()&&(o=this.applyCanvas2DEffect(e),o))return o;return this.supportsWebGL()||this.supportsCanvas2D(),e}}class ni{static createTempCanvas(t,e,i){return Dt.createCanvas({width:t,height:e,dpr:i||Dt.devicePixelRatio})}static cloneImageData(t){const e=new Uint8ClampedArray(t.data);return new ImageData(e,t.width,t.height)}static lerp(t,e,i){return t*(1-i)+e*i}static smoothstep(t,e,i){const r=Math.max(0,Math.min(1,(i-t)/(e-t)));return r*r*(3-2*r)}static distance(t,e,i,r){const o=i-t,s=r-e;return Math.sqrt(o*o+s*s)}static normalizeAngle(t){return(t+Math.PI)/(2*Math.PI)}static pixelNoise(t,e,i){if(i<=0)return 0;const r=Math.floor(t/i)*i,o=Math.floor(e/i)*i,s=43758.5453*Math.sin(12.9898*r+78.233*o);return s-Math.floor(s)}static generateNoiseTexture(t,e){const i=new Uint8Array(t*e);for(let r=0;r<i.length;r++)i[r]=Math.floor(256*Math.random());return i}static applyCSSFilter(t,e){const i=this.createTempCanvas(t.width,t.height),r=i.getContext("2d");return r?(r.filter=e,r.drawImage(t,0,0),r.filter="none",i):t}static extractChannel(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);for(let a=0;a<i.length;a+=4)s[a]=0,s[a+1]=0,s[a+2]=0,s[a+3]=i[a+3],e>=0&&e<=2&&(s[a+e]=i[a+e]);return new ImageData(s,r,o)}static blendImageData(t,e,i){const{data:r,width:o,height:s}=t,{data:a}=e,l=new Uint8ClampedArray(r.length);for(let h=0;h<r.length;h+=4)l[h]=Math.round(this.lerp(r[h],a[h],i)),l[h+1]=Math.round(this.lerp(r[h+1],a[h+1],i)),l[h+2]=Math.round(this.lerp(r[h+2],a[h+2],i)),l[h+3]=Math.round(this.lerp(r[h+3],a[h+3],i));return new ImageData(l,o,s)}static getLuminance(t,e,i){return .299*t+.587*e+.114*i}static applySepiaToPixel(t,e,i){return[Math.min(255,.393*t+.769*e+.189*i),Math.min(255,.349*t+.686*e+.168*i),Math.min(255,.272*t+.534*e+.131*i)]}static calculateDynamicStrength(t,e){return t*(e/(2*Math.PI))}}class op{}op.STANDARD_VERTEX_SHADER=`
    attribute vec2 a_position;
    attribute vec2 a_texCoord;
    varying vec2 v_texCoord;

    void main() {
      gl_Position = vec4(a_position, 0.0, 1.0);
      v_texCoord = a_texCoord;
    }
  `,op.SHADER_FUNCTIONS=`
    // 
    float luminance(vec3 color) {
      return dot(color, vec3(0.299, 0.587, 0.114));
    }

    // 
    vec3 sepia(vec3 color) {
      float r = color.r * 0.393 + color.g * 0.769 + color.b * 0.189;
      float g = color.r * 0.349 + color.g * 0.686 + color.b * 0.168;
      float b = color.r * 0.272 + color.g * 0.534 + color.b * 0.131;
      return vec3(r, g, b);
    }

    // 
    float lerp(float a, float b, float t) {
      return a * (1.0 - t) + b * t;
    }


    // 
    float pixelNoise(vec2 coord, float pixelSize) {
      vec2 gridCoord = floor(coord / pixelSize) * pixelSize;
      return fract(sin(dot(gridCoord, vec2(12.9898, 78.233))) * 43758.5453123);
    }

    // 
    float calculateDynamicStrength(float baseStrength, float time) {
      return baseStrength * (time / 6.28318531); // 2
    }
  `;class MDt extends bc{constructor(t,e,i,r,o){var s,a,l,h;super(t,e,i,r,o),this.noiseData=null;const u=(s=o?.options)===null||s===void 0?void 0:s.noiseScale,d=u!==void 0?Math.max(0,Math.floor(u)):8;this.dissolveConfig={dissolveType:((a=o?.options)===null||a===void 0?void 0:a.dissolveType)||"outward",useWebGL:((l=o?.options)===null||l===void 0?void 0:l.useWebGL)===void 0||o.options.useWebGL,noiseScale:d,fadeEdge:((h=o?.options)===null||h===void 0?void 0:h.fadeEdge)===void 0||o.options.fadeEdge}}getShaderSources(){return{vertex:op.STANDARD_VERTEX_SHADER,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform sampler2D u_noiseTexture;
      uniform float u_time;
      uniform int u_dissolveType;
      uniform vec2 u_resolution;
      uniform float u_noiseScale;
      uniform bool u_fadeEdge;
      varying vec2 v_texCoord;

      ${op.SHADER_FUNCTIONS}

      // 
      float outwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float distFromCenter = length(uv - center);
        float maxDist = length(vec2(0.5, 0.5));

        //  (01)
        float normalizedDist = distFromCenter / maxDist;

        // time
        // 
        float edgeThreshold = 1.2 - time * 1.5;

        // pixelSize > 0
        if (pixelSize > 0.0) {
          // 
          vec2 pixelCoord = uv * resolution; // 
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.4; // 
          edgeThreshold += noiseInfluence;
          return normalizedDist > edgeThreshold ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.15; // 
            return 1.0 - smoothstep(edgeThreshold - fadeWidth, edgeThreshold, normalizedDist);
          } else {
            // 01
            return normalizedDist > edgeThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 
      float inwardDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float distFromCenter = length(uv - center);
        float maxDist = length(vec2(0.5, 0.5));

        float normalizedDist = distFromCenter / maxDist;

        // time
        // 
        float centerThreshold = time * 1.4;

        // pixelSize > 0
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.4;
          centerThreshold += noiseInfluence;
          return normalizedDist < centerThreshold ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.15; // 
            return smoothstep(centerThreshold, centerThreshold + fadeWidth, normalizedDist);
          } else {
            // 01
            return normalizedDist < centerThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 
      float radialDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        vec2 center = vec2(0.5, 0.5);
        float angle = atan(uv.y - center.y, uv.x - center.x);
        float normalizedAngle = (angle + 3.14159) / (2.0 * 3.14159);

        // time
        // 
        float angleThreshold = time * 1.2;

        // pixelSize > 0
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          angleThreshold += noiseInfluence;
          return normalizedAngle < angleThreshold ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.08; // 
            return smoothstep(angleThreshold, angleThreshold + fadeWidth, normalizedAngle);
          } else {
            // 01
            return normalizedAngle < angleThreshold ? 0.0 : 1.0;
          }
        }
      }

      // 
      float leftToRightDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // x=0x=1
        float dissolvePosition = time * 1.2; // 

        // pixelSize > 0
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.x < dissolvePosition ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.08; // 
            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.x);
          } else {
            // 01
            return uv.x < dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 
      float rightToLeftDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // x=1x=0
        float dissolvePosition = 1.0 - time * 1.2; // 

        // pixelSize > 0
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.x > dissolvePosition ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.08; // 
            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.x);
          } else {
            // 01
            return uv.x > dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 
      float topToBottomDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // y=0y=1
        float dissolvePosition = time * 1.2; // 

        // pixelSize > 0
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.y < dissolvePosition ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.08; // 
            return smoothstep(dissolvePosition, dissolvePosition + fadeWidth, uv.y);
          } else {
            // 01
            return uv.y < dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      // 
      float bottomToTopDissolve(vec2 uv, float time, float pixelSize, vec2 resolution) {
        // y=1y=0
        float dissolvePosition = 1.0 - time * 1.2; // 

        // pixelSize > 0
        if (pixelSize > 0.0) {
          vec2 pixelCoord = uv * resolution;
          float noiseValue = pixelNoise(pixelCoord, pixelSize);
          float noiseInfluence = (noiseValue - 0.5) * 0.3;
          dissolvePosition += noiseInfluence;
          return uv.y > dissolvePosition ? 0.0 : 1.0;
        } else {
          // fadeEdge
          if (u_fadeEdge) {
            // 
            float fadeWidth = 0.08; // 
            return smoothstep(dissolvePosition - fadeWidth, dissolvePosition, uv.y);
          } else {
            // 01
            return uv.y > dissolvePosition ? 0.0 : 1.0;
          }
        }
      }

      void main() {
        vec2 uv = v_texCoord;
        vec4 texColor = texture2D(u_texture, uv);

        float alpha = 1.0;

        // 
        if (u_dissolveType == 0) {
          alpha = outwardDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 1) {
          alpha = inwardDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 2) {
          alpha = radialDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 3) {
          alpha = leftToRightDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 4) {
          alpha = rightToLeftDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 5) {
          alpha = topToBottomDissolve(uv, u_time, u_noiseScale, u_resolution);
        } else if (u_dissolveType == 6) {
          alpha = bottomToTopDissolve(uv, u_time, u_noiseScale, u_resolution);
        }

        gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return t;this.setupWebGLState(t);const e=this.createTextureFromCanvas(t);if(!e)return t;this.noiseData||(this.noiseData=ni.generateNoiseTexture(256,256));const i=this.gl.createTexture();this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,256,256,0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,this.noiseData),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);const r=this.createFullScreenQuad();return r?(this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setUniforms(),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.deleteTexture(e),this.gl.deleteTexture(i),this.gl.deleteBuffer(r),this.webglCanvas):t}setUniforms(){if(!this.gl||!this.program||!this.webglCanvas)return;const t=this.gl.getUniformLocation(this.program,"u_texture"),e=this.gl.getUniformLocation(this.program,"u_noiseTexture"),i=this.gl.getUniformLocation(this.program,"u_time"),r=this.gl.getUniformLocation(this.program,"u_dissolveType"),o=this.gl.getUniformLocation(this.program,"u_resolution"),s=this.gl.getUniformLocation(this.program,"u_noiseScale"),a=this.gl.getUniformLocation(this.program,"u_fadeEdge");this.gl.uniform1i(t,0),this.gl.uniform1i(e,1),this.gl.uniform1f(i,this.currentAnimationRatio),this.gl.uniform2f(o,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1f(s,this.dissolveConfig.noiseScale),this.gl.uniform1i(a,this.dissolveConfig.fadeEdge?1:0),this.gl.uniform1i(r,{outward:0,inward:1,radial:2,leftToRight:3,rightToLeft:4,topToBottom:5,bottomToTop:6}[this.dissolveConfig.dissolveType]||0)}applyCanvas2DEffect(t){const e=this.createOutputCanvas(t);if(!e)return t;const{canvas:i,ctx:r}=e,o=r.getImageData(0,0,t.width,t.height),s=this.currentAnimationRatio;let a;switch(this.dissolveConfig.dissolveType){case"outward":a=this.applyOutwardDissolve(o,s);break;case"inward":a=this.applyInwardDissolve(o,s);break;case"radial":a=this.applyRadialDissolve(o,s);break;case"leftToRight":a=this.applyLeftToRightDissolve(o,s);break;case"rightToLeft":a=this.applyRightToLeftDissolve(o,s);break;case"topToBottom":a=this.applyTopToBottomDissolve(o,s);break;case"bottomToTop":a=this.applyBottomToTopDissolve(o,s);break;default:a=o}return r.putImageData(a,0,0),i}applyOutwardDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=r/2,l=o/2,h=Math.sqrt(a*a+l*l),u=this.dissolveConfig.noiseScale;for(let d=0;d<o;d++)for(let c=0;c<r;c++){const f=c-a,g=d-l,p=Math.sqrt(f*f+g*g)/h;let v=1.2-1.4*e,m=1;if(u>0)v+=.4*(ni.pixelNoise(c,d,u)-.5),m=p>v?0:1;else if(this.dissolveConfig.fadeEdge){const b=v-.15;m=p<b?1:p>v?0:1-(p-b)/(v-b)}else m=p>v?0:1;const y=4*(d*r+c);s[y+3]=Math.floor(s[y+3]*m)}return new ImageData(s,r,o)}applyInwardDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=r/2,l=o/2,h=Math.sqrt(a*a+l*l),u=this.dissolveConfig.noiseScale;for(let d=0;d<o;d++)for(let c=0;c<r;c++){const f=c-a,g=d-l,p=Math.sqrt(f*f+g*g)/h;let v=1.4*e,m=1;if(u>0)v+=.4*(ni.pixelNoise(c,d,u)-.5),m=p<v?0:1;else if(this.dissolveConfig.fadeEdge){const b=v+.15;m=p<v?0:p>b?1:(p-v)/(b-v)}else m=p<v?0:1;const y=4*(d*r+c);s[y+3]=Math.floor(s[y+3]*m)}return new ImageData(s,r,o)}applyRadialDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=r/2,l=o/2,h=this.dissolveConfig.noiseScale;for(let u=0;u<o;u++)for(let d=0;d<r;d++){const c=d-a,f=u-l,g=(Math.atan2(f,c)+Math.PI)/(2*Math.PI);let p=1.2*e,v=1;if(h>0)p+=.3*(ni.pixelNoise(d,u,h)-.5),v=g<p?0:1;else if(this.dissolveConfig.fadeEdge){const y=p+.08;v=g<p?0:g>y?1:(g-p)/(y-p)}else v=g<p?0:1;const m=4*(u*r+d);s[m+3]=Math.floor(s[m+3]*v)}return new ImageData(s,r,o)}applyLeftToRightDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=this.dissolveConfig.noiseScale;for(let l=0;l<o;l++)for(let h=0;h<r;h++){const u=h/r;let d=1.2*e,c=1;if(a>0)d+=.3*(ni.pixelNoise(h,l,a)-.5),c=u<d?0:1;else if(this.dissolveConfig.fadeEdge){const g=d+.08;c=u<d?0:u>g?1:(u-d)/(g-d)}else c=u<d?0:1;const f=4*(l*r+h);s[f+3]=Math.floor(s[f+3]*c)}return new ImageData(s,r,o)}applyRightToLeftDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=this.dissolveConfig.noiseScale;for(let l=0;l<o;l++)for(let h=0;h<r;h++){const u=h/r;let d=1-1.2*e,c=1;if(a>0)d+=.3*(ni.pixelNoise(h,l,a)-.5),c=u>d?0:1;else if(this.dissolveConfig.fadeEdge){const g=d-.08;c=u<g?1:u>d?0:1-(u-g)/(d-g)}else c=u>d?0:1;const f=4*(l*r+h);s[f+3]=Math.floor(s[f+3]*c)}return new ImageData(s,r,o)}applyTopToBottomDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=this.dissolveConfig.noiseScale;for(let l=0;l<o;l++)for(let h=0;h<r;h++){const u=l/o;let d=1.2*e,c=1;if(a>0)d+=.3*(ni.pixelNoise(h,l,a)-.5),c=u<d?0:1;else if(this.dissolveConfig.fadeEdge){const g=d+.08;c=u<d?0:u>g?1:(u-d)/(g-d)}else c=u<d?0:1;const f=4*(l*r+h);s[f+3]=Math.floor(s[f+3]*c)}return new ImageData(s,r,o)}applyBottomToTopDissolve(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i.length);s.set(i);const a=this.dissolveConfig.noiseScale;for(let l=0;l<o;l++)for(let h=0;h<r;h++){const u=l/o;let d=1-1.2*e,c=1;if(a>0)d+=.3*(ni.pixelNoise(h,l,a)-.5),c=u>d?0:1;else if(this.dissolveConfig.fadeEdge){const g=d-.08;c=u<g?1:u>d?0:1-(u-g)/(d-g)}else c=u>d?0:1;const f=4*(l*r+h);s[f+3]=Math.floor(s[f+3]*c)}return new ImageData(s,r,o)}}class RDt extends bc{constructor(t,e,i,r,o){var s,a,l;super(t,e,i,r,o);const h=((s=o?.options)===null||s===void 0?void 0:s.strength)!==void 0?o.options.strength:1,u=Math.max(0,Math.min(1,h));this.colorConfig={effectType:((a=o?.options)===null||a===void 0?void 0:a.effectType)||"grayscale",strength:u,useWebGL:((l=o?.options)===null||l===void 0?void 0:l.useWebGL)===void 0||o.options.useWebGL}}getShaderSources(){return{vertex:op.STANDARD_VERTEX_SHADER,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform float u_time;
      uniform float u_strength;
      uniform int u_effectType;
      uniform vec2 u_resolution;
      varying vec2 v_texCoord;

      ${op.SHADER_FUNCTIONS}

      void main() {
        vec2 uv = v_texCoord;
        vec4 originalColor = texture2D(u_texture, uv);
        vec3 color = originalColor.rgb;

        // 
        float dynamicStrength = calculateDynamicStrength(u_strength, u_time);

        if (u_effectType == 0) {
          // 
          float gray = luminance(color);
          vec3 grayColor = vec3(gray);
          color = mix(color, grayColor, dynamicStrength);
        } else if (u_effectType == 1) {
          // 
          vec3 sepiaColor = sepia(color);
          color = mix(color, sepiaColor, dynamicStrength);
        }

        gl_FragColor = vec4(color, originalColor.a);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);const e=this.createTextureFromCanvas(t);if(!e)return null;const i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setColorUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}setColorUniforms(){if(!this.gl||!this.program)return;const t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),r=this.gl.getUniformLocation(this.program,"u_effectType"),o=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.colorConfig.strength),this.gl.uniform2f(o,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(r,{grayscale:0,sepia:1}[this.colorConfig.effectType]||0)}applyCanvas2DEffect(t){if(this.colorConfig.strength<=0){const r=this.createOutputCanvas(t);return r?r.canvas:null}if(this.canUseCSSFilter())return this.applyCSSFilter(t);const e=this.createOutputCanvas(t);if(!e)return null;const{ctx:i}=e;try{const r=i.getImageData(0,0,t.width,t.height),o=this.getAnimationTime();let s;switch(this.colorConfig.effectType){case"grayscale":default:s=this.applyGrayscaleEffect(r,this.colorConfig.strength,o);break;case"sepia":s=this.applySepiaEffect(r,this.colorConfig.strength,o)}return i.clearRect(0,0,t.width,t.height),i.putImageData(s,0,0),e.canvas}catch{return null}}canUseCSSFilter(){var t;return!!window.useFilterAPI&&typeof CSS<"u"&&((t=CSS.supports)===null||t===void 0?void 0:t.call(CSS,"filter","grayscale(1)"))}applyCSSFilter(t){try{const e=ni.createTempCanvas(t.width,t.height),i=e.getContext("2d");if(!i)return null;const r=this.getAnimationTime(),o=ni.calculateDynamicStrength(this.colorConfig.strength,r);let s="";return this.colorConfig.effectType==="grayscale"?s=`grayscale(${Math.min(1,o)})`:this.colorConfig.effectType==="sepia"&&(s=`sepia(${Math.min(1,o)})`),i.filter=s,i.drawImage(t,0,0),i.filter="none",e}catch{return null}}applyGrayscaleEffect(t,e,i){const{data:r,width:o,height:s}=t,a=new Uint8ClampedArray(r.length),l=ni.calculateDynamicStrength(e,i);for(let h=0;h<r.length;h+=4){const u=r[h],d=r[h+1],c=r[h+2],f=r[h+3],g=ni.getLuminance(u,d,c);a[h]=Math.round(ni.lerp(u,g,l)),a[h+1]=Math.round(ni.lerp(d,g,l)),a[h+2]=Math.round(ni.lerp(c,g,l)),a[h+3]=f}return new ImageData(a,o,s)}applySepiaEffect(t,e,i){const{data:r,width:o,height:s}=t,a=new Uint8ClampedArray(r.length),l=ni.calculateDynamicStrength(e,i);for(let h=0;h<r.length;h+=4){const u=r[h],d=r[h+1],c=r[h+2],f=r[h+3],[g,p,v]=ni.applySepiaToPixel(u,d,c);a[h]=Math.round(ni.lerp(u,g,l)),a[h+1]=Math.round(ni.lerp(d,p,l)),a[h+2]=Math.round(ni.lerp(c,v,l)),a[h+3]=f}return new ImageData(a,o,s)}afterStageRender(t,e){if(this.canUseCSSFilter()&&this.colorConfig.strength>0){const i=this.applyCSSFilter(e);if(i)return i}return super.afterStageRender(t,e)}}class BDt extends bc{constructor(t,e,i,r,o){var s,a,l;super(t,e,i,r,o),this.distortionConfig={distortionType:((s=o?.options)===null||s===void 0?void 0:s.distortionType)||"wave",strength:((a=o?.options)===null||a===void 0?void 0:a.strength)||.3,useWebGL:((l=o?.options)===null||l===void 0?void 0:l.useWebGL)===void 0||o.options.useWebGL}}getShaderSources(){return{vertex:`
      attribute vec2 a_position;
      attribute vec2 a_texCoord;
      varying vec2 v_texCoord;

      void main() {
        gl_Position = vec4(a_position, 0.0, 1.0);
        v_texCoord = a_texCoord;
      }
    `,fragment:`
      precision mediump float;
      uniform sampler2D u_texture;
      uniform float u_time;
      uniform float u_strength;
      uniform int u_distortionType;
      uniform vec2 u_resolution;
      varying vec2 v_texCoord;

      // 
      vec2 wave(vec2 uv, float time, float strength) {
        float waveX = sin(uv.y * 10.0 + time * 3.0) * strength * 0.1;
        float waveY = sin(uv.x * 10.0 + time * 2.0) * strength * 0.1;
        return uv + vec2(waveX, waveY);
      }

      // 
      vec2 ripple(vec2 uv, float time, float strength) {
        vec2 center = vec2(0.5, 0.5);
        float distance = length(uv - center);
        float ripple = sin(distance * 20.0 - time * 5.0) * strength * 0.1;
        vec2 direction = normalize(uv - center);
        return uv + direction * ripple;
      }

      // 
      vec2 swirl(vec2 uv, float time, float strength) {
        vec2 center = vec2(0.5, 0.5);
        vec2 delta = uv - center;
        float dist = length(delta);
        float originalAngle = atan(delta.y, delta.x);
        float rotationAngle = dist * strength * time * 2.0;
        float finalAngle = originalAngle + rotationAngle;
        return center + dist * vec2(cos(finalAngle), sin(finalAngle));
      }

      void main() {
        vec2 uv = v_texCoord;

        // 
        if (u_distortionType == 0) {
          uv = wave(uv, u_time, u_strength);
        } else if (u_distortionType == 1) {
          uv = ripple(uv, u_time, u_strength);
        } else if (u_distortionType == 2) {
          uv = swirl(uv, u_time, u_strength);
        }

        // 
        if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        } else {
          gl_FragColor = texture2D(u_texture, uv);
        }
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t);const e=this.createTextureFromCanvas(t);if(!e)return null;const i=this.createFullScreenQuad();if(!i)return this.gl.deleteTexture(e),null;try{return this.gl.useProgram(this.program),this.setupVertexAttributes(),this.setDistortionUniforms(),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.webglCanvas}finally{this.gl.deleteTexture(e),this.gl.deleteBuffer(i)}}setDistortionUniforms(){if(!this.gl||!this.program)return;const t=this.getAnimationTime(),e=this.gl.getUniformLocation(this.program,"u_time"),i=this.gl.getUniformLocation(this.program,"u_strength"),r=this.gl.getUniformLocation(this.program,"u_distortionType"),o=this.gl.getUniformLocation(this.program,"u_resolution");this.gl.uniform1f(e,t),this.gl.uniform1f(i,this.distortionConfig.strength),this.gl.uniform2f(o,this.webglCanvas.width,this.webglCanvas.height),this.gl.uniform1i(r,{wave:0,ripple:1,swirl:2}[this.distortionConfig.distortionType]||0)}applyCanvas2DEffect(t){const e=this.createOutputCanvas(t);if(!e)return null;const{ctx:i}=e;try{const r=i.getImageData(0,0,t.width,t.height),o=this.getAnimationTime();let s;switch(this.distortionConfig.distortionType){case"wave":s=this.applyWaveDistortion(r,this.distortionConfig.strength,o);break;case"ripple":s=this.applyRippleDistortion(r,this.distortionConfig.strength,o);break;case"swirl":s=this.applySwirlDistortion(r,this.distortionConfig.strength,o);break;default:s=r}return i.clearRect(0,0,t.width,t.height),i.putImageData(s,0,0),e.canvas}catch{return null}}applyWaveDistortion(t,e,i){const{data:r,width:o,height:s}=t,a=new Uint8ClampedArray(r.length);for(let l=0;l<s;l++)for(let h=0;h<o;h++){const u=Math.sin(.1*l+3*i)*e*20,d=Math.sin(.1*h+2*i)*e*20,c=Math.round(h-u),f=Math.round(l-d),g=4*(l*o+h);if(c>=0&&c<o&&f>=0&&f<s){const p=4*(f*o+c);a[g]=r[p],a[g+1]=r[p+1],a[g+2]=r[p+2],a[g+3]=r[p+3]}else a[g+3]=0}return new ImageData(a,o,s)}applyRippleDistortion(t,e,i){const{data:r,width:o,height:s}=t,a=new Uint8ClampedArray(r.length),l=o/2,h=s/2;for(let u=0;u<s;u++)for(let d=0;d<o;d++){const c=d-l,f=u-h,g=Math.sqrt(c*c+f*f),p=Math.sin(.2*g-5*i)*e*10,v=Math.atan2(f,c),m=Math.round(d-Math.cos(v)*p),y=Math.round(u-Math.sin(v)*p),b=4*(u*o+d);if(m>=0&&m<o&&y>=0&&y<s){const _=4*(y*o+m);a[b]=r[_],a[b+1]=r[_+1],a[b+2]=r[_+2],a[b+3]=r[_+3]}else a[b+3]=0}return new ImageData(a,o,s)}applySwirlDistortion(t,e,i){const{data:r,width:o,height:s}=t,a=new Uint8ClampedArray(r.length),l=o/2,h=s/2;for(let u=0;u<s;u++)for(let d=0;d<o;d++){const c=d-l,f=u-h,g=Math.sqrt(c*c+f*f),p=Math.atan2(f,c)+g*e*i*.02,v=Math.round(l+g*Math.cos(p)),m=Math.round(h+g*Math.sin(p)),y=4*(u*o+d);if(v>=0&&v<o&&m>=0&&m<s){const b=4*(m*o+v);a[y]=r[b],a[y+1]=r[b+1],a[y+2]=r[b+2],a[y+3]=r[b+3]}else a[y+3]=0}return new ImageData(a,o,s)}afterStageRender(t,e){return this.distortionConfig.strength<=0?e:super.afterStageRender(t,e)}}class PDt extends bc{constructor(t,e,i,r,o){var s,a,l,h,u;super(t,e,i,r,o),this.particles=[],this.positionBuffer=null,this.colorBuffer=null,this.particleConfig={effectType:((s=o?.options)===null||s===void 0?void 0:s.effectType)||"gravity",count:((a=o?.options)===null||a===void 0?void 0:a.count)||4e3,size:((l=o?.options)===null||l===void 0?void 0:l.size)||20,strength:((h=o?.options)===null||h===void 0?void 0:h.strength)||1.5,useWebGL:((u=o?.options)===null||u===void 0?void 0:u.useWebGL)===void 0||o.options.useWebGL}}getShaderSources(){return{vertex:`
      attribute vec2 a_position;
      attribute vec4 a_color;
      attribute float a_size;

      uniform vec2 u_resolution;
      uniform float u_time;
      uniform float u_forceStrength;
      uniform int u_effectType;

      varying vec4 v_color;

      void main() {
        // 
        vec2 clipSpace = ((a_position / u_resolution) * 2.0) - 1.0;
        clipSpace.y = -clipSpace.y; // Y

        gl_Position = vec4(clipSpace, 0.0, 1.0);
        gl_PointSize = a_size;
        v_color = a_color;
      }
    `,fragment:`
      precision mediump float;
      varying vec4 v_color;

      void main() {
        // 
        vec2 coord = gl_PointCoord - vec2(0.5);
        float distance = length(coord);

        if (distance > 0.5) {
          discard;
        }

        // 
        gl_FragColor = vec4(v_color.rgb, v_color.a);
      }
    `}}applyWebGLEffect(t){if(!this.gl||!this.program||!this.webglCanvas)return null;this.setupWebGLState(t),this.particles.length===0&&this.extractParticles(t),this.updateParticles(t);const e=this.gl;return e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.program),this.prepareAndDrawParticles(e),this.webglCanvas}applyCanvas2DEffect(t){const e=this.createOutputCanvas(t);if(!e)return null;const{canvas:i,ctx:r}=e,o=this.currentAnimationRatio;switch(this.particleConfig.effectType){case"explode":this.applyCanvas2DExplode(r,t,o);break;case"gravity":this.applyCanvas2DGravity(r,t,o);break;case"vortex":this.applyCanvas2DVortex(r,t,o);break;default:r.globalAlpha=Math.max(0,1-o),r.drawImage(t,0,0)}return i}extractParticles(t){const e=ni.createTempCanvas(t.width,t.height,1),i=e.getContext("2d");if(!i)return;i.drawImage(t,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height).data;this.particles=[];const o=Math.max(1,Math.floor(Math.sqrt(e.width*e.height/(1.5*this.particleConfig.count))));for(let s=0;s<e.height;s+=o)for(let a=0;a<e.width;a+=o){const l=4*(s*e.width+a),h=r[l],u=r[l+1],d=r[l+2],c=r[l+3];if(c>5){const f=a/e.width*t.width,g=s/e.height*t.height,p={x:f,y:g,originX:f,originY:g,vx:0,vy:0,r:h/255,g:u/255,b:d/255,a:Math.max(.6,c/255),life:1,size:this.particleConfig.size*(1+.5*Math.random())};this.particles.push(p)}}}updateParticles(t){const e=t.width/2,i=t.height/2,r=this.currentAnimationRatio,o=this.getDurationFromParent(),s=o<2e3,a=s?Math.max(1.5,3e3/o):1,l=s?Math.min(2,2e3/o):1;this.particles.forEach(h=>{const u=h.x-e,d=h.y-i,c=Math.sqrt(u*u+d*d),f=Math.atan2(d,u);this.applyParticleForces(h,f,c,r,l,t),this.updateParticleProperties(h,r,s,a,l)})}applyParticleForces(t,e,i,r,o,s){const a=this.getAnimationTime();switch(this.particleConfig.effectType){case"explode":const l=r*this.particleConfig.strength*o*5;t.vx+=Math.cos(e)*l,t.vy+=Math.sin(e)*l;break;case"gravity":this.applyGravityEffect(t,r,o,s,a);break;case"vortex":this.applyVortexEffect(t,r,o,s,e,i)}}applyGravityEffect(t,e,i,r,o){const s=(t.originX+.7*t.originY)/(r.width+r.height)*.8;if(e>s){const a=(e-s)/(1-s),l=this.particleConfig.strength*a*a*12*i;t.vy+=l;const h=Math.sin(3*o+.02*t.originX)*Math.cos(2*o+.015*t.originY);t.vx+=h*this.particleConfig.strength*2*i}}applyVortexEffect(t,e,i,r,o,s){const a=r.width/2,l=r.height/2,h=o+e*Math.PI*.8,u=s+e*Math.max(r.width,r.height)*.7*1.8,d=a+Math.cos(h)*u,c=l+Math.sin(h)*u,f=e*this.particleConfig.strength*.08*i;t.vx+=(d-t.x)*f,t.vy+=(c-t.y)*f}updateParticleProperties(t,e,i,r,o){const s=i?.99:.98;if(t.vx*=s,t.vy*=s,t.x+=t.vx,t.y+=t.vy,i){const a=Math.max(.1,.5/r);t.life=Math.max(0,1-e*a),t.a=Math.max(.2,t.life*Math.min(1,1.2*t.a)),t.size=Math.max(.7*this.particleConfig.size,this.particleConfig.size*(.5+.5*t.life))}else t.life=Math.max(0,1-.2*e),t.a=Math.max(.1,t.life*Math.min(1,1.5*t.a)),t.size=Math.max(.5*this.particleConfig.size,this.particleConfig.size*(.3+.7*t.life))}prepareAndDrawParticles(t){const e=new Float32Array(2*this.particles.length),i=new Float32Array(4*this.particles.length),r=new Float32Array(this.particles.length);this.particles.forEach((o,s)=>{e[2*s]=o.x,e[2*s+1]=o.y,i[4*s]=o.r,i[4*s+1]=o.g,i[4*s+2]=o.b,i[4*s+3]=Math.max(.1,o.a),r[s]=Math.max(6,1.5*o.size)}),this.updateParticleBuffers(t,e,i,r),this.setParticleUniforms(t),t.drawArrays(t.POINTS,0,this.particles.length),this.cleanupTempBuffers(t)}updateParticleBuffers(t,e,i,r){this.positionBuffer||(this.positionBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW);const o=t.getAttribLocation(this.program,"a_position");t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),this.colorBuffer||(this.colorBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,i,t.DYNAMIC_DRAW);const s=t.getAttribLocation(this.program,"a_color");t.enableVertexAttribArray(s),t.vertexAttribPointer(s,4,t.FLOAT,!1,0,0);const a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW);const l=t.getAttribLocation(this.program,"a_size");t.enableVertexAttribArray(l),t.vertexAttribPointer(l,1,t.FLOAT,!1,0,0),this._tempSizeBuffer=a}setParticleUniforms(t){const e=t.getUniformLocation(this.program,"u_resolution"),i=t.getUniformLocation(this.program,"u_time"),r=t.getUniformLocation(this.program,"u_forceStrength"),o=t.getUniformLocation(this.program,"u_effectType");t.uniform2f(e,this.webglCanvas.width,this.webglCanvas.height),t.uniform1f(i,this.getAnimationTime()),t.uniform1f(r,this.particleConfig.strength),t.uniform1i(o,{explode:0,vortex:1,gravity:2}[this.particleConfig.effectType]||0)}cleanupTempBuffers(t){const e=this._tempSizeBuffer;e&&(t.deleteBuffer(e),delete this._tempSizeBuffer)}applyCanvas2DExplode(t,e,i){const r=e.width/2,o=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(r,o);const s=1+.5*i;t.scale(s,s),t.translate(-r,-o),t.drawImage(e,0,0),t.restore()}applyCanvas2DGravity(t,e,i){t.save(),t.globalAlpha=Math.max(0,1-i);const r=i*e.height*.3;t.drawImage(e,0,r),t.restore()}applyCanvas2DVortex(t,e,i){const r=e.width/2,o=e.height/2;t.save(),t.globalAlpha=Math.max(0,1-i),t.translate(r,o),t.rotate(i*Math.PI*2),t.translate(-r,-o),t.drawImage(e,0,0),t.restore()}}class kDt extends TDt{constructor(t,e,i,r,o){var s,a;super(t,e,i,r,o),this.glitchConfig={effectType:((s=o?.options)===null||s===void 0?void 0:s.effectType)||"rgb-shift",intensity:((a=o?.options)===null||a===void 0?void 0:a.intensity)!==void 0?o.options.intensity:.5}}applyCanvas2DEffect(t){if(this.glitchConfig.intensity<=0){const e=this.createOutputCanvas(t);return e?e.canvas:null}try{switch(this.glitchConfig.effectType){case"rgb-shift":default:return this.applyRGBShiftGlitch(t);case"digital-distortion":return this.applyDigitalDistortionGlitch(t);case"scan-lines":return this.applyScanLineGlitch(t);case"data-corruption":return this.applyDataCorruptionGlitch(t)}}catch{return null}}applyRGBShiftGlitch(t){const e=this.createOutputCanvas(t);if(!e)return null;const{ctx:i}=e;try{i.clearRect(0,0,t.width,t.height);const r=ni.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),o=Math.floor(20*r),s=this.generateRandomOffset(o),a=this.generateRandomOffset(o,.3),l=this.generateRandomOffset(-o),h=ni.createTempCanvas(t.width,t.height),u=h.getContext("2d");u.drawImage(t,0,0);const d=u.getImageData(0,0,t.width,t.height),c=ni.extractChannel(d,0),f=ni.extractChannel(d,1),g=ni.extractChannel(d,2);return i.globalCompositeOperation="screen",u.clearRect(0,0,t.width,t.height),u.putImageData(c,0,0),i.drawImage(h,s.x,s.y),u.clearRect(0,0,t.width,t.height),u.putImageData(f,0,0),i.drawImage(h,a.x,a.y),u.clearRect(0,0,t.width,t.height),u.putImageData(g,0,0),i.drawImage(h,l.x,l.y),i.globalCompositeOperation="source-over",e.canvas}catch{return null}}applyDigitalDistortionGlitch(t){const e=this.createOutputCanvas(t);if(!e)return null;const{ctx:i}=e;try{const r=i.getImageData(0,0,t.width,t.height),o=ni.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),s=this.processDigitalDistortion(r,o);return i.clearRect(0,0,t.width,t.height),i.putImageData(s,0,0),e.canvas}catch{return null}}applyScanLineGlitch(t){const e=this.createOutputCanvas(t);if(!e)return null;const{ctx:i}=e;try{const r=ni.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),o=Math.max(2,Math.floor(10-8*r));i.globalCompositeOperation="multiply";for(let a=0;a<t.height;a+=o)if(Math.random()<r){const l=.1+.4*r;i.fillStyle=`rgba(0, 0, 0, ${l})`,i.fillRect(0,a,t.width,1)}i.globalCompositeOperation="screen";const s=Math.floor(20*r);for(let a=0;a<s;a++){const l=Math.random()*t.height,h=.3*r;i.fillStyle=`rgba(255, 255, 255, ${h})`,i.fillRect(0,Math.floor(l),t.width,1)}return i.globalCompositeOperation="source-over",e.canvas}catch{return null}}applyDataCorruptionGlitch(t){const e=this.createOutputCanvas(t);if(!e)return null;const{ctx:i}=e;try{const r=i.getImageData(0,0,t.width,t.height),o=ni.calculateDynamicStrength(this.glitchConfig.intensity,this.getAnimationTime()),s=this.processDataCorruption(r,o);return i.clearRect(0,0,t.width,t.height),i.putImageData(s,0,0),e.canvas}catch{return null}}generateRandomOffset(t,e=1){return{x:(Math.random()-.5)*t,y:(Math.random()-.5)*t*e}}processDigitalDistortion(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i),a=Math.floor(20*e)+5,l=Math.floor(o/a);for(let u=0;u<a;u++)if(Math.random()<e){const d=u*l,c=Math.min(d+l,o),f=Math.floor((Math.random()-.5)*r*e*.1);this.shiftSliceHorizontal(s,r,o,d,c,f)}const h=.3*e;for(let u=0;u<i.length;u+=4)Math.random()<h&&(s[u]=255*Math.random(),s[u+1]=255*Math.random(),s[u+2]=255*Math.random());return new ImageData(s,r,o)}shiftSliceHorizontal(t,e,i,r,o,s){const a=new Uint8ClampedArray(4*e);for(let l=r;l<o;l++){const h=l*e*4;for(let u=0;u<4*e;u++)a[u]=t[h+u];for(let u=0;u<e;u++){const d=h+4*u,c=4*((u-s+e)%e);t[d]=a[c],t[d+1]=a[c+1],t[d+2]=a[c+2],t[d+3]=a[c+3]}}}processDataCorruption(t,e){const{data:i,width:r,height:o}=t,s=new Uint8ClampedArray(i),a=Math.floor(15*e)+5;for(let h=0;h<a;h++)if(Math.random()<e){const u=Math.floor(Math.random()*r),d=Math.floor(5*Math.random())+1,c=Math.random()<.5?0:255;for(let f=0;f<o;f++)for(let g=0;g<d&&u+g<r;g++){const p=4*(f*r+u+g);s[p]=c,s[p+1]=c,s[p+2]=c}}const l=Math.floor(20*e);for(let h=0;h<l;h++){const u=Math.floor(Math.random()*r),d=Math.floor(Math.random()*o),c=Math.floor(20*Math.random())+5,f=Math.floor(10*Math.random())+2;this.corruptBlock(s,r,o,u,d,c,f)}return new ImageData(s,r,o)}corruptBlock(t,e,i,r,o,s,a){for(let l=0;l<a&&o+l<i;l++)for(let h=0;h<s&&r+h<e;h++){const u=4*((o+l)*e+(r+h));Math.random()<.7&&(t[u]=255*Math.random(),t[u+1]=255*Math.random(),t[u+2]=255*Math.random())}}}class EDt extends Zq{constructor(t,e,i,r,o){var s,a;super(t,e,i,r,o),this.blurConfig={blurRadius:((s=o?.options)===null||s===void 0?void 0:s.blurRadius)||8,useOptimizedBlur:((a=o?.options)===null||a===void 0?void 0:a.useOptimizedBlur)===void 0||o.options.useOptimizedBlur}}applyCSSBlur(t,e){const i=Dt.createCanvas({width:t.width,height:t.height,dpr:Dt.devicePixelRatio}),r=i.getContext("2d");return r?(r.filter=`blur(${e}px)`,r.drawImage(t,0,0),r.filter="none",i):t}applyDownsampleBlur(t,e){const{width:i,height:r}=t,o=Math.max(1,Math.floor(e/2)),s=Math.floor(i/o),a=Math.floor(r/o),l=Dt.createCanvas({width:s,height:a,dpr:1}),h=l.getContext("2d");if(!h)return t;const u=Dt.createCanvas({width:i,height:r,dpr:1}),d=u.getContext("2d");return d?(d.putImageData(t,0,0),h.drawImage(u,0,0,s,a),h.filter=`blur(${e/o}px)`,h.drawImage(l,0,0),h.filter="none",d.clearRect(0,0,i,r),d.drawImage(l,0,0,i,r),d.getImageData(0,0,i,r)):t}afterStageRender(t,e){if(this.blurConfig.blurRadius<=0)return e;let i;if(this.blurConfig.useOptimizedBlur)i=this.applyCSSBlur(e,this.blurConfig.blurRadius);else{const o=Dt.createCanvas({width:e.width,height:e.height,dpr:Dt.devicePixelRatio}),s=o.getContext("2d");if(!s)return!1;s.clearRect(0,0,e.width,e.height),s.drawImage(e,0,0);const a=s.getImageData(0,0,e.width,e.height),l=this.applyDownsampleBlur(a,this.blurConfig.blurRadius);s.putImageData(l,0,0),i=o}const r=i.getContext("2d");return r&&(r.globalCompositeOperation="overlay",r.fillStyle="rgba(255, 255, 255, 0.1)",r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="source-over"),i}}class LDt extends ky{constructor(t,e,i,r,o){var s,a;super(t,e,i,r,o),this.pixelationConfig={maxPixelSize:((s=o?.options)===null||s===void 0?void 0:s.maxPixelSize)||20,method:((a=o?.options)===null||a===void 0?void 0:a.method)||"out"}}applyDownsamplePixelation(t,e){if(e<=1)return t;const{width:i,height:r}=t,o=Math.ceil(i/e),s=Math.ceil(r/e),a=Dt.createCanvas({width:o,height:s,dpr:1}),l=a.getContext("2d");if(!l)return t;const h=Dt.createCanvas({width:i,height:r,dpr:Dt.devicePixelRatio}),u=h.getContext("2d");return u?(l.imageSmoothingEnabled=!1,u.imageSmoothingEnabled=!1,l.drawImage(t,0,0,o,s),u.drawImage(a,0,0,i,r),h):t}updateAnimationProgress(){return this.pixelationConfig.method==="in"?this.pixelationConfig.maxPixelSize-this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1):1+this.currentAnimationRatio*(this.pixelationConfig.maxPixelSize-1)}afterStageRender(t,e){const i=this.updateAnimationProgress();return i<=1?e:this.applyDownsamplePixelation(e,i)}}const ODt=()=>{xt.registerBuiltInAnimate("increaseCount",rOt),xt.registerBuiltInAnimate("fromTo",SDt),xt.registerBuiltInAnimate("scaleIn",rDt),xt.registerBuiltInAnimate("scaleOut",oDt),xt.registerBuiltInAnimate("growHeightIn",xOt),xt.registerBuiltInAnimate("growHeightOut",TOt),xt.registerBuiltInAnimate("growWidthIn",YOt),xt.registerBuiltInAnimate("growWidthOut",KOt),xt.registerBuiltInAnimate("growCenterIn",yOt),xt.registerBuiltInAnimate("growCenterOut",bOt),xt.registerBuiltInAnimate("clipIn",oOt),xt.registerBuiltInAnimate("clipOut",sOt),xt.registerBuiltInAnimate("fadeIn",aOt),xt.registerBuiltInAnimate("fadeOut",lOt),xt.registerBuiltInAnimate("growPointsIn",ROt),xt.registerBuiltInAnimate("growPointsOut",BOt),xt.registerBuiltInAnimate("growPointsXIn",kOt),xt.registerBuiltInAnimate("growPointsXOut",EOt),xt.registerBuiltInAnimate("growPointsYIn",OOt),xt.registerBuiltInAnimate("growPointsYOut",DOt),xt.registerBuiltInAnimate("growAngleIn",gOt),xt.registerBuiltInAnimate("growAngleOut",pOt),xt.registerBuiltInAnimate("growRadiusIn",WOt),xt.registerBuiltInAnimate("growRadiusOut",VOt),xt.registerBuiltInAnimate("moveIn",mDt),xt.registerBuiltInAnimate("moveOut",yDt),xt.registerBuiltInAnimate("rotateIn",CDt),xt.registerBuiltInAnimate("rotateOut",wDt),xt.registerBuiltInAnimate("update",gDt),xt.registerBuiltInAnimate("state",sDt),xt.registerBuiltInAnimate("labelItemAppear",qOt),xt.registerBuiltInAnimate("labelItemDisappear",ZOt),xt.registerBuiltInAnimate("poptipAppear",JOt),xt.registerBuiltInAnimate("poptipDisappear",QOt),xt.registerBuiltInAnimate("inputText",Wm),xt.registerBuiltInAnimate("inputRichText",tDt),xt.registerBuiltInAnimate("outputRichText",eDt),xt.registerBuiltInAnimate("slideRichText",iDt),xt.registerBuiltInAnimate("slideOutRichText",nDt),xt.registerBuiltInAnimate("slideIn",cD),xt.registerBuiltInAnimate("growIn",oZ),xt.registerBuiltInAnimate("spinIn",sZ),xt.registerBuiltInAnimate("moveScaleIn",hDt),xt.registerBuiltInAnimate("moveRotateIn",uDt),xt.registerBuiltInAnimate("strokeIn",aDt),xt.registerBuiltInAnimate("slideOut",fD),xt.registerBuiltInAnimate("growOut",aZ),xt.registerBuiltInAnimate("spinOut",lZ),xt.registerBuiltInAnimate("moveScaleOut",dDt),xt.registerBuiltInAnimate("moveRotateOut",cDt),xt.registerBuiltInAnimate("strokeOut",lDt),xt.registerBuiltInAnimate("pulse",fDt),xt.registerBuiltInAnimate("MotionPath",xDt),xt.registerBuiltInAnimate("streamLight",ADt),xt.registerBuiltInAnimate("dissolve",MDt),xt.registerBuiltInAnimate("grayscale",RDt),xt.registerBuiltInAnimate("distortion",BDt),xt.registerBuiltInAnimate("particle",PDt),xt.registerBuiltInAnimate("glitch",kDt),xt.registerBuiltInAnimate("gaussianBlur",EDt),xt.registerBuiltInAnimate("pixelation",LDt)};class DDt extends Tp{onBind(){var t;const e=Mp(this.target);this._animator=e;const i=this.duration,r=this.easing,{config:o,lastScale:s,getTickCoord:a}=this.params;let l=1;const h=this.target.data;if(s&&a&&h){l=.7;const u=a(s.scale(h.rawValue)),d=this.target.attribute.x,c=this.target.attribute.y;this.target.setAttributes({x:u.x,y:u.y}),e.animate(this.target,{type:"to",to:{x:d,y:c},duration:i,easing:r})}e.animate(this.target,{type:(t=o.type)!==null&&t!==void 0?t:"fadeIn",to:o.to,duration:i*l,easing:r}),this.completeBind(e)}}class IDt extends Tp{onBind(){const t=Mp(this.target);this._animator=t;const e=this.duration,i=this.easing,{config:r,diffAttrs:o}=this.params;t.animate(this.target,{type:"to",to:Object.assign({},o),duration:e,easing:i,customParameters:{diffAttrs:Object.assign({},o)}}),this.completeBind(t)}deleteSelfAttr(t){super.deleteSelfAttr(t),this._animator.deleteSelfAttr(t)}tryPreventConflict(){}}function HDt(){xt.registerBuiltInAnimate("axisEnter",DDt),xt.registerBuiltInAnimate("axisUpdate",IDt)}function FDt(){eo(),oD(),yA(),Qa(),HDt()}function zDt(){FDt(),Ql()}var d6=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};zDt();class Vm extends PLt{constructor(t,e){super(e?.skipDefault?t:Wt({},Vm.defaultAttributes,t),e)}_renderInner(t){var e;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){const r=[];for(let o=0;o<this.attribute.breaks.length;o++){const s=this.attribute.breaks[o],{range:a,breakSymbol:l,rawRange:h}=s;r.push({startPoint:this.getTickCoord(a[0]),endPoint:this.getTickCoord(a[1]),range:a,breakSymbol:l,rawRange:h})}this._breaks=r}super._renderInner(t),this._breaks&&this._breaks.length&&this._breaks.forEach((r,o)=>{const{startPoint:s,endPoint:a,breakSymbol:l,rawRange:h}=r;if(l?.visible!==!1){const u=kt.group({zIndex:mLt});u.name=Yn.axisBreak,u.id=this._getNodeId(`${Yn.axisBreak}-${o}`),u.data=h;const d=wLt(l),c=kt.symbol(Object.assign({x:s.x,y:s.y},d));c.name=Yn.axisBreakSymbol;const f=kt.symbol(Object.assign({x:a.x,y:a.y},d));f.name=Yn.axisBreakSymbol,u.add(c),u.add(f),t.add(u)}});const{panel:i}=this.attribute;if(i&&i.visible){const r=this.axisContainer,o=r.AABBBounds,s=kt.rect(Object.assign({x:o.x1,y:o.y1,width:o.width(),height:o.height()},i.style));s.name=Yn.background,s.id=this._getNodeId("background"),s.states=Wt({},sf,(e=i.state)!==null&&e!==void 0?e:{}),r.insertBefore(s,r.firstChild)}}renderLine(t){const{start:e,end:i,line:r}=this.attribute,o=r,{startSymbol:s,endSymbol:a,style:l,state:h}=o,u=d6(o,["startSymbol","endSymbol","style","state"]),d=Object.assign({startSymbol:s,endSymbol:a,lineStyle:l},u);if(this._breaks&&this._breaks.length){const f=[];let g=e;this._breaks.forEach(p=>{const{startPoint:v,endPoint:m}=p;f.push([g,v]),g=m}),f.push([g,i]),d.points=f,d.multiSegment=!0}else d.points=[e,i];Qe(h)||(d.state={line:Wt({},sf,h),symbol:Wt({},sf,h)});const c=new _A(d);c.name=Yn.line,c.id=this._getNodeId("line"),t.add(c)}getTextAlign(t){let e="center";return Ed(t[0],0)?Ed(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTitleAttribute(){var t,e,i;const r=this.attribute.title,{position:o="middle",space:s=4,textStyle:a={},autoRotate:l=!0,shape:h,background:u,state:d={},maxWidth:c}=r,f=d6(r,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]);let g=.5;o==="start"?g=0:o==="end"&&(g=1);const{verticalFactor:p=1}=this.attribute,v=-1*p,m=this.getTickCoord(g),y=this.getRelativeVector();let b=0;if(!((t=this.attribute.label)===null||t===void 0)&&t.visible&&this.attribute.label.inside===!1){const E=+Mr(this.attribute,"label.space",4);b+=E;const P=Object.keys(this.axisLabelLayerSize).length;if(y[1]===0){const B=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(B)?b+=B+(P-1)*E:b=0}else if(y[0]===0)if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){const B=this.axisLabelLayerSize[0].labelPos,k=this.axisLabelsContainer.AABBBounds;b+=(v===1?k.x2>B?Math.min(k.x2-B,k.width()):0:k.x1<B?Math.min(B-k.x1,k.width()):0)+(P-1)*E}else b=0;else Object.keys(this.axisLabelLayerSize).forEach((B,k)=>{b+=this.axisLabelLayerSize[B].width+(k>0?E:0)})}let _=0;!((e=this.attribute.tick)===null||e===void 0)&&e.visible&&this.attribute.tick.inside===!1&&(_=this.attribute.tick.length||4),!((i=this.attribute.subTick)===null||i===void 0)&&i.visible&&this.attribute.subTick.inside===!1&&(_=Math.max(_,this.attribute.subTick.length||2));const w=_+b+s,C=this.getVerticalCoord(m,w,!1),x=this.getVerticalVector(w,!1,{x:0,y:0});let S,A,{angle:T}=f;if(S=o==="start"?"start":o==="end"?"end":"center",ee(T)&&l){T=rLt(y,[1,0],!0);const{verticalFactor:E=1}=this.attribute;A=-1*E===1?"bottom":"top"}else S=this.getTextAlign(x),A=this.getTextBaseline(x,!1);let M=c;if(ee(M)){const{verticalLimitSize:E,verticalMinSize:P,orient:B}=this.attribute,k=Math.min(E||1/0,P||1/0);if(Zi(k))if(B==="bottom"||B==="top")if(T!==Math.PI/2){const L=Math.abs(Math.cos(T??0));M=L<1e-6?1/0:this.attribute.end.x/L}else M=k-w;else if(T&&T!==0){const L=Math.abs(Math.sin(T));M=L<1e-6?1/0:this.attribute.end.y/L}else M=k-w}const R=Object.assign(Object.assign(Object.assign({},C),f),{maxWidth:M,textStyle:Object.assign({textAlign:S,textBaseline:A},a),state:{text:Wt({},sf,d.text),shape:Wt({},sf,d.shape),panel:Wt({},sf,d.background)}});return R.angle=T,h&&h.visible&&(R.shape=Object.assign({visible:!0},h.style),h.space&&(R.space=h.space)),u&&u.visible&&(R.panel=Object.assign({visible:!0},u.style)),R}getTextBaseline(t,e){let i="middle";const{verticalFactor:r=1}=this.attribute,o=(e?1:-1)*r;return Ed(t[1],0)?i=!Ed(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":o===1?"bottom":"top":t[1]>0?i="top":t[1]<0&&(i="bottom"),i}getLabelAlign(t,e,i){const r=this.attribute.orient;if(["top","bottom","right","left"].includes(r)||t[0]===0&&t[1]===0){if(r==="top"||r==="bottom")return Uq(e?r==="bottom"?"top":"bottom":r,i);if(r==="left"||r==="right")return Xq(e?r==="left"?"right":"left":r,i)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,i,r,o){var s,a,l,h;const{flush:u=!1}=this.attribute.label||{};if(u&&t.length){const{orient:d,start:c,end:f}=this.attribute,g=d==="bottom"||d==="top",p=t[0],v=Ef(t),m=g?p.attribute.x>v.attribute.x:p.attribute.y<v.attribute.y;if(g){const y=m?v:p,b=m?p:v,_=c.x,w=f.x,C=y.AABBBounds.x1,x=b.AABBBounds.x2;C<_&&(y.attribute.angle?y.setAttributes({dx:((s=y.attribute.dx)!==null&&s!==void 0?s:0)+_-C}):y.setAttributes({x:_,textAlign:"left"})),x>w&&(b.attribute.angle?b.setAttributes({dx:((a=b.attribute.dx)!==null&&a!==void 0?a:0)+w-x}):b.setAttributes({x:w,textAlign:"right"}))}else{const y=m?v:p,b=m?p:v,_=y.AABBBounds.y2,w=b.AABBBounds.y1,C=c.y,x=f.y;w<C&&(b.attribute.angle?b.setAttributes({dy:((l=b.attribute.dy)!==null&&l!==void 0?l:0)+C-w}):b.setAttributes({y:C,textBaseline:"top"})),_>x&&(y.attribute.angle?y.setAttributes({dy:((h=y.attribute.dy)!==null&&h!==void 0?h:0)+x-_}):y.setAttributes({y:x,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,i,r,o){if(Qe(t))return;const{verticalLimitSize:s,label:a,orient:l}=this.attribute,h=this._getAxisLabelLimitLength(s,o),{layoutFunc:u,autoRotate:d,autoRotateAngle:c,autoLimit:f,limitEllipsis:g,autoHide:p,autoHideMethod:v,autoHideSeparation:m,lastVisible:y,firstVisible:b,autoWrap:_,overflowLimitLength:w}=a;if(zi(u))u(t,e,r,this);else{if(d)OLt(t,{labelRotateAngle:c,orient:l});else if(_){const C=Math.abs(l==="left"||l==="right"?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x);WLt(t,{orient:l,limitLength:h,axisLength:C,ellipsis:g})}if(!_&&f&&Zi(h)&&h>0){const C=l==="left"||l==="right",x=Math.abs(C?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x),S=C?x/t.length:p||d?1/0:x/t.length;NLt(t,{limitLength:h,verticalLimitLength:S,ellipsis:g,orient:l,axisLength:x,overflowLimitLength:w})}p&&LLt(t,{method:v,separation:m,lastVisible:y,firstVisible:b})}}afterLabelsOverlap(t,e,i,r,o){const{verticalLimitSize:s,orient:a}=this.attribute,l=a==="bottom"||a==="top",h=i.AABBBounds;let u=l?h.height():h.width();const{verticalMinSize:d}=this.attribute;if(Zi(d)&&(!Zi(s)||d<=s)){const c=this._getAxisLabelLimitLength(d,o);let f,g;u=Math.max(u,c),a==="left"?(f=h.x2-u,g=h.y1):a==="right"?(f=h.x1,g=h.y1):a==="top"?(f=h.x1,g=h.y2-u):a==="bottom"&&(f=h.x1,g=h.y1);const p=kt.rect({x:f,y:g,width:l?h.width():u,height:l?u:h.height(),pickable:!1});p.name=Yn.axisLabelBackground,p.id=this._getNodeId("axis-label-background"),i.insertBefore(p,i.firstChild)}if(Tt(this.attribute.label.containerAlign)){let c;a==="left"?c=h.x2-u:a==="right"?c=h.x1:a==="top"?c=h.y2-u:a==="bottom"&&(c=h.y1),VLt(t,c,u,a,this.attribute.label.containerAlign)}}_getAxisLabelLimitLength(t,e){var i,r,o,s,a;const{label:l,title:h,line:u,tick:d}=this.attribute,c=(i=l.space)!==null&&i!==void 0?i:4;let f=t,g=0,p=0;const v=u&&u.visible?(r=u.style.lineWidth)!==null&&r!==void 0?r:1:0,m=d&&d.visible?(o=d.length)!==null&&o!==void 0?o:4:0;if(h&&h.visible&&typeof h.text=="string"){g=bA(h.text,h.textStyle,(a=(s=this.stage)===null||s===void 0?void 0:s.getTheme())===null||a===void 0?void 0:a.text).height;const y=$a(h.padding);p=h.space+y[0]+y[2]}return f&&(f=(f-c-p-g-v-m)/e),f}release(){super.release(),this._breaks=null}}Vm.defaultAttributes=Ik,qBt(Vm,GLt);const zl=n=>n.map((t,e)=>({index:e,value:t})),c6=(n,t,e=0)=>{const i=new Nm(n).expand(e/2),r=new Nm(t).expand(e/2);return i.intersects(r)},f6=12,C_=(n,t,e,i)=>e<n?Math.max(n-t/2,e):e>n?Math.min(n-t/2,e-t):e<i?e:e-t,zk=(n,t,e)=>{var i,r,o;const{labelStyle:s,axisOrientType:a,labelFlush:l,labelFormatter:h,startAngle:u=0}=e;let d=(i=s.angle)!==null&&i!==void 0?i:0;s.direction==="vertical"&&(d+=Ld(90));const c=["bottom","top"].includes(a),f=["left","right"].includes(a);let g=1,p=0;c||(f?(g=0,p=1):u&&(g=Math.cos(u),p=-Math.sin(u)));const v=Dq(s),m=n.range();let y=[];for(let b=0;b<t.length;b++){const _=t[b],w=h?h(_):`${_}`;if(A0(w)){y=void 0;break}const{width:C,height:x}=v.quickMeasure(w),S=Math.max(C,12),A=Math.max(x,12),T=n.scale(_),M=g*T,R=p*T;let E,P,B=M,k=R;l&&c&&b===0?B=C_(M,S,m[0],m[m.length-1]):l&&c&&b===t.length-1?B=C_(M,S,m[m.length-1],m[0]):E=(r=s.textAlign)!==null&&r!==void 0?r:"center",E==="right"?B-=S:E==="center"&&(B-=S/2),l&&f&&b===0?k=C_(R,A,m[0],m[m.length-1]):l&&f&&b===t.length-1?k=C_(R,A,m[m.length-1],m[0]):P=(o=s.textBaseline)!==null&&o!==void 0?o:"middle",P==="bottom"?k-=A:P==="middle"&&(k-=A/2);const L=new Nm().set(B,k,B+S,k+A);d&&L.rotate(d,M,R),y.push(L)}return y},NDt=n=>["bottom","top","z"].includes(n);var uo;(function(n){n.Identity="identity",n.Linear="linear",n.Log="log",n.Pow="pow",n.Sqrt="sqrt",n.Symlog="symlog",n.Time="time",n.Quantile="quantile",n.Quantize="quantize",n.Threshold="threshold",n.Ordinal="ordinal",n.Point="point",n.Band="band"})(uo||(uo={}));Object.values(uo).forEach(n=>{});function dZ(n){switch(n){case uo.Linear:case uo.Log:case uo.Pow:case uo.Sqrt:case uo.Symlog:case uo.Time:return!0;default:return!1}}function WDt(n){switch(n){case uo.Ordinal:case uo.Point:case uo.Band:return!0;default:return!1}}function Cv(n){return n}function Nk(n,t){if(n=Number(n),t=Number(t),t-=n)return i=>(i-n)/t;const e=Number.isNaN(t)?NaN:.5;return()=>e}function g6(n,t,e){const i=n[0],r=n[1],o=t[0],s=t[1];let a,l;return r<i?(a=Nk(r,i),l=e(s,o)):(a=Nk(i,r),l=e(o,s)),h=>l(a(h))}function VDt(n,t){const e=(n[1]-n[0])/(t[1]-t[0]),i=n[0]-e*t[0];return[i,e+i]}function GDt(n,t,e){const i=Math.min(n.length,t.length)-1,r=new Array(i),o=new Array(i);let s=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=Nk(n[s],n[s+1]),o[s]=e(t[s],t[s+1]);return function(a){const l=tPt(n,a,1,i)-1;return o[l](r[l](a))}}let $Dt=class{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:Tt(this._rangeFactorStart)&&Tt(this._rangeFactorEnd)&&t.length===2?(this._wholeRange=VDt(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(t.length===2&&t.every(r=>r>=0&&r<=1)&&(this._wholeRange=null,t[0]===0&&t[1]===1?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):Tt(this._rangeFactorStart)&&Tt(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return ee(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!ee(this._rangeFactorEnd)&&this._rangeFactorEnd!==1?(this._rangeFactorStart=t,this._rangeFactorEnd=(i=this._rangeFactorEnd)!==null&&i!==void 0?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}rangeFactorEnd(t,e){var i;return ee(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!ee(this._rangeFactorStart)&&this._rangeFactorStart!==0?(this._rangeFactorEnd=t,this._rangeFactorStart=(i=this._rangeFactorStart)!==null&&i!==void 0?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);const{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,o=this.range(),s=o[0],a=o[o.length-1],l=Math.min(s,a),h=Math.max(s,a),u=ho((t=this._fishEyeOptions.focus)!==null&&t!==void 0?t:0,l,h),d=ee(r)?(h-l)*i:r;let c=Math.exp(e);c=c/(c-1)*d;const f=e/d;this._fishEyeTransform=g=>{const p=Math.abs(g-u);if(p>=d)return g;if(p<=1e-6)return u;const v=c*(1-Math.exp(-p*f))/p*.75+.25;return u+(g-u)*v}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return(i=this==null?void 0:this[t])!==null&&i!==void 0?i:e}};const{interpolateRgb:VR}=CPt;function jDt(n,t){const e=typeof t;let i;if(ee(t)||e==="boolean")return()=>t;if(e==="number")return cC(n,t);if(e==="string"){if(i=gC.parseColorString(t)){const r=VR(gC.parseColorString(n),i);return o=>r(o).formatRgb()}return cC(Number(n),Number(t))}return t instanceof Br?VR(n,t):t instanceof gC?VR(n.color,t.color):t instanceof Date?sPt(n,t):cC(Number(n),Number(t))}let UDt=class extends $Dt{constructor(t=Cv,e=Cv){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=Cv,this._piecewise=g6,this._interpolate=jDt}calculateVisibleDomain(t){var e;return Tt(this._rangeFactorStart)&&Tt(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:(e=this._niceDomain)!==null&&e!==void 0?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),cC)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;const r=Array.from(t,QBt);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();const i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){const i=Array.from(t);return this._range=i,this._interpolate=oPt,this.rescale(e)}rescale(t){var e;if(t)return this;const i=(e=this._niceDomain)!==null&&e!==void 0?e:this._domain,r=i.length,o=this._range.length;let s=Math.min(r,o);if(r&&r<o&&this._forceAlign){const a=o-r+1,l=i[r-1],h=r>=2?(l-i[r-2])/a:0;for(let u=1;u<=a;u++)i[r-2+u]=l-h*(a-u);s=o}return this._autoClamp&&(this._clamp=rPt(i[0],i[s-1])),this._piecewise=s>2?GDt:g6,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:Cv),this.rescale(i)):this._clamp!==Cv}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){const e=this.ticks(t);return(e??[]).map((i,r)=>({index:r,tick:i,value:(this.scale(i)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return ee(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return ee(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}};const XDt=Math.sqrt(50),YDt=Math.sqrt(10),KDt=Math.sqrt(2),w_=[1,2,5,10],p6=(n,t,e)=>{let i=1,r=n;const o=Math.floor((t-1)/2),s=Math.abs(n);return n>=0&&n<=Number.MIN_VALUE?r=0:n<0&&n>=-Number.MIN_VALUE?r=-(t-1):!e&&s<1?i=cZ(s).step:(e||s>1)&&(r=Math.floor(n)-o*i),i>0?(n>0?r=Math.max(r,0):n<0&&(r=Math.min(r,-(t-1)*i)),ZBt(0,t).map(a=>r+a*i)):n>0?X1(0,-(t-1)/i,i):X1((t-1)/i,0,i)},qDt=dq((n,t,e,i)=>{let r,o,s,a,l=-1;if(e=+e,(n=+n)==(t=+t))return[n];if(Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return[n];if((r=t<n)&&(o=n,n=t,t=o),a=gD(n,t,e).step,!isFinite(a))return[];if(a>0){let h=Math.round(n/a),u=Math.round(t/a);for(h*a<n&&++h,u*a>t&&--u,s=new Array(o=u-h+1);++l<o;)s[l]=(h+l)*a}else if(a<0&&i?.noDecimals){a=1;const h=Math.ceil(n),u=Math.floor(t);if(!(h<=u))return[];for(s=new Array(o=u-h+1);++l<o;)s[l]=h+l}else{a=-a;let h=Math.round(n*a),u=Math.round(t*a);for(h/a<n&&++h,u/a>t&&--u,s=new Array(o=u-h+1);++l<o;)s[l]=(h+l)/a}return r&&s.reverse(),s}),X1=(n,t,e)=>{let i,r,o=-1;if(e>0){let s=Math.floor(n/e),a=Math.ceil(t/e);for((s+1)*e<n&&++s,(a-1)*e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)*e}else{e=-e;let s=Math.floor(n*e),a=Math.ceil(t*e);for((s+1)/e<n&&++s,(a-1)/e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)/e}return r},ZDt=(n,t,e)=>{let i;const r=n[0],o=n[n.length-1],s=t-n.length;if(o<=0){const h=[];for(i=s;i>=1;i--)h.push(r-i*e);return h.concat(n)}if(r>=0){for(i=1;i<=s;i++)n.push(o+i*e);return n}let a=[];const l=[];for(i=1;i<=s;i++)i%2==0?a=[r-Math.floor(i/2)*e].concat(a):l.push(o+Math.ceil(i/2)*e);return a.concat(n).concat(l)},JDt=dq((n,t,e,i)=>{let r,o,s;if(e=+e,(n=+n)==(t=+t)||Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return p6(n,e,i?.noDecimals);(r=t<n)&&(s=n,n=t,t=s);const a=gD(n,t,e);let l=a.step;if(!isFinite(l))return[];if(l>0){let h=1;const{power:u,gap:d}=a,c=d===10?2*10**u:1*10**u;for(;h<=5&&(o=X1(n,t,l),o.length>e+1)&&e>2;)l+=c,h+=1;e>2&&o.length<e-1&&(o=ZDt(o,e,l))}else i?.noDecimals&&l<0&&(l=1),o=X1(n,t,l);return r&&o.reverse(),o}),cZ=n=>{const t=Math.floor(Math.log(n)/Math.LN10),e=n/10**t;let i=w_[0];return e>=XDt?i=w_[3]:e>=YDt?i=w_[2]:e>=KDt&&(i=w_[1]),t>=0?{step:i*10**t,gap:i,power:t}:{step:-(10**-t)/i,gap:i,power:t}};function gD(n,t,e){const i=(t-n)/Math.max(0,e);return cZ(i)}function QDt(n,t,e){let i;if(e=+e,(n=+n)==(t=+t)&&e>0)return[n];if(e<=0||(i=tIt(n,t,e))===0||!isFinite(i))return[];const r=new Array(e);for(let o=0;o<e;o++)r[o]=n+o*i;return r}function tIt(n,t,e){return(t-n)/Math.max(1,e-1)}function eIt(n,t,e){let i,r,o=-1;if(e=+e,(r=(t=+t)<(n=+n))&&(i=n,n=t,t=i),!isFinite(e)||t-n<=e)return[n];const s=Math.floor((t-n)/e+1),a=new Array(s);for(;++o<s;)a[o]=n+o*e;return r&&a.reverse(),a}function GR(n,t=10){let e,i,r=0,o=n.length-1,s=n[r],a=n[o],l=10;for(a<s&&(i=s,s=a,a=i,i=r,r=o,o=i);l-- >0;){if(i=gD(s,a,t).step,i===e)return n[r]=s,n[o]=a,n;if(i>0)s=Math.floor(s/i)*i,a=Math.ceil(a/i)*i;else{if(!(i<0))break;s=Math.ceil(s*i)/i,a=Math.floor(a*i)/i}e=i}}function iIt(n,t){const e=jn(t.forceMin),i=jn(t.forceMax);let r=null;const o=[];let s=null;const a=e&&i?l=>l>=t.forceMin&&l<=t.forceMax:e?l=>l>=t.forceMin:i?l=>l<=t.forceMax:null;return e?o[0]=t.forceMin:jn(t.min)&&t.min<=Math.min(n[0],n[n.length-1])&&(o[0]=t.min),i?o[1]=t.forceMax:jn(t.max)&&t.max>=Math.max(n[0],n[n.length-1])&&(o[1]=t.max),jn(o[0])&&jn(o[1])?(s=n.slice(),s[0]=o[0],s[s.length-1]=o[1]):r=jn(o[0])||jn(o[1])?jn(o[0])?"max":"min":"all",{niceType:r,niceDomain:s,niceMinMax:o,domainValidator:a}}let nIt=class fZ extends UDt{constructor(){super(...arguments),this.type=uo.Linear}clone(){var t;const e=new fZ;return e.domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate),this._niceType&&(e._niceType=this._niceType,e._domainValidator=this._domainValidator,e._niceDomain=(t=this._niceDomain)===null||t===void 0?void 0:t.slice()),e}tickFormat(){return()=>{}}d3Ticks(t=10,e){const i=this.calculateVisibleDomain(this._range);return qDt(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(zi(e?.customTicks))return e.customTicks(this,t);if(Tt(this._rangeFactorStart)&&Tt(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&this._range.length===2||!this._niceType)return this.d3Ticks(t,e);const r=(i=this._niceDomain)!==null&&i!==void 0?i:this._domain,o=this._domain,s=r[0],a=r[r.length-1];let l=JDt(o[0],o[o.length-1],t,e);if(!l.length)return l;if(this._domainValidator)l=l.filter(this._domainValidator);else if((l[0]!==s||l[l.length-1]!==a)&&this._niceType){const h=r.slice();if(this._niceType==="all"?(h[0]=l[0],h[h.length-1]=l[l.length-1],this._niceDomain=h,this.rescale()):this._niceType==="min"&&l[0]!==s?(h[0]=l[0],this._niceDomain=h,this.rescale()):this._niceType==="max"&&l[l.length-1]!==a&&(h[h.length-1]=l[l.length-1],this._niceDomain=h,this.rescale()),this._niceType!=="all"){const u=Math.min(h[0],h[h.length-1]),d=Math.max(h[0],h[h.length-1]);l=l.filter(c=>c>=u&&c<=d)}}return l}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return QDt(e[0],e[e.length-1],t)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return eIt(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;const o=this._domain;let s=[];if(e){const a=iIt(o,e);if(s=a.niceMinMax,this._domainValidator=a.domainValidator,this._niceType=a.niceType,a.niceDomain)return this._niceDomain=a.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){const a=GR(o.slice(),t);this._niceType==="min"?a[a.length-1]=(i=s[1])!==null&&i!==void 0?i:a[a.length-1]:this._niceType==="max"&&(a[0]=(r=s[0])!==null&&r!==void 0?r:a[0]),this._niceDomain=a,this.rescale()}return this}niceMin(t=10){this._niceType="min";const e=this._domain[this._domain.length-1],i=GR(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";const e=this._domain[0],i=GR(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}};function $R(n,t,e,i){let r;const{breakData:o}=n;if(o&&o()){const{breakDomains:s}=o(),a=t.domain();r=[];for(let l=0;l<a.length-1;l++)i(e,[a[l],a[l+1]]).forEach(h=>{s.some(u=>h>=u[0]&&h<=u[1])||r.push(h)});t.domain(a)}else r=i(e);return r}function v6(n,t,e,i,r=!1){if(e&&!t.includes(n)){let o=t.length;if(o>1){r?t.push(n):t.unshift(n);for(let s=0;s<o;s++){const a=r?o-1-s:s;if(!i(t[a]))break;t.splice(a,1),s--,o--}}}}const rIt=(n,t)=>{var e,i,r,o;if(!dZ(n.type))return zl(n.domain());const s=n.range(),a=Math.abs(s[s.length-1]-s[0]);if(a<2)return zl([n.domain()[0]]);const{tickCount:l,forceTickCount:h,tickStep:u,noDecimals:d=!1,labelStyle:c,breakData:f}=t;let g;if(Tt(u))p=n.stepTicks(u),v=f&&f()?f().breakDomains:null,g=v&&v.length?p.filter(y=>v.every(b=>y<b[0]||y>b[1])):p;else if(Tt(h))g=$R(t,n,h,(y,b)=>b&&b.length?n.domain(b,!0).forceTicks(y):n.forceTicks(y));else if(t.tickMode==="d3"){const y=(e=zi(l)?l({axisLength:a,labelStyle:c}):l)!==null&&e!==void 0?e:5;g=$R(t,n,y,(b,_)=>_&&_.length?n.domain(_,!0).d3Ticks(b,{noDecimals:d}):n.d3Ticks(b,{noDecimals:d}))}else{const y=(i=zi(l)?l({axisLength:a,labelStyle:c}):l)!==null&&i!==void 0?i:5,b=zi(t.tickMode)?t.tickMode:void 0;g=$R(t,n,y,(_,w)=>w&&w.length?n.domain(w,!0).ticks(_,{noDecimals:d,customTicks:b}):n.ticks(_,{noDecimals:d,customTicks:b}))}var p,v;const m=n.domain();if(t.labelFirstVisible&&m[0]!==g[0]&&!g.includes(m[0])&&g.unshift(m[0]),t.labelLastVisible&&m[m.length-1]!==g[g.length-1]&&!g.includes(m[m.length-1])&&g.push(m[m.length-1]),t.sampling&&g.length>1&&(t.coordinateType==="cartesian"||t.coordinateType==="polar"&&t.axisOrientType==="radius")){const{labelGap:y=4,labelFlush:b}=t,_=6;let w;if(g.length*_>a){const C=[],x=Math.floor(g.length*_/a);g.forEach((S,A)=>{A%x!=0&&A!==g.length-1||C.push(S)}),w=(r=zk(n,C,t))===null||r===void 0?void 0:r.map((S,A)=>({AABBBounds:S,value:C[A]}))}else w=(o=zk(n,g,t))===null||o===void 0?void 0:o.map((C,x)=>({AABBBounds:C,value:g[x]}));if(w){const C=w[0],x=Ef(w),S=f&&f()?m6.greedy:m6.parity;for(;w.length>=3&&Hk(w,y);)w=S(w,y);const A=t.labelFirstVisible;let T=t.labelLastVisible;Ws(C,x,y)&&w.includes(x)&&w.length>1&&A&&T&&(w.splice(w.indexOf(x),1),T=!1),v6(C,w,A,R=>Ws(R,C,y)),v6(x,w,T,R=>Ws(R,x,y)||!(!A||R===C)&&Ws(R,C,y),!0);const M=w.map(R=>R.value);M.length<3&&b&&(M.length>1&&M.pop(),Ef(M)!==Ef(g)&&M.push(Ef(g))),g=M}}return zl(g)},m6={parity:function(n){return n.filter((t,e)=>e%2==0)},greedy:function(n,t){let e;return n.filter((i,r)=>(!r||!Ws(e,i,t))&&(e=i,!0))}},y6=(n,t,e,i)=>{const r=zk(n,t,e);return r&&r.map(o=>i?[o.x1,o.x2,o.width()]:[o.y1,o.y2,o.height()])},b6=(n,t,e=0)=>Math.max(n[0],t[0])-e/2<=Math.min(n[1],t[1])+e/2,_6=(n,t)=>n[1]<t[0]?t[0]-n[1]:t[1]<n[0]?n[0]-t[1]:0,oIt=(n,t)=>{var e;const i=n.domain();if(!i.length)return[];const{tickCount:r,forceTickCount:o,tickStep:s,labelGap:a=4,axisOrientType:l,labelStyle:h}=t,u=NDt(l),d=n.range(),c=n.calculateWholeRangeSize();if(c<2)return t.labelLastVisible?zl([i[i.length-1]]):zl([i[0]]);let f;if(Tt(s))f=n.stepTicks(s);else if(Tt(o))f=n.forceTicks(o);else if(Tt(r)){const g=zi(r)?r({axisLength:c,labelStyle:h}):r;f=n.ticks(g)}else if(t.sampling){const g=((e=t.labelStyle.fontSize)!==null&&e!==void 0?e:12)+2,p=tD(d),v=uq(d);if(i.length<=c/g){const m=y6(n,i,t,u);if(m){const y=Math.min(...m.map(w=>w[2])),b=(v-p)/i.length,_=sIt(i,m,a,t.labelLastVisible,Math.floor(y/b));f=n.stepTicks(_.step),t.labelLastVisible&&(_.delCount&&(f=f.slice(0,f.length-_.delCount)),f.push(i[i.length-1]))}}else{const m=[i[0],i[Math.floor(i.length/2)],i[i.length-1]],y=y6(n,m,t,u);if(y){let b=null;y.forEach(w=>{b?b[2]<w[2]&&(b=w):b=w});const _=v-p-a>0?Math.ceil(i.length*(a+b[2])/(v-p-a)):i.length-1;f=n.stepTicks(_),!t.labelLastVisible||f.length&&f[f.length-1]===i[i.length-1]||(f.length&&Math.abs(n.scale(f[f.length-1])-n.scale(i[i.length-1]))<b[2]&&(f=f.slice(0,-1)),f.push(i[i.length-1]))}}}return ee(f)&&(f=n.domain()),zl(f)},sIt=(n,t,e,i,r,o)=>{let s=0,a=0,l=-1,h=Number.MAX_VALUE;const u=f=>{let g=!0,p=0;do p+f<n.length&&b6(t[p],t[p+f],e)&&(g=!1),p+=f;while(g&&p<n.length);return g},d=ePt(r,n.length,f=>u(f)?1:-1);let c=d;do if(c>d&&!u(c))c++;else{if(!i){a=c;break}{const f=n.length-1;let g,p=0;g=n.length%c>0?n.length-n.length%c+c:n.length;do{if(g-=c,g!==f&&!b6(t[g],t[f],e))break;p++}while(g>0);if(g===f){a=c,s=p;break}{const v=Math.floor(n.length/c)-p+1;if(v<l)break;{l=v;const m=_6(t[g],t[f]),y=g-c>=0?_6(t[g-c],t[g]):m,b=Math.abs(m-y);if(b<h&&(h=b,a=c,s=p),m<=y)break}}}c++}while(c<=n.length);return{step:a,delCount:s}},aIt=(n,t,e)=>{var i;const{labelStyle:r,getRadius:o,labelOffset:s,labelFormatter:a,inside:l}=e,h=o?.(),u=(i=r.angle)!==null&&i!==void 0?i:0,d=Dq(r);return t.map(c=>{const f=a?a(c):`${c}`,{width:g,height:p}=d.quickMeasure(f),v=Math.max(g,f6),m=Math.max(p,f6),y=n.scale(c),b={x:0,y:0};let _=0,w=0;const C={align:r.textAlign,baseline:r.textBaseline},{x,y:S}=SLt(y,b,h,s,l);return C.align||(Ed(x,b.x)?C.baseline||(C.baseline=S>b.y?"top":"bottom"):x>b.x?C.align="left":x<b.x&&(C.align="right")),_=x+(C.align==="right"?-v:C.align==="left"?0:-v/2),w=S+(C.baseline==="bottom"?-m:C.baseline==="top"?0:-m/2),new Nm().set(_,w,_+v,w+m).rotate(u,_+v/2,w+m/2)})},lIt=(n,t)=>{const{tickCount:e,forceTickCount:i,tickStep:r,getRadius:o,labelOffset:s,labelGap:a=0,labelStyle:l}=t,h=o?.();if(!h)return zl(n.domain());let u;if(Tt(r))u=n.stepTicks(r);else if(Tt(i))u=n.forceTicks(i);else if(Tt(e)){const d=n.range(),c=Math.abs(d[d.length-1]-d[0]),f=zi(e)?e({axisLength:c,labelStyle:l}):e;u=n.ticks(f)}else if(t.sampling){const d=n.domain(),c=n.range(),f=aIt(n,d,t),g=tD(c),p=uq(c),v=Math.abs(p-g)*(h+s)/d.length,{step:m,delCount:y}=hIt(d,f,a,Math.floor(f.reduce((b,_)=>Math.min(b,_.width(),_.height()),Number.MAX_VALUE)/v));u=n.stepTicks(m),u=u.slice(0,u.length-y)}else u=n.domain();return zl(u)},hIt=(n,t,e,i)=>{let r=i;do{let s=!0;r++;let a=0;do a+r<n.length&&c6(t[a],t[a+r],e)&&(s=!1),a+=r;while(s&&a<n.length);if(s)break}while(r<=n.length);let o=0;if(n.length>2){let s=n.length-n.length%r;for(s>=n.length&&(s-=r);s>0&&c6(t[0],t[s]);)o++,s-=r}return{step:r,delCount:o}},uIt=(n,t)=>{if(dZ(n.type))return rIt(n,t);if(WDt(n.type)){if(t.coordinateType==="cartesian")return oIt(n,t);if(t.coordinateType==="polar"&&t.axisOrientType==="angle")return lIt(n,t)}return zl(n.domain())};function gZ(){eo(),Ap(),Qa()}const pZ={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};gZ();class Gm extends Ro{getCurrent(){return this._current}constructor(t,e){super(e?.skipDefault?t:Wt({},Gm.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=i=>{const r=i.target;r.hasState("disable")||r.addState("hover")},this._onUnHover=i=>{i.target.removeState("hover")},this._onClick=i=>{const r=i.target;if(r.name==="preHandler"){if(this._current===1)return;this._current-=1,this._current===1?r.addState("disable"):r.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:i})}if(r.name==="nextHandler"){if(this._current===this._total)return;this._current+=1,this._current===this._total?r.addState("disable"):r.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:i})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,i;this._reset();const{layout:r="horizontal",handler:o=pZ,total:s,defaultCurrent:a=1,textStyle:l,padding:h=0}=this.attribute;this._current=a;const u=$a(h),d=r==="horizontal",c=kt.group({x:0,y:0}),f=o.style||{},g=f.size||15,p=(t=o.space)!==null&&t!==void 0?t:8,v=o.state||{};let{preShape:m,nextShape:y}=o;m||(m=d?"triangleLeft":"triangleUp"),y||(y=d?"triangleRight":"triangleDown");const b=kt.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},f),{x:0,y:0,symbolType:m,size:g}));b.states=v,b.name="preHandler",this.preHandler=b,c.add(b);const{width:_,height:w}=bA(this._getPageText(s),Object.assign({textAlign:"center",textBaseline:"middle"},l),(i=(e=this.stage)===null||e===void 0?void 0:e.getTheme())===null||i===void 0?void 0:i.text),C=jn(g)?g:g[0],x=jn(g)?g:g[1],S=kt.text(Object.assign({x:d?C/2+p+_/2:0,y:d?0:x/2+p+w/2,text:this._getPageText(a),textAlign:"center",textBaseline:"middle",lineHeight:l?.fontSize},l));this.text=S,c.add(S);const A=kt.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},f),{x:d?C+2*p+_:0,y:d?0:x+2*p+w,symbolType:y,size:g}));A.name="nextHandler",A.states=v,this.nextHandler=A,c.add(A),this._total===1?(b.addState("disable"),A.addState("disable")):this._current===1?b.addState("disable"):this._current===s&&A.addState("disable");const T=c.AABBBounds,M=T.width(),R=T.height();c.translateTo(0-T.x1+u[3],0-T.y1+u[0]),this.add(c),this.attribute.width=M+u[1]+u[3],this.attribute.height=R+u[0]+u[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){const{pageFormatter:e}=this.attribute;return e?zi(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,this._current!==1&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}Gm.defaultAttributes={handler:pZ,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};const Y1=10,vZ=8,mZ=8,dIt=8,pC=16,vC=8,Ey=12,Wk=12;var Et;(function(n){n.selected="selected",n.unSelected="unSelected",n.selectedHover="selectedHover",n.unSelectedHover="unSelectedHover",n.focus="focus"})(Et||(Et={}));var Yo;(function(n){n.legendItemHover="legendItemHover",n.legendItemUnHover="legendItemUnHover",n.legendItemClick="legendItemClick",n.legendItemAttributeUpdate="legendItemAttributeUpdate"})(Yo||(Yo={}));var Gn;(function(n){n.innerView="innerView",n.title="legendTitle",n.item="legendItem",n.itemShape="legendItemShape",n.itemLabel="legendItemLabel",n.itemValue="legendItemValue",n.focus="legendItemFocus"})(Gn||(Gn={}));class pD extends Ro{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);const{interactive:t=!0,title:e,padding:i=0}=this.attribute;this._parsedPadding=$a(i);const r=kt.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:t,childrenPickable:t});r.name=Gn.innerView,this.add(r),this._innerView=r,e?.visible&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();const o=this._innerView.AABBBounds;this.attribute.width=o.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=o.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(t){const{text:e="",textStyle:i,padding:r=0,background:o,minWidth:s,maxWidth:a,shape:l}=t,h={x:0,y:0,text:e,textStyle:i,padding:$a(r),minWidth:s,maxWidth:a};l&&l.visible&&(h.shape=Object.assign({visible:!0},l.style),Tt(l.space)&&(h.space=l.space)),o&&o.visible&&(h.panel=Object.assign({visible:!0},o.style));const u=new ou(h);u.name=Gn.title,this._title=u,this._innerView.add(u)}_adjustLayout(){var t;if(this._title){const e=this._innerView.AABBBounds.width(),i=this._title.AABBBounds.width(),r=(t=this.attribute.title)===null||t===void 0?void 0:t.align;r==="center"?this._title.setAttribute("x",(e-i)/2):r==="end"&&this._title.setAttribute("x",e-i)}}}function vD(){eo(),Qa(),Ql(),Ap()}function mD(){eo(),Fq()}function cIt(){mD(),gZ(),kq()}function fIt(){mD(),vD()}function gIt(){mD(),vD(),YEt()}var C6=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const pIt={[Et.focus]:{},[Et.selected]:{},[Et.selectedHover]:{},[Et.unSelected]:{},[Et.unSelectedHover]:{}};cIt();class wA extends pD{constructor(t,e){super(e?.skipDefault?t:Wt({},wA.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=i=>{const r=i.target;if(r&&r.name&&r.name.startsWith(Gn.item)){const o=r.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===o.id)return;this._unHover(this._lastActiveItem,i)}this._hover(o,i)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,i),this._lastActiveItem=null)},this._onUnHover=i=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,i),this._lastActiveItem=null)},this._onClick=i=>{var r,o,s,a;const l=i.target;if(l&&l.name&&l.name.startsWith(Gn.item)){const h=l.delegate,{selectMode:u="multiple"}=this.attribute;if(l.name===Gn.focus||u==="focus"){const d=h.hasState(Et.focus);h.toggleState(Et.focus),d?(r=this._itemsContainer)===null||r===void 0||r.getChildren().forEach(c=>{this._removeLegendItemState(c,[Et.unSelected,Et.unSelectedHover,Et.focus],i),this._setLegendItemState(c,Et.selected,i)}):(this._setLegendItemState(h,Et.selected,i),this._removeLegendItemState(h,[Et.unSelected,Et.unSelectedHover],i),(o=this._itemsContainer)===null||o===void 0||o.getChildren().forEach(c=>{h!==c&&(this._removeLegendItemState(c,[Et.selected,Et.selectedHover,Et.focus],i),this._setLegendItemState(c,Et.unSelected,i))}))}else{(s=this._itemsContainer)===null||s===void 0||s.getChildren().forEach(g=>{g.removeState(Et.focus)});const{allowAllCanceled:d=!0}=this.attribute,c=h.hasState(Et.selected),f=this._getSelectedLegends();if(u==="multiple"){if(d===!1&&c&&f.length===1)return void this._dispatchLegendEvent(Yo.legendItemClick,h,i);c?(this._removeLegendItemState(h,[Et.selected,Et.selectedHover],i),this._setLegendItemState(h,Et.unSelected,i)):(this._setLegendItemState(h,Et.selected,i),this._removeLegendItemState(h,[Et.unSelected,Et.unSelectedHover],i))}else this._setLegendItemState(h,Et.selected,i),this._removeLegendItemState(h,[Et.unSelected,Et.unSelectedHover],i),(a=this._itemsContainer)===null||a===void 0||a.getChildren().forEach(g=>{h!==g&&(this._removeLegendItemState(g,[Et.selected,Et.selectedHover],i),this._setLegendItemState(g,Et.unSelected,i))})}this._dispatchLegendEvent(Yo.legendItemClick,h,i)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;((e=this._itemsContainer)===null||e===void 0?void 0:e.getChildren()).forEach(i=>{const r=i.data;t.includes(r.label)?(this._setLegendItemState(i,Et.selected),this._removeLegendItemState(i,[Et.unSelected,Et.unSelectedHover])):(this._removeLegendItemState(i,[Et.selected,Et.selectedHover]),this._setLegendItemState(i,Et.unSelected))})}_renderItems(){const{item:t={},maxCol:e=1,maxRow:i=2,maxWidth:r,defaultSelected:o,lazyload:s,autoPage:a}=this.attribute,{spaceCol:l=pC,spaceRow:h=vC,verticalAlign:u="middle"}=t,d=this._itemsContainer,{items:c,isHorizontal:f,startIndex:g,isScrollbar:p}=this._itemContext,v=p?1:f?i:e,m=this._contentMaxHeight;let y,{doWrap:b,maxWidthInCol:_,startX:w,startY:C,pages:x}=this._itemContext,S=0,A=0;const T=[];for(let M=g,R=c.length;M<R&&!(s&&x>this._itemContext.currentPage*v);M++){s&&(this._itemContext.startIndex=M+1),y=c[M],y.id||(y.id=y.label),y.index=M;let E=!0;Ge(o)&&(E=o.includes(y.label));const P=this._renderEachItem(y,E,M,c),B=P.attribute.width,k=P.attribute.height;this._itemHeight=Math.max(this._itemHeight,k),_=Math.max(B,_),this._itemMaxWidth=Math.max(B,this._itemMaxWidth),f?(Tt(r)&&(p&&a?(x=Math.ceil((w+B)/r),b=x>1):w+B>r&&(b=!0,w>0&&(u!=="middle"&&u!=="bottom"||T.forEach(L=>{L.setAttributes({y:L.attribute.y+(A-L.attribute.height)/(u==="middle"?2:1)})}),x+=1,w=0,C+=A+h,A=0,T.length=0))),w===0&&C===0||P.setAttributes({x:w,y:C}),w+=l+B,A=Math.max(A,k),T.push(P)):(Tt(m)&&(p&&a?(x=Math.ceil((C+k)/m),b=x>1):m<=k?(x+=1,b=!0,C=0,M>0&&(w+=S+l)):m<C+k&&(x+=1,b=!0,C=0,w+=_+l,_=0)),w===0&&C===0||P.setAttributes({x:w,y:C}),C+=h+k),d.add(P),S=B}return!f||u!=="middle"&&u!=="bottom"||T.forEach(M=>{M.setAttributes({y:M.attribute.y+(A-M.attribute.height)/(u==="middle"?2:1)})}),this._itemContext.doWrap=b,this._itemContext.startX=w,this._itemContext.startY=C,this._itemContext.maxWidthInCol=_,this._itemContext.pages=x,this._itemContext.maxPages=v,p&&(this._itemContext.totalPage=x),s||(this._itemContext.startIndex=c.length),this._itemContext}_renderContent(){const{item:t={},items:e,reversed:i,maxWidth:r,maxHeight:o}=this.attribute;if(t.visible===!1||Qe(e))return;let s=e;i&&(s=e?.reverse()),this._contentMaxHeight=Math.max(0,o-this._parsedPadding[0]-this._parsedPadding[2]);const a=kt.group({x:0,y:0});this._itemsContainer=a;const{layout:l,autoPage:h}=this.attribute,u=l==="horizontal",{maxWidth:d,width:c,height:f}=t,g=[];Tt(d)&&g.push(d),Tt(c)&&g.push(c),g.length&&(Tt(r)&&g.push(r),this._itemWidthByUser=tD(g)),Tt(f)&&(this._itemHeightByUser=f);const p=this.attribute.pager;this._itemContext={currentPage:p&&p.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:s,isHorizontal:u,totalPage:1/0,isScrollbar:p&&p.type==="scrollbar",clipContainer:void 0},this._itemContext=this._renderItems();let v=!1;this._itemContext.doWrap&&h&&this._itemContext.pages>this._itemContext.maxPages&&(v=this._renderPagerComponent()),v||(a.setAttribute("y",this._title?this._title.AABBBounds.height()+Mr(this.attribute,"title.space",8):0),this._innerView.add(a))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;const{hover:t=!0,select:e=!0}=this.attribute;if(t){let i="pointermove",r="pointerleave";Js(t)&&(t.trigger&&(i=t.trigger),t.triggerOff&&(r=t.triggerOff)),this._itemsContainer.addEventListener(i,this._onHover),this._itemsContainer.addEventListener(r,this._onUnHover)}if(e){let i="pointerdown";Js(e)&&e.trigger&&(i=e.trigger),this._itemsContainer.addEventListener(i,this._onClick)}}_autoEllipsis(t,e,i,r){var o,s;const{label:a,value:l}=this.attribute.item,h=r.AABBBounds,u=i.AABBBounds,d=h.width(),c=u.width();let f=!1;t==="labelFirst"?c>e?f=!0:r.setAttribute("maxLineWidth",e-c):t==="valueFirst"?d>e?f=!0:i.setAttribute("maxLineWidth",e-d):d+c>e&&(f=!0),f&&(r.setAttribute("maxLineWidth",Math.max(e*((o=a.widthRatio)!==null&&o!==void 0?o:.5),e-c)),i.setAttribute("maxLineWidth",Math.max(e*((s=l.widthRatio)!==null&&s!==void 0?s:.5),e-d)))}_renderEachItem(t,e,i,r){var o,s;const{id:a,label:l,value:h,shape:u}=t,{padding:d=0,focus:c,focusIconStyle:f,align:g,autoEllipsisStrategy:p}=this.attribute.item,{shape:v,label:m,value:y,background:b}=this.attribute.item,_=this._handleStyle(v,t,e,i,r),w=this._handleStyle(m,t,e,i,r),C=this._handleStyle(y,t,e,i,r),x=this._handleStyle(b,t,e,i,r),S=$a(d);let A;b.visible===!1?(A=kt.group({x:0,y:0,cursor:(o=x.style)===null||o===void 0?void 0:o.cursor}),this._appendDataToShape(A,Gn.item,t,A)):(A=kt.group(Object.assign({x:0,y:0},x.style)),this._appendDataToShape(A,Gn.item,t,A,x.state)),A.id=`${a??l}-${i}`,A.addState(e?Et.selected:Et.unSelected);const T=kt.group({x:0,y:0,pickable:!1});A.add(T);let M,R=0,E=0,P=0;if(v&&v.visible!==!1){const W=Mr(_,"style.size",Y1);E=Ge(W)?W[0]||0:W,P=Mr(v,"space",vZ);const K=kt.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},u),_.style));Object.keys(_.state||{}).forEach(J=>{const q=_.state[J].fill||_.state[J].stroke;u.fill&&ee(_.state[J].fill)&&q&&(_.state[J].fill=q),u.stroke&&ee(_.state[J].stroke)&&q&&(_.state[J].stroke=q)}),this._appendDataToShape(K,Gn.itemShape,t,A,_.state),K.addState(e?Et.selected:Et.unSelected),T.add(K)}let B=0;if(c){const W=Mr(f,"size",Y1);M=kt.symbol(Object.assign(Object.assign({x:0,y:-W/2-1,strokeBoundsBuffer:0,boundsPadding:S},f),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(M,Gn.focus,t,A),B=W}const k=m.formatMethod?m.formatMethod(l,t,i):l,L=Object.assign(Object.assign({x:E/2+P,y:0,textAlign:"start",textBaseline:"middle",lineHeight:(s=w.style)===null||s===void 0?void 0:s.fontSize},w.style),{text:k,_originText:m.formatMethod?l:void 0}),O=Dk(L);this._appendDataToShape(O,Gn.itemLabel,t,A,w.state),O.addState(e?Et.selected:Et.unSelected),T.add(O);const D=Mr(m,"space",mZ);if(Tt(h)){const W=Mr(y,"space",c?dIt:0),K=y.formatMethod?y.formatMethod(h,t,i):h,J=Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:C.style.fontSize},C.style),{text:K,_originText:y.formatMethod?h:void 0}),q=Dk(J);if(this._appendDataToShape(q,Gn.itemValue,t,A,C.state),q.addState(e?Et.selected:Et.unSelected),this._itemWidthByUser){const X=this._itemWidthByUser-S[1]-S[3]-E-P-D-B-W;this._autoEllipsis(p,X,O,q),y.alignRight?q.setAttributes({textAlign:"right",x:this._itemWidthByUser-E/2-S[1]-S[3]-B-W}):q.setAttribute("x",D+(O.AABBBounds.empty()?0:O.AABBBounds.x2))}else q.setAttribute("x",D+(O.AABBBounds.empty()?0:O.AABBBounds.x2));R=W+(q.AABBBounds.empty()?0:q.AABBBounds.x2),T.add(q)}else this._itemWidthByUser&&O.setAttribute("maxLineWidth",this._itemWidthByUser-S[1]-S[3]-E-P-B),R=D+(O.AABBBounds.empty()?0:O.AABBBounds.x2);M&&(M.setAttribute("x",R),T.add(M));const I=T.AABBBounds,H=I.width();if(g==="right"){const W=I.x2,K=I.x1;T.forEachChildren((J,q)=>{J.type!=="symbol"&&J.attribute.textAlign!=="right"||J===M?J.setAttribute("x",K+W-J.attribute.x-J.AABBBounds.width()):J.type!=="symbol"?J.setAttributes({x:K+W-J.attribute.x,textAlign:"left"}):J.setAttribute("x",K+W-J.attribute.x)})}const F=I.height(),G=Tt(this.attribute.item.width)?this.attribute.item.width:H+S[1]+S[3],j=this._itemHeightByUser||F+S[0]+S[2];return A.attribute.width=G,A.attribute.height=j,M&&M.setAttribute("visible",!1),T.translateTo(-I.x1+S[3],-I.y1+S[0]),A}_createPager(t){var e,i;const{disableTriggerEvent:r,maxRow:o}=this.attribute,s=a=>a<=99?99:a<=999?999:9999;return this._itemContext.isHorizontal?new Gm(Object.assign(Object.assign({layout:o===1?"horizontal":"vertical",total:s(this._itemContext.pages)},Wt({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:(e=this.attribute.pager)===null||e===void 0?void 0:e.defaultCurrent,disableTriggerEvent:r})):new Gm(Object.assign({layout:"horizontal",total:s(this._itemContext.pages),disableTriggerEvent:r,defaultCurrent:(i=this.attribute.pager)===null||i===void 0?void 0:i.defaultCurrent},t))}_createScrollbar(t,e){const{disableTriggerEvent:i}=this.attribute;return this._itemContext.isHorizontal?new Yl(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:i,range:[0,.5],height:t.visible===!1?0:12},t),{width:e})):new Yl(Object.assign(Object.assign({direction:"vertical",width:t.visible===!1?0:12,range:[0,.5]},t),{height:e,disableTriggerEvent:i}))}_updatePositionOfPager(t,e,i){const{pager:r}=this.attribute,{totalPage:o,isHorizontal:s}=this._itemContext,a=r&&r.position||"middle";if(this._pagerComponent.setTotal(o),s){let l;l=a==="start"?t:a==="end"?t+i-this._pagerComponent.AABBBounds.height()/2:t+i/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:l})}else{let l;l=a==="start"?0:a==="end"?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:l,y:i-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){const{isHorizontal:t,clipContainer:e}=this._itemContext,i=this._itemsContainer.AABBBounds,r=e.AABBBounds;let o,s;return t?(s=r.width(),o=s/i.width()):(s=r.height(),o=s/i.height()),o}_updatePositionOfScrollbar(t,e,i){const{isHorizontal:r,currentPage:o,totalPage:s}=this._itemContext,a=(o-1)/s;this._pagerComponent.setScrollRange([a,a+this._computeScrollbarDelta()]),r?this._pagerComponent.setAttributes({x:0,y:i+e}):this._pagerComponent.setAttributes({x:t,y:i})}_bindEventsOfPager(t,e){const i=this.attribute.pager||{},{animation:r=!0,animationDuration:o=450,animationEasing:s="quadIn"}=i,a=this._itemContext.isScrollbar?u=>{const{value:d}=u.detail;let c;return c=d[0]===0?1:d[1]===1?this._itemContext.totalPage:d[0]*this._itemContext.totalPage+1,c}:u=>u.detail.current,l=u=>{const d=this._pagerComponent,c=d.getScrollRange(),{direction:f}=d.attribute,{width:g,height:p}=d.getSliderRenderBounds(),v=f==="vertical"?u.deltaY/p:u.deltaX/g;d.setScrollRange([c[0]+v,c[1]+v],!0),this.updateScrollMask()},h=u=>{const d=a(u);if(d!==this._itemContext.currentPage){if(this._itemContext.currentPage=d,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();const c=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=c,this._itemContext.isScrollbar&&this._pagerComponent){const f=this._computeScrollbarDelta(),[g]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([g,g+f])}}if(this._itemContext.isScrollbar){const[c]=this._pagerComponent.getScrollRange();let f;f=this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height();const g=f*c;this.updateScrollMask(),r?this._itemsContainer.animate().to({[e]:-g},o,s):this._itemsContainer.setAttribute(e,-g)}else r?this._itemsContainer.animate().to({[e]:-(d-1)*t},o,s):this._itemsContainer.setAttribute(e,-(d-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",h),this._pagerComponent.addEventListener("scrollUp",h),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",d=>d.nativeEvent.preventDefault()),this.addEventListener("wheel",fq(l,50)))):(this._pagerComponent.addEventListener("toPrev",h),this._pagerComponent.addEventListener("toNext",h))}_renderPager(){const t=this._title?this._title.AABBBounds.height()+Mr(this.attribute,"title.space",8):0,{maxWidth:e,maxCol:i=1,maxRow:r=2,item:o={},pager:s={}}=this.attribute,{spaceCol:a=pC,spaceRow:l=vC}=o,h=this._itemsContainer,{space:u=Wk,defaultCurrent:d=1}=s,c=C6(s,["space","defaultCurrent"]),{isHorizontal:f}=this._itemContext,g=this._contentMaxHeight;let p,v=0,m=0,y=0,b=0,_=0,w=0,C=1;if(f){if(m=(r-1)*l+this._itemHeight*r,v=e,p=this._createPager(c),this._pagerComponent=p,this._innerView.add(p),y=e-p.AABBBounds.width()-u,y<=0)return this._innerView.removeChild(p),!1;h.getChildren().forEach((A,T)=>{const{width:M,height:R}=A.attribute;y<_+M&&(_=0,w+=R+l,C+=1),T>0&&A.setAttributes({x:_,y:w}),_+=a+M}),this._itemContext.startX=_,this._itemContext.startY=w,this._itemContext.pages=C;const S=Math.ceil(C/r);this._itemContext.totalPage=S,this._updatePositionOfPager(t,v,m)}else{if(v=this._itemMaxWidth*i+(i-1)*a,m=g,y=v,p=this._createPager(c),this._pagerComponent=p,this._innerView.add(p),b=g-p.AABBBounds.height()-u-t,b<=0)return this._innerView.removeChild(p),!1;h.getChildren().forEach((A,T)=>{const{height:M}=A.attribute;b<w+M&&(w=0,_+=this._itemMaxWidth+a,C+=1),T>0&&A.setAttributes({x:_,y:w}),w+=l+M});const S=Math.ceil(C/i);this._itemContext.totalPage=S,this._updatePositionOfPager(t,v,m)}d>1&&(f?h.setAttribute("y",-(d-1)*(m+l)):h.setAttribute("x",-(d-1)*(v+a)));const x=kt.group({x:0,y:t,width:f?y:v,height:f?m:b,clip:!0,pickable:!1});return x.add(h),this._innerView.add(x),this._itemContext.clipContainer=x,this._bindEventsOfPager(f?m+l:v+a,f?"y":"x"),!0}_renderScrollbar(){var t;const e=this._title?this._title.AABBBounds.height()+Mr(this.attribute,"title.space",8):0,{maxWidth:i,item:r={},pager:o={}}=this.attribute,{spaceCol:s=pC,spaceRow:a=vC}=r,l=this._itemsContainer,{space:h=Wk,defaultCurrent:u=1}=o,d=C6(o,["space","defaultCurrent"]),{isHorizontal:c}=this._itemContext,f=this._contentMaxHeight;let g,p=0,v=0,m=0,y=1;if(c)p=i,v=this._itemHeight,g=this._createScrollbar(d,p),this._pagerComponent=g,this._innerView.add(g);else{if(v=f-e,p=this._itemMaxWidth,g=this._createScrollbar(d,v),this._pagerComponent=g,this._innerView.add(g),v<=0)return this._innerView.removeChild(g),!1;const _=l.getChildren(),w=_.map(C=>C.attribute.height);if(w.length===1||w.every(C=>C===w[0])){const C=w[0],x=v,S=Math.floor(x/(a+C));v=S*(a+C),y=Math.ceil(_.length/S)}else _.forEach((C,x)=>{const{height:S}=C.attribute,A=y,T=m;y=Math.floor((m+S)/v)+1,m+=a+S,A!==y&&x===l.getChildren().length-1&&m-v>=1/3*S&&(v=T+S,y-=1)});this._itemContext.totalPage=y,this._itemContext.pages=y}if(u>1)if(c){const _=this._itemsContainer.AABBBounds.width()-p;l.setAttribute("x",-Math.min((u-1)*(p+s),_))}else{const _=this._itemsContainer.AABBBounds.height()-v;l.setAttribute("y",-Math.min((u-1)*(v+a),_))}const b=kt.group({x:0,y:e,width:p,height:v,clip:!0,pickable:!1});return b.add(l),this._innerView.add(b),this._itemContext.clipContainer=b,this._updatePositionOfScrollbar(p,v,e),!((t=o.scrollMask)===null||t===void 0)&&t.visible&&this.renderScrollMask(b),this._bindEventsOfPager(c?p:v,c?"x":"y"),!0}renderScrollMask(t){const{scrollMask:e={}}=this.attribute.pager,{visible:i=!0,gradientLength:r=16,gradientStops:o}=e;if(!i||!o)return;const s=t.AABBBounds.width(),a=t.AABBBounds.height(),l=this._itemContext.isHorizontal?s:a,h=o.map(c=>({offset:r*c.offset/l,color:c.color})),u=o.map(c=>({offset:(l-r*c.offset)/l,color:c.color})),d=kt.rect({x:0,y:0,width:s,height:a});this._scrollMask=d,this._scrollMaskContext={startStops:h,endStops:u},this.updateScrollMask(),t.add(d)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;const[t,e]=this._pagerComponent.getScrollRange(),i=[];Ed(ho(e,0,1),1)||i.push(...this._scrollMaskContext.endStops),Ed(ho(t,0,1),0)||i.push(...this._scrollMaskContext.startStops),i.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:i}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:i}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(Et.selected)?this._setLegendItemState(t,Et.selectedHover,e):this._setLegendItemState(t,Et.unSelectedHover,e);const i=t.getChildren()[0].find(r=>r.name===Gn.focus,!1);i&&i.setAttribute("visible",!0),this._dispatchLegendEvent(Yo.legendItemHover,t,e)}_unHover(t,e){let i=!1;(t.hasState(Et.unSelectedHover)||t.hasState(Et.selectedHover))&&(i=!0),t.removeState(Et.unSelectedHover),t.removeState(Et.selectedHover),t.getChildren()[0].getChildren().forEach(o=>{i||!o.hasState(Et.unSelectedHover)&&!o.hasState(Et.selectedHover)||(i=!0),o.removeState(Et.unSelectedHover),o.removeState(Et.selectedHover)});const r=t.getChildren()[0].find(o=>o.name===Gn.focus,!1);r&&r.setAttribute("visible",!1),i&&this._dispatchLegendEvent(Yo.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(Yo.legendItemUnHover,t,e)}_setLegendItemState(t,e,i){let r=!1;t.hasState(e)||(r=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(o=>{o.name!==Gn.focus&&(r||o.hasState(e)||(r=!0),o.addState(e,!0))}),r&&this._dispatchLegendEvent(Yo.legendItemAttributeUpdate,t,i)}_removeLegendItemState(t,e,i){let r=!1;e.forEach(o=>{!r&&t.hasState(o)&&(r=!0),t.removeState(o)}),t.getChildren()[0].getChildren().forEach(o=>{o.name!==Gn.focus&&e.forEach(s=>{!r&&o.hasState(s)&&(r=!0),o.removeState(s)})}),r&&this._dispatchLegendEvent(Yo.legendItemAttributeUpdate,t,i)}_getSelectedLegends(){var t;const e=[];return(t=this._itemsContainer)===null||t===void 0||t.getChildren().forEach(i=>{i.hasState(Et.selected)&&e.push(i.data)}),e}_appendDataToShape(t,e,i,r,o={}){t.name=e,t.data=i,t.delegate=r,t.states=Wt({},pIt,o)}_dispatchLegendEvent(t,e,i){const r=this._getSelectedLegends();r.sort((s,a)=>s.index-a.index);const o=r.map(s=>s.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(Et.selected),currentSelectedItems:r,currentSelected:o,event:i})}_handleStyle(t,e,i,r,o){const s={};return t.style&&(zi(t.style)?s.style=t.style(e,i,r,o):s.style=t.style),t.state&&(s.state={},Object.keys(t.state).forEach(a=>{t.state[a]&&(zi(t.state[a])?s.state[a]=t.state[a](e,i,r,o):s.state[a]=t.state[a])})),s}release(){super.release(),this.removeAllEventListeners()}}wA.defaultAttributes={layout:"horizontal",title:{align:"start",space:Ey,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:pC,spaceRow:vC,shape:{space:vZ,style:{size:Y1,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:mZ,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:Y1,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:Wk,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0};var Vn;(function(n){n.innerView="innerView",n.railContainer="sliderRailContainer",n.rail="sliderRail",n.startText="sliderStartText",n.endText="sliderEndText",n.startHandler="sliderStartHandler",n.startHandlerText="startHandlerText",n.endHandler="sliderEndHandler",n.endHandlerText="sliderEndHandlerText",n.track="sliderTrack",n.trackContainer="sliderTrackContainer"})(Vn||(Vn={}));function jR(n){return Ge(n)?n:[n,n]}function x_(n){return n?"ew-resize":"ns-resize"}vD();class Ly extends Ro{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super(e?.skipDefault?t:Wt({},Ly.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=i=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(i),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=i=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;const r=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),o=ho(this._isHorizontal?(i.viewX-this._rail.globalAABBBounds.x1)/r:(i.viewY-this._rail.globalAABBBounds.y1)/r,0,1);o!==this._tooltipState.pos&&(this._tooltipState.pos=o,this._tooltipState.value=this.calculateValueByPos(o*r),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{const{tooltip:i}=this.attribute;i&&i.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=i=>{this._clearAllDragEvents(),this._isChanging=!0;const{x:r,y:o}=this.stage.eventPointTransform(i);this._currentHandler=i.target,this._prePos=this._isHorizontal?r:o;const s=M0(),a=Dt.env==="browser"?Dt:this.stage;a.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),s.forEach(l=>{a.addEventListener(l,this._onHandlerPointerUp)})},this._onHandlerPointerMove=i=>{var r,o;this._isChanging=!0;const{railWidth:s,railHeight:a,min:l,max:h}=this.attribute;if(h===l)return;const{x:u,y:d}=this.stage.eventPointTransform(i);let c,f,g,p=0;this._isHorizontal?(c=u,p=c-this._prePos,f=(o=this._currentHandler)===null||o===void 0?void 0:o.attribute.x,g=s):(c=d,p=c-this._prePos,f=(r=this._currentHandler)===null||r===void 0?void 0:r.attribute.y,g=a);const v=ho(f+p,0,g),m=this.calculateValueByPos(v);this._currentHandler.type==="text"?this._updateHandlerText(this._currentHandler,v,m):this._updateHandler(this._currentHandler,v,m),this._updateTrack(),this._prePos=c,this._dispatchChangeEvent()},this._onHandlerPointerUp=i=>{this._isChanging=!1,this._currentHandler=null,this._clearAllDragEvents()},this._handleTouchMove=i=>{this._isChanging&&i.preventDefault()},this._onTrackPointerdown=i=>{this._clearAllDragEvents(),this._isChanging=!0;const{x:r,y:o}=this.stage.eventPointTransform(i);this._prePos=this._isHorizontal?r:o;const s=M0(),a=Dt.env==="browser"?Dt:this.stage;a.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),s.forEach(l=>{a.addEventListener(l,this._onTrackPointerUp)})},this._onTrackPointerMove=i=>{this._isChanging=!0;const{railWidth:r,railHeight:o,min:s,max:a,inverse:l}=this.attribute;if(a===s)return;const{startHandler:h,endHandler:u}=this._getHandlers();let d,c,f;const{x:g,y:p}=this.stage.eventPointTransform(i);this._isHorizontal?(d=g,c=this._track.attribute.width,f=r):(d=p,c=this._track.attribute.height,f=o);const v=d-this._prePos;if(h){const m=this._isHorizontal?h.attribute.x:h.attribute.y,y=l?ho(m+v,c,f):ho(m+v,0,f-c),b=this.calculateValueByPos(y);this._updateHandler(h,y,b)}if(u){const m=this._isHorizontal?u.attribute.x:u.attribute.y,y=l?ho(m+v,0,f-c):ho(m+v,c,f),b=this.calculateValueByPos(y),_=h?.attribute;this._updateHandler(u,y,b),this._track.setAttributes(this._isHorizontal?{x:Math.min(_.x,u.attribute.x),width:Math.abs(_.x-u.attribute.x)}:{y:Math.min(_.y,u.attribute.y),height:Math.abs(_.y-u.attribute.y)})}this._prePos=d,this._dispatchChangeEvent()},this._onTrackPointerUp=i=>{this._isChanging=!1,this._clearAllDragEvents()},this._onRailPointerDown=i=>{this._clearAllDragEvents(),this._isChanging=!0;const{railWidth:r,railHeight:o,min:s,max:a}=this.attribute;if(a===s)return;const l=this._startHandler,h=this._endHandler;let u,d,c;this._isHorizontal?(u=i.viewX-this._rail.globalAABBBounds.x1,d=l?.attribute.x,c=h?.attribute.x):(u=i.viewY-this._rail.globalAABBBounds.y1,d=l?.attribute.y,c=h?.attribute.y);const f=this.calculateValueByPos(u);if(Tt(c)){const g=Math.abs(u-d)>Math.abs(u-c)?h:l;this._updateHandler(g,u,f)}else this._updateHandler(l,u,f);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){const{layout:i,railWidth:r,railHeight:o,min:s,max:a,inverse:l}=this.attribute;let h=0;return h=s===a?e==="start"?0:e==="end"?1:0:(t-s)/(a-s),(l?1-h:h)*(i==="vertical"?o:r)}calculateValueByPos(t){const{layout:e,railWidth:i,railHeight:r,min:o,max:s,inverse:a}=this.attribute,l=e==="vertical"?r:i;return o+(s-o)*(a?1-t/l:t/l)}setValue(t){const{min:e,max:i}=this.attribute;if(i===e)return;const[r,o]=w1(t),{startHandler:s,endHandler:a}=this._getHandlers();s&&this._updateHandler(s,this.calculatePosByValue(r),r),a&&this._updateHandler(a,this.calculatePosByValue(o),o),this._updateTrack()}render(){var t,e;this.removeAllChild(!0);const{layout:i="horizontal",railWidth:r,railHeight:o,startText:s,endText:a,min:l,max:h,showHandler:u=!0,showTooltip:d}=this.attribute;let{value:c}=this.attribute;ee(c)&&(c=[l,h]),this._currentValue={startValue:jR(c)[0],endValue:jR(c)[1]};const f=i==="horizontal";this._isHorizontal=f;const g=kt.group({x:0,y:0});g.name=Vn.innerView,this.add(g),this._innerView=g;let p,v=0;if(s&&s.visible){p=kt.text(Object.assign({x:f?0:r/2,y:f?o/2:0,textAlign:f?"start":"center",textBaseline:f?"middle":"top",text:s.text,lineHeight:(t=s.style)===null||t===void 0?void 0:t.fontSize},s.style)),p.name=Vn.startText,g.add(p);const _=Tt(s.space)?s.space:0;v+=(f?p.AABBBounds.width():p.AABBBounds.height())+_}const m=kt.group({x:f?v:0,y:f?0:v});g.add(m);const y=kt.group({x:0,y:0});let b;if(y.name=Vn.railContainer,this._railContainer=y,m.add(y),this._mainContainer=m,this._renderRail(y),v+=f?r:o,a&&a.visible){const _=Tt(a.space)?a.space:0;b=kt.text(Object.assign({x:f?v+_:r/2,y:f?o/2:v+_,textAlign:f?"start":"center",textBaseline:f?"middle":"top",text:a.text,lineHeight:(e=a.style)===null||e===void 0?void 0:e.fontSize},a.style)),b.name=Vn.endText,g.add(b)}this._renderTrack(y),u&&(this._renderHandlers(m),this._bindEvents()),d&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){const{railWidth:e,railHeight:i,railStyle:r,slidable:o}=this.attribute;let s="default";o!==!1&&(s="pointer");const a=kt.rect(Object.assign({x:0,y:0,width:e,height:i,cursor:s},r));return a.name=Vn.rail,t.add(a),this._rail=a,a}_renderHandlers(t){const{range:e,min:i,max:r,handlerSize:o=14,handlerStyle:s,handlerText:a,railHeight:l,railWidth:h,slidable:u}=this.attribute;let{value:d}=this.attribute;ee(d)&&(d=[i,r]);const c=a&&a.visible,f=this._isHorizontal,[g,p]=jR(d),v=this.calculatePosByValue(g,e?"start":"end"),m=this._renderHandler(Object.assign({x:f?v:h/2,y:f?l/2:v,size:o,strokeBoundsBuffer:0,cursor:u===!1?"default":x_(f)},s));if(m.name=Vn.startHandler,this._startHandler=m,t.add(m),this._currentValue.startPos=v,c){const y=this._renderHandlerText(g,e?"start":"end");y.name=Vn.startHandlerText,t.add(y),this._startHandlerText=y}if(e){const y=this.calculatePosByValue(p,"end"),b=this._renderHandler(Object.assign({x:f?y:h/2,y:f?l/2:y,size:o,strokeBoundsBuffer:0,cursor:u===!1?"default":x_(f)},s));if(b.name=Vn.endHandler,this._endHandler=b,t.add(b),this._currentValue.endPos=y,c){const _=this._renderHandlerText(p,"end");_.name=Vn.endHandlerText,t.add(_),this._endHandlerText=_}}}_renderTrack(t){const{range:e,min:i,max:r,railHeight:o,railWidth:s,trackStyle:a,railStyle:l,slidable:h,value:u}=this.attribute;let d,c;if(ee(u))e?(d=i,c=r):d=c=i;else if(e){const _=td(u,i,r);d=_[0],c=_[1]}else d=i,c=ho(u,i,r);const f=this._isHorizontal;e||(d=i);const g=kt.group({x:0,y:0,width:s,height:o,cornerRadius:l?.cornerRadius,clip:!0,pickable:!1});g.name=Vn.trackContainer;const p=Js(e)&&e.draggableTrack===!0;let v;v=h===!1?"default":e===!1||p===!1?"pointer":x_(f);const m=this.calculatePosByValue(d,"start"),y=this.calculatePosByValue(c,e?"end":"start"),b=kt.rect(Object.assign({x:f?Math.min(m,y):0,y:f?0:Math.min(m,y),width:f?Math.abs(y-m):s,height:f?o:Math.abs(y-m),cursor:v},a));b.name=Vn.track,this._track=b,g.add(b),t.add(g)}_renderHandler(t){return kt.symbol(t)}_renderHandlerText(t,e){var i,r,o;const{align:s,handlerSize:a=14,handlerText:l={},railHeight:h,railWidth:u,slidable:d}=this.attribute,c=this._isHorizontal,f=this.calculatePosByValue(t,e),g=(i=l.space)!==null&&i!==void 0?i:4,p={text:l.formatter?l.formatter(t):t.toFixed((r=l.precision)!==null&&r!==void 0?r:0),lineHeight:(o=l.style)===null||o===void 0?void 0:o.lineHeight,cursor:d===!1?"default":x_(c)};return c?s==="top"?(p.textBaseline="bottom",p.textAlign="center",p.x=f,p.y=(h-a)/2-g):(p.textBaseline="top",p.textAlign="center",p.x=f,p.y=(h+a)/2+g):s==="left"?(p.textBaseline="middle",p.textAlign="end",p.x=(u-a)/2-g,p.y=f):(p.textBaseline="middle",p.textAlign="start",p.x=(u+a)/2+g,p.y=f),kt.text(Object.assign(Object.assign({},p),l.style))}_renderTooltip(){var t;const{tooltip:e,railHeight:i,railWidth:r,align:o}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;const s=this._isHorizontal?0:r/2,a=this._isHorizontal?i/2:0;if(e&&e.shape){const c=kt.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:s,y:a,symbolType:"circle"},e.shapeStyle));this._tooltipShape=c,this._mainContainer.add(c)}const l=e&&e.text||{},h=(t=l.space)!==null&&t!==void 0?t:6,u={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(u.x=s,u.y=o==="top"?a-i/2-h:a+i/2+h,u.textAlign="center",u.textBaseline=o==="top"?"bottom":"top"):(u.y=a,u.x=o==="left"?s-r/2-h:a+r/2+h,u.textAlign=o==="left"?"end":"start",u.textBaseline="middle");const d=kt.text(Object.assign(Object.assign({},u),l.style));this._mainContainer.add(d),this._tooltipText=d,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;const{railWidth:i,railHeight:r}=this.attribute,o=this._isHorizontal?i:r,s=this._tooltipState.pos*o,a=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[a]:s});const{align:l}=this.attribute;if(this._tooltipText){const h=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[a]:s,text:h.formatter?h.formatter(this._tooltipState.value):this._isHorizontal||l!=="left"?` ${this._tooltipState.value.toFixed((e=h.precision)!==null&&e!==void 0?e:0)}`:`${this._tooltipState.value.toFixed((t=h.precision)!==null&&t!==void 0?t:0)} `})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;const{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),Js(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown),(Dt.env==="browser"?Dt:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_clearAllDragEvents(){const t=M0(),e=Dt.env==="browser"?Dt:this.stage;e.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),t.forEach(i=>{e.removeEventListener(i,this._onHandlerPointerUp)}),e.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),t.forEach(i=>{e.removeEventListener(i,this._onTrackPointerUp)})}_updateTrack(){const{inverse:t,railWidth:e,railHeight:i}=this.attribute,r=this._startHandler,o=this._endHandler;if(this._isHorizontal){const s=r?.attribute.x;if(o){const a=o?.attribute.x;this._track.setAttributes({x:Math.min(s,a),width:Math.abs(s-a)})}else t?this._track.setAttributes({x:s,width:e-s}):this._track.setAttributes({width:s})}else{const s=r?.attribute.y;if(o){const a=o?.attribute.y;this._track.setAttributes({y:Math.min(s,a),height:Math.abs(s-a)})}else t?this._track.setAttributes({y:s,height:i-s}):this._track.setAttributes({height:s})}}_updateHandler(t,e,i){var r;const o=this._isHorizontal;t.setAttribute(o?"x":"y",e);const s=t.name===Vn.startHandler?this._startHandlerText:this._endHandlerText;if(s){const{handlerText:a={}}=this.attribute;s.setAttributes({text:a.formatter?a.formatter(i):i.toFixed((r=a.precision)!==null&&r!==void 0?r:0),[o?"x":"y"]:e})}t.name===Vn.startHandler?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_updateHandlerText(t,e,i){var r;const o=this._isHorizontal,{handlerText:s={}}=this.attribute;t.setAttributes({[o?"x":"y"]:e,text:s.formatter?s.formatter(i):i.toFixed((r=s.precision)!==null&&r!==void 0?r:0)});const a=t.name===Vn.startHandlerText?this._startHandler:this._endHandler;a&&a.setAttributes({[o?"x":"y"]:e}),t.name===Vn.startHandlerText?(this._currentValue.startValue=i,this._currentValue.startPos=e):(this._currentValue.endValue=i,this._currentValue.endPos=e)}_dispatchChangeEvent(){const t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){const{inverse:t}=this.attribute;let e=this._startHandler,i=this._endHandler;return i?(this._isHorizontal?(!t&&i.attribute.x<e?.attribute.x||t&&i.attribute.x>e?.attribute.x)&&([e,i]=[i,e]):(!t&&i.attribute.y<e?.attribute.y||t&&i.attribute.y>e?.attribute.y)&&([e,i]=[i,e]),{startHandler:e,endHandler:i}):{startHandler:e,endHandler:i}}release(t){super.release(t),(Dt.env==="browser"?Dt:this.stage).addEventListener("touchmove",this._handleTouchMove,{passive:!1}),this._clearAllDragEvents()}}Ly.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}};fIt();class xA extends pD{constructor(t,e){super(e?.skipDefault?t:Wt({},xA.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=i=>{const r=this._slider.tooltipShape;if(r&&i.detail&&!ee(i.detail.value)){const o=this._colorScale.scale(i.detail.value);r.setAttribute("fill",o)}this.dispatchEvent(i)},this._onSliderChange=i=>{this._updateColor(),this.dispatchEvent(i)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){const{colors:t,slidable:e,layout:i,align:r,min:o,max:s,value:a,railWidth:l,railHeight:h,showHandler:u=!0,handlerSize:d,handlerStyle:c,railStyle:f,trackStyle:g,startText:p,endText:v,handlerText:m,showTooltip:y,tooltip:b,inverse:_,disableTriggerEvent:w}=this.attribute,C=[],x=(s-o)/(t.length-1);for(let A=0;A<t.length;A++)C.push(o+x*A);this._colorScale=new nIt().domain(C,!0).range(t),this._color=this._getTrackColor();const S=new Ly({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:i,align:r,min:o,max:s,value:a,railWidth:l,railHeight:h,showHandler:u,handlerSize:d,handlerStyle:c,railStyle:f,trackStyle:Object.assign({fill:this._color},g),startText:p,endText:v,handlerText:m,showTooltip:y,tooltip:b,disableTriggerEvent:w,inverse:_});this._innerView.add(S),this._slider=S,S.translateTo(0-S.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+Mr(this.attribute,"title.space",Ey):0)-S.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){const{colors:t,layout:e,inverse:i}=this.attribute;if(Qe(t))return;const r=t.length;if(r===1)return t[0];const o=[];for(let l=0;l<r;l++){const h=l/(r-1);o.push({offset:h,color:t[l]})}const s=e==="horizontal",a={gradient:"linear",stops:o,x0:0,y0:0,x1:s?1:0,y1:s?0:1};return i&&(s?(a.x0=1,a.x1=0):(a.y0=1,a.y1=0)),a}_updateColor(){var t;const{layout:e="horizontal",colors:i,railWidth:r,railHeight:o}=this.attribute,{startHandler:s,endHandler:a,track:l,attribute:h}=this._slider,{startValue:u,endValue:d,startPos:c,endPos:f}=this._slider.currentValue,g=(t=h.handlerStyle)===null||t===void 0?void 0:t.fill;if(s&&!g){const v=this._colorScale.scale(u);s.setAttribute("fill",v)}if(a&&!g){const v=this._colorScale.scale(d);a.setAttribute("fill",v)}const p=e==="horizontal"?r:o;if(Math.abs(c-f)!==p&&i&&i.length>1){const v=this._color.stops,m=Math.min(c,f),y=Math.max(c,f),b=m/p,_=y/p,w=_-b,C=v.filter(R=>R.offset>b&&R.offset<_),x=Math.min(u,d),S=Math.max(u,d),A=this._colorScale.scale(x),T=this._colorScale.scale(S),M=[{offset:0,color:A}];C.forEach(R=>{M.push({offset:(R.offset-b)/w,color:R.color})}),M.push({offset:1,color:T}),l.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:M}))}}}xA.defaultAttributes={layout:"horizontal",title:{align:"start",space:Ey,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}};function vIt(n="bottom"){let t=0;return n==="top"?`
    M${t},-6L${t-3.5},-2.5
    v5
    h7
    v-5
    Z
`:n==="left"?(t=1,`
    M${t-6},0L${t-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):n==="right"?(t=-1,`
    M${t+6},0L${t+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${t},6L${t-3.5},2.5
    v-5
    h7
    v5
    Z
`}gIt();class SA extends pD{constructor(t,e){super(e?.skipDefault?t:Wt({},SA.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=i=>{this.dispatchEvent(i)},this._onSliderToolipChange=i=>{this.dispatchEvent(i)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){const{slidable:t,layout:e,align:i,min:r,max:o,value:s,railWidth:a,railHeight:l,showHandler:h=!0,handlerSize:u,handlerStyle:d,railStyle:c,trackStyle:f,startText:g,endText:p,handlerText:v,showTooltip:m,tooltip:y,sizeBackground:b,disableTriggerEvent:_,inverse:w}=this.attribute,C=kt.group({x:0,y:0});this._innerView.add(C);const x=new Ly({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:i,min:r,max:o,value:s,railWidth:a,railHeight:l,showHandler:h,handlerSize:u,handlerStyle:Object.assign({symbolType:vIt(i)},d),railStyle:c,trackStyle:f,startText:g,endText:p,handlerText:v,showTooltip:m,tooltip:y,disableTriggerEvent:_,inverse:w});C.add(x);let S,A=0;e==="horizontal"?i==="top"?(S=`M0,0L${a},0L${w?0:a},12Z`,A=l):(S=`M0,12L${a},12L${w?0:a},0Z`,x.setAttribute("y",12)):i==="left"?S=`M${a},0L${a+12},${w?0:l}L${a},${l}Z`:(S=`M0,${w?0:l}L12,${l}L12,0Z`,x.setAttribute("x",12));const T=kt.path(Object.assign(Object.assign({x:0,y:A,path:S},b),{zIndex:0}));C.add(T);const M=this._title?this._title.AABBBounds.height()+Mr(this.attribute,"title.space",Ey):0;C.translate(0-C.AABBBounds.x1,M-C.AABBBounds.y1),this._slider=x}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}SA.defaultAttributes={layout:"horizontal",title:{align:"start",space:Ey,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}};function mIt(){eo(),Qa(),yA()}mIt();let yZ=class bZ extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},bZ.defaultAttributes,t)),this.name="title"}render(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_;const{textType:w,text:C,subtextType:x,textStyle:S={},subtext:A,subtextStyle:T={},width:M,height:R,minWidth:E,maxWidth:P,minHeight:B,maxHeight:k,align:L,verticalAlign:O,padding:D=0}=this.attribute,I=$a(D),H=this.createOrUpdateChild("title-container",{x:I[3],y:I[0],zIndex:1},"group"),F=(t=S.height)!==null&&t!==void 0?t:R;if(this.attribute.visible!==!1&&S.visible!==!1){const{width:X,maxHeight:it,maxWidth:Z,x:et=0,y:nt=0,ellipsis:z=!0,wordBreak:V="break-word",maxWidth:$,lineClamp:U}=S;if(w==="rich"||Tt(S.character)){const Q=Object.assign({x:et,y:nt,width:(e=X??M)!==null&&e!==void 0?e:0,height:F??0,ellipsis:z==null||z,wordBreak:V??"break-word",maxHeight:it??k,maxWidth:Z??$,textConfig:(i=S.character)!==null&&i!==void 0?i:C},S);this._mainTitle=H.createOrUpdateChild("mainTitle",Q,"richtext")}else if(w==="html"){const Q=Object.assign({html:Object.assign(Object.assign({dom:C},Y4),S),x:et,y:nt,width:(r=X??M)!==null&&r!==void 0?r:0,height:F??0,ellipsis:z,wordBreak:V,maxHeight:it??k,maxWidth:Z??$,textConfig:[]},S);this._mainTitle=H.createOrUpdateChild("mainTitle",Q,"richtext")}else Tt(C)&&(this._mainTitle=H.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:Ge(C)?C:[C],whiteSpace:"normal"},S),{maxLineWidth:(s=(o=S.maxLineWidth)!==null&&o!==void 0?o:X)!==null&&s!==void 0?s:M,heightLimit:(a=S.height)!==null&&a!==void 0?a:k,lineClamp:U,ellipsis:z,x:et,y:nt}),"text"))}const G=this._mainTitle?this._mainTitle.AABBBounds.height():0,j=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(this.attribute.visible!==!1&&T.visible!==!1){const{width:X,height:it,maxWidth:Z,maxHeight:et,x:nt=0,y:z=0,ellipsis:V=!0,wordBreak:$="break-word",lineClamp:U}=T,Q=Math.max(Number.MIN_VALUE,k-G);if(x==="rich"||Tt(T.character)){const rt=Object.assign({x:nt,y:z,width:(l=X??M)!==null&&l!==void 0?l:0,height:(h=it??R)!==null&&h!==void 0?h:0,ellipsis:V,wordBreak:$,maxHeight:et??Q,maxWidth:Z??P,textConfig:(u=T.character)!==null&&u!==void 0?u:A},T);this._subTitle=H.createOrUpdateChild("subTitle",rt,"richtext")}else if(x==="html"){const rt=Object.assign({html:Object.assign(Object.assign({dom:A},Y4),T),x:nt,y:z,width:(d=X??M)!==null&&d!==void 0?d:0,height:(c=it??R)!==null&&c!==void 0?c:0,ellipsis:V,wordBreak:$,maxHeight:et??Q,maxWidth:Z??P,textConfig:[]},T);this._subTitle=H.createOrUpdateChild("subTitle",rt,"richtext")}else Tt(A)&&(this._subTitle=H.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:Ge(A)?A:[A],whiteSpace:"normal"},T),{maxLineWidth:(f=T.maxLineWidth)!==null&&f!==void 0?f:M,heightLimit:(g=T.heightLimit)!==null&&g!==void 0?g:Q,lineClamp:U,ellipsis:V,x:0,y:G}),"text"))}const W=this._subTitle?this._subTitle.AABBBounds.height():0,K=this._subTitle?this._subTitle.AABBBounds.width():0;let J=Math.max(j,K),q=G+((p=T.height)!==null&&p!==void 0?p:W);if(Tt(M)&&(J=M),Tt(R)&&(q=R),Tt(E)&&J<E&&(J=E),Tt(P)&&J>P&&(J=P),Tt(B)&&q<B&&(q=B),Tt(k)&&q>k&&(q=k),H.attribute.width=J,H.attribute.height=q,H.attribute.boundsPadding=I,this._mainTitle){if(Tt(L)||Tt(S.align)){const Z=S.align?S.align:L,et=(v=S.width)!==null&&v!==void 0?v:J;Z==="center"?(this._mainTitle.setAttribute("x",et/2),this._mainTitle.setAttribute("textAlign","center")):Z==="right"?(this._mainTitle.setAttribute("x",et),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}const X=S.verticalAlign?S.verticalAlign:O,it=F??(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height());X==="middle"?(this._mainTitle.setAttribute("y",it/2),this._mainTitle.setAttribute("textBaseline","middle")):X==="bottom"?(this._mainTitle.setAttribute("y",it),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}if(this._subTitle){if(Tt(L)||Tt(T.align)){const et=T.align?T.align:L,nt=(y=(m=T.width)!==null&&m!==void 0?m:S.width)!==null&&y!==void 0?y:J;et==="center"?(this._subTitle.setAttribute("x",nt/2),this._subTitle.setAttribute("textAlign","center")):et==="right"?(this._subTitle.setAttribute("x",nt),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}const X=T.verticalAlign?T.verticalAlign:O,it=this._mainTitle?Tt(F)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.empty()?0:this._mainTitle.AABBBounds.height(),F):this._mainTitle.AABBBounds.y2:0,Z=(_=(b=T.height)!==null&&b!==void 0?b:R)!==null&&_!==void 0?_:this._subTitle.AABBBounds.empty()?0:this._subTitle.AABBBounds.height();X==="middle"?(this._subTitle.setAttribute("y",it+Z/2),this._subTitle.setAttribute("textBaseline","middle")):X==="bottom"?(this._subTitle.setAttribute("y",it+Z),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",it),this._subTitle.setAttribute("textBaseline","top"))}}};yZ.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};function yIt(){eo(),Ql(),Qa(),mA()}const bIt='<svg width="200" height="200" viewBox="0 0 1024 1024" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M877.44815445 206.10060629a64.72691371 64.72691371 0 0 0-95.14856334 4.01306852L380.73381888 685.46812814 235.22771741 533.48933518a64.72691371 64.72691371 0 0 0-92.43003222-1.03563036l-45.82665557 45.82665443a64.72691371 64.72691371 0 0 0-0.90617629 90.61767965l239.61903446 250.10479331a64.72691371 64.72691371 0 0 0 71.19960405 15.14609778 64.33855261 64.33855261 0 0 0 35.08198741-21.23042702l36.24707186-42.71976334 40.5190474-40.77795556-3.36579926-3.49525333 411.40426297-486.74638962a64.72691371 64.72691371 0 0 0-3.88361443-87.64024149l-45.3088404-45.43829334z"></path></svg>',_It='<svg width="200" height="200" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="5" d="M5 12h14"/></svg>';yIt();class au extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},au.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?(this.setAttribute("checked",!1),this.setAttribute("indeterminate",!1)):(this.setAttribute("checked",!0),this.setAttribute("indeterminate",!1)),this._dispatchEvent("checkbox_state_change",{eventType:"checkbox_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(i,r,o)=>{"interactive"in i&&this.setAttribute("pickable",i.interactive),"disabled"in i&&this.setAttribute("cursor",i.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderIcon(),this.renderText(),this.layout()}renderBox(){this._box=new Py(Wt({},this.attribute.box));const t=this.attribute.checked||this.attribute.indeterminate;t&&this.attribute.disabled?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill,stroke:this.attribute.box.disableCheckedStroke}):t?this._box.setAttributes({fill:this.attribute.box.checkedFill,stroke:this.attribute.box.checkedStroke}):this.attribute.disabled&&this._box.setAttributes({fill:this.attribute.box.disableFill}),this.appendChild(this._box)}renderIcon(){this._checkIcon=new Ga(Wt({image:this.attribute.icon.checkIconImage},this.attribute.icon)),this.appendChild(this._checkIcon),this._indeterminateIcon=new Ga(Wt({image:this.attribute.icon.indeterminateIconImage},this.attribute.icon)),this.appendChild(this._indeterminateIcon),this.attribute.checked?(this._checkIcon.setAttribute("visible",!0),this._indeterminateIcon.setAttribute("visible",!1)):this.attribute.indeterminate?(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!0)):(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!1))}renderText(){this._text=new si(Wt({wrap:!0},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){const t=this.attribute.box.height,e=this.attribute.icon.height,i=this._text.AABBBounds.height(),r=Math.max(t,e,i),o=r/2-t/2,s=r/2-e/2,a=r/2-i/2,l=this.attribute.box.width,h=this.attribute.icon.width,u=Math.max(l,h),d=u/2-l/2,c=u/2-h/2,f=u+this.attribute.spaceBetweenTextAndIcon;this._box.setAttributes({x:d,y:o}),this._checkIcon.setAttributes({x:c,y:s}),this._indeterminateIcon.setAttributes({x:c,y:s}),this._text.setAttributes({x:f,y:a})}initAttributes(t,e){t=e?.skipDefault?t:Wt({},au.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}au.defaultAttributes={interactive:!0,disabled:!1,checked:!1,indeterminate:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},icon:{checkIconImage:bIt,indeterminateIconImage:_It,width:10,height:10,pickable:!1},box:{width:14,height:14,cornerRadius:2,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}};function CIt(){eo(),Ql(),ZEt(),mA()}CIt();class sp extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},sp.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||this.attribute.checked||(this.setAttribute("checked",!0),this._dispatchEvent("radio_checked",{eventType:"radio_checked",target:this}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(i,r,o)=>{"interactive"in i&&this.setAttribute("pickable",i.interactive),"disabled"in i&&this.setAttribute("cursor",i.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderCircle(),this.renderText(),this.layout()}renderCircle(){this._circle=new tp(Wt({},this.attribute.circle));const t=this.attribute.checked;t&&this.attribute.disabled?this._circle.setAttributes({fill:this.attribute.circle.disableCheckedFill,stroke:this.attribute.circle.disableCheckedStroke}):t?this._circle.setAttributes({fill:this.attribute.circle.checkedFill,stroke:this.attribute.circle.checkedStroke}):this.attribute.disabled&&this._circle.setAttributes({fill:this.attribute.circle.disableFill}),this.appendChild(this._circle)}renderText(){this._text=new si(Wt({},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){const t=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),e=this._text.AABBBounds.height(),i=Math.max(t,e),r=i/2-t/2+this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,o=i/2-e/2,s=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),a=this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,l=s+this.attribute.spaceBetweenTextAndIcon;this._circle.setAttributes({x:a,y:r}),this._text.setAttributes({x:l,y:o})}initAttributes(t,e){t=e?.skipDefault?t:Wt({},sp.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}sp.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},circle:{outerRadius:7,innerRadius:3,startAngle:0,endAngle:2*Math.PI,lineWidth:1,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}};function wIt(){eo(),Qa(),mA()}const xIt='<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>';wIt();let _Z=class CZ extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},CZ.defaultAttributes,t))}render(){this.removeAllChild(!0),this.renderIcon(),this.renderText(),this.layout()}renderIcon(){this._emptyTipIcon=new Ga(Wt({image:this.attribute.icon.image},this.attribute.icon)),this.appendChild(this._emptyTipIcon)}renderText(){this._text=new si(Wt({wrap:!0},this.attribute.text)),this.appendChild(this._text)}layout(){const t=this.attribute.icon.height,e=this._text.AABBBounds.height(),i=this.attribute.icon.width,{width:r,height:o,spaceBetweenTextAndIcon:s}=this.attribute;this._emptyTipIcon.setAttribute("x",r/2-i/2),this._emptyTipIcon.setAttribute("y",o/2-t/2-e/2-s/2),this._text.setAttribute("x",r/2),this._text.setAttribute("textAlign","center"),this._text.setAttribute("y",o/2+t/2+s/2),this._text.setAttribute("textBaseline","middle")}};_Z.defaultAttributes={spaceBetweenTextAndIcon:20,text:{text:"no data",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",pickable:!1},icon:{image:xIt,width:100,height:100,pickable:!1}};function SIt(){eo(),Ql(),Qa(),Pq()}SIt();class $m extends Ro{constructor(t,e){super(e?.skipDefault?t:Wt({},$m.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this._dispatchEvent("switch_state_change",{eventType:"switch_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(i,r,o)=>{"interactive"in i&&this.setAttribute("pickable",i.interactive),"disabled"in i&&this.setAttribute("cursor",i.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderCircle(),this.renderText(),this.layout()}renderBox(){this._box=new Py(Wt({},this.attribute.box)),this.attribute.disabled&&this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill}):this.attribute.disabled&&!this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableUncheckedFill}):this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.checkedFill}):this._box.setAttributes({fill:this.attribute.box.uncheckedFill}),this.appendChild(this._box)}renderCircle(){this._circle=new ru(Wt({},this.attribute.circle)),this.appendChild(this._circle)}renderText(){var t,e,i;this._text=new si(Wt({},(t=this.attribute.text)!==null&&t!==void 0?t:{})),this.attribute.checked&&(!((e=this.attribute.text)===null||e===void 0)&&e.checkedText)?this._text.setAttributes({text:this.attribute.text.checkedText}):!((i=this.attribute.text)===null||i===void 0)&&i.uncheckedText&&this._text.setAttributes({text:this.attribute.text.uncheckedText}),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){var t,e,i,r,o,s,a,l,h,u;const d=this.attribute.spaceBetweenTextAndCircle,c=this.attribute.circle.radius,f=this.attribute.box.height,g=2*c,p=this._text.AABBBounds.height(),v=Math.max(f,g,p),m=v/2-g/2+c,y=v/2-p/2,b=this.attribute.box.width,_=2*c,w=bA(((i=(e=(t=this.attribute.text)===null||t===void 0?void 0:t.checkedText)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0)>((s=(o=(r=this.attribute.text)===null||r===void 0?void 0:r.uncheckedText)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0)?(l=(a=this.attribute.text)===null||a===void 0?void 0:a.checkedText)!==null&&l!==void 0?l:"":(u=(h=this.attribute.text)===null||h===void 0?void 0:h.uncheckedText)!==null&&u!==void 0?u:"",this._text.attribute).width,C=Math.max(b,_+w+3*d),x=f/2-_/2+c,S=x+c+d;this._box.setAttributes({width:C,height:v}),this._circle.setAttributes({y:m,x:this.attribute.checked?C-x:x}),this._text.setAttributes({x:this.attribute.checked?C-S-w:S,y})}initAttributes(t,e){t=e?.skipDefault?t:Wt({},$m.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}$m.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",circle:{radius:8,fill:"#FFF",pickable:!1},box:{width:40,height:24,cornerRadius:12,uncheckedFill:"rgb(201,205,212)",checkedFill:"#165DFF",disableUncheckedFill:"rgb(242,243,245)",disableCheckedFill:"rgb(148,191,255)",pickable:!1},text:{textAlign:"left",textBaseline:"top",pickable:!1},spaceBetweenTextAndCircle:6};let w6=!1;function wZ(){w6||(w6=!0,zm(),ZO()?B1(Nt):oBt()&&E1(Nt),XEt(),Pq(),eo(),mA(),oD(),Ql(),yA(),qEt(),Ap(),Qa(),KW(),pLt(),KW())}function x6(n,t){let e=null;return function(...i){e||(n.apply(this,i),e=setTimeout(()=>{e=null},t))}}function Sl(n,t){const e=n.getFullYear().toString(),i=(n.getMonth()+1).toString().padStart(2,"0"),r=n.getDate().toString().padStart(2,"0");if((t=(t=(t=t.replace("yyyy",e)).replace("mm",i)).replace("dd",r)).length>10){const o=n.getHours().toString().padStart(2,"0"),s=n.getMinutes().toString().padStart(2,"0"),a=n.getSeconds().toString().padStart(2,"0");t=(t=(t=t.replace("hh",o)).replace("mm",s)).replace("ss",a)}return t}function AIt(n,t){const e=t.indexOf("yyyy"),i=t.indexOf("mm"),r=t.indexOf("dd"),o=i<e?i<r?0:1:i<r?1:2,s=r<e?r<i?0:1:r<i?1:2,a=parseInt(n[e<i?e<r?0:1:i<r?1:2],10),l=parseInt(n[o],10)-1,h=parseInt(n[s],10);if(isNaN(a)||a<1||isNaN(l)||l<0||l>11)return!1;const u=[31,MIt(a)?29:28,31,30,31,30,31,31,30,31,30,31];return!(isNaN(h)||h<1||h>u[l])}function TIt(n,t){if(t.includes("hh")||t.includes("mm")||t.includes("ss")){const e=t.indexOf("hh")>-1?t.indexOf("hh"):t.indexOf("HH"),i=parseInt(n[e],10),r=parseInt(n[e+1],10),o=n.length>e+2?parseInt(n[e+2],10):0;if(isNaN(i)||i<0||i>23||isNaN(r)||r<0||r>59||isNaN(o)||o<0||o>59)return!1}return!0}function MIt(n){return n%4==0&&n%100!=0||n%400==0}function S_(n){const t=["yyyy-mm-dd","dd-mm-yyyy","mm/dd/yyyy","yyyy/mm/dd","dd/mm/yyyy","yyyy.mm.dd","mm.dd.yyyy","dd.mm.yyyy"],e=["hh:mm:ss","hh:mm"],i=(n=n.trim()).split(" "),r=i[0],o=i[1];let s,a;if(r)for(let l=0;l<t.length;l++){const h=t[l],u=r.split(UR(h)),d=AIt(u,h);if(u.length===3&&d){s=h;break}}if(s&&o)for(let l=0;l<e.length;l++){const h=e[l],u=o.split(UR(h)),d=h.split(UR(h));if(TIt(u,h)&&u.length===d.length){a=h;break}}return r&&o&&s&&a?s+" "+a:r&&!o?s:"yyyy-mm-dd hh:mm:ss"}function UR(n){const t=n.match(/[^\w]/g);if(t){const e=t.map(i=>"\\"+i).join("|");return new RegExp(e,"g")}return/[^\w]/}function xZ(n,t){return n.replace(/\{([^}]+)\}/g,(e,i)=>{const r=i.split(".");let o=t;for(const s of r){if(!o.hasOwnProperty(s)){o=e;break}o=o[s]}return o})}function Oy(n){return Array.isArray(n)?n.length===3?[n[0],n[1],n[2],n[1]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:[n[0],n[1],n[2],n[3]]:[n,n,n,n]}function RIt(n){const t=new Date(n.getFullYear(),0,1);return Math.ceil(((n.getTime()+1-t.getTime())/864e5+1)/7)}function BIt(n,t){const e=Object.getOwnPropertyDescriptor(n,t);return!!e&&(!!e.set||e.writable===!0)}function Ai(n,t=!1){let e;if(n){if(e=new Date(n),typeof n=="string"){if(n.length>10)return t&&e.setHours(0,0,0,0),e;e.setHours(0,0,0,0)}}else e=new Date;return t&&e.setHours(0,0,0,0),e}function PIt(n,t=!1){let e;if(n){if(e=new Date(n),typeof n=="string"){if(n.length>10)return t&&e.setMinutes(59,59,999),e;e.setMinutes(59,59,999)}}else e=new Date;return t&&e.setMinutes(59,59,999),e}function kIt(n,t=!1){let e;if(n){if(e=new Date(n),typeof n=="string"){if(n.length>10)return t&&e.setSeconds(59,999),e;e.setSeconds(59,999)}}else e=new Date;return t&&e.setSeconds(59,999),e}function SZ(n,t=!1){let e;if(n){if(e=new Date(n),typeof n=="string"){if(n.length>10)return t&&e.setMilliseconds(999),e;e.setMilliseconds(999)}}else e=new Date;return t&&e.setMilliseconds(999),e}function Mh(n,t=!1){let e;if(n){if(e=new Date(n),typeof n=="string"){if(n.length>10)return t&&e.setHours(23,59,59,999),e;e.setHours(23,59,59,999)}}else e=new Date;return t&&e.setHours(23,59,59,999),e}function ap(n,t,e,i){let r=new Date(t);switch(e){case"second":r.setMilliseconds(999);break;case"minute":r.setSeconds(59,999);break;case"hour":r.setMinutes(59,59,999);break;case"day":r.setHours(23,59,59,999);break;case"week":const a=6-r.getDay();r.setDate(r.getDate()+a),r.setHours(23,59,59,999);break;case"month":const l=new Date(r.getFullYear(),r.getMonth()+1,0).getDate();r.setDate(l),r.setHours(23,59,59,999);break;case"quarter":const h=r.getMonth(),u=h-h%3+2,d=new Date(r.getFullYear(),u+1,0).getDate();r.setMonth(u,d),r.setHours(23,59,59,999);break;case"year":r.setMonth(11,31),r.setHours(23,59,59,999);break;default:throw new Error("Invalid time scale")}const o=Oe(r,n,e,i,1),s=Math.ceil(o);if(s>o){const a=(s-o)*i,l=1e3,h=60*l,u=60*h,d=24*u,c=7*d;switch(new Date(r.getTime()+1),e){case"second":r.setTime(r.getTime()+a*l);break;case"minute":r.setTime(r.getTime()+a*h);break;case"hour":r.setTime(r.getTime()+a*u);break;case"day":r.setTime(r.getTime()+a*d);break;case"week":r.setTime(r.getTime()+a*c);break;case"month":r=new Date(r.getFullYear(),r.getMonth()+1+Math.round(a),0),r.setHours(23,59,59,999);break;case"quarter":const f=r.getMonth(),g=f-f%3+2;r=new Date(r.getFullYear(),g+Math.round(3*a)+1,0),r.setHours(23,59,59,999);break;case"year":r.setFullYear(r.getFullYear()+Math.floor(a)),r.setHours(23,59,59,999);break;default:throw new Error("Invalid time scale")}}return r}function _c(n,t,e="monday"){const i=new Date(n);switch(t){case"second":i.setMilliseconds(0);break;case"minute":i.setSeconds(0,0);break;case"hour":i.setMinutes(0,0,0);break;case"day":i.setHours(0,0,0,0);break;case"week":const r=i.getDay();let o=r;o=e==="monday"?r===0?-6:1-r:-r,i.setDate(i.getDate()+o),i.setHours(0,0,0,0);break;case"month":i.setDate(1),i.setHours(0,0,0,0);break;case"quarter":const s=i.getMonth(),a=s-s%3;i.setMonth(a,1),i.setHours(0,0,0,0);break;case"year":i.setMonth(0,1),i.setHours(0,0,0,0);break;default:throw new Error("Invalid time scale")}return i}function Oe(n,t,e,i,r=0){let o;const s=new Date(n.getTime()+r);switch(e){case"second":o=(s.getTime()-t.getTime())/1e3;break;case"minute":o=(s.getTime()-t.getTime())/6e4;break;case"hour":o=(s.getTime()-t.getTime())/36e5;break;case"day":o=(s.getTime()-t.getTime())/864e5;break;case"week":o=(s.getTime()-t.getTime())/6048e5;break;case"month":o=12*(s.getFullYear()-t.getFullYear())+(s.getMonth()-t.getMonth()),o+=(s.getDate()-t.getDate())/new Date(s.getFullYear(),s.getMonth()+1,0).getDate();break;case"quarter":o=4*(s.getFullYear()-t.getFullYear())+(s.getMonth()-t.getMonth())/3,o+=(s.getDate()-t.getDate())/(3*new Date(s.getFullYear(),s.getMonth()+1,0).getDate());break;case"year":o=s.getFullYear()-t.getFullYear(),o+=(s.getMonth()-t.getMonth())/12;break;default:throw new Error("Invalid time scale")}return o/i}class EIt{constructor(t){var e;this._scene=t,this.scrollLeft=0,this.scrollTop=0,this.x=0,this.y=t._gantt.getAllHeaderRowsHeight(),this.width=t.ganttGroup.attribute.width,this.height=t.ganttGroup.attribute.height-t.timelineHeader.group.attribute.height,this.rowHeight=t._gantt.parsedOptions.rowHeight,this.rowCount=t._gantt.itemCount,this.allGridWidth=t._gantt.getAllDateColsWidth(),this.allGridHeight=t._gantt.getAllTaskBarsHeight(),this.group=new ge({x:this.x,y:this.y,width:this.width,height:this.height,clip:!0,fill:(e=t._gantt.parsedOptions.grid)===null||e===void 0?void 0:e.backgroundColor}),this.group.name="grid-container",t.ganttGroup.addChild(this.group),this.createVerticalBackgroundRects(),this.createHorizontalBackgroundRects(),this.createVerticalLines(),this.createHorizontalLines(),this.createTimeLineHeaderBottomLine()}createTimeLineHeaderBottomLine(){var t,e,i,r,o,s,a,l,h;const u=this._scene._gantt.parsedOptions,d=(e=(t=u.horizontalSplitLine)===null||t===void 0?void 0:t.lineWidth)!==null&&e!==void 0?e:(i=u.timelineHeaderHorizontalLineStyle)===null||i===void 0?void 0:i.lineWidth,c=(1&d?-.5:0)+d/2,f=Ri({pickable:!1,stroke:(o=(r=u.horizontalSplitLine)===null||r===void 0?void 0:r.lineColor)!==null&&o!==void 0?o:(s=u.timelineHeaderHorizontalLineStyle)===null||s===void 0?void 0:s.lineColor,lineWidth:d+(1&d?1:0),lineDash:(l=(a=u.horizontalSplitLine)===null||a===void 0?void 0:a.lineDash)!==null&&l!==void 0?l:(h=u.timelineHeaderHorizontalLineStyle)===null||h===void 0?void 0:h.lineDash,points:[{x:0,y:c},{x:this._scene._gantt.getAllDateColsWidth(),y:c}]});f.name="timeLine-header-bottom-line",this.group.addChild(f)}createVerticalLines(){var t,e;const i=this._scene._gantt.parsedOptions.grid,r=(t=i.verticalLineDependenceOnTimeScale)!==null&&t!==void 0?t:this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0].unit;if(i.verticalLine){this.verticalLineGroup=new ge({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalLineGroup.name="grid-vertical",this.group.appendChild(this.verticalLineGroup);const o=(e=this._scene._gantt.parsedOptions.reverseSortedTimelineScales.find(u=>u.unit===r))!==null&&e!==void 0?e:this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],{unit:s,step:a}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],{timelineDates:l}=o,h=this._scene._gantt.parsedOptions.timelineColWidth;if(typeof i.verticalLine=="function")for(let u=0;u<l?.length-1;u++){const{endDate:d}=l[u],c=i.verticalLine({index:u,dateIndex:l[u].dateIndex,date:l[u].endDate,ganttInstance:this._scene._gantt}),f=Math.ceil(Oe(d,this._scene._gantt.parsedOptions.minDate,s,a,1)*h)+(1&c.lineWidth?.5:0),g=Ri({pickable:!1,stroke:c.lineColor,lineWidth:c.lineWidth,lineDash:c.lineDash,points:[{x:f,y:0},{x:f,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(g)}else{const u=i.verticalLine;for(let d=0;d<l?.length-1;d++){const{endDate:c}=l[d],f=Math.ceil(Oe(c,this._scene._gantt.parsedOptions.minDate,s,a,1)*h)+(1&u.lineWidth?.5:0),g=Ri({pickable:!1,stroke:u.lineColor,lineWidth:u.lineWidth,lineDash:u.lineDash,points:[{x:f,y:0},{x:f,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(g)}}}}createHorizontalLines(){const t=this._scene._gantt.parsedOptions.grid;if(t.horizontalLine)if(this.horizontalLineGroup=new ge({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalLineGroup.name="grid-horizontal",this.group.appendChild(this.horizontalLineGroup),typeof t.horizontalLine=="function"){let e=.5;for(let i=0;i<this.rowCount-1;i++){const r=t.horizontalLine({index:i,ganttInstance:this._scene._gantt});e+=this._scene._gantt.getRowHeightByIndex(i);const o=Ri({pickable:!1,stroke:r.lineColor,lineWidth:r.lineWidth,lineDash:r.lineDash,points:[{x:0,y:e},{x:this.allGridWidth,y:e}]});this.horizontalLineGroup.appendChild(o)}}else{const e=t.horizontalLine;let i=0;1&e.lineWidth&&(i+=.5);for(let r=0;r<this.rowCount-1;r++){i+=this._scene._gantt.getRowHeightByIndex(r);const o=Ri({pickable:!1,stroke:e.lineColor,lineWidth:e.lineWidth,lineDash:e.lineDash,points:[{x:0,y:i},{x:this.allGridWidth,y:i}]});this.horizontalLineGroup.appendChild(o)}}}createVerticalBackgroundRects(){const t=this._scene._gantt.parsedOptions.grid.verticalBackgroundColor,e=this._scene._gantt.parsedOptions.grid.weekendBackgroundColor;if(t||e){this.verticalBackgroundRectsGroup=new ge({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalBackgroundRectsGroup.name="grid-vertical-background",this.group.appendChild(this.verticalBackgroundRectsGroup);const{timelineDates:i,unit:r,step:o}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],s=this._scene._gantt.parsedOptions.timelineColWidth;if(t||e)for(let a=0;a<=i?.length-1;a++){let l;if(!e||r!=="day"||o!==1||i[a].startDate.getDay()!==0&&i[a].startDate.getDay()!==6?typeof t=="function"?l=t({index:a,dateIndex:i[a].dateIndex,date:i[a].endDate,ganttInstance:this._scene._gantt}):t&&(l=t[a%t.length]):l=e,l){const h=Math.ceil(s*a),u=Ne({pickable:!1,fill:l,x:h,y:0,width:s,height:this.allGridHeight});this.verticalBackgroundRectsGroup.appendChild(u)}}}}createHorizontalBackgroundRects(){const t=this._scene._gantt.parsedOptions.grid.horizontalBackgroundColor;if(t){this.horizontalBackgroundRectsGroup=new ge({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalBackgroundRectsGroup.name="grid-horizontal-background",this.group.appendChild(this.horizontalBackgroundRectsGroup);let e=0;for(let i=0;i<=this.rowCount-1;i++){let r;r=typeof t=="function"?t({index:i,ganttInstance:this._scene._gantt}):t[i%t.length];const o=Ne({pickable:!1,fill:r,x:0,y:e,width:this.allGridWidth,height:this._scene._gantt.getRowHeightByIndex(i)});this.horizontalBackgroundRectsGroup.appendChild(o),e+=this._scene._gantt.getRowHeightByIndex(i)}}}refresh(){this.width=this._scene.ganttGroup.attribute.width,this.height=this._scene.ganttGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttributes({width:this.width,height:this.height,y:this._scene._gantt.getAllHeaderRowsHeight()}),this.rowCount=this._scene._gantt.itemCount,this.allGridWidth=this._scene._gantt.getAllDateColsWidth(),this.allGridHeight=this._scene._gantt.getAllTaskBarsHeight(),this.group.removeAllChild(),this.createVerticalBackgroundRects(),this.createHorizontalBackgroundRects(),this.createVerticalLines(),this.createHorizontalLines(),this.createTimeLineHeaderBottomLine()}setX(t){var e,i,r,o;(e=this.verticalLineGroup)===null||e===void 0||e.setAttribute("x",t),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("x",t),(r=this.verticalBackgroundRectsGroup)===null||r===void 0||r.setAttribute("x",t),(o=this.horizontalBackgroundRectsGroup)===null||o===void 0||o.setAttribute("x",t)}setY(t){var e,i,r,o;(e=this.verticalLineGroup)===null||e===void 0||e.setAttribute("y",t),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("y",t),(r=this.verticalBackgroundRectsGroup)===null||r===void 0||r.setAttribute("y",t),(o=this.horizontalBackgroundRectsGroup)===null||o===void 0||o.setAttribute("y",t)}resize(){this.width=this._scene.ganttGroup.attribute.width,this.height=this._scene.ganttGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}}let Ko=class ur{static get mode(){return ur._mode||(ur._mode=LIt()),ur._mode}static set mode(t){ur._mode=t}static RegisterCreateCanvas(t){ur.CreateCanvas=t}static RegisterLoadImage(t){ur.LoadImage=t}static GetCreateCanvasFunc(){return ur.CreateCanvas?ur.CreateCanvas:ur.mode==="worker"?(t=200,e=200)=>new OffscreenCanvas(t,e):void 0}static RegisterRequestAnimationFrame(t){ur.RequestAnimationFrame=t()}static GetRequestAnimationFrame(){if(ur.RequestAnimationFrame)return ur.RequestAnimationFrame}static RegisterCancelAnimationFrame(t){ur.CancelAnimationFrame=t()}static GetCancelAnimationFrame(){if(ur.CancelAnimationFrame)return ur.CancelAnimationFrame}};function LIt(){let n="browser";try{window.type==="node"?n="node":typeof window>"u"||window.performance?typeof window>"u"&&(n="node"):n="miniApp"}catch{n="node"}return n}Ko.dpr=0;const Bp=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,La=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||Bp(n,"Boolean"),Bo=n=>typeof n=="function",Pe=n=>n==null,Y=n=>n!=null,pn=n=>{const t=typeof n;return n!==null&&t==="object"||t==="function"},OIt=n=>typeof n=="object"&&n!==null,yD=function(n){if(!OIt(n)||!Bp(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},Si=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||Bp(n,"String")},Mt=n=>Array.isArray?Array.isArray(n):Bp(n,"Array"),bD=function(n){return n!==null&&typeof n!="function"&&Number.isFinite(n.length)},DIt=n=>Bp(n,"Date"),pt=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||Bp(n,"Number")},Dd=n=>pt(n)&&Number.isFinite(n),IIt=n=>({}).toString.call(n).replace(/^\[object /,"").replace(/]$/,""),HIt=Object.prototype,FIt=function(n){const t=n&&n.constructor;return n===(typeof t=="function"&&t.prototype||HIt)},zIt=Object.prototype.hasOwnProperty;function Jn(n){if(Pe(n))return!0;if(bD(n))return!n.length;const t=IIt(n);if(t==="Map"||t==="Set")return!n.size;if(FIt(n))return!Object.keys(n).length;for(const e in n)if(zIt.call(n,e))return!1;return!0}const mC=(n,t,e)=>{const i=Si(t)?t.split("."):t;for(let r=0;r<i.length;r++)n=n?n[i[r]]:void 0;return n===void 0?e:n};function kc(n,t,e){let i;if(!Y(n)||typeof n!="object"||t)return n;const r=Mt(n),o=n.length;i=r?new Array(o):typeof n=="object"?{}:La(n)||pt(n)||Si(n)?n:DIt(n)?new Date(+n):void 0;const s=r?void 0:Object.keys(Object(n));let a=-1;if(i)for(;++a<(s||n).length;){const l=s?s[a]:a,h=n[l];e&&e.includes(l.toString())?i[l]=h:i[l]=kc(h,t,e)}return i}function AZ(n,t,e=!1,i=!1){if(t){if(n===t)return;if(Y(t)&&typeof t=="object"){const r=Object(t),o=[];for(const l in r)o.push(l);let{length:s}=o,a=-1;for(;s--;){const l=o[++a];!Y(r[l])||typeof r[l]!="object"||i&&Mt(n[l])?TZ(n,l,r[l]):NIt(n,t,l,e,i)}}}}function NIt(n,t,e,i=!1,r=!1){const o=n[e],s=t[e];let a=t[e],l=!0;if(Mt(s)){if(i)a=[];else if(Mt(o))a=o;else if(bD(o)){a=new Array(o.length);let h=-1;const u=o.length;for(;++h<u;)a[h]=o[h]}}else yD(s)?(a=o??{},typeof o!="function"&&typeof o=="object"||(a={})):l=!1;l&&AZ(a,s,i,r),TZ(n,e,a)}function TZ(n,t,e){(e!==void 0&&!WIt(n[t],e)||e===void 0&&!(t in n))&&(n[t]=e)}function WIt(n,t){return n===t||Number.isNaN(n)&&Number.isNaN(t)}function Ue(n,...t){let e=-1;const i=t.length;for(;++e<i;)AZ(n,t[e],!0);return n}function VIt(n,t){if(!n||!yD(n))return n;const e={};return Object.keys(n).forEach(i=>{const r=n[i];let o=!1;t.forEach(s=>{(Si(s)&&s===i||s instanceof RegExp&&i.match(s))&&(o=!0)}),o||(e[i]=r)}),e}function S6(n){return Object.prototype.toString.call(n)}function A6(n){return Object.keys(n)}function jm(n,t,e){if(n===t)return!0;if(typeof n!=typeof t||n==null||t==null)return!1;if(Number.isNaN(n)&&Number.isNaN(t))return!0;if(S6(n)!==S6(t)||Bo(n)||typeof n!="object")return!1;if(Mt(n)){if(n.length!==t.length)return!1;for(let o=n.length-1;o>=0;o--)if(!jm(n[o],t[o]))return!1;return!0}if(!yD(n))return!1;const i=A6(n),r=A6(t);if(i.length!==r.length)return!1;i.sort(),r.sort();for(let o=i.length-1;o>=0;o--)if(i[o]!=r[o])return!1;for(let o=i.length-1;o>=0;o--){const s=i[o];if(!jm(n[s],t[s]))return!1}return!0}function GIt(n){if(bD(n))return n[n.length-1]}const $It=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)>0&&(i=o)}return i},jIt=(n,t)=>{var e;if(n.length===0)return;let i=n[0];for(let r=1;r<n.length;r++){const o=n[r];((e=void 0)!==null&&e!==void 0?e:o-i)<0&&(i=o)}return i};function UIt(n,t){if(!Mt(n)||!Mt(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function K1(n){return n*(Math.PI/180)}const T6=n=>{let t=n.charCodeAt(0),e=n.length===2?n.charCodeAt(1):0,i=t;return 55296<=t&&t<=56319&&56320<=e&&e<=57343&&(t&=1023,e&=1023,i=t<<10|e,i+=65536),i===12288||65281<=i&&i<=65376||65504<=i&&i<=65510?"F":i===8361||65377<=i&&i<=65470||65474<=i&&i<=65479||65482<=i&&i<=65487||65490<=i&&i<=65495||65498<=i&&i<=65500||65512<=i&&i<=65518?"H":4352<=i&&i<=4447||4515<=i&&i<=4519||4602<=i&&i<=4607||9001<=i&&i<=9002||11904<=i&&i<=11929||11931<=i&&i<=12019||12032<=i&&i<=12245||12272<=i&&i<=12283||12289<=i&&i<=12350||12353<=i&&i<=12438||12441<=i&&i<=12543||12549<=i&&i<=12589||12593<=i&&i<=12686||12688<=i&&i<=12730||12736<=i&&i<=12771||12784<=i&&i<=12830||12832<=i&&i<=12871||12880<=i&&i<=13054||13056<=i&&i<=19903||19968<=i&&i<=42124||42128<=i&&i<=42182||43360<=i&&i<=43388||44032<=i&&i<=55203||55216<=i&&i<=55238||55243<=i&&i<=55291||63744<=i&&i<=64255||65040<=i&&i<=65049||65072<=i&&i<=65106||65108<=i&&i<=65126||65128<=i&&i<=65131||110592<=i&&i<=110593||127488<=i&&i<=127490||127504<=i&&i<=127546||127552<=i&&i<=127560||127568<=i&&i<=127569||131072<=i&&i<=194367||177984<=i&&i<=196605||196608<=i&&i<=262141?"W":32<=i&&i<=126||162<=i&&i<=163||165<=i&&i<=166||i===172||i===175||10214<=i&&i<=10221||10629<=i&&i<=10630?"Na":i===161||i===164||167<=i&&i<=168||i===170||173<=i&&i<=174||176<=i&&i<=180||182<=i&&i<=186||188<=i&&i<=191||i===198||i===208||215<=i&&i<=216||222<=i&&i<=225||i===230||232<=i&&i<=234||236<=i&&i<=237||i===240||242<=i&&i<=243||247<=i&&i<=250||i===252||i===254||i===257||i===273||i===275||i===283||294<=i&&i<=295||i===299||305<=i&&i<=307||i===312||319<=i&&i<=322||i===324||328<=i&&i<=331||i===333||338<=i&&i<=339||358<=i&&i<=359||i===363||i===462||i===464||i===466||i===468||i===470||i===472||i===474||i===476||i===593||i===609||i===708||i===711||713<=i&&i<=715||i===717||i===720||728<=i&&i<=731||i===733||i===735||768<=i&&i<=879||913<=i&&i<=929||931<=i&&i<=937||945<=i&&i<=961||963<=i&&i<=969||i===1025||1040<=i&&i<=1103||i===1105||i===8208||8211<=i&&i<=8214||8216<=i&&i<=8217||8220<=i&&i<=8221||8224<=i&&i<=8226||8228<=i&&i<=8231||i===8240||8242<=i&&i<=8243||i===8245||i===8251||i===8254||i===8308||i===8319||8321<=i&&i<=8324||i===8364||i===8451||i===8453||i===8457||i===8467||i===8470||8481<=i&&i<=8482||i===8486||i===8491||8531<=i&&i<=8532||8539<=i&&i<=8542||8544<=i&&i<=8555||8560<=i&&i<=8569||i===8585||8592<=i&&i<=8601||8632<=i&&i<=8633||i===8658||i===8660||i===8679||i===8704||8706<=i&&i<=8707||8711<=i&&i<=8712||i===8715||i===8719||i===8721||i===8725||i===8730||8733<=i&&i<=8736||i===8739||i===8741||8743<=i&&i<=8748||i===8750||8756<=i&&i<=8759||8764<=i&&i<=8765||i===8776||i===8780||i===8786||8800<=i&&i<=8801||8804<=i&&i<=8807||8810<=i&&i<=8811||8814<=i&&i<=8815||8834<=i&&i<=8835||8838<=i&&i<=8839||i===8853||i===8857||i===8869||i===8895||i===8978||9312<=i&&i<=9449||9451<=i&&i<=9547||9552<=i&&i<=9587||9600<=i&&i<=9615||9618<=i&&i<=9621||9632<=i&&i<=9633||9635<=i&&i<=9641||9650<=i&&i<=9651||9654<=i&&i<=9655||9660<=i&&i<=9661||9664<=i&&i<=9665||9670<=i&&i<=9672||i===9675||9678<=i&&i<=9681||9698<=i&&i<=9701||i===9711||9733<=i&&i<=9734||i===9737||9742<=i&&i<=9743||9748<=i&&i<=9749||i===9756||i===9758||i===9792||i===9794||9824<=i&&i<=9825||9827<=i&&i<=9829||9831<=i&&i<=9834||9836<=i&&i<=9837||i===9839||9886<=i&&i<=9887||9918<=i&&i<=9919||9924<=i&&i<=9933||9935<=i&&i<=9953||i===9955||9960<=i&&i<=9983||i===10045||i===10071||10102<=i&&i<=10111||11093<=i&&i<=11097||12872<=i&&i<=12879||57344<=i&&i<=63743||65024<=i&&i<=65039||i===65533||127232<=i&&i<=127242||127248<=i&&i<=127277||127280<=i&&i<=127337||127344<=i&&i<=127386||917760<=i&&i<=917999||983040<=i&&i<=1048573||1048576<=i&&i<=1114109?"A":"N"};function XIt(n,t={},e){e||(e=1);const{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=t.fontWeight,fontSize:s=t.fontSize,fontFamily:a=t.fontFamily}=n;return(i?i+" ":"")+(r?r+" ":"")+(o?o+" ":"")+s*e+"px "+(a||"sans-serif")}class co{constructor(t,e){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'"~`,this._option=t,this._userSpec=e??{},this.textSpec=this._initSpec(),Y(t.specialCharSet)&&(this.specialCharSet=t.specialCharSet),this._standardMethod=Y(t.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(Pe(this._canvas)&&(Y(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),Pe(this._canvas)&&typeof window<"u"&&window.document!==void 0&&globalThis&&Y(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),Pe(this._context)&&Y(this._canvas)){const t=this._canvas.getContext("2d");Y(t)&&(t.save(),t.font=XIt(this.textSpec),this._contextSaved=!0,this._context=t)}return!Pe(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var t,e,i;const{defaultFontParams:r={}}=this._option,{fontStyle:o=r.fontStyle,fontVariant:s=r.fontVariant,fontWeight:a=(t=r.fontWeight)!==null&&t!==void 0?t:"normal",fontSize:l=(e=r.fontSize)!==null&&e!==void 0?e:12,fontFamily:h=(i=r.fontFamily)!==null&&i!==void 0?i:"sans-serif",align:u,textAlign:d=u??"center",baseline:c,textBaseline:f=c??"middle",ellipsis:g,limit:p}=this._userSpec;let{lineHeight:v=l}=this._userSpec;if(Si(v)&&v[v.length-1]==="%"){const m=Number.parseFloat(v.substring(0,v.length-1))/100;v=l*m}return{fontStyle:o,fontVariant:s,fontFamily:h,fontSize:l,fontWeight:a,textAlign:d,textBaseline:f,ellipsis:g,limit:p,lineHeight:v}}measure(t,e){switch(e){case"vrender":case"canopus":return this.fullMeasure(t);case"canvas":return this.measureWithNaiveCanvas(t);case"simple":return this.quickMeasureWithoutCanvas(t);default:return this.quickMeasure(t)}}fullMeasure(t){if(Pe(t))return{width:0,height:0};if(Pe(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(t);const{fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:a,limit:l,lineHeight:h}=this.textSpec;let u;try{const d=this._option.getTextBounds({text:t,fontFamily:e,fontSize:i,fontWeight:r,textAlign:o,textBaseline:s,ellipsis:!!a,maxLineWidth:l||1/0,lineHeight:h});u={width:d.width(),height:d.height()}}catch{this._notSupportVRender=!0,u=this.measureWithNaiveCanvas(t)}return u}measureWithNaiveCanvas(t){return this._measureReduce(t,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(t){var e;if(!this.initContext())return this._quickMeasureWithoutCanvas(t);const i=this._context.measureText(t),{fontSize:r,lineHeight:o}=this.textSpec;return{width:i.width,height:(e=o)!==null&&e!==void 0?e:r,fontBoundingBoxAscent:i.fontBoundingBoxAscent,fontBoundingBoxDescent:i.fontBoundingBoxDescent}}quickMeasure(t){return this._measureReduce(t,this._quickMeasure.bind(this))}_quickMeasure(t){const e={width:0,height:0};for(let i=0;i<t.length;i++){const r=t[i];let o=this._measureSpecialChar(r);Pe(o)&&co.NUMBERS_CHAR_SET.includes(r)&&(o=this._measureNumberChar()),Pe(o)&&["F","W"].includes(T6(r))&&(o=this._measureFullSizeChar()),Pe(o)&&(o=this._measureLetterChar()),e.width+=o.width,e.height=Math.max(e.height,o.height),!Pe(o.fontBoundingBoxAscent)&&(e.fontBoundingBoxAscent=o.fontBoundingBoxAscent),!Pe(o.fontBoundingBoxDescent)&&(e.fontBoundingBoxDescent=o.fontBoundingBoxDescent)}return e}quickMeasureWithoutCanvas(t){return this._measureReduce(t,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(t){var e;const i={width:0,height:0},{fontSize:r,lineHeight:o}=this.textSpec;for(let s=0;s<t.length;s++){const a=t[s],l=["F","W"].includes(T6(a))?1:.53;i.width+=l*r}return i.height=(e=o)!==null&&e!==void 0?e:r,i}_measureReduce(t,e){var i;const{fontSize:r,lineHeight:o}=this.textSpec,s={width:0,height:0};if(Pe(t))return s;if(Mt(t)){const a=t.filter(Y).map(l=>l.toString());return a.length===0?s:a.length===1?e(a[0]):{width:a.reduce((l,h)=>Math.max(l,e(h).width),0),height:a.length*(((i=o)!==null&&i!==void 0?i:r)+1)+1}}return e(t.toString())}_measureNumberChar(){if(Pe(this._numberCharSize)){const t=this._standardMethod(co.NUMBERS_CHAR_SET);this._numberCharSize={width:t.width/co.NUMBERS_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return Pe(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(co.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(Pe(this._letterCharSize)){const t=this._standardMethod(co.ALPHABET_CHAR_SET);this._letterCharSize={width:t.width/co.ALPHABET_CHAR_SET.length,height:t.height,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(t){return Y(this._specialCharSizeMap[t])?this._specialCharSizeMap[t]:this.specialCharSet.includes(t)?(this._specialCharSizeMap[t]=this._standardMethod(t),this._specialCharSizeMap[t]):null}release(){Y(this._canvas)&&(this._canvas=null),Y(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}co.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",co.NUMBERS_CHAR_SET="0123456789",co.FULL_SIZE_CHAR="";function YIt(n,t,e){const{x1:i,y1:r,x2:o,y2:s}=t;return e.onlyTranslate()?(n!==t&&n.setValue(t.x1,t.y1,t.x2,t.y2),n.translate(e.e,e.f),t):(n.clear(),n.add(e.a*i+e.c*r+e.e,e.b*i+e.d*r+e.f),n.add(e.a*o+e.c*r+e.e,e.b*o+e.d*r+e.f),n.add(e.a*o+e.c*s+e.e,e.b*o+e.d*s+e.f),n.add(e.a*i+e.c*s+e.e,e.b*i+e.d*s+e.f),t)}class lu{constructor(t){t?this.setValue(t.x1,t.y1,t.x2,t.y2):this.clear()}clone(){return new lu(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}setValue(t=0,e=0,i=0,r=0){return this.x1=t,this.y1=e,this.x2=i,this.y2=r,this}set(t=0,e=0,i=0,r=0){return i<t?(this.x2=t,this.x1=i):(this.x1=t,this.x2=i),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this}add(t=0,e=0){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this}expand(t=0){return Mt(t)?(this.y1-=t[0],this.x2+=t[1],this.y2+=t[2],this.x1-=t[3]):(this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(t=0,e=0){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this}rotate(t=0,e=0,i=0){const r=this.rotatedPoints(t,e,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(t=0,e=0,i=0,r=0){const o=this.scalePoints(t,e,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this}intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this}encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2}alignsWith(t){return t&&(this.x1===t.x1||this.x2===t.x2||this.y1===t.y1||this.y2===t.y2)}intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)}contains(t=0,e=0){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)}containsPoint(t){return!(t.x<this.x1||t.x>this.x2||t.y<this.y1||t.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(t=0){return this.x1*=t,this.x2*=t,this}scaleY(t=0){return this.y1*=t,this.y2*=t,this}transformWithMatrix(t){return YIt(this,this,t),this}copy(t){return this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this}rotatedPoints(t,e,i){const{x1:r,y1:o,x2:s,y2:a}=this,l=Math.cos(t),h=Math.sin(t),u=e-e*l+i*h,d=i-e*h-i*l;return[l*r-h*o+u,h*r+l*o+d,l*r-h*a+u,h*r+l*a+d,l*s-h*o+u,h*s+l*o+d,l*s-h*a+u,h*s+l*a+d]}scalePoints(t,e,i,r){const{x1:o,y1:s,x2:a,y2:l}=this;return[t*o+(1-t)*i,e*s+(1-e)*r,t*a+(1-t)*i,e*l+(1-e)*r]}}class k0 extends lu{}class KIt{constructor(t){this._gantt=t,this.createScrollBar(t.tableNoFrameWidth,t.tableNoFrameHeight-t.getAllHeaderRowsHeight())}createScrollBar(t,e){var i,r;const o=this._gantt.parsedOptions.scrollStyle.scrollRailColor,s=this._gantt.parsedOptions.scrollStyle.scrollSliderColor,a=this._gantt.parsedOptions.scrollStyle.scrollSliderCornerRadius,l=this._gantt.parsedOptions.scrollStyle.width;let h;h=Y(a)?{cornerRadius:a,fill:s}:{fill:s},(i=this._gantt.parsedOptions.scrollStyle)===null||i===void 0||i.visible,(r=this._gantt.parsedOptions.scrollStyle)===null||r===void 0||r.hoverOn,this.hScrollBar=new Yl({direction:"horizontal",x:2*-t,y:2*-e,width:t,height:l,padding:0,railStyle:{fill:o},sliderStyle:h,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new Yl({direction:"vertical",x:2*-t,y:2*-e,width:l,height:e,padding:0,railStyle:{fill:o},sliderStyle:h,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}refresh(){}hideVerticalScrollBar(){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showVerticalScrollBar(t){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),t&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{this.hideVerticalScrollBar()},1e3)))}hideHorizontalScrollBar(){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showHorizontalScrollBar(t){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),t&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{this.hideHorizontalScrollBar()},1e3)))}updateVerticalScrollBarPos(t){const e=this.vScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.vScrollBar.setAttribute("range",[r,r+i]);const o=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:o.x1,y:o.y1}}updateHorizontalScrollBarPos(t){const e=this.hScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.hScrollBar.setAttribute("range",[r,r+i]);const o=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:o.x1,y:o.y1}}updateScrollBar(){const t=this._gantt.stateManager.scroll.horizontalBarPos,e=this._gantt.stateManager.scroll.verticalBarPos,i=this._gantt.parsedOptions.scrollStyle,r=i?.width,o=i?.visible,s=Math.ceil(this._gantt.scenegraph.ganttGroup.attribute.width),a=Math.ceil(this._gantt.scenegraph.ganttGroup.attribute.height),l=this._gantt.getAllRowsHeight(),h=this._gantt.getAllDateColsWidth(),u=this._gantt.getAllHeaderRowsHeight();if(h>s){const d=Math.min(a,l),c=Math.max(.05,s/h),f=i.hoverOn;let g=0;g=i.barToSide?this._gantt.tableNoFrameHeight-(f?r:-this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY:d-(f?r:-this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY,this.hScrollBar.setAttributes({x:this._gantt.scenegraph.ganttGroup.attribute.x,y:g,width:s,range:[0,c],visible:o==="always"});const p=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:p.x1,y:p.y1},o==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,width:0,visible:!1});if(l>a){const d=Math.min(s,h)+this._gantt.scenegraph.ganttGroup.attribute.x,c=Math.max(.05,(a-u)/(l-u));let f=0;const g=this._gantt.parsedOptions.scrollStyle.hoverOn;f=this._gantt.parsedOptions.scrollStyle.barToSide?this._gantt.tableNoFrameWidth-(g?r:-this._gantt.scenegraph.ganttGroup.attribute.x):d-(g?r:-this._gantt.scenegraph.ganttGroup.attribute.x),this.vScrollBar.setAttributes({x:f,y:u+(g?0:this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY,height:a-u,range:[0,c],visible:o==="always"});const p=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:p.x1,y:p.y1},o==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,height:0,visible:!1});this._gantt.stateManager.setScrollLeft(t),this._gantt.stateManager.setScrollTop(e)}}function Vk(n,t,e,i=!0){var r;let{deltaX:o,deltaY:s}=n;n.shiftKey&&n.deltaY&&(o=s,s=0);const[a,l]=qIt(o,s,{horizontal:1,vertical:1});a&&(t.setScrollLeft(t.scroll.horizontalBarPos+a),e.scenegraph.scrollbarComponent.showHorizontalScrollBar(!0)),l&&(t.setScrollTop(t.scroll.verticalBarPos+l),e.scenegraph.scrollbarComponent.showVerticalScrollBar(!0)),i&&t.resetInteractionState(),!((r=n.nativeEvent)===null||r===void 0)&&r.cancelable&&(t._gantt.parsedOptions.overscrollBehavior==="none"||Math.abs(s)>=Math.abs(o)&&s!==0&&MZ(s,t)||Math.abs(s)<=Math.abs(o)&&o!==0&&RZ(o,t))&&n.preventDefault()}function qIt(n,t,e){var i,r;const o=Math.abs(n/t),s=o<=.5?0:n,a=o>2?0:t;return[Math.ceil(s*((i=e.horizontal)!==null&&i!==void 0?i:0)),Math.ceil(a*((r=e.vertical)!==null&&r!==void 0?r:0))]}function MZ(n,t){return t._gantt.getAllRowsHeight()-t._gantt.scenegraph.height!=0&&!ZIt(n,t)&&!JIt(n,t)}function RZ(n,t){return t._gantt.getAllDateColsWidth()-t._gantt.scenegraph.width!=0&&!QIt(n,t)&&!tHt(n,t)}function ZIt(n,t){return t._gantt.getAllRowsHeight()-t._gantt.scenegraph.height!==0&&n<=0&&t.scroll.verticalBarPos<1}function JIt(n,t){const e=t._gantt.getAllRowsHeight()-t._gantt.scenegraph.height;return e!==0&&n>=0&&Math.abs(t.scroll.verticalBarPos-e)<1}function QIt(n,t){return t._gantt.getAllDateColsWidth()-t._gantt.scenegraph.width!==0&&n<=0&&t.scroll.horizontalBarPos<1}function tHt(n,t){const e=t._gantt.getAllDateColsWidth()-t._gantt.scenegraph.width;return e!==0&&n>=0&&Math.abs(t.scroll.horizontalBarPos-e)<1}function eHt(n){const t=n._gantt,e=t.stateManager,i=t.scenegraph;i.scrollbarComponent.vScrollBar.addEventListener("pointerover",s=>{i.scrollbarComponent.showVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerover",s=>{i.scrollbarComponent.showHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointerout",s=>{e.interactionState!==Ve.scrolling&&i.scrollbarComponent.hideVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerout",s=>{e.interactionState!==Ve.scrolling&&i.scrollbarComponent.hideHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointermove",s=>{s.stopPropagation()}),i.scrollbarComponent.vScrollBar.addEventListener("scrollDown",s=>{i._gantt.eventManager.isDown=!0}),i.scrollbarComponent.vScrollBar.addEventListener("pointerup",()=>{i._gantt.eventManager.isDraging=!1,e.interactionState===Ve.scrolling&&e.updateInteractionState(Ve.default)}),i.scrollbarComponent.vScrollBar.addEventListener("pointerupoutside",()=>{e.interactionState===Ve.scrolling&&e.updateInteractionState(Ve.default)}),i.scrollbarComponent.vScrollBar.addEventListener("scrollUp",s=>{i._gantt.eventManager.isDraging=!1}),i.scrollbarComponent.hScrollBar.addEventListener("pointermove",s=>{s.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDown",s=>{i._gantt.eventManager.isDown=!0,e.interactionState!==Ve.scrolling&&e.updateInteractionState(Ve.scrolling)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerup",()=>{e.interactionState===Ve.scrolling&&e.updateInteractionState(Ve.default)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerupoutside",()=>{e.interactionState===Ve.scrolling&&e.updateInteractionState(Ve.default)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollUp",s=>{i._gantt.eventManager.isDraging=!1});const r=x6(e.updateVerticalScrollBar,20),o=x6(e.updateHorizontalScrollBar,20);i.scrollbarComponent.vScrollBar.addEventListener("scrollDrag",s=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),e.interactionState!==Ve.scrolling&&e.updateInteractionState(Ve.scrolling);const a=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);r(a,s)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDrag",s=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==Ve.scrolling&&e.updateInteractionState(Ve.scrolling);const a=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);o(a)})}const q1={barColor:"blue",completedBarColor:"gray",width:30,cornerRadius:3,borderWidth:0,fontFamily:"Arial",fontSize:14};function iHt(n){q1.width=n}const nHt=typeof window>"u"||window.window===void 0;function og(n,t){const e=n+t.stateManager.scroll.horizontalBarPos,i=t.getDateColWidth(0);return Math.floor((e-i)/t.parsedOptions.timelineColWidth)+1}function _D(n){var t,e,i,r,o;return n?n===!0?[{date:Ai().toLocaleDateString(),content:"",scrollToMarkLine:!0,position:"left",style:{lineColor:"red",lineWidth:1}}]:Array.isArray(n)?n.map((s,a)=>{var l,h,u,d;return Object.assign(Object.assign({},s),{date:s.date,scrollToMarkLine:s.scrollToMarkLine,position:(l=s.position)!==null&&l!==void 0?l:"left",style:{lineColor:((h=s.style)===null||h===void 0?void 0:h.lineColor)||"red",lineWidth:((u=s.style)===null||u===void 0?void 0:u.lineWidth)||1,lineDash:(d=s.style)===null||d===void 0?void 0:d.lineDash}})}):[Object.assign(Object.assign({},n),{date:n.date,scrollToMarkLine:(t=n.scrollToMarkLine)===null||t===void 0||t,position:(e=n.position)!==null&&e!==void 0?e:"left",style:{lineColor:((i=n.style)===null||i===void 0?void 0:i.lineColor)||"red",lineWidth:((r=n.style)===null||r===void 0?void 0:r.lineWidth)||1,lineDash:(o=n.style)===null||o===void 0?void 0:o.lineDash}})]:[]}function rHt(n){var t;return n?.hoverOn||n?.horizontalVisible&&n?.horizontalVisible==="none"||!n?.horizontalVisible&&n?.visible==="none"?0:(t=n?.width)!==null&&t!==void 0?t:7}function oHt(n){var t;return n?.hoverOn||n?.verticalVisible&&n?.verticalVisible==="none"||!n?.verticalVisible&&n?.visible==="none"?0:(t=n?.width)!==null&&t!==void 0?t:7}function M6(n){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K,J,q,X,it,Z,et,nt,z,V,$,U,Q,rt,st,at,ht,gt,dt,vt,oe,Se,fi,me,bn,Gi,Ii,Yt,ai,We,Hi,br,At,_i,wt,Ec,Lc,_r,_s,NA,WA,VA,GA,$A,jA,UA,XA,YA,KA,qA,ZA,JA,QA,tT,eT,iT,nT,rT,oT,sT,aT,lT,hT,uT,dT,cT,fT,gT,pT,vT,mT;const lt=n.options;n.parsedOptions.tasksShowMode=(t=lt?.tasksShowMode)!==null&&t!==void 0?t:mt.Tasks_Separate,n.parsedOptions.pixelRatio=(e=lt?.pixelRatio)!==null&&e!==void 0?e:1,n.parsedOptions.rowHeight=(i=lt?.rowHeight)!==null&&i!==void 0?i:40,n.parsedOptions.timelineColWidth=(o=(r=lt?.timelineHeader)===null||r===void 0?void 0:r.colWidth)!==null&&o!==void 0?o:60,n.parsedOptions.startDateField=(a=(s=lt.taskBar)===null||s===void 0?void 0:s.startDateField)!==null&&a!==void 0?a:"startDate",n.parsedOptions.endDateField=(h=(l=lt.taskBar)===null||l===void 0?void 0:l.endDateField)!==null&&h!==void 0?h:"endDate",n.parsedOptions.progressField=(d=(u=lt.taskBar)===null||u===void 0?void 0:u.progressField)!==null&&d!==void 0?d:"progress",n.parsedOptions.projectSubTasksExpandable=(c=lt?.projectSubTasksExpandable)===null||c===void 0||c;const{unit:yT,startOfWeek:UD,step:kQ}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.minDate=lt?.minDate?_c(new Date(lt.minDate),yT,UD):void 0,n.parsedOptions.maxDate=lt?.maxDate&&(!((f=n.parsedOptions)===null||f===void 0)&&f.minDate)?ap((g=n.parsedOptions)===null||g===void 0?void 0:g.minDate,new Date(lt.maxDate),yT,kQ):void 0,n.parsedOptions._minDateTime=(p=n.parsedOptions.minDate)===null||p===void 0?void 0:p.getTime(),n.parsedOptions._maxDateTime=(v=n.parsedOptions.maxDate)===null||v===void 0?void 0:v.getTime(),n.parsedOptions.overscrollBehavior=(m=lt?.overscrollBehavior)!==null&&m!==void 0?m:"auto",n.parsedOptions.underlayBackgroundColor=(y=lt?.underlayBackgroundColor)!==null&&y!==void 0?y:"#FFF",n.parsedOptions.scrollStyle=Object.assign({},{scrollRailColor:"rgba(100, 100, 100, 0.2)",scrollSliderColor:"rgba(100, 100, 100, 0.5)",scrollSliderCornerRadius:4,width:10,visible:"always",hoverOn:!0,barToSide:!1},lt?.scrollStyle),n.parsedOptions.timelineHeaderHorizontalLineStyle=(b=lt?.timelineHeader)===null||b===void 0?void 0:b.horizontalLine,n.parsedOptions.timelineHeaderVerticalLineStyle=(_=lt?.timelineHeader)===null||_===void 0?void 0:_.verticalLine,n.parsedOptions.timelineHeaderBackgroundColor=(w=lt?.timelineHeader)===null||w===void 0?void 0:w.backgroundColor,n.parsedOptions.timeLineHeaderRowHeights=[],n.parsedOptions.timelineHeaderStyles=[];for(let ha=0;ha<n.parsedOptions.sortedTimelineScales.length;ha++){const EQ=n.parsedOptions.sortedTimelineScales[ha].style;n.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},EQ)),n.parsedOptions.timeLineHeaderRowHeights.push((x=(C=n.parsedOptions.sortedTimelineScales[ha].rowHeight)!==null&&C!==void 0?C:lt?.headerRowHeight)!==null&&x!==void 0?x:40)}n.parsedOptions.grid=Object.assign({},lt?.grid),iHt(3*n.parsedOptions.rowHeight/4),n.parsedOptions.taskBarStyle=!((S=lt?.taskBar)===null||S===void 0)&&S.barStyle&&typeof((A=lt?.taskBar)===null||A===void 0?void 0:A.barStyle)=="function"?lt.taskBar.barStyle:Object.assign({},q1,(T=lt?.taskBar)===null||T===void 0?void 0:T.barStyle),n.parsedOptions.projectBarStyle=!((M=lt?.taskBar)===null||M===void 0)&&M.projectStyle&&typeof((R=lt?.taskBar)===null||R===void 0?void 0:R.projectStyle)=="function"?lt.taskBar.projectStyle:!((E=lt?.taskBar)===null||E===void 0)&&E.projectStyle?Object.assign({},q1,(P=lt?.taskBar)===null||P===void 0?void 0:P.projectStyle):n.parsedOptions.taskBarStyle,n.parsedOptions.taskBarMilestoneStyle=Object.assign(typeof n.parsedOptions.taskBarStyle=="function"?{}:{width:n.parsedOptions.taskBarStyle.width,borderColor:n.parsedOptions.taskBarStyle.borderColor,borderLineWidth:(B=n.parsedOptions.taskBarStyle.borderLineWidth)!==null&&B!==void 0?B:1,fillColor:n.parsedOptions.taskBarStyle.barColor,cornerRadius:0},{labelTextStyle:{fontSize:16,color:"red",fontFamily:"Arial",padding:4}},(k=lt?.taskBar)===null||k===void 0?void 0:k.milestoneStyle),n.parsedOptions.taskBarMilestoneHypotenuse=n.parsedOptions.taskBarMilestoneStyle.width*Math.sqrt(2),n.parsedOptions.dateFormat=lt?.dateFormat,n.parsedOptions.taskBarHoverStyle=Object.assign({barOverlayColor:"rgba(99, 144, 0, 0.4)"},(L=lt?.taskBar)===null||L===void 0?void 0:L.hoverBarStyle),n.parsedOptions.taskBarSelectable=(D=(O=lt?.taskBar)===null||O===void 0?void 0:O.selectable)===null||D===void 0||D,n.parsedOptions.taskBarSelectedStyle=Object.assign(typeof n.parsedOptions.taskBarStyle=="function"?{shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,borderLineWidth:1}:{shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:n.parsedOptions.taskBarStyle.barColor,borderColor:n.parsedOptions.taskBarStyle.barColor,borderLineWidth:1},(I=lt?.taskBar)===null||I===void 0?void 0:I.selectedBarStyle),n.parsedOptions.taskBarLabelText=(F=(H=lt?.taskBar)===null||H===void 0?void 0:H.labelText)!==null&&F!==void 0?F:"",n.parsedOptions.taskBarMoveable=(j=(G=lt?.taskBar)===null||G===void 0?void 0:G.moveable)===null||j===void 0||j,n.parsedOptions.moveTaskBarToExtendDateRange=(K=(W=lt?.taskBar)===null||W===void 0?void 0:W.moveToExtendDateRange)===null||K===void 0||K,n.parsedOptions.taskBarResizable=(q=(J=lt?.taskBar)===null||J===void 0?void 0:J.resizable)===null||q===void 0||q,n.parsedOptions.taskBarProgressAdjustable=(it=(X=lt?.taskBar)===null||X===void 0?void 0:X.progressAdjustable)!==null&&it!==void 0&&it,n.parsedOptions.taskBarDragOrder=(et=(Z=lt?.taskBar)===null||Z===void 0?void 0:Z.dragOrder)===null||et===void 0||et,n.parsedOptions.taskBarLabelStyle={fontFamily:(V=(z=(nt=lt?.taskBar)===null||nt===void 0?void 0:nt.labelTextStyle)===null||z===void 0?void 0:z.fontFamily)!==null&&V!==void 0?V:"Arial",fontSize:(Q=(U=($=lt?.taskBar)===null||$===void 0?void 0:$.labelTextStyle)===null||U===void 0?void 0:U.fontSize)!==null&&Q!==void 0?Q:20,color:(at=(st=(rt=lt?.taskBar)===null||rt===void 0?void 0:rt.labelTextStyle)===null||st===void 0?void 0:st.color)!==null&&at!==void 0?at:"#F01",outsideColor:(dt=(gt=(ht=lt?.taskBar)===null||ht===void 0?void 0:ht.labelTextStyle)===null||gt===void 0?void 0:gt.outsideColor)!==null&&dt!==void 0?dt:"#333333",textAlign:(Se=(oe=(vt=lt?.taskBar)===null||vt===void 0?void 0:vt.labelTextStyle)===null||oe===void 0?void 0:oe.textAlign)!==null&&Se!==void 0?Se:"left",textBaseline:(bn=(me=(fi=lt?.taskBar)===null||fi===void 0?void 0:fi.labelTextStyle)===null||me===void 0?void 0:me.textBaseline)!==null&&bn!==void 0?bn:"middle",padding:(Yt=(Ii=(Gi=lt?.taskBar)===null||Gi===void 0?void 0:Gi.labelTextStyle)===null||Ii===void 0?void 0:Ii.padding)!==null&&Yt!==void 0?Yt:[0,0,0,10],textOverflow:(We=(ai=lt?.taskBar)===null||ai===void 0?void 0:ai.labelTextStyle)===null||We===void 0?void 0:We.textOverflow,orient:(br=(Hi=lt?.taskBar)===null||Hi===void 0?void 0:Hi.labelTextStyle)===null||br===void 0?void 0:br.orient,orientHandleWithOverflow:(_i=(At=lt?.taskBar)===null||At===void 0?void 0:At.labelTextStyle)===null||_i===void 0?void 0:_i.orientHandleWithOverflow},n.parsedOptions.taskBarCustomLayout=(wt=lt?.taskBar)===null||wt===void 0?void 0:wt.customLayout,n.parsedOptions.taskBarCreatable=(Lc=(Ec=lt?.taskBar)===null||Ec===void 0?void 0:Ec.scheduleCreatable)!==null&&Lc!==void 0?Lc:!(n.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Separate&&n.parsedOptions.tasksShowMode!==mt.Tasks_Separate),n.parsedOptions.taskBarCreationButtonStyle=Object.assign({lineColor:"rgb(99, 144, 0)",lineWidth:1,lineDash:[5,5],cornerRadius:4,backgroundColor:"#FFF"},(_s=(_r=lt?.taskBar)===null||_r===void 0?void 0:_r.scheduleCreation)===null||_s===void 0?void 0:_s.buttonStyle),n.parsedOptions.taskBarCreationCustomLayout=(WA=(NA=lt?.taskBar)===null||NA===void 0?void 0:NA.scheduleCreation)===null||WA===void 0?void 0:WA.customLayout,n.parsedOptions.taskBarCreationMaxWidth=(GA=(VA=lt?.taskBar)===null||VA===void 0?void 0:VA.scheduleCreation)===null||GA===void 0?void 0:GA.maxWidth,n.parsedOptions.taskBarCreationMinWidth=(jA=($A=lt?.taskBar)===null||$A===void 0?void 0:$A.scheduleCreation)===null||jA===void 0?void 0:jA.minWidth,n.parsedOptions.outerFrameStyle=Object.assign({borderColor:"#e1e4e8",borderLineWidth:1,cornerRadius:4},(UA=lt.frame)===null||UA===void 0?void 0:UA.outerFrameStyle),n.parsedOptions.markLine=_D(lt?.markLine),(YA=(XA=n.parsedOptions.markLine)===null||XA===void 0?void 0:XA.length)!==null&&YA!==void 0&&YA&&(!((KA=n.parsedOptions.markLine)===null||KA===void 0)&&KA.every(ha=>ha.scrollToMarkLine===void 0)&&(n.parsedOptions.markLine[0].scrollToMarkLine=!0),!((qA=n.parsedOptions.markLine)===null||qA===void 0)&&qA.find(ha=>ha.scrollToMarkLine)&&(n.parsedOptions.scrollToMarkLineDate=_c(new Date((ZA=n.parsedOptions.markLine)===null||ZA===void 0?void 0:ZA.find(ha=>ha.scrollToMarkLine).date),yT,UD))),n.parsedOptions.verticalSplitLineHighlight=(JA=lt.frame)===null||JA===void 0?void 0:JA.verticalSplitLineHighlight,n.parsedOptions.verticalSplitLine=Object.assign({lineColor:(QA=n.parsedOptions.outerFrameStyle)===null||QA===void 0?void 0:QA.borderColor,lineWidth:(tT=n.parsedOptions.outerFrameStyle)===null||tT===void 0?void 0:tT.borderLineWidth},(eT=lt.frame)===null||eT===void 0?void 0:eT.verticalSplitLine),n.parsedOptions.horizontalSplitLine=(iT=lt.frame)===null||iT===void 0?void 0:iT.horizontalSplitLine,n.parsedOptions.verticalSplitLineMoveable=(nT=lt.frame)===null||nT===void 0?void 0:nT.verticalSplitLineMoveable,n.parsedOptions.taskKeyField=(rT=lt.taskKeyField)!==null&&rT!==void 0?rT:"id",n.parsedOptions.dependencyLinks=(sT=(oT=lt.dependency)===null||oT===void 0?void 0:oT.links)!==null&&sT!==void 0?sT:[],n.parsedOptions.dependencyLinkCreatable=(lT=(aT=lt.dependency)===null||aT===void 0?void 0:aT.linkCreatable)!==null&&lT!==void 0&&lT,n.parsedOptions.dependencyLinkSelectable=(uT=(hT=lt.dependency)===null||hT===void 0?void 0:hT.linkSelectable)===null||uT===void 0||uT,n.parsedOptions.dependencyLinkDeletable=(cT=(dT=lt.dependency)===null||dT===void 0?void 0:dT.linkDeletable)!==null&&cT!==void 0&&cT,n.parsedOptions.dependencyLinkLineStyle=Object.assign({lineColor:"red",lineWidth:1},(fT=lt.dependency)===null||fT===void 0?void 0:fT.linkLineStyle),n.parsedOptions.dependencyLinkSelectedLineStyle=Object.assign({shadowBlur:4,shadowOffset:0,shadowColor:n.parsedOptions.dependencyLinkLineStyle.lineColor,lineColor:n.parsedOptions.dependencyLinkLineStyle.lineColor,lineWidth:n.parsedOptions.dependencyLinkLineStyle.lineWidth},(gT=lt?.dependency)===null||gT===void 0?void 0:gT.linkSelectedLineStyle),n.parsedOptions.dependencyLinkLineCreatePointStyle=Object.assign({strokeColor:"red",fillColor:"white",radius:5,strokeWidth:1},(pT=lt?.dependency)===null||pT===void 0?void 0:pT.linkCreatePointStyle),n.parsedOptions.dependencyLinkLineCreatingPointStyle=Object.assign({strokeColor:"red",fillColor:"red",radius:5,strokeWidth:1},(vT=lt?.dependency)===null||vT===void 0?void 0:vT.linkCreatingPointStyle),n.parsedOptions.dependencyLinkLineCreatingStyle=Object.assign({lineColor:"red",lineWidth:1,lineDash:[5,5]},(mT=lt?.dependency)===null||mT===void 0?void 0:mT.linkCreatingLineStyle),n.parsedOptions.eventOptions=lt?.eventOptions,n.parsedOptions.keyboardOptions=lt?.keyboardOptions,n.parsedOptions.markLineCreateOptions=lt?.markLineCreateOptions}function sHt(n){var t,e,i,r;const o=n.options,{unit:s,startOfWeek:a,step:l}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.minDate=_c(new Date(n.parsedOptions.minDate),s,a),n.parsedOptions.maxDate=ap(n.parsedOptions.minDate,new Date(n.parsedOptions.maxDate),s,l),n.parsedOptions._minDateTime=(t=n.parsedOptions.minDate)===null||t===void 0?void 0:t.getTime(),n.parsedOptions._maxDateTime=(e=n.parsedOptions.maxDate)===null||e===void 0?void 0:e.getTime(),n.parsedOptions.timeLineHeaderRowHeights=[],n.parsedOptions.timelineHeaderStyles=[];for(let h=0;h<n.parsedOptions.sortedTimelineScales.length;h++){const u=n.parsedOptions.sortedTimelineScales[h].style;n.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},u)),n.parsedOptions.timeLineHeaderRowHeights.push((r=(i=n.parsedOptions.sortedTimelineScales[h].rowHeight)!==null&&i!==void 0?i:o?.headerRowHeight)!==null&&r!==void 0?r:40)}}function aHt(n,t,e){var i;const{unit:r,step:o,format:s}=e,a=[];for(;n<t;)if(r==="day"){const l=n.getFullYear(),h=n.getMonth(),u=n.getDate(),d=Mh(new Date(l,h,u+o-1),!0);d.getTime()>t.getTime()&&d.setTime(t.getTime());const c=n,f=s?.({dateIndex:u,startDate:c,endDate:d})||u.toString(),g={days:Math.abs(d.getTime()-n.getTime()+1)/864e5,startDate:c,endDate:d,step:o,unit:"day",title:f,dateIndex:u};a.push(g),n=new Date(l,h,u+o)}else if(r==="month"){const l=n.getFullYear(),h=n.getMonth(),u=Mh(new Date(l,h+o,0),!0);u.getTime()>t.getTime()&&u.setTime(t.getTime());const d=n,c=s?.({dateIndex:h+1,startDate:d,endDate:u})||(h+1).toString(),f={days:Math.abs(u.getTime()-n.getTime()+1)/864e5,startDate:d,step:o,unit:"month",endDate:u,title:c,dateIndex:h+1};a.push(f),n=new Date(l,h+o,1)}else if(r==="quarter"){const l=n.getFullYear(),h=Math.floor(n.getMonth()/3),u=Mh(new Date(l,3*(h+o),0),!0);u.getTime()>t.getTime()&&u.setTime(t.getTime());const d=n,c=s?.({dateIndex:h+1,startDate:d,endDate:u})||(h+1).toString(),f={days:Math.abs(u.getTime()-n.getTime()+1)/864e5,startDate:d,step:o,unit:"quarter",endDate:u,title:c,dateIndex:h+1};a.push(f),n=new Date(l,3*(h+o),1)}else if(r==="year"){const l=n.getFullYear(),h=Mh(new Date(l+o-1,11,31),!0);h.getTime()>t.getTime()&&h.setTime(t.getTime());const u=n,d=s?.({dateIndex:l,startDate:u,endDate:h})||l.toString(),c={days:Math.abs(h.getTime()-n.getTime()+1)/864e5,startDate:u,endDate:h,step:o,unit:"year",title:d,dateIndex:l};a.push(c),n=new Date(l+o,0,1)}else if(r==="week"){const l=(i=e.startOfWeek)!==null&&i!==void 0?i:"monday";let h=n.getDay();l==="monday"&&(h=h===0?6:h-1);const u=Ai(n),d=Mh(n.getTime()+24*(7*o-h)*60*60*1e3-1,!0);d>t&&d.setTime(t.getTime());const c=RIt(u),f=s?.({dateIndex:c,startDate:u,endDate:d})||c.toString(),g={days:(d.getTime()-u.getTime()+1)/864e5,startDate:u,endDate:d,step:o,unit:"week",title:f,dateIndex:c};a.push(g),n.setTime(Ai(n.getTime()+24*(7*o-h)*60*60*1e3,!0).getTime())}else if(r==="hour"){const l=n.getFullYear(),h=n.getMonth(),u=n.getDate(),d=n.getHours(),c=PIt(new Date(l,h,u,d+o-1),!0);c.getTime()>t.getTime()&&c.setTime(t.getTime());const f=n,g=s?.({dateIndex:d,startDate:f,endDate:c})||d.toString(),p={days:Math.abs(c.getTime()-n.getTime()+1)/864e5,startDate:f,endDate:c,step:o,unit:"hour",title:g,dateIndex:n.getHours()};a.push(p),n=new Date(l,h,u,d+o)}else if(r==="minute"){const l=n.getFullYear(),h=n.getMonth(),u=n.getDate(),d=n.getHours(),c=n.getMinutes(),f=kIt(new Date(l,h,u,d,c+o-1),!0);f.getTime()>t.getTime()&&f.setTime(t.getTime());const g=n,p=s?.({dateIndex:c,startDate:g,endDate:f})||c.toString(),v={days:Math.abs(f.getTime()-n.getTime()+1)/864e5,startDate:g,endDate:f,step:o,unit:"minute",title:p,dateIndex:n.getMinutes()};a.push(v),n=new Date(l,h,u,d,c+o)}else if(r==="second"){const l=n.getFullYear(),h=n.getMonth(),u=n.getDate(),d=n.getHours(),c=n.getMinutes(),f=n.getSeconds(),g=SZ(new Date(l,h,u,d,c,f+o-1),!0);g.getTime()>t.getTime()&&g.setTime(t.getTime());const p=n,v=s?.({dateIndex:f,startDate:p,endDate:g})||f.toString(),m={days:Math.abs(g.getTime()-n.getTime()+1)/864e5,startDate:p,endDate:g,step:o,unit:"second",title:v,dateIndex:n.getSeconds()};a.push(m),n=new Date(l,h,u,d,c,f+o)}return a}function Dy(n,t,e,i,r){var o,s,a,l,h,u,d,c,f;let g=(o=n[3])!==null&&o!==void 0?o:10;t==="right"||t==="end"?g=i-0-((s=n[1])!==null&&s!==void 0?s:10):t==="center"&&(g=0+(i-0+((a=n[3])!==null&&a!==void 0?a:10)-((l=n[1])!==null&&l!==void 0?l:10))/2);let p=0+((h=n[0])!==null&&h!==void 0?h:10);return e==="bottom"||e==="alphabetic"||e==="ideographic"?p=r-0-((u=n[2])!==null&&u!==void 0?u:10):e==="middle"&&(p=0+(r-0-((d=n[0])!==null&&d!==void 0?d:10)-((c=n[2])!==null&&c!==void 0?c:10))/2+((f=n[0])!==null&&f!==void 0?f:10)),{x:g,y:p}}function lHt(n){return typeof n=="string"&&(n=n.replace("%",""),n=parseFloat(n)),isNaN(n)?0:Math.max(0,Math.min(100,Math.round(10*n)/10))}function hHt(n){if(n.taskListTableInstance){n.verticalSplitResizeLine=document.createElement("div"),n.verticalSplitResizeLine.style.position="absolute",n.verticalSplitResizeLine.style.top=n.tableY+"px",n.verticalSplitResizeLine.style.left=(n.taskTableWidth!==-1?n.taskTableWidth-7+n.parsedOptions.verticalSplitLine.lineWidth/2:0)+"px",n.verticalSplitResizeLine.style.width="14px",n.verticalSplitResizeLine.style.height=n.drawHeight+"px",n.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",n.verticalSplitResizeLine.style.zIndex="100",n.parsedOptions.verticalSplitLineMoveable&&(n.verticalSplitResizeLine.style.cursor="col-resize"),n.verticalSplitResizeLine.style.userSelect="none",n.verticalSplitResizeLine.style.opacity="1";const t=document.createElement("div");if(t.style.position="absolute",t.style.top="0px",t.style.left=(14-n.parsedOptions.verticalSplitLine.lineWidth)/2+"px",t.style.width=n.parsedOptions.verticalSplitLine.lineWidth+"px",t.style.height="100%",t.style.backgroundColor=n.parsedOptions.verticalSplitLine.lineColor,t.style.zIndex="100",t.style.userSelect="none",t.style.pointerEvents="none",t.style.transition="background-color 0.3s",n.verticalSplitResizeLine.appendChild(t),n.parsedOptions.verticalSplitLineHighlight){const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left=(14-n.parsedOptions.verticalSplitLineHighlight.lineWidth)/2+"px",e.style.width=n.parsedOptions.verticalSplitLineHighlight.lineWidth+"px",e.style.height="100%",e.style.backgroundColor=n.parsedOptions.verticalSplitLineHighlight.lineColor,e.style.zIndex="100",e.style.cursor="col-resize",e.style.userSelect="none",e.style.pointerEvents="none",e.style.opacity="0",e.style.transition="background-color 0.3s",n.verticalSplitResizeLine.appendChild(e)}n.container.appendChild(n.verticalSplitResizeLine)}}function yC(n){if(n.verticalSplitResizeLine){n.verticalSplitResizeLine.style.position="absolute",n.verticalSplitResizeLine.style.top=n.tableY+"px",n.verticalSplitResizeLine.style.left=n.taskTableWidth!==-1?n.taskTableWidth-7+n.parsedOptions.verticalSplitLine.lineWidth/2+"px":"0px",n.verticalSplitResizeLine.style.width="14px",n.verticalSplitResizeLine.style.height=n.drawHeight+"px",n.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",n.verticalSplitResizeLine.style.zIndex="100",n.parsedOptions.verticalSplitLineMoveable&&(n.verticalSplitResizeLine.style.cursor="col-resize"),n.verticalSplitResizeLine.style.userSelect="none",n.verticalSplitResizeLine.style.opacity="1";const t=n.verticalSplitResizeLine.childNodes[0];if(t.style.position="absolute",t.style.top="0px",t.style.left=(14-n.parsedOptions.verticalSplitLine.lineWidth)/2+"px",t.style.width=n.parsedOptions.verticalSplitLine.lineWidth+"px",t.style.height="100%",t.style.backgroundColor=n.parsedOptions.verticalSplitLine.lineColor,t.style.zIndex="100",t.style.userSelect="none",t.style.pointerEvents="none",t.style.transition="background-color 0.3s",n.verticalSplitResizeLine.childNodes[1]){const e=n.verticalSplitResizeLine.childNodes[1];e.style.position="absolute",e.style.top="0px",e.style.left=(14-n.parsedOptions.verticalSplitLineHighlight.lineWidth)/2+"px",e.style.width=n.parsedOptions.verticalSplitLineHighlight.lineWidth+"px",e.style.height="100%",e.style.backgroundColor=n.parsedOptions.verticalSplitLineHighlight.lineColor,e.style.zIndex="100",e.style.cursor="col-resize",e.style.userSelect="none",e.style.pointerEvents="none",e.style.opacity="0",e.style.transition="background-color 0.3s"}}}function Oa(n,t,e,i="children"){var r;for(let o=0;o<n.length;o++){if(Array.isArray(e)&&e.length===1&&n[o][t]===e[0]||n[o][t]===e)return{record:n[o],index:[o]};if(!((r=n[o][i])===null||r===void 0)&&r.length){if(Array.isArray(e)&&e[0]===n[o][t]){const s=Oa(n[o][i],t,e.slice(1));if(s)return s.index.unshift(o),s}else if(!Array.isArray(e)){const s=Oa(n[o][i],t,e);if(s)return s.index.unshift(o),s}}}}function BZ(n,t="children"){var e;for(let i=0;i<n.length;i++)!((e=n[i][t])===null||e===void 0)&&e.length?BZ(n[i][t],t):(delete n[i].vtable_gantt_linkedTo,delete n[i].vtable_gantt_linkedFrom)}function PZ(n,t="children"){var e;for(let i=0;i<n.length;i++)!((e=n[i][t])===null||e===void 0)&&e.length?PZ(n[i][t],t):delete n[i].vtable_gantt_showIndex}function vo(n,t){var e;let i,r;if(t.taskListTableInstance){const o=t.taskListTableInstance.getTargetRowAt(n+t.headerHeight);if(o){const{row:s}=o;i=s-t.taskListTableInstance.columnHeaderLevelCount;const a=t.getRowsHeightByIndex(0,i-1);if(t.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||t.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||t.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact||t.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate)r=Math.floor((n-a)/t.parsedOptions.rowHeight);else if(t.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline){const l=t.getRecordByIndex(i);l&&l.type===Me.PROJECT&&((e=l.children)===null||e===void 0?void 0:e.length)>0&&(l.hierarchyState==="expand"||t.parsedOptions.projectSubTasksExpandable===!1||(r=Math.floor((n-a)/t.parsedOptions.rowHeight)))}}}else i=Math.floor(n/t.parsedOptions.rowHeight);return{task_index:i,sub_task_index:r}}function uHt(n,t){var e;if(!t.children||t.children.length<=1)return((e=t.children)===null||e===void 0?void 0:e.length)===1?t.children[0].vtable_gantt_showIndex=0:t.vtable_gantt_showIndex=0,1;const i=t.children.slice().sort((o,s)=>{const{startDate:a}=E0(n,o),{startDate:l}=E0(n,s);return a.getTime()-l.getTime()}),r=[];for(let o=0;o<=i.length-1;o++){const s=i[o],{startDate:a,endDate:l}=E0(n,s);let h=!1;for(let u=0;u<r.length;u++)if(a.getTime()>r[u]){r[u]=l.getTime(),h=!0,s.vtable_gantt_showIndex=u;break}h||(r.push(l.getTime()),s.vtable_gantt_showIndex=r.length-1)}return r.length}function dHt(n,t,e,i){return e.some(r=>{const{startDate:o,endDate:s}=E0(i,r);return n<=s&&o<=t})}function cHt(n,t){var e;if(!t.children||t.children.length<=1)return((e=t.children)===null||e===void 0?void 0:e.length)===1?t.children[0].vtable_gantt_showIndex=0:t.vtable_gantt_showIndex=0,1;const i=[];for(let r=0;r<=t.children.length-1;r++){const o=t.children[r],{startDate:s,endDate:a}=E0(n,o);let l=!1;for(let h=0;h<i.length;h++)if(!dHt(s,a,t.children.filter(u=>u!==o&&u.vtable_gantt_showIndex===h),n)){i[h]=a.getTime(),l=!0,o.vtable_gantt_showIndex=h;break}l||(i.push(a.getTime()),o.vtable_gantt_showIndex=i.length-1)}return i.length}function E0(n,t){const{timeScaleIncludeHour:e,startDateField:i,endDateField:r}=n.parsedOptions,o=t[i],s=t[r];return e?{startDate:Ai(o),endDate:Mh(s)}:{startDate:Ai(o,!0),endDate:Mh(s,!0)}}function fHt(n){var t,e,i,r,o,s,a;const l=n.options,{unit:h,startOfWeek:u}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.markLine=_D(l?.markLine),(e=(t=n.parsedOptions.markLine)===null||t===void 0?void 0:t.length)!==null&&e!==void 0&&e&&(!((i=n.parsedOptions.markLine)===null||i===void 0)&&i.every(d=>d.scrollToMarkLine===void 0)&&(n.parsedOptions.markLine[0].scrollToMarkLine=!0),!((r=n.parsedOptions.markLine)===null||r===void 0)&&r.find(d=>d.scrollToMarkLine)&&(n.parsedOptions.scrollToMarkLineDate=_c(new Date((o=n.parsedOptions.markLine)===null||o===void 0?void 0:o.find(d=>d.scrollToMarkLine).date),h,u))),n.parsedOptions.dependencyLinks=(a=(s=l.dependency)===null||s===void 0?void 0:s.links)!==null&&a!==void 0?a:[]}function gHt(n){var t,e;const i=n.options,{unit:r,startOfWeek:o,step:s}=n.parsedOptions.reverseSortedTimelineScales[0];n.parsedOptions.minDate=i?.minDate?_c(new Date(i.minDate),r,o):void 0,n.parsedOptions.maxDate=i?.maxDate?ap(n.parsedOptions.minDate,new Date(i.maxDate),r,s):void 0,n.parsedOptions._minDateTime=(t=n.parsedOptions.minDate)===null||t===void 0?void 0:t.getTime(),n.parsedOptions._maxDateTime=(e=n.parsedOptions.maxDate)===null||e===void 0?void 0:e.getTime()}function XR(n){const t=n.options;n.parsedOptions.markLine=_D(t?.markLine)}function pHt(n,t,e){const i=vo(t-e.headerHeight+e.stateManager.scrollTop,e),r=e.getRecordByIndex(i.task_index),o=og(n,e),s=e.getDateRangeByIndex(o);if(r?.children){const a=vo(t-e.headerHeight+e.stateManager.scrollTop,e);for(let l=0;l<r.children.length;l++){const{startDate:h,endDate:u,taskDays:d,progress:c,taskRecord:f}=e.getTaskInfoByTaskListIndex(a.task_index,l);if(((e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact||e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange)&&f.vtable_gantt_showIndex===a.sub_task_index||e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||e.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline&&r.type===Me.PROJECT&&r.hierarchyState!=="expand"&&e.parsedOptions.projectSubTasksExpandable!==!1)&&h&&u&&s.startDate.getTime()>=h.getTime()&&s.endDate.getTime()<=u.getTime())return{startDate:h,endDate:u,taskDays:d,progress:c,taskRecord:f}}}}function R6(n,t){return{left:n.globalTransMatrix.e+t.taskListTableInstance.tableNoFrameWidth+t.taskListTableInstance.tableX+t.tableX,top:n.globalTransMatrix.f,width:n.attribute.width,height:n.attribute.height}}function vHt(n,t){const e=n.startDate.getTime(),i=n.endDate.getTime();return t.some(r=>{const o=new Date(r.date).getTime();return o>=e&&o<=i})}function mHt(n){if(!n.records||n.records.length===0)return;const t=n.parsedOptions.startDateField,e=n.parsedOptions.endDateField,i=(r,o,s)=>{let a=null,l=null;return r.forEach((h,u)=>{var d;if(!h)return;let c=null,f=null;if(h.children&&h.children.length>0&&h.type===Me.PROJECT){const[g,p]=i(h.children);if(g&&p&&(c=g,f=p,h.type===Me.PROJECT)){const v=(d=n.parsedOptions.dateFormat)!==null&&d!==void 0?d:n.parseTimeFormat(h[t]||h.children[0][t]||""),m=b=>n.formatDate?n.formatDate(b,v):b.toISOString().split("T")[0],y=Object.assign({},h);y[t]=m(c),y[e]=m(f),r[u]=y}}else h[t]&&h[e]&&(c=new Date(h[t]),f=new Date(h[e]));c&&(!a||c<a)&&(a=c),f&&(!l||f>l)&&(l=f)}),[a,l]};i(n.records)}const yHt='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1471" width="24" height="24"> <path d="M840.05 153.35a27.61875 27.61875 0 0 0-22.95-4.95c-56.25 13.05-218.25 39.6-289.8 2.25-115.65-60.75-241.65-31.95-299.7-13.05V95.75a27.05625 27.05625 0 0 0-27-27 27.05625 27.05625 0 0 0-27 27v834.75c0 14.85 12.15 27 27 27s27-12.15 27-27V611.9c44.1-13.95 199.35-56.25 293.85 1.8 45.9 28.35 96.75 37.8 143.55 37.8 89.1 0 164.7-34.2 169.65-36.45a27.9 27.9 0 0 0 15.75-24.75V174.5a27.5625 27.5625 0 0 0-10.35-21.15z" fill="#f54319" p-id="1472"></path></svg>';class bHt{constructor(t){this._scene=t,this.initNodes()}initNodes(){var t,e,i,r,o,s,a,l,h,u,d;const{_scene:c}=this,f=new ge({x:0,y:0,width:c._gantt.getAllDateColsWidth(),height:c._gantt.getAllHeaderRowsHeight(),clip:!0,pickable:!1});this.group=f,f.name="date-header-container",c.ganttGroup.addChild(this.group);const{unit:g,step:p}=c._gantt.parsedOptions.reverseSortedTimelineScales[0];let v=0;for(let m=0;m<c._gantt.timeLineHeaderLevel;m++){const{timelineDates:y,customLayout:b,visible:_}=c._gantt.parsedOptions.sortedTimelineScales[m];if(_===!1)continue;const w=new ge({x:0,y:v,width:c._gantt.getAllDateColsWidth(),height:c._gantt.parsedOptions.timeLineHeaderRowHeights[m],clip:!1});v+=w.attribute.height,w.name="row-header",f.addChild(w);for(let C=0;C<y?.length;C++){const{days:x,endDate:S,startDate:A,title:T,dateIndex:M,unit:R}=y[C],E=Math.ceil(Oe(A,c._gantt.parsedOptions.minDate,g,p)*c._gantt.parsedOptions.timelineColWidth),P=Math.ceil(Oe(S,c._gantt.parsedOptions.minDate,g,p,1)*c._gantt.parsedOptions.timelineColWidth)-E,B=new ge({x:E,y:0,width:P,height:w.attribute.height,clip:!1,fill:c._gantt.parsedOptions.timelineHeaderBackgroundColor});let k;B.name="date-header-cell";let L=!0;const O=w.attribute.height;if(b){let D;typeof b=="function"?D=b({width:P,height:O,index:C,startDate:A,endDate:S,days:x,dateIndex:M,title:T,ganttInstance:this._scene._gantt}):D=b,D&&(k=D.rootContainer,L=(t=D.renderDefaultText)!==null&&t!==void 0&&t,k.name="task-bar-custom-render"),k&&B.appendChild(k)}if(L){const{padding:D,textAlign:I,textBaseline:H,textOverflow:F,fontSize:G,fontWeight:j,color:W,strokeColor:K,textStick:J}=c._gantt.parsedOptions.timelineHeaderStyles[m],q=Dy(Oy(D),I,H,P,O),X=new si({x:q.x,y:q.y,maxLineWidth:P,heightLimit:O,pickable:!0,text:T.toLocaleString(),fontSize:G,fontWeight:j,fill:W,stroke:K,lineWidth:2,textAlign:I,textBaseline:H,ellipsis:F==="clip"?"":F==="ellipsis"?"...":Y(F)?F:void 0});X.attribute.textStick=J,B.appendChild(X),X.name="date-header-cell-text"}if(m===c._gantt.timeLineHeaderLevel-1&&c._gantt.parsedOptions.markLineCreateOptions&&c._gantt.parsedOptions.markLineCreateOptions.markLineCreatable){const D=c._gantt.parsedOptions.markLineCreateOptions.markLineCreationStyle||{},I=D.size||24,H=D.iconSize||18,F=D.svg||yHt,G=new ge({x:P/2-I/2,y:O/2-I/2,width:I,height:I,visiable:!0});G.name="markline-hover-group",G.data=y[C];const j=new ge({x:0,y:0,width:I,height:I,cornerRadius:I/2,fill:D.fill||"#ccc",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",visibleAll:!1});j.name="markline-hover-inner-group",G.add(j);const W=new Ga({width:H,height:H,image:F,cursor:"pointer",pickable:!0});W.name="markline-hover-icon",j.appendChild(W),B.add(G)}if(w.addChild(B),C>0){const D=Ri({pickable:!1,stroke:(e=c._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||e===void 0?void 0:e.lineColor,lineWidth:(i=c._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||i===void 0?void 0:i.lineWidth,lineDash:(r=c._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||r===void 0?void 0:r.lineDash,points:[{x:1&((o=c._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||o===void 0?void 0:o.lineWidth)?.5:0,y:0},{x:1&((s=c._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||s===void 0?void 0:s.lineWidth)?.5:0,y:w.attribute.height}]});B.appendChild(D)}}if(m>0){const C=Ri({pickable:!1,stroke:(a=c._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||a===void 0?void 0:a.lineColor,lineWidth:(l=c._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||l===void 0?void 0:l.lineWidth,lineDash:(h=c._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||h===void 0?void 0:h.lineDash,points:[{x:0,y:1&((u=c._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||u===void 0?void 0:u.lineWidth)?.5:0},{x:c._gantt.getAllDateColsWidth(),y:1&((d=c._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||d===void 0?void 0:d.lineWidth)?.5:0}]});w.addChild(C)}}}setX(t){this.group.setAttribute("x",t)}setY(t){this.group.setAttribute("y",t)}resize(){var t,e,i,r;this.group.setAttribute("width",(e=(t=this.group.attribute)===null||t===void 0?void 0:t.width)!==null&&e!==void 0?e:0),this.group.setAttribute("height",(r=(i=this.group.attribute)===null||i===void 0?void 0:i.height)!==null&&r!==void 0?r:0)}refresh(){var t;(t=this.group)===null||t===void 0||t.parent.removeChild(this.group),this.initNodes()}showMarklineIcon(t){let e;return t.children.forEach(i=>{i.name==="date-header-cell-text"&&i.setAttribute("visible",!1),i.name==="markline-hover-group"&&(e=i.firstChild,e.setAttribute("visibleAll",!0))}),e}hideMarklineIconHover(t){let e;return t.children.forEach(i=>{i.name==="date-header-cell-text"&&i.setAttribute("visible",!0),i.name==="markline-hover-group"&&(e=i.firstChild,e.setAttribute("visibleAll",!1))}),e}}var Ft;(function(n){n.default="default",n.grabing="grabing",n.scrolling="scrolling"})(Ft||(Ft={}));var Ae;(function(n){n.single="single",n.column="column",n.row="row",n.cross="cross",n.none="none"})(Ae||(Ae={}));const _Ht=["bgColor","color","strokeColor","borderColor","linkColor"];var ki;(function(n){n.RECORD="RECORD",n.NONE="NONE",n.SUM="SUM",n.MIN="MIN",n.MAX="MAX",n.AVG="AVG",n.COUNT="COUNT",n.CUSTOM="CUSTOM",n.RECALCULATE="RECALCULATE"})(ki||(ki={}));var B6;(function(n){n.ASC="ASC",n.DESC="DESC",n.NORMAL="NORMAL",n.desc="desc",n.asc="asc",n.normal="normal"})(B6||(B6={}));var ao;(function(n){n.top="top",n.bottom="bottom",n.left="left",n.right="right"})(ao||(ao={}));var Lt;(function(n){n.expand="expand",n.collapse="collapse",n.none="none",n.loading="loading"})(Lt||(Lt={}));var He;(function(n){n.inlineFront="inlineFront",n.inlineEnd="inlineEnd",n.left="left",n.right="right",n.absoluteRight="absoluteRight",n.contentLeft="contentLeft",n.contentRight="contentRight",n.absolute="absolute"})(He||(He={}));var Fe;(function(n){n.frozen="frozen",n.sort="sort",n.dropDown="dropDown",n.dropDownState="dropDownState",n.play="play",n.damagePic="damagePic",n.expand="expand",n.collapse="collapse",n.drillDown="drillDown",n.drillUp="drillUp",n.dragReorder="dragReorder"})(Fe||(Fe={}));var Un;(function(n){n.upwardIconName="sort_upward",n.downwardIconName="sort_downward",n.normalIconName="sort_normal",n.freezeIconName="freeze",n.frozenIconName="frozen",n.frozenCurrentIconName="frozenCurrent",n.dropdownIconName="dropdownIcon",n.expandIconName="expand",n.collapseIconName="collapse",n.dragReorderIconName="dragReorder",n.loadingIconName="loading"})(Un||(Un={}));class mu{constructor(t){var e;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.children=[],this.key=t.key,this.field=t.field,this.formatFun=t.formatFun,this.isRecord=(e=t.isRecord)!==null&&e!==void 0?e:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(t,e,i){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),t,e,i):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.clearCacheValue()}}class CHt extends mu{constructor(){super(...arguments),this.type=ki.RECORD,this.isRecord=!0}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t))),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.clearCacheValue())}value(){var t;return(t=this.changedValue)!==null&&t!==void 0?t:this.records}reset(){this.children=[],this.changedValue=void 0,this.records=[]}recalculate(){}}class wHt extends mu{constructor(){super(...arguments),this.type=ki.NONE,this.isRecord=!0}push(t){t&&(this.isRecord&&(this.records=[t]),t.isAggregator&&this.children&&(this.children=[t]),this.field&&(this.fieldValue=t[this.field])),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){var t;return(t=this.changedValue)!==null&&t!==void 0?t:this.fieldValue}reset(){this.children=[],this.changedValue=void 0,this.records=[],this.fieldValue=void 0}recalculate(){}}class xHt extends mu{constructor(t){super(t),this.type=ki.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=t.aggregationFun}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children&&this.children.push(t),this.field&&this.values.push(t[this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.field&&this.records.length&&(this.values=this.records.map(i=>i[this.field])),this.clearCacheValue())}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.field&&this.records.length&&(this.values=this.records.map(e=>e[this.field]))),this.clearCacheValue()}value(){var t,e;return this.fieldValue||(this.fieldValue=(t=this.aggregationFun)===null||t===void 0?void 0:t.call(this,this.values,this.records,this.field)),(e=this.changedValue)!==null&&e!==void 0?e:this.fieldValue}reset(){this.records=[],this.children=[],this.changedValue=void 0,this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}}class SHt extends mu{constructor(t){var e;super(t),this.type=ki.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=(e=t.needSplitPositiveAndNegative)!==null&&e!==void 0&&e}push(t){if(t){if(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&this.children){this.children.push(t);const e=t.value();this.sum+=e??0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const e=parseFloat(t[this.field]);this.sum+=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}this.clearCacheValue()}deleteRecord(t){if(t){if(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children){this.children=this.children.filter(i=>i!==t);const e=t.value();this.sum-=e??0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const e=parseFloat(t[this.field]);this.sum-=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}}this.clearCacheValue()}updateRecord(t,e){if(t&&e){if(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&this.children){const i=t.value();this.children=this.children.filter(o=>o!==t);const r=e.value();this.children.push(e),this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const i=parseFloat(t[this.field]),r=parseFloat(e[this.field]);this.sum+=r-i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum-=i:i<0&&(this.nagetiveSum-=i),r>0?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))}this.clearCacheValue()}}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.sum+=i??0,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum+=i:i<0&&(this.nagetiveSum+=i))}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];if(e.isAggregator){const i=e.value();this.sum+=i??0,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum+=i:i<0&&(this.nagetiveSum+=i))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){const i=parseFloat(e[this.field]);this.sum+=i,this.needSplitPositiveAndNegativeForSum&&(i>0?this.positiveSum+=i:i<0&&(this.nagetiveSum+=i))}}}}class AHt extends mu{constructor(){super(...arguments),this.type=ki.COUNT,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.count+=t.value()):this.count++),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.count-=t.value()):this.count--),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&(this.count+=e.value()-t.value()),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)))}value(){var t;return(t=this.changedValue)!==null&&t!==void 0?t:this.count}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.count+=i??0}else this.count++}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.count+=e.value():this.count++}}}class THt extends mu{constructor(){super(...arguments),this.type=ki.AVG,this.sum=0,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&t.type===ki.AVG?(this.children&&this.children.push(t),this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&t.type===ki.AVG?(this.children&&(this.children=this.children.filter(e=>e!==t)),this.sum-=t.sum,this.count-=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum-=parseFloat(t[this.field]),this.count--)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&t.type===ki.AVG?(this.children&&e.isAggregator&&(this.children=this.children.map(i=>i===t?e:i)),this.sum+=e.sum-t.sum,this.count+=e.count-t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(e[this.field])-parseFloat(t[this.field])),this.clearCacheValue())}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.sum/this.count:void 0}reset(){this.changedValue=void 0,this.children=[],this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator&&e.type===ki.AVG){const i=e.value();this.sum+=i*e.count,this.count+=e.count}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator&&e.type===ki.AVG?(this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)}}}class MHt extends mu{constructor(){super(...arguments),this.type=ki.MAX,this.max=Number.MIN_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.max=t.max>this.max?t.max:this.max):typeof t=="number"?this.max=t>this.max?t:this.max:this.field&&typeof t[this.field]=="number"?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.max:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.max=Math.max(this.max,i)}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.max=e.max>this.max?e.max:this.max:typeof e=="number"?this.max=e>this.max?e:this.max:this.field&&typeof e[this.field]=="number"?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)}}}class RHt extends mu{constructor(){super(...arguments),this.type=ki.MIN,this.min=Number.MAX_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?(this.children&&this.children.push(t),this.min=t.min<this.min?t.min:this.min):typeof t=="number"?this.min=t<this.min?t:this.min:this.field&&typeof t[this.field]=="number"?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&this.children&&(this.children=this.children.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(i=>i===t?e:i)),t.isAggregator&&e.isAggregator&&this.children&&(this.children=this.children.map(i=>i===t?e:i)),this.recalculate())}value(){var t,e;return(t=this.changedValue)!==null&&t!==void 0?t:((e=this.records)===null||e===void 0?void 0:e.length)>=1?this.min:void 0}reset(){this.records=[],this.changedValue=void 0,this.children=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.children&&this.children.length>0)for(let t=0;t<this.children.length;t++){const e=this.children[t];if(e.isAggregator){const i=e.value();this.min=Math.min(this.min,i)}}else if(this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.min=e.min<this.min?e.min:this.min:typeof e=="number"?this.min=e<this.min?e:this.min:this.field&&typeof e[this.field]=="number"?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)}}}let BHt=1,AA=class{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,e){const i=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]);i.push(e);const r=BHt++;return this.listenersData.listenerData[r]={type:t,listener:e,remove:()=>{delete this.listenersData.listenerData[r];const o=i.indexOf(e);i.splice(o,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},r}off(t,e){var i;if(e){const r=t;this.removeEventListener(r,e)}else{const r=t;if(!this.listenersData)return;(i=this.listenersData.listenerData[r])===null||i===void 0||i.remove()}}addEventListener(t,e,i){this.on(t,e)}removeEventListener(t,e){if(this.listenersData)for(const i in this.listenersData.listenerData){const r=this.listenersData.listenerData[i];r.type===t&&r.listener===e&&this.off(i)}}hasListeners(t){return!!this.listenersData&&!!this.listenersData.listeners[t]}fireListeners(t,e){if(!this.listenersData)return[];const i=this.listenersData.listeners[t];return i?i.map(r=>r.call(this,e)).filter(r=>Y(r)):[]}release(){delete this.listenersData}},P6;const PHt={CHANGE_STYLE:"change_style"};let Qs=class Gk extends AA{static get EVENT_TYPE(){return PHt}static get DEFAULT(){return P6||(P6=new Gk)}constructor(t={},e={}){var i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L;super(),this._defaultPadding=[10,16,10,16],this._textAlign=(i=t?.textAlign)!==null&&i!==void 0?i:e?.textAlign,this._textBaseline=(r=t?.textBaseline)!==null&&r!==void 0?r:e?.textBaseline,this._color=(o=t?.color)!==null&&o!==void 0?o:e?.color,this._strokeColor=(s=t?.strokeColor)!==null&&s!==void 0?s:e?.strokeColor,this._fontSize=(a=t.fontSize)!==null&&a!==void 0?a:e?.fontSize,this._fontFamily=(l=t.fontFamily)!==null&&l!==void 0?l:e?.fontFamily,this._fontWeight=(h=t.fontWeight)!==null&&h!==void 0?h:e?.fontWeight,this._fontVariant=(u=t.fontVariant)!==null&&u!==void 0?u:e?.fontVariant,this._fontStyle=(d=t.fontStyle)!==null&&d!==void 0?d:e?.fontStyle,this._padding=(f=(c=t?.padding)!==null&&c!==void 0?c:e?.padding)!==null&&f!==void 0?f:this._defaultPadding,this._borderColor=(g=t?.borderColor)!==null&&g!==void 0?g:e?.borderColor,this._textOverflow=(p=t?.textOverflow)!==null&&p!==void 0?p:e?.textOverflow,this._textStick=(m=(v=t.textStick)!==null&&v!==void 0?v:e?.textStick)!==null&&m!==void 0&&m,this._textStickBaseOnAlign=(b=(y=t.textStickBaseOnAlign)!==null&&y!==void 0?y:e?.textStickBaseOnAlign)!==null&&b!==void 0&&b,this._bgColor=(_=t?.bgColor)!==null&&_!==void 0?_:e?.bgColor,this._lineHeight=(w=t?.lineHeight)!==null&&w!==void 0?w:e?.lineHeight,this._underline=(C=t?.underline)!==null&&C!==void 0?C:e?.underline,this._underlineColor=(x=t?.underlineColor)!==null&&x!==void 0?x:e?.underlineColor,this._underlineDash=(S=t?.underlineDash)!==null&&S!==void 0?S:e?.underlineDash,this._underlineOffset=(A=t?.underlineOffset)!==null&&A!==void 0?A:e?.underlineOffset,this._lineThrough=(T=t?.lineThrough)!==null&&T!==void 0?T:e?.lineThrough,this._lineThroughColor=(M=t?.lineThroughColor)!==null&&M!==void 0?M:e?.lineThroughColor,this._lineThroughDash=(R=t?.lineThroughDash)!==null&&R!==void 0?R:e?.lineThroughDash,this._linkColor=(E=t?.linkColor)!==null&&E!==void 0?E:e?.linkColor,this._cursor=(P=t.cursor)!==null&&P!==void 0?P:e?.cursor,this._borderLineWidth=(B=t.borderLineWidth)!==null&&B!==void 0?B:e?.borderLineWidth,this._borderLineDash=(k=t.borderLineDash)!==null&&k!==void 0?k:e?.borderLineDash,this._marked=(L=t.marked)!==null&&L!==void 0?L:e?.marked}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get padding(){return this._padding}set padding(t){this._padding=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}get marked(){return this._marked}set marked(t){this._marked=t}clone(){return new Gk(this,null)}},k6,kHt=class $k extends Qs{static get DEFAULT(){return k6||(k6=new $k)}constructor(t={},e={}){super(t,e)}clone(){return new $k(this,null)}},E6;class Um extends Qs{static get DEFAULT(){return E6||(E6=new Um)}constructor(t={},e={}){var i,r;super(t,e),this._autoWrapText=(i=t?.autoWrapText)!==null&&i!==void 0?i:e?.autoWrapText,this._lineClamp=(r=t?.lineClamp)!==null&&r!==void 0?r:e?.lineClamp}clone(){return new Um(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let L6,jk=class bC extends Qs{static get DEFAULT(){return L6||(L6=new bC)}constructor(t={},e={},i={}){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A;super(t,e),this._size=((o=(r=t?.size)!==null&&r!==void 0?r:e?.size)!==null&&o!==void 0?o:i?.size)||14,this._spaceBetweenTextAndIcon=((a=(s=t?.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e?.spaceBetweenTextAndIcon)!==null&&a!==void 0?a:i?.spaceBetweenTextAndIcon)||8,this._defaultFill=(h=(l=t?.checkboxStyle)===null||l===void 0?void 0:l.defaultFill)!==null&&h!==void 0?h:i?.defaultFill,this._defaultStroke=(d=(u=t?.checkboxStyle)===null||u===void 0?void 0:u.defaultStroke)!==null&&d!==void 0?d:i?.defaultStroke,this._disableFill=(f=(c=t?.checkboxStyle)===null||c===void 0?void 0:c.disableFill)!==null&&f!==void 0?f:i?.disableFill,this._checkedFill=(p=(g=t?.checkboxStyle)===null||g===void 0?void 0:g.checkedFill)!==null&&p!==void 0?p:i?.checkedFill,this._checkedStroke=(m=(v=t?.checkboxStyle)===null||v===void 0?void 0:v.checkedStroke)!==null&&m!==void 0?m:i?.checkedStroke,this._disableCheckedFill=(b=(y=t?.checkboxStyle)===null||y===void 0?void 0:y.disableCheckedFill)!==null&&b!==void 0?b:i?.disableCheckedFill,this._disableCheckedStroke=(w=(_=t?.checkboxStyle)===null||_===void 0?void 0:_.disableCheckedStroke)!==null&&w!==void 0?w:i?.disableCheckedStroke,this._checkIconImage=(x=(C=t?.checkboxStyle)===null||C===void 0?void 0:C.checkIconImage)!==null&&x!==void 0?x:i?.checkIconImage,this._indeterminateIconImage=(A=(S=t?.checkboxStyle)===null||S===void 0?void 0:S.indeterminateIconImage)!==null&&A!==void 0?A:i?.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new bC(t,this)}clone(){return new bC(this)}},O6;class Xd extends Qs{static get DEFAULT(){return O6||(O6=new Xd)}constructor(t={},e={},i={}){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M;super(t,e),this._size=((o=(r=t?.size)!==null&&r!==void 0?r:e?.size)!==null&&o!==void 0?o:i?.size)||14,this._spaceBetweenTextAndIcon=((a=(s=t?.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e?.spaceBetweenTextAndIcon)!==null&&a!==void 0?a:i?.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=((h=(l=t?.spaceBetweenRadio)!==null&&l!==void 0?l:e?.spaceBetweenRadio)!==null&&h!==void 0?h:i?.spaceBetweenRadio)||2,this._innerRadius=(d=(u=t?.radioStyle)===null||u===void 0?void 0:u.innerRadius)!==null&&d!==void 0?d:i?.innerRadius,this._outerRadius=(f=(c=t?.radioStyle)===null||c===void 0?void 0:c.outerRadius)!==null&&f!==void 0?f:i?.outerRadius,this._defaultFill=(p=(g=t?.radioStyle)===null||g===void 0?void 0:g.defaultFill)!==null&&p!==void 0?p:i?.defaultFill,this._defaultStroke=(m=(v=t?.radioStyle)===null||v===void 0?void 0:v.defaultStroke)!==null&&m!==void 0?m:i?.defaultStroke,this._disableFill=(b=(y=t?.radioStyle)===null||y===void 0?void 0:y.disableFill)!==null&&b!==void 0?b:i?.disableFill,this._checkedFill=(w=(_=t?.radioStyle)===null||_===void 0?void 0:_.checkedFill)!==null&&w!==void 0?w:i?.checkedFill,this._checkedStroke=(x=(C=t?.radioStyle)===null||C===void 0?void 0:C.checkedStroke)!==null&&x!==void 0?x:i?.checkedStroke,this._disableCheckedFill=(A=(S=t?.radioStyle)===null||S===void 0?void 0:S.disableCheckedFill)!==null&&A!==void 0?A:i?.disableCheckedFill,this._disableCheckedStroke=(M=(T=t?.radioStyle)===null||T===void 0?void 0:T.disableCheckedStroke)!==null&&M!==void 0?M:i?.disableCheckedStroke}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(t){this._spaceBetweenRadio=t}get innerRadius(){return this._innerRadius}set innerRadius(t){this._innerRadius=t}get outerRadius(){return this._outerRadius}set outerRadius(t){this._outerRadius=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}getStyle(t){return new Xd(t,this)}clone(){return new Xd(this)}}let D6;class Yd extends Qs{static get DEFAULT(){return D6||(D6=new Yd)}constructor(t={},e={},i={}){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w;super(t,e),this._spaceBetweenTextAndCircle=((o=(r=t?.spaceBetweenTextAndCircle)!==null&&r!==void 0?r:e?.spaceBetweenTextAndCircle)!==null&&o!==void 0?o:i?.spaceBetweenTextAndCircle)||6,this._circleRadius=((a=(s=t?.switchStyle)===null||s===void 0?void 0:s.circleRadius)!==null&&a!==void 0?a:i?.circleRadius)||8,this._boxWidth=((h=(l=t?.switchStyle)===null||l===void 0?void 0:l.boxWidth)!==null&&h!==void 0?h:i?.boxWidth)||40,this._boxHeight=((d=(u=t?.switchStyle)===null||u===void 0?void 0:u.boxHeight)!==null&&d!==void 0?d:i?.boxHeight)||24,this._checkedFill=((f=(c=t?.switchStyle)===null||c===void 0?void 0:c.checkedFill)!==null&&f!==void 0?f:i?.checkedFill)||"#165DFF",this._uncheckedFill=((p=(g=t?.switchStyle)===null||g===void 0?void 0:g.uncheckedFill)!==null&&p!==void 0?p:i?.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=((m=(v=t?.switchStyle)===null||v===void 0?void 0:v.disableCheckedFill)!==null&&m!==void 0?m:i?.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=((b=(y=t?.switchStyle)===null||y===void 0?void 0:y.disableUncheckedFill)!==null&&b!==void 0?b:i?.disableUncheckedFill)||"#f2f3f5",this._circleFill=((w=(_=t?.switchStyle)===null||_===void 0?void 0:_.circleFill)!==null&&w!==void 0?w:i?.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(t){this._spaceBetweenTextAndCircle=t}get circleRadius(){return this._circleRadius}set circleRadius(t){this._circleRadius=t}get boxWidth(){return this._boxWidth}set boxWidth(t){this._boxWidth=t}get boxHeight(){return this._boxHeight}set boxHeight(t){this._boxHeight=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(t){this._uncheckedFill=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(t){this._disableUncheckedFill=t}get circleFill(){return this._circleFill}set circleFill(t){this._circleFill=t}getStyle(t){return new Yd(t,this)}clone(){return new Yd(this)}}let I6;class Kd extends Qs{static get DEFAULT(){return I6||(I6=new Kd)}constructor(t={},e={},i={}){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A;super(t,e),this._buttonColor=((o=(r=t?.buttonStyle)===null||r===void 0?void 0:r.buttonColor)!==null&&o!==void 0?o:i?.buttonColor)||"#165DFF",this._buttonBorderColor=((a=(s=t?.buttonStyle)===null||s===void 0?void 0:s.buttonBorderColor)!==null&&a!==void 0?a:i?.buttonBorderColor)||"#165DFF",this._buttonLineWidth=((h=(l=t?.buttonStyle)===null||l===void 0?void 0:l.buttonLineWidth)!==null&&h!==void 0?h:i?.buttonLineWidth)||1,this._buttonBorderRadius=((d=(u=t?.buttonStyle)===null||u===void 0?void 0:u.buttonBorderRadius)!==null&&d!==void 0?d:i?.buttonBorderRadius)||2,this._buttonHoverColor=((f=(c=t?.buttonStyle)===null||c===void 0?void 0:c.buttonHoverColor)!==null&&f!==void 0?f:i?.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=((p=(g=t?.buttonStyle)===null||g===void 0?void 0:g.buttonHoverBorderColor)!==null&&p!==void 0?p:i?.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=(m=(v=t?.buttonStyle)===null||v===void 0?void 0:v.buttonTextHoverColor)!==null&&m!==void 0?m:i?.buttonTextHoverColor,this._buttonDisableColor=((b=(y=t?.buttonStyle)===null||y===void 0?void 0:y.buttonDisableColor)!==null&&b!==void 0?b:i?.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=((w=(_=t?.buttonStyle)===null||_===void 0?void 0:_.buttonDisableBorderColor)!==null&&w!==void 0?w:i?.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=(x=(C=t?.buttonStyle)===null||C===void 0?void 0:C.buttonTextDisableColor)!==null&&x!==void 0?x:i?.buttonTextDisableColor,this._buttonPadding=((A=(S=t?.buttonStyle)===null||S===void 0?void 0:S.buttonPadding)!==null&&A!==void 0?A:i?.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(t){this._buttonColor=t}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(t){this._buttonBorderColor=t}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(t){this._buttonLineWidth=t}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(t){this._buttonBorderRadius=t}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(t){this._buttonHoverColor=t}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(t){this._buttonHoverBorderColor=t}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(t){this._buttonTextHoverColor=t}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(t){this._buttonDisableColor=t}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(t){this._buttonDisableBorderColor=t}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(t){this._buttonTextDisableColor=t}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(t){this._buttonTextHoverBorderColor=t}get buttonPadding(){return this._buttonPadding}set buttonPadding(t){this._buttonPadding=t}getStyle(t){return new Kd(t,this)}clone(){return new Kd(this)}}const{EVENT_TYPE:Y7t}=Qs;function CD(n,t,e,i=Qs,r,o){var s,a,l,h;return n||t?n instanceof Qs?n:typeof n=="function"?CD(n(e),t,e,i,r,o):(n||(n={}),r&&!Y(n.autoWrapText)&&(n.autoWrapText=!0),i===jk?new jk(n??{},t??{},(s=o.checkboxStyle)!==null&&s!==void 0?s:{}):i===Xd?new Xd(n??{},t??{},(a=o.radioStyle)!==null&&a!==void 0?a:{}):i===Yd?new Yd(n??{},t??{},(l=o.switchStyle)!==null&&l!==void 0?l:{}):i===Kd?new Kd(n??{},t??{},(h=o.buttonStyle)!==null&&h!==void 0?h:{}):new i(n??{},t??{})):i.DEFAULT}class ye{static get mode(){return ye._mode||(ye._mode=EHt()),ye._mode}static set mode(t){ye._mode=t}static RegisterCreateCanvas(t){ye.CreateCanvas=t}static RegisterLoadImage(t){ye.LoadImage=t}static GetCreateCanvasFunc(){return ye.CreateCanvas?ye.CreateCanvas:ye.mode==="worker"?(t=200,e=200)=>new OffscreenCanvas(t,e):void 0}static RegisterRequestAnimationFrame(t){ye.RequestAnimationFrame=t()}static GetRequestAnimationFrame(){if(ye.RequestAnimationFrame)return ye.RequestAnimationFrame}static RegisterCancelAnimationFrame(t){ye.CancelAnimationFrame=t()}static GetCancelAnimationFrame(){if(ye.CancelAnimationFrame)return ye.CancelAnimationFrame}}function EHt(){let n="browser";try{window.type==="node"?n="node":typeof window>"u"||window.performance?typeof window>"u"&&(n="node"):n="miniApp"}catch{n="node"}return n}ye.dpr=0;function LHt(){try{const n=window.getSelection();if(n){if(typeof n.removeAllRanges=="function")return void n.removeAllRanges();if(typeof n.empty=="function")return void n.empty();if(typeof n.collapse=="function")return void n.collapse(document.body,0)}}catch{}}function OHt(){if(ye.mode==="node")return;const n=document.createElement("style");n.id="vtable-style-styleSheet",n.textContent=`
.vtable .input-container {
	position: absolute;
	top:0px;
}
.vtable .table-scrollable {
	position: absolute;
	overflow: scroll;
}
.vtable .table-scrollable::-webkit-scrollbar-button{
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-track-piece{
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-corner {
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-thumb {
	border-radius      : 4px;
	background-color   : rgba(100, 100, 100, .5);
}

.vtable .table-scroll-end-point {
	opacity: 0;
	position: relative;
}
.vtable {
	/* overflow: auto  auto domvtable ;auto  */
	/* overflow: auto; */
	position: relative;
	width: 100%;
	height: 100%;
	text-align: left;
  -webkit-font-smoothing:auto;

  overflow: hidden; // for react-vtable dom custom element
}

.vtable-gantt {
	/* overflow: auto  auto domvtable ;auto  */
	/* overflow: auto; */
	position: absolute;
	width: 100%;
	height: 100%;
	text-align: left;
  -webkit-font-smoothing:auto;

  overflow: hidden; // for react-vtable dom custom element
}
.vtable .table-component-container {
  pointer-events: none;
  overflow: hidden;
  position: absolute;
  top: 0px;
  left: 0px;
}
.vtable > canvas {
	position: absolute;
	width: 0;
	height: 0;
}
.vtable .table-focus-control {
	position: relative !important;
	width: 1px;
	height: 1px;
	opacity: 0;
	padding: 0;
	margin: 0;
	box-sizing: border-box;
	pointer-events: none;
	max-width: 500px;
	max-height: 500px;
	float: none !important;
}
.vtable input.table-focus-control::-ms-clear {
	visibility: hidden;
}
.vtable input.table-focus-control.composition {
	opacity: 1;
	max-width: none;
	max-height: none;
}
`,document.head.appendChild(n)}function YR(n){var t;return n?.hoverOn||n?.horizontalVisible&&n?.horizontalVisible==="none"||!n?.horizontalVisible&&n?.visible==="none"?0:(t=n?.width)!==null&&t!==void 0?t:7}function KR(n){var t;return n?.hoverOn||n?.verticalVisible&&n?.verticalVisible==="none"||!n?.verticalVisible&&n?.visible==="none"?0:(t=n?.width)!==null&&t!==void 0?t:7}function DHt(n){return!!Y(n)&&(!Mt(n)||n.some(t=>Y(t)))}function IHt(n){return n===0||Mt(n)&&n.every(t=>t===0)}function HHt(n){const t=n.stateManager.select.ranges,e=[];for(let i=0;i<t.length;i++){const r=t[i];e.push({range:r,style:{cellBorderColor:"blue",cellBorderLineWidth:2,cellBorderLineDash:[5,5]}})}n.stateManager.setCustomSelectRanges(e)}function FHt(n){n.stateManager.setCustomSelectRanges([])}const zHt=n=>{switch(Object.prototype.toString.call(n)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},TA=(n,t)=>zHt(n)===t,A_=n=>TA(n,"object"),NHt=n=>TA(n,"string"),WHt=n=>TA(n,"number"),VHt=n=>TA(n,"boolean");function ei(n,...t){if(!t.length)return n||{};const e=t.shift();if(A_(n)&&A_(e))for(const i in e)A_(e[i])?(n[i]||Object.assign(n,{[i]:{}}),A_(n[i])||Object.assign(n,{[i]:e[i]}),ei(n[i],e[i])):e[i]!==null&&e[i]!==void 0&&Object.assign(n,{[i]:e[i]});return ei(n,...t)}function H6(n){return typeof n=="function"&&(n=n()),Y(n)?`${n}`:""}function F6(n,t){let e=null;return function(...i){e||(n.apply(this,i),e=setTimeout(()=>{e=null},t))}}function GHt(n,t){let e=null;return function(...i){e||(e=setTimeout(()=>{n.apply(this,i),e=null},t))}}function qR(n,t){for(n=`${n}`;n.length<t;)n="0"+n;return n}function ch(n,t,e){n=(n=n.replace(/^\s*|\s*$/,"")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");const i=Math.round(256*t)*1,r=n.match(new RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),o=r&&Y(r[4])?r[4]:null,s=r?[r[1],r[2],r[3]]:n.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},${parseInt(arguments[3],16)}`}).split(/,/);return r?`rgb${o!==null?"a":""}(${Math.min(parseInt(s[0],10)+i,255)}, ${Math.min(parseInt(s[1],10)+i,255)}, ${Math.min(parseInt(s[2],10)+i,255)}${o!==null?`, ${o}`:""})`:["#",qR(Math.min(parseInt(s[0],10)+i,255).toString(16),2),qR(Math.min(parseInt(s[1],10)+i,255).toString(16),2),qR(Math.min(parseInt(s[2],10)+i,255).toString(16),2)].join("")}function MA(n){return NHt(n)||WHt(n)||VHt(n)?n.toString():""}function Uk(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function Z1(n,t,e){return e!=="desc"?n===t?0:n>t?1:-1:n===t?0:n<t?1:-1}function $Ht(n,t){let e,i=n;for(;(e=t.shift())&&(i=i[e],i););return i}function jHt(n){return/^-?\d+(\.\d+)?$/.test(n)}function L0(n){const t=[];for(let e=0;e<n.length;e++)t.indexOf(n[e])===-1&&t.push(n[e]);return t}function UHt(n){const t=window.getSelection();if(t.rangeCount){const e=t.getRangeAt(0);return e.endOffset>e.startOffset&&n.contains(e.commonAncestorContainer)}return!1}function wD(n,t,e){e(n),n?.[t]&&Array.isArray(n?.[t])&&n[t].forEach(i=>wD(i,t,e))}function RA(n,t,e){let i=0;if(!t||t===Lt.collapse||t===Lt.none)return i;const r=e.filteredChildren?e.filteredChildren:e.children;if(r)for(let o=0;o<r.length;o++)i+=1,i+=RA(Array.isArray(n)?n.concat([o]):[n,o],r[o].hierarchyState,r[o]);return i}const kZ=typeof window>"u"||window.window===void 0;let ZR,JR;const EZ={get find(){return ZR||(ZR=Array.prototype.find?(n,t)=>Array.prototype.find.call(n,t):(n,t)=>{const e=EZ.findIndex(n,t);return e>=0?n[e]:void 0},ZR)},get findIndex(){return JR||(JR=Array.prototype.findIndex?(n,t)=>Array.prototype.findIndex.call(n,t):(n,t)=>{const{length:e}=n;for(let i=0;i<e;i++)if(t(n[i],i,n))return i;return-1},JR)}};function XHt(){if(kZ)return{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1};const n=window.navigator.userAgent.toLowerCase();return{IE:!!/(msie|trident)/.exec(n),Edge:n.indexOf("edge")>-1,Chrome:n.indexOf("chrome")>-1&&n.indexOf("edge")===-1,Firefox:n.indexOf("firefox")>-1,Safari:n.indexOf("safari")>-1&&n.indexOf("edge")===-1}}const{IE:YHt,Chrome:K7t,Firefox:q7t,Edge:Z7t,Safari:J7t}=XHt();function KHt(n){return n===Object(n)}function Iy(...n){const t={};return n.forEach(e=>{for(const i in e)Object.defineProperty(t,i,{get:()=>e[i],set(r){e[i]=r},configurable:!0,enumerable:!0})}),t}function LZ(n,t,...e){let i=n;for(let r=0;r<e.length&&i!=null;r++)i=t(i,e[r]);return i}function T_(n,...t){return LZ(n,(e,i)=>e[i],...t)}function Ie(n,...t){return typeof n=="function"?n(...t):n}function qHt(n,t,e){const i=MA(n);(typeof e!="number"||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;const r=i.lastIndexOf(t,e);return r!==-1&&r===e}function aa(n){return!!(n&&typeof n.then=="function")}function J1(n,t){aa(n)?n.then(e=>{t(e)}).catch(e=>{}):t(n)}function ZHt(n){return!!n.changedTouches}function JHt(n,t){if(n[t])return n[t];const e=t.toLowerCase();if(n[e])return n[e];const i=t.toLowerCase();if(n[i])return n[i];for(const r in n)if(r.toLowerCase()===e)return n[r]}function Ls(n){return Array.isArray(n)?n.length===3?[n[0],n[1],n[2],n[1]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===1?[n[0],n[0],n[0],n[0]]:[n[0],n[1],n[2],n[3]]:[n,n,n,n]}function fs(n,t,e){return n.start.col<=t&&t<=n.end.col&&n.start.row<=e&&e<=n.end.row||n.end.col<=t&&t<=n.start.col&&n.end.row<=e&&e<=n.start.row||n.end.col<=t&&t<=n.start.col&&n.start.row<=e&&e<=n.end.row||n.start.col<=t&&t<=n.end.col&&n.end.row<=e&&e<=n.start.row}function QHt(n,t,e){for(let i=0;i<n.length;i++){const r=n[i],o=Math.min(r.start.col,r.end.col),s=Math.max(r.start.col,r.end.col),a=Math.min(r.start.row,r.end.row),l=Math.max(r.start.row,r.end.row);if(o<=t&&t<=s&&a<=e&&e<=l||s<=t&&t<=o&&l<=e&&e<=a)return!0}return!1}function z6(n){return{start:{col:Math.min(n.start.col,n.end.col),row:Math.min(n.start.row,n.end.row)},end:{col:Math.max(n.start.col,n.end.col),row:Math.max(n.start.row,n.end.row)}}}function tFt(n,t){const e=z6(n),i=z6(t);return Math.max(e.start.col,i.start.col)<=Math.min(e.end.col,i.end.col)&&Math.max(e.start.row,i.start.row)<=Math.min(e.end.row,i.end.row)}const eFt={IE:YHt},OZ={isObject:KHt},M_={endsWith:qHt},iFt={isTouchEvent:ZHt},nFt={toBoxArray:Ls},rFt=Function.prototype,ot={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",BEFORE_KEYDOWN:"before_keydown",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",CONTEXTMENU_CANVAS:"contextmenu_canvas",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",CAN_SCROLL:"can_scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",SELECTED_CHANGED:"selected_changed",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",BEFORE_SET_SIZE:"before_set_size",BEFORE_INIT:"before_init",BEFORE_UPDATE_OPTION:"before_update_option",AFTER_RENDER:"after_render",INITIALIZED:"initialized",UPDATED:"updated",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click",BEFORE_CACHE_CHART_IMAGE:"before_cache_chart_image",PASTED_DATA:"pasted_data",PLUGIN_EVENT:"plugin_event"},oFt=n=>{switch(Object.prototype.toString.call(n)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},sFt=(n,t)=>oFt(n)===t,aFt=n=>sFt(n,"object");function DZ(n,t,e){let i,r,o,s,a,l,h=0,u=!1,d=!1,c=!0;const f=!t&&t!==0&&typeof requestAnimationFrame=="function";if(typeof n!="function")throw new TypeError("Expected a function");function g(y){const b=i,_=r;return r=void 0,i=void 0,h=y,s=n.apply(_,b),s}function p(y,b){return f?requestAnimationFrame(y):setTimeout(y,b)}function v(y){const b=y-l;return l===void 0||b>=t||b<0||u&&y-h>=o}function m(){const y=Date.now();if(v(y))return function(b){return a=void 0,c&&i?g(b):(r=void 0,i=void 0,s)}(y);a=p(m,function(b){const _=b-h,w=t&&-(b-l);return u?Math.min(w,o-_):w}(y))}return t=+t||0,aFt(e)&&(d=!!e.leading,u="maxWait"in e,u&&(o=Math.max(+e.maxWait||0,t)),c="trailing"in e?!!e.trailing:c),function(...y){const b=Date.now(),_=v(b);if(i=y,r=this,l=b,_){if(a===void 0)return function(w){return h=w,a=p(m,t),d?g(w):s}(l);if(u)return a=p(m,t),g(l)}return a===void 0&&(a=p(m,t)),s}}let lFt=1,hFt=class{constructor(t,e,i){var r;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const o=this.getSize();let s=!1;o.width===this.lastSize.width&&o.height===this.lastSize.height&&(s=!0),this.lastSize=o,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:s}))},this.onResize=()=>{this.callBackDebounce()},this.element=t,this.cb=e,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=DZ(this.callBack,this.resizeTime),window?.addEventListener("resize",this.onResize),"ResizeObserver"in window){const o=window.ResizeObserver;this.observer=new o(this.mutationResize),(r=this.observer)===null||r===void 0||r.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(t){this.lastSize=t}checkSize(){const t=this.getSize();return t.width!==this.lastSize.width||t.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}},BA=class{constructor(){this.listeners={},this.reseizeListeners={}}on(t,e,i,...r){if(ye.mode==="node")return-1;const o=lFt++;if(t?.addEventListener)if(e!=="resize"||t===window)t?.addEventListener(e,i,...r);else{const a=new hFt(t,i,this.resizeTime);this.reseizeListeners[o]=a}const s={target:t,type:e,listener:i,options:r};return this.listeners[o]=s,o}once(t,e,i,...r){if(ye.mode==="node")return-1;const o=this.on(t,e,(...s)=>{this.off(o),i(...s)},...r);return o}off(t){var e;if(ye.mode==="node"||t===null)return;const i=(e=this.listeners)===null||e===void 0?void 0:e[t];i&&(delete this.listeners[t],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(t,e,...i){if(ye.mode!=="node")for(const r in this.listeners){const o=this.listeners[r];o.target===t&&o.type===e&&o.listener.call(o.target,...i)}}hasListener(t,e){if(ye.mode==="node")return!1;let i=!1;for(const r in this.listeners){const o=this.listeners[r];o.target===t&&o.type===e&&(i=!0)}return i}clear(){if(ye.mode!=="node"){for(const t in this.listeners){const e=this.listeners[t];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(const t in this.reseizeListeners){const e=this.reseizeListeners[t];e?.disConnect()}this.listeners={}}}release(){ye.mode!=="node"&&(this.clear(),this.listeners={})}};const Uu=(n,t)=>{let e=0,i=n.length-1;for(;e<=i;){const r=Math.floor((e+i)/2);if(n[r]===t)return r;n[r]>t?i=r-1:e=r+1}return i<0?0:i};class Fh{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(t,e,i){const{_keys:r}=this;if(this._sorted||(r.sort((s,a)=>s<a?-1:s>a?1:0),this._sorted=!0),t>e){const s=[];for(let a=Uu(r,t+i-1);a>=0;a--){const l=r[a];if(l>=t)s.push(this.get(l));else if(e<=l&&l<t)this.put(l+i,this.get(l));else if(l<e)break}for(let a=0;a<i;a++)this.put(e+a,s[i-1-a])}const{length:o}=r;if(t<e){const s=[];for(let a=Uu(r,t);a<o;a++){const l=r[a];if(l>=t&&l<t+i)s.push(this.get(l));else if(t+i<=l&&l<=e)this.put(l-i,this.get(l));else if(l>e)break}for(let a=0;a<i;a++)this.put(e+a,s[a])}}exchangeOrder(t,e,i,r,o){const{_keys:s}=this;if(this._sorted||(s.sort((a,l)=>a<l?-1:a>l?1:0),this._sorted=!0),t>i){const a=[],l=[];for(let h=Uu(s,i);h<Uu(s,t)+e;h++){const u=s[h];u>=t&&u<t+e?l.push(this.get(u)):a.push(this.get(u))}for(let h=0;h<e;h++)this.put(o+h,l[h]);for(let h=0;h<a.length;h++)this.put(o+e+h,a[h])}else{const a=[],l=[];for(let h=Uu(s,t);h<Uu(s,i)+r;h++){const u=s[h];u>=t&&u<t+e?l.push(this.get(u)):a.push(this.get(u))}for(let h=0;h<e;h++)this.put(o+h,l[h]);for(let h=0;h<a.length;h++)this.put(t+h,a[h])}}del(t){delete this._vals[t];const e=this._keys.indexOf(t);e!==-1&&this._keys.splice(e,1)}put(t,e){t in this._vals||(this._keys.push(t),this._sorted=!1),this._vals[t]=e}get(t){return this._vals[t]}has(t){return Y(this._vals[t])}contain(t){return Object.values(this._vals).indexOf(t)>=0}each(t,e,i){const{_keys:r}=this,{length:o}=r;this._sorted||(r.sort((s,a)=>s<a?-1:s>a?1:0),this._sorted=!0);for(let s=Uu(r,t);s<o;s++){const a=r[s];if(t<=a&&a<=e){if(i(this.get(a),a)===!1)break}else if(e<a)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){const t=this.getLastIndex();this.del(t)}delAndReorder(t){if(!this.has(t))return;const e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}addAndReorder(t,e){if(Y(e)){const i=this.getLastIndex();this.adjustOrder(t,t+1,i-t),this.put(t,e)}}}class Ma{constructor(t,e,i,r){this.bounds=new lu,this.bounds.set(t,e,t+i,e+r)}static bounds(t,e,i,r){return new Ma(t,e,Math.round(i-t),Math.round(r-e))}get left(){return this.bounds.x1}set left(t){this.bounds.x1=t}get top(){return this.bounds.y1}set top(t){this.bounds.y1=t}get right(){return this.bounds.x2}set right(t){this.bounds.x2=t}get bottom(){return this.bounds.y2}set bottom(t){this.bounds.y2=t}get width(){return this.bounds.width()}set width(t){this.bounds.x2=this.bounds.x1+t}get height(){return this.bounds.height()}set height(t){this.bounds.y2=this.bounds.y1+t}offsetLeft(t){this.bounds.translate(t,0)}offsetTop(t){this.bounds.translate(0,t)}copy(){return new Ma(this.left,this.top,this.width,this.height)}contains(t){return this.bounds.encloses(t.bounds)}inPoint(t,e){return this.bounds.contains(t,e)}}function uFt(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#282a2e":"#2d3137"}const N6={name:"DARK",underlayBackgroundColor:"transparent",defaultStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},headerStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:"#e5e7ea",bgColor:uFt,fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#29364D"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(255, 255, 255, 0.1)",cellBorderColor:"#4284FF",cellBorderLineWidth:2},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"},functionalIconsStyle:{sort_color:"#FFFFFF",sort_color_opacity:"0.75",sort_color_2:"#416EFF",sort_color_opacity_2:"1",frozen_color:"#FFFFFF",frozen_color_opacity:"0.75",collapse_color:"#FFF",collapse_color_opacity:"0.75",expand_color:"#FFF",expand_color_opacity:"0.75",dragReorder_color:"#FFF",dragReorder_color_opacity:"0.75"}};function dFt(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#FFF":"#F4F8FF"}const W6={name:"BRIGHT",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#5286FA",hover:{cellBgColor:"#2E67E3"}},headerStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#A1C1FF",hover:{cellBgColor:"#2E67E3"}},bodyStyle:{color:"#000",bgColor:dFt,borderColor:"#E0EAFE",hover:{cellBgColor:"#E9EFFD"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"#CBDCFE",endColor:"#CBDCFE",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function cFt(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#fbfbfc":"#FFF"}const V6={name:"ARCO",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12]},headerStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},rowHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},cornerHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},bodyStyle:{padding:[8,12,8,12],color:"#141414",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:400,textAlign:"left",bgColor:cFt,borderColor:"#e1e4e8",lineHeight:14,hover:{cellBgColor:"#F7F8FA",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#3073f2"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function fFt(n){const{row:t,table:e}=n;return 1&t-e.frozenRowCount?"#FDFDFD":"#FAF9FB"}const G6={name:"DEFAULT",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:"#E1E4E8",color:"#000",bgColor:"#ECF1F5"},headerStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},rowHeaderStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},cornerHeaderStyle:{fontSize:16,fontWeight:"bold"},bodyStyle:{fontSize:14,bgColor:fFt,hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"rgba(225, 228, 232, 0.6)",endColor:"rgba(225, 228, 232, 0.6)",visible:"always"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#0000ff"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function gFt(n){const{row:t,table:{frozenRowCount:e}}=n;return e-1===t?["#f2f2f2","#f2f2f2","#ccc7c7","#f2f2f2"]:["#f2f2f2"]}function pFt(n){const{col:t,table:e}=n,{colCount:i,frozenColCount:r}=e,o="#ccc7c7";return r-1===t||i-1===t?[o,"#f2f2f2","#ccc7c7",null]:[o,null,"#ccc7c7",null]}const $6={name:"SIMPLIFY",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:pFt,hover:{cellBorderColor:"#0000FF",cellBgColor:"#D0E0E3"},bgColor:"#FFF"},headerStyle:{color:"rgba(0, 0, 0, 0.87)",borderColor:gFt},bodyStyle:{color:"rgba(0, 0, 0, 0.87)"},frameStyle:{borderColor:"#f2f2f2",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF"},selectionStyle:{cellBorderColor:"#FD5",cellBgColor:"rgba(111, 168, 220, 0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},vFt={},j6=16,U6="Arial,sans-serif",mFt="#FFF",yFt="#000",bFt=1,_Ft=[],CFt="#000",xD=/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,R_="$$indicator$$",wFt='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path  d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z"></path></svg>',xFt='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z"></path></svg>',SFt={type:"line"};function AFt(n){return{defaultAxisStyle:wv(n.defaultAxisStyle),leftAxisStyle:wv(n.leftAxisStyle),rightAxisStyle:wv(n.rightAxisStyle),topAxisStyle:wv(n.topAxisStyle),bottomAxisStyle:wv(n.bottomAxisStyle)}}function wv(n){return n||{}}const TFt={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:12,fontWeight:"bold",fill:"#4E5969"},contentStyle:{fontSize:12,fill:"#4E5969"},panel:{visible:!0,fill:"#fff",stroke:"#ffffff",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:"rgba(0, 0, 0, 0.1)",size:0,space:12}};function lf(n,t,e,i){var r,o,s;return(s=(o=(r=T_(n,...e))!==null&&r!==void 0?r:T_(t,...e))!==null&&o!==void 0?o:i&&T_(n,...i))!==null&&s!==void 0?s:i&&T_(t,...i)}class mo{constructor(t,e){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name="",this.internalTheme={obj:t,superTheme:e},this.name=lf(t,e,["name"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){const{obj:t,superTheme:e}=this.internalTheme;return lf(t,e,["font"],["bodyStyle","font"])}get underlayBackgroundColor(){const{obj:t,superTheme:e}=this.internalTheme;return lf(t,e,["underlayBackgroundColor"])}get cellInnerBorder(){var t;const{obj:e,superTheme:i}=this.internalTheme;return(t=lf(e,i,["cellInnerBorder"]))===null||t===void 0||t}get cellBorderClipDirection(){var t;const{obj:e,superTheme:i}=this.internalTheme;return(t=lf(e,i,["cellBorderClipDirection"]))!==null&&t!==void 0?t:"top-left"}get _contentOffset(){var t;const{obj:e,superTheme:i}=this.internalTheme;return(t=lf(e,i,["_contentOffset"]))!==null&&t!==void 0?t:0}get defaultStyle(){const t=this;if(!this._defaultStyle){const{obj:e,superTheme:i}=this.internalTheme,r=ei({},i.defaultStyle,e.defaultStyle);this._defaultStyle={get fontSize(){var o;return(o=r.fontSize)!==null&&o!==void 0?o:j6},get fontFamily(){var o;return(o=r.fontFamily)!==null&&o!==void 0?o:U6},get fontWeight(){return r.fontWeight},get fontVariant(){return r.fontVariant},get fontStyle(){return r.fontStyle},get bgColor(){var o;return(o=r.bgColor)!==null&&o!==void 0?o:mFt},get color(){var o;return(o=r.color)!==null&&o!==void 0?o:CFt},get borderColor(){var o;return(o=r.borderColor)!==null&&o!==void 0?o:yFt},get borderLineWidth(){var o;return(o=r.borderLineWidth)!==null&&o!==void 0?o:bFt},get borderLineDash(){var o;return(o=r.borderLineDash)!==null&&o!==void 0?o:_Ft},get hover(){if(r.hover)return{get cellBgColor(){var o,s;return(s=(o=r.hover)===null||o===void 0?void 0:o.cellBgColor)!==null&&s!==void 0?s:void 0},get inlineColumnBgColor(){var o,s,a,l,h,u;return(u=(s=(o=r.hover)===null||o===void 0?void 0:o.inlineColumnBgColor)!==null&&s!==void 0?s:!((a=r.hover)===null||a===void 0)&&a.cellBgColor&&typeof((l=r.hover)===null||l===void 0?void 0:l.cellBgColor)=="string"?ch((h=r.hover)===null||h===void 0?void 0:h.cellBgColor,.1):void 0)!==null&&u!==void 0?u:void 0},get inlineRowBgColor(){var o,s,a,l,h,u;return(u=(s=(o=r.hover)===null||o===void 0?void 0:o.inlineRowBgColor)!==null&&s!==void 0?s:!((a=r.hover)===null||a===void 0)&&a.cellBgColor&&typeof((l=r.hover)===null||l===void 0?void 0:l.cellBgColor)=="string"?ch((h=r.hover)===null||h===void 0?void 0:h.cellBgColor,.1):void 0)!==null&&u!==void 0?u:void 0}}},get select(){if(r.select)return{get inlineColumnBgColor(){var o,s,a,l,h,u;return(u=(l=(s=(o=r.select)===null||o===void 0?void 0:o.inlineColumnBgColor)!==null&&s!==void 0?s:(a=t.selectionStyle)===null||a===void 0?void 0:a.inlineColumnBgColor)!==null&&l!==void 0?l:!((h=t.selectionStyle)===null||h===void 0)&&h.cellBgColor&&typeof t.selectionStyle.cellBgColor=="string"?ch(t.selectionStyle.cellBgColor,.1):void 0)!==null&&u!==void 0?u:void 0},get inlineRowBgColor(){var o,s,a,l,h;return(h=(a=(s=(o=r.select)===null||o===void 0?void 0:o.inlineRowBgColor)!==null&&s!==void 0?s:t.selectionStyle.inlineRowBgColor)!==null&&a!==void 0?a:!((l=t.selectionStyle)===null||l===void 0)&&l.cellBgColor&&typeof t.selectionStyle.cellBgColor=="string"?ch(t.selectionStyle.cellBgColor,.1):void 0)!==null&&h!==void 0?h:void 0}}},get padding(){var o;return(o=r.padding)!==null&&o!==void 0?o:[10,16,10,16]},get textAlign(){var o;return(o=r.textAlign)!==null&&o!==void 0?o:"left"},get textBaseline(){var o;return(o=r.textBaseline)!==null&&o!==void 0?o:"middle"},get textOverflow(){var o;return(o=r.textOverflow)!==null&&o!==void 0?o:"ellipsis"},get lineHeight(){return r.lineHeight},get autoWrapText(){var o;return(o=r.autoWrapText)!==null&&o!==void 0&&o},get lineClamp(){var o;return(o=r.lineClamp)!==null&&o!==void 0?o:"auto"},get linkColor(){var o;return(o=r.linkColor)!==null&&o!==void 0?o:"#3772ff"},get cursor(){var o;return(o=r.cursor)!==null&&o!==void 0?o:"auto"},get marked(){var o;return(o=r.marked)!==null&&o!==void 0&&o},get underline(){var o;return(o=r.underline)!==null&&o!==void 0&&o},get underlineColor(){return r.underlineColor},get underlineDash(){return r.underlineDash},get underlineOffset(){return r.underlineOffset},get lineThrough(){var o;return(o=r.lineThrough)!==null&&o!==void 0&&o},get lineThroughColor(){return r.lineThroughColor},get lineThroughDash(){return r.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){if(!this._cornerHeader){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},this.defaultStyle,e.cornerHeaderStyle,t.cornerHeaderStyle);this._cornerHeader=this.getStyle(i)}return this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightTopCellStyle&&!t.cornerRightTopCellStyle)return this._cornerRightTopCell;const i=ei({},this.defaultStyle,e.cornerRightTopCellStyle,t.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(i)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerLeftBottomCellStyle&&!t.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;const i=ei({},this.defaultStyle,e.cornerLeftBottomCellStyle,t.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(i)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightBottomCellStyle&&!t.cornerRightBottomCellStyle)return this._cornerRightBottomCell;const i=ei({},this.defaultStyle,e.cornerRightBottomCellStyle,t.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(i)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){const{obj:t,superTheme:e}=this.internalTheme;if(!e.rightFrozenStyle&&!t.rightFrozenStyle)return this._rightFrozen;const i=ei({},this.defaultStyle,this.rowHeaderStyle,e.rightFrozenStyle,t.rightFrozenStyle);this._rightFrozen=this.getStyle(i)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){const{obj:t,superTheme:e}=this.internalTheme;if(!e.bottomFrozenStyle&&!t.bottomFrozenStyle)return this._bottomFrozen;const i=ei({},this.defaultStyle,this.headerStyle,e.bottomFrozenStyle,t.bottomFrozenStyle);this._bottomFrozen=this.getStyle(i)}return this._bottomFrozen}get rowHeaderStyle(){var t;if(!this._rowHeader){const{obj:e,superTheme:i}=this.internalTheme,r=ei({},this.defaultStyle,i.rowHeaderStyle,(t=e.rowHeaderStyle)!==null&&t!==void 0?t:this.isPivot?null:e.headerStyle);this._rowHeader=this.getStyle(r)}return this._rowHeader}get headerStyle(){if(!this._header){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},this.defaultStyle,e.headerStyle,t.headerStyle);this._header=this.getStyle(i)}return this._header}get bodyStyle(){if(!this._body){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},this.defaultStyle,e.bodyStyle,t.bodyStyle);this._body=this.getStyle(i)}return this._body}get groupTitleStyle(){if(!this._groupTitle){const{obj:t,superTheme:e}=this.internalTheme;if(!e.groupTitleStyle&&!t.groupTitleStyle)return this._groupTitle;const i=ei({},this.defaultStyle,e.groupTitleStyle,t.groupTitleStyle);this._groupTitle=this.getStyle(i)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.frameStyle,t.frameStyle);this._frameStyle={get borderColor(){return i.borderColor},get borderLineWidth(){return i.borderLineWidth},get borderLineDash(){return i.borderLineDash},get innerBorder(){return i.innerBorder},get shadowBlur(){return i.shadowBlur},get shadowColor(){return i.shadowColor},get shadowOffsetX(){return i.shadowOffsetX},get shadowOffsetY(){return i.shadowOffsetY},get cornerRadius(){return i.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.scrollStyle,t.scrollStyle);this._scroll={get scrollSliderColor(){var r;return(r=i.scrollSliderColor)!==null&&r!==void 0?r:"#C0C0C0"},get scrollSliderCornerRadius(){return i.scrollSliderCornerRadius},get scrollRailColor(){return i.scrollRailColor},get visible(){var r;return(r=i.visible)!==null&&r!==void 0?r:"scrolling"},get verticalVisible(){return i.verticalVisible},get horizontalVisible(){return i.horizontalVisible},get width(){var r;return(r=i.width)!==null&&r!==void 0?r:7},get hoverOn(){var r;return(r=i.hoverOn)===null||r===void 0||r},get barToSide(){var r;return(r=i.barToSide)!==null&&r!==void 0&&r},get horizontalPadding(){var r;return(r=i.horizontalPadding)!==null&&r!==void 0?r:0},get verticalPadding(){var r;return(r=i.verticalPadding)!==null&&r!==void 0?r:0},get ignoreFrozenCols(){var r;return(r=i.ignoreFrozenCols)!==null&&r!==void 0&&r}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.tooltipStyle,t.tooltipStyle);this._tooltip={get fontFamily(){var r;return(r=i.fontFamily)!==null&&r!==void 0?r:U6},get fontSize(){var r;return(r=i.fontSize)!==null&&r!==void 0?r:j6},get bgColor(){var r;return(r=i.bgColor)!==null&&r!==void 0?r:"#000"},get padding(){var r;return(r=i.padding)!==null&&r!==void 0?r:[6,8]},get color(){var r;return(r=i.color)!==null&&r!==void 0?r:"#FFF"},get maxWidth(){return i.maxWidth},get maxHeight(){return i.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.columnResize,t.columnResize);this._columnResize={get lineColor(){var r;return(r=i.lineColor)!==null&&r!==void 0?r:"#416EFF"},get bgColor(){var r;return(r=i.bgColor)!==null&&r!==void 0?r:"#D9E2FF"},get lineWidth(){var r;return(r=i.lineWidth)!==null&&r!==void 0?r:1},get width(){var r;return(r=i.width)!==null&&r!==void 0?r:i.lineWidth+2},get resizeHotSpotSize(){var r;return(r=i.resizeHotSpotSize)!==null&&r!==void 0?r:16},get labelColor(){var r;return(r=i.labelColor)!==null&&r!==void 0?r:"#FFF"},get labelFontSize(){var r;return(r=i.labelFontSize)!==null&&r!==void 0?r:10},get labelFontFamily(){var r;return(r=i.labelFontFamily)!==null&&r!==void 0?r:"sans-serif"},get labelBackgroundFill(){var r;return(r=i.labelBackgroundFill)!==null&&r!==void 0?r:"#3073F2"},get labelBackgroundCornerRadius(){var r;return(r=i.labelBackgroundCornerRadius)!==null&&r!==void 0?r:5},get labelVisible(){var r;return(r=i.labelVisible)===null||r===void 0||r},get visibleOnHover(){var r;return(r=i.visibleOnHover)!==null&&r!==void 0&&r}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.dragHeaderSplitLine,t.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var r;return(r=i.lineColor)!==null&&r!==void 0?r:"blue"},get lineWidth(){var r;return(r=i.lineWidth)!==null&&r!==void 0?r:2},get shadowBlockColor(){var r;return(r=i.shadowBlockColor)!==null&&r!==void 0?r:"rgba(204,204,204,0.3)"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.frozenColumnLine,t.frozenColumnLine);this._frozenColumnLine={get shadow(){if(i.shadow)return{get width(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.width)!==null&&o!==void 0?o:24},get startColor(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.startColor)!==null&&o!==void 0?o:"rgba(00, 24, 47, 0.06)"},get endColor(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.endColor)!==null&&o!==void 0?o:"rgba(00, 24, 47, 0)"},get visible(){var r,o;return(o=(r=i.shadow)===null||r===void 0?void 0:r.visible)!==null&&o!==void 0?o:"always"}}},get border(){if(i.border)return{get lineColor(){var r,o;return(o=(r=i.border)===null||r===void 0?void 0:r.lineColor)!==null&&o!==void 0?o:"rgba(00, 24, 47, 0.06)"},get bgColor(){var r,o,s,a;return(a=(o=(r=i.border)===null||r===void 0?void 0:r.bgColor)!==null&&o!==void 0?o:(s=i.border)===null||s===void 0?void 0:s.lineColor)!==null&&a!==void 0?a:"rgba(00, 24, 47, 0.06)"},get lineWidth(){var r,o;return(o=(r=i.border)===null||r===void 0?void 0:r.lineWidth)!==null&&o!==void 0?o:4},get width(){var r,o,s,a;return(a=(o=(r=i.border)===null||r===void 0?void 0:r.width)!==null&&o!==void 0?o:(s=i.border)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.selectionStyle,t.selectionStyle);this._selectionStyle={get cellBgColor(){var r;return(r=i?.cellBgColor)!==null&&r!==void 0?r:"rgba(0, 0, 255,0.1)"},get cellBorderColor(){var r;return(r=i?.cellBorderColor)!==null&&r!==void 0?r:"#3073f2"},get cellBorderLineWidth(){var r;return(r=i?.cellBorderLineWidth)!==null&&r!==void 0?r:2},get inlineColumnBgColor(){return i?.inlineColumnBgColor},get inlineRowBgColor(){return i?.inlineRowBgColor},get selectionFillMode(){var r;return(r=i?.selectionFillMode)!==null&&r!==void 0?r:"overlay"},get dynamicUpdateSelectionSize(){var r;return(r=i?.dynamicUpdateSelectionSize)!==null&&r!==void 0&&r}}}return this._selectionStyle}get axisStyle(){if(!this._axisStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.axisStyle,t.axisStyle);this._axisStyle=AFt(i)}return this._axisStyle}get checkboxStyle(){if(!this._checkboxStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.checkboxStyle,t.checkboxStyle);this._checkboxStyle=i}return this._checkboxStyle}get radioStyle(){if(!this._radioStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.radioStyle,t.radioStyle);this._radioStyle=i}return this._radioStyle}get switchStyle(){if(!this._switchStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.switchStyle,t.switchStyle);this._switchStyle=i}return this._switchStyle}get buttonStyle(){if(!this._buttonStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.buttonStyle,t.buttonStyle);this._buttonStyle=i}return this._buttonStyle}get textPopTipStyle(){if(!this._textPopTipStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},TFt,e.textPopTipStyle,t.textPopTipStyle);this._textPopTipStyle=i}return this._textPopTipStyle}get functionalIconsStyle(){if(!this._internalIconsStyle){const{obj:t,superTheme:e}=this.internalTheme,i=ei({},e.functionalIconsStyle,t.functionalIconsStyle);this._internalIconsStyle=i}return this._internalIconsStyle}hasProperty(t){const{obj:e,superTheme:i}=this.internalTheme;return X6(e,t)||X6(i,t)}extends(t){return new mo(ei({},t),ei({},this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(t){const e=this;return{get fontSize(){return t.fontSize},get fontFamily(){return t.fontFamily},get fontWeight(){return t.fontWeight},get fontVariant(){return t.fontVariant},get fontStyle(){return t.fontStyle},get bgColor(){return t.bgColor},get color(){return t.color},get strokeColor(){return t.strokeColor},get borderColor(){return t.borderColor},get borderLineWidth(){return t.borderLineWidth},get borderLineDash(){return t.borderLineDash},get hover(){if(t.hover)return{get cellBgColor(){var i,r;return(r=(i=t.hover)===null||i===void 0?void 0:i.cellBgColor)!==null&&r!==void 0?r:void 0},get inlineColumnBgColor(){var i,r,o,s,a,l;return(l=(r=(i=t.hover)===null||i===void 0?void 0:i.inlineColumnBgColor)!==null&&r!==void 0?r:!((o=t.hover)===null||o===void 0)&&o.cellBgColor&&typeof((s=t.hover)===null||s===void 0?void 0:s.cellBgColor)=="string"?ch((a=t.hover)===null||a===void 0?void 0:a.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0},get inlineRowBgColor(){var i,r,o,s,a,l;return(l=(r=(i=t.hover)===null||i===void 0?void 0:i.inlineRowBgColor)!==null&&r!==void 0?r:!((o=t.hover)===null||o===void 0)&&o.cellBgColor&&typeof((s=t.hover)===null||s===void 0?void 0:s.cellBgColor)=="string"?ch((a=t.hover)===null||a===void 0?void 0:a.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0}}},get select(){return{get inlineColumnBgColor(){var i,r,o,s,a,l;return(l=(s=(r=(i=t.select)===null||i===void 0?void 0:i.inlineColumnBgColor)!==null&&r!==void 0?r:(o=e.selectionStyle)===null||o===void 0?void 0:o.inlineColumnBgColor)!==null&&s!==void 0?s:!((a=e.selectionStyle)===null||a===void 0)&&a.cellBgColor&&typeof e.selectionStyle.cellBgColor=="string"?ch(e.selectionStyle.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0},get inlineRowBgColor(){var i,r,o,s,a;return(a=(o=(r=(i=t.select)===null||i===void 0?void 0:i.inlineRowBgColor)!==null&&r!==void 0?r:e.selectionStyle.inlineRowBgColor)!==null&&o!==void 0?o:!((s=e.selectionStyle)===null||s===void 0)&&s.cellBgColor&&typeof e.selectionStyle.cellBgColor=="string"?ch(e.selectionStyle.cellBgColor,.1):void 0)!==null&&a!==void 0?a:void 0},get cellBgColor(){var i,r,o;if(e.selectionStyle.selectionFillMode==="replace")return(o=(r=(i=t.select)===null||i===void 0?void 0:i.cellBgColor)!==null&&r!==void 0?r:e.selectionStyle.cellBgColor)!==null&&o!==void 0?o:void 0}}},get frameStyle(){if(t.frameStyle)return{get borderColor(){var i,r;return(r=(i=t.frameStyle)===null||i===void 0?void 0:i.borderColor)!==null&&r!==void 0?r:void 0},get borderLineWidth(){var i,r;return(r=(i=t.frameStyle)===null||i===void 0?void 0:i.borderLineWidth)!==null&&r!==void 0?r:void 0},get borderLineDash(){var i,r;return(r=(i=t.frameStyle)===null||i===void 0?void 0:i.borderLineDash)!==null&&r!==void 0?r:void 0}}},get padding(){return t.padding},get textAlign(){return t.textAlign},get textBaseline(){return t.textBaseline},get textOverflow(){return t.textOverflow},get lineHeight(){return t.lineHeight},get autoWrapText(){return t.autoWrapText},get lineClamp(){return t.lineClamp},get linkColor(){return t.linkColor},get cursor(){return t.cursor},get textStick(){return t.textStick},get marked(){return t.marked},get underline(){var i;return(i=t.underline)!==null&&i!==void 0&&i},get underlineColor(){return t.underlineColor},get underlineDash(){return t.underlineDash},get underlineOffset(){return t.underlineOffset},get lineThrough(){var i;return(i=t.lineThrough)!==null&&i!==void 0&&i},get lineThroughColor(){return t.lineThroughColor},get lineThroughDash(){return t.lineThroughDash}}}}function X6(n,t){if(n instanceof mo)return n.hasProperty(t);let e=n;if(!e)return!1;for(let i=0;i<t.length;i++)if(e=e[t[i]],!e)return!1;return!!e}const IZ=new mo(N6,N6),HZ=new mo(W6,W6),FZ=new mo(V6,V6),If=new mo(G6,G6),zZ=new mo($6,$6),MFt={DEFAULT:If,SIMPLIFY:zZ,ARCO:FZ,DARK:IZ,BRIGHT:HZ},RFt={TableTheme:mo};function BFt(n){if(!n)return null;if(typeof n=="string"){const t=JHt(NZ(),n);return t?t instanceof mo?t:new mo(t,t):null}return n instanceof mo?n:new mo(n,n)}function NZ(){return Iy(MFt,vFt)}const fh={DARK:IZ,BRIGHT:HZ,ARCO:FZ,DEFAULT:If,SIMPLIFY:zZ,theme:RFt,of:BFt,get:NZ};function Ji(n,t,e){var i;if(n.internalProps.customMergeCell){const o=n.getCustomMerge(t,e);if(o)return o.range}if(!n.internalProps.enableTreeNodeMerge&&!n.isHeader(t,e)&&!(!((i=n.getBodyColumnDefine(t,e))===null||i===void 0)&&i.mergeCell))return!1;const r=n.getCellRange(t,e);return!(r.start.col===r.end.col&&r.start.row===r.end.row)&&r}class Bt{static registerComponent(t,e){Bt._components[t]=e}static getComponent(t){return Bt._components[t]}static registerFunction(t,e){Bt._functions[t]=e}static getFunction(t){return Bt._functions[t]}static registerCellType(t,e){Bt._cellTypes[t]=e}static getCellType(t){return Bt._cellTypes[t]}}Bt._components={},Bt._functions={},Bt._cellTypes={};function PFt(n,t){const e=new Array(t);for(let i=0;i<t;i++)e[i]=n(i);return e}function kFt(n,t,e,i,r,o){const s=PFt(n,e);s.sort((a,l)=>i(o(a),o(l),r));for(let a=0;a<e;a++)t(a,s[a])}function EFt(n){if(OZ.isObject(n)){const t=n;if(Y(t.get)&&Y(t.set))return!0}return!1}const B_={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function Rh(n,t){const e=Ie(n);if(aa(e)){const i=e.then(r=>(t(r),r));return t(i),i}return e}function Q1(n,t,e,i,r,o){if(n==null)return;if(aa(n))return n.then(l=>Q1(l,t,e,i,r,o));const s=EFt(t)?t.get:t;if((s===void 0||s==="")&&Array.isArray(n))return n[e-r.leftRowSeriesNumberCount];if(pn(n)&&s in n)return Rh(n[s],o);if(typeof s=="function")return Rh(s(n,e,i,r),o);if(Array.isArray(s))return Rh($Ht(n,[...s]),o);const a=`${s}`.split(".");return a.length<=1?Rh(n[s],o):Rh(LZ(n,(l,h)=>Q1(l,h,e,i,r,rFt),...a),o)}function hf(n,t){if(!n)return t;const e=n[t];return Y(e)?e:t}let Nl=class extends AA{static get EVENT_TYPE(){return B_}constructor(t,e,i,r,o,s){var a;super(),this.addRecordRule="Object",this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.addRecordRule=e?.addRecordRule||"Object",this.registerAggregators(),this.dataSourceObj=t,this.dataConfig=e,this._get=t?.get,this.columns=r,this._source=t?.records?this.processRecords(t?.records):t,this._sourceLength=((a=this._source)===null||a===void 0?void 0:a.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=i,this.pagination=i||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},s>=1&&(this.hierarchyExpandLevel=s),this.currentIndexedData=Array.from({length:this._sourceLength},(l,h)=>h),o==="tree"&&this.initTreeHierarchyState(),this.rowHierarchyType=o,this.updatePagerData()}initTreeHierarchyState(){var t,e;this._sourceLength=((t=this._source)===null||t===void 0?void 0:t.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(r,o)=>o);let i=this._sourceLength;for(let r=0;r<i;r++){const o=this.currentIndexedData[r],s=this.getOriginalRecord(o);if(!s)continue;const a=(e=s.filteredChildren)!==null&&e!==void 0?e:s.children;if(a?.length>0){if(this.hierarchyExpandLevel>1?!s.hierarchyState&&(s.hierarchyState=Lt.expand):!s.hierarchyState&&(s.hierarchyState=Lt.collapse),this.hasHierarchyStateExpand=!0,s.hierarchyState===Lt.collapse)continue;const l=this.initChildrenNodeHierarchy(o,this.hierarchyExpandLevel,2,s);r+=l,i+=l}else s.children===!0&&!s.hierarchyState&&(s.hierarchyState=Lt.collapse)}}supplementConfig(t,e,i,r){var o;this.columns=e,this._sourceLength=((o=this._source)===null||o===void 0?void 0:o.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=t,this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},r>=1&&(this.hierarchyExpandLevel=r),this.currentIndexedData=Array.from({length:this._sourceLength},(s,a)=>a),i==="tree"&&this.initTreeHierarchyState(),this.rowHierarchyType=i,this.updatePagerData()}registerAggregator(t,e){this.registedAggregators[t]=e}registerAggregators(){this.registerAggregator(ki.RECORD,CHt),this.registerAggregator(ki.SUM,SHt),this.registerAggregator(ki.COUNT,AHt),this.registerAggregator(ki.MAX,MHt),this.registerAggregator(ki.MIN,RHt),this.registerAggregator(ki.AVG,THt),this.registerAggregator(ki.NONE,wHt),this.registerAggregator(ki.CUSTOM,xHt)}updateColumns(t){this.columns=t}_generateFieldAggragations(){const t=this.columns;this.fieldAggregators=[];const e=r=>{delete r.vtable_aggregator;const o=r.field,s=r.aggregation;if(s)if(Array.isArray(s))for(const a of s){const l=new this.registedAggregators[a.aggregationType]({field:o,formatFun:a.formatFun,isRecord:!0,aggregationFun:a.aggregationFun});this.fieldAggregators.push(l),r.vtable_aggregator||(r.vtable_aggregator=[]),r.vtable_aggregator.push(l)}else{const a=new this.registedAggregators[s.aggregationType]({field:o,formatFun:s.formatFun,isRecord:!0,aggregationFun:s.aggregationFun});this.fieldAggregators.push(a),r.vtable_aggregator=a}},i=r=>{if(r&&r.length!==0)for(const o of r)e(o),o.columns&&i(o.columns)};i(t)}processRecords(t){var e,i,r,o,s,a,l,h;this._generateFieldAggragations();const u=[],d=this.fieldAggregators.length>=1;if(((i=(e=this.dataConfig)===null||e===void 0?void 0:e.filterRules)===null||i===void 0?void 0:i.length)>=1||((r=this.lastFilterRules)===null||r===void 0?void 0:r.length)>=1||d){for(let c=0,f=t.length;c<f;c++){const g=t[c];g!=null&&(((s=(o=this.dataConfig)===null||o===void 0?void 0:o.filterRules)===null||s===void 0?void 0:s.length)>=1?this.filterRecord(g)&&(u.push(g),this.rowHierarchyType==="tree"&&g.children&&(g.filteredChildren=this.filteredChildren(g.children)),d&&this.processRecord(g)):((a=this.lastFilterRules)===null||a===void 0?void 0:a.length)>=1?(this.clearFilteredChildren(g),d&&this.processRecord(g)):d&&this.processRecord(g))}if(((h=(l=this.dataConfig)===null||l===void 0?void 0:l.filterRules)===null||h===void 0?void 0:h.length)>=1)return u}return t}filteredChildren(t){const e=[];for(let i=0,r=t.length;i<r;i++){const o=t[i];this.filterRecord(o)&&(e.push(o),o.children&&(o.filteredChildren=this.filteredChildren(o.children)))}return e}processRecord(t){for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t)}initChildrenNodeHierarchy(t,e,i,r){var o,s,a;let l=0;const h=r.filteredChildren?r.filteredChildren.length:(s=(o=r.children)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0;for(let u=0;u<h;u++){(i<=e||r.hierarchyState===Lt.expand)&&(l+=1);const d=r.filteredChildren?r.filteredChildren[u]:r.children[u],c=Array.isArray(t)?t.concat(u):[t,u];(i<=e||r.hierarchyState===Lt.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+l,0,c),(d.filteredChildren?d.filteredChildren.length>0:((a=d.children)===null||a===void 0?void 0:a.length)>0)&&(i<e||d.hierarchyState===Lt.expand?(!d.hierarchyState&&(d.hierarchyState=Lt.expand),this.hasHierarchyStateExpand=!0):!d.hierarchyState&&(d.hierarchyState=Lt.collapse)),d.hierarchyState===Lt.expand&&(l+=this.initChildrenNodeHierarchy(c,e,i+1,d)),d.children===!0&&!d.hierarchyState&&(d.hierarchyState=Lt.collapse)}return l}updatePagination(t){this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){const{currentIndexedData:t}=this,{perPageCount:e,currentPage:i}=this.pagination,r=e*(i||0),o=r+e;if(this._currentPagerIndexedData.length=0,t&&t.length>0){let s=-1;for(let a=0;a<t.length;a++)if((Array.isArray(t[a])&&t[a].length===1||!Array.isArray(t[a]))&&s++,s>=r&&s<o)this._currentPagerIndexedData.push(t[a]);else if(s>=o)break}else if(this._sourceLength>0)throw new Error("currentIndexedData should has values!")}getRecordIndexPaths(t){return this._currentPagerIndexedData[t]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(t){return this.getOriginalRecord(hf(this.currentPagerIndexedData,t))}getRaw(t){return this.getRawRecord(hf(this.currentPagerIndexedData,t))}getIndexKey(t){return hf(this.currentPagerIndexedData,t)}getTableIndex(t){return Array.isArray(t)?this.rowHierarchyType==="tree"?this.currentPagerIndexedData.findIndex(e=>UIt(e,t)):this.currentPagerIndexedData.findIndex(e=>e===t[0]):this.currentPagerIndexedData.findIndex(e=>e===t)}getField(t,e,i,r,o){return this.getOriginalField(hf(this.currentPagerIndexedData,t),e,i,r,o)}getRawField(t,e,i,r,o){return this.getRawFieldData(hf(this.currentPagerIndexedData,t),e,i,r,o)}hasField(t,e){return this.hasOriginalField(hf(this.currentPagerIndexedData,t),e)}getHierarchyState(t){var e;const i=this.getOriginalRecord(this.currentPagerIndexedData[t]);if(i?.hierarchyState){const r=i.hierarchyState;if(((e=i.children)===null||e===void 0?void 0:e.length)>0||i.children===!0)return r}return null}toggleHierarchyState(t,e,i){const r=this.currentIndexedData.slice(0),o=this.getIndexKey(t),s=this.getHierarchyState(t),a=this.getOriginalRecord(o);if(this.clearSortedIndexMap(),s===Lt.collapse)a.hierarchyState=Lt.expand,this.pushChildrenNode(o,Lt.expand,a),this.hasHierarchyStateExpand=!0;else if(s===Lt.expand){const u=RA(o,s,a);this.currentIndexedData.splice(this.currentIndexedData.indexOf(o)+1,u),a.hierarchyState=Lt.collapse}this.updatePagerData();const l=[],h=[];if(s===Lt.collapse){const u=this.currentIndexedData.length-r.length;for(let d=0;d<u;d++)l.push(t+d+1)}else if(s===Lt.expand){const u=r.length-this.currentIndexedData.length;for(let d=0;d<u;d++)h.push(t+d+1)}return{add:l,remove:h}}pushChildrenNode(t,e,i){var r,o;if(!e||e===Lt.collapse||e===Lt.none)return 0;let s=0;const a=i.filteredChildren?i.filteredChildren:i.children;if(a){const l=Array.from({length:a.length},(h,u)=>u);(r=this.lastSortStates)===null||r===void 0||r.forEach(h=>{h.order!=="normal"&&kFt(u=>Y(l[u])?l[u]:l[u]=u,(u,d)=>{l[u]=d},a.length,h.orderFn,h.order,u=>this.getOriginalField(Array.isArray(t)?t.concat([u]):[t,u],h.field))});for(let h=0;h<l.length;h++){s+=1;const u=Array.isArray(t)?t.concat([l[h]]):[t,l[h]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+s,0,u);const d=this.getOriginalRecord(u);!d.hierarchyState&&((o=d.filteredChildren)!==null&&o!==void 0?o:d.children)&&(d.hierarchyState=Lt.collapse),s+=this.pushChildrenNode(u,d.hierarchyState,a[l[h]])}}return s}changeFieldValue(t,e,i,r,o,s){var a;if(i!==null&&e>=0){const l=this.getIndexKey(e);if(this.cacheBeforeChangedRecord(l,s),i!==void 0&&i!==""||(i=r-s.leftRowSeriesNumberCount),typeof i=="string"||typeof i=="number"){const h=(a=this.beforeChangedRecordsMap.get(l.toString()))===null||a===void 0?void 0:a[i],u=this.getOriginalRecord(l);let d=t;typeof h=="number"&&jHt(t)&&(d=parseFloat(t)),aa(u)?u.then(c=>{c[i]=d}).catch(c=>{}):u?u[i]=d:(this.records[l]=this.addRecordRule==="Array"?[]:{},this.records[l][i]=d)}}}cacheBeforeChangedRecord(t,e){var i;if(!this.beforeChangedRecordsMap.has(t.toString())){const r=this.getOriginalRecord(t);this.beforeChangedRecordsMap.set(t.toString(),(i=kc(r,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))!==null&&i!==void 0?i:{})}}setRecord(t,e){var i,r;let o=!0;if(((r=(i=this.dataConfig)===null||i===void 0?void 0:i.filterRules)===null||r===void 0?void 0:r.length)>=1&&(this.filterRecord(t)?this.rowHierarchyType==="tree"&&t.children&&(t.filteredChildren=this.filteredChildren(t.children)):o=!1),o&&Array.isArray(this.records)){const s=this.getIndexKey(e);Array.isArray(s)||this.records.splice(s,1,t)}}addRecord(t,e){var i;if(Array.isArray(this.records)){this.records.splice(e,0,t),this.adjustBeforeChangedRecordsMap(e,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let r=0;r<this.fieldAggregators.length;r++)this.fieldAggregators[r].push(t);if(this.rowHierarchyType==="tree"&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;const{perPageCount:r,currentPage:o}=this.pagination;e<r*(o||0)+r&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();!((i=this.dataSourceObj)===null||i===void 0)&&i.added&&this.dataSourceObj.added(e,1)}}addRecords(t,e){var i;if(Array.isArray(this.records)){if(Array.isArray(t)){this.records.splice(e,0,...t),this.adjustBeforeChangedRecordsMap(e,t.length);for(let r=0;r<t.length;r++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length;for(let r=0;r<this.fieldAggregators.length;r++)for(let o=0;o<t.length;o++)this.fieldAggregators[r].push(t[o])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;const{perPageCount:r,currentPage:o}=this.pagination;e<r*(o||0)+r&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();!((i=this.dataSourceObj)===null||i===void 0)&&i.added&&this.dataSourceObj.added(e,t.length)}}addRecordForSorted(t){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(t),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(t){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(t)){this.records.push(...t);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(t,e,i="add"){for(let r=this.beforeChangedRecordsMap.size-1;r>=t;r--){const o=this.beforeChangedRecordsMap.get(r.toString());this.beforeChangedRecordsMap.delete(r.toString()),this.beforeChangedRecordsMap.set((r+(i==="add"?e:-e)).toString(),o)}}deleteRecords(t){var e;if(Array.isArray(this.records)){const i=[],r=t.sort((o,s)=>s-o);for(let o=0;o<r.length;o++){const s=r[o];if(s>=this._sourceLength||s<0)continue;this.adjustBeforeChangedRecordsMap(s,1,"delete"),i.push(s);const a=this.records[s];for(let l=0;l<this.fieldAggregators.length;l++)this.fieldAggregators[l].deleteRecord(a);this.records.splice(s,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),!((e=this.dataSourceObj)===null||e===void 0)&&e.deleted&&this.dataSourceObj.deleted(i),i}return[]}deleteRecordsForSorted(t){if(Array.isArray(this.records)){const e=t.sort((i,r)=>r-i);for(let i=0;i<e.length;i++){const r=e[i];if(r>=this._sourceLength||r<0)continue;const o=this.currentIndexedData[r];this.records.splice(o,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(t,e){const i=[];for(let r=0;r<e.length;r++){const o=e[r];if(Array.isArray(o))this.beforeChangedRecordsMap.delete(o.toString()),i.push(o),o.slice(0,-1).reduce((s,a)=>(s[a]===void 0&&(s[a]={}),s[a].children),this.records)[o[o.length-1]]=t[r];else{if(o>=this._sourceLength||o<0)continue;this.beforeChangedRecordsMap.delete(o.toString()),i.push(o);for(let s=0;s<this.fieldAggregators.length;s++)this.fieldAggregators[s].updateRecord(this.records[o],t[r]);this.records[o]=t[r]}}return this.userPagination&&this.updatePagerData(),i}updateRecordsForSorted(t,e){for(let i=0;i<e.length;i++){const r=e[i];if(r>=this._sourceLength||r<0)continue;const o=this.currentIndexedData[r];if(typeof o!="number")return;this.beforeChangedRecordsMap.delete(o.toString()),this.records[o]=t[i]}this.sortedIndexMap.clear()}sort(t){t=(Array.isArray(t)?t:[t]).filter(o=>{const s=this.columns.find(a=>a.field===o.field);return s?.sort!==!1&&o.order!=="normal"}),this.lastSortStates=t;let e=t.map(o=>this.sortedIndexMap.get(o?.field)||{asc:[],desc:[],normal:[]}),i=null;if(e.length>0&&(i=t.reduce((o,s,a)=>{var l;const h=(l=e[a])===null||l===void 0?void 0:l[s.order];return h&&h.length>0?h:o},null),i&&i.length>0))return this.currentIndexedData=i,this.updatePagerData(),void this.fireListeners(B_.CHANGE_ORDER,null);const r=Array.from({length:this._sourceLength},(o,s)=>s);if(r.sort((o,s)=>{const a=this.getOriginalRecord(o),l=this.getOriginalRecord(s),h=a==null||typeof a=="object"&&Object.keys(a).length===0,u=l==null||typeof l=="object"&&Object.keys(l).length===0;return t.reduce((d,c)=>{if(d!==0)return d;if(c.order==="asc"||c.order==="desc"){if(h&&!u)return 1;if(!h&&u)return-1;if(h&&u)return o-s}else if(h||u)return o-s;return(c.orderFn||(c.order!=="desc"?(f,g)=>f===g?0:f>g?1:-1:(f,g)=>f===g?0:f<g?1:-1))(this.getOriginalField(o,c.field),this.getOriginalField(s,c.field),c.order)},0)}),this.currentIndexedData=r,this.hierarchyExpandLevel){let o=r.length;for(let s=0;s<o;s++){const a=this.getOriginalRecord(r[s]),l=this.pushChildrenNode(r[s],a.hierarchyState,this.getOriginalRecord(r[s]));o+=l,s+=l}}if(!e.length){e=t.map(()=>({asc:[],desc:[],normal:[]}));for(let o=0;o<t.length;o++)this.sortedIndexMap.set(t[o].field,e[o])}t.forEach((o,s)=>{e[s][o.order]=r.slice()}),this.updatePagerData(),this.fireListeners(B_.CHANGE_ORDER,null)}setSortedIndexMap(t,e){this.sortedIndexMap.set(t,e)}clearFilteredChildren(t){var e,i;t.filteredChildren=void 0;for(let r=0;r<((i=(e=t.children)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0);r++)this.clearFilteredChildren(t.children[r])}filterRecord(t){var e,i,r;let o=!0;for(let s=0;s<((e=this.dataConfig.filterRules)===null||e===void 0?void 0:e.length);s++){const a=(i=this.dataConfig)===null||i===void 0?void 0:i.filterRules[s];if(a.filterKey){const l=t[a.filterKey];if(a.filteredValues.indexOf(l)===-1){o=!1;break}}else if(!(!((r=a.filterFunc)===null||r===void 0)&&r.call(a,t))){o=!1;break}}return o}updateFilterRulesForSorted(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords((i=(e=this.dataSourceObj)===null||e===void 0?void 0:e.records)!==null&&i!==void 0?i:this.dataSourceObj),this._sourceLength=((r=this._source)===null||r===void 0?void 0:r.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(o,s)=>s),this.rowHierarchyType==="tree"&&this.initTreeHierarchyState(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(t){var e,i,r;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords((i=(e=this.dataSourceObj)===null||e===void 0?void 0:e.records)!==null&&i!==void 0?i:this.dataSourceObj),this._sourceLength=((r=this._source)===null||r===void 0?void 0:r.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(o,s)=>s),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.rowHierarchyType==="tree"&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((t,e)=>{this.lastSortStates.some(i=>i.field===e)?this.lastSortStates.forEach(i=>{i.order==="asc"?(t.desc=[],t.normal=[]):i.order==="desc"?(t.asc=[],t.normal=[]):(t.asc=[],t.desc=[])}):this.sortedIndexMap.delete(e)})}get sourceLength(){return this._sourceLength}set sourceLength(t){this._sourceLength!==t&&(this._sourceLength=t,this.fireListeners(B_.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var t;(t=super.release)===null||t===void 0||t.call(this),this.lastFilterRules=null,this.clearSortedMap(),this.clearCurrentIndexedData(),this.currentPagerIndexedData.length=0}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(t=>{t.asc&&(t.asc.length=0),t.desc&&(t.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(t){let e;return e=this.dataSourceObj.records?Array.isArray(t)?Xk(this.records,t):this.records[t]:this._get(t),Rh(e,i=>{this.recordPromiseCallBack(t,i)})}getRawRecord(t){var e,i;if(!((e=this.beforeChangedRecordsMap)===null||e===void 0)&&e.has(t.toString()))return(i=this.beforeChangedRecordsMap)===null||i===void 0?void 0:i.get(t.toString());let r;return r=this.dataSourceObj.records?Array.isArray(t)?Xk(this.records,t):this.records[t]:this._get(t),Rh(r,o=>{this.recordPromiseCallBack(t,o)})}getOriginalField(t,e,i,r,o){if(e!==null)return Q1(this.getOriginalRecord(t),e,i,r,o,s=>{this.fieldPromiseCallBack(t,e,s)})}getRawFieldData(t,e,i,r,o){if(e!==null)return Q1(this.getRawRecord(t),e,i,r,o,s=>{this.fieldPromiseCallBack(t,e,s)})}hasOriginalField(t,e){if(e===null)return!1;if(typeof e=="function")return!0;const i=this.getOriginalRecord(t);return!!(i&&e in i)}fieldPromiseCallBack(t,e,i){}recordPromiseCallBack(t,e){}canChangeOrder(t,e){var i;if(!((i=this.dataSourceObj)===null||i===void 0)&&i.canChangeOrder)return this.dataSourceObj.canChangeOrder(t,e);if(this.hasHierarchyStateExpand){let r=this.currentPagerIndexedData[t],o=this.currentPagerIndexedData[e];if(r=Array.isArray(r)?[...r]:[r],o=Array.isArray(o)?[...o]:[o],e>t&&o.length>r.length){let s=this.currentPagerIndexedData[e+1];s=Array.isArray(s)?[...s]:[s],s.length<o.length&&o.splice(o.length-1,1)}if(r.length===o.length){for(let s=0;s<=r.length-2;s++)if(r[s]!==o[s])return!1;return!0}return!1}return!0}changeOrder(t,e){var i,r,o;if(!((i=this.dataSourceObj)===null||i===void 0)&&i.changeOrder)this.dataSourceObj.changeOrder(t,e);else if(!(!((r=this.lastSortStates)===null||r===void 0)&&r.some(s=>s.order==="asc"||s.order==="desc"))&&this.canChangeOrder(t,e))if(this.hasHierarchyStateExpand){let s,a,l=this.currentPagerIndexedData[t],h=this.currentPagerIndexedData[e];if(l=Array.isArray(l)?[...l]:[l],h=Array.isArray(h)?[...h]:[h],l.length>1||h.length>1){if(e>t&&h.length>l.length){let u=this.currentPagerIndexedData[e+1];u=Array.isArray(u)?[...u]:[u],u.length<h.length&&h.splice(h.length-1,1)}if(s=l.splice(l.length-1,1)[0],a=h.splice(h.length-1,1)[0],l.length>=1){const u=this.getOriginalRecord(l);if(u){const d=u.filteredChildren?u.filteredChildren.splice(s,1):u.children.splice(s,1);d.unshift(a,0),Array.prototype.splice.apply((o=u.filteredChildren)!==null&&o!==void 0?o:u.children,d)}}else{const u=this.records.splice(s,1);u.unshift(a,0),Array.prototype.splice.apply(this.records,u)}}else this.exchangeRecordData(t,e);this.restoreTreeHierarchyState(),this.updatePagerData()}else this.exchangeRecordData(t,e)}exchangeRecordData(t,e){const i=this.getRecordIndexPaths(t),r=this.getRecordIndexPaths(e),o=this.records.splice(i,1);o.unshift(r,0),Array.prototype.splice.apply(this.records,o)}restoreTreeHierarchyState(){var t,e;if(this.hierarchyExpandLevel){for(let r=0;r<this._sourceLength;r++){const o=this.getOriginalRecord(r);o&&((t=o.filteredChildren)!==null&&t!==void 0?t:o.children)&&!o.hierarchyState&&(o.hierarchyState=Lt.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(r,o)=>o);let i=this._sourceLength;for(let r=0;r<i;r++){const o=this.currentIndexedData[r],s=this.getOriginalRecord(o);if(!s)continue;const a=(e=s.filteredChildren)!==null&&e!==void 0?e:s.children;if(a?.length>0&&s.hierarchyState===Lt.expand){this.hasHierarchyStateExpand=!0;const l=this.restoreChildrenNodeHierarchy(o,s);r+=l,i+=l}else s.children===!0&&!s.hierarchyState&&(s.hierarchyState=Lt.collapse)}}}restoreChildrenNodeHierarchy(t,e){var i,r;let o=0;const s=(i=e.filteredChildren)!==null&&i!==void 0?i:e.children,a=(r=s?.length)!==null&&r!==void 0?r:0;for(let l=0;l<a;l++){e.hierarchyState===Lt.expand&&(o+=1);const h=s[l],u=Array.isArray(t)?t.concat(l):[t,l];e.hierarchyState===Lt.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+o,0,u),o+=this.restoreChildrenNodeHierarchy(u,h)}return o}_setNodeStateRecursive(t,e){var i;if(!t)return;const r=(i=t.filteredChildren)!==null&&i!==void 0?i:t.children;if(r&&(Array.isArray(r)?r.length>0:r===!0)&&(t.hierarchyState=e),r&&Array.isArray(r))for(const o of r)this._setNodeStateRecursive(o,e)}expandAllNodes(){if(Array.isArray(this._source)){for(const t of this._source)this._setNodeStateRecursive(t,Lt.expand);this.hasHierarchyStateExpand=!0,this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}collapseAllNodes(){if(Array.isArray(this._source)){for(const t of this._source)this._setNodeStateRecursive(t,Lt.collapse);this.clearSortedIndexMap(),this.restoreTreeHierarchyState(),this.lastSortStates&&this.lastSortStates.length>0?this.sort(this.lastSortStates):this.updatePagerData()}}};Nl.EMPTY=new Nl({get(){},length:0});function Xk(n,t){var e;let i=n;for(let r=0;r<t.length;r++){const o=t[r];if(!i[o])return;i=i[o];const s=(e=i.filteredChildren)!==null&&e!==void 0?e:i?.children;s&&r+1<t.length&&(i=s)}return i}function Y6(n,t){return n.sort((e,i)=>{var r,o;pt(e)&&(e=[e]),pt(i)&&(i=[i]);const s=Math.max(e.length,i.length);for(let a=0;a<s;a++){const l=(r=e[a])!==null&&r!==void 0?r:-1,h=(o=i[a])!==null&&o!==void 0?o:-1;if(l!==h)return h-l}return 0})}var LFt=Array.isArray,SD=LFt,OFt=typeof $y=="object"&&$y&&$y.Object===Object&&$y,DFt=OFt,IFt=DFt,HFt=typeof self=="object"&&self&&self.Object===Object&&self,FFt=IFt||HFt||Function("return this")(),AD=FFt,zFt=AD,NFt=zFt.Symbol,TD=NFt,K6=TD,WZ=Object.prototype,WFt=WZ.hasOwnProperty,VFt=WZ.toString,xv=K6?K6.toStringTag:void 0;function GFt(n){var t=WFt.call(n,xv),e=n[xv];try{n[xv]=void 0;var i=!0}catch{}var r=VFt.call(n);return i&&(t?n[xv]=e:delete n[xv]),r}var $Ft=GFt,jFt=Object.prototype,UFt=jFt.toString;function XFt(n){return UFt.call(n)}var YFt=XFt,q6=TD,KFt=$Ft,qFt=YFt,ZFt="[object Null]",JFt="[object Undefined]",Z6=q6?q6.toStringTag:void 0;function QFt(n){return n==null?n===void 0?JFt:ZFt:Z6&&Z6 in Object(n)?KFt(n):qFt(n)}var VZ=QFt;function tzt(n){return n!=null&&typeof n=="object"}var ezt=tzt,izt=VZ,nzt=ezt,rzt="[object Symbol]";function ozt(n){return typeof n=="symbol"||nzt(n)&&izt(n)==rzt}var MD=ozt,szt=SD,azt=MD,lzt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hzt=/^\w*$/;function uzt(n,t){if(szt(n))return!1;var e=typeof n;return e=="number"||e=="symbol"||e=="boolean"||n==null||azt(n)?!0:hzt.test(n)||!lzt.test(n)||t!=null&&n in Object(t)}var dzt=uzt;function czt(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}var GZ=czt,fzt=VZ,gzt=GZ,pzt="[object AsyncFunction]",vzt="[object Function]",mzt="[object GeneratorFunction]",yzt="[object Proxy]";function bzt(n){if(!gzt(n))return!1;var t=fzt(n);return t==vzt||t==mzt||t==pzt||t==yzt}var _zt=bzt,Czt=AD,wzt=Czt["__core-js_shared__"],xzt=wzt,QR=xzt,J6=function(){var n=/[^.]+$/.exec(QR&&QR.keys&&QR.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function Szt(n){return!!J6&&J6 in n}var Azt=Szt,Tzt=Function.prototype,Mzt=Tzt.toString;function Rzt(n){if(n!=null){try{return Mzt.call(n)}catch{}try{return n+""}catch{}}return""}var Bzt=Rzt,Pzt=_zt,kzt=Azt,Ezt=GZ,Lzt=Bzt,Ozt=/[\\^$.*+?()[\]{}|]/g,Dzt=/^\[object .+?Constructor\]$/,Izt=Function.prototype,Hzt=Object.prototype,Fzt=Izt.toString,zzt=Hzt.hasOwnProperty,Nzt=RegExp("^"+Fzt.call(zzt).replace(Ozt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wzt(n){if(!Ezt(n)||kzt(n))return!1;var t=Pzt(n)?Nzt:Dzt;return t.test(Lzt(n))}var Vzt=Wzt;function Gzt(n,t){return n?.[t]}var $zt=Gzt,jzt=Vzt,Uzt=$zt;function Xzt(n,t){var e=Uzt(n,t);return jzt(e)?e:void 0}var $Z=Xzt,Yzt=$Z,Kzt=Yzt(Object,"create"),PA=Kzt,Q6=PA;function qzt(){this.__data__=Q6?Q6(null):{},this.size=0}var Zzt=qzt;function Jzt(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}var Qzt=Jzt,t3t=PA,e3t="__lodash_hash_undefined__",i3t=Object.prototype,n3t=i3t.hasOwnProperty;function r3t(n){var t=this.__data__;if(t3t){var e=t[n];return e===e3t?void 0:e}return n3t.call(t,n)?t[n]:void 0}var o3t=r3t,s3t=PA,a3t=Object.prototype,l3t=a3t.hasOwnProperty;function h3t(n){var t=this.__data__;return s3t?t[n]!==void 0:l3t.call(t,n)}var u3t=h3t,d3t=PA,c3t="__lodash_hash_undefined__";function f3t(n,t){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=d3t&&t===void 0?c3t:t,this}var g3t=f3t,p3t=Zzt,v3t=Qzt,m3t=o3t,y3t=u3t,b3t=g3t;function Pp(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}Pp.prototype.clear=p3t;Pp.prototype.delete=v3t;Pp.prototype.get=m3t;Pp.prototype.has=y3t;Pp.prototype.set=b3t;var _3t=Pp;function C3t(){this.__data__=[],this.size=0}var w3t=C3t;function x3t(n,t){return n===t||n!==n&&t!==t}var S3t=x3t,A3t=S3t;function T3t(n,t){for(var e=n.length;e--;)if(A3t(n[e][0],t))return e;return-1}var kA=T3t,M3t=kA,R3t=Array.prototype,B3t=R3t.splice;function P3t(n){var t=this.__data__,e=M3t(t,n);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():B3t.call(t,e,1),--this.size,!0}var k3t=P3t,E3t=kA;function L3t(n){var t=this.__data__,e=E3t(t,n);return e<0?void 0:t[e][1]}var O3t=L3t,D3t=kA;function I3t(n){return D3t(this.__data__,n)>-1}var H3t=I3t,F3t=kA;function z3t(n,t){var e=this.__data__,i=F3t(e,n);return i<0?(++this.size,e.push([n,t])):e[i][1]=t,this}var N3t=z3t,W3t=w3t,V3t=k3t,G3t=O3t,$3t=H3t,j3t=N3t;function kp(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}kp.prototype.clear=W3t;kp.prototype.delete=V3t;kp.prototype.get=G3t;kp.prototype.has=$3t;kp.prototype.set=j3t;var U3t=kp,X3t=$Z,Y3t=AD,K3t=X3t(Y3t,"Map"),q3t=K3t,tV=_3t,Z3t=U3t,J3t=q3t;function Q3t(){this.size=0,this.__data__={hash:new tV,map:new(J3t||Z3t),string:new tV}}var tNt=Q3t;function eNt(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}var iNt=eNt,nNt=iNt;function rNt(n,t){var e=n.__data__;return nNt(t)?e[typeof t=="string"?"string":"hash"]:e.map}var EA=rNt,oNt=EA;function sNt(n){var t=oNt(this,n).delete(n);return this.size-=t?1:0,t}var aNt=sNt,lNt=EA;function hNt(n){return lNt(this,n).get(n)}var uNt=hNt,dNt=EA;function cNt(n){return dNt(this,n).has(n)}var fNt=cNt,gNt=EA;function pNt(n,t){var e=gNt(this,n),i=e.size;return e.set(n,t),this.size+=e.size==i?0:1,this}var vNt=pNt,mNt=tNt,yNt=aNt,bNt=uNt,_Nt=fNt,CNt=vNt;function Ep(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}Ep.prototype.clear=mNt;Ep.prototype.delete=yNt;Ep.prototype.get=bNt;Ep.prototype.has=_Nt;Ep.prototype.set=CNt;var wNt=Ep,jZ=wNt,xNt="Expected a function";function RD(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new TypeError(xNt);var e=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=e.cache;if(o.has(r))return o.get(r);var s=n.apply(this,i);return e.cache=o.set(r,s)||o,s};return e.cache=new(RD.Cache||jZ),e}RD.Cache=jZ;var SNt=RD,ANt=SNt,TNt=500;function MNt(n){var t=ANt(n,function(i){return e.size===TNt&&e.clear(),i}),e=t.cache;return t}var RNt=MNt,BNt=RNt,PNt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kNt=/\\(\\)?/g,ENt=BNt(function(n){var t=[];return n.charCodeAt(0)===46&&t.push(""),n.replace(PNt,function(e,i,r,o){t.push(r?o.replace(kNt,"$1"):i||e)}),t}),LNt=ENt;function ONt(n,t){for(var e=-1,i=n==null?0:n.length,r=Array(i);++e<i;)r[e]=t(n[e],e,n);return r}var DNt=ONt,eV=TD,INt=DNt,HNt=SD,FNt=MD,iV=eV?eV.prototype:void 0,nV=iV?iV.toString:void 0;function UZ(n){if(typeof n=="string")return n;if(HNt(n))return INt(n,UZ)+"";if(FNt(n))return nV?nV.call(n):"";var t=n+"";return t=="0"&&1/n==-1/0?"-0":t}var zNt=UZ,NNt=zNt;function WNt(n){return n==null?"":NNt(n)}var VNt=WNt,GNt=SD,$Nt=dzt,jNt=LNt,UNt=VNt;function XNt(n,t){return GNt(n)?n:$Nt(n,t)?[n]:jNt(UNt(n))}var YNt=XNt,KNt=MD;function qNt(n){if(typeof n=="string"||KNt(n))return n;var t=n+"";return t=="0"&&1/n==-1/0?"-0":t}var ZNt=qNt,JNt=YNt,QNt=ZNt;function t5t(n,t){t=JNt(t,n);for(var e=0,i=t.length;n!=null&&e<i;)n=n[QNt(t[e++])];return e&&e==i?n:void 0}var e5t=t5t,i5t=e5t;function n5t(n,t,e){var i=n==null?void 0:i5t(n,t);return i===void 0?e:i}var r5t=n5t;const o5t=_E(r5t);function s5t(n,t,e,i){(n[t]||(n[t]=new Map)).set(e,i)}class LA extends Nl{static get EVENT_TYPE(){return Nl.EVENT_TYPE}static ofArray(t,e,i,r,o,s){return new LA({get:a=>t[a],length:t.length,records:t},e,i,r,o,s)}constructor(t,e,i,r,o,s){let a;Mt(e?.groupByRules)&&(o="tree",a=!0),super(t,e,i,r,o,s),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(t){return pt(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:super.getOriginalRecord(t)}getRawRecord(t){var e,i,r,o;let s,a;if(this._isGrouped){if(s=this.getOriginRecordIndexForGroup(t),Y(s)&&((e=this.beforeChangedRecordsMap)===null||e===void 0?void 0:e.has(s.toString())))return(i=this.beforeChangedRecordsMap)===null||i===void 0?void 0:i.get(s.toString())}else if(!((r=this.beforeChangedRecordsMap)===null||r===void 0)&&r.has(t.toString()))return(o=this.beforeChangedRecordsMap)===null||o===void 0?void 0:o.get(t.toString());return pt(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:(a=this.dataSourceObj.records?Array.isArray(t)?Xk(this.records,t):this.records[t]:this._get(t),Rh(a,l=>{this.recordPromiseCallBack(t,l)}))}getOriginalField(t,e,i,r,o){const s=this._fieldCache&&this._fieldCache[t];if(s){const a=s.get(e);if(a)return a}return super.getOriginalField(t,e,i,r,o)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(t,e,i){s5t(this._fieldCache,t,e,i)}recordPromiseCallBack(t,e){this._recordCache&&(this._recordCache[t]=e)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var t;(t=super.release)===null||t===void 0||t.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var t;if(super._generateFieldAggragations(),Mt((t=this.dataConfig)===null||t===void 0?void 0:t.groupByRules)){const e=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[ki.CUSTOM]({field:"",aggregationFun:(i,r,o)=>{const s=new Map,a=[];for(let l=0;l<r.length;l++)Yk(r[l],a,s,e,0);return a}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(t){var e;const i=super.processRecords(t);return((e=this.groupAggregator)===null||e===void 0?void 0:e.value())||i}getGroupLength(){var t,e,i;return(i=(e=(t=this.dataConfig)===null||t===void 0?void 0:t.groupByRules)===null||e===void 0?void 0:e.length)!==null&&i!==void 0?i:0}updateGroup(){var t,e,i;this.clearCache();const r=this.source;this._source=this.processRecords((e=(t=this.dataSourceObj)===null||t===void 0?void 0:t.records)!==null&&e!==void 0?e:this.dataSourceObj),r&&XZ(r,this.source),this.sourceLength=((i=this.source)===null||i===void 0?void 0:i.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(o,s)=>s),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(t){const e=this.getOriginalRecord(t);if(Y(e)&&!(e.children&&e.children.length>0)){for(let i=0;i<this.dataSourceObj.records.length;i++)if(this.dataSourceObj.records[i]===e)return i}}addRecordsForGroup(t,e){if(!Mt(t)||t.length===0)return;let i=this.getOriginRecordIndexForGroup(e);(i===void 0||i>this.dataSourceObj.records)&&(i=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(i,0,...t),this.adjustBeforeChangedRecordsMap(i,t.length),this.updateGroup()}deleteRecordsForGroup(t){if(!Mt(t)||t.length===0)return;const e=Y6(t);for(let i=0;i<e.length;i++){const r=e[i];if(pt(r)&&(r>=this.sourceLength||r<0))continue;const o=this.getOriginRecordIndexForGroup(r);this.beforeChangedRecordsMap.delete(o.toString()),this.dataSourceObj.records.splice(o,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(o,1,"delete")}this.updateGroup()}updateRecordsForGroup(t,e){for(let i=0;i<e.length;i++){const r=e[i];if(pt(r)&&(r>=this.sourceLength||r<0))continue;const o=this.getOriginRecordIndexForGroup(r);this.beforeChangedRecordsMap.delete(o.toString()),this.dataSourceObj.records[o]=t[i]}this.updateGroup()}addRecordsForTree(t,e){if(Mt(t)&&t.length!==0){if(this.adjustBeforeChangedRecordsMap(e,t.length),pt(e))this.dataSourceObj.records.splice(e,0,...t);else{const i=[...e],r=i.pop(),o=this.getOriginalRecord(i);o.children?o.children.splice(r,0,...t):o.children=t}this.initTreeHierarchyState(),this.updatePagination()}}deleteRecordsForTree(t){if(!Mt(t)||t.length===0)return[];const e=Y6(t),i=[];for(let r=0;r<e.length;r++){const o=e[r];if(!pt(o)||!(o>=this.sourceLength||o<0)){if(this.beforeChangedRecordsMap.delete(o.toString()),pt(o))this.dataSourceObj.records.splice(o,1);else{const s=[...o],a=s.pop();this.getOriginalRecord(s).children.splice(a,1)}this.adjustBeforeChangedRecordsMap(o,1,"delete"),i.push(o)}}return this.initTreeHierarchyState(),this.updatePagination(),i}updateRecordsForTree(t,e){for(let i=0;i<e.length;i++){const r=e[i],o=t[i];if(!pt(r)||!(r>=this.sourceLength||r<0))if(this.beforeChangedRecordsMap.delete(r.toString()),pt(r))this.dataSourceObj.records.splice(r,1,o);else{const s=[...r],a=s.pop();this.getOriginalRecord(s).children.splice(a,1,o)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(t,e,i="add"){if(this.rowHierarchyType==="tree"){let r;r=pt(t)?[t]:t;const o=[];this.beforeChangedRecordsMap.forEach((s,a)=>{var l,h;const u=a.split(","),d=Math.max(u.length,r.length);for(let c=0;c<d;c++){const f=(l=r[c])!==null&&l!==void 0?l:-1,g=(h=Number(u[c]))!==null&&h!==void 0?h:-1;if(f<g||f===g&&c===u.length-1&&c===r.length-1)return u[c]=(g+(i==="add"?e:-e)).toString(),void o.push({originKey:a,targetKey:u.toString(),value:s})}}),o.forEach(({originKey:s,targetKey:a,value:l})=>{this.beforeChangedRecordsMap.delete(s),this.beforeChangedRecordsMap.set(a,l)})}else super.adjustBeforeChangedRecordsMap(t,e,i)}cacheBeforeChangedRecord(t,e){var i;const r=this.getOriginalRecord(t);e.internalProps.groupBy&&(t=this.getOriginRecordIndexForGroup(t)),this.beforeChangedRecordsMap.has(t.toString())||this.beforeChangedRecordsMap.set(t.toString(),(i=kc(r,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))!==null&&i!==void 0?i:{})}getGroupSeriesNumber(t){const e=this.dataSource.currentIndexedData[t],i=e.length-1;let r=e.length,o=1;for(;r>i;o++){const s=this.dataSource.currentIndexedData[t-o];r=pt(s)?1:s.length}return o-1}}function Yk(n,t,e,i,r){const o=i[r];if(!Y(o))return void t.push(n);const s=o5t(n,o);if(s!==void 0){if(e.has(s)){const a=e.get(s);return Yk(n,t[a].children,t[a].map,i,r+1)}return e.set(s,t.length),t.push({vtableMerge:!0,vtableMergeName:s,children:[],map:new Map}),Yk(n,t[t.length-1].children,t[t.length-1].map,i,r+1)}}function XZ(n,t,e,i){if(!e){e=new Map;for(let r=0;r<n.length;r++){const o=n[r];o.vtableMerge&&e.set(o.vtableMergeName,r)}}if(!i){i=new Map;for(let r=0;r<t.length;r++){const o=t[r];o.vtableMerge&&i.set(o.vtableMergeName,r)}}for(let r=0;r<n.length;r++){const o=n[r],s=t[i.get(o.vtableMergeName)];Y(s)&&(s.hierarchyState=n[r].hierarchyState),Mt(o?.children)&&Mt(s?.children)&&o.map.size!==0&&s.map.size!==0&&XZ(o.children,s.children,o.map,s.map)}}var BD={exports:{}},P_={},a5t=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),l5t=["style","variant","weight","size","lineHeight","family"],h5t=/([\.0-9]+)(.*)/,rV=function(n,t,e){var i=n.match(h5t);if(i){n=parseFloat(i[1]);var r=i[2].toLowerCase().trim(),o=Math.round(n);switch(o===n&&(n=o),r){case"em":return t===null?void 0:n*t;case"px":return n;case"pt":return n/(72/e);case"pc":return n/(6/e);case"mm":return n*(e/25.4);case"cm":return n*(e/2.54);case"in":return n*e;case"%":return t===null?void 0:t*(n/100)}}},oV={size:rV,lineHeight:rV},YZ={serif:1,"sans-serif":1,cursive:1,fantasy:1,monospace:1},u5t=BD.exports=function(n,t,e){var i=n+"-"+(t||"null")+"@"+e;if(e=e||96,typeof P_[i]<"u")return P_[i];if(t&&(t=u5t(t,null,e)),n==="inherit")return t;var r=a5t.exec(n);if(!r){P_[i]=null;return}r.shift();for(var o={},s=0;s<r.length;s++){var a=l5t[s],l=r[s];if(oV[a]&&l){var h=t&&t[a]||null,u=oV[a](l,h,e);typeof u>"u"&&a==="lineHeight"&&l?l=o.size*parseFloat(l):l=u}if(!(!l||l==="normal")){if(l==="inherit"){if(!t)return;l=t[a]}l.trim&&(l=l.trim()),o[a]=l}}Object.keys(o).length||(o=null),P_[i]=o;var d=[];o.style&&d.push(o.style),o.variant&&d.push(o.variant),o.weight&&o.weight!=="400"&&o.weight!=="normal"&&d.push(o.weight),d.push(o.size+"px"),o.lineHeight&&(d[d.length-1]+="/"+o.lineHeight+"px");var c=o.family.split(",");return o.family=c.map(function(f){return f=f.trim(),YZ[f.toLowerCase()]&&(f=f.toLowerCase()),f}),d.push(o.family),Object.defineProperty(o,"toString",{value:function(){return d.map(function(f){return Array.isArray(f)?f.map(function(g){return g.indexOf(" ")>-1?'"'+g.replace(/["']/g,"")+'"':g}).join(", "):f}).join(" ")}}),o};BD.exports.generics=YZ;var d5t=BD.exports;const c5t=_E(d5t);function f5t(n){return c5t(n)}function ce(n){var t,e,i,r;if(pt(n)||Si(n)||Mt(n)){let o=jw(n);return typeof o=="number"||typeof o=="string"?o=[o,o,o,o]:Array.isArray(o)&&(o=o.slice(0)),o}return n&&(isFinite(n.bottom)||isFinite(n.left)||isFinite(n.right)||isFinite(n.top))?[(t=n.top)!==null&&t!==void 0?t:0,(e=n.right)!==null&&e!==void 0?e:0,(i=n.bottom)!==null&&i!==void 0?i:0,(r=n.left)!==null&&r!==void 0?r:0]:[0,0,0,0]}const _C=0,KZ=1,tx=2,qZ=3,ZZ=10,JZ=11,QZ=12,g5t=9,p5t=13,v5t=10,m5t=12,y5t=32,b5t=37,_5t=46,C5t=48,w5t=57,x5t=65,S5t=90,A5t=97,T5t=122;function M5t(n){return n>=x5t&&n<=S5t}function R5t(n){return n>=A5t&&n<=T5t}function B5t(n){return R5t(n)||M5t(n)}function P5t(n){return n===g5t||n===v5t||n===m5t||n===p5t||n===y5t}function t2(n){return n>=C5t&&n<=w5t}function sV(n){return n===_5t}function aV(n){return B5t(n)||n===b5t}function O0(n){return new Error(`calc parse error: ${n}`)}function k5t(n){const t=n.replace(/calc\(/g,"(").trim(),e=[],i=t.length;for(let a=0;a<i;a++){const l=t[a],h=l.charCodeAt(0);if(l==="("||l===")")e.push({value:l,type:_C});else if(l==="*"||l==="/")e.push({value:l,type:tx});else if(l==="+"||l==="-")a=r(l,a+1)-1;else if(t2(h)||sV(h))a=o(l,a+1)-1;else if(!P5t(h))throw O0(n)}function r(a,l){if(l<i){const h=t[l],u=h.charCodeAt(0);if(t2(u)||sV(u))return o(a+h,l+1)}return e.push({value:a,type:tx}),l}function o(a,l){let h=l;for(;h<i;h++){const u=t[h],d=u.charCodeAt(0);if(t2(d))a+=u;else{if(u!=="."){if(aV(d))return s(a,u,h+1);break}if(a.indexOf(".")>=0)throw O0(n);a+=u}}if(a===".")throw O0(n);return e.push({value:parseFloat(a),type:qZ}),h}function s(a,l,h){let u=h;for(;u<i;u++){const d=t[u];if(!aV(d.charCodeAt(0)))break;l+=d}return e.push({value:parseFloat(a),unit:l,type:KZ}),u}return e}const lV={"*":3,"/":3,"+":2,"-":2};function tJ(n,t){function e(r){const o=r.pop(),s=r.pop(),a=r.pop();if(!(a&&a.nodeType&&s&&s.type===tx&&o&&o.nodeType))throw O0(t);return{nodeType:JZ,left:a,op:s,right:o}}const i=[];for(;n.length;){const r=n.shift();if(r.type===_C&&r.value==="("){let o=0;const s=EZ.findIndex(n,a=>{if(a.type===_C&&a.value==="(")o++;else if(a.type===_C&&a.value===")"){if(!o)return!0;o--}return!1});if(s===-1)throw O0(t);i.push(tJ(n.splice(0,s),t)),n.shift()}else if(r.type===tx){if(i.length>=3){const o=i[i.length-2].value;lV[r.value]<=lV[o]&&i.push(e(i))}i.push(r)}else if(r.type===KZ){const{value:o,unit:s}=r;i.push({nodeType:ZZ,value:o,unit:s})}else r.type===qZ&&i.push({nodeType:QZ,value:r.value})}for(;i.length>1;)i.push(e(i));return i[0]}function E5t(n){return tJ(k5t(n),n)}function Kk(n,t){if(n.nodeType===JZ){const e=Kk(n.left,t),i=Kk(n.right,t);switch(n.op.value){case"+":return e+i;case"-":return e-i;case"*":return e*i;case"/":return e/i;default:throw new Error(`calc error. unknown operator: ${n.op.value}`)}}else if(n.nodeType===ZZ)switch(n.unit){case"%":return n.value*t.full/100;case"px":return n.value;default:throw new Error(`calc error. unknown unit: ${n.unit}`)}else if(n.nodeType===QZ)return n.value;throw new Error("calc error.")}function L5t(n,t){return Kk(E5t(n),t)}function O5t(n,t){return typeof n=="string"?L5t(n.trim(),t):n-0}function D5t(n){return!Pe(n)&&(!!pt(n)||+n==+n)}function e2(n){return!!Si(n)&&!!n.endsWith("%")&&D5t(n.substring(0,n.length-1))}function I5t(n,t="vtable"){var e,i;const r=document.createElement("div");r.setAttribute("tabindex","0"),r.classList.add(t),r.style.outline="none",r.style.margin=`${n.top}px ${n.right}px ${n.bottom}px ${n.left}px`;const o=(r.offsetWidth||((e=r.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,s=(r.offsetHeight||((i=r.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;return r.style.width=o&&o-n.left-n.right+"px"||"0px",r.style.height=s&&s-n.top-n.bottom+"px"||"0px",r}function H5t(n,t){var e,i;n.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;const r=(n.offsetWidth||((e=n.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,o=(n.offsetHeight||((i=n.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;n.style.width=r&&r-t.left-t.right+"px"||"0px",n.style.height=o&&o-t.top-t.bottom+"px"||"0px"}function eJ(n,t){const{dataSourceEventIds:e}=n.internalProps;e&&e.forEach(i=>n.internalProps.handler.off(i)),t(n),n.internalProps.dataSourceEventIds=[n.internalProps.handler.on(n.internalProps.dataSource,Nl.EVENT_TYPE.CHANGE_ORDER,()=>{n.dataSource.hierarchyExpandLevel&&n.refreshRowColCount(),n.render()})]}function hV(n,t=[]){eJ(n,()=>{n.internalProps.records=t;const e=n.internalProps.dataSource=LA.ofArray(t,n.internalProps.dataConfig,n.pagination,n.internalProps.columns,n.internalProps.layoutMap.rowHierarchyType,iJ(n));n.addReleaseObj(e)})}function iJ(n){var t;return n.options.hierarchyExpandLevel?n.options.hierarchyExpandLevel:n.internalProps.groupBy?1/0:!((t=n._hasHierarchyTreeHeader)===null||t===void 0)&&t.call(n)?1:void 0}function F5t(n,t){eJ(n,()=>{n.internalProps.dataSource&&n.internalProps.releaseList.forEach(e=>{e instanceof Nl&&(e.release(),n.internalProps.releaseList.splice(n.internalProps.releaseList.indexOf(e),1))}),t?t instanceof Nl?(n.internalProps.dataSource=t,n.internalProps.dataSource.supplementConfig(n.pagination,n.options.columns,n.internalProps.layoutMap.rowHierarchyType,iJ(n))):n.internalProps.dataSource=new LA(t):n.internalProps.dataSource=Nl.EMPTY,n.addReleaseObj(n.internalProps.dataSource),n.internalProps.records=null})}function z5t(n,t){if(!n.internalProps.frozenRowCount)return null;let{scrollTop:e}=n;const i=n.internalProps.frozenRowCount;for(let r=0;r<i;r++){const o=n.getRowHeight(r),s=e+o;if(s>t)return{top:e,row:r,bottom:s,height:o};e=s}return null}function N5t(n,t){if(!n.internalProps.frozenColCount)return null;let{scrollLeft:e}=n;const i=n.internalProps.frozenColCount;for(let r=0;r<i;r++){const o=n.getColWidth(r),s=e+o;if(s>t)return{left:e,col:r,right:s,width:o};e=s}return null}function uf(n,t){return Math.round(O5t(t,n.internalProps.calcWidthContext))}function W5t(n,t){return n?n.min&&n.min>t?n.min:n.max&&n.max<t?n.max:t:t}function V5t(n){let t=0,e=0;n.frozenColCount>0&&(t=n.getFrozenColsWidth()),n.rightFrozenColCount>0&&(e=n.getRightFrozenColsWidth());let i=0,r=0;return n.frozenRowCount>0&&(i=n.getFrozenRowsHeight()),n.bottomFrozenRowCount>0&&(r=n.getBottomFrozenRowsHeight()),new Ma(n.scrollLeft+t,n.scrollTop+i,n.tableNoFrameWidth-t-e,n.tableNoFrameHeight-i-r)}function yu(n,t,e,i,r,o=!0){const s=ce(r("padding",n,e,i,t)),a=r("bgColor",n,e,i,t),l=r("font",n,e,i,t);let h,u,d,c,f;if(l){const{family:k,size:L,weight:O,style:D,variant:I}=f5t(l);h=k.join(" "),u=L,d=O,c=D,c=I}else h=r("fontFamily",n,e,i,t),u=r("fontSize",n,e,i,t),d=r("fontWeight",n,e,i,t),c=r("fontStyle",n,e,i,t),f=r("fontVariant",n,e,i,t);const g=r("textAlign",n,e,i,t),p=r("textBaseline",n,e,i,t),v=r("color",n,e,i,t),m=r("strokeColor",n,e,i,t),y=r("lineHeight",n,e,i,t),b=r("underline",n,e,i,t),_=r("underlineDash",n,e,i,t),w=r("underlineOffset",n,e,i,t),C=r("lineThrough",n,e,i,t),x=Math.max(1,Math.floor(u/10)),S=r("textOverflow",n,e,i,t),A=r("borderColor",n,e,i,t),T=r("borderLineWidth",n,e,i,t),M=r("borderLineDash",n,e,i,t),R=r("marked",n,e,i,t),E=r("cursor",n,e,i,t),P=!(s&&a&&l&&g&&p&&v&&S&&A&&T&&M&&typeof b=="boolean"&&typeof C=="boolean"&&typeof R=="boolean");if(!o)return{hasFunctionPros:P};const B={text:{fontFamily:h,fontSize:u,fontWeight:d,fontStyle:c,fontVariant:f,fill:v,stroke:m!=null&&m,textAlign:g,textBaseline:p,lineHeight:y??u,underline:b?x:void 0,underlineDash:_,underlineOffset:w,lineThrough:C?x:void 0,ellipsis:S==="clip"?"":S==="ellipsis"?"...":Y(S)?S:void 0},group:{fill:a,lineDash:M,lineWidth:T,stroke:A,cursor:E==="auto"||E==="default"?void 0:E},_vtable:{padding:s,marked:R}};if(Array.isArray(T)&&(B.group.strokeArrayWidth=ce(T)),Array.isArray(A)){const k=ce(A);B.group.stroke=!k.every(L=>!L)&&k,B.group.strokeArrayColor=ce(A)}return{theme:B,hasFunctionPros:P}}function OA(n,t,e){const i=e.theme.frameStyle.cornerRadius;if(e.theme.cellInnerBorder){if(Array.isArray(i)){const r=[0,0,0,0];return n===0&&t===0&&(r[0]=i[0]),n===e.colCount-1&&t===0&&(r[1]=i[1]),n===0&&t===e.rowCount-1&&(r[3]=i[3]),n===e.colCount-1&&t===e.rowCount-1&&(r[2]=i[2]),r}if(i){const r=[0,0,0,0];return n===0&&t===0&&(r[0]=i),n===e.colCount-1&&t===0&&(r[1]=i),n===0&&t===e.rowCount-1&&(r[3]=i),n===e.colCount-1&&t===e.rowCount-1&&(r[2]=i),r}}return 0}function k_(n){for(let t=0;t<n.internalProps.columns.length;t++){const e=n.internalProps.columns[t];if(!e.aggregation){if(n.options.aggregation){let i;if(i=typeof n.options.aggregation=="function"?n.options.aggregation({col:t,field:e.field}):n.options.aggregation,i)if(Array.isArray(i)){const r=[];i.forEach(o=>{r.push(Object.assign({showOnTop:!1},o))}),e.aggregation=r}else e.aggregation=Object.assign({showOnTop:!1},i)}}}}function uV(n){for(let t=0;t<n.length;t++)if(n[t].aggregation)return!0;return!1}function G5t(n){if(n.options.widthMode==="autoWidth"||n.options.defaultHeaderColWidth==="auto"||Array.isArray(n.options.defaultHeaderColWidth)&&n.options.defaultHeaderColWidth.includes("auto"))return!0;const t=n.internalProps.layoutMap.columnObjects;for(let e=0;e<t.length;e++)if(t[e].width==="auto")return!0;return!1}let Yv,Kv,qk,Zk,nd,rd,Jk,nJ,rJ,oJ,sJ,od,sd,aJ,lJ,Qk,tE,hJ,uJ,eE,iE,ad,ld,nE;function E_(n){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S;Yv=(t=n?.sort_color)!==null&&t!==void 0?t:"#282F38",Kv=(e=n?.sort_color_opacity)!==null&&e!==void 0?e:"0.35",qk=(i=n?.sort_color_2)!==null&&i!==void 0?i:"#416EFF",Zk=(r=n?.sort_color_opacity_2)!==null&&r!==void 0?r:"1",nd=(o=n?.sort_size)!==null&&o!==void 0?o:16,rd=(s=n?.sort_size_2)!==null&&s!==void 0?s:22,Jk=(a=n?.frozen_color)!==null&&a!==void 0?a:"#282F38",nJ=(l=n?.frozen_color_opacity)!==null&&l!==void 0?l:"0.35",rJ=(h=n?.frozen_color_opacity)!==null&&h!==void 0?h:"0.2",oJ=(u=n?.frozen_color_2)!==null&&u!==void 0?u:"#416EFF",sJ=(d=n?.frozen_color_opacity_2)!==null&&d!==void 0?d:"1",od=(c=n?.frozen_size)!==null&&c!==void 0?c:22,sd=(f=n?.frozen_size_2)!==null&&f!==void 0?f:22,aJ=(g=n?.collapse_color)!==null&&g!==void 0?g:"#141414",lJ=(p=n?.collapse_color_opacity)!==null&&p!==void 0?p:"0.65",Qk=(v=n?.collapse_size)!==null&&v!==void 0?v:16,tE=(m=n?.frozen_size_2)!==null&&m!==void 0?m:22,hJ=(y=n?.expand_color)!==null&&y!==void 0?y:"#141414",uJ=(b=n?.expand_color_opacity)!==null&&b!==void 0?b:"0.65",eE=(_=n?.expand_size)!==null&&_!==void 0?_:16,iE=(w=n?.expand_size_2)!==null&&w!==void 0?w:22,ad=(C=n?.dragReorder_color)!==null&&C!==void 0?C:"#666666",ld=(x=n?.dragReorder_color_opacity)!==null&&x!==void 0?x:"1",nE=(S=n?.dragReorder_size)!==null&&S!==void 0?S:20}const $5t={get sort_downward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${qk}"  fill-opacity="${Zk}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${Yv}" fill-opacity="${Kv}"/></svg> `,width:nd,height:nd,funcType:Fe.sort,name:"sort_downward",positionType:He.contentRight,marginLeft:3,hover:{width:rd,height:rd,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_upward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${Yv}"  fill-opacity="${Kv}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${qk}"  fill-opacity="${Zk}"/> </svg>`,width:nd,height:nd,funcType:Fe.sort,positionType:He.contentRight,name:"sort_upward",marginLeft:3,hover:{width:rd,height:rd,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_normal(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${Yv}" fill-opacity="${Kv}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${Yv}" fill-opacity="${Kv}"/></svg> `,width:nd,height:nd,funcType:Fe.sort,positionType:He.contentRight,name:"sort_normal",marginLeft:3,hover:{width:rd,height:rd,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get freeze(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z" fill="${Jk}" fill-opacity="${rJ}"/></g><defs><clipPath id="clip0"><rect width="22" height="22" fill="white"/></clipPath></defs></svg>`,width:od,height:od,name:"freeze",funcType:Fe.frozen,positionType:He.right,marginRight:0,hover:{width:sd,height:sd,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozen(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z" fill="${Jk}" fill-opacity="${nJ}"/></svg>`,width:od,height:od,name:"frozen",funcType:Fe.frozen,positionType:He.right,marginRight:0,hover:{width:sd,height:sd,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozenCurrent(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"  fill="${oJ}" fill-opacity="${sJ}"/></svg>`,width:od,height:od,funcType:Fe.frozen,positionType:He.right,name:"frozenCurrent",marginRight:0,hover:{width:sd,height:sd,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get dropdownIcon(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="white"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#959DA5"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="#4F5965"/></svg>',width:24,height:24,funcType:Fe.dropDown,positionType:He.absoluteRight,name:"dropdownIcon",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)",image:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="#1E54C9"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#141414" stroke-opacity="0.2"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="white"/></svg>'},cursor:"pointer",visibleTime:"mouseenter_cell"}},get play(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01" /><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /></svg>',width:24,height:24,funcType:Fe.play,positionType:He.right,name:"play",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get damage_pic(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',width:24,height:24,funcType:Fe.damagePic,positionType:He.left,name:"damage_pic",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get loading_pic(){return{type:"svg",svg:'<svg viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="50" y="65" width="301" height="170"><path d="M350.3 65H50v169.8h300.3V65Z" fill="#fff"/></mask><g mask="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M58.3 233.2h32.8v-36.8H58.3v36.8Z" fill="#C7DEFF"/><path d="M91.1 224.5v8.8H58.3M82.4 196.2H58.3" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z" fill="#00E4E5"/><path fill-rule="evenodd" clip-rule="evenodd" d="M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z" fill="#00E4E5"/><path d="M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z" fill="#C7DEFF"/><path d="m337 74.2-30.6 129.2h-5.9" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path d="M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M148.3 138.1h97V119h-97v19.1Z" fill="#00E4E5"/><path d="M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z" fill="#C7DEFF"/><path d="M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3" stroke="#071F4D"/><path d="M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5" stroke="#071F4D"/><path d="M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1" stroke="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z" fill="#C7DEFF"/><path d="M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6" stroke="#071F4D"/><path d="M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z" fill="#fff"/><path d="M273.2 195.9h16.9M261.2 195.9h5" stroke="#fff"/><path d="M62.4 201.9v2.9M62.4 224.5v2.9" stroke="#071F4D"/><path d="m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1" stroke="#fff"/><path d="M148.3 138.1h121.6V119H148.3v19.1Z" stroke="#071F4D"/></g></svg>',width:400,height:300,name:"loading_pic",positionType:He.left}},get expand(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z" fill="${hJ}" fill-opacity="${uJ}"/>
      </svg>`,width:eE,height:eE,funcType:Fe.expand,name:"expand",positionType:He.contentLeft,marginLeft:0,marginRight:4,hover:{width:iE,height:iE,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get collapse(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z"  fill="${aJ}" fill-opacity="${lJ}"/>
      </svg>`,width:Qk,height:Qk,funcType:Fe.collapse,name:"collapse",positionType:He.contentLeft,marginLeft:0,marginRight:4,hover:{width:tE,height:tE,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get drillDown(){return{name:"drillDown",type:"svg",positionType:He.absolute,funcType:Fe.drillDown,svg:wFt,width:13,height:13,cursor:"pointer"}},get drillUp(){return{name:"drillUp",type:"svg",positionType:He.absolute,funcType:Fe.drillUp,svg:xFt,width:13,height:13,cursor:"pointer"}},get dragReorder(){return{type:"svg",svg:`<svg t="1710129136961" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5166" width="200" height="200"><path d="M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${ad}"  fill-opacity="${ld}" p-id="5167"></path><path d="M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${ad}"  fill-opacity="${ld}" p-id="5168"></path><path d="M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${ad}"  fill-opacity="${ld}" p-id="5169"></path><path d="M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${ad}"  fill-opacity="${ld}" p-id="5170"></path><path d="M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${ad}"  fill-opacity="${ld}" p-id="5171"></path><path d="M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${ad}"  fill-opacity="${ld}" p-id="5172"></path></svg>`,width:nE,height:nE,funcType:Fe.dragReorder,positionType:He.left,name:"dragReorder",marginLeft:-10,marginRight:10,cursor:"grab"}}},j5t={};function ms(){return Iy($5t,j5t)}class Cc extends Ga{constructor(t){super(t),this.failCallback=()=>{const e=ms(),{svg:i,src:r}=e.damage_pic||{},o=i||r;o&&(super.image=o)},this.attribute.visibleTime!=="mouseenter_cell"&&this.attribute.visibleTime!=="click_cell"||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,Xe.GetFile(this.attribute.gif+`?role=gif&radom=${Math.random()}`,"arrayBuffer").then(t=>{const e=Rq(t),i=Mq(e,!0);this.renderGIF(i),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(t=>{})}get backgroundWidth(){var t,e;return(e=(t=this.attribute.backgroundWidth)!==null&&t!==void 0?t:this.attribute.width)!==null&&e!==void 0?e:0}get backgroundHeight(){var t,e;return(e=(t=this.attribute.backgroundHeight)!==null&&t!==void 0?t:this.attribute.height)!==null&&e!==void 0?e:0}renderGIF(t){this.loadedFrames=t,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=t[0].dims.width,this.gifCanvas.height=t[0].dims.height,this.playing=!0,this.lastTime=new Date().getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(t,e,i){const r=this.loadedFrames[this.frameIndex||0];r.disposalType===2&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(r),this.manipulate(t,e,i);const o=new Date().getTime()-this.lastTime;r.delay<o&&(this.frameIndex++,this.lastTime=new Date().getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(t){const e=t.dims;this.frameImageData&&e.width===this.frameImageData.width&&e.height===this.frameImageData.height||(this.tempCanvas.width=e.width,this.tempCanvas.height=e.height,this.frameImageData=this.tempCtx.createImageData(e.width,e.height)),this.frameImageData.data.set(t.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,e.left,e.top)}manipulate(t,e,i){t.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,e,i,this.attribute.width,this.attribute.height)}setAttribute(t,e,i,r){super.setAttribute(t,e,i,r),t==="gif"&&this.loadGif()}setAttributes(t,e,i){super.setAttributes(t,e,i),t.gif&&this.loadGif()}}class dJ extends si{constructor(t){var e,i,r,o,s;t.fill=(e=t.fill)!==null&&e!==void 0?e:"#00F",t.fontSize=(i=t.fontSize)!==null&&i!==void 0?i:12,t.underline=(r=t.underline)!==null&&r!==void 0?r:1,t.textBaseline=(o=t.textBaseline)!==null&&o!==void 0?o:"top",t.cursor=(s=t.cursor)!==null&&s!==void 0?s:"pointer",super(t)}}function Xm(n){return{rootContainer:new ge({}),renderDefault:!0}}class U5t{constructor(t){this.table=t,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(t,e){return e?this.headerCustomLayoutFuncCache.has(t):this.customLayoutFuncCache.has(t)}setReactCreateGraphic(t,e,i){i?this.headerCustomLayoutFuncCache.set(t,e):this.customLayoutFuncCache.set(t,e)}setReactRemoveGraphic(t,e,i){i?this.headerReactRemoveGraphicCache.set(t,e):this.reactRemoveGraphicCache.set(t,e)}setReactRemoveAllGraphic(t,e,i){i?this.headerReactRemoveAllGraphicCache.set(t,e):this.reactRemoveAllGraphicCache.set(t,e)}updateCustomCell(t,e){const i=this.table;if(i.widthMode==="autoWidth"&&i.scenegraph.recalculateColWidths(),(i.isAutoRowHeight()||i.internalProps.defaultRowHeight==="auto"&&!e||i.internalProps.defaultHeaderRowHeight==="auto"&&e)&&i.scenegraph.recalculateRowHeights(),i.isPivotTable()){const r=Y5t(t,i,e);for(let o=0;o<r.length;o++){const s=r[o];for(let a=s.start.col;a<=s.end.col;a++)for(let l=s.start.row;l<=s.end.row;l++)i.scenegraph.updateCellContent(a,l)}}else{const r=X5t(t,i,e);for(let o=r.start.col;o<=r.end.col;o++)for(let s=r.start.row;s<=r.end.row;s++)i.scenegraph.updateCellContent(o,s)}i.scenegraph.renderSceneGraph()}getCustomLayoutFunc(t,e){var i;if(this.table.isHeader(t,e)){const{componentId:o}=this.table.getHeaderDefine(t,e);return(i=this.headerCustomLayoutFuncCache.get(o))!==null&&i!==void 0?i:Xm}const{componentId:r}=this.table.getBodyColumnDefine(t,e);return this.customLayoutFuncCache.get(r)||Xm}removeCustomCell(t,e){let i;if(this.table.isHeader(t,e)){const r=this.table.getHeaderDefine(t,e),{componentId:o}=r;i=this.headerReactRemoveGraphicCache.get(o)}else{const r=this.table.getBodyColumnDefine(t,e),{componentId:o}=r;i=this.reactRemoveGraphicCache.get(o)}i&&i(t,e)}clearCache(){this.reactRemoveAllGraphicCache.forEach(t=>{t()}),this.headerReactRemoveAllGraphicCache.forEach(t=>{t()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e)}),this.headerCustomLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e,!0)})}}function X5t(n,t,e){const i=t.internalProps.rowSeriesNumber?1:0;if(e){const o=t.internalProps.layoutMap,{headerObjects:s}=t.internalProps.layoutMap;let a;for(let h=0;h<s.length;h++){const u=s[h];if(u.define.componentId===n){a=u.id;break}}const l=o.getHeaderCellAdressById(a);return o.getCellRange(l.col,l.row)}const{columnObjects:r}=t.internalProps.layoutMap;for(let o=0;o<r.length;o++)if(r[o].define.componentId===n)return{start:{col:i+o,row:t.columnHeaderLevelCount},end:{col:i+o,row:t.rowCount-1}};return{start:{col:0,row:0},end:{col:t.colCount-1,row:t.rowCount-1}}}function Y5t(n,t,e){const i=t.internalProps.rowSeriesNumber?1:0,r=[],o=t.internalProps.layoutMap;if(e){const{headerObjects:s}=o,a=[];for(let l=0;l<s.length;l++){const h=s[l];h&&h.define.componentId===n&&a.push(h.id)}for(let l=0;l<a.length;l++){const h=a[l],u=o.getHeaderCellAdressById(h),d=o.getCellRange(u.col,u.row);r.push(d)}}else{let s;const{columnObjects:a,indicatorsAsCol:l}=o;for(let h=0;h<a.length;h++)if(a[h].define.componentId===n){s=h;break}if(l)for(let h=o.rowHeaderLevelCount+s;h<o.colCount;h+=a.length){const u={start:{col:h+i,row:o.columnHeaderLevelCount},end:{col:h+i,row:o.rowCount-1}};r.push(u)}else for(let h=o.columnHeaderLevelCount+s;h<o.rowCount;h+=a.length){const u={start:{col:o.rowHeaderLevelCount+i,row:h},end:{col:o.colCount-1,row:h}};r.push(u)}}return r}function sn(n){const t={abstractPos:{x:n.viewport.x,y:n.viewport.y}},e=wc(n.target);return e&&(t.eventArgs={col:e.col,row:e.row,event:n,targetCell:e,mergeInfo:K5t(e),target:n.target}),t}function wc(n){for(;n&&n.parent;){if(n.role==="cell")return n;n=n.parent}return null}function K5t(n){if(Y(n.mergeStartCol)&&Y(n.mergeStartRow)&&Y(n.mergeEndCol)&&Y(n.mergeEndRow))return{colStart:n.mergeStartCol,colEnd:n.mergeEndCol,rowStart:n.mergeStartRow,rowEnd:n.mergeEndRow}}const q5t=/radio-\d+-\d+-(\d+)/,cJ="_custom_",ta="custom-container",ex=cJ+"_0";function hu(n,t,e,i,r,o,s,a,l,h,u){var d,c,f;let g,p,v,m=!0,y=!1;if(n==="react-custom-layout"&&(n=((d=u.reactCustomLayout)===null||d===void 0?void 0:d.getCustomLayoutFunc(e,i))||Xm),typeof n=="function"){const b=n({col:(c=h?.start.col)!==null&&c!==void 0?c:e,row:(f=h?.start.row)!==null&&f!==void 0?f:i,dataValue:u.getCellOriginValue(e,i),value:u.getCellValue(e,i)||"",rect:{left:0,top:0,right:r,bottom:o,width:r,height:o},table:u,originCol:e,originRow:i});if(!b)return{renderDefault:!0};b.rootContainer&&(b.rootContainer=Ym(b.rootContainer,u.animationManager.timeline)),b.rootContainer instanceof ge&&(v=b.rootContainer,v.name=ta,v.col=e,v.row=i),m=b.renderDefault,y=b.enableCellPadding}else if(typeof t=="function"){const b=t({col:e,row:i,dataValue:u.getCellOriginValue(e,i),value:u.getCellValue(e,i)||"",rect:{left:0,top:0,right:r,bottom:o,width:r,height:o},table:u});b&&(p=b.elements,m=b.renderDefault,b.expectedWidth,g=b.expectedHeight)}else t&&(t.expectedWidth,g=t.expectedHeight,p=t.elements,m=t.renderDefault);return p&&(v=Z5t(p,r,a?g:o,u.getCellValue(e,i))),y&&v.setAttributes({x:l[3],y:l[0],width:r-l[1]-l[3],height:o-l[0]-l[2]}),DA(v,r,o),!h||h.start.col===h.end.col&&h.start.row===h.end.row||fJ(v,e,i,0),{elementsGroup:v,renderDefault:m}}function Z5t(n,t,e,i){const r=new ge({x:0,y:0,width:t,height:e,fill:!1,stroke:!1,pickable:!1});return r.name=ta,J5t(n,t,e,i).forEach(o=>{var s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L;switch(o.clickable&&(o.pickable=o.clickable),o.type){case"arc":const O=Kw({x:o.x,y:o.y,dx:(s=o.dx)!==null&&s!==void 0?s:0,dy:(a=o.dy)!==null&&a!==void 0?a:0,fill:o.fill,stroke:o.stroke,outerRadius:o.radius,startAngle:o.startAngle,endAngle:o.endAngle,pickable:!!o.pickable,cursor:o.cursor});O.name=o.name,r.appendChild(O);break;case"text":if(o.background){const W=(h=(l=o.background)===null||l===void 0?void 0:l.expandX)!==null&&h!==void 0?h:0,K=(d=(u=o.background)===null||u===void 0?void 0:u.expandY)!==null&&d!==void 0?d:0,J=Ne({x:o.x-W,y:o.y-K,dx:(c=o.dx)!==null&&c!==void 0?c:0,dy:(f=o.dy)!==null&&f!==void 0?f:0,width:o.width+2*W,height:o.height+2*K,cornerRadius:(p=(g=o.background)===null||g===void 0?void 0:g.cornerRadius)!==null&&p!==void 0?p:0,fill:(m=(v=o.background)===null||v===void 0?void 0:v.fill)!==null&&m!==void 0?m:"#888"});r.appendChild(J)}const D=new si(Object.assign({pickable:!!o.pickable,fill:(y=o.color)!==null&&y!==void 0?y:o.fill},o));D.name=o.name,r.appendChild(D);break;case"rect":const I=Ne({x:o.x,y:o.y,dx:(b=o.dx)!==null&&b!==void 0?b:0,dy:(_=o.dy)!==null&&_!==void 0?_:0,width:o.width,height:o.height,cornerRadius:o.radius,fill:o.fill,stroke:o.stroke,pickable:!!o.pickable,cursor:o.cursor});I.name=o.name,r.appendChild(I);break;case"circle":const H=UK({x:o.x,y:o.y,dx:(w=o.dx)!==null&&w!==void 0?w:0,dy:(C=o.dy)!==null&&C!==void 0?C:0,radius:o.radius,fill:o.fill,stroke:o.stroke,pickable:!!o.pickable,cursor:o.cursor});H.name=o.name,r.appendChild(H);break;case"icon":const F=new Cc({x:o.x,y:o.y,dx:(x=o.dx)!==null&&x!==void 0?x:0,dy:(S=o.dy)!==null&&S!==void 0?S:0,width:o.width,height:o.height,image:o.svg,backgroundWidth:o.hover?(A=o.hover.width)!==null&&A!==void 0?A:o.width:void 0,backgroundHeight:o.hover?(T=o.hover.width)!==null&&T!==void 0?T:o.width:void 0,backgroundColor:o.hover?(M=o.hover.bgColor)!==null&&M!==void 0?M:"rgba(22,44,66,0.2)":void 0,pickable:!!o.pickable,cursor:o.cursor});F.name=o.name,F.role="icon-custom",r.appendChild(F);break;case"image":const G=new Cc({x:o.x,y:o.y,dx:(R=o.dx)!==null&&R!==void 0?R:0,dy:(E=o.dy)!==null&&E!==void 0?E:0,width:o.width,height:o.height,image:o.src,backgroundWidth:o.hover?(P=o.hover.width)!==null&&P!==void 0?P:o.width:void 0,backgroundHeight:o.hover?(B=o.hover.width)!==null&&B!==void 0?B:o.width:void 0,backgroundColor:o.hover?(k=o.hover.bgColor)!==null&&k!==void 0?k:"rgba(22,44,66,0.2)":void 0,pickable:!!o.pickable,cursor:o.cursor,shape:o.shape});G.name=o.name,G.role="image-custom",r.appendChild(G);break;case"line":const j=Ri({points:o.points,lineWidth:(L=o.lineWidth)!==null&&L!==void 0?L:1,stroke:o.stroke,pickable:!!o.pickable,cursor:o.cursor});j.name=o.name,r.appendChild(j)}}),r}function J5t(n,t,e,i){const r=[],o=[0,0,0,0];for(let s=0;s<n.length;s++){const a=n[s],l=Object.assign({},a);for(const u in l)l.hasOwnProperty(u)&&Bo(l[u])&&(l[u]=l[u](i));const h=l;Y(h.x)&&(h.x=Si(h.x)?al(h.x,t-o[1]):Number(h.x)),Y(h.y)&&(h.y=Si(h.y)?al(h.y,e-o[2]):Number(h.y)),"width"in l&&(l.width=Si(l.width)?al(l.width,t-o[1]):Number(l.width)),"height"in l&&(l.height=Si(l.height)?al(l.height,e-o[2]):Number(l.height)),"radius"in l&&(l.radius=Si(l.radius)?al(l.radius,Math.min(t-o[1],e-o[2])):Number(l.radius)),"hover"in l&&(l.hover.x=Si(l.hover.x)?al(l.hover.x,t-o[1]):Number(l.hover.x),l.hover.y=Si(l.hover.y)?al(l.hover.y,e-o[2]):Number(l.hover.y),l.hover.width=Si(l.hover.width)?al(l.hover.width,t-o[1]):Number(l.hover.width),l.hover.height=Si(l.hover.height)?al(l.hover.height,e-o[2]):Number(l.hover.height),l.hover.x+=0,l.hover.y+=0),h.x=h.x+0,h.y=h.y+0,r.push(l)}return r}function al(n,t){return n.endsWith("px")?parseInt(n,10):n.endsWith("%")&&t?parseInt(n,10)/100*t:parseInt(n,10)}function DA(n,t,e){n&&n.forEachChildren(i=>{var r,o;i&&(pn(i.attribute.width)&&i.attribute.width.percent&&i.setAttribute("width",Math.max(0,i.attribute.width.percent/100*t+((r=i.attribute.width.delta)!==null&&r!==void 0?r:0))),i.attribute.width<0&&i.setAttribute("width",0),pn(i.attribute.height)&&i.attribute.height.percent&&i.setAttribute("height",Math.max(0,i.attribute.height.percent/100*e+((o=i.attribute.height.delta)!==null&&o!==void 0?o:0))),i.attribute.height<0&&i.setAttribute("height",0),i.type==="group"&&DA(i,i.attribute.width,i.attribute.height))})}function Ym(n,t){if(!n||!Y(n.$$typeof)&&!Y(n.vtype))return n;const e=n.type,{attribute:i,children:r,stateProxy:o,animation:s}=n.props,a=e({attribute:i});if(Q5t(a,n.props),o&&(a.stateProxy=o),a.id=i.id,a.name=i.name,Mt(r)?r.forEach(l=>{const h=Ym(l,t);h&&h.type&&a.add(h)}):r&&a.add(Ym(r,t)),Mt(s)&&t){const l=a.animate();l.setTimeline(t),s.forEach(h=>{l[h[0]](...h.slice(1))})}return a}function Q5t(n,t){let e=!1;switch(n.type){case"richtext":case"rich/image":break;default:e=!0}e&&Object.keys(t).forEach(i=>{const r=BPt[i];r&&n.on(r,t[i])})}function fJ(n,t,e,i,r){n&&(n.name=`${cJ}${r??""}_${i}`,n.onBeforeAttributeUpdate=tWt,n.type==="group"&&n.childrenCount&&n.forEachChildren((o,s)=>{fJ(o,t,e,s,(r??"")+"_"+i)}))}function tWt(n,t){const e=this;if(e.skipMergeUpdate)return;const i=wc(e);if(!i||!i.stage)return;const r=i.stage.table;e.skipAttributeUpdate=!0;const{mergeStartCol:o,mergeEndCol:s,mergeStartRow:a,mergeEndRow:l}=i;if(Y(o)&&Y(s)&&Y(a)&&Y(l)&&(o!==s||a!==l)){for(let h=o;h<=s;h++)for(let u=a;u<=l;u++){if(h===i.col&&u===i.row)continue;const d=r.scenegraph.highPerformanceGetCell(h,u);if(d.role==="cell"){const c=d.getChildByName(e.name,!0);if(!c||c.skipAttributeUpdate)continue;for(const f in n)n[f]!==c.attribute[f]&&f!=="dx"&&f!=="dy"&&c.setAttribute(f,n[f])}}e.skipAttributeUpdate=void 0}}class re extends ge{clear(){this.removeAllChild()}getChildByName(t,e){let i=null;return this.forEachChildren(r=>r.name===t&&(i=r,!0)),e&&this.forEachChildren(r=>{if(r.getChildByName){const o=r.getChildByName(t,!0);if(o)return i=o,!0}return!1}),i}get width(){var t;let e=this.AABBBounds.width();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,(t=this.attribute.width)!==null&&t!==void 0?t:0)}get height(){var t;let e=this.AABBBounds.height();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,(t=this.attribute.height)!==null&&t!==void 0?t:0)}setDeltaWidth(t){var e;t!==0&&(this.setAttribute("width",((e=this.attribute.width)!==null&&e!==void 0?e:0)+t),this.border&&(this.border.setAttribute("width",this.border.attribute.width+t),this.border.type==="group"&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+t)))}setDeltaHeight(t){var e;t!==0&&(this.setAttribute("height",((e=this.attribute.height)!==null&&e!==void 0?e:0)+t),this.border&&(this.border.setAttribute("height",this.border.attribute.height+t),this.border.type==="group"&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+t)))}setDeltaX(t){t!==0&&this.setAttribute("x",this.attribute.x+t)}setDeltaY(t){t!==0&&this.setAttribute("y",this.attribute.y+t)}forEachChildrenSkipChild(t,e="border-rect",i=!1){if(i){let r=this._lastChild,o=0;for(;r;){if(r.name!==e&&t(r,o++))return;r=r._prev}}else{let r=this._firstChild,o=0;for(;r;){if(r.name!==e&&t(r,o++))return;r=r._next}}}getColGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.col===t)return e;e=e._next}return null}getRowGroup(t){let e=this._firstChild;if(!e)return null;for(let i=0;i<this.childrenCount;i++){if(e.row===t)return e;e=e._next}return null}addCellGroup(t){if(this.childrenCount===0||this.lastChild.row===t.row-1)this.addChild(t);else{let e=this._firstChild;for(let i=0;i<this.childrenCount;i++){if(e.row===t.row-1)return void this.insertAfter(t,e);e=e._next}this.addChild(t)}}getChildAt(t){const e=super.getChildAt(t);return e&&e.name==="border-rect"?e._next:e}tryUpdateAABBBounds(){if(this.role==="cell"){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;const t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),eWt(this,t),e}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if(this.role==="cell"){const t=this.attribute,{x:e,y:i,width:r,height:o}=t;return this._AABBBounds.setValue(e,i,e+r,i+o),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return this.role==="body"||this.role==="row-header"||this.role==="col-header"||this.role==="right-frozen"||this.role==="bottom-frozen"||this.role==="corner-header"||this.role==="corner-right-top-header"||this.role==="corner-right-bottom-header"||this.role==="corner-left-bottom-header"?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(t){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,t):this.rowNumber=t}updateColumnHeight(t){this.colHeight?this.colHeight+=t:this.colHeight=t}}function eWt(n,t){n.stage&&n.stage.dirtyBounds&&n.stage.renderCount&&(n.isContainer&&!t||n.stage.dirty(n.globalAABBBounds))}function IA(n,t,e,i){const r=n/t;let o,s;return r>e/i?(o=e,s=o/r,(i-s)/2):(s=i,o=s*r,(e-o)/2),{width:o,height:s}}function PD(n,t,e,i,r,o,s="left",a="middle",l=[0,0,0,0],h=0,u=0,d=0,c=0){const f=n+e,g=t+i;let p=n+l[3]+h;s==="right"||s==="end"?p=f-r-l[1]-u:s==="center"&&(p=n+(e-r+h-u)/2);let v=t+l[0]+d;return a==="bottom"||a==="alphabetic"||a==="ideographic"?v=g-o-l[2]-c:a==="middle"&&(v=t+(i-o+d-c)/2),{x:p,y:v}}function gJ(n,t,e,i,r){let o=!1,s=!1,a=!1,l=!1,h=!1,u=!1,d=!1,c=!1,f=!1;return n<=r.frozenColCount-1&&t<=r.frozenRowCount-1&&(u=!0),e>=r.colCount-r.rightFrozenColCount&&t<=r.frozenRowCount-1&&(d=!0),n<=r.frozenColCount-1&&i>=r.rowCount-r.bottomFrozenRowCount&&(f=!0),e>=r.colCount-r.rightFrozenColCount&&i>=r.rowCount-r.bottomFrozenRowCount&&(c=!0),n<=r.frozenColCount-1&&i>=r.frozenRowCount&&t<=r.rowCount-r.bottomFrozenRowCount-1&&(o=!0),e>=r.colCount-r.rightFrozenColCount&&i>=r.frozenRowCount&&t<=r.rowCount-r.bottomFrozenRowCount-1&&(s=!0),t<=r.frozenRowCount-1&&e>=r.frozenColCount&&n<=r.colCount-r.rightFrozenColCount-1&&(a=!0),i>=r.rowCount-r.bottomFrozenRowCount&&e>=r.frozenColCount&&n<=r.colCount-r.rightFrozenColCount-1&&(l=!0),n<=r.colCount-r.rightFrozenColCount-1&&e>=r.frozenColCount&&t<=r.rowCount-r.bottomFrozenRowCount-1&&i>=r.frozenRowCount&&(h=!0),{needRowHeader:o,needRightRowHeader:s,needColumnHeader:a,needBottomColumnHeader:l,needBody:h,needCornerHeader:u,needRightTopCornerHeader:d,needLeftBottomCornerHeader:f,needRightBottomCornerHeader:c}}function ut(n,t,e,i,r){const o=t&&Y(t[n])?t[n]:void 0;return typeof o=="function"?o({col:e,row:i,table:r,value:r.getCellValue(e,i),dataValue:r.getCellOriginValue(e,i),cellHeaderPaths:r.getCellHeaderPaths(e,i)}):o}function HA(n,t,e,i,r){const o=t&&Y(t[n])?t[n]:void 0;if(typeof o=="function")return o({col:e,row:i,table:r,value:r.getCellValue(e,i),dataValue:r.getCellOriginValue(e,i),cellHeaderPaths:r.getCellHeaderPaths(e,i)})}function tl(n,t,e,i){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w;let C=(o=(r=e?.group)===null||r===void 0?void 0:r.strokeArrayWidth)!==null&&o!==void 0?o:void 0;return i.theme.cellInnerBorder||!DHt(i.theme.frameStyle.borderLineWidth)||IHt(i.theme.frameStyle.borderLineWidth)||(n===0&&(C=C??[(s=e?.group)===null||s===void 0?void 0:s.lineWidth,(a=e?.group)===null||a===void 0?void 0:a.lineWidth,(l=e?.group)===null||l===void 0?void 0:l.lineWidth,(h=e?.group)===null||h===void 0?void 0:h.lineWidth],C[3]=0),n===i.colCount-1&&(C=C??[(u=e?.group)===null||u===void 0?void 0:u.lineWidth,(d=e?.group)===null||d===void 0?void 0:d.lineWidth,(c=e?.group)===null||c===void 0?void 0:c.lineWidth,(f=e?.group)===null||f===void 0?void 0:f.lineWidth],C[1]=0),t===0&&(C=C??[(g=e?.group)===null||g===void 0?void 0:g.lineWidth,(p=e?.group)===null||p===void 0?void 0:p.lineWidth,(v=e?.group)===null||v===void 0?void 0:v.lineWidth,(m=e?.group)===null||m===void 0?void 0:m.lineWidth],C[0]=0),t===i.rowCount-1&&(C=C??[(y=e?.group)===null||y===void 0?void 0:y.lineWidth,(b=e?.group)===null||b===void 0?void 0:b.lineWidth,(_=e?.group)===null||_===void 0?void 0:_.lineWidth,(w=e?.group)===null||w===void 0?void 0:w.lineWidth],C[2]=0)),C}class iWt extends re{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new re({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new re({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new re({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addContent(t){const e=this._centerGroup.lastChild;e&&t.setAttributes({x:e.attribute.x+e.AABBBounds.width()}),this._centerGroup.appendChild(t),t instanceof si&&(this._centerGroup.setAttribute("pickable",!1),t.setAttribute("textAlign","left"))}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){const s=this._centerGroup.width;this._cellWidth=t+e+s,this.setAttribute("width",this._cellWidth)}else{const s=this._cellWidth-t-e;this.updateCenterLayout(s);const a=this._centerGroup.width;this._cellWidth=t+e+a,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();const i=this._leftGroup.height,r=this._rightGroup.height,o=this._centerGroup.height;this._cellHeight=Math.max(i,r,o),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._centerGroup.forEachChildren(o=>{(o instanceof Cc||o instanceof dJ)&&(e-=o.AABBBounds.width())});const i=this._centerGroup.getChildByName("text");i instanceof Ei?i.setAttribute("width",e):i instanceof si&&i.setAttribute("maxLineWidth",e);let r=0;this._centerGroup.forEachChildren(o=>{o.setAttribute("x",r),r+=o.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),this._align==="left"||this._align==="start"?this.setAttribute("dx",0):this._align==="center"?this.setAttribute("dx",-this.attribute.width/2):this._align!=="right"&&this._align!=="end"||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){this._baseline==="top"?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):this._baseline==="middle"?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):this._baseline==="bottom"&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(t){this._cellWidth=t,this._originCellWidth=t,this.layout()}updateHeight(t){this._cellHeight=t,this._cellWidth=this._originCellWidth;const e=this.getChildByName("text",!0);e&&e.setAttribute("heightLimit",t),this.layout()}}function jr(n,t,e){var i,r,o,s,a;let l=0;const h=e.internalProps.layoutMap;if(h.isHeader(n,t)){const u=h.getHeader(n,t);Y(u?.hierarchyLevel)&&(l=((i=u.hierarchyLevel)!==null&&i!==void 0?i:0)*(h.rowHierarchyType==="tree"&&(r=h.rowHierarchyIndent)!==null&&r!==void 0?r:0),h.rowHierarchyTextStartAlignment&&!e.internalProps.headerHelper.getHierarchyIcon(n,t)&&(l+=e.internalProps.headerHelper.getHierarchyIconWidth()))}else if(e.internalProps.groupBy||!((o=e.getBodyColumnDefine(n,t))===null||o===void 0)&&o.tree){const u=e.dataSource.getIndexKey(e.getRecordShowIndexByCell(n,t)),d=(s=e.dataSource.getGroupLength())!==null&&s!==void 0?s:0;let c=Mt(u)?u.length-1:0;d>0&&c===d&&(c=0),l=Array.isArray(u)&&e.getHierarchyState(n,t)!==Lt.none?c*((a=h.hierarchyIndent)!==null&&a!==void 0?a:0):0,h.hierarchyTextStartAlignment&&!e.internalProps.bodyHelper.getHierarchyIcon(n,t)&&(l+=e.internalProps.bodyHelper.getHierarchyIconWidth())}return l}function Km(n,t){var e,i;let r,o=!1;for(Si(n)&&n.length>(t.options.maxCharactersNumber||200)&&(n=n.slice(0,t.options.maxCharactersNumber||200),n+="",o=!0),r=t.internalProps.enableLineBreak||!((e=t.options.customConfig)===null||e===void 0)&&e.multilinesForXTable?H6(n).replace(/\r?\n/g,`
`).replace(/\r/g,`
`).split(`
`)||[]:[H6(n)];r.length&&r.length>1&&!r[r.length-1];)r.pop();if(!((i=t.options.customConfig)===null||i===void 0)&&i.multilinesForXTable&&!t.internalProps.autoWrapText)for(;r.length&&r.length>1&&!r[0];)r.shift();return{text:r,moreThanMaxCharacters:o}}function nWt(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){var p,v,m,y,b,_,w,C,x;let S,A=0,T=0,M=0;if(Array.isArray(t)&&t.length!==0){const{inlineFrontIcons:P,inlineEndIcons:B,contentLeftIcons:k,contentRightIcons:L,leftIconWidth:O,rightIconWidth:D,absoluteRightIconWidth:I}=Lp(t,n,g,c);let H;if(A=O,T=D,M=I,P.length===0&&B.length===0){let F=0;pt(c.theme._contentOffset)&&(u==="left"?F=c.theme._contentOffset:u==="right"&&(F=-c.theme._contentOffset));const G=g?jr(g.start.col,g.start.row,c):jr(n.col,n.row,c),{text:j,moreThanMaxCharacters:W}=Km(e,c),K={text:j.length===1?j[0]:j,moreThanMaxCharacters:W,maxLineWidth:r?1/0:l-(i[1]+i[3])-A-T-G,textBaseline:"top",heightLimit:((y=c.options.customConfig)===null||y===void 0?void 0:y.limitContentHeight)===!1||o&&!(!((b=c.options.customConfig)===null||b===void 0)&&b.multilinesForXTable)?-1:h-Math.floor(i[0]+i[2]),pickable:!1,autoWrapText:s,lineClamp:a,wordBreak:"break-word",whiteSpace:((_=c.options.customConfig)===null||_===void 0?void 0:_.limitContentHeight)===!1||j.length!==1||s?"normal":"no-wrap",dx:(u==="left"?k.length?0:G:0)+F,keepCenterInLine:!0},J=new si(f.text?Object.assign({},f.text,K):K);J.name="text",H=J}else{const F=Object.assign({text:e?.toString()},((x=(C=(w=n.parent)===null||w===void 0?void 0:w.theme)===null||C===void 0?void 0:C.userTheme)===null||x===void 0?void 0:x.text)||{});f.text&&Object.assign(F,f.text),F.textBaseline="middle";const G=[...P.map(W=>ix(W)),F,...B.map(W=>ix(W))];G[0].textAlign=u;const j=new Ei({width:r?0:l-(i[1]+i[3])-A-T,height:o&&s?0:Math.ceil(h-(i[0]+i[2])),textConfig:G,verticalDirection:o&&s?"top":d,ellipsis:F.ellipsis});j.name="text",H=j,j.bindIconEvent(),!g||g.start.col===g.end.col&&g.start.row===g.end.row||(j.onBeforeAttributeUpdate=oWt)}if(k.length!==0||L.length!==0){const F=new iWt({x:0,y:0,fill:!1,stroke:!1,pickable:!1});F.name="content",F.setCellContentOption({autoWidth:r,autoHeight:o,cellWidth:l-(i[1]+i[3])-A-T,cellHeight:h-(i[0]+i[2]),align:u,baseline:d});const G={addedHierarchyOffset:0};k.forEach(j=>{const W=yo(j,void 0,n.col,n.row,g,c,G);W.role="icon-content-left",W.name=j.name,F.addLeftOccupyingIcon(W)}),L.forEach(j=>{const W=yo(j,void 0,n.col,n.row,g,c,G);W.role="icon-content-right",W.name=j.name,F.addRightOccupyingIcon(W)}),F.addContent(H),n.appendChild(F),F.layout(),S=F.AABBBounds.width(),F.AABBBounds.height()}else n.firstChild?n.insertBefore(H,n.firstChild):n.appendChild(H),S=H.AABBBounds.width(),H.AABBBounds.height()}else if(Y(e)){const{text:P,moreThanMaxCharacters:B}=Km(e,c),k=g?jr(g.start.col,g.start.row,c):jr(n.col,n.row,c);let L=0;pt(c.theme._contentOffset)&&(u==="left"?L=c.theme._contentOffset:u==="right"&&(L=-c.theme._contentOffset));const O={text:P.length===1?P[0]:P,moreThanMaxCharacters:B,maxLineWidth:r?1/0:l-(i[1]+i[3]+k),textBaseline:"top",autoWrapText:s,lineClamp:a,wordBreak:"break-word",heightLimit:((p=c.options.customConfig)===null||p===void 0?void 0:p.limitContentHeight)===!1||o&&!(!((v=c.options.customConfig)===null||v===void 0)&&v.multilinesForXTable)?-1:h-Math.floor(i[0]+i[2]),pickable:!1,dx:(u==="left"?k:0)+L,whiteSpace:((m=c.options.customConfig)===null||m===void 0?void 0:m.limitContentHeight)===!1||P.length!==1||s?"normal":"no-wrap",keepCenterInLine:!0},D=new si(f.text?Object.assign({},f.text,O):O);D.name="text",D.textBaseline=d,n.appendChild(D),S=D.AABBBounds.width(),D.AABBBounds.height()}const R=r?A+S+T:l-(i[1]+i[3]),E=h-(i[0]+i[2]);n.forEachChildren(P=>{P.role==="icon-left"?P.setAttribute("x",P.attribute.x+i[3]):P.role==="icon-right"?P.setAttribute("x",P.attribute.x+R-T+i[3]):P.role==="icon-absolute-right"?P.setAttribute("x",P.attribute.x+R-M+i[3]+i[1]):P.name!=="content"&&P.name!=="text"||(u==="center"&&P.type!=="richtext"?P.setAttribute("x",i[3]+A+(R-A-T)/2):u==="right"&&P.type!=="richtext"?P.setAttribute("x",i[3]+R-T):P.setAttribute("x",i[3]+A))}),n.forEachChildren(P=>{P.name!==ta&&(d==="middle"?P.setAttribute("y",i[0]+(E-P.AABBBounds.height())/2):d==="bottom"?P.setAttribute("y",i[0]+E-P.AABBBounds.height()):P.setAttribute("y",i[0]))}),n.setAttributes({width:R+i[1]+i[3],height:E+i[0]+i[2]})}function yo(n,t,e,i,r,o,s){var a,l,h,u,d,c;if(!n)return;const f={};n.type==="image"?(n.isGif&&(f.gif=n.src),f.image=n.src):(n.type==="svg"||"svg"in n)&&(f.image=n.svg),f.width=n.width,f.height=n.height,f.visibleTime=(a=n.visibleTime)!==null&&a!==void 0?a:"always",f.funcType=n.funcType,f.interactive=n.interactive,f.isGif=n.isGif;let g,p=0;return s&&s?.addedHierarchyOffset!==0||!pt(e)||!pt(i)||!o||n.funcType!==Fe.collapse&&n.funcType!==Fe.expand&&n.positionType!==He.contentLeft&&n.positionType!==He.contentRight||(p=r?jr(r.start.col,r.start.row,o):jr(e,i,o),s&&(s.addedHierarchyOffset=1)),f.marginLeft=((l=n.marginLeft)!==null&&l!==void 0?l:0)+p,f.marginRight=(h=n.marginRight)!==null&&h!==void 0?h:0,n.interactive===!1&&(f.pickable=!1),n.hover&&(f.backgroundWidth=(u=n.hover.width)!==null&&u!==void 0?u:n.width,f.backgroundHeight=(d=n.hover.width)!==null&&d!==void 0?d:n.width,f.backgroundColor=(c=n.hover.bgColor)!==null&&c!==void 0?c:"rgba(22,44,66,0.2)",f.hoverImage=n.hover.image),n.cursor&&(f.cursor=n.cursor),"shape"in n&&n.shape==="circle"&&(f.shape=n.shape),t?(t.setAttributes(f),t.loadImage(f.image),t.tooltip=n.tooltip,t.name=n.name,t):(n.type==="text"?(f.text=n.content,Ue(f,n.style),g=new dJ(f),g.tooltip=n.tooltip,g.name=n.name):(g=new Cc(f),g.tooltip=n.tooltip,g.name=n.name),g)}function ix(n){var t,e,i,r,o,s;const a={};return n.type==="image"?a.image=n.src:(n.type==="svg"||"svg"in n)&&(a.image=n.svg),a.visibleTime=(t=n.visibleTime)!==null&&t!==void 0?t:"always",a.funcType=n.funcType,a.id=n.name,a.width=n.width,a.height=n.height,(n.marginRight||n.marginLeft)&&(a.margin=[0,(e=n.marginRight)!==null&&e!==void 0?e:0,0,(i=n.marginLeft)!==null&&i!==void 0?i:0]),n.hover&&(a.backgroundWidth=(r=n.hover.width)!==null&&r!==void 0?r:n.width,a.backgroundHeight=(o=n.hover.height)!==null&&o!==void 0?o:n.height,a.backgroundShowMode="hover",a.hoverImage=n.hover.image,a.backgroundStroke=!1,a.backgroundFill=(s=n.hover.bgColor)!==null&&s!==void 0?s:"rgba(22,44,66,0.2)"),n.cursor&&(a.cursor=n.cursor),a.tooltip=n.tooltip,a}function nx(n,t,e,i,r,o,s,a,l){var h,u,d,c;Dd(n.contentWidth)&&(i=t-((h=n.contentWidth)!==null&&h!==void 0?h:n.attribute.width));let f,g=0,p=0,v=0,m=0;n.forEachChildren(C=>{var x,S,A,T;C.role==="icon-left"?(g+=C.AABBBounds.width()+((x=C.attribute.marginLeft)!==null&&x!==void 0?x:0)+((S=C.attribute.marginRight)!==null&&S!==void 0?S:0),p=Math.max(p,C.AABBBounds.height())):C.role==="icon-right"&&(v+=C.AABBBounds.width()+((A=C.attribute.marginLeft)!==null&&A!==void 0?A:0)+((T=C.attribute.marginRight)!==null&&T!==void 0?T:0),m=Math.max(m,C.AABBBounds.height()))});const y=n.getChildByName("text"),b=n.getChildByName("content");let _;y instanceof si?(f=y.AABBBounds.height(),y.setAttribute("maxLineWidth",t-g-v-(o[1]+o[3])-((u=y.attribute.dx)!==null&&u!==void 0?u:0)-((d=l.table.theme._contentOffset)!==null&&d!==void 0?d:0)),_=y.AABBBounds.height()):y instanceof Ei?(f=y.AABBBounds.height(),y.setAttribute("width",t-g-v-(o[1]+o[3])),_=y.AABBBounds.height()):b&&(f=b.AABBBounds.height(),b.updateWidth(t-g-v-(o[1]+o[3])),_=b.AABBBounds.height());const w=Math.round(Math.max(p,m,f)+o[0]+o[2]);if(n.forEachChildren(C=>{var x;if(C.role!=="icon-left")if(C.role==="icon-right")C.setAttribute("x",C.attribute.x+i);else if(C.role==="icon-absolute-right")C.setAttribute("x",C.attribute.x+i);else if(C.name==="content"||C.name==="text"&&C.type!=="richtext"){const S=(x=C.attribute.textAlign)!==null&&x!==void 0?x:s;S==="center"?C.setAttribute("x",o[3]+g+(t-(o[1]+o[3])-g-v)/2):S==="right"&&C.setAttribute("x",o[3]+t-(o[1]+o[3])-v)}else C.name==="mark"&&C.setAttribute("x",n.attribute.width)}),r){let C=Math.max(p,_,m);if(rWt(l,n,Math.round(C+o[0]+o[2]),w))return!0;C=((c=n.contentHeight)!==null&&c!==void 0?c:e)-(o[0]+o[2]),n.forEachChildren(x=>{x.type!=="rect"&&x.type!=="chart"&&x.name!==ta&&(x.name==="mark"?x.setAttribute("y",0):a==="middle"?x.setAttribute("y",o[0]+(C-x.AABBBounds.height())/2):a==="bottom"?x.setAttribute("y",o[0]+C-x.AABBBounds.height()):x.setAttribute("y",o[0]))})}else a!=="middle"&&a!=="bottom"||n.forEachChildren(C=>{C.type!=="rect"&&C.type!=="chart"&&C.name!==ta&&(C.name==="mark"?C.setAttribute("y",0):a==="middle"?C.setAttribute("y",(e-o[2]+o[0]-C.AABBBounds.height())/2):a==="bottom"?C.setAttribute("y",e-C.AABBBounds.height()-o[2]):C.setAttribute("y",o[0]))});return!1}function rx(n,t,e,i,r,o,s,a){var l;const h=t-Math.floor(r[0]+r[2]),u=n.getChildByName("text");u instanceof si&&!i?u.setAttributes({heightLimit:((l=a.options.customConfig)===null||l===void 0?void 0:l.limitContentHeight)===!1?-1:h}):u instanceof Ei&&!i?u.setAttributes({height:h}):n.getChildByName("content")&&n.getChildByName("content").updateHeight(h),n.forEachChildren(d=>{d.setAttribute("dy",0),d.type==="rect"||d.type==="chart"||d.name===ta||(d.name==="mark"?d.setAttribute("y",0):s==="middle"?d.setAttribute("y",r[0]+(h-d.AABBBounds.height())/2):s==="bottom"?d.setAttribute("y",r[0]+h-d.AABBBounds.height()):d.setAttribute("y",r[0]))})}function rWt(n,t,e,i){const r=n.table,o=Ji(r,t.col,t.row);if(o&&o.end.row-o.start.row){i/=o.end.row-o.start.row+1,e/=o.end.row-o.start.row+1;for(let s=o.start.row;s<=o.end.row;s++){const a=r.getRowHeight(s);if(a===i&&e!==a||e>a)return!0}}else{const s=r.getRowHeight(t.row);if(s===i&&e!==s||e>s)return!0}return!1}function Lp(n,t,e,i){const r=[],o=[],s=[],a=[],l=[],h=[],u=[],d=[];let c=0,f=0,g=0,p=0,v=0,m=0;return n.forEach(y=>{switch(y.positionType){case He.left:r.push(y);break;case He.right:o.push(y);break;case He.contentLeft:s.push(y);break;case He.contentRight:a.push(y);break;case He.absoluteRight:d.push(y);break;case He.inlineFront:l.push(y);break;case He.inlineEnd:h.push(y)}}),r.forEach(y=>{var b,_,w;const C=yo(y,void 0,t.col,t.row,e,i);C.role="icon-left",C.name=y.name,C.setAttribute("x",c+((b=C.attribute.marginLeft)!==null&&b!==void 0?b:0)),c+=C.AABBBounds.width()+((_=C.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=C.attribute.marginRight)!==null&&w!==void 0?w:0),f=Math.max(f,C.AABBBounds.height()),t.appendChild(C)}),o.forEach(y=>{var b,_,w;const C=yo(y,void 0,t.col,t.row,e,i);C.role="icon-right",C.name=y.name,C.setAttribute("x",g+((b=C.attribute.marginLeft)!==null&&b!==void 0?b:0)),g+=C.AABBBounds.width()+((_=C.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=C.attribute.marginRight)!==null&&w!==void 0?w:0),p=Math.max(p,C.AABBBounds.height()),t.appendChild(C)}),u.forEach(y=>{var b,_,w;const C=yo(y,void 0,t.col,t.row,e,i);C.role="icon-absolute-left",C.name=y.name,C.setAttribute("x",v+((b=C.attribute.marginLeft)!==null&&b!==void 0?b:0)),v+=C.AABBBounds.width()+((_=C.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=C.attribute.marginRight)!==null&&w!==void 0?w:0),t.appendChild(C)}),d.forEach(y=>{var b,_,w;const C=yo(y,void 0,t.col,t.row,e,i);C.role="icon-absolute-right",C.name=y.name,C.setAttribute("x",m+((b=C.attribute.marginLeft)!==null&&b!==void 0?b:0)),m+=C.AABBBounds.width()+((_=C.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=C.attribute.marginRight)!==null&&w!==void 0?w:0),t.appendChild(C)}),{leftIcons:r,rightIcons:o,contentLeftIcons:s,contentRightIcons:a,inlineFrontIcons:l,inlineEndIcons:h,absoluteLeftIcons:u,absoluteRightIcons:d,leftIconWidth:c,leftIconHeight:f,rightIconWidth:g,rightIconHeight:p,absoluteLeftIconWidth:v,absoluteRightIconWidth:m}}function oWt(n,t){if(n.hasOwnProperty("hoverIconId")){const e=this;if(e.skipMergeUpdate)return;const i=wc(e);if(!i||!i.stage)return;const r=i.stage.table;e.skipAttributeUpdate=!0;const{mergeStartCol:o,mergeEndCol:s,mergeStartRow:a,mergeEndRow:l}=i;if(Y(o)&&Y(s)&&Y(a)&&Y(l)&&(o!==s||a!==l)){for(let h=o;h<=s;h++)for(let u=a;u<=l;u++){if(h===i.col&&u===i.row){if(n.hoverIconId!==e.attribute.hoverIconId){const c=e._frameCache.icons.get(n.hoverIconId);e.updateHoverIconState(c)}continue}const d=r.scenegraph.highPerformanceGetCell(h,u);if(d.role==="cell"){const c=d.getChildByName(e.name,!0);if(!c||c.skipAttributeUpdate)continue;n.hoverIconId!==c.attribute.hoverIconId&&(c.setAttribute("hoverIconId",n.hoverIconId),d.addUpdateBoundTag())}}e.skipAttributeUpdate=void 0}}}function sWt(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v){var m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K,J,q,X,it;const Z=f._getCellStyle(i,r),et=HA("padding",Z,i,r,f);!((m=f.options.customConfig)===null||m===void 0)&&m.imageMargin?h=ce((y=f.options.customConfig)===null||y===void 0?void 0:y.imageMargin):Y(et)&&(h=et),!((b=g?.text)===null||b===void 0)&&b.textAlign&&(u=(_=g?.text)===null||_===void 0?void 0:_.textAlign),!((w=g?.text)===null||w===void 0)&&w.textBaseline&&(d=(C=g?.text)===null||C===void 0?void 0:C.textBaseline);const nt=tl(i,r,g,f);let z,V;if(v&&(z=f.scenegraph.highPerformanceGetCell(i,r,!0),z&&z.role==="cell"&&z.setAttributes({x:t,y:e,width:o,height:s,lineWidth:(S=(x=g?.group)===null||x===void 0?void 0:x.lineWidth)!==null&&S!==void 0?S:void 0,fill:(T=(A=g?.group)===null||A===void 0?void 0:A.fill)!==null&&T!==void 0?T:void 0,stroke:(R=(M=g?.group)===null||M===void 0?void 0:M.stroke)!==null&&R!==void 0?R:void 0,strokeArrayWidth:nt??void 0,strokeArrayColor:(P=(E=g?.group)===null||E===void 0?void 0:E.strokeArrayColor)!==null&&P!==void 0?P:void 0,cursor:(k=(B=g?.group)===null||B===void 0?void 0:B.cursor)!==null&&k!==void 0?k:void 0,lineDash:(O=(L=g?.group)===null||L===void 0?void 0:L.lineDash)!==null&&O!==void 0?O:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})),z&&z.role==="cell"||(z=new re({x:t,y:e,width:o,height:s,lineWidth:(I=(D=g?.group)===null||D===void 0?void 0:D.lineWidth)!==null&&I!==void 0?I:void 0,fill:(F=(H=g?.group)===null||H===void 0?void 0:H.fill)!==null&&F!==void 0?F:void 0,stroke:(j=(G=g?.group)===null||G===void 0?void 0:G.stroke)!==null&&j!==void 0?j:void 0,strokeArrayWidth:nt??void 0,strokeArrayColor:(K=(W=g?.group)===null||W===void 0?void 0:W.strokeArrayColor)!==null&&K!==void 0?K:void 0,cursor:(q=(J=g?.group)===null||J===void 0?void 0:J.cursor)!==null&&q!==void 0?q:void 0,lineDash:(it=(X=g?.group)===null||X===void 0?void 0:X.lineDash)!==null&&it!==void 0?it:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),z.role="cell",z.col=i,z.row=r,n?.addCellGroup(z)),c){let at=i,ht=r;p&&(at=p.start.col,ht=p.start.row),V=f.getCellIcons(at,ht)}let $=0,U=0,Q=0;if(Array.isArray(V)&&V.length!==0){const{leftIconWidth:at,rightIconWidth:ht,absoluteRightIconWidth:gt}=Lp(V,z,p,f);$=at+ht,U=at,Q=ht,z.forEachChildren(dt=>{dt.role==="icon-left"?dt.setAttribute("x",dt.attribute.x+h[3]):dt.role==="icon-right"?dt.setAttribute("x",dt.attribute.x+o-ht-h[1]):dt.role==="icon-absolute-right"&&dt.setAttribute("x",dt.attribute.x+o-gt-h[1])}),z.forEachChildren(dt=>{d==="middle"?dt.setAttribute("y",(s-dt.AABBBounds.height())/2):d==="bottom"?dt.setAttribute("y",s-dt.AABBBounds.height()-h[2]):dt.setAttribute("y",h[0])}),z._cellLeftIconWidth=U,z._cellRightIconWidth=Q}const rt=f.getCellValue(i,r),st=uA({x:h[3],y:h[0],width:o-h[1]-h[3]-$,height:s-h[0]-h[2],image:rt,cursor:"pointer"});return st.name="image",st.keepAspectRatio=a,st.textAlign=u,st.textBaseline=d,a||l?st.resources&&st.resources.has(st.attribute.image)&&st.resources.get(st.attribute.image).state==="success"?(st.setAttribute("opacity",0),setTimeout(()=>{st.setAttribute("opacity",1),dV(l,a,h,u,d,st,z,f),f.scenegraph.updateNextFrame()},0)):st.successCallback=()=>{dV(l,a,h,u,d,st,z,f),f.scenegraph.updateNextFrame()}:st.resources&&st.resources.has(st.attribute.image)&&st.resources.get(st.attribute.image).state==="success"?qm(z,i,r,0,0,f):st.successCallback=()=>{qm(z,i,r,0,0,f)},st.failCallback=()=>{const at=ms();st.image=at.damage_pic.svg},z.appendChild(st),z}function pJ(n,t,e,i,r,o,s){let a=!1,l=null,h=null;const{width:u,height:d,isMerge:c}=lp(s,r.table);if(u<e+o[1]+o[3]&&(l=e+o[1]+o[3],a=!0),d<i+o[2]+o[0]&&(h=i+o[2]+o[0],a=!0),a){if(typeof l=="number")if(c)for(let f=s.mergeStartCol;f<=s.mergeEndCol;f++)r.setColWidth(f,l/(s.mergeEndCol-s.mergeStartCol+1));else r.setColWidth(n,l);if(typeof h=="number")if(c)for(let f=s.mergeStartRow;f<=s.mergeEndRow;f++)r.setRowHeight(f,h/(s.mergeEndRow-s.mergeStartRow+1));else r.setRowHeight(t,h);return r.component.updateScrollBar(),!0}return!1}function qm(n,t,e,i,r,o){var s,a,l,h,u,d,c,f,g,p,v,m;const y=n.getChildByName("image");if(!y)return;const b=typeof y.attribute.image!="string"&&y.attribute.image||((s=y.resources)===null||s===void 0?void 0:s.get(y.attribute.image).data);if(!b)return;const _=o._getCellStyle(t,e),w=(a=ut("textAlign",_,t,e,o))!==null&&a!==void 0?a:"left",C=(l=ut("textBaseline",_,t,e,o))!==null&&l!==void 0?l:"middle";let x;x=!((h=o.options.customConfig)===null||h===void 0)&&h.imageMargin?ce((u=o.options.customConfig)===null||u===void 0?void 0:u.imageMargin):(d=ce(ut("padding",_,t,e,o)))!==null&&d!==void 0?d:[0,0,0,0];const{width:S,height:A,isMerge:T}=lp(n,o),M=(c=n.mergeStartCol)!==null&&c!==void 0?c:n.col,R=(f=n.mergeStartRow)!==null&&f!==void 0?f:n.row,E=(g=n.mergeEndCol)!==null&&g!==void 0?g:n.col,P=(p=n.mergeEndCol)!==null&&p!==void 0?p:n.row,B=(v=n._cellLeftIconWidth)!==null&&v!==void 0?v:0,k=(m=n._cellRightIconWidth)!==null&&m!==void 0?m:0;if(y.keepAspectRatio){const{width:L,height:O}=IA(b.width||b.videoWidth,b.height||b.videoHeight,S-(x[1]+x[3]),A-(x[0]+x[2])),D=PD(0,0,S,A,L,O,w,C,x);for(let I=M;I<=E;I++)for(let H=R;H<=P;H++){const F=o.scenegraph.getCell(I,H).getChildByName("image");F?.setAttributes({x:D.x,y:D.y,width:L,height:O})}}else for(let L=M;L<=E;L++)for(let O=R;O<=P;O++){const D=o.scenegraph.getCell(L,O).getChildByName("image");D?.setAttributes({x:B+x[3],y:x[0],width:S-x[1]-x[3]-k-B,height:A-x[0]-x[2]})}if(n.getChildByName("play-icon")){const{width:D,height:I}=lp(n,o),H=Math.floor(Math.min(D-x[1]-x[3],I-x[2]-x[0])/2),F=0+(D>y.attribute.width?y.attribute.x-0+y.attribute.width/2:D/2),G=0+(I>y.attribute.height?y.attribute.y-0+y.attribute.height/2:I/2);for(let j=M;j<=E;j++)for(let W=R;W<=P;W++)o.scenegraph.getCell(j,W).getChildByName("play-icon").setAttributes({x:F-H/2,y:G-H/2,width:H,height:H})}n.forEachChildren(L=>{L.role==="icon-left"||(L.role==="icon-right"||L.role==="icon-absolute-right")&&L.setAttribute("x",L.attribute.x+i)}),n.forEachChildren(L=>{(L.type==="rect"||L.role&&L.role.startsWith("icon"))&&(C==="middle"?L.setAttribute("y",x[0]+(A-x[0]-x[2]-L.AABBBounds.height())/2):C==="bottom"?L.setAttribute("y",x[0]+A-x[0]-x[2]-L.AABBBounds.height()):L.setAttribute("y",x[0]))}),T&&kD(n.mergeStartCol,n.mergeEndCol,n.mergeStartRow,n.mergeEndRow,o)}function lp(n,t){return n.role==="cell"&&Y(n.mergeStartCol)&&Y(n.mergeEndCol)&&Y(n.mergeStartRow)&&Y(n.mergeEndRow)?{width:t.getColsWidth(n.mergeStartCol,n.mergeEndCol),height:t.getRowsHeight(n.mergeStartRow,n.mergeEndRow),isMerge:!0}:{width:n.attribute.width,height:n.attribute.height,isMerge:!1}}function kD(n,t,e,i,r){for(let o=n;o<=t;o++)for(let s=e;s<=i;s++){const a=r.scenegraph.getCell(o,s);if(a){const l=a.getChildByName("image");l&&l.setAttributes({dx:-r.getColsWidth(a.mergeStartCol,o-1),dy:-r.getRowsHeight(a.mergeStartRow,s-1)});const h=a.getChildByName("play-icon");h&&h.setAttributes({dx:-r.getColsWidth(a.mergeStartCol,o-1),dy:-r.getRowsHeight(a.mergeStartRow,s-1)})}}}function dV(n,t,e,i,r,o,s,a){const l=o.resources.get(o.attribute.image).data,{col:h,row:u}=s;if(n&&!cV(o)&&pJ(h,u,l.width,l.height,a.scenegraph,e,s),t||cV(o)){const{width:d,height:c,isMerge:f}=lp(s,a),{width:g,height:p}=IA(l.width,l.height,d-e[1]-e[3],c-e[0]-e[2]),v=PD(0,0,d,c,g,p,i,r,e);o.setAttributes({x:v.x,y:v.y,width:g,height:p}),f&&kD(s.mergeStartCol,s.mergeEndCol,s.mergeStartRow,s.mergeEndRow,a)}}function cV(n){const t=ms();return n.attribute.image===t.damage_pic.svg}function vJ(n,t,e){n.then(()=>{e(),t.scenegraph.updateNextFrame()}).catch(i=>{})}function aWt(n,t){var e,i;const r=this;if(r.shadowRoot&&r.shadowRoot.childrenCount&&(Y(n.width)||Y(n.height))){const o=r.shadowRoot.findChildrenByName("shadow-rect")[0];o&&o.setAttributes({width:(e=n.width)!==null&&e!==void 0?e:o.attribute.width,height:(i=n.height)!==null&&i!==void 0?i:o.attribute.height})}}function ED(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m){var y,b;let _,w=!1;if(aa(t)){if(i.scenegraph.highPerformanceGetCell(r,o).role!=="cell")return _;t=i.getCellValue(r,o),w=!0}if(n==="checkbox"&&e.tree)_=Bt.getFunction("createCheckboxCellGroup")(null,h,0,u,r,o,s,a,l,d,c,f,g,i,p,e,v,w,!0);else if(n==="text"||n==="link"||m){if(n==="link"){const A=t,T=i.getCellOriginValue(r,o),M=i._getCellStyle(r,o);n==="link"&&("templateLink"in e&&e.templateLink||!("linkDetect"in e)||!Ie(e.linkDetect,{col:r,row:o,table:i,value:A,dataValue:T,cellHeaderPaths:void 0})||xD.test(A))&&(p?(p.text.fill=ut("linkColor",M,r,o,i),p.group.cursor="pointer"):p={text:{fill:ut("linkColor",M,r,o,i)},group:{cursor:"pointer"}})}const{customElementsGroup:C,renderDefault:x}=fV(i,e,r,o,a,l,d,v,m);_=Bt.getFunction("createTextCellGroup")(i,t,h,0,u,r,o,s,a,l,d,c,f,g,C,x,p,v,w);const S=i.internalProps.layoutMap.getAxisConfigInPivotChart(r,o);if(S){const A=new(Bt.getComponent("axis"))(S,_.attribute.width,_.attribute.height,(y=S.__vtablePadding)!==null&&y!==void 0?y:d,i);_.clear(),_.appendChild(A.component),A.overlap()}else i.internalProps.layoutMap.isEmpty(r,o)?(_.setAttributes({fill:!1,stroke:!1}),_.clear()):i.internalProps.layoutMap.isAxisCell(r,o)&&_.clear()}else if(n==="image")_=Bt.getFunction("createImageCellGroup")(h,0,u,r,o,a,l,e.keepAspectRatio,e.imageAutoSizing,d,c,f,g,i,p,v,w);else if(n==="video")_=Bt.getFunction("createVideoCellGroup")(h,0,u,r,o,a,l,e.keepAspectRatio,e.imageAutoSizing,d,c,f,g,i,p,v,w);else if(n==="chart"){const C=i.internalProps.layoutMap.getChartInstance(r,o);_=Bt.getFunction("createChartCellGroup")(null,h,0,u,r,o,a,l,d,t,e.chartModule,i.internalProps.layoutMap.getChartSpec(r,o),C,(b=i.internalProps.layoutMap.getChartDataId(r,o))!==null&&b!==void 0?b:"data",i,p,i.internalProps.layoutMap.isShareChartSpec(r,o),w,i.internalProps.layoutMap.isNoChartDataRenderNothing(r,o))}else if(n==="progressbar"){const{customElementsGroup:C,renderDefault:x}=fV(i,e,r,o,a,l,d,v,m),S=i._getCellStyle(r,o),A=i.getCellOriginValue(r,o);_=Bt.getFunction("createTextCellGroup")(i,t,h,0,u,r,o,s,a,l,d,c,f,g,C,x,p,v,w);const T=Bt.getFunction("createProgressBarCell")(e,S,s,t,A,r,o,d,i,v);_.firstChild?_.insertBefore(T,_.firstChild):_.appendChild(T)}else if(n==="sparkline")_=Bt.getFunction("createSparkLineCellGroup")(null,h,0,u,r,o,a,l,d,i,p,w);else if(n==="checkbox"){const C="isAggregation"in i.internalProps.layoutMap&&i.internalProps.layoutMap.isAggregation(r,o),x=i.internalProps.layoutMap.isSeriesNumber(r,o);C&&x?_=Bt.getFunction("createTextCellGroup")(i,t,h,0,u,r,o,s,a,l,d,c,f,!1,void 0,!0,p,v,w):_=Bt.getFunction("createCheckboxCellGroup")(null,h,0,u,r,o,s,a,l,d,c,f,g,i,p,e,v,w,!1)}else n==="radio"?_=Bt.getFunction("createRadioCellGroup")(null,h,0,u,r,o,s,a,l,d,c,f,i,p,e,v):n==="switch"?_=Bt.getFunction("createSwitchCellGroup")(null,h,0,u,r,o,s,a,l,d,c,f,g,i,p,e,v,w):n==="button"&&(_=Bt.getFunction("createButtonCellGroup")(null,h,0,u,r,o,s,a,l,d,c,f,g,i,p,e,v,w));return _.onBeforeAttributeUpdate=aWt,_}function fV(n,t,e,i,r,o,s,a,l){let h,u=!0;if(l)h=l.elementsGroup,u=l.renderDefault;else if(!(a?.isCustom&&!n.isCornerHeader(e,i))){let d,c;if(n.getCellLocation(e,i)!=="body"?(d=t?.headerCustomRender,c=t?.headerCustomLayout):(d=t?.customRender||n.customRender,c=t?.customLayout),c||d){const f=hu(c,d,e,i,r,o,!1,n.isAutoRowHeight(i),s,a,n);h=f.elementsGroup,u=f.renderDefault}}return{customElementsGroup:h,renderDefault:u}}function ss(n,t,e,i,r,o){var s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x;const S=e.scenegraph.highPerformanceGetCell(n,t,!0);if(S.role!=="cell"&&!i)return;const A=e.getCellLocation(n,t);let T,M,R,E,P=e.getCellValue(n,t),B=!1;if(e.internalProps.customMergeCell){const Z=e.getCustomMerge(n,t);if(Z){const{range:et,text:nt,style:z,customLayout:V,customRender:$}=Z;M=et,T=M.start.col!==M.end.col||M.start.row!==M.end.row,P=nt,R=z,(V||$)&&(E=hu(V,$,et.start.col,et.start.row,e.getColsWidth(et.start.col,et.end.col),e.getRowsHeight(et.start.row,et.end.row),!1,e.isAutoRowHeight(t),[0,0,0,0],M,e)),B=!0}}let k=n,L=t;M&&(k=M.start.col,L=M.start.row);const O=A!=="body"?e.getHeaderDefine(k,L):e.getBodyColumnDefine(k,L);let D=A!=="body"||O?.dragOrder||!!O?.icon||!!O?.tree;M||!e.internalProps.enableTreeNodeMerge&&A==="body"&&!O?.mergeCell||(M=e.getCellRange(n,t),T=M.start.col!==M.end.col||M.start.row!==M.end.row);let I=!1;if(e.internalProps.enableTreeNodeMerge&&T){const Z=e.getCellRawRecord(M.start.col,M.start.row),{vtableMergeName:et,vtableMerge:nt}=Z??{};I=nt,nt&&(D=!0,e.internalProps.groupTitleCustomLayout&&(E=hu(e.internalProps.groupTitleCustomLayout,void 0,M.start.col,M.start.row,e.getColsWidth(M.start.col,M.end.col),e.getRowsHeight(M.start.row,M.end.row),!1,e.isAutoRowHeight(t),[0,0,0,0],M,e)),e.internalProps.groupTitleFieldFormat?P=e.internalProps.groupTitleFieldFormat(Z,n,t,e):et!==void 0&&(P=et))}const H=R||e._getCellStyle(M?M.start.col:n,M?M.start.row:t),F=(s=H.autoWrapText)!==null&&s!==void 0?s:e.internalProps.autoWrapText,G=yu(H,e,T?M.start.col:n,T?M.start.row:t,ut).theme;if(G.group.cornerRadius=OA(n,t,e),!i&&!T&&!(O?.customLayout||O?.customRender||O?.headerCustomLayout||O?.headerCustomRender)&&(o||lWt(n,t,S,F,D,e))){const Z=e.getColWidth(n),et=e.getRowHeight(t),nt=tl(n,t,G,e);S.setAttributes({width:Z,height:et,lineWidth:(l=(a=G?.group)===null||a===void 0?void 0:a.lineWidth)!==null&&l!==void 0?l:void 0,fill:(u=(h=G?.group)===null||h===void 0?void 0:h.fill)!==null&&u!==void 0?u:void 0,stroke:(c=(d=G?.group)===null||d===void 0?void 0:d.stroke)!==null&&c!==void 0?c:void 0,strokeArrayWidth:nt??void 0,strokeArrayColor:(g=(f=G?.group)===null||f===void 0?void 0:f.strokeArrayColor)!==null&&g!==void 0?g:void 0,cursor:(v=(p=G?.group)===null||p===void 0?void 0:p.cursor)!==null&&v!==void 0?v:void 0,cornerRadius:(y=(m=G?.group)===null||m===void 0?void 0:m.cornerRadius)!==null&&y!==void 0?y:0,lineDash:(_=(b=G?.group)===null||b===void 0?void 0:b.lineDash)!==null&&_!==void 0?_:void 0,y:e.scenegraph.getCellGroupY(t)}),S.mergeStartCol=void 0,S.mergeStartRow=void 0,S.mergeEndCol=void 0,S.mergeEndRow=void 0,S.forEachChildren(V=>{V.setAttributes({dx:0,dy:0})});const z=S.getChildByName("text");if(o&&z){const V=G.text.textAlign,$=jr(n,t,e),U={textBaseline:"top",dx:V==="left"?$:0};z.setAttributes(G.text?Object.assign({},G.text,U):U)}else if(z){const V=e.getCellValue(n,t),{text:$,moreThanMaxCharacters:U}=Km(V,e),Q=jr(n,t,e),rt=H.lineClamp,st=(w=ce(ut("padding",H,n,t,e)))!==null&&w!==void 0?w:[0,0,0,0],at=G.text.textAlign;let ht=0;ht=at==="center"?st[3]+(Z-(st[1]+st[3]))/2:at==="right"?st[3]+Z-(st[1]+st[3]):st[3];const gt={text:$.length!==1||F?$:$[0],moreThanMaxCharacters:U,maxLineWidth:Z-(st[1]+st[3]+Q),textBaseline:"top",autoWrapText:F,lineClamp:rt,wordBreak:"break-word",heightLimit:et-Math.floor(st[0]+st[2]),pickable:!1,dx:at==="left"?Q:0,x:ht};if(z.setAttributes(G.text?Object.assign({},G.text,gt):gt),z.attribute.text){const dt=G.text.textBaseline,vt=et-(st[0]+st[2]);let oe=0;oe=dt==="middle"?st[0]+(vt-z.AABBBounds.height())/2:dt==="bottom"?st[0]+vt-z.AABBBounds.height():st[0],z.setAttributes({y:oe})}}return S}if(!i&&S.role==="empty")return;const j=I||B?"text":e.isHeader(n,t)?(C=e._getHeaderLayoutMap(n,t).headerType)!==null&&C!==void 0?C:"text":(x=e.getBodyColumnType(n,t))!==null&&x!==void 0?x:"text",W=G._vtable.padding,K=G.text.textAlign,J=G.text.textBaseline;let q,X,it;if(M?(X=e.getColsWidth(M.start.col,M.end.col),it=e.getRowsHeight(M.start.row,M.end.row)):(X=e.getColWidth(n),it=e.getRowHeight(t)),aa(P)?(S.removeAllChild(),vJ(P,e,hWt.bind(null,{type:j,value:P,define:O,table:e,col:n,row:t,cellWidth:X,cellHeight:it,oldCellGroup:S,padding:W,textAlign:K,textBaseline:J,mayHaveIcon:D,addNew:i,range:M,customResult:E,customStyle:R}))):q=mJ(j,P,O,e,n,t,X,it,S,W,K,J,D,i,G,M,E),T){const{width:Z}=q.attribute,{height:et}=q.attribute;q.contentWidth=Z,q.contentHeight=et,r?uWt(M,X,it,W,K,J,e,q):yJ(M,X,it,W,K,J,e)}return q}function mJ(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v){var m,y;if(aa(t)&&(t=i.getCellValue(r,o)),!f&&(l.row!==o||l.col!==r))return null;if(!f&&l.parent&&i.reactCustomLayout){const _=l.getChildByName("custom-container");if(_){const{col:w,row:C}=_;pt(w)&&pt(C)&&i.reactCustomLayout.removeCustomCell(w,C)}}const b=ED(n,t,e,i,r,o,i.getColWidth(r),s,a,f?i.scenegraph.getColGroup(r):l.parent,f?0:i.scenegraph.getCellGroupY(o),h,u,d,c,g,p,v);return!f&&l.parent&&(l.parent.insertAfter(b,l),l.parent.removeChild(l),l.release(!0),!((m=i.scenegraph)===null||m===void 0)&&m.proxy.cellCache.get(r)&&((y=i.scenegraph)===null||y===void 0||y.proxy.cellCache.set(r,b))),b}function lWt(n,t,e,i,r,o){var s;const a=o.getBodyColumnType(n,t),l=o.isAutoRowHeight(t),h=o.getCellValue(n,t);return!(o.isHeader(n,t)||e.role!=="cell"||a!=="text"||i||l||r||((s=e.firstChild)===null||s===void 0?void 0:s.type)!=="text"||aa(h))}function hWt(n){const{type:t,value:e,define:i,table:r,col:o,row:s,cellWidth:a,cellHeight:l,oldCellGroup:h,padding:u,textAlign:d,textBaseline:c,mayHaveIcon:f,addNew:g,range:p,customResult:v,customStyle:m}=n,y=m||r._getCellStyle(p?p.start.col:o,p?p.start.row:s),b=yu(y,r,p?p.start.col:o,p?p.start.row:s,ut).theme;b.group.cornerRadius=OA(o,s,r),mJ(t,e,i,r,o,s,a,l,h,u,d,c,f,g,b,p,v)}function yJ(n,t,e,i,r,o,s){for(let a=n.start.col;a<=n.end.col;a++)for(let l=n.start.row;l<=n.end.row;l++){const h=s.scenegraph.highPerformanceGetCell(a,l,!0);if(h.role!=="cell")continue;n.start.row!==n.end.row&&h.contentHeight!==e&&rx(h,e,e,s.isAutoRowHeight(l),i,r,o,s),n.start.col!==n.end.col&&h.contentWidth!==t&&nx(h,t,e,0,s.isAutoRowHeight(l),i,r,o,s.scenegraph),h.contentWidth=t,h.contentHeight=e;const u=s.getRowHeight(l);Hy(h,s.getColWidth(a),u,n,s)}}function uWt(n,t,e,i,r,o,s,a){const{col:l,row:h}=a;n.start.row!==n.end.row&&a.contentHeight!==e&&rx(a,e,e,s.isAutoRowHeight(h),i,r,o,s),n.start.col!==n.end.col&&a.contentWidth!==t&&nx(a,t,e,0,s.isAutoRowHeight(h),i,r,o,s.scenegraph),a.contentWidth=t,a.contentHeight=e;const u=s.getRowHeight(h);Hy(a,s.getColWidth(l),u,n,s)}function Hy(n,t,e,i,r){var o,s;const{col:a,row:l}=n,h=-r.getColsWidth(i.start.col,a-1);let u=0;if(!((o=r.options.customConfig)===null||o===void 0)&&o._disableColumnAndRowSizeRound)for(let v=i.start.row;v<=l-1;v++)u-=r.getRowHeight(v);else u=-r.getRowsHeight(i.start.row,l-1);n.forEachChildren(v=>{var m,y,b,_,w,C;typeof v._dx=="number"?(v.skipMergeUpdate=!0,v.setAttributes({dx:((m=v._dx)!==null&&m!==void 0?m:0)+h}),v.skipMergeUpdate=!1):(v._dx=(y=v.attribute.dx)!==null&&y!==void 0?y:0,v.skipMergeUpdate=!0,v.setAttributes({dx:((b=v.attribute.dx)!==null&&b!==void 0?b:0)+h}),v.skipMergeUpdate=!1),typeof v._dy=="number"?(v.skipMergeUpdate=!0,v.setAttributes({dy:((_=v._dy)!==null&&_!==void 0?_:0)+u}),v.skipMergeUpdate=!1):(v._dy=(w=v.attribute.dy)!==null&&w!==void 0?w:0,v.skipMergeUpdate=!0,v.setAttributes({dy:((C=v.attribute.dy)!==null&&C!==void 0?C:0)+u}),v.skipMergeUpdate=!1)});const d=(s=n.attribute.strokeArrayWidth)!==null&&s!==void 0?s:n.attribute.lineWidth,c=Mt(d),f=[0,0,0,0];a===i.start.col&&(f[3]=c?d[3]:d),l===i.start.row&&(f[0]=c?d[0]:d),a===i.end.col&&(f[1]=c?d[1]:d),l===i.end.row&&(f[2]=c?d[2]:d);const g=t!==n.attribute.width,p=e!==n.attribute.height;return n.skipMergeUpdate=!0,n.setAttributes({width:t,height:e,strokeArrayWidth:f}),n.skipMergeUpdate=!1,n.mergeStartCol=i.start.col,n.mergeStartRow=i.start.row,n.mergeEndCol=i.end.col,n.mergeEndRow=i.end.row,{widthChange:g,heightChange:p}}function ox(n,t,e,i){if(i.internalProps.customMergeCell){const r=i.getCustomMerge(n,t);if(r){const{range:o,text:s,style:a,customLayout:l,customRender:h}=r;if(l||h){const u=hu(l,h,o.start.col,o.start.row,i.getColsWidth(o.start.col,o.end.col),i.getRowsHeight(o.start.row,o.end.row),!1,i.isAutoRowHeight(t),[0,0,0,0],o,i).elementsGroup;e.childrenCount>0&&u?e.insertBefore(u,e.firstChild):u&&e.appendChild(u);const d=i.getRowHeight(t),c=i.getColWidth(n),{width:f}=e.attribute,{height:g}=e.attribute;return e.contentWidth=f,e.contentHeight=g,Hy(e,c,d,o,i),o}}}}function $h(n){return!!(n.role==="cell"&&pt(n.mergeStartCol)&&pt(n.mergeStartRow)&&pt(n.mergeEndCol)&&pt(n.mergeEndRow))}const i2=new au({}),D0=new sp({}),dWt=new ou({});function cWt(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){const p=pn(n)?n.text:n,v=MA(p).split(`
`)||[],m=g.getColsWidth(t,i),y=ut("size",r,t,e,g);let b=0;if(o){const _=ut("spaceBetweenTextAndIcon",r,t,e,g),w=m-(f[1]+f[3])-s-y-_;i2.setAttributes({text:{maxLineWidth:w,text:v,fontSize:a,fontStyle:l,fontWeight:h,fontFamily:u,lineHeight:d,wordBreak:"break-word",lineClamp:c},icon:{width:Math.floor(y/1.4),height:Math.floor(y/1.4)},box:{width:y,height:y},spaceBetweenTextAndIcon:_}),i2.render(),b=i2.AABBBounds.height()}else b=Math.max(y,v.length*d);return b}function fWt(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){var p;if(Mt(n)){let v=0;const m=g.getBodyColumnDefine(t,e),y=ut("spaceBetweenRadio",r,t,e,g),b=(p=m?.radioDirectionInCell)!==null&&p!==void 0?p:"vertical";return b==="vertical"?n.forEach((_,w)=>{const C=n2(_,t,e,i,r,o,s,a,l,h,u,d,c,f,g);v+=C,w!==n.length-1&&(v+=y)}):b==="horizontal"&&n.forEach(_=>{const w=n2(_,t,e,i,r,o,s,a,l,h,u,d,c,f,g);v=Math.max(w,v)}),v}return n2(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g)}function n2(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){const p=pn(n)?n.text:n,v=MA(p).split(`
`)||[],m=g.getColsWidth(t,i),y=ut("size",r,t,e,g);let b=ut("outerRadius",r,t,e,g);const _=pt(b)?2*b:y;let w=0;if(o){const C=ut("spaceBetweenTextAndIcon",r,t,e,g),x=m-(f[1]+f[3])-s-_-C;pt(b)||(b=Math.round(y/2)),D0.setAttributes({text:{maxLineWidth:x,text:v,fontSize:a,fontStyle:l,fontWeight:h,fontFamily:u,lineHeight:d,wordBreak:"break-word",lineClamp:c},circle:{outerRadius:b},spaceBetweenTextAndIcon:C}),D0.render(),w=D0.AABBBounds.height()}else w=Math.max(y,v.length*d);return w}function gWt(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){return ut("boxWidth",r,t,e,g)}function pWt(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){const p=pn(n)?n.text:n,v=MA(p).split(`
`)||[],m=g.getColsWidth(t,i),y=ut("buttonPadding",r,t,e,g),b=ut("buttonLineWidth",r,t,e,g);let _=0;if(o){const w=m-(f[1]+f[3]);dWt.setAttributes({text:v,textStyle:{maxLineWidth:w,fontSize:a,fontStyle:l,fontWeight:h,fontFamily:u,lineHeight:d,wordBreak:"break-word",lineClamp:c},padding:y,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:b}}),D0.render(),_=D0.AABBBounds.height()}else _=v.length*d+2*y;return _}let vWt="",rE="quick";const mWt=new Ut((n,t,e,i)=>{e(Hl)?i(Hl).to(pV).inSingletonScope():n(Hl).to(pV).inSingletonScope()});new Ut((n,t,e,i)=>{e(Hl)?i(Hl).to(qg).inSingletonScope():n(Hl).to(qg).inSingletonScope()});const gV=new Map;function oE(n,t,e,i="normal"){const r=`${n}-${t}-${e}-${i}`,o=gV.get(r);if(o)return o;const s=(a={fontSize:n,fontFamily:e,fontWeight:t,fontStyle:i},new co(Object.assign({defaultFontParams:{fontFamily:$r.fontFamily,fontSize:$r.fontSize},getTextBounds:dA,specialCharSet:`{}()//&-/: .,@%'"~=${co.ALPHABET_CHAR_SET}${co.ALPHABET_CHAR_SET.toUpperCase()}0123456789${vWt}`},{}),a));var a;return gV.set(r,s),s}class pV extends qg{_fastMeasure(t,e){const{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=e,a=oE(i,o,r,s).measure(t,rE);if(!Y(a.fontBoundingBoxAscent)&&!Y(a.fontBoundingBoxDescent)){const{ascent:l,descent:h}=this.measureTextBoundADscentEstimate(e);a.fontBoundingBoxAscent=l,a.fontBoundingBoxDescent=h}return a}measureTextWidth(t,e){return this._fastMeasure(t,e).width}measureText(t,e){return this._fastMeasure(t,e)}_measureTextWithoutAlignBaseline(t,e,i){return this._fastMeasure(t,e)}_measureTextWithAlignBaseline(t,e,i){return this._fastMeasure(t,e)}}class yWt{measureText(t,e){const{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=e;return oE(i,o,r,s).measure(t,rE)}measureTextWidth(t,e){const{fontSize:i,fontFamily:r="Arial,sans-serif",fontWeight:o="normal",fontStyle:s="normal"}=e;return oE(i,o,r,s).measure(t,rE).width}clipText(t,e,i){if(t.length===0)return{str:"",width:0};let r=this.measureTextWidth(t,e);return r<=i?{str:t,width:r}:(r=this.measureTextWidth(t[0],e),r>i?{str:"",width:0}:this._clipText(t,e,i,0,t.length-1))}_clipText(t,e,i,r,o){const s=Math.floor((r+o)/2),a=t.substring(0,s+1),l=this.measureTextWidth(a,e);let h;if(l>i){if(a.length<=1)return{str:"",width:0};const u=t.substring(0,s);return h=this.measureTextWidth(u,e),h<=i?{str:u,width:h}:this._clipText(t,e,i,r,s)}if(l<i){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};const u=t.substring(0,s+2);return h=this.measureTextWidth(u,e),h>=i?{str:a,width:l}:this._clipText(t,e,i,s,o)}return{str:a,width:l}}clipTextWithSuffix(t,e,i,r){if(r==="")return this.clipText(t,e,i);if(t.length===0)return{str:"",width:0};const o=this.measureTextWidth(t,e);if(o<=i)return{str:t,width:o};const s=this.measureTextWidth(r,e);if(s>i)return{str:"",width:0};i-=s;const a=this._clipText(t,e,i,0,t.length-1);return a.str+=r,a.width+=s,a}}const LD=new yWt,vV=new si({ignoreBuf:!0});function bJ(n){return vV.initAttributes(Object.assign(Object.assign({},n),{ignoreBuf:!0})),vV.AABBBounds}const mV=new Ei({width:0,height:0,textConfig:[]});function as(n,t,e,i=!0,r){var o,s,a,l,h,u,d,c,f,g,p;typeof window<"u"&&window.performance.now();const v=[],m=[];if(r)for(let C=t;C<=e;C++)v[C]=n.getRowHeight(C);const y=n.internalProps.layoutMap;n.isPivotTable()&&(y.enableUseGetBodyCache(),y.enableUseHeaderPathCache()),n.defaultHeaderRowHeight,n.defaultHeaderColWidth;const b=n.defaultHeaderRowHeight==="auto"||Mt(n.defaultHeaderRowHeight)&&n.defaultHeaderRowHeight.some(C=>C==="auto"),_=n.isAutoRowHeight(t)||n.heightMode==="adaptive"&&n.options.autoHeightInAdaptiveMode!==!1,w=n.options.defaultRowHeight==="auto";if(_||b||w){t=t??0,e=e??n.rowCount-1,(t===0&&e===n.rowCount-1||i)&&n._clearRowRangeHeightsMap();for(let C=t;C<n.columnHeaderLevelCount;C++){let x=0,S=n.colCount-1;if((n.isPivotTable()&&!n.isPivotChart()||n.isPivotChart()&&!n.internalProps.layoutMap.indicatorsAsCol)&&CWt(n,C)&&!Ji(n,n.rowHeaderLevelCount,C)&&(x=0,S=n.rowHeaderLevelCount),_||n.getDefaultRowHeight(C)==="auto"){const A=qo(C,x,S,n);m[C]=Math.round(A),n.heightAdaptiveMode!=="only-body"&&r||n._setRowHeight(C,A)}}for(let C=n.rowCount-n.bottomFrozenRowCount;C<=e;C++)if(_||n.getDefaultRowHeight(C)==="auto"){const x=qo(C,0,n.colCount-1,n);r?m[C]=Math.round(x):n._setRowHeight(C,x)}if(!(e<n.columnHeaderLevelCount||!_&&!w))if(n.internalProps.transpose||n.isPivotTable()&&!n.internalProps.layoutMap.indicatorsAsCol||n.options.customComputeRowHeight||!bWt(n,t))if(n.internalProps.transpose||n.isPivotTable()&&!n.internalProps.layoutMap.indicatorsAsCol)for(let C=Math.max(t,n.columnHeaderLevelCount);C<=e;C++){let x;x=_Wt(n,C)?qo(C,0,n.rowHeaderLevelCount,n):qo(C,0,n.colCount-1,n),r?m[C]=Math.round(x):n._setRowHeight(C,x)}else for(let C=Math.max(t,n.columnHeaderLevelCount);C<=e;C++){const x=qo(C,0,n.colCount-1,n);r?m[C]=Math.round(x):n._setRowHeight(C,x)}else{wWt(qo(n.columnHeaderLevelCount,0,n.colCount-1,n),n.columnHeaderLevelCount,n.rowCount-1-n.bottomFrozenRowCount,n,r?m:void 0);for(let C=n.rowCount-n.bottomFrozenRowCount;C<=e;C++){const x=qo(C,0,n.colCount-1,n);r?m[C]=Math.round(x):n._setRowHeight(C,x)}}}else if((n.heightMode==="adaptive"||n.autoFillHeight)&&n.clearRowHeightCache(),r)for(let C=t;C<=e;C++)m[C]=n.getRowHeight(C);if((t===0&&e===n.rowCount-1||i)&&n._clearRowRangeHeightsMap(),n.heightMode==="adaptive"){n._clearRowRangeHeightsMap();let C=n.tableNoFrameHeight,x=0,S=n.rowCount;if(n.heightAdaptiveMode==="only-body"){const M=n.getRowsHeight(0,n.columnHeaderLevelCount-1),R=n.isPivotChart()?n.getBottomFrozenRowsHeight():0;C=n.tableNoFrameHeight-M-R,x=n.columnHeaderLevelCount,S=n.isPivotChart()?n.rowCount-n.bottomFrozenRowCount:n.rowCount}let A=0;for(let M=x;M<S;M++)A+=r&&(o=m[M])!==null&&o!==void 0?o:n.getRowHeight(M);const T=C/A;for(let M=x;M<S;M++){let R;R=M===S-1?C-(r?m.reduce((E,P,B)=>B>=x&&B<=S-2?E+P:E,0):n.getRowsHeight(x,S-2)):Math.round((r&&(s=m[M])!==null&&s!==void 0?s:n.getRowHeight(M))*T),r?m[M]=R:n._setRowHeight(M,R,!1)}}else if(n.autoFillHeight){n._clearRowRangeHeightsMap();const C=n.tableNoFrameHeight;let x=0,S=0;for(let A=0;A<n.rowCount;A++){const T=r&&(a=m[A])!==null&&a!==void 0?a:n.getRowHeight(A);(A<n.columnHeaderLevelCount||n.isPivotChart()&&A>=n.rowCount-n.bottomFrozenRowCount)&&(S+=T),x+=T}if(n.scenegraph._dealAutoFillHeightOriginRowsHeight=x,x<C&&x-S>0){const A=n.columnHeaderLevelCount,T=n.isPivotChart()?n.rowCount-n.bottomFrozenRowCount:n.rowCount,M=(C-S)/(x-S);for(let R=A;R<T;R++){let E;E=R===T-1?C-S-(r?m.reduce((P,B,k)=>k>=A&&k<=T-2?P+B:P,0):n.getRowsHeight(A,T-2)):Math.round((r&&(l=m[R])!==null&&l!==void 0?l:n.getRowHeight(R))*M),r?m[R]=E:n._setRowHeight(R,E,!1)}}}if(r){for(let C=t;C<=e;C++){const x=(h=m[C])!==null&&h!==void 0?h:n.getRowHeight(C);Y(x)&&n._setRowHeight(C,x)}for(let C=0;C<=n.frozenRowCount-1;C++){const x=n.getRowHeight(C);x!==((u=v[C])!==null&&u!==void 0?u:n.getRowHeight(C))&&n.scenegraph.updateRowHeight(C,x-((d=v[C])!==null&&d!==void 0?d:n.getRowHeight(C)),!0)}for(let C=n.rowCount-n.bottomFrozenRowCount;C<=n.rowCount-1;C++){const x=n.getRowHeight(C);x!==((c=v[C])!==null&&c!==void 0?c:n.getRowHeight(C))&&n.scenegraph.updateRowHeight(C,x-((f=v[C])!==null&&f!==void 0?f:n.getRowHeight(C)),!0)}for(let C=n.scenegraph.proxy.rowStart;C<=n.scenegraph.proxy.rowEnd;C++){const x=n.getRowHeight(C);x!==((g=v[C])!==null&&g!==void 0?g:n.getRowHeight(C))&&n.scenegraph.updateRowHeight(C,x-((p=v[C])!==null&&p!==void 0?p:n.getRowHeight(C)),!0)}}n.isPivotTable()&&(y.disableUseGetBodyCache(),y.disableUseHeaderPathCache())}function qo(n,t,e,i){var r;if(!(i.isAutoRowHeight(n)||i.heightMode==="adaptive"&&i.options.autoHeightInAdaptiveMode!==!1)&&i.getDefaultRowHeight(n)!=="auto")return i.getDefaultRowHeight(n);let o;if(i.options.customComputeRowHeight){const a=i.options.customComputeRowHeight({row:n,table:i});if(typeof a=="number")return a;if(a!=="auto")return i.getDefaultRowHeight(n)}if(i.isPivotChart()&&n>=i.columnHeaderLevelCount&&n<i.rowCount-i.bottomFrozenRowCount){let a=i.internalProps.layoutMap.indicatorsAsCol,l=!1;if(i.internalProps.layoutMap.indicatorsAsCol||i.internalProps.layoutMap.getChartSpec(i.rowHeaderLevelCount,n).type==="heatmap"&&(l=!0,a=!0),a){const h=i.internalProps.layoutMap.getOptimunHeightForChart(n,l);if(h>0)return h}else{const h=i.getDefaultRowHeight(n);if(pt(h))return h}}for(let a=t;a<=e;a++){const l=xWt(a,n,i);if(l&&(o=Y(o)?Math.max(l.height,o):l.height,!l.renderDefault))continue;if(i.isPivotChart()){const u=i.internalProps.layoutMap.getAxisConfigInPivotChart(a,n);if(u){const d=Bt.getFunction("computeAxisComponentHeight")(u,i);if(typeof d=="number"){o=Y(o)?Math.max(d,o):d;continue}}}if(i.isPivotChart()&&(i.isLeftFrozenColumn(a)&&i.isBottomFrozenRow(n)||i.isRightFrozenColumn(a)&&i.isBottomFrozenRow(n)))continue;const h=SWt(a,n,i.isHeader(a,n)?(r=i._getHeaderLayoutMap(a,n))===null||r===void 0?void 0:r.headerType:i.getBodyColumnType(a,n),i);o=Y(o)?Math.max(h,o):h}if(Y(o))return o;const s=i.getDefaultRowHeight(n);return pt(s)?s:i.defaultRowHeight}function bWt(n,t){var e,i,r;const{layoutMap:o}=n.internalProps,s=n.columnHeaderLevelCount;if((n.internalProps.autoWrapText||n.internalProps.enableLineBreak||n.isPivotChart())&&(n.isAutoRowHeight(t)||n.options.heightMode==="adaptive"))return!1;for(let a=0;a<n.colCount;a++){const l=o.getBody(a,s);if(l.cellType==="radio"||typeof l.style=="function"||typeof l.icon=="function"||!((e=l.define)===null||e===void 0)&&e.customRender||!((i=l.define)===null||i===void 0)&&i.customLayout||typeof((r=l.define)===null||r===void 0?void 0:r.icon)=="function")return!1;const h=n._getCellStyle(a,s);if(typeof h.padding=="function"||typeof h.fontSize=="function"||typeof h.lineHeight=="function"||h.autoWrapText===!0)return!1}return!0}function _Wt(n,t){var e,i,r;const{layoutMap:o}=n.internalProps;if((n.internalProps.autoWrapText||n.internalProps.enableLineBreak)&&(n.isAutoRowHeight(t)||n.options.heightMode==="adaptive"))return!1;const s=o.getBody(n.rowHeaderLevelCount,t);if(typeof s.style=="function"||typeof s.icon=="function"||!((e=s.define)===null||e===void 0)&&e.customRender||!((i=s.define)===null||i===void 0)&&i.customLayout||typeof((r=s.define)===null||r===void 0?void 0:r.icon)=="function")return!1;const a=n._getCellStyle(n.rowHeaderLevelCount,t);return typeof a.padding!="function"&&typeof a.fontSize!="function"&&typeof a.lineHeight!="function"&&a.autoWrapText!==!0}function CWt(n,t){var e,i,r;const{layoutMap:o}=n.internalProps;if(n.internalProps.autoWrapText&&(n.isAutoRowHeight(t)||n.options.heightMode==="adaptive"))return!1;const s=o.getHeader(n.rowHeaderLevelCount,t);if(typeof s.style=="function"||typeof s.icons=="function"||!((e=s.define)===null||e===void 0)&&e.headerCustomRender||!((i=s.define)===null||i===void 0)&&i.headerCustomLayout||typeof((r=s.define)===null||r===void 0?void 0:r.icon)=="function")return!1;const a=n._getCellStyle(n.rowHeaderLevelCount,t);return typeof a.padding!="function"&&typeof a.fontSize!="function"&&typeof a.lineHeight!="function"&&a.autoWrapText!==!0}function wWt(n,t,e,i,r){if(!i.internalProps.useOneRowHeightFillAll){for(let o=t;o<=e;o++)r?r[o]=n:i._setRowHeight(o,n);i.internalProps.useOneRowHeightFillAll=!0}}function xWt(n,t,e){var i,r,o,s,a,l,h;const u=e.getCustomRender(n,t);let d=e.getCustomLayout(n,t);if(u||d){let c,f=1,g=0,p=!1,v=!1;(e.isHeader(n,t)||!((i=e.getBodyColumnDefine(n,t))===null||i===void 0)&&i.mergeCell||e.hasCustomMerge())&&(c=e.getCellRange(n,t),f=c.end.row-c.start.row+1);const m={col:(r=c?.start.col)!==null&&r!==void 0?r:n,row:(o=c?.start.row)!==null&&o!==void 0?o:t,dataValue:e.getCellOriginValue(n,t),value:e.getCellValue(n,t)||"",rect:AWt(n,t,e),table:e,originCol:n,originRow:t,forComputation:!0};if(d==="react-custom-layout"&&(d=((s=e.reactCustomLayout)===null||s===void 0?void 0:s.getCustomLayoutFunc(n,t))||Xm),Bo(d)){const y=d(m);y.rootContainer?(y.rootContainer=Ym(y.rootContainer),DA(y.rootContainer,e.getColWidth(n),0),y.rootContainer.setStage(e.scenegraph.stage),g=(a=y.rootContainer.AABBBounds.height())!==null&&a!==void 0?a:0,p=y.renderDefault,v=y.enableCellPadding):(g=0,p=y.renderDefault,v=y.enableCellPadding)}else if(typeof u=="function"){const y=u(m);g=(l=y?.expectedHeight)!==null&&l!==void 0?l:0,p=y?.renderDefault}else g=(h=u?.expectedHeight)!==null&&h!==void 0?h:0,p=u?.renderDefault;if(v){const y=e._getCellStyle(n,t),b=ce(ut("padding",y,n,t,e));g+=b[0]+b[2]}return{height:g/f,renderDefault:p}}}function SWt(n,t,e,i){var r,o,s,a;let l=0;const h=i.getCellValue(n,t),u=i._getCellStyle(n,t);let d=0,c=0;const f=[];let g=0;const p=[];let v=0,m=!1;if(i.getCellLocation(n,t)!=="body")m=!0;else{const B=i.getBodyColumnDefine(n,t);m=!!B?.icon||!!B?.tree||B?.dragOrder}if(m){const B=i.getCellIcons(n,t);B?.forEach(k=>{var L,O,D,I,H,F,G,j,W,K;k.positionType!==He.absoluteRight&&k.positionType!==He.inlineFront&&k.positionType!==He.inlineEnd?(c+=((L=k.width)!==null&&L!==void 0?L:0)+((O=k.marginLeft)!==null&&O!==void 0?O:0)+((D=k.marginRight)!==null&&D!==void 0?D:0),d=Math.max(d,(I=k.height)!==null&&I!==void 0?I:0)):k.positionType===He.inlineFront?(f.push(k),g=Math.max(g,((H=k.height)!==null&&H!==void 0?H:0)+((F=k.marginLeft)!==null&&F!==void 0?F:0)+((G=k.marginRight)!==null&&G!==void 0?G:0))):k.positionType===He.inlineEnd&&(p.push(k),v=Math.max(v,((j=k.height)!==null&&j!==void 0?j:0)+((W=k.marginLeft)!==null&&W!==void 0?W:0)+((K=k.marginRight)!==null&&K!==void 0?K:0)))})}let y=1,b=n;if(i.isHeader(n,t)||!((r=i.getBodyColumnDefine(n,t))===null||r===void 0)&&r.mergeCell||i.hasCustomMerge()){const B=i.getCellRange(n,t);y=B.end.row-B.start.row+1,n=B.start.col,b=B.end.col}const _=ce(ut("padding",u,n,t,i)),w=ut("fontSize",u,n,t,i),C=ut("fontStyle",u,n,t,i),x=ut("fontWeight",u,n,t,i),S=(o=ut("lineHeight",u,n,t,i))!==null&&o!==void 0?o:w,A=ut("fontFamily",u,n,t,i),T=ut("autoWrapText",u,n,t,i),M=ut("lineClamp",u,n,t,i),R=ut("underline",u,n,t,i),E=(s=ut("underlineOffset",u,n,t,i))!==null&&s!==void 0?s:0;let P;if(e!=="text"&&e!=="link"&&e!=="progressbar"&&e!=="checkbox"&&e!=="radio"&&e!=="switch"&&e!=="button")l=S;else if(e==="checkbox")l=cWt(h,n,t,b,u,T,c,w,C,x,A,S,M,_,i);else if(e==="radio")l=fWt(h,n,t,b,u,T,c,w,C,x,A,S,M,_,i);else if(e==="switch")l=gWt(h,n,t,b,u,T,c,w,C,x,A,S,M,_,i);else if(e==="button")l=pWt(h,n,t,b,u,T,c,w,C,x,A,S,M,_,i);else{P=h;const B=Km(P,i).text,k=i.getColsWidth(n,b);if(f.length||p.length)if(T){const L=Object.assign({text:h?.toString(),fontFamily:A,fontSize:w,fontStyle:C,fontWeight:x,lineHeight:S});L.textBaseline="middle";const O=[...f.map(D=>ix(D)),L,...p.map(D=>ix(D))];mV.setAttributes({width:k-(_[1]+_[3])-c,height:0,textConfig:O}),l=mV.AABBBounds.height()}else l=0,B.forEach((L,O)=>{var D;!((D=i.options.customConfig)===null||D===void 0)&&D.multilinesForXTable&&O!==0||(O===0&&f.length?l+=Math.max(S,g):O===B.length-1&&p.length?l+=Math.max(S,v):l+=S)});else if(T){const L=jr(n,t,i),O=k-(_[1]+_[3])-c-L;l=(bJ({maxLineWidth:O,text:B,fontSize:w,fontStyle:C,fontWeight:x,fontFamily:A,lineHeight:S,wordBreak:"break-word",whiteSpace:B.length!==1||T?"normal":"no-wrap",lineClamp:M}).height()||(typeof S=="number"?S:w))+(R?E:0)}else l=!((a=i.options.customConfig)===null||a===void 0)&&a.multilinesForXTable?S:B.length*S}return(Math.max(l,d)+_[0]+_[2])/y}function AWt(n,t,e){return{left:0,top:0,right:e.getColWidth(n),bottom:e.getRowHeight(t),width:e.getColWidth(n),height:0}}function bu(n,t){if(!t||!t.proxy)return{colStart:0,colEnd:0,rowStart:0,rowEnd:0};const{mergeStartCol:e,mergeEndCol:i,mergeStartRow:r,mergeEndRow:o,col:s,row:a}=n;return{colStart:e,colEnd:i,rowStart:r,rowEnd:o}}function TWt(n,t){const e=n.start.col,i=n.end.col,r=n.start.row,o=n.end.row;let s=e,a=i,l=r,h=o;for(let u=e;u<=i;u++)for(let d=r;d<=o;d++){const c=t.getCellRange(u,d);c&&(s=Math.min(s,c.start.col),a=Math.max(a,c.end.col),l=Math.min(l,c.start.row),h=Math.max(h,c.end.row))}return n.start.col=s,n.end.col=a,n.start.row=l,n.end.row=h,n}function yV(n,t,e,i){!i&&e&&n.table._setRowHeight(t,n.table.getRowHeight(t)+e,!0);for(let s=0;s<n.table.colCount;s++){const a=n.getCell(s,t);if(a.role==="empty")continue;const l=Ji(n.table,s,t);l&&l.start.col!==s||(_J(n,a,s,t,a.attribute.height+e,e,n.table.isHeader(s,t)),n.updateCellContentWhileResize(s,t))}let r=0,o=0;t<n.table.frozenRowCount?(r=t+1,o=n.table.frozenRowCount-1):t>=n.table.rowCount-n.table.bottomFrozenRowCount?(r=t+1,o=n.table.rowCount-1):(r=t+1,o=Math.min(n.proxy.rowEnd,n.table.rowCount-n.table.bottomFrozenRowCount-1));for(let s=0;s<n.table.colCount;s++)for(let a=r;a<=o;a++){const l=n.highPerformanceGetCell(s,a);l.role==="cell"&&l.setAttribute("y",l.attribute.y+e)}}function _J(n,t,e,i,r,o,s){t&&MWt(n,t,e,i,r,o)}function MWt(n,t,e,i,r,o,s){var a,l,h,u,d;if(t.attribute.height===r&&!t.needUpdateHeight)return;t.needUpdateHeight=!1,t.setAttribute("height",r);const c=(a=n.table.getCellRawRecord(e,i))===null||a===void 0?void 0:a.vtableMerge,f=!!n.table.getCustomMerge(e,i),g=c||f?"text":n.table.isHeader(e,i)?(l=n.table._getHeaderLayoutMap(e,i).headerType)!==null&&l!==void 0?l:"text":(h=n.table.getBodyColumnType(e,i))!==null&&h!==void 0?h:"text";if(g==="progressbar"){const p=n.table.getBodyColumnDefine(e,i),v=n.table._getCellStyle(e,i),m=n.table.getCellValue(e,i),y=n.table.getCellOriginValue(e,i),b=ce(ut("padding",v,e,i,n.table));let _;p?.mergeCell&&(_=n.table.getCellRange(e,i));const w=Bt.getFunction("createProgressBarCell")(p,v,t.attribute.width,m,y,e,i,b,n.table,_),C=t.getChildByName("progress-bar");t.insertBefore(w,C),t.removeChild(C),C.removeAllChild(),C.release(),bV(t,r,o,n.table.isAutoRowHeight(i),!0,n.table)}else if(g==="sparkline"){t.removeAllChild();const p=n.table._getCellStyle(e,i),v=ce(ut("padding",p,e,i,n.table));Bt.getFunction("createSparkLineCellGroup")(t,t.parent,t.attribute.x,t.attribute.y,e,i,t.attribute.width,t.attribute.height,v,n.table,yu(p,n.table,e,i,ut).theme,!1)}else if(g==="image"||g==="video")qm(t,e,i,0,o,n.table);else if(((u=t.firstChild)===null||u===void 0?void 0:u.name)==="axis")(d=t.firstChild)===null||d===void 0||d.originAxis.resize(t.attribute.width,t.attribute.height);else{let p=!0;const v=t.getChildByName(ta)||t.getChildByName(ex);if(v){let m;t.removeChild(v);const y=ox(e,i,t,n.table);if(y)for(let b=y.start.row;b<=y.end.row;b++){if(b===i)continue;const _=n.getCell(e,b),w=_.getChildByName(ta)||_.getChildByName(ex);w.removeAllChild(),_.removeChild(w),ox(e,b,_,n.table)}else{let b,_;const w=n.table.getCellLocation(e,i),{vtableMerge:C}=n.table.getCellRawRecord(e,i)||{};if(C&&n.table.internalProps.groupTitleCustomLayout)_=n.table.internalProps.groupTitleCustomLayout;else if(w!=="body"){const x=n.table.getHeaderDefine(e,i);b=x?.headerCustomRender,_=x?.headerCustomLayout}else{const x=n.table.getBodyColumnDefine(e,i);b=x?.customRender||n.table.customRender,_=x?.customLayout}if((b||_)&&$h(t))for(let x=t.mergeStartCol;x<=t.mergeEndCol;x++)for(let S=t.mergeStartRow;S<=t.mergeEndRow;S++)S!==i&&n.updateCellContent(x,S);if(_||b){const x=n.table._getCellStyle(e,i),S=ce(ut("padding",x,e,i,n.table));let A=t.attribute.width,T=t.attribute.height;$h(t)&&(A=n.table.getColsWidth(t.mergeStartCol,t.mergeEndCol),T=n.table.getRowsHeight(t.mergeStartRow,t.mergeEndRow));const M=hu(_,b,e,i,A,T,!1,n.table.isAutoRowHeight(i),S,$h(t)?{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}}:void 0,n.table);m=M.elementsGroup,p=M.renderDefault}t.childrenCount>0&&m?t.insertBefore(m,t.firstChild):m&&t.appendChild(m)}}bV(t,r,o,n.table.isAutoRowHeight(i),p,n.table)}}function bV(n,t,e,i,r,o){if($h(n)){t=0;for(let u=n.mergeStartRow;u<=n.mergeEndRow;u++)t+=o.getRowHeight(u);const{colStart:s,colEnd:a,rowStart:l,rowEnd:h}=bu(n,o.scenegraph);for(let u=s;u<=a;u++)for(let d=l;d<=h;d++){const c=o.scenegraph.getCell(u,d);if(c.role!=="cell")continue;if(c.forEachChildren(v=>{v.setAttributes({dx:0,dy:0})}),r){const v=o._getCellStyle(s,l),m=ce(ut("padding",v,u,d,o));rx(c,t,e,i,m,v.textAlign,v.textBaseline,o)}const f=o.getRowHeight(d),g=o.getColWidth(u);c.contentHeight=t;const{widthChange:p}=Hy(c,g,f,{start:{col:n.mergeStartCol,row:n.mergeStartRow},end:{col:n.mergeEndCol,row:n.mergeEndRow}},o);p&&(c.needUpdateWidth=!0)}}else{const s=o._getCellStyle(n.col,n.row),a=ce(ut("padding",s,n.col,n.row,o));rx(n,t,e,i,a,s.textAlign,s.textBaseline,o)}}function RWt(n,t,e,i){i||n.table._setColWidth(t,n.table.getColWidth(t)+e,!0);const r=n.getColGroup(t,!0),o=n.getColGroupInRightTopCorner(t);r&&!o&&df(r,e,"col-corner",n),o&&df(o,e,"right-top",n);const s=n.getColGroup(t);s&&df(s,e,"row-body",n);const a=n.getColGroupInLeftBottomCorner(t);a&&df(a,e,"left-bottom",n);const l=n.getColGroupInBottom(t);l&&df(l,e,"bottom",n);const h=n.getColGroupInRightBottomCorner(t);h&&df(h,e,"right-bottom",n),t<n.frozenColCount?(n.cornerHeaderGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)}),n.rowHeaderGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)})):(n.colHeaderGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)}),n.bodyGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)})),a&&n.leftBottomCornerGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)}),l&&n.bottomFrozenGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)}),h&&n.rightBottomCornerGroup.forEachChildrenSkipChild((u,d)=>{u.col>t&&u.setAttribute("x",u.attribute.x+e)})}function df(n,t,e,i){var r,o,s,a,l,h,u;let d=!1;const c=(r=n?.attribute.width)!==null&&r!==void 0?r:0;if(n?.setAttribute("width",c+t),n?.forEachChildren((f,g)=>{if(BWt(i,f,f.col,f.row,c,c+t,t,e!=="row-body"||f.col<i.table.rowHeaderLevelCount,i.table.internalProps.autoWrapText)){const p=Ji(i.table,f.col,f.row);if(p&&p.end.row-p.start.row)for(let v=p.start.row;v<=p.end.row;v++)CV(i,v);else CV(i,f.row);d=!0}}),d){let f,g,p,v=0;for(let m=0;m<i.table.colCount;m++){if(e==="col-corner"?(p=0,f=i.getColGroup(m,!0),g=(o=i.colHeaderGroup.attribute.height)!==null&&o!==void 0?o:0):e==="row-body"?(p=i.table.frozenRowCount,f=i.getColGroup(m,!1),g=(s=i.bodyGroup.attribute.height)!==null&&s!==void 0?s:0):e==="bottom"?(p=i.table.rowCount-i.table.bottomFrozenRowCount,f=i.getColGroupInBottom(m),g=(a=i.bottomFrozenGroup.attribute.height)!==null&&a!==void 0?a:0):e==="left-bottom"?(p=i.table.rowCount-i.table.bottomFrozenRowCount,f=i.getColGroupInLeftBottomCorner(m),g=(l=i.leftBottomCornerGroup.attribute.height)!==null&&l!==void 0?l:0):e==="right-top"?(p=0,f=i.getColGroupInRightTopCorner(m),g=(h=i.rightTopCornerGroup.attribute.height)!==null&&h!==void 0?h:0):e==="right-bottom"&&(p=i.table.rowCount-i.table.bottomFrozenRowCount,f=i.getColGroupInRightBottomCorner(m),g=(u=i.rightBottomCornerGroup.attribute.height)!==null&&u!==void 0?u:0),!f)continue;let y=0;f.forEachChildren(b=>{var _;b.setAttribute("y",y),y+=(_=i.table.getRowHeight(b.row))!==null&&_!==void 0?_:0}),v=y}i.updateContainerHeight(p,v-g);for(let m=0;m<i.table.frozenColCount;m++){const y=i.getColGroupInLeftBottomCorner(m);let b=0;y?.forEachChildren(_=>{_.setAttribute("y",b),b+=i.table.getRowHeight(_.row)})}for(let m=i.table.colCount-i.table.rightFrozenColCount;m<i.table.colCount;m++){const y=i.getColGroupInRightBottomCorner(m);let b=0;y?.forEachChildren(_=>{_.setAttribute("y",b),b+=i.table.getRowHeight(_.row)})}for(let m=i.table.frozenColCount;m<i.table.colCount-i.table.rightFrozenColCount;m++){const y=i.getColGroupInBottom(m);let b=0;y?.forEachChildren(_=>{_.setAttribute("y",b),b+=i.table.getRowHeight(_.row)})}}}function BWt(n,t,e,i,r,o,s,a,l){var h,u,d,c,f,g,p;if(t.attribute.width===o&&!t.needUpdateWidth)return!1;t.needUpdateWidth=!1,t.setAttribute("width",o);const v=t;if(!v)return!1;const m=n.table.isAutoRowHeight(i),y=(h=n.table.getCellRawRecord(e,i))===null||h===void 0?void 0:h.vtableMerge,b=!!n.table.getCustomMerge(e,i),_=y||b?"text":n.table.isHeader(e,i)?(u=n.table._getHeaderLayoutMap(e,i).headerType)!==null&&u!==void 0?u:"text":(d=n.table.getBodyColumnType(e,i))!==null&&d!==void 0?d:"text";let w=!1;if(_==="progressbar"){const C=n.table.getBodyColumnDefine(e,i),x=n.table._getCellStyle(e,i),S=n.table.getCellValue(e,i),A=n.table.getCellOriginValue(e,i),T=ce(ut("padding",x,e,i,n.table));let M;C?.mergeCell&&(M=n.table.getCellRange(e,i));const R=Bt.getFunction("createProgressBarCell")(C,x,v.attribute.width,S,A,e,i,T,n.table,M),E=v.getChildByName("progress-bar");v.insertBefore(R,E),v.removeChild(E),E.removeAllChild(),E.release();const P=_V(v,o,s,m,!0,n.table);w=w||P}else if(_==="sparkline"){v.removeAllChild();const C=n.table._getCellStyle(e,i),x=ce(ut("padding",C,e,i,n.table));Bt.getFunction("createSparkLineCellGroup")(v,v.parent,v.attribute.x,v.attribute.y,e,i,v.attribute.width,v.attribute.height,x,n.table,yu(C,n.table,e,i,ut).theme,!1)}else if(_==="image"||_==="video")qm(v,e,i,s,0,n.table);else if(((c=v.firstChild)===null||c===void 0?void 0:c.name)==="axis"){const C=n.table.internalProps.layoutMap.getAxisConfigInPivotChart(e,i),x=n.table._getCellStyle(e,i),S=ce(ut("padding",x,e,i,n.table));if(C){const A=new(Bt.getComponent("axis"))(C,v.attribute.width,v.attribute.height,(f=C.__vtablePadding)!==null&&f!==void 0?f:S,n.table);v.clear(),v.appendChild(A.component),A.overlap()}}else if(((g=t.firstChild)===null||g===void 0?void 0:g.name)==="axis")(p=t.firstChild)===null||p===void 0||p.originAxis.resize(t.attribute.width,t.attribute.height);else{let C=!0;const x=t.getChildByName(ta)||t.getChildByName(ex);if(x){let A;t.removeChild(x);const T=ox(e,i,t,n.table);if(T)for(let M=T.start.col;M<=T.end.col;M++){if(M===e)continue;const R=n.getCell(M,i),E=R.getChildByName(ta)||R.getChildByName(ex);E.removeAllChild(),R.removeChild(E),ox(M,i,R,n.table)}else{let M,R;const E=n.table.getCellLocation(e,i),{vtableMerge:P}=n.table.getCellRawRecord(e,i)||{};if(P&&n.table.internalProps.groupTitleCustomLayout)R=n.table.internalProps.groupTitleCustomLayout;else if(E!=="body"){const B=n.table.getHeaderDefine(e,i);M=B?.headerCustomRender,R=B?.headerCustomLayout}else{const B=n.table.getBodyColumnDefine(e,i);M=B?.customRender||n.table.customRender,R=B?.customLayout}if((M||R)&&$h(v)){for(let B=v.mergeStartCol;B<=v.mergeEndCol;B++)if(B!==e)for(let k=v.mergeStartRow;k<=v.mergeEndRow;k++)n.updateCellContent(B,k)}if(R||M){const B=n.table._getCellStyle(e,i),k=ce(ut("padding",B,e,i,n.table));let L=v.attribute.width,O=v.attribute.height;$h(v)&&(L=n.table.getColsWidth(v.mergeStartCol,v.mergeEndCol),O=n.table.getRowsHeight(v.mergeStartRow,v.mergeEndRow));const D=hu(R,M,e,i,L,O,!1,n.table.isAutoRowHeight(i),k,$h(v)?{start:{col:v.mergeStartCol,row:v.mergeStartRow},end:{col:v.mergeEndCol,row:v.mergeEndRow}}:void 0,n.table);A=D.elementsGroup,C=D.renderDefault,w=!0}t.childrenCount>0&&A?t.insertBefore(A,t.firstChild):A&&t.appendChild(A)}}const S=_V(v,o,s,m,C,n.table);w=w||S}return l||(l=n.table._getCellStyle(e,i).autoWrapText),!(!m||!l)&&w}function _V(n,t,e,i,r,o){if($h(n)){t=0;let u=!1;for(let v=n.mergeStartCol;v<=n.mergeEndCol;v++)t+=o.getColWidth(v);let d=0;for(let v=n.mergeStartRow;v<=n.mergeEndRow;v++)d+=o.getRowHeight(v);const{colStart:c,colEnd:f,rowStart:g,rowEnd:p}=bu(n,o.scenegraph);for(let v=c;v<=f;v++)for(let m=g;m<=p;m++){if(v===n.col&&m!==n.row)continue;const y=o.scenegraph.getCell(v,m);if(y.role!=="cell")continue;y.forEachChildren(x=>{x.setAttributes({dx:0,dy:0})});let b=!1;if(r){const x=o._getCellStyle(c,g),S=ce(ut("padding",x,v,m,o)),A=x.textAlign,T=x.textBaseline;b=nx(y,t,d,e,i,S,A,T,o.scenegraph);const M=jr(y.col,y.row,o);if(M){const R=y.getChildByName("text"),E=y.getChildByName("expand")||y.getChildByName("collapse");E?.role!=="icon-left"&&R&&R.setAttribute("dx",M)}}const _=o.getRowHeight(m),w=o.getColWidth(v);y.contentWidth=t;const{heightChange:C}=Hy(y,w,_,{start:{col:n.mergeStartCol,row:n.mergeStartRow},end:{col:n.mergeEndCol,row:n.mergeEndRow}},o);C&&(y.needUpdateHeight=!0),u=u||b}return u}const s=o._getCellStyle(n.col,n.row),a=ce(ut("padding",s,n.col,n.row,o)),l=s.textAlign,h=s.textBaseline;return nx(n,t,o.getRowHeight(n.row),e,i,a,l,h,o.scenegraph)}function CV(n,t){const e=Math.round(qo(t,0,n.table.colCount-1,n.table));n.table._setRowHeight(t,e,!0);for(let i=0;i<n.table.colCount;i++){const r=e,o=n.highPerformanceGetCell(i,t);o.role!=="empty"&&_J(n,o,i,t,r,r-o.attribute.height,n.table.isHeader(i,t))}}var lo;(function(n){n.dropDown="dropDown",n.contextmenu="contextmenu",n.custom="custom"})(lo||(lo={}));const wi={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};let PWt=class{constructor(t){this._table=t,this._menuInstance=new re({x:0,y:0,fill:wi.bgColor,stroke:wi.borderColor,cornerRadius:wi.cornerRadius,lineWidth:wi.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:lo.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(t){t.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(t,e,i,r,o,s){if(o===lo.dropDown&&this.checkDropDownMenuChange(i,r)){const a=this.getMenuInfo(i,r,o);if(!a)return;const{menuInfo:l,highlightIndex:h}=a;this.updateMenuInfo(i,r,o,l,h),this.updateMenuInstance(l,h)}else if(o===lo.contextmenu&&this.checkContextMenuChange(t,e)){const a=this.getMenuInfo(i,r,o);if(!a)return;const{menuInfo:l,highlightIndex:h}=a;this.updateMenuInfo(i,r,o,l,h),this.updateMenuInstance(l,h)}this.updatePosition(t-this._table.scenegraph.x,e-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(t,e,i,r,o){this._menuInfo.col=t,this._menuInfo.row=e,this._menuInfo.type=i,this._menuInfo.menuInfo=r,this._menuInfo.highlightIndex=o}checkDropDownMenuChange(t,e){const{type:i,col:r,row:o}=this._menuInfo;return i!==lo.dropDown||t!==r||e!==o}checkContextMenuChange(t,e){var i;const{type:r,menuInfo:o}=this._menuInfo;return r!==lo.contextmenu||o!==((i=this._table.internalProps.menu)===null||i===void 0?void 0:i.contextMenuItems)}updateMenuInstance(t,e){this._menuInstance.removeAllChild();let i=wi.menuPadding;const r=wi.menuPadding;let o=0;t.forEach((s,a)=>{var l,h;const u=e===a;let d,c;typeof s=="string"?c=s:typeof s=="object"&&(c=s.text,d=u?s.selectedIcon:s.icon);const f=new re({y:i,x:r,height:wi.lineHeight,fill:wi.bgColor});f.role="menu-item",this._menuInstance.appendChild(f),f.stateProxy=p=>p==="hover"?{fill:wi.hoverBgColor}:{fill:wi.bgColor},f.addEventListener("pointerenter",p=>{f.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),f.addEventListener("pointerleave",p=>{f.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});const g=new si({x:wi.menuItemPadding,y:wi.menuItemPadding,fill:u?wi.highlightColor:wi.color,text:c,textBaseline:"top",fontSize:wi.fontSize,fontFamily:wi.fontFamily,pickable:!1,maxLineWidth:wi.maxLineWidth,ellipsis:""});if(f.addChild(g),d){g.AABBBounds.height();const p=(l=d.width)!==null&&l!==void 0?l:16,v=(h=d.height)!==null&&h!==void 0?h:16,m=new Cc({x:wi.menuItemPadding,y:(wi.lineHeight-v)/2,width:p,height:v,image:d.svg,pickable:!1});m.role="menu-icon",f.insertBefore(m,g),g.setAttribute("x",p+wi.menuItemPadding)}o=Math.max(f.AABBBounds.width(),o),i+=wi.lineHeight}),this._menuInstance.setAttributes({width:o+2*wi.menuItemPadding+2*wi.menuPadding,height:i+wi.menuPadding}),this._menuInstance.forEachChildren(s=>{s.setAttribute("width",o+2*wi.menuItemPadding)})}updatePosition(t,e){this._menuInstance.setAttributes({x:this._menuInfo.type===lo.dropDown?t-this._menuInstance.attribute.width:t,y:e}),this._menuInfo.x=lo.dropDown?t-this._menuInstance.attribute.width:t,this._menuInfo.y=e}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(t,e,i){var r;if(i===lo.dropDown){let o=this._table.globalDropDownMenu;o=this._table._getHeaderLayoutMap(t,e).dropDownMenu,typeof o=="function"&&(o=o({row:e,col:t,table:this._table}));let s=-1;if(Array.isArray(o)){for(let a=0;a<o.length;a++)if(this._table._dropDownMenuIsHighlight(t,e,a)){s=a;break}}return{menuInfo:o,highlightIndex:s}}if(i===lo.contextmenu){const o=(r=this._table.internalProps.menu)===null||r===void 0?void 0:r.contextMenuItems;let s;if(Array.isArray(o))s=o;else if(typeof o=="function"){const{field:a}=this._table.isHeader(t,e)?this._table.getHeaderDefine(t,e):this._table.getBodyColumnDefine(t,e);s=o(a,e,t)}return{menuInfo:s,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",t=>{const{target:e}=t;if(e&&e.role==="menu-item"){const i=this.getEventInfo(e),r=this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type),o=Object.assign(i,r);o.event=t.nativeEvent,this._table.fireListeners(ot.DROPDOWN_MENU_CLICK,o)}})}getEventInfo(t){const e=t.parent;let i=0;e.forEachChildren((s,a)=>s===t&&(i=a-1,!0));const r=typeof this._menuInfo.menuInfo[i]=="string"?this._menuInfo.menuInfo[i]:this._menuInfo.menuInfo[i].text,o=typeof this._menuInfo.menuInfo[i]=="string"?r:this._menuInfo.menuInfo[i].menuKey||r;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:i,highlight:i===this._menuInfo.highlightIndex,text:r,menuKey:o}}get bounds(){return this._menuInstance.globalAABBBounds}};const r2=ms();class kWt{constructor(){const t=r2.drillDown;this.icon=new Cc({x:-1e3,y:-1e3,image:t.svg,width:t.width,height:t.height,dx:-t.width/2,dy:-t.height/2,visible:!1,funcType:t.funcType,cursor:t.cursor}),this.icon.role="icon-drill"}appand(t){t.appendChild(this.icon)}update(t,e,i,r,o,s){if(!t||r&&o)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void s.updateNextFrame();const a=r2.drillDown,l=r2.drillUp;this.icon.setAttributes({x:e,y:i,image:r?a.svg:l.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),s.updateNextFrame()}}class EWt{constructor(t){const e=t.theme.dragHeaderSplitLine.lineWidth,i=t.theme.dragHeaderSplitLine.lineColor,r=t.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=Qg({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:i}),this.columnMoverLine=Ri({visible:!1,pickable:!1,stroke:i,lineWidth:e,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=Ne({visible:!1,pickable:!1,fill:r,x:0,y:0,width:0,height:0}),this.table=t}appand(t){t.appendChild(this.columnMoverLabel),t.appendChild(this.columnMoverLine),t.appendChild(this.columnMoverBack)}show(t,e,i){const r=this.table.getCellLocation(t,e),o=Ji(this.table,t,e);o&&(t=o.start.col,e=o.start.row);let s=0,a=0,l=0,h=0,u=0,d=0,c=0,f=0,g=Math.PI;const p=[];return r==="columnHeader"?(s=this.table.getColsWidth(0,t-1)-this.table.stateManager.scroll.horizontalBarPos,a=this.table.getRowsHeight(0,this.table.frozenRowCount-1),h=this.table.tableNoFrameHeight,l=o?this.table.getColsWidth(o.start.col,o.end.col):this.table.getColWidth(t),u=s-i,c=s+l,f=2,p.push({x:0,y:0}),p.push({x:0,y:this.table.tableNoFrameHeight})):(r==="rowHeader"||this.table.internalProps.layoutMap.isSeriesNumberInBody(t,e))&&(a=this.table.getRowsHeight(0,e-1)-this.table.stateManager.scroll.verticalBarPos,s=this.table.getColsWidth(0,this.table.frozenColCount-1),l=this.table.tableNoFrameWidth,h=o?this.table.getRowsHeight(o.start.row,o.end.row):this.table.getRowHeight(e),d=a-i,c=2,f=a+h,g=Math.PI/2,p.push({x:0,y:0}),p.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:s-u,y:a-d,width:l,height:h,dx:u,dy:d}),this.columnMoverLine.setAttributes({x:c,y:f,visible:!0,points:p}),this.columnMoverLabel.setAttributes({visible:!0,x:c,y:f,angle:g}),{backX:s-u,lineX:c,backY:a-d,lineY:f}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(t,e,i,r){typeof t=="number"&&typeof e=="number"?(this.columnMoverLabel.setAttribute("x",e),this.columnMoverLine.setAttribute("x",e),this.columnMoverBack.setAttribute("x",t)):typeof i=="number"&&typeof r=="number"&&(this.columnMoverLabel.setAttribute("y",r),this.columnMoverLine.setAttribute("y",r),this.columnMoverBack.setAttribute("y",i))}updateStyle(){const t=this.table.theme.dragHeaderSplitLine.lineWidth,e=this.table.theme.dragHeaderSplitLine.lineColor,i=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:e}),this.columnMoverLine.setAttributes({stroke:e,lineWidth:t}),this.columnMoverBack.setAttributes({fill:i})}}function L_(n,t,e){if(e)return Math.min(t.tableNoFrameWidth,t.getAllColsWidth())-t.getColsWidth(n,t.colCount-1);let i=t.getColsWidth(0,n);return n>=t.frozenColCount&&(i-=t.scrollLeft),i}function wV(n,t,e){if(e)return Math.min(t.tableNoFrameWidth,t.getAllRowsHeight())-t.getRowsHeight(n,t.rowCount-1);let i=t.getRowsHeight(0,n);return n>=t.frozenRowCount&&(i-=t.scrollTop),i}class LWt{constructor(t){var e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_;this.table=t;const w=this.table.theme;this.createScrollBar();const C=(e=w.columnResize)===null||e===void 0?void 0:e.lineColor,x=(i=w.columnResize)===null||i===void 0?void 0:i.lineWidth,S=(r=w.columnResize)===null||r===void 0?void 0:r.bgColor,A=(o=w.columnResize)===null||o===void 0?void 0:o.width,T=(a=(s=w.columnResize)===null||s===void 0?void 0:s.labelVisible)===null||a===void 0||a,M=(l=w.columnResize)===null||l===void 0?void 0:l.labelColor,R=(h=w.columnResize)===null||h===void 0?void 0:h.labelFontSize,E=(u=w.columnResize)===null||u===void 0?void 0:u.labelFontFamily,P=(d=w.columnResize)===null||d===void 0?void 0:d.labelBackgroundFill,B=(c=w.columnResize)===null||c===void 0?void 0:c.labelBackgroundCornerRadius;this.labelVisible=T,this.columnResizeLine=Ri({visible:!1,pickable:!1,stroke:C,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=Ri({visible:!1,pickable:!1,stroke:S,lineWidth:A,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});const k=Om({visible:!1,pickable:!1,x:0,y:0,fontSize:R,fill:M,fontFamily:E,text:"",textBaseline:"top",dx:16,dy:-R/2}),L=Ne({visible:!1,pickable:!1,fill:P,x:0,y:0,width:5*R*.8,height:R+8,cornerRadius:B,dx:12,dy:-R/2-4});this.columnResizeLabel=Xw({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(L),this.columnResizeLabel.appendChild(k),this.rowResizeLine=Ri({visible:!1,pickable:!1,stroke:C,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=Ri({visible:!1,pickable:!1,stroke:S,lineWidth:A,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});const O=Om({visible:!1,pickable:!1,x:0,y:0,fontSize:R,fill:M,fontFamily:E,text:"",textBaseline:"top",dx:16,dy:-R/2}),D=Ne({visible:!1,pickable:!1,fill:P,x:0,y:0,width:5*R*.8,height:R+8,cornerRadius:B,dx:12,dy:-R/2-4});this.rowResizeLabel=Xw({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(D),this.rowResizeLabel.appendChild(O),this.cellMover=new EWt(this.table);const I=(g=(f=w.frozenColumnLine)===null||f===void 0?void 0:f.shadow)===null||g===void 0?void 0:g.width,H=(v=(p=w.frozenColumnLine)===null||p===void 0?void 0:p.shadow)===null||v===void 0?void 0:v.startColor,F=(y=(m=w.frozenColumnLine)===null||m===void 0?void 0:m.shadow)===null||y===void 0?void 0:y.endColor,G=(_=(b=w.frozenColumnLine)===null||b===void 0?void 0:b.shadow)===null||_===void 0?void 0:_.visible;this.frozenShadowLine=Ne({visible:G==="always",pickable:!1,x:0,y:0,width:I,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:H,offset:0},{color:F,offset:1}]}}),this.rightFrozenShadowLine=Ne({visible:G==="always",pickable:!1,x:0,y:0,width:I,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:F,offset:0},{color:H,offset:1}]}}),this.menu=new PWt(this.table),this.drillIcon=new kWt}addToGroup(t){t.addChild(this.frozenShadowLine),t.addChild(this.rightFrozenShadowLine),t.addChild(this.columnResizeBgLine),t.addChild(this.columnResizeLine),t.addChild(this.columnResizeLabel),t.addChild(this.rowResizeBgLine),t.addChild(this.rowResizeLine),t.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(t.addChild(this.hScrollBar),t.addChild(this.vScrollBar)):(t.stage.defaultLayer.addChild(this.hScrollBar),t.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(t),this.drillIcon.appand(t),this.cellMover.appand(t)}createScrollBar(){var t,e,i,r,o,s;const a=this.table.theme,l=(t=a.scrollStyle)===null||t===void 0?void 0:t.scrollRailColor,h=(e=a.scrollStyle)===null||e===void 0?void 0:e.scrollSliderColor,u=(i=a.scrollStyle)===null||i===void 0?void 0:i.scrollSliderCornerRadius,d=(r=a.scrollStyle)===null||r===void 0?void 0:r.width,c=(o=a.scrollStyle)===null||o===void 0?void 0:o.horizontalPadding,f=(s=a.scrollStyle)===null||s===void 0?void 0:s.verticalPadding;let g;g=Y(u)?{cornerRadius:u,fill:h}:{fill:h},this.hScrollBar=new Yl({direction:"horizontal",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:this.table.tableNoFrameWidth,height:d,padding:c,railStyle:{fill:l},sliderStyle:g,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new Yl({direction:"vertical",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:d,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:f,railStyle:{fill:l},sliderStyle:g,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var t,e,i,r,o,s,a,l,h;const u=this.table.stateManager.scroll.horizontalBarPos,d=this.table.stateManager.scroll.verticalBarPos,c=this.table.theme,f=(t=c.scrollStyle)===null||t===void 0?void 0:t.width,g=(e=c.scrollStyle)===null||e===void 0?void 0:e.visible,p=(r=(i=c.scrollStyle)===null||i===void 0?void 0:i.horizontalVisible)!==null&&r!==void 0?r:g,v=(s=(o=c.scrollStyle)===null||o===void 0?void 0:o.verticalVisible)!==null&&s!==void 0?s:g,m=Math.ceil(this.table.tableNoFrameWidth),y=Math.ceil(this.table.tableNoFrameHeight),b=this.table.getAllRowsHeight(),_=this.table.getAllColsWidth(),w=this.table.getFrozenRowsHeight(),C=this.table.getFrozenColsWidth(),x=this.table.getBottomFrozenRowsHeight(),S=this.table.getRightFrozenColsWidth(),A=this.table.theme.scrollStyle.hoverOn,T=!((a=this.table.options.customConfig)===null||a===void 0)&&a._disableColumnAndRowSizeRound?1:0;if(_>m+T){const M=Math.min(y,b),R=Math.max(.05,(m-C)/(_-C));let E=0;E=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(A?f:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:M-(A?f:-this.table.scenegraph.tableGroup.attribute.y);let P=C+(A?0:this.table.scenegraph.tableGroup.attribute.x),B=m-C-S;(h=(l=this.table.theme.scrollStyle)===null||l===void 0?void 0:l.ignoreFrozenCols)!==null&&h!==void 0&&h?(P=A?0:this.table.scenegraph.tableGroup.attribute.x,B=m):(P=C+(A?0:this.table.scenegraph.tableGroup.attribute.x),B=m-C-S),this.hScrollBar.setAttributes({x:P,y:E,width:B,range:[0,R],visible:p==="always"});const k=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:k.x1,y:k.y1},p==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:0,visible:!1});if(b>y+T){const M=Math.min(m,_),R=Math.max(.05,(y-w)/(b-w));let E=0;E=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(A?f:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:M-(A?f:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:E,y:w+(A?0:this.table.scenegraph.tableGroup.attribute.y),height:y-w-x,range:[0,R],visible:v==="always"});const P=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:P.x1,y:P.y1},v==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,height:0,visible:!1});this.table.stateManager.setScrollLeft(u),this.table.stateManager.setScrollTop(d)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(t,e,i){const r=L_(t,this.table,i);this.columnResizeLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(t)}px`))}updateResizeCol(t,e,i){const r=L_(t,this.table,i);this.columnResizeLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:r,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(t))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(t,e,i){const r=wV(t,this.table,i);this.rowResizeLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(t)}px`))}updateResizeRow(t,e,i){const r=wV(t,this.table,i);this.rowResizeLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:r,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(t))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(t,e,i){return this.cellMover.show(t,e,i)}updateMoveCol(t,e,i,r){this.cellMover.update(t,e,i,r)}setFrozenColumnShadow(t,e){var i,r;const o=L_(t,this.table,e);t<0||((r=(i=this.table.theme.frozenColumnLine)===null||i===void 0?void 0:i.shadow)===null||r===void 0?void 0:r.visible)!=="always"?this.frozenShadowLine.setAttributes({visible:!1,x:o,height:this.table.getDrawRange().height}):this.frozenShadowLine.setAttributes({visible:!0,x:o,height:this.table.getDrawRange().height})}setRightFrozenColumnShadow(t){var e,i;const r=L_(t,this.table,!0);t>=this.table.colCount||((i=(e=this.table.theme.frozenColumnLine)===null||e===void 0?void 0:e.shadow)===null||i===void 0?void 0:i.visible)!=="always"?this.rightFrozenShadowLine.setAttributes({visible:!1,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}):this.rightFrozenShadowLine.setAttributes({visible:!0,x:r-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}hideFrozenColumnShadow(){var t,e,i,r,o;const s=(e=(t=this.table.theme.frozenColumnLine)===null||t===void 0?void 0:t.shadow)===null||e===void 0?void 0:e.visible;((o=(r=(i=this.table.theme.frozenColumnLine)===null||i===void 0?void 0:i.shadow)===null||r===void 0?void 0:r.visible)!==null&&o!==void 0?o:s)==="scrolling"&&(this.frozenShadowLine.setAttribute("visible",!1),this.rightFrozenShadowLine.setAttribute("visible",!1),this.table.scenegraph.updateNextFrame())}showFrozenColumnShadow(){var t,e,i,r,o;const s=(e=(t=this.table.theme.frozenColumnLine)===null||t===void 0?void 0:t.shadow)===null||e===void 0?void 0:e.visible;((o=(r=(i=this.table.theme.frozenColumnLine)===null||i===void 0?void 0:i.shadow)===null||r===void 0?void 0:r.visible)!==null&&o!==void 0?o:s)==="scrolling"&&(this.frozenShadowLine.setAttribute("visible",!0),this.rightFrozenShadowLine.setAttribute("visible",!0),this.table.scenegraph.updateNextFrame())}hideVerticalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.verticalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.verticalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.horizontalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,i=(t=this.table.theme.scrollStyle.horizontalVisible)!==null&&t!==void 0?t:e;i!=="focus"&&i!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(t){const e=this.vScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.vScrollBar.setAttribute("range",[r,r+i]);const o=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:o.x1,y:o.y1}}updateHorizontalScrollBarPos(t){const e=this.hScrollBar.attribute.range,i=e[1]-e[0],r=t*(1-i);this.hScrollBar.setAttribute("range",[r,r+i]);const o=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:o.x1,y:o.y1}}updateStyle(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x;const S=this.table.theme,A=(t=S.scrollStyle)===null||t===void 0?void 0:t.scrollRailColor,T=(e=S.scrollStyle)===null||e===void 0?void 0:e.scrollSliderColor,M=(i=S.scrollStyle)===null||i===void 0?void 0:i.scrollSliderCornerRadius,R=(r=S.scrollStyle)===null||r===void 0?void 0:r.width,E=(o=S.scrollStyle)===null||o===void 0?void 0:o.horizontalPadding,P=(s=S.scrollStyle)===null||s===void 0?void 0:s.verticalPadding;let B;B=Y(M)?{cornerRadius:M,fill:T}:{fill:T},this.hScrollBar.setAttributes({height:R,padding:E,railStyle:{fill:A},sliderStyle:B}),this.vScrollBar.setAttributes({width:R,padding:P,railStyle:{fill:A},sliderStyle:B});const k=(a=S.columnResize)===null||a===void 0?void 0:a.lineColor,L=(l=S.columnResize)===null||l===void 0?void 0:l.lineWidth,O=(h=S.columnResize)===null||h===void 0?void 0:h.bgColor,D=(u=S.columnResize)===null||u===void 0?void 0:u.width;this.columnResizeLine.setAttributes({stroke:k,lineWidth:L}),this.columnResizeBgLine=Ri({stroke:O,lineWidth:D});const I=(d=S.columnResize)===null||d===void 0?void 0:d.labelColor,H=(c=S.columnResize)===null||c===void 0?void 0:c.labelFontSize,F=(f=S.columnResize)===null||f===void 0?void 0:f.labelFontFamily,G=(g=S.columnResize)===null||g===void 0?void 0:g.labelBackgroundFill,j=(p=S.columnResize)===null||p===void 0?void 0:p.labelBackgroundCornerRadius,W=(m=(v=S.columnResize)===null||v===void 0?void 0:v.labelVisible)===null||m===void 0||m;this.labelVisible=W,this.columnResizeLabel.lastChild.setAttributes({fontSize:H,fill:I,fontFamily:F,dy:-H/2}),this.columnResizeLabel.firstChild.setAttributes({fill:G,width:5*H*.8,height:H+8,cornerRadius:j,dy:-H/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:H,fill:I,fontFamily:F,dy:-H/2}),this.rowResizeLabel.firstChild.setAttributes({fill:G,width:5*H*.8,height:H+8,cornerRadius:j,dy:-H/2-4});const K=(b=(y=S.frozenColumnLine)===null||y===void 0?void 0:y.shadow)===null||b===void 0?void 0:b.width,J=(w=(_=S.frozenColumnLine)===null||_===void 0?void 0:_.shadow)===null||w===void 0?void 0:w.startColor,q=(x=(C=S.frozenColumnLine)===null||C===void 0?void 0:C.shadow)===null||x===void 0?void 0:x.endColor;this.frozenShadowLine.setAttributes({width:K,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:J,offset:0},{color:q,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:K,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:q,offset:0},{color:J,offset:1}]}}),this.cellMover.updateStyle()}}function Ss(n,t,e,i,r){var o,s,a,l,h,u;if(!t)return;const d=e==="table",{shadowBlur:c,shadowOffsetX:f,shadowOffsetY:g,shadowColor:p,cornerRadius:v,borderColor:m,borderLineWidth:y,borderLineDash:b}=t;let _=!1;const w={},C={pickable:!1};c&&d&&(C.shadowBlur=c,C.shadowOffsetX=f,C.shadowOffsetY=g,C.shadowColor=p,C.stroke=!0,C.stroke=p,C.lineWidth=1,_=!0),y&&(C.stroke=!0,C.fill=!1,C.stroke=OD(m??"#E1E4E8",i,y),C.lineWidth=y,b&&(C.lineDash=b),C.lineCap="butt"),Array.isArray(m)&&(C.strokeArrayColor=ce(m)),Array.isArray(y)&&(C.strokeArrayWidth=ce(y),C.lineWidth=1),v&&(C.cornerRadius=v,w.cornerRadius=v);const x=C.strokeArrayWidth?C.strokeArrayWidth[0]:(o=C.lineWidth)!==null&&o!==void 0?o:0,S=C.strokeArrayWidth?C.strokeArrayWidth[1]:(s=C.lineWidth)!==null&&s!==void 0?s:0,A=C.strokeArrayWidth?C.strokeArrayWidth[2]:(a=C.lineWidth)!==null&&a!==void 0?a:0,T=C.strokeArrayWidth?C.strokeArrayWidth[3]:(l=C.lineWidth)!==null&&l!==void 0?l:0;if(n.setAttributes(w),!r)if(C.stroke)if(C.x=T/2,C.y=x/2,C.pickable=!1,d){if(v)if(Array.isArray(v)){const E=ce(v);C.cornerRadius=E,w.cornerRadius=E,E[0]&&(E[0]=E[0]+Math.min(T,x)/2),E[1]&&(E[1]=E[1]+Math.min(x,S)/2),E[2]&&(E[2]=E[2]+Math.min(S,A)/2),E[3]&&(E[3]=E[3]+Math.min(A,T)/2)}else if(Mt(y)){const E=[];C.cornerRadius=E,w.cornerRadius=E,E[0]=v+Math.min(T,x)/2,E[1]=v+Math.min(x,S)/2,E[2]=v+Math.min(S,A)/2,E[3]=v+Math.min(A,T)/2}else C.cornerRadius=v+((h=C.lineWidth)!==null&&h!==void 0?h:0)/2,w.cornerRadius=v+((u=C.lineWidth)!==null&&u!==void 0?u:0)/2;let M,R;if(t.innerBorder?(C.x=n.attribute.x+T/2,C.y=n.attribute.y+x/2,C.width=n.attribute.width-T/2-S/2,C.height=n.attribute.height-x/2-A/2):(C.x=n.attribute.x-T/2,C.y=n.attribute.y-x/2,C.width=n.attribute.width+T/2+S/2,C.height=n.attribute.height+x/2+A/2),_){C.fill="white",C.notAdjustPos=!0,R=Xw(C),R.name="table-border-rect",M=Ne({x:T/2,y:x/2,width:n.attribute.width,height:n.attribute.height,fill:"red",cornerRadius:n.attribute.cornerRadius,globalCompositeOperation:"destination-out"}),R.addChild(M);const E=Ne({x:T/2,y:x/2,width:n.attribute.width,height:n.attribute.height,fill:"transparent",pickable:!1,globalCompositeOperation:"source-over"});R.addChild(E)}else R=Ne(C),R.name="table-border-rect";t.innerBorder&&!_?n.parent.insertAfter(R,n):n.parent.insertBefore(R,n),n.border=R}else{C.width=n.attribute.width-T/2-S/2,C.height=n.attribute.height-x/2-A/2;const M=Ne(C);M.name="border-rect",n.addChild(M),n.border=M}else{const M=Ne({fill:!1,stroke:!1,pickable:!1,lineWidth:0});M.name="border-rect",n.addChild(M),n.border=M}}function xV(n,t,e){var i;if(!t)return;const{borderColor:r}=t;(i=n.border)===null||i===void 0||i.setAttribute("stroke",OD(r,e))}function OD(n,t,e){let i=!0;return!t&&!Mt(e)||Mt(n)?t?i=t:t||Mt(n)?Mt(n)&&(i=!0):i=n:i=(t??e).map(r=>!!r&&n),i}function ll(n){var t,e,i,r;if(!n.border)return;const o=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[0]:(t=n.border.attribute.lineWidth)!==null&&t!==void 0?t:0,s=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[1]:(e=n.border.attribute.lineWidth)!==null&&e!==void 0?e:0,a=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[2]:(i=n.border.attribute.lineWidth)!==null&&i!==void 0?i:0,l=n.border.attribute.strokeArrayWidth?n.border.attribute.strokeArrayWidth[3]:(r=n.border.attribute.lineWidth)!==null&&r!==void 0?r:0;n.border.setAttributes({borderLeft:l,borderTop:o,borderRight:s,borderBottom:a,width:n.attribute.width-l/2-s/2,height:n.attribute.height-o/2-a/2}),n.border.type==="group"&&n.border.firstChild.setAttributes({width:n.attribute.width,height:n.attribute.height})}function OWt(n){if(!n.theme.frameStyle.cornerRadius)return;const t=n.theme.frameStyle.cornerRadius,{cornerHeaderGroup:e,colHeaderGroup:i,rowHeaderGroup:r,bodyGroup:o,rightTopCornerGroup:s,leftBottomCornerGroup:a,rightBottomCornerGroup:l,rightFrozenGroup:h,bottomFrozenGroup:u}=n.scenegraph;e.setAttribute("cornerRadius",0),i.setAttribute("cornerRadius",0),r.setAttribute("cornerRadius",0),o.setAttribute("cornerRadius",0),s.setAttribute("cornerRadius",0),a.setAttribute("cornerRadius",0),l.setAttribute("cornerRadius",0),h.setAttribute("cornerRadius",0),u.setAttribute("cornerRadius",0);const d=Ls(t);e.attribute.width>0&&e.attribute.height>0?ar(e,[d[0],0,0,0]):i.attribute.height>0?ar(i,[d[0],0,0,0]):r.attribute.width>0?ar(r,[d[0],0,0,0]):ar(o,[d[0],0,0,0]),a.attribute.width>0&&a.attribute.height>0?ar(a,[0,0,0,d[3]]):u.attribute.height>0?ar(u,[0,0,0,d[3]]):r.attribute.width>0?ar(r,[0,0,0,d[3]]):ar(o,[0,0,0,d[3]]),s.attribute.width>0&&s.attribute.height>0?ar(s,[0,d[1],0,0]):i.attribute.height>0?ar(i,[0,d[1],0,0]):h.attribute.width>0?ar(h,[0,d[1],0,0]):ar(o,[0,d[1],0,0]),l.attribute.width>0&&l.attribute.height>0?ar(l,[0,0,d[2],0]):h.attribute.width>0?ar(h,[0,0,d[2],0]):u.attribute.height>0?ar(u,[0,0,d[2],0]):ar(o,[0,0,d[2],0])}function ar(n,t){n.setAttribute("cornerRadius",t),n.border&&n.border.setAttribute("cornerRadius",t)}function CJ(n,t){var e,i,r,o,s,a,l,h,u,d,c;let f,g;if(n.role==="cell"&&Y(n.mergeStartCol)&&Y(n.mergeStartRow)&&Y(n.mergeEndCol)&&Y(n.mergeEndRow)){const{colStart:v,colEnd:m,rowStart:y,rowEnd:b}=bu(n,t.scenegraph);for(let _=v;_<=m;_++)for(let w=y;w<=b;w++){const C=SV(t.stateManager,_,w,n);!C||f&&C!=="cellBgColor"||(f=C)}}else n.role==="cell"&&(f=SV(t.stateManager,n.col,n.row,n));if(!f)return;const p=t.internalProps.layoutMap;return p.isCornerHeader(n.col,n.row)?g=((e=t.theme.cornerHeaderStyle)===null||e===void 0?void 0:e.hover)||((i=t.theme.headerStyle)===null||i===void 0?void 0:i.hover):p.isColumnHeader(n.col,n.row)?g=(r=t.theme.headerStyle)===null||r===void 0?void 0:r.hover:p.isRowHeader(n.col,n.row)?g=(o=t.theme.rowHeaderStyle)===null||o===void 0?void 0:o.hover:p.isBottomFrozenRow(n.col,n.row)?g=((s=t.theme.bottomFrozenStyle)===null||s===void 0?void 0:s.hover)||(t.isListTable()?(a=t.theme.bodyStyle)===null||a===void 0?void 0:a.hover:(l=t.theme.headerStyle)===null||l===void 0?void 0:l.hover):p.isRightFrozenColumn(n.col,n.row)?g=((h=t.theme.rightFrozenStyle)===null||h===void 0?void 0:h.hover)||(t.isListTable()?(u=t.theme.bodyStyle)===null||u===void 0?void 0:u.hover:(d=t.theme.rowHeaderStyle)===null||d===void 0?void 0:d.hover):t.isHeader(n.col,n.row)||(g=(c=t.theme.bodyStyle)===null||c===void 0?void 0:c.hover),ut(f,g,n.col,n.row,t)}function SV(n,t,e,i){var r;const{highlightScope:o,disableHeader:s,cellPos:a}=n.hover,l=n.table,h=l.isHeader(t,e);if(h&&s)return;let u;if(o===Ae.single&&a.col===t&&a.row===e?u="cellBgColor":o===Ae.column&&a.col===t?u=a.col===t&&a.row===e?"cellBgColor":"inlineColumnBgColor":o===Ae.row&&a.row===e?u=a.col===t&&a.row===e?"cellBgColor":"inlineRowBgColor":o===Ae.cross&&(a.col===t&&a.row===e?u="cellBgColor":a.col===t?u="inlineColumnBgColor":a.row===e&&(u="inlineRowBgColor")),u){let d;if(h){const c=l.getHeaderDefine(t,e);d=c?.disableHeaderHover,i.firstChild&&i.firstChild.name==="axis"&&(!((r=l.options.hover)===null||r===void 0)&&r.disableAxisHover)&&(d=!0)}else{const c=l.getBodyColumnDefine(t,e);d=c?.disableHover}d&&(u=void 0)}return u}const DD=Wn();class sg extends Py{constructor(t,e){if(super(e),this.type="chart",this.numberType=DD,this.isShareChartSpec=t,e.chartInstance)this.chartInstance=e.chartInstance;else{const i=this.chartInstance=new e.ClassType(e.spec,Ue({},this.attribute.tableChartOption,{renderCanvas:e.canvas,mode:this.attribute.mode==="node"?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:e.dpr,interactive:!1,animation:!1,autoFit:!1}));i.renderSync(),i.getStage().enableDirtyBounds(),e.chartInstance=this.chartInstance=i}}activate(t){var e,i,r,o,s;this.active=!0;const{col:a,row:l}=this.parent,h=CJ(this.parent,t),{x1:u,y1:d,x2:c,y2:f}=this.getViewBox(),g=DWt(a,l,t).intersect({x1:u-t.scrollLeft,x2:c-t.scrollLeft,y1:d-t.scrollTop,y2:f-t.scrollTop});(e=this.activeChartInstance)===null||e===void 0||e.release(),this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,Ue({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:c-u,y1:0,y2:f-d},dpr:t.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:y=>{const b=this.stage,_=y.window.getContext(),w=b.window.getViewBoxTransform(),C=b.window.getViewBox();_.inuse=!0,_.clearMatrix(),_.setTransform(w.a,w.b,w.c,w.d,w.e,w.f,!0),_.translate(C.x1,C.y1),_.setTransformForCurrent(!0),_.beginPath(),_.rect(g.x1,g.y1,g.x2-g.x1,g.y2-g.y1),_.clip(),_.clearMatrix(),t.options.canvas&&!y.needRender&&(y.pauseRender(),t.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),t.scenegraph.updateNextFrame())},afterRender(y){y.window.getContext().inuse=!1,y.needRender=!1,p.resumeRender()},renderHooks:{afterClearRect(y){const{context:b,layer:_,viewBox:w}=y;_.main&&y.clear&&h&&(b.beginPath(),b.fillStyle=h,b.rect(w.x1,w.y1,w.x2-w.x1,w.y2-w.y1),b.fill())}}}));const p=this.activeChartInstance.getStage(),v=this.globalTransMatrix.clone(),m=this.stage.window.getViewBoxTransform();v.multiply(m.a,m.b,m.c,m.d,m.e,m.f),p.window.setViewBoxTransform&&p.window.setViewBoxTransform(v.a,v.b,v.c,v.d,v.e,v.f),this.activeChartInstance.renderSync(),(r=(i=t.internalProps.layoutMap)===null||i===void 0?void 0:i.updateDataStateToActiveChartInstance)===null||r===void 0||r.call(i,this.activeChartInstance),this.activeChartInstance.on("click",y=>{var b;((b=this.attribute.spec.select)===null||b===void 0?void 0:b.enable)===!1?t.scenegraph.updateChartState(null):sg.temp&&t.scenegraph.updateChartState(y?.datum)}),this.activeChartInstance.on("brushEnd",y=>{var b;t.scenegraph.updateChartState((b=y?.value)===null||b===void 0?void 0:b.inBrushData),sg.temp=0,setTimeout(()=>{sg.temp=1},0)}),(s=(o=t)._bindChartEvent)===null||s===void 0||s.call(o,this.activeChartInstance)}deactivate(){var t,e;this.active=!1,(t=this.activeChartInstance)===null||t===void 0||t.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),(e=this.activeChartInstance)===null||e===void 0||e.release(),this.activeChartInstance=null}updateData(t){this.attribute.data=t}getViewBox(){var t,e,i,r,o,s,a,l;const h=this.parent,u=this.attribute.cellPadding,d=this.stage.table,{x1:c,y1:f,x2:g,y2:p}=h.globalAABBBounds;return{x1:Math.ceil(c+u[3]+d.scrollLeft+((e=(t=d.options.viewBox)===null||t===void 0?void 0:t.x1)!==null&&e!==void 0?e:0)),x2:Math.ceil(c+h.attribute.width-u[1]+d.scrollLeft+((r=(i=d.options.viewBox)===null||i===void 0?void 0:i.x1)!==null&&r!==void 0?r:0)),y1:Math.ceil(f+u[0]+d.scrollTop+((s=(o=d.options.viewBox)===null||o===void 0?void 0:o.y1)!==null&&s!==void 0?s:0)),y2:Math.ceil(f+h.attribute.height-u[2]+d.scrollTop+((l=(a=d.options.viewBox)===null||a===void 0?void 0:a.y1)!==null&&l!==void 0?l:0))}}}function DWt(n,t,e){var i,r,o,s,a,l,h,u;const{layoutMap:d}=e.internalProps,c=new lu,f=e.scenegraph.tableGroup.globalAABBBounds;return c.x1=f.x1,c.x2=f.x2,c.y1=f.y1,c.y2=f.y2,d.isLeftBottomCorner(n,t)||d.isRightTopCorner(n,t)||d.isLeftTopCorner(n,t)||d.isRightBottomCorner(n,t)||(d.isFrozenColumn(n,t)?(c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight()):d.isFrozenRow(n,t)?(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth()):d.isRightFrozenColumn(n,t)?(c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight()):d.isBottomFrozenRow(n,t)?(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth()):d.isFrozenColumn(n,t)||d.isRightFrozenColumn(n,t)||(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth(),c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight())),c.x1=c.x1+((r=(i=e.options.viewBox)===null||i===void 0?void 0:i.x1)!==null&&r!==void 0?r:0),c.x2=c.x2+((s=(o=e.options.viewBox)===null||o===void 0?void 0:o.x1)!==null&&s!==void 0?s:0),c.y1=c.y1+((l=(a=e.options.viewBox)===null||a===void 0?void 0:a.y1)!==null&&l!==void 0?l:0),c.y2=c.y2+((u=(h=e.options.viewBox)===null||h===void 0?void 0:h.y1)!==null&&u!==void 0?u:0),c}sg.temp=1;let sx=[],ax=[],wJ,sE=5,lx=!1;function AV(n){Y(n)&&(sE=n)}function aE(){sx=[],ax=[],lx=!1,cancelAnimationFrame(wJ)}function IWt(){return lx}function xJ(n){var t,e,i,r,o,s,a;const{axes:l,dataId:h,data:u,spec:d,ClassType:c,canvas:f,mode:g,modeParams:p,dpr:v}=n.attribute;let{chartInstance:m}=n;m||(m=new c(d,{renderCanvas:f,mode:g==="node"?"node":"desktop-browser",modeParams:p,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:v,interactive:!1,animation:!1,autoFit:!1}),m.renderSync(),n.chartInstance=m);const y=n.getViewBox();y.x2<=y.x1&&(y.x2=y.x1+1),y.y2<=y.y1&&(y.y2=y.y1+1),m.updateViewBox({x1:0,x2:y.x2-y.x1,y1:0,y2:y.y2-y.y1},!1,!1);const b=m.getStage(),_=n.globalTransMatrix,w=n.stage.window.getViewBoxTransform().clone();w.multiply(_.a,_.b,_.c,_.d,_.e,_.f),b.window.setViewBoxTransform&&b.window.setViewBoxTransform(w.a,w.b,w.c,w.d,w.e,w.f);const{table:C}=n.getRootNode();let x=!1;if(C.options.specFormat){const S=C.options.specFormat(n.attribute.spec,m,n);if(S.needFormatSpec&&S.spec){const A=S.spec;m.updateSpecSync(A,!1,{reuse:!1,morph:!1}),x=(t=S.updateSpec)===null||t===void 0||t}}if(!x)if(l?.forEach((S,A)=>{var T,M,R,E,P;S.type==="band"?m.updateModelSpec({type:"axes",index:A},{domain:S.domain.slice(0)},!0):m.updateModelSpecSync({type:"axes",index:A},{min:(M=(T=S.range)===null||T===void 0?void 0:T.min)!==null&&M!==void 0?M:0,max:(E=(R=S.range)===null||R===void 0?void 0:R.max)!==null&&E!==void 0?E:0,tick:{tickMode:(P=S.tick)===null||P===void 0?void 0:P.tickMode}},!0)}),(i=(e=C.internalProps.layoutMap)===null||e===void 0?void 0:e.updateDataStateToActiveChartInstance)===null||i===void 0||i.call(e,m),typeof h=="string")m.updateDataSync(h,u??[]);else{const S=[];for(const A in h){const T=h[A],M=d.series.find(R=>{var E;return((E=R?.data)===null||E===void 0?void 0:E.id)===A});S.push({id:A,values:T?(r=u?.filter(R=>R.hasOwnProperty(T)))!==null&&r!==void 0?r:[]:u??[],fields:(o=M?.data)===null||o===void 0?void 0:o.fields}),m.updateFullDataSync||m.updateDataSync(A,T?(s=u?.filter(R=>R.hasOwnProperty(T)))!==null&&s!==void 0?s:[]:u??[])}(a=m.updateFullDataSync)===null||a===void 0||a.call(m,S)}C.fireListeners("before_cache_chart_image",{chartInstance:m}),HWt(m.getStage(),n)}function SJ(n){lx=!0,ax.length>0?wJ=requestAnimationFrame(()=>{const t=ax.splice(0,sE);sx.splice(0,sE),t.forEach(e=>{xJ(e),e.addUpdateBoundTag()}),n.render(),SJ(n)}):lx=!1}const ya=2e3;function HWt(n,t){var e;const{viewWidth:i,viewHeight:r}=n;if(i<ya&&r<ya)return t.cacheCanvas=TV(n),void(t.isShareChartSpec||((e=t.chartInstance)===null||e===void 0||e.release(),t.chartInstance=null,t.setAttribute("chartInstance",null)));const o=Math.ceil(r/ya),s=Math.ceil(i/ya),a=[];for(let l=0;l<o;l++)for(let h=0;h<s;h++){const u=h*ya,d=l*ya,c=u+ya>i?i:u+ya,f=d+ya>r?r:d+ya,g=c-u,p=f-d,v=new lu;v.setValue(u,d,c,f);const m=TV(n,!1,v);a.push({canvas:m,x:u,y:d,width:g,height:p})}t.cacheCanvas=a}function TV(n,t=!0,e){if(n.releaseStatus==="released")return null;const i=FWt(n,t,e).getNativeHandler();return i.nativeCanvas?i.nativeCanvas:null}function FWt(n,t=!0,e){const i=n.window.getViewBoxTransform(),r=Nt.get(Pm),o=e?-e.x1:0,s=e?-e.y1:0,a=e?e.x2:n.viewWidth,l=e?e.y2:n.viewHeight,h=e?e.width():n.viewWidth,u=e?e.height():n.viewHeight;return r.create({viewBox:{x1:o,y1:s,x2:a,y2:l},width:h*i.a,height:u*i.d,dpr:n.window.dpr,canvasControled:!0,offscreen:!0,title:""}),r.setViewBoxTransform(i.a,i.b,i.c,i.d,0,0),n.renderTo(r),r}var zWt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};const NWt=Symbol.for("ChartRender");let I0=class extends to{constructor(){super(...arguments),this.numberType=DD}drawShape(n,t,e,i,r,o,s,a){var l,h,u,d;const c=te(n,o?.theme).group,{dataId:f,data:g,spec:p}=n.attribute,{width:v=c.width,height:m=c.height}=(n.getViewBox(),n.attribute),{table:y}=n.getRootNode(),{active:b,cacheCanvas:_,activeChartInstance:w}=n;if(!b&&_)Mt(_)?_.forEach(C=>{const{x,y:S,width:A,height:T,canvas:M}=C;t.drawImage(M,x,S,A,T)}):t.drawImage(_,e,i,v,m);else if(w){if(y.options.specFormat){const T=y.options.specFormat(n.attribute.spec,w,n);if(T.needFormatSpec&&T.spec){const M=T.spec;w.updateSpecSync(M,!1,{reuse:!1,morph:!1})}}const C=n.getViewBox();w.updateViewBox({x1:0,x2:C.x2-C.x1,y1:0,y2:C.y2-C.y1},!1,!1);const x=w.getStage();x.needRender=!0;const S=n.globalTransMatrix.clone(),A=n.stage.window.getViewBoxTransform().clone();if(A.multiply(S.a,S.b,S.c,S.d,S.e,S.f),x.window.setViewBoxTransform(A.a,A.b,A.c,A.d,A.e,A.f),typeof f=="string")w.updateDataSync(f,g??[]);else{const T=[];for(const M in f){const R=f[M],E=p.series.find(P=>{var B;return((B=P?.data)===null||B===void 0?void 0:B.id)===M});T.push({id:M,values:R?(l=g?.filter(P=>P.hasOwnProperty(R)))!==null&&l!==void 0?l:[]:g??[],fields:(h=E?.data)===null||h===void 0?void 0:h.fields}),w.updateFullDataSync||w.updateDataSync(M,R?(u=g?.filter(P=>P.hasOwnProperty(R)))!==null&&u!==void 0?u:[]:g??[])}(d=w.updateFullDataSync)===null||d===void 0||d.call(w,T)}}else y.internalProps.renderChartAsync?(sx.indexOf(`${n.parent.col}+${n.parent.row}`)===-1&&(sx.push(`${n.parent.col}+${n.parent.row}`),ax.push(n)),IWt()||SJ(y)):xJ(n)}draw(n,t,e,i){this._draw(n,{},!1,e,i)}};I0=zWt([yt()],I0);var FA=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let hx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{shape:f}=n.attribute;if(f==="circle"){const{width:g=l.width,height:p=l.height}=n.attribute;t.beginPath(),t.arc(e+g/2,i+p/2,Math.min(g,p)/2,0,2*Math.PI),t.closePath(),t.save(),t.clip()}}};hx=FA([yt()],hx);let ux=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{shape:f}=n.attribute;f==="circle"&&t.restore()}};ux=FA([yt()],ux);let dx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{isGif:f}=n.attribute;f&&n.playing&&(n.attribute.opacity=0)}};dx=FA([yt()],dx);let cx=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{isGif:f}=n.attribute;f&&n.playing&&(n.attribute.opacity=1,t.globalAlpha=n.attribute.opacity,n.renderFrame(t,e,i))}};cx=FA([yt()],cx);function WWt(n,t){var e,i,r,o,s,a,l,h,u,d,c;let f,g;if(n.role==="cell"&&Y(n.mergeStartCol)&&Y(n.mergeStartRow)&&Y(n.mergeEndCol)&&Y(n.mergeEndRow)){const{colStart:v,colEnd:m,rowStart:y,rowEnd:b}=bu(n,t.scenegraph);for(let _=v;_<=m;_++)for(let w=y;w<=b;w++){const C=MV(t.stateManager,_,w);!C||f&&C!=="cellBgColor"||(f=C)}}else n.role==="cell"&&(f=MV(t.stateManager,n.col,n.row));if(!f)return;const p=t.internalProps.layoutMap;return p.isCornerHeader(n.col,n.row)?g=((e=t.theme.cornerHeaderStyle)===null||e===void 0?void 0:e.select)||((i=t.theme.headerStyle)===null||i===void 0?void 0:i.select):p.isColumnHeader(n.col,n.row)?g=(r=t.theme.headerStyle)===null||r===void 0?void 0:r.select:p.isRowHeader(n.col,n.row)?g=(o=t.theme.rowHeaderStyle)===null||o===void 0?void 0:o.select:p.isBottomFrozenRow(n.col,n.row)?g=((s=t.theme.bottomFrozenStyle)===null||s===void 0?void 0:s.select)||(t.isListTable()?(a=t.theme.bodyStyle)===null||a===void 0?void 0:a.select:(l=t.theme.headerStyle)===null||l===void 0?void 0:l.select):p.isRightFrozenColumn(n.col,n.row)?g=((h=t.theme.rightFrozenStyle)===null||h===void 0?void 0:h.select)||(t.isListTable()?(u=t.theme.bodyStyle)===null||u===void 0?void 0:u.select:(d=t.theme.rowHeaderStyle)===null||d===void 0?void 0:d.select):t.isHeader(n.col,n.row)||(g=(c=t.theme.bodyStyle)===null||c===void 0?void 0:c.select),ut(f,g,n.col,n.row,t)}function VWt(n){return n.start.col!==n.end.col||n.start.row!==n.end.row}function GWt(n,t,e){let i;const{highlightScope:r,cellPos:o,ranges:s}=n.select,a=s[0],l=Math.min(a.start.col,a.end.col),h=Math.max(a.start.col,a.end.col),u=Math.min(a.start.row,a.end.row),d=Math.max(a.start.row,a.end.row);return r===Ae.single&&o.col===t&&o.row===e?i="cellBgColor":r===Ae.column&&t>=l&&t<=h?i=fs(s[0],t,e)?"cellBgColor":"inlineColumnBgColor":r===Ae.row&&e>=u&&e<=d?i=fs(s[0],t,e)?"cellBgColor":"inlineRowBgColor":r===Ae.cross&&(fs(s[0],t,e)?i="cellBgColor":t>=l&&t<=h?i="inlineColumnBgColor":e>=u&&e<=d&&(i="inlineRowBgColor")),i}function $Wt(n,t,e){let i;const{highlightScope:r,cellPos:o}=n.select;return r===Ae.single&&o.col===t&&o.row===e?i="cellBgColor":r===Ae.column&&o.col===t?i=o.col===t&&o.row===e?"cellBgColor":"inlineColumnBgColor":r===Ae.row&&o.row===e?i=o.col===t&&o.row===e?"cellBgColor":"inlineRowBgColor":r===Ae.cross&&(o.col===t&&o.row===e?i="cellBgColor":o.col===t?i="inlineColumnBgColor":o.row===e&&(i="inlineRowBgColor")),i}function MV(n,t,e,i){const{highlightInRange:r,disableHeader:o,ranges:s}=n.select;let a;const l=s.length===1&&VWt(s?.[0])&&r;if(l?s?.length===1&&s[0].start&&s[0].end:s?.length===1&&s[0].end.col===s[0].start.col&&s[0].end.row===s[0].start.row){if(n.table.isHeader(t,e)&&o)return;a=l?GWt(n,t,e):$Wt(n,t,e),a&&zh(n.table,t,e)&&(a=void 0)}else if(n.table.theme.selectionStyle.selectionFillMode==="replace")for(let h=0;h<s.length;h++){const u=s[h],d=Math.min(u.start.col,u.end.col),c=Math.max(u.start.col,u.end.col),f=Math.min(u.start.row,u.end.row),g=Math.max(u.start.row,u.end.row);if(d<=t&&f<=e&&c>=t&&g>=e){a="cellBgColor";break}}return a}function zh(n,t,e){var i,r;const o=(i=n.options.select)===null||i===void 0?void 0:i.disableSelect;if(typeof o=="function"?o(t,e,n):o)return!0;if(n.isHeader(t,e)){let s=(r=n.options.select)===null||r===void 0?void 0:r.disableHeaderSelect;if(s)return!0;const a=n.getHeaderDefine(t,e);if(s=a?.disableHeaderSelect,s)return!0}else{const s=n.getBodyColumnDefine(t,e),a=s?.disableSelect;if(typeof a=="function"?a(t,e,n):a)return!0}return!1}var th=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let fx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{stroke:f=l.stroke,strokeArrayWidth:g=l.strokeArrayWidth,strokeArrayColor:p=l.strokeArrayColor}=n.attribute;f&&(Array.isArray(g)||Array.isArray(p))&&(c.doStroke=!1)}};fx=th([yt()],fx);let gx=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d){var c,f;const{stroke:g=l.stroke,strokeArrayColor:p=l.strokeArrayColor,strokeArrayWidth:v=l.strokeArrayWidth,lineWidth:m=l.lineWidth,strokeColor:y=l.stroke,cornerRadius:b=l.cornerRadius}=n.attribute;let _,w,{width:C=l.width,height:x=l.height}=n.attribute;if(g&&(Array.isArray(v)||m!==0)&&(Array.isArray(p)||Array.isArray(v))){if(typeof m=="number"&&1&m||Array.isArray(v)&&v.some(S=>1&S)){const S=n.stage.table;if(!S)return;const A=((c=S?.theme)===null||c===void 0?void 0:c.cellBorderClipDirection)==="bottom-right";if(A){if(e=Math.floor(e)-.5,i=Math.floor(i)-.5,n.role==="cell"){const R=n.col,E=n.row;R===0&&(e+=1),E===0&&(i+=1)}}else e=Math.floor(e)+.5,i=Math.floor(i)+.5;!((f=S.options.customConfig)===null||f===void 0)&&f._disableColumnAndRowSizeRound&&(C=Math.round(C),x=Math.round(x));const{width:T,height:M}=ID(n,Math.ceil(C),Math.ceil(x),A);_=T,w=M}else _=Math.ceil(C),w=Math.ceil(x);b===0||Mt(b)&&b.every(S=>S===0)?TJ(n,t,e,i,l,g,v||m,p||y,_,w):(t.beginPath(),qa(t,e,i,_,w,b,!0,new Array(4).fill(0).map((S,A)=>(T,M,R,E)=>{RJ(A,T,M,R,E,n,t,e,i,l,g,v||m,p||y,_,w)})),t.stroke())}}};gx=th([yt()],gx);function AJ(n){if(!Array.isArray(n))return{isSplitDraw:!1,width:n};let t;for(let e=0;e<n.length;e++){const i=n[e];if(i)if(t){if(i!==t)return{isSplitDraw:!0}}else t=i}return{isSplitDraw:!1,width:t}}function TJ(n,t,e,i,r,o,s,a,l,h,u,d){var c,f,g,p;const v=AJ(s),m=!Array.isArray(s),y=!Array.isArray(o),b=Array.isArray(d),_=Array.isArray(a)||v.isSplitDraw;t.setStrokeStyle(n,n.attribute,e,i,r);const{lineDash:w=r.lineDash}=n.attribute;let C=!1;w.length&&w.some(M=>Array.isArray(M))&&(C=!0),t.beginPath(),t.moveTo(e,i);const x=(y||o[0])&&(m||s[0]),S=(y||o[1])&&(m||s[1]),A=(y||o[2])&&(m||s[2]),T=(y||o[3])&&(m||s[3]);if(x){const M=(m?v.width:s[0])/2,R=(m?v.width:s[0])/2;b&&Array.isArray(d[0])?(t.moveTo(e-M+(l+M+R)*d[0][0],i),t.lineTo(e-M+(l+M+R)*(d[0][1]-d[0][0]),i),t.moveTo(e+l+R,i)):(t.moveTo(e-M,i),t.lineTo(e+l+R,i)),(_||C)&&(a&&a[0]?t.strokeStyle=a[0]:a&&!a[0]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[0]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,C&&t.setLineDash((c=w[0])!==null&&c!==void 0?c:[]),t.stroke(),t.beginPath(),t.moveTo(e+l,i))}else t.moveTo(e+l,i);if(S){const M=(m?v.width:s[1])/2,R=(m?v.width:s[1])/2;b&&Array.isArray(d[1])?(t.moveTo(e+l,i-M+h*d[1][0]),t.lineTo(e+l,i-M+(h+M+R)*(d[1][1]-d[1][0])),t.moveTo(e+l,i+h+R)):(t.moveTo(e+l,i-M),t.lineTo(e+l,i+h+R)),(_||C)&&(a&&a[1]?t.strokeStyle=a[1]:a&&!a[1]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[1]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,C&&t.setLineDash((f=w[1])!==null&&f!==void 0?f:[]),t.stroke(),t.beginPath(),t.moveTo(e+l,i+h))}else t.moveTo(e+l,i+h);if(A){const M=(m?v.width:s[2])/2,R=(m?v.width:s[2])/2;b&&Array.isArray(d[2])?(t.moveTo(e-M+(l+M+R)*d[2][0],i+h),t.lineTo(e-M+(l+M+R)*(d[2][1]-d[2][0]),i+h),t.moveTo(e-M,i+h)):(t.moveTo(e-M,i+h),t.lineTo(e+l+R,i+h)),(_||C)&&(a&&a[2]?t.strokeStyle=a[2]:a&&!a[2]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[2]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,C&&t.setLineDash((g=w[2])!==null&&g!==void 0?g:[]),t.stroke(),t.beginPath(),t.moveTo(e,i+h))}else t.moveTo(e,i+h);if(T){const M=(m?v.width:s[3])/2,R=(m?v.width:s[3])/2;b&&Array.isArray(d[3])?(t.moveTo(e,i-M+(h+M+R)*d[3][0]),t.lineTo(e,i-M+(h+M+R)*(d[3][1]-d[3][0])),t.moveTo(e,i-M)):(t.moveTo(e,i-M),t.lineTo(e,i+h+R)),(_||C)&&(a&&a[3]?t.strokeStyle=a[3]:a&&!a[3]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[3]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,C&&t.setLineDash((p=w[3])!==null&&p!==void 0?p:[]),t.stroke(),t.beginPath(),t.moveTo(e,i))}else t.moveTo(e,i);_||C||(!m&&v.width&&(t.lineWidth=v.width),t.stroke()),t.lineDashOffset=0,t.setLineDash([])}let px=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){var f;const{lineDash:g=l.lineDash,stroke:p=l.stroke,strokeArrayColor:v=l.strokeArrayColor,strokeArrayWidth:m=l.strokeArrayWidth}=n.attribute;p&&Array.isArray(g)&&g.length&&(!((f=g[0])===null||f===void 0)&&f.length)&&!Array.isArray(v)&&!Array.isArray(m)&&(c.doStroke=!1)}};px=th([yt()],px);let vx=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d){var c,f,g,p,v,m;const{lineDash:y=l.lineDash,stroke:b=l.stroke,strokeArrayColor:_=l.strokeArrayColor,strokeArrayWidth:w=l.strokeArrayWidth,lineWidth:C=l.lineWidth}=n.attribute;if(!b||!(Array.isArray(y)&&y.length&&(!((c=y[0])===null||c===void 0)&&c.length))||Array.isArray(_)||Array.isArray(w))return;const x=n.stage.table;if(!x)return;const S=Mt(y[0])?jWt(y):[y,y,y,y];let A,T,{width:M=l.width,height:R=l.height}=n.attribute;if(!((f=x.options.customConfig)===null||f===void 0)&&f._disableColumnAndRowSizeRound?(M=Math.round(M),R=Math.round(R)):(M=Math.ceil(M),R=Math.ceil(R)),1&C){const E=x.theme.cellBorderClipDirection==="bottom-right",P=0,B=0;E?(e=Math.floor(e)-.5,i=Math.floor(i)-.5,n.role==="cell"&&(n.col===0&&(e+=1),n.row===0&&(i+=1))):(e=Math.floor(e)+.5,i=Math.floor(i)+.5);const{width:k,height:L}=ID(n,Math.ceil(M+P),Math.ceil(R+B),E);A=k,T=L}else A=Math.ceil(M),T=Math.ceil(R);t.setStrokeStyle(n,n.attribute,e,i,l),t.beginPath(),t.moveTo(e,i),t.lineTo(e+A,i),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash((g=S[0])!==null&&g!==void 0?g:[]),t.stroke(),t.beginPath(),t.moveTo(e+A,i),t.lineTo(e+A,i+T),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash((p=S[1])!==null&&p!==void 0?p:[]),t.stroke(),t.beginPath(),t.moveTo(e,i+T),t.lineTo(e+A,i+T),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash((v=S[2])!==null&&v!==void 0?v:[]),t.stroke(),t.beginPath(),t.moveTo(e,i),t.lineTo(e,i+T),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash((m=S[3])!==null&&m!==void 0?m:[]),t.stroke(),t.lineDashOffset=0,t.setLineDash([])}};vx=th([yt()],vx);let mx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{lineWidth:f=l.lineWidth,stroke:g=l.stroke,lineDash:p=l.lineDash,strokeArrayWidth:v=l.strokeArrayWidth,strokeArrayColor:m=l.strokeArrayColor,notAdjustPos:y}=n.attribute;y!==!0&&g&&Array.isArray(p)&&!p.length&&!Array.isArray(m)&&!Array.isArray(v)&&1&f&&(c.doStroke=!1)}};mx=th([yt()],mx);let yx=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d){var c,f;const{lineWidth:g=l.lineWidth,stroke:p=l.stroke,lineDash:v=l.lineDash,strokeArrayWidth:m=l.strokeArrayWidth,strokeArrayColor:y=l.strokeArrayColor,notAdjustPos:b,cornerRadius:_=l.cornerRadius}=n.attribute;let{width:w=l.width,height:C=l.height}=n.attribute;if(b!==!0&&p&&Array.isArray(v)&&!v.length&&!Array.isArray(y)&&!Array.isArray(m)&&1&g){const x=n.stage.table;if(!x)return;!((c=x.options.customConfig)===null||c===void 0)&&c._disableColumnAndRowSizeRound&&(w=Math.round(w),C=Math.round(C)),t.beginPath();const S=((f=x?.theme)===null||f===void 0?void 0:f.cellBorderClipDirection)==="bottom-right",A=0,T=0;S?(e=Math.floor(e)-.5,i=Math.floor(i)-.5,n.role==="cell"&&(n.col===0&&(e+=1),n.row===0&&(i+=1))):(e=Math.floor(e)+.5,i=Math.floor(i)+.5);const{width:M,height:R}=ID(n,Math.ceil(w),Math.ceil(C),S);_?qa(t,e,i,M+A,R+T,_):t.rect(e,i,M,R),t.setStrokeStyle(n,n.attribute,e,i,l),t.stroke()}}};yx=th([yt()],yx);let bx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){if(n.role==="cell"){const f=n.stage.table;if(f){const g=WWt(n,f);if(g)n.attribute._vtableHightLightFill=g;else if(f.stateManager.interactionState!==Ft.scrolling){const p=CJ(n,f);p&&(n.attribute._vtableHightLightFill=p)}}}}};bx=th([yt()],bx);let _x=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d){if(n.attribute._vtableHightLightFill&&!u){if(s){const c=n.attribute.fill;n.attribute.fill=n.attribute._vtableHightLightFill,t.setCommonStyle(n,n.attribute,e,i,l),t.fill(),n.attribute.fill=c,n.attribute._vtableHightLightFill=void 0}}}};_x=th([yt()],_x);let Cx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){var f,g,p,v,m,y;const b=n.stage.table;b&&(n.role==="body"?hl(t,-((f=n.attribute.x)!==null&&f!==void 0?f:0)+b.getFrozenColsWidth(),-((g=n.attribute.y)!==null&&g!==void 0?g:0)+b.getFrozenRowsHeight(),n.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),n.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):n.role==="row-header"?hl(t,0,-((p=n.attribute.y)!==null&&p!==void 0?p:0)+b.getFrozenRowsHeight(),b.getFrozenColsWidth(),n.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):n.role==="col-header"?hl(t,-((v=n.attribute.x)!==null&&v!==void 0?v:0)+b.getFrozenColsWidth(),0,n.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),b.getFrozenRowsHeight()):n.role==="right-frozen"?hl(t,0,-((m=n.attribute.y)!==null&&m!==void 0?m:0)+b.getFrozenRowsHeight(),b.getRightFrozenColsWidth(),n.parent.attribute.height-b.getFrozenRowsHeight()-b.getBottomFrozenRowsHeight()):n.role==="bottom-frozen"?hl(t,-((y=n.attribute.x)!==null&&y!==void 0?y:0)+b.getFrozenColsWidth(),0,n.parent.attribute.width-b.getFrozenColsWidth()-b.getRightFrozenColsWidth(),b.getBottomFrozenRowsHeight()):n.role==="corner-header"?hl(t,0,0,b.getFrozenColsWidth(),b.getFrozenRowsHeight()):n.role==="corner-right-top-header"?hl(t,0,0,b.getRightFrozenColsWidth(),b.getFrozenRowsHeight()):n.role==="corner-right-bottom-header"?hl(t,0,0,b.getRightFrozenColsWidth(),b.getBottomFrozenRowsHeight()):n.role==="corner-left-bottom-header"&&hl(t,0,0,b.getFrozenColsWidth(),b.getBottomFrozenRowsHeight()))}};Cx=th([yt()],Cx);const cf=Math.pow(2,24);function hl(n,t,e,i,r){n.beginPath();const o=n.applyedMatrix;Math.abs(o.f)>cf||Math.abs(o.g)>cf?n.rect(t-cf,e-cf,i+2*cf,r+2*cf):n.rect(t,e,i,r)}function ID(n,t,e,i){var r,o;const s=n.stage.table;if(!s)return{width:t,height:e};if(n.role==="cell"){let a=n.col,l=n.row;const h=Ji(s,a,l);h&&(a=h.end.col,l=h.end.row),i?(a===0&&(t-=1),l===0&&(e-=1)):((a===s.colCount-1||a===s.frozenColCount-1&&s.scrollLeft||!((r=s.containerFit)===null||r===void 0)&&r.width&&s.rightFrozenColCount&&a===s.colCount-s.rightFrozenColCount-1)&&(t-=1),(l===s.rowCount-1||l===s.frozenRowCount-1&&s.scrollTop||!((o=s.containerFit)===null||o===void 0)&&o.height&&s.bottomFrozenRowCount&&l===s.rowCount-s.bottomFrozenRowCount-1)&&(e-=1))}else n.role==="corner-frozen"&&(s.scrollLeft&&!i&&(t-=1),s.scrollTop&&!i&&(e-=1));return{width:t,height:e}}function jWt(n){return n.length===1?[n[0],n[0],n[0],n[0]]:n.length===2?[n[0],n[1],n[0],n[1]]:n}var MJ=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let H0=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){const{stroke:f=l.stroke,strokeArrayWidth:g=l.strokeArrayWidth,strokeArrayColor:p=l.strokeArrayColor}=n.attribute;f&&(Array.isArray(f)||Array.isArray(g)||Array.isArray(p))&&(c.doStroke=!1)}};H0=MJ([yt()],H0);let F0=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d){const{width:c=l.width,height:f=l.height,stroke:g=l.stroke,strokeArrayColor:p=l.strokeArrayColor,strokeArrayWidth:v=l.strokeArrayWidth,lineWidth:m=l.lineWidth,strokeColor:y=l.stroke,cornerRadius:b=l.cornerRadius}=n.attribute;g&&(Array.isArray(v)||m!==0)&&(Array.isArray(g)||Array.isArray(p)||Array.isArray(v))&&(n.name!=="border-rect"&&n.name!=="table-border-rect"&&(typeof m=="number"&&1&m||Array.isArray(v)&&v.some(C=>1&C))&&(e=Math.floor(e)+.5,i=Math.floor(i)+.5),b===0||Mt(b)&&b.every(C=>C===0)?TJ(n,t,e,i,l,g,v||m,p||y,n.name!=="table-border-rect"?Math.ceil(c+0):c+0,n.name!=="table-border-rect"?Math.ceil(f+0):f+0):(t.beginPath(),qa(t,e,i,c,f,b,!0,new Array(4).fill(0).map((C,x)=>(S,A,T,M)=>{RJ(x,S,A,T,M,n,t,e,i,l,g,v||m,p||y,Math.ceil(c+0),Math.ceil(f+0))})),t.stroke()))}};F0=MJ([yt()],F0);function RJ(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g){var p,v,m,y;const b=o,_=h,w=AJ(d),C=!Array.isArray(d),x=!Array.isArray(u),S=Array.isArray(c)||w.isSplitDraw;s.stroke(),s.setStrokeStyle(o,o.attribute,a,l,h);const{lineDash:A=_.lineDash}=b.attribute;let T=!1;A.length&&A.some(B=>Array.isArray(B))&&(T=!0),s.beginPath(),s.moveTo(a,l);const M=(x||u[0])&&(C||d[0]),R=(x||u[1])&&(C||d[1]),E=(x||u[2])&&(C||d[2]),P=(x||u[3])&&(C||d[3]);M&&n===0?(C?w.width:d[0],C?w.width:d[0],s.moveTo(t,e),s.lineTo(i,r),(S||T)&&(c&&c[0]?s.strokeStyle=c[0]:c&&!c[0]&&(s.strokeStyle="transparent"),C||(s.lineWidth=d[0]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,T&&s.setLineDash((p=A[0])!==null&&p!==void 0?p:[]),s.stroke(),s.beginPath())):n===0&&s.moveTo(a+f,l),R&&n===1?(C?w.width:d[1],C?w.width:d[1],s.moveTo(t,e),s.lineTo(i,r),(S||T)&&(c&&c[1]?s.strokeStyle=c[1]:c&&!c[1]&&(s.strokeStyle="transparent"),C||(s.lineWidth=d[1]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,T&&s.setLineDash((v=A[1])!==null&&v!==void 0?v:[]),s.stroke(),s.beginPath(),s.moveTo(a+f,l+g))):n===1&&s.moveTo(a+f,l+g),E&&n===2?(C?w.width:d[2],C?w.width:d[2],s.moveTo(t,e),s.lineTo(i,r),(S||T)&&(c&&c[2]?s.strokeStyle=c[2]:c&&!c[2]&&(s.strokeStyle="transparent"),C||(s.lineWidth=d[2]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,T&&s.setLineDash((m=A[2])!==null&&m!==void 0?m:[]),s.stroke(),s.beginPath(),s.moveTo(a,l+g))):n===2&&s.moveTo(a,l+g),P&&n===3?(C?w.width:d[3],C?w.width:d[3],s.moveTo(t,e),s.lineTo(i,r),(S||T)&&(c&&c[3]?s.strokeStyle=c[3]:c&&!c[3]&&(s.strokeStyle="transparent"),C||(s.lineWidth=d[3]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,T&&s.setLineDash((y=A[3])!==null&&y!==void 0?y:[]),s.stroke(),s.beginPath(),s.moveTo(a,l))):n===3&&s.moveTo(a,l),s.closePath(),S||T||(!C&&w.width&&(s.lineWidth=w.width),s.stroke()),s.lineDashOffset=0,s.setLineDash([]),s.beginPath()}var UWt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Sv,xx=class{constructor(){this.order=1,this.interceptors=[new XWt]}afterDrawItem(n,t,e,i,r){for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].afterDrawItem&&this.interceptors[o].afterDrawItem(n,t,e,i,r))return!0;return!1}beforeDrawItem(n,t,e,i,r){if((!n.in3dMode||e.in3dInterceptor)&&!n.shadowRoot&&!(n.baseGraphic||n.attribute.globalZIndex||n.interactiveGraphic))return!1;for(let o=0;o<this.interceptors.length;o++)if(this.interceptors[o].beforeDrawItem&&this.interceptors[o].beforeDrawItem(n,t,e,i,r))return!0;return!1}};xx=UWt([yt()],xx);class XWt{constructor(){this.order=1}afterDrawItem(t,e,i,r,o){return t.type==="image"&&this.drawItem(t,e,i,r,o),!1}drawItem(t,e,i,r,o){const{image:s,gif:a}=t.attribute;if(a&&t.playing||!s||!t.resources)return!1;const l=t.resources.get(s);if(!l||l.state!=="loading")return!1;if(!Sv){const p=ms(),v=p.loading_pic.svg,m=p.loading_pic.width,y=p.loading_pic.height;Sv=uA({width:m,height:y,image:v})}const{image:h}=Sv.attribute;if(!s||!Sv.resources)return!1;const u=Sv.resources.get(h);if(u.state!=="success")return!1;const{context:d}=i;d.highPerformanceSave(),t.parent&&d.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&d.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);const c=t.AABBBounds,{width:f,height:g}=IA(u.data.width,u.data.height,c.width(),c.height());return d.drawImage(u.data,c.x1+(c.width()-f)/2,c.y1+(c.height()-g)/2,f,g),d.highPerformanceRestore(),!0}}var YWt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Sx=class{constructor(){this.time=xe.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){var f,g;const{text:p,underline:v=l.underline,lineThrough:m=l.lineThrough,direction:y=l.direction,whiteSpace:b=l.whiteSpace,fontSize:_=l.fontSize,verticalMode:w=l.verticalMode,ellipsis:C=l.ellipsis,textAlign:x=l.textAlign,textBaseline:S=l.textBaseline,x:A=l.x,y:T=l.y}=n.attribute;let M=!1;if(Array.isArray(n)){const B=(f=n.cache)===null||f===void 0?void 0:f.layoutData;C&&B&&B.lines.every(k=>k.str==="")&&(M=!0)}else{const{cache:B}=n;C&&B&&B.clipedText===""&&B.clipedWidth===0&&(M=!0)}if(!M)return;const R=Si(C)?C:"...",E=(g=Ty(n.attribute.lineHeight,_))!==null&&g!==void 0?g:_;let P=0;E!==_&&(S==="top"?P=(E-_)/2:S==="middle"||S==="bottom"&&(P=-(E-_)/2)),o&&(d?d(t,n.attribute,l):a&&(t.setStrokeStyle(n,n.attribute,A-e,T-i,l),t.strokeText(R,A,T+P))),r&&(u?u(t,n.attribute,l):s&&(t.setCommonStyle(n,n.attribute,A-e,T-i,l),t.fillText(R,A,T+P),this.drawUnderLine(v,m,n,A,T+P,0,l,t,R)))}drawUnderLine(n,t,e,i,r,o,s,a,l){if(t+n<=0)return;const{textAlign:h=s.textAlign,textBaseline:u=s.textBaseline,fontSize:d=s.fontSize,fontFamily:c=s.fontFamily,fontWeight:f=s.fontWeight,fontStyle:g=s.fontStyle,fill:p=s.fill,opacity:v=s.opacity,underlineOffset:m=s.underlineOffset,underlineDash:y=s.underlineDash,fillOpacity:b=s.fillOpacity}=e.attribute;if(!n&&!t)return;const _=LD.measureTextWidth(l,{fontSize:d,fontFamily:c,fontWeight:f,fontStyle:g}),w=Jg(h,_),C=Lm(u,d,d),x={lineWidth:0,stroke:p,opacity:v,strokeOpacity:b};if(n){x.lineWidth=n,a.setStrokeStyle(e,x,i,r,s),a.setLineDash(y),a.beginPath();const S=r+C+d+m;a.moveTo(i+w,S,o),a.lineTo(i+w+_,S,o),a.stroke()}if(t){x.lineWidth=t,a.setStrokeStyle(e,x,i,r,s),a.beginPath();const S=r+C+d/2;a.moveTo(i+w,S,o),a.lineTo(i+w+_,S,o),a.stroke()}}};Sx=YWt([yt()],Sx);var KWt=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Ax=class{constructor(){this.type="chart",this.numberType=DD}contains(n,t,e){var i;if(n.attribute.detectPickChartItem){const r=n.activeChartInstance;if(!r)return!1;const o=r.getStage();(i=o.dirtyBounds)===null||i===void 0||i.clear();const s=o.pick(t.x,t.y);return(s.graphic!==null||s.group.name!=="root")&&s}return!!n.AABBBounds.containsPoint(t)}};Ax=KWt([yt()],Ax);const qWt=new Ut((n,t,e,i)=>{e(ep)?i(ep).to(H0).inSingletonScope():(n(H0).toSelf().inSingletonScope(),n(Pd).toService(H0)),e(ip)?i(ip).to(F0).inSingletonScope():(n(F0).toSelf().inSingletonScope(),n(Pd).toService(F0)),n(I0).toSelf().inSingletonScope(),n(NWt).to(I0),n(kr).to(I0),n(Ax).toSelf().inSingletonScope(),n(Qr).toService(Ax),n(hx).toSelf().inSingletonScope(),n(Bd).toService(hx),n(ux).toSelf().inSingletonScope(),n(Bd).toService(ux),n(dx).toSelf().inSingletonScope(),n(Bd).toService(dx),n(cx).toSelf().inSingletonScope(),n(Bd).toService(cx),n(bx).toSelf().inSingletonScope(),n(No).toService(bx),n(_x).toSelf().inSingletonScope(),n(No).toService(_x),n(gx).toSelf().inSingletonScope(),n(No).toService(gx),n(fx).toSelf().inSingletonScope(),n(No).toService(fx),n(px).toSelf().inSingletonScope(),n(No).toService(px),n(vx).toSelf().inSingletonScope(),n(No).toService(vx),n(mx).toSelf().inSingletonScope(),n(No).toService(mx),n(yx).toSelf().inSingletonScope(),n(No).toService(yx),n(Cx).toSelf().inSingletonScope(),n(No).toService(Cx),n(xx).toSelf().inSingletonScope(),n(Hm).toService(xx),n(Sx).toSelf().inSingletonScope(),n(Yw).toService(Sx)});function ls(n,t,e,i){var r,o,s,a,l,h,u,d;n.internalProps.columnWidthConfig&&e4t(n,n.internalProps.columnWidthConfig),n.isPivotTable()&&n.internalProps.columnWidthConfigForRowHeader&&r4t(n,n.internalProps.columnWidthConfigForRowHeader),t=t??0,e=e??n.colCount-1,t===0&&e===n.colCount-1&&n._clearColRangeWidthsMap();const c=n.internalProps.layoutMap;n.isPivotTable()&&(c.enableUseGetBodyCache(),c.enableUseHeaderPathCache());const f=[],g=[];if(i)for(let p=0;p<n.colCount;p++)f[p]=n.getColWidth(p);for(let p=t;p<=e;p++){let v;if(n.internalProps.transpose||((o=(r=n.internalProps.layoutMap.columnObjects)===null||r===void 0?void 0:r[p])===null||o===void 0?void 0:o.columnWidthComputeMode)!=="only-header"&&n.columnWidthComputeMode!=="only-header"||!("showHeader"in n.internalProps.layoutMap))v=n.internalProps.transpose||((a=(s=n.internalProps.layoutMap.columnObjects)===null||s===void 0?void 0:s[p])===null||a===void 0?void 0:a.columnWidthComputeMode)!=="only-body"&&n.columnWidthComputeMode!=="only-body"?ag(p,0,n.rowCount-1,n):ag(p,n.internalProps.layoutMap.getBodyRange().start.row,n.internalProps.layoutMap.getBodyRange().end.row,n);else{const m=n.internalProps.layoutMap.showHeader;n.internalProps.layoutMap.showHeader=!0,v=ag(p,0,n.internalProps.layoutMap.headerLevelCount-1,n),n.internalProps.layoutMap.showHeader=m}n._setColContentWidth(p,v),n.getColWidth(p)!==v&&n._clearColRangeWidthsMap(p),i?g[p]=Math.round(n._adjustColWidth(p,v)):n._setColWidth(p,n._adjustColWidth(p,v),!1,!0)}if(n.widthMode==="adaptive"){n._clearColRangeWidthsMap();const p=n.tableNoFrameWidth;let v=0,m=0,y=n.colCount;if(n.widthAdaptiveMode==="only-body"){for(let b=0;b<n.colCount;b++){const _=i&&(l=g[b])!==null&&l!==void 0?l:n.getColWidth(b);(b<n.rowHeaderLevelCount||n.isPivotChart()&&b>=n.colCount-n.rightFrozenColCount)&&(v+=_)}m=n.rowHeaderLevelCount,y=n.isPivotChart()?n.colCount-n.rightFrozenColCount:n.colCount}Tx(p-v,m,y,i,g,n)}else if(n.autoFillWidth){n._clearColRangeWidthsMap();const p=n.tableNoFrameWidth;let v=0,m=0;for(let y=0;y<n.colCount;y++){const b=i&&(h=g[y])!==null&&h!==void 0?h:n.getColWidth(y);(y<n.rowHeaderLevelCount+n.leftRowSeriesNumberCount||n.isPivotChart()&&y>=n.colCount-n.rightFrozenColCount)&&(v+=b),m+=b}m<p&&m>v&&Tx(p-v,n.rowHeaderLevelCount+n.leftRowSeriesNumberCount,n.isPivotChart()?n.colCount-n.rightFrozenColCount:n.colCount,i,g,n)}if(i){for(let p=0;p<n.colCount;p++){const v=(d=(u=g[p])!==null&&u!==void 0?u:n.getColWidth(p))!==null&&d!==void 0?d:n.getColWidth(p);v!==f[p]&&n._setColWidth(p,v,!1,!0)}n.stateManager.checkFrozen();for(let p=0;p<n.colCount;p++){const v=n.getColWidth(p);v!==f[p]&&n.scenegraph.updateColWidth(p,v-f[p],!0,!0)}n.scenegraph.updateContainer({async:!0})}n.isPivotTable()&&(c.disableUseGetBodyCache(),c.disableUseHeaderPathCache())}function ag(n,t,e,i,r=!1){let o=t4t(n,i);return i.internalProps.transpose&&o==="auto"&&(i.columnWidthComputeMode==="only-header"&&n>=i.rowHeaderLevelCount||i.columnWidthComputeMode==="only-body"&&n<i.rowHeaderLevelCount)&&(o=i.getDefaultColumnWidth(n)),r&&!i.internalProps.transpose?RV(o,n,t,e,r,i):typeof o=="number"?o:o!=="auto"&&typeof o=="string"?i._adjustColWidth(n,i._colWidthDefineToPxWidth(o)):RV(o,n,t,e,r,i)}function RV(n,t,e,i,r,o){var s,a,l,h,u;let d=0,c=1,f=1;if(i-e>5e3&&(f=Math.ceil((i-e)/5e3)),o.isPivotChart()&&t>=o.rowHeaderLevelCount&&t<o.colCount-o.rightFrozenColCount){if(o.internalProps.layoutMap.indicatorsAsCol)return o.defaultColWidth;{let v=!1;o.internalProps.layoutMap.getChartSpec(t,o.columnHeaderLevelCount).type==="heatmap"&&(v=!0);const m=o.internalProps.layoutMap.getOptimunWidthForChart(t,v);if(m>0)return m}}for(let v=e;v<=i;v+=c){if(o.isPivotChart()){const x=o.internalProps.layoutMap,S=x.getAxisConfigInPivotChart(t,v);if(S){const A=Bt.getFunction("computeAxisComponentWidth")(S,o);if(typeof A=="number"){d=Math.max(A,d);continue}}else if(x.isLeftBottomCorner(t,v)||x.isRightTopCorner(t,v)||x.isRightBottomCorner(t,v))continue}const m=ZWt(t,v,o);if(m&&(d=Math.max(m.width,d),!m.renderDefault))continue;const y=n;if(typeof y=="number"&&o.widthMode==="standard"&&!r){d=Math.max(y,d);continue}const b=o.isHeader(t,v)?(s=o._getHeaderLayoutMap(t,v))===null||s===void 0?void 0:s.headerType:o.getBodyColumnType(t,v);if(Y(b)&&b!=="text"&&b!=="link"&&b!=="progressbar"&&b!=="checkbox"&&b!=="radio"&&b!=="switch"&&b!=="button"){d=Math.max(d,o.getColWidthDefinedNumber(t)||0);continue}let _=0;const w=o.internalProps.layoutMap;if(w.isHeader(t,v)){const x=w.getHeader(t,v);if(((a=x?.define)===null||a===void 0?void 0:a.columnWidthComputeMode)==="only-body")continue;Y(x?.hierarchyLevel)&&(_=((l=x.hierarchyLevel)!==null&&l!==void 0?l:0)*(w.rowHierarchyType==="tree"&&(h=w.rowHierarchyIndent)!==null&&h!==void 0?h:0),w.rowHierarchyTextStartAlignment&&!o.internalProps.headerHelper.getHierarchyIcon(t,v)&&(_+=o.internalProps.headerHelper.getHierarchyIconWidth()))}else if(o.isListTable()){c=f;const x=o.getBodyColumnDefine(t,v);if(x?.tree){const S=o.dataSource.getIndexKey(o.getRecordShowIndexByCell(t,v));_=Array.isArray(S)&&o.getHierarchyState(t,v)!==Lt.none?(S.length-1)*((u=w.hierarchyIndent)!==null&&u!==void 0?u:0):0,w.hierarchyTextStartAlignment&&!o.internalProps.bodyHelper.getHierarchyIcon(t,v)&&(_+=o.internalProps.headerHelper.getHierarchyIconWidth())}}const C=JWt(t,v,b,o);d=Math.max(C+_,d),c>1&&o.bottomFrozenRowCount>0&&v<o.rowCount-o.bottomFrozenRowCount&&v+c>=o.rowCount-o.bottomFrozenRowCount&&(v=o.rowCount-o.bottomFrozenRowCount-c,c=1,f=1)}const g=o.getMinColWidth(t),p=o.getMaxColWidth(t);return d<g?g:d>p?p:(d<=0&&(d=o.defaultColWidth),d)}function ZWt(n,t,e){var i,r,o,s,a,l,h;const u=e.getCustomRender(n,t);let d=e.getCustomLayout(n,t);if(u||d){let c,f=1,g=0,p=!1,v=!1;(e.isHeader(n,t)||!((i=e.getBodyColumnDefine(n,t))===null||i===void 0)&&i.mergeCell||e.hasCustomMerge())&&(c=e.getCellRange(n,t),f=c.end.col-c.start.col+1);const m={col:(r=c?.start.col)!==null&&r!==void 0?r:n,row:(o=c?.start.row)!==null&&o!==void 0?o:t,dataValue:e.getCellOriginValue(n,t),value:e.getCellValue(n,t)||"",rect:QWt(n,t,e),table:e,originCol:n,originRow:t,forComputation:!0};if(d==="react-custom-layout"&&(d=((s=e.reactCustomLayout)===null||s===void 0?void 0:s.getCustomLayoutFunc(n,t))||Xm),Bo(d)){const y=d(m);if(y.rootContainer){y.rootContainer=Ym(y.rootContainer),DA(y.rootContainer,0,e.getRowHeight(t));const b=y.rootContainer.attribute.width;y.rootContainer.setStage(e.scenegraph.stage),g=b>0?b:(a=y.rootContainer.AABBBounds.width())!==null&&a!==void 0?a:0,p=y.renderDefault,v=y.enableCellPadding}else g=0,p=y.renderDefault,v=y.enableCellPadding}else if(typeof u=="function"){const y=u(m);g=(l=y?.expectedWidth)!==null&&l!==void 0?l:0,p=y?.renderDefault}else g=(h=u?.expectedWidth)!==null&&h!==void 0?h:0,p=u?.renderDefault;if(g=Math.ceil(g),v){const y=e._getCellStyle(n,t),b=ce(ut("padding",y,n,t,e));g+=b[1]+b[3]}return{width:g/f,renderDefault:p}}}function JWt(n,t,e,i){var r,o,s,a;let l=0;const h=i.getCellValue(n,t),u=i._getCellStyle(n,t);let d=0,c=!1;if(i.getCellLocation(n,t)!=="body")c=!0;else{const w=i.getBodyColumnDefine(n,t);c=!!w?.icon||!!w?.tree||w?.dragOrder}if(c){const w=i.getCellIcons(n,t);w?.forEach(C=>{var x,S,A;C.positionType!==He.absoluteRight&&(d+=((x=C.width)!==null&&x!==void 0?x:0)+((S=C.marginLeft)!==null&&S!==void 0?S:0)+((A=C.marginRight)!==null&&A!==void 0?A:0))})}let f=1;if(i.isHeader(n,t)||!((r=i.getBodyColumnDefine(n,t))===null||r===void 0)&&r.mergeCell||i.hasCustomMerge()){const w=i.getCellRange(n,t);f=w.end.col-w.start.col+1}const g=ce(ut("padding",u,n,t,i)),p=g[1]+g[3],v=ut("fontSize",u,n,t,i),m=ut("fontFamily",u,n,t,i),y=ut("fontWeight",u,n,t,i);let b;if(e==="checkbox")b=pn(h)?h.text:h;else if(e==="radio")if(Mt(h)){b="";const w=i.getBodyColumnDefine(n,t),C=(o=w?.radioDirectionInCell)!==null&&o!==void 0?o:"vertical";C==="vertical"?h.forEach(x=>{b+=(pn(x)?x.text:x).toString()+`
`}):C==="horizontal"&&h.forEach(x=>{b+=(pn(x)?x.text:x).toString()})}else b=pn(h)?h.text:h;else if(e==="button"){const w=i.getBodyColumnDefine(n,t),C=Ie(w.text,{col:n,row:t,table:i,context:null,value:h,dataValue:i.getCellOriginValue(n,t)});b=(s=C??h)!==null&&s!==void 0?s:""}else b=h;const _=Km(b,i).text;if(_.length>=1&&(_.length!==1||_[0]!=="")?_.forEach(w=>{const C=i.measureText(w,{fontSize:v,fontFamily:m,fontWeight:y}).width;l=Math.max((C+p+4+d)/f,l)}):l=Math.max((p+4+d)/f,l),i.internalProps.limitMaxAutoWidth!==!1&&(l=Math.min(typeof i.internalProps.limitMaxAutoWidth=="number"?i.internalProps.limitMaxAutoWidth:450,l)),e==="checkbox"){const w=ut("size",u,n,t,i);if(l+=w,b){const C=ut("spaceBetweenTextAndIcon",u,n,t,i);l+=C}}else if(e==="radio"){const w=ut("size",u,n,t,i),C=ut("outerRadius",u,n,t,i),x=pt(C)?2*C:w,S=ut("spaceBetweenTextAndIcon",u,n,t,i);if(Mt(h)){const A=i.getBodyColumnDefine(n,t),T=ut("spaceBetweenRadio",u,n,t,i),M=(a=A?.radioDirectionInCell)!==null&&a!==void 0?a:"vertical";M==="vertical"?(l+=x,l+=S):M==="horizontal"&&(l+=(x+S)*h.length,l+=T*(h.length-1))}else l+=x,b&&(l+=S)}else if(e==="switch")l=ut("boxWidth",u,n,t,i);else if(e==="button"){const w=ut("buttonPadding",u,n,t,i);l+=2*w}return l}function QWt(n,t,e){return{left:0,top:0,right:e.getColWidth(n),bottom:e.getRowHeight(t),width:null,height:null}}function t4t(n,t){const e=t.getColWidthDefined(n);return t.internalProps._widthResizedColMap.has(n)?t.getColWidth(n):e}function Tx(n,t,e,i,r,o,s){var a,l,h,u;let d=0;const c=[],f=[];let g=0;const p=new Map,v=new Map;for(let y=t;y<e;y++){const b=i&&(a=r[y])!==null&&a!==void 0?a:o.getColWidth(y),_=o.getMaxColWidth(y),w=o.getMinColWidth(y);d+=b,c.push(y),_===b?p.set(y,b):w===b&&v.set(y,b),!((l=o.options.customConfig)===null||l===void 0)&&l.shrinkSparklineFirst&&o.getBodyColumnType(y,0)==="sparkline"&&(f.push({col:y,width:b}),g+=b-o.defaultColWidth)}if(d>n)for(const[y,b]of v){n-=b,d-=b;const _=c.indexOf(y);_!==-1&&c.splice(_,1)}else if(d<n)for(const[y,b]of p){n-=b,d-=b;const _=c.indexOf(y);_!==-1&&c.splice(_,1)}const m=n/d;if(!((h=o.options.customConfig)===null||h===void 0)&&h.shrinkSparklineFirst&&m<1&&d-n<g)for(let y=0;y<f.length;y++){const{col:b,width:_}=f[y],w=(d-n)/f.length,C=Math.floor(_-w);i?r[b]=o._adjustColWidth(b,C):s?o.scenegraph.setColWidth(b,o._adjustColWidth(b,C)):o._setColWidth(b,o._adjustColWidth(b,C),!1,!0)}else for(let y=0;y<c.length;y++){const b=c[y];let _;_=y===c.length-1?n-c.reduce((w,C,x)=>{var S;return C!==b?w+(i?(S=r[C])!==null&&S!==void 0?S:o.getColWidth(b):o.getColWidth(C)):w},0):Math.round((i&&(u=r[b])!==null&&u!==void 0?u:o.getColWidth(b))*m),i?r[b]=o._adjustColWidth(b,_):s?o.scenegraph.setColWidth(b,o._adjustColWidth(b,_)):o._setColWidth(b,o._adjustColWidth(b,_),!1,!0)}}function e4t(n,t){n.isPivotTable()?n4t(n,t):n.isListTable()&&i4t(n,t)}function i4t(n,t){for(let e=0;e<t?.length;e++){const i=t[e],r=i.key,o=i.width,s=n.internalProps.layoutMap.getColumnByKey(r);if(s.columnDefine){const{col:a}=s;n.internalProps._widthResizedColMap.has(a)||(n._setColWidth(a,o),n.internalProps._widthResizedColMap.add(a))}}}function n4t(n,t){for(let e=0;e<t?.length;e++){const i=t[e],r=i.dimensions,o=i.width,s=n.getCellAddressByHeaderPaths(r);if(s&&s.col>=n.rowHeaderLevelCount){const a=n.getCellHeaderPaths(s.col,n.columnHeaderLevelCount);if(a.colHeaderPaths.length===r.length){let l=!0;for(let h=0;h<r.length;h++){const u=r[h];if(a.colHeaderPaths.findIndex((d,c)=>d.indicatorKey===u.indicatorKey||d.dimensionKey===u.dimensionKey&&d.value===u.value)<0){l=!1;break}}l&&!n.internalProps._widthResizedColMap.has(s.col)&&(n._setColWidth(s.col,o),n.internalProps._widthResizedColMap.add(s.col))}}else s&&s.col<n.rowHeaderLevelCount&&(n.internalProps._widthResizedColMap.has(s.col)||(n._setColWidth(s.col,o),n.internalProps._widthResizedColMap.add(s.col)))}}function r4t(n,t){for(let e=0;e<t?.length;e++){const i=t[e],r=i.dimensions,o=i.width,s=n.getCellAddressByHeaderPaths(r);s&&s.col<n.rowHeaderLevelCount&&(n.internalProps._widthResizedColMap.has(s.col)||(n._setColWidth(s.col,o),n.internalProps._widthResizedColMap.add(s.col)))}}const Mx=new re({});Mx.role="empty";function CC(n,t,e,i,r,o,s,a,l){var h,u;let d,c,f,g=0;n.lastChild&&n.lastChild.row===i-1?g=n.lastChild.attribute.y+n.lastChild.attribute.height:n.colHeight?g=n.colHeight:i>=a.columnHeaderLevelCount&&i<a.rowCount-a.bottomFrozenRowCount&&(g=a.getRowsHeight(a.columnHeaderLevelCount,i-1));for(let p=i;p<=r;p++){const v=p;let m,y,b,_,w=a.getCellLocation(t,v),C=a.getCellValue(t,v),x=e,S=a.getRowHeight(v),A=!1;if(a.internalProps.customMergeCell){const O=a.getCustomMerge(t,v);if(O){const{range:D,text:I,style:H,customLayout:F,customRender:G}=O;if(m=D,y=m.start.col!==m.end.col||m.start.row!==m.end.row,y){const j=BV(m,o,a,i>m.start.row);x=j.cellWidth,S=j.cellHeight}C=I,b=H,(F||G)&&(_=hu(F,G,D.start.col,D.start.row,a.getColsWidth(D.start.col,D.end.col),a.getRowsHeight(D.start.row,D.end.row),!1,a.isAutoRowHeight(v),[0,0,0,0],m,a)),A=!0}}let T,M=t,R=v;m&&(M=m.start.col,R=m.start.row),!a.isPivotTable()&&(w==="columnHeader"||w==="cornerHeader")&&v>=a.columnHeaderLevelCount&&(w="body"),T=!a.isPivotTable()&&a.isSeriesNumberInBody(t,v)?a.getBodyColumnDefine(M,R):w!=="body"?a.getHeaderDefine(M,R):a.getBodyColumnDefine(M,R);const E="isAggregation"in a.internalProps.layoutMap&&a.internalProps.layoutMap.isAggregation(t,v),P=a.internalProps.layoutMap.isSeriesNumber(t,v);let B=w!=="body"||(T?.dragOrder||!!T?.icon||!!T?.tree)&&!(E&&P);if(!m&&(a.internalProps.enableTreeNodeMerge||w!=="body"||T?.mergeCell)&&(m=a.getCellRange(t,v),y=m.start.col!==m.end.col||m.start.row!==m.end.row,y)){const O=BV(m,o,a,i>m.start.row);x=O.cellWidth,S=O.cellHeight}let k=!1;if(a.internalProps.enableTreeNodeMerge&&y){const O=a.getCellRawRecord(m.start.col,m.start.row),{vtableMergeName:D,vtableMerge:I}=O??{};k=I,I&&(B=!0,a.internalProps.groupTitleCustomLayout&&(_=hu(a.internalProps.groupTitleCustomLayout,void 0,m.start.col,m.start.row,a.getColsWidth(m.start.col,m.end.col),a.getRowsHeight(m.start.row,m.end.row),!1,a.isAutoRowHeight(v),[0,0,0,0],m,a)),a.internalProps.groupTitleFieldFormat?C=a.internalProps.groupTitleFieldFormat(O,t,v,a):D!==void 0&&(C=D))}const L=k||A?"text":(u=a.isHeader(t,v)?(h=a._getHeaderLayoutMap(t,v).headerType)!==null&&h!==void 0?h:"text":a.getBodyColumnType(t,v))!==null&&u!==void 0?u:"text";if(aa(C)){s4t(t,v,0,g,x,S,n),vJ(C,a,o4t.bind(null,{type:L,value:C,define:T,table:a,col:t,row:v,colWidth:e,cellWidth:x,cellHeight:S,columnGroup:n,y:g,customStyle:b,mayHaveIcon:B,cellLocation:w,range:m,customResult:_,defaultRowHeight:s})),n.updateColumnRowNumber(v);const O=a.getRowHeight(v);n.updateColumnHeight(O),g+=O}else{const O=b||a._getCellStyle(m?m.start.col:t,m?m.start.row:v),D=yu(O,a,m?m.start.col:t,m?m.start.row:v,ut).theme;D.group.cornerRadius=OA(t,v,a),D.group.width=e,D.group.height=Array.isArray(s)?s[v]:s,D._vtable.padding&&(d=D._vtable.padding),D.text.textAlign&&(c=D.text.textAlign),D.text.textBaseline&&(f=D.text.textBaseline),w==="body"||D.group.fill||(D.group.fill="#fff");const I=ED(L,C,T,a,t,v,e,x,S,n,g,d,c,f,B,D,m,_);if(n.updateColumnRowNumber(v),y){const H=a.getRowHeight(v),{width:F}=(a.getColWidth(t),I.attribute),{height:G}=I.attribute;I.contentWidth=F,I.contentHeight=G,yJ(m,F,G,d,c,f,a),n.updateColumnHeight(H),g+=H}else n.updateColumnHeight(S),g+=S}}return n.setAttribute("width",e),{width:e,height:g}}function o4t(n){let t,e,i;const{type:r,value:o,define:s,table:a,col:l,row:h,colWidth:u,cellWidth:d,cellHeight:c,columnGroup:f,y:g,cellLocation:p,mayHaveIcon:v,customStyle:m,range:y,customResult:b,defaultRowHeight:_}=n,w=m||a._getCellStyle(y?y.start.col:l,y?y.start.row:h),C=yu(w,a,y?y.start.col:l,y?y.start.row:h,ut).theme;C.group.cornerRadius=OA(l,h,a),C.group.width=u,C.group.height=Array.isArray(_)?_[h]:_,C._vtable.padding&&(t=C._vtable.padding),C.text.textAlign&&(e=C.text.textAlign),C.text.textBaseline&&(i=C.text.textBaseline),p==="body"||C.group.fill||(C.group.fill="#fff"),ED(r,o,s,a,l,h,u,d,c,f,g,t,e,i,v,C,y,b)}function BV(n,t,e,i){let r=0,o=0;const s=t.get(`${n.start.col},${n.start.row};${n.end.col},${n.end.row}`);if(!s||i){for(let a=n.start.col;a<=n.end.col;a++)r+=e.getColWidth(a);for(let a=n.start.row;a<=n.end.row;a++)o+=e.getRowHeight(a);t.set(`${n.start.col},${n.start.row};${n.end.col},${n.end.row}`,{cellWidth:r,cellHeight:o})}else r=s.cellWidth,o=s.cellHeight;return{cellWidth:r,cellHeight:o}}function s4t(n,t,e,i,r,o,s){const a=new re({x:e,y:i,width:r,height:o});a.role="cell",a.col=n,a.row=t,s.addChild(a)}function ji(n,t,e,i,r,o,s,a,l,h){if(i>r||o>s)return;const{layoutMap:u,defaultHeaderRowHeight:d,defaultColWidth:c}=l.internalProps,f=l.defaultRowHeight;let g=0,p=0;for(let v=i;v<=r;v++){const m=v,y=l.getColWidth(m),b=new re({x:t+g,y:e,width:y,height:0,clip:!1,pickable:!1});b.role="column",b.col=v,n.addChild(b);const{width:_,height:w}=CC(b,m,y,o,s,l.scenegraph.mergeMap,a==="columnHeader"&&pt(d)?d:f,l);g+=_,p=Math.max(p,w)}n.setAttribute("width",g),n.setAttribute("height",p)}function a4t(n,t,e,i,r,o,s,a,l){var h,u,d,c,f,g,p,v,m,y,b,_,w;const{table:C}=l,{leftBottomCornerGroup:x,rightTopCornerGroup:S,rightBottomCornerGroup:A}=C.scenegraph;let T,M,R,E;l.setParamsForRow(),l.setParamsForColumn(),(C.widthMode==="adaptive"||C.options.autoWrapText&&(C.heightMode==="adaptive"||C.isAutoRowHeight(C.columnHeaderLevelCount)))&&(R=C.colCount-1),T=Math.min(l.firstScreenColLimit-1,C.colCount-1),C.heightMode==="adaptive"&&(E=C.rowCount-1),M=Math.min(l.firstScreenRowLimit-1,C.rowCount-1),C.internalProps._widthResizedColMap.size===0&&ls(C,0,R??T),C.internalProps._heightResizedRowMap.size===0&&as(C,0,C.options.canvasHeight==="auto"||!((h=C.options.customConfig)===null||h===void 0)&&h.forceComputeAllRowHeight?C.rowCount-1:E??M),T<C.colCount-C.rightFrozenColCount&&C.colCount-C.rightFrozenColCount<=C.colCount-1&&ls(C,C.colCount-C.rightFrozenColCount,C.colCount-1),M<C.rowCount-C.bottomFrozenRowCount&&C.rowCount-C.bottomFrozenRowCount<=C.rowCount-1&&as(C,C.rowCount-C.bottomFrozenRowCount,C.rowCount-1),C.scenegraph.colHeaderGroup.setAttribute("x",C.getFrozenColsWidth()),C.scenegraph.rowHeaderGroup.setAttribute("y",C.getFrozenRowsHeight()),C.scenegraph.bottomFrozenGroup.setAttribute("x",C.getFrozenColsWidth()),C.scenegraph.rightFrozenGroup.setAttribute("y",C.getFrozenRowsHeight()),C.scenegraph.bodyGroup.setAttributes({x:C.getFrozenColsWidth(),y:C.getFrozenRowsHeight()}),ji(n,s,a,0,C.frozenColCount-1,0,C.frozenRowCount-1,C.isListTable()?"columnHeader":"cornerHeader",C),T-C.rightFrozenColCount>=C.frozenColCount&&ji(t,s,a,C.frozenColCount,T-C.rightFrozenColCount,0,C.frozenRowCount-1,"columnHeader",C),C.frozenColCount>0&&(C.leftRowSeriesNumberCount>0&&ji(e,s,a,0,C.leftRowSeriesNumberCount-1,C.frozenRowCount,M-C.bottomFrozenRowCount,"rowHeader",C),C.frozenColCount>C.leftRowSeriesNumberCount&&ji(e,s,a,C.leftRowSeriesNumberCount,Math.min(C.frozenColCount-1,C.rowHeaderLevelCount+C.leftRowSeriesNumberCount-1),C.frozenRowCount,M-C.bottomFrozenRowCount,"rowHeader",C),C.frozenColCount>C.rowHeaderLevelCount+C.leftRowSeriesNumberCount&&ji(e,s,a,C.rowHeaderLevelCount+C.leftRowSeriesNumberCount,C.frozenColCount-1,C.frozenRowCount,M-C.bottomFrozenRowCount,"body",C)),C.bottomFrozenRowCount>0&&(C.frozenColCount>0&&(C.leftRowSeriesNumberCount>0&&ji(x,s,a,0,C.leftRowSeriesNumberCount-1,C.rowCount-1-C.bottomFrozenRowCount+1,C.rowCount-1,"rowHeader",C),C.rowHeaderLevelCount>0&&ji(x,s,a,C.leftRowSeriesNumberCount,C.leftRowSeriesNumberCount+C.rowHeaderLevelCount-1,C.rowCount-1-C.bottomFrozenRowCount+1,C.rowCount-1,"rowHeader",C),C.frozenColCount>C.rowHeaderLevelCount+C.leftRowSeriesNumberCount&&ji(x,s,a,C.rowHeaderLevelCount+C.leftRowSeriesNumberCount,C.frozenColCount-1,C.rowCount-1-C.bottomFrozenRowCount+1,C.rowCount-1,"body",C)),T-C.rightFrozenColCount>=C.frozenColCount&&ji(r,s,a,C.frozenColCount,T-C.rightFrozenColCount,C.rowCount-1-C.bottomFrozenRowCount+1,C.rowCount-1,C.isPivotChart()?"rowHeader":"body",C)),C.rightFrozenColCount>0&&(ji(S,s,a,C.colCount-1-C.rightFrozenColCount+1,C.colCount-1,0,C.frozenRowCount-1,"columnHeader",C),ji(i,s,a,C.colCount-1-C.rightFrozenColCount+1,C.colCount-1,C.frozenRowCount,M-C.bottomFrozenRowCount,C.isPivotChart()?"rowHeader":"body",C)),C.bottomFrozenRowCount>0&&C.rightFrozenColCount>0&&ji(A,s,a,C.colCount-1-C.rightFrozenColCount+1,C.colCount-1,C.rowCount-1-C.bottomFrozenRowCount+1,C.rowCount-1,"body",C),T-C.rightFrozenColCount>=C.frozenColCount&&ji(o,s,a,C.frozenColCount,T-C.rightFrozenColCount,C.frozenRowCount,M-C.bottomFrozenRowCount,"body",C),o.firstChild||t.firstChild||n.firstChild||e.firstChild?(l.currentRow=(f=(d=(u=o.firstChild)===null||u===void 0?void 0:u.rowNumber)!==null&&d!==void 0?d:(c=e.firstChild)===null||c===void 0?void 0:c.rowNumber)!==null&&f!==void 0?f:l.totalRow,l.rowEnd=l.currentRow,l.rowUpdatePos=l.rowEnd+1,l.referenceRow=l.rowStart+Math.floor((l.rowEnd-l.rowStart)/2),l.currentCol=(w=(b=(m=(p=(g=o.lastChild)===null||g===void 0?void 0:g.col)!==null&&p!==void 0?p:(v=t.lastChild)===null||v===void 0?void 0:v.col)!==null&&m!==void 0?m:(y=e.lastChild)===null||y===void 0?void 0:y.col)!==null&&b!==void 0?b:(_=n.lastChild)===null||_===void 0?void 0:_.col)!==null&&w!==void 0?w:l.totalCol,l.colEnd=l.currentCol,l.colUpdatePos=l.colEnd+1,l.referenceCol=l.colStart+Math.floor((l.colEnd-l.colStart)/2),l.progress()):(l.currentRow=l.totalRow,l.rowEnd=l.currentRow,l.rowUpdatePos=l.rowEnd+1,l.referenceRow=l.rowStart+Math.floor((l.rowEnd-l.rowStart)/2),l.currentCol=l.totalCol,l.colEnd=l.currentCol,l.colUpdatePos=l.colEnd+1,l.referenceCol=l.colStart+Math.floor((l.colEnd-l.colStart)/2))}function PV(n){let t=n.firstChild;for(;t&&t.type!=="group";)t=t._next;return t}function Zm(n){let t=n.lastChild;for(;t&&t.type!=="group";)t=t._prev;return t}function l4t(n){let t=n._prev;for(;t&&t.type!=="group";)t=t._prev;return t}function h4t(n){let t=n._next;for(;t&&t.type!=="group";)t=t._next;return t}function lE(n,t,e,i="left"){for(let a=n;a<=t;a++){const l=e.scenegraph.getColGroup(a);l&&o2(l,e,i);const h=e.scenegraph.getColGroup(a,!0);h&&o2(h,e,i);const u=e.scenegraph.getColGroupInBottom(a);u&&o2(u,e,i)}const r=Math.min(e.scenegraph.proxy.colLimit,e.scenegraph.proxy.bodyRightCol-e.scenegraph.proxy.bodyLeftCol+1),o=e.getColsWidth(e.frozenColCount,e.frozenColCount+r),s=e.getColsWidth(e.frozenColCount,e.colCount-1);e.scenegraph.proxy.xLimitLeft=o/2,e.scenegraph.proxy.xLimitRight=s-o/2}function o2(n,t,e="left"){if(e==="left"){let i;const r=l4t(n);i=r?r.attribute.x+t.getColWidth(n._prev.col):t.getColsWidth(t.frozenColCount,n.col-1),n.setAttribute("x",i)}else{let i;const r=h4t(n);i=r?r.attribute.x-t.getColWidth(n.col):t.getColsWidth(t.frozenColCount,n.col-1),n.setAttribute("x",i)}}var BJ=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function u4t(n,t,e,i){return BJ(this,void 0,void 0,function*(){if(!t)return;const r=t.col,o=t.left;let s;if(s=e?i.bodyRightCol-i.colEnd:i.screenLeftCol-i.referenceCol,d4t(s,r,o,n,i),e){const a=i.table.scenegraph.getColGroup(i.colEnd);if(a){const l=a.attribute.x+a.attribute.width-(i.table.tableNoFrameWidth-i.table.getFrozenColsWidth()-i.table.getRightFrozenColsWidth())-n;i.deltaX=-l,i.table.scenegraph.setBodyAndColHeaderX(-n+i.deltaX)}}i.table.scenegraph.updateNextFrame()})}function d4t(n,t,e,i,r){n>0?(kV(n,"left",r.screenLeftCol,e,i,r),r.updateDeltaX(i,e,t),r.table.scenegraph.setBodyAndColHeaderX(-i+r.deltaX)):n<0?(kV(-n,"right",r.screenLeftCol,e,i,r),r.updateDeltaX(i,e,t),r.table.scenegraph.setBodyAndColHeaderX(-i+r.deltaX)):(r.updateDeltaX(i,e,t),r.table.scenegraph.setBodyAndColHeaderX(-i+r.deltaX))}function kV(n,t,e,i,r,o){return BJ(this,void 0,void 0,function*(){if(t==="left"&&o.colEnd+n>o.bodyRightCol?n=o.bodyRightCol-o.colEnd:t==="right"&&o.colStart-n<o.bodyLeftCol&&(n=o.colStart-o.bodyLeftCol),n!==0)if(n<0&&(t=t==="left"?"right":"left",n=-n),n<o.colEnd-o.colStart){const s=t==="left"?o.colStart:o.colEnd-n+1,a=t==="left"?o.colStart+n-1:o.colEnd,l=t==="left"?o.colEnd+1:o.colStart-n,h=t==="left"?o.colEnd+n:o.colStart-1;ls(o.table,l,h),f4t(s,a,t,o);const u=l,d=h;o.colStart=t==="left"?o.colStart+n:o.colStart-n,o.colEnd=t==="left"?o.colEnd+n:o.colEnd-n,Jm(u,d,o),lE(u,d,o.table,t);const c=o.table.scenegraph.getColGroup(e)||o.table.scenegraph.getColGroup(e,!0),f=i-(c.attribute.x+o.table.getFrozenColsWidth()+o.table.scenegraph.proxy.deltaX);o.table.scenegraph.proxy.deltaX+=f,o.currentCol=t==="left"?o.currentCol+n:o.currentCol-n,o.totalCol=Math.max(0,Math.min(o.table.colCount-1,t==="left"?o.totalCol+n:o.totalCol-n)),o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2),o.colUpdatePos=l,o.colUpdateDirection=t,o.table.scenegraph.updateNextFrame()}else{const s=t==="left"?o.colStart+n:o.colStart-n,a=t==="left"?o.colEnd+n:o.colEnd-n;ls(o.table,s,a),g4t(o.table.getColsWidth(o.bodyLeftCol,s-1),n,t,o);const l=s,h=a;o.colStart=s,o.colEnd=a,Jm(l,h,o),lE(l,h,o.table,a>o.bodyRightCol-(o.colEnd-o.colStart+1)?"right":"left"),o.currentCol=t==="left"?o.currentCol+n:o.currentCol-n,o.totalCol=Math.max(0,Math.min(o.table.colCount-1,t==="left"?o.totalCol+n:o.totalCol-n)),o.referenceCol=o.colStart+Math.floor((o.colEnd-o.colStart)/2),o.colUpdatePos=o.colStart,o.colUpdateDirection=a>o.bodyRightCol-(o.colEnd-o.colStart+1)?"right":"left",o.table.scenegraph.updateNextFrame()}})}function z0(n,t,e){n.col=t,n.forEachChildren(i=>{i.col=t,i.needUpdate=!0}),n.setAttribute("x",e),n.needUpdate=!0}function O_(n,t){if(!n)return;let e=n.firstChild;for(;e;)e=t.updateCellGroupContent(e)._next;n.needUpdate=!1,n.setAttribute("width",t.table.getColWidth(n.col))}function c4t(n,t){if(!n)return;const e=t.screenTopRow,i=Math.max(t.bodyTopRow,e-1*t.screenRowCount),r=Math.min(t.bodyBottomRow,e+2*t.screenRowCount,t.table.rowCount-1);for(let o=i;o<=r;o++){const s=t.highPerformanceGetCell(n.col,o,!0);t.updateCellGroupContent(s)}t.rowUpdatePos=t.rowStart,n.needUpdate=!1,n.setAttribute("width",t.table.getColWidth(n.col))}function f4t(n,t,e,i){for(let r=n;r<=t;r++)i.table.scenegraph.bodyGroup.childrenCount>0&&i.table.scenegraph.bodyGroup.firstChild.type==="group"&&s2(i.table.scenegraph.bodyGroup,e,i),i.table.scenegraph.colHeaderGroup.childrenCount>0&&i.table.scenegraph.colHeaderGroup.firstChild.type==="group"&&s2(i.table.scenegraph.colHeaderGroup,e,i),i.table.scenegraph.bottomFrozenGroup.childrenCount>0&&i.table.scenegraph.bottomFrozenGroup.firstChild.type==="group"&&s2(i.table.scenegraph.bottomFrozenGroup,e,i)}function s2(n,t,e){if(t==="left"){const i=PV(n),r=Zm(n);z0(i,r.col+1,r.attribute.x+e.table.getColWidth(r.col)),n.appendChild(i),n.border&&n.appendChild(n.border)}else{const i=Zm(n),r=PV(n);z0(i,r.col-1,r.attribute.x-e.table.getColWidth(r.col-1)),n.insertBefore(i,n.firstChild)}}function Jm(n,t,e){for(let i=n;i<=t;i++){const r=e.table.scenegraph.getColGroup(i,!0);r&&O_(r,e);const o=e.table.scenegraph.getColGroupInBottom(i);o&&O_(o,e);const s=e.table.scenegraph.getColGroupInRightTopCorner(i);s&&O_(s,e);const a=e.table.scenegraph.getColGroupInRightBottomCorner(i);a&&O_(a,e);const l=e.table.scenegraph.getColGroup(i);l&&c4t(l,e)}a2(e.table.scenegraph.colHeaderGroup),a2(e.table.scenegraph.bottomFrozenGroup),a2(e.table.scenegraph.bodyGroup),e.progress()}function g4t(n,t,e,i){i.table.scenegraph.colHeaderGroup.forEachChildren((r,o)=>{r.type==="group"&&z0(r,e==="left"?r.col+t:r.col-t,o===0?n:r._prev.attribute.x+i.table.getColWidth(r._prev.col))}),i.table.scenegraph.bottomFrozenGroup.forEachChildren((r,o)=>{r.type==="group"&&z0(r,e==="left"?r.col+t:r.col-t,o===0?n:r._prev.attribute.x+i.table.getColWidth(r._prev.col))}),i.table.scenegraph.bodyGroup.forEachChildren((r,o)=>{r.type==="group"&&z0(r,e==="left"?r.col+t:r.col-t,o===0?n:r._prev.attribute.x+i.table.getColWidth(r._prev.col))})}function a2(n){var t,e;const i=Zm(n);if(i&&(n.setAttribute("width",i.attribute.x+i.attribute.width),n.border)){const r=n.border;r.setAttribute("width",i.attribute.x+i.attribute.width-((t=r.attribute.borderLeft)!==null&&t!==void 0?t:0)/2-((e=r.attribute.borderRight)!==null&&e!==void 0?e:0)/2)}}function fo(n,t,e,i,r,o="up",s){var a,l;if(o==="up")for(let c=n;c<=t;c++)for(let f=e;f<=i;f++){const g=r.scenegraph.highPerformanceGetCell(c,f,!0);if(g.role!=="cell"||!g.row)continue;let p;if(g._prev)p=((a=g._prev)===null||a===void 0?void 0:a.attribute.y)+r.getRowHeight(g._prev.row);else if(s){const v=i===r.rowCount-r.bottomFrozenRowCount-1?i:i+1;if(p=r.scenegraph.highPerformanceGetCell(c,v,!0).attribute.y,Y(p))for(let m=f;m<v;m++)p-=r.getRowHeight(m)}else p=EV(g.row,r);Y(p)&&g.setAttribute("y",p)}else for(let c=n;c<=t;c++)for(let f=i;f>=e;f--){const g=r.scenegraph.highPerformanceGetCell(c,f,!0);if(g.role!=="cell"||!g.row)continue;let p;if(g._next)p=((l=g._next)===null||l===void 0?void 0:l.attribute.y)-r.getRowHeight(g.row);else if(s){const v=e<=r.frozenRowCount?r.frozenRowCount:e-1;e<=r.frozenRowCount?p=0:p=r.scenegraph.highPerformanceGetCell(c,v,!0).attribute.y;for(let m=v;m<f;m++)p+=r.getRowHeight(m)}else p=EV(g.row,r);Y(p)&&g.setAttribute("y",p)}const h=Math.min(r.scenegraph.proxy.rowLimit,r.scenegraph.proxy.bodyBottomRow-r.scenegraph.proxy.bodyTopRow+1),u=r.getRowsHeight(r.frozenRowCount,r.frozenRowCount+h),d=r.getRowsHeight(r.frozenRowCount,r.rowCount-1);r.scenegraph.proxy.yLimitTop=u/2,r.scenegraph.proxy.yLimitBottom=d-u/2}function EV(n,t){let e;return e=n<t.frozenRowCount?t.getRowsHeight(0,n-1):n>=t.rowCount-t.bottomFrozenRowCount?t.getRowsHeight(t.rowCount-t.bottomFrozenRowCount,n-1):t.getRowsHeight(t.frozenRowCount,n-1),e}var PJ=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function p4t(n,t,e,i){return PJ(this,void 0,void 0,function*(){if(!t)return;const r=t.row,o=t.top;let s;if(s=e?i.bodyBottomRow-i.rowEnd:r-i.referenceRow,v4t(s,r,o,n,i),e){const a=i.table.scenegraph.highPerformanceGetCell(i.colStart,i.rowEnd,!0);if(a.role==="cell"){const l=a.attribute.y+a.attribute.height-(i.table.tableNoFrameHeight-i.table.getFrozenRowsHeight()-i.table.getBottomFrozenRowsHeight())-n;i.deltaY=-l,i.updateBody(n-i.deltaY)}}})}function v4t(n,t,e,i,r){n>0?(LV(n,"up",t,e,i,r),r.updateDeltaY(i,e,t),r.updateBody(i-r.deltaY)):n<0?(LV(-n,"down",t,e,i,r),r.updateDeltaY(i,e,t),r.updateBody(i-r.deltaY)):(r.updateDeltaY(i,e,t),r.updateBody(i-r.deltaY))}function LV(n,t,e,i,r,o){return PJ(this,void 0,void 0,function*(){if(t==="up"&&o.rowEnd+n>o.bodyBottomRow?n=o.bodyBottomRow-o.rowEnd:t==="down"&&o.rowStart-n<o.bodyTopRow&&(n=o.rowStart-o.bodyTopRow),n!==0)if(n<0&&(t=t==="up"?"down":"up",n=-n),n<o.rowEnd-o.rowStart){const s=t==="up"?o.rowStart:o.rowEnd-n+1,a=t==="up"?o.rowStart+n-1:o.rowEnd,l=t==="up"?o.rowEnd+1:o.rowStart-n,h=t==="up"?o.rowEnd+n:o.rowStart-1;let u,d;o.table.isAutoRowHeight(s)?(u=l,d=h):(u=Math.max(o.bodyTopRow,e-1*o.screenRowCount),d=Math.min(o.bodyBottomRow,e+2*o.screenRowCount,o.table.rowCount-1)),as(o.table,u,d,!1),m4t(s,a,t,o),o.rowStart=t==="up"?o.rowStart+n:o.rowStart-n,o.rowEnd=t==="up"?o.rowEnd+n:o.rowEnd-n;const c=Qm(u,d,o,!0);o.table.isAutoRowHeight(s)&&(fo(o.bodyLeftCol,o.bodyRightCol,u,d,o.table,h>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",!0),fo(0,o.table.frozenColCount-1,u,d,o.table,h>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",!0),fo(o.table.colCount-o.table.rightFrozenColCount,o.table.colCount-1,u,d,o.table,h>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",!0)),o.currentRow=t==="up"?o.currentRow+n:o.currentRow-n,o.totalRow=Math.max(0,Math.min(o.bodyBottomRow,t==="up"?o.totalRow+n:o.totalRow-n,o.table.rowCount-1)),o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.table.isAutoRowHeight(s)&&c?o.rowUpdatePos=Math.min(o.rowUpdatePos,o.rowEnd+1):o.rowUpdatePos=Math.min(o.rowUpdatePos,l),o.rowUpdateDirection=t,o.table.scenegraph.updateNextFrame(),yield o.progress()}else{const s=t==="up"?o.rowStart+n:o.rowStart-n,a=Math.min(o.table.rowCount-1,t==="up"?o.rowEnd+n:o.rowEnd-n),l=o.table.getRowsHeight(o.bodyTopRow,s-1);let h,u;o.table.isAutoRowHeight(s)?(h=s,u=a):(h=Math.max(o.bodyTopRow,e-1*o.screenRowCount),u=Math.min(o.bodyBottomRow,e+2*o.screenRowCount,o.table.rowCount-1)),as(o.table,h,u,!1),y4t(l,n,t,o),o.rowStart=s,o.rowEnd=a;const d=Qm(h,u,o,!0);o.table.isAutoRowHeight(s)&&(fo(o.bodyLeftCol,o.bodyRightCol,h,u,o.table,a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up"),fo(0,o.table.frozenColCount-1,h,u,o.table,a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up"),fo(o.table.colCount-o.table.rightFrozenColCount,o.table.colCount-1,h,u,o.table,a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up")),o.currentRow=t==="up"?o.currentRow+n:o.currentRow-n,o.totalRow=Math.max(0,Math.min(o.bodyBottomRow,t==="up"?o.totalRow+n:o.totalRow-n,o.table.rowCount-1)),o.referenceRow=o.rowStart+Math.floor((o.rowEnd-o.rowStart)/2),o.table.isAutoRowHeight(s)&&d?o.rowUpdatePos=o.rowEnd+1:o.rowUpdatePos=o.rowStart,o.rowUpdateDirection=a>o.bodyBottomRow-(o.rowEnd-o.rowStart+1)?"down":"up",o.table.scenegraph.updateNextFrame(),yield o.progress()}})}function m4t(n,t,e,i){for(let r=0;r<i.table.frozenColCount;r++){const o=i.table.scenegraph.getColGroup(r);if(o)for(let s=n;s<=t;s++)l2(o,e,i)}for(let r=i.table.colCount-i.table.rightFrozenColCount;r<i.table.colCount;r++){const o=i.table.scenegraph.getColGroup(r);if(o)for(let s=n;s<=t;s++)l2(o,e,i)}for(let r=i.bodyLeftCol;r<=i.bodyRightCol;r++){const o=i.table.scenegraph.getColGroup(r);if(o)for(let s=n;s<=t;s++)l2(o,e,i)}}function l2(n,t,e){if(n.childrenCount>=1)if(t==="up"){const i=n.firstChild;e.updateCellGroupPosition(i,n.lastChild.row+1,n.lastChild.attribute.y+e.table.getRowHeight(n.lastChild.row)),n.appendChild(i)}else{const i=n.lastChild;e.updateCellGroupPosition(i,n.firstChild.row-1,n.firstChild.attribute.y-e.table.getRowHeight(i.row)),n.insertBefore(i,n.firstChild)}}function y4t(n,t,e,i){for(let r=0;r<i.table.frozenColCount;r++){const o=i.table.scenegraph.getColGroup(r);o?.forEachChildren((s,a)=>{i.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,a===0?n:s._prev.attribute.y+i.table.getRowHeight(s._prev.row))})}for(let r=i.table.colCount-i.table.rightFrozenColCount;r<i.table.colCount;r++){const o=i.table.scenegraph.getColGroup(r);o?.forEachChildren((s,a)=>{i.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,a===0?n:s._prev.attribute.y+i.table.getRowHeight(s._prev.row))})}for(let r=i.bodyLeftCol;r<=i.bodyRightCol;r++){const o=i.table.scenegraph.getColGroup(r);o?.forEachChildren((s,a)=>{i.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,a===0?n:s._prev.attribute.y+i.table.getRowHeight(s._prev.row))})}}function Qm(n,t,e,i=!1){for(let a=0;a<e.table.frozenColCount;a++)for(let l=n;l<=t;l++){const h=e.highPerformanceGetCell(a,l,!0);e.updateCellGroupContent(h)}for(let a=e.table.colCount-e.table.rightFrozenColCount;a<e.table.colCount;a++)for(let l=n;l<=t;l++){const h=e.highPerformanceGetCell(a,l);e.updateCellGroupContent(h)}let r=e.bodyLeftCol,o=e.bodyRightCol,s=!0;if(i){const a=e.screenLeftCol;r=Math.max(e.bodyLeftCol,a-1*e.screenColCount),o=Math.min(e.bodyRightCol,a+2*e.screenColCount),r===e.bodyLeftCol&&o===e.bodyRightCol||(s=!1)}for(let a=r;a<=o;a++)for(let l=n;l<=t;l++){const h=e.highPerformanceGetCell(a,l);e.updateCellGroupContent(h)}return h2(e.table.scenegraph.rowHeaderGroup),h2(e.table.scenegraph.rightFrozenGroup),h2(e.table.scenegraph.bodyGroup),e.table.scenegraph.updateNextFrame(),s}function h2(n){var t,e;const i=Zm(n);if(!i)return;const r=Zm(i);if(r&&(n.setAttribute("height",r.attribute.y+r.attribute.height),n.border)){const o=n.border;o.setAttribute("height",r.attribute.y+r.attribute.height-((t=o.attribute.borderTop)!==null&&t!==void 0?t:0)/2-((e=o.attribute.borderBottom)!==null&&e!==void 0?e:0)/2)}}var b4t=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function _4t(n){var t;return b4t(this,void 0,void 0,function*(){let e,i;n.table.scenegraph.bodyGroup.forEachChildren((s,a)=>{s.type==="group"&&(s.needUpdate=!0,s?.forEachChildren(l=>{l.needUpdate=!0}))}),n.table.isAutoRowHeight(n.rowStart)?(e=n.rowStart,i=n.rowEnd):(e=Math.max(n.bodyTopRow,n.screenTopRow-1*n.screenRowCount),i=Math.min(n.bodyBottomRow,n.screenTopRow+2*n.screenRowCount,n.table.rowCount-1));const r=n.table.getAllRowsHeight();as(n.table,e,i);const o=n.table.getAllRowsHeight();r!==o&&n.table.scenegraph.updateContainerHeight(n.table.frozenRowCount,o-r);for(let s=0;s<((t=n.table.frozenColCount)!==null&&t!==void 0?t:0);s++){const a=n.table.scenegraph.getColGroup(s);a?.setAttribute("chartInstance",void 0);for(let l=n.rowStart;l<=n.rowEnd;l++)n.table.scenegraph.updateCellContent(s,l);for(let l=n.table.rowCount-n.table.bottomFrozenRowCount;l<n.table.rowCount;l++)n.table.scenegraph.updateCellContent(s,l)}for(let s=n.colStart;s<=n.colEnd;s++){const a=n.table.scenegraph.getColGroup(s);a?.setAttribute("chartInstance",void 0);for(let l=n.table.rowCount-n.table.bottomFrozenRowCount;l<n.table.rowCount;l++)n.table.scenegraph.updateCellContent(s,l)}for(let s=n.table.colCount-n.table.rightFrozenColCount;s<n.table.colCount;s++){const a=n.table.scenegraph.getColGroup(s);a?.setAttribute("chartInstance",void 0);for(let l=n.rowStart;l<=n.rowEnd;l++)n.table.scenegraph.updateCellContent(s,l);for(let l=n.table.rowCount-n.table.bottomFrozenRowCount;l<n.table.rowCount;l++)n.table.scenegraph.updateCellContent(s,l)}Qm(e,i,n),n.table.isAutoRowHeight(e)&&fo(n.bodyLeftCol,n.bodyRightCol,e,i,n.table,n.rowEnd>n.bodyBottomRow-(n.rowEnd-n.rowStart+1)?"down":"up"),n.rowUpdatePos=n.rowStart,n.rowUpdateDirection=n.rowEnd>n.bodyBottomRow-(n.rowEnd-n.rowStart+1)?"down":"up",n.table.scenegraph.updateNextFrame(),n.table.isAutoRowHeight(n.rowStart)||(yield n.progress())})}var C4t=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function w4t(n){return C4t(this,void 0,void 0,function*(){n.table.scenegraph.bodyGroup.forEachChildren((i,r)=>{i.type==="group"&&(i.needUpdate=!0,i?.forEachChildren(o=>{o.needUpdate=!0}))});const t=Math.max(n.bodyLeftCol,n.screenLeftCol-1*n.screenColCount),e=Math.min(n.bodyRightCol,n.screenLeftCol+2*n.screenColCount);ls(n.table,t,e);for(let i=n.colStart;i<=n.colEnd;i++){const r=n.table.scenegraph.getColGroup(i);r?.setAttribute("chartInstance",void 0);for(let o=n.table.rowCount-n.table.bottomFrozenRowCount;o<n.table.rowCount;o++)n.table.scenegraph.updateCellContent(i,o)}for(let i=n.table.colCount-n.table.rightFrozenColCount;i<n.table.colCount;i++){const r=n.table.scenegraph.getColGroup(i);r?.setAttribute("chartInstance",void 0);for(let o=n.rowStart;o<=n.rowEnd;o++)n.table.scenegraph.updateCellContent(i,o);for(let o=n.table.rowCount-n.table.bottomFrozenRowCount;o<n.table.rowCount;o++)n.table.scenegraph.updateCellContent(i,o)}Jm(t,e,n),n.colUpdatePos=n.colStart,n.colUpdateDirection=n.colEnd>n.bodyRightCol-(n.colEnd-n.colStart+1)?"right":"left",n.table.scenegraph.updateNextFrame(),yield n.progress()})}function HD(n){const{changedCells:t}=n.internalProps.stick;return t.forEach(e=>{n.scenegraph.getCell(e.col,e.row).forEachChildren(i=>{i.setAttributes({dx:e.dx,dy:e.dy})})}),t.clear(),t}function N0(n){const t=HD(n),{scrollTop:e,scrollLeft:i,frozenRowCount:r,frozenColCount:o}=n,s=n.getFrozenRowsHeight(),a=n.getFrozenColsWidth(),{row:l}=n.getRowAt(e+s+1),{col:h}=n.getColAt(i+a+1),u=Math.max(l,n.frozenRowCount),d=Math.max(h,n.frozenColCount),c=n.getAllRowsHeight()>n.tableNoFrameHeight?n.getRowAt(e+n.tableNoFrameHeight-n.getBottomFrozenRowsHeight()-1).row:n.rowCount-n.bottomFrozenRowCount-1,f=n.getAllColsWidth()>n.tableNoFrameWidth?n.getColAt(i+n.tableNoFrameWidth-n.getRightFrozenColsWidth()-1).col:n.colCount-n.rightFrozenColCount-1;if(!(f<0||c<0)){for(let g=0;g<r&&!(f<d);g++)[d,f].forEach(p=>{const v=n._getCellStyle(p,g);v?.textStick&&v?.textStick!=="vertical"&&IV(n.scenegraph.getCell(p,g),a+n.tableX,n.tableNoFrameWidth-n.getRightFrozenColsWidth()+n.tableX,t,v?.textStickBaseOnAlign,n)});for(let g=0;g<o&&!(c<u);g++)[u,c].forEach(p=>{const v=n._getCellStyle(g,p);v?.textStick&&v?.textStick!=="horizontal"&&OV(n.scenegraph.getCell(g,p),s+n.tableY,n.tableNoFrameHeight-n.getBottomFrozenRowsHeight()+n.tableY,t,v?.textStickBaseOnAlign,n)});for(let g=d;g<=f&&!(c<u);g++)[u,c].forEach(p=>{const v=n._getCellStyle(g,p);v?.textStick&&v?.textStick!=="horizontal"&&OV(n.scenegraph.getCell(g,p),s+n.tableY,n.tableNoFrameHeight-n.getBottomFrozenRowsHeight()+n.tableY,t,v?.textStickBaseOnAlign,n)});for(let g=u;g<=c&&!(f<d);g++)[d,f].forEach(p=>{const v=n._getCellStyle(p,g);v?.textStick&&v?.textStick!=="vertical"&&IV(n.scenegraph.getCell(p,g),a+n.tableX,n.tableNoFrameWidth-n.getRightFrozenColsWidth()+n.tableX,t,v?.textStickBaseOnAlign,n)})}}function OV(n,t,e,i,r,o){if(pt(n.mergeStartCol)&&pt(n.mergeStartRow)&&pt(n.mergeEndCol)&&pt(n.mergeEndRow)){const{colStart:s,colEnd:a,rowStart:l,rowEnd:h}=bu(n,o.scenegraph);for(let u=s;u<=a;u++)for(let d=l;d<=h;d++){const c=o.scenegraph.getCell(u,d);c.role==="cell"&&DV(c,t,e,i,r)}}else DV(n,t,e,i,r)}function DV(n,t,e,i,r){var o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w;const C=n.getChildByName("text",!0)||n.getChildByName("image",!0);if(!C)return;if(C.type==="image"){const{image:T}=C.attribute;if(!T||!C.resources||C.resources.get(T).state!=="success")return}const x=(o=C.textBaseline)!==null&&o!==void 0?o:"top";C.AABBBounds.width();const S=C.globalAABBBounds.y1,A=C.globalAABBBounds.y2;if(x==="middle"&&r){const T=n.globalAABBBounds.y1+((a=(s=n.firstChild)===null||s===void 0?void 0:s.attribute.dy)!==null&&a!==void 0?a:0),M=T+((h=(l=n.contentHeight)!==null&&l!==void 0?l:n.attribute.height)!==null&&h!==void 0?h:0);if(T<t||M>e){const R=Math.max(T,t),E=Math.min(M,e),P=C.globalTransMatrix.f-(E+R)/2+C.AABBBounds.height()/2;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(d=(u=n.firstChild)===null||u===void 0?void 0:u.attribute.dx)!==null&&d!==void 0?d:0,dy:(f=(c=n.firstChild)===null||c===void 0?void 0:c.attribute.dy)!==null&&f!==void 0?f:0}),n.forEachChildren(B=>{var k;B.setAttribute("dy",((k=B.attribute.dy)!==null&&k!==void 0?k:0)-P+2)})}}else if(S<t){const T=S-t;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(p=(g=n.firstChild)===null||g===void 0?void 0:g.attribute.dx)!==null&&p!==void 0?p:0,dy:(m=(v=n.firstChild)===null||v===void 0?void 0:v.attribute.dy)!==null&&m!==void 0?m:0}),n.forEachChildren(M=>{var R;M.setAttribute("dy",((R=M.attribute.dy)!==null&&R!==void 0?R:0)-T+2)})}else if(A>e){const T=A-e;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(b=(y=n.firstChild)===null||y===void 0?void 0:y.attribute.dx)!==null&&b!==void 0?b:0,dy:(w=(_=n.firstChild)===null||_===void 0?void 0:_.attribute.dy)!==null&&w!==void 0?w:0}),n.forEachChildren(M=>{var R;M.setAttribute("dy",((R=M.attribute.dy)!==null&&R!==void 0?R:0)-T)})}}function IV(n,t,e,i,r,o){if(pt(n.mergeStartCol)&&pt(n.mergeStartRow)&&pt(n.mergeEndCol)&&pt(n.mergeEndRow)){const{colStart:s,colEnd:a,rowStart:l,rowEnd:h}=bu(n,o.scenegraph);for(let u=s;u<=a;u++)for(let d=l;d<=h;d++){const c=o.scenegraph.getCell(u,d);c.role==="cell"&&HV(c,t,e,i,r)}}else HV(n,t,e,i,r)}function HV(n,t,e,i,r){var o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C;const x=n.getChildByName("text",!0)||n.getChildByName("image",!0);if(!x)return;if(x.type==="image"){const{image:M}=x.attribute;if(!M||!x.resources||x.resources.get(M).state!=="success")return}const S=(s=(o=x.attribute.textAlign)!==null&&o!==void 0?o:x.textAlign)!==null&&s!==void 0?s:"left";x.AABBBounds.width();const A=x.globalAABBBounds.x1,T=x.globalAABBBounds.x2;if(S==="center"&&r){const M=n.globalAABBBounds.x1+((l=(a=n.firstChild)===null||a===void 0?void 0:a.attribute.dx)!==null&&l!==void 0?l:0),R=M+((u=(h=n.contentWidth)!==null&&h!==void 0?h:n.attribute.width)!==null&&u!==void 0?u:0);if(M<t||R>e){const E=Math.max(M,t),P=Math.min(R,e),B=x.globalTransMatrix.e-(P+E)/2;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(c=(d=n.firstChild)===null||d===void 0?void 0:d.attribute.dx)!==null&&c!==void 0?c:0,dy:(g=(f=n.firstChild)===null||f===void 0?void 0:f.attribute.dy)!==null&&g!==void 0?g:0}),n.forEachChildren(k=>{var L;k.setAttribute("dx",((L=k.attribute.dx)!==null&&L!==void 0?L:0)-B+2)})}}else if(A<t){const M=A-t;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(v=(p=n.firstChild)===null||p===void 0?void 0:p.attribute.dx)!==null&&v!==void 0?v:0,dy:(y=(m=n.firstChild)===null||m===void 0?void 0:m.attribute.dy)!==null&&y!==void 0?y:0}),n.forEachChildren(R=>{var E;R.setAttribute("dx",((E=R.attribute.dx)!==null&&E!==void 0?E:0)-M+2)})}else if(T>e){const M=T-e;!i.has(`${n.col}-${n.row}`)&&i.set(`${n.col}-${n.row}`,{col:n.col,row:n.row,dx:(_=(b=n.firstChild)===null||b===void 0?void 0:b.attribute.dx)!==null&&_!==void 0?_:0,dy:(C=(w=n.firstChild)===null||w===void 0?void 0:w.attribute.dy)!==null&&C!==void 0?C:0}),n.forEachChildren(R=>{var E;R.setAttribute("dx",((E=R.attribute.dx)!==null&&E!==void 0?E:0)-M)})}}function Rx(n){var t,e;const i=n.internalProps.layoutMap.headerObjects,r=n.internalProps.layoutMap.columnObjects;for(let o=0;o<i.length;o++){const s=i[o];if(s&&(!((t=s.style)===null||t===void 0)&&t.textStick))return!0}for(let o=0;o<r.length;o++){const s=r[o];if(s&&(!((e=s.style)===null||e===void 0)&&e.textStick))return!0}return!!(n.theme.headerStyle.textStick||n.theme.rowHeaderStyle.textStick||n.theme.bodyStyle.textStick)}var Do=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};class x4t{constructor(t){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=t,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))):this.table.isAutoRowHeight(t.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)):(this.table.widthMode==="autoWidth"||(this.rowLimit=Math.max(200,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount),this.table.heightMode==="adaptive"&&(this.rowLimit=this.table.rowCount),this.table.widthMode==="adaptive"&&(this.colLimit=this.table.colCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;const t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;const e=this.table.defaultColWidth;this.taskColCount=1*Math.ceil(this.table.tableNoFrameWidth/e);const i=e*t,r=e*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=i/2,this.xLimitRight=r-i/2;const o=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(o/e))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;const t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.bodyTopRow+t-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;const e=this.table.defaultRowHeight;this.taskRowCount=1*Math.ceil(this.table.tableNoFrameHeight/e);const i=e*t,r=e*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=i/2,this.yLimitBottom=r-i/2;const o=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/e),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(o/e))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;const t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.rowStart+t-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;const t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){const t=this.table.defaultColWidth;this.taskColCount=1*Math.ceil(this.table.tableNoFrameWidth/t);const e=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(e/t));const i=this.table.defaultRowHeight;this.taskRowCount=1*Math.ceil(this.table.tableNoFrameHeight/i);const r=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/i),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(r/i))}createGroupForFirstScreen(t,e,i,r,o,s,a,l){a4t(t,e,i,r,o,s,a,l,this)}progress(){return Do(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((t,e)=>{setTimeout(()=>Do(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),N0(this.table),this.table.scenegraph.updateNextFrame(),t())}),16)})})}createRow(){return Do(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return Do(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(t){const e=Math.min(this.totalRow,this.currentRow+t);if(this.table.heightMode!=="adaptive"&&as(this.table,this.currentRow+1,e,!1),this.rowEnd=e,this.table.frozenColCount){let r=0;for(let o=0;o<this.table.frozenColCount;o++){const s=this.table.scenegraph.getColGroup(o),{height:a}=(this.table.isListTable(),CC(s,o,s.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));r=Math.max(r,a),this.table.scenegraph.rowHeaderGroup.setAttribute("height",r)}}if(this.table.rightFrozenColCount){let r=0;for(let o=this.table.colCount-this.table.rightFrozenColCount;o<this.table.colCount;o++){const s=this.table.scenegraph.getColGroup(o),{height:a}=(this.table.isPivotChart(),CC(s,o,s.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));r=Math.max(r,a),this.table.scenegraph.rightFrozenGroup.setAttribute("height",r)}}let i=0;for(let r=this.bodyLeftCol;r<=this.bodyRightCol;r++){const o=this.table.scenegraph.getColGroup(r);if(!o)continue;this.table.rowHeaderLevelCount;const{height:s}=CC(o,r,o.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);i=Math.max(i,s)}this.table.scenegraph.bodyGroup.setAttribute("height",i),this.currentRow=e,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(t){const e=Math.min(this.totalCol,this.currentCol+t);this.table.widthMode!=="adaptive"&&ls(this.table,this.currentCol+1,e),this.colEnd=e;for(let s=0;s<this.table.rowCount;s++){const a=this.highPerformanceGetCell(this.currentCol,s);a.role==="cell"&&pt(a.mergeStartCol)&&a.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(a.col,a.row)}if(this.table.frozenRowCount){const s=this.table.scenegraph.colHeaderGroup.lastChild instanceof re?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,a=s.attribute.x+s.attribute.width,l=s.attribute.y;ji(this.table.scenegraph.colHeaderGroup,a,l,this.currentCol+1,e,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){const s=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof re?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,a=s.attribute.x+s.attribute.width,l=s.attribute.y;ji(this.table.scenegraph.bottomFrozenGroup,a,l,this.currentCol+1,e,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let i=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof re?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);i||(i=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof re?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));const r=i.attribute.x+i.attribute.width,o=i.attribute.y;ji(this.table.scenegraph.bodyGroup,r,o,this.currentCol+1,e,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=e,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(t,e=!1){return Do(this,void 0,void 0,function*(){const i=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,r=this.table.getAllRowsHeight()-i,o=this.table.getTargetRowAt(t+this.table.scenegraph.colHeaderGroup.attribute.height);o&&(this.screenTopRow=o.row),t<i&&this.rowStart===this.bodyTopRow||t>r&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(t),this.updateBody(t-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&this.table.scenegraph.bodyGroup.firstChild.type==="group"&&this.table.scenegraph.bodyGroup.firstChild.childrenCount!==0||this.table.scenegraph.rowHeaderGroup.firstChild&&this.table.scenegraph.rowHeaderGroup.firstChild.type==="group"&&this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount!==0?this.dynamicSetY(t,o,e):(this.updateDeltaY(t),this.updateBody(t-this.deltaY))})}setX(t,e=!1){return Do(this,void 0,void 0,function*(){const i=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,r=this.table.getAllColsWidth()-i,o=this.table.getTargetColAt(t+this.table.scenegraph.rowHeaderGroup.attribute.width);o&&(this.screenLeftCol=o.col),t<i&&this.colStart===this.bodyLeftCol||t>r&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&this.table.scenegraph.bodyGroup.firstChild.type==="group"&&this.table.scenegraph.bodyGroup.firstChild.childrenCount===0?(this.updateDeltaX(t),this.table.scenegraph.setBodyAndColHeaderX(-t+this.deltaX)):this.dynamicSetX(t,o,e)})}dynamicSetY(t,e,i=!1){return Do(this,void 0,void 0,function*(){p4t(t,e,i,this)})}dynamicSetX(t,e,i=!1){return Do(this,void 0,void 0,function*(){u4t(t,e,i,this)})}updateBody(t){this.table.scenegraph.setBodyAndRowHeaderY(-t)}updateRowCellGroupsAsync(){return Do(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(t){const e=Math.min(this.bodyBottomRow,this.rowUpdatePos+t);this.table.isAutoRowHeight(this.rowUpdatePos)&&as(this.table,this.rowUpdatePos,e,!1),Qm(this.rowUpdatePos,e,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(fo(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),fo(0,this.table.frozenColCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),fo(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=e+1}updateBottomFrozenCellGroups(){const t=this.table.rowCount-this.table.bottomFrozenRowCount,e=this.table.rowCount-1;this.table.isAutoRowHeight(t)&&as(this.table,t,e,!1),Qm(t,e,this),this.table.isAutoRowHeight(t)&&(fo(this.bodyLeftCol,this.bodyRightCol,t,e,this.table,this.rowUpdateDirection),fo(0,this.table.frozenColCount-1,t,e,this.table,this.rowUpdateDirection),fo(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,t,e,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){const t=this.table.colCount-this.table.rightFrozenColCount,e=this.table.colCount-1;this.table.widthMode==="autoWidth"&&ls(this.table,t,e,!1),Jm(t,e,this),this.table.isAutoRowHeight(this.rowStart)&&lE(t,e,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return Do(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(t){const e=Math.min(this.bodyRightCol,this.colUpdatePos+t);this.table.widthMode==="autoWidth"&&ls(this.table,this.colUpdatePos,e),Jm(this.colUpdatePos,e,this),this.colUpdatePos=e+1}updateCellGroupPosition(t,e,i){t.row=e,t.mergeStartCol=void 0,t.mergeStartRow=void 0,t.mergeEndCol=void 0,t.mergeEndRow=void 0,t.setAttribute("y",i),t.needUpdate=!0,t.needUpdateForAutoRowHeight=!0}updateCellGroupContent(t){if(!t.needUpdate||t.role!=="cell")return t;const e=this.table.scenegraph.updateCellContent(t.col,t.row);return t.needUpdate=!1,e||t}sortCellVertical(){return Do(this,void 0,void 0,function*(){yield _4t(this)})}sortCellHorizontal(){return Do(this,void 0,void 0,function*(){yield w4t(this)})}highPerformanceGetCell(t,e,i){if(e>=this.table.frozenRowCount&&e<this.table.rowCount-this.table.bottomFrozenRowCount&&(e<this.rowStart||e>this.rowEnd)||t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return Mx;if(this.cellCache.get(t)){const o=this.cellCache.get(t);if((o._next||o._prev)&&Math.abs(o.row-e)<e){let a=hE(o,e);return a&&(i||a.role!=="shadow-cell")||(a=this.table.scenegraph.getCell(t,e,i)),a.row&&this.cellCache.set(t,a),a}const s=this.table.scenegraph.getCell(t,e,i);return s.col===t&&s.row&&this.cellCache.set(t,s),s}const r=this.table.scenegraph.getCell(t,e,i);return r.col===t&&r.row&&this.cellCache.set(t,r),r}updateDeltaY(t,e,i){if(this.rowStart===this.bodyTopRow){const r=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if(r.role==="cell"){const o=r.attribute.y;this.deltaY=-o}}else if(this.rowEnd===this.bodyBottomRow){const r=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if(r.role==="cell"){const o=r.attribute.y+r.attribute.height-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-o}}else if(Y(e)&&Y(i)){let r=this.table.scenegraph.highPerformanceGetCell(this.colStart,i,!0);r.role!=="cell"&&(r=this.table.scenegraph.highPerformanceGetCell(0,i,!0));const o=t-this.deltaY,s=e-o,a=r.attribute.y-o+this.table.getFrozenRowsHeight();this.deltaY=s-a}}updateDeltaX(t,e,i){if(this.colStart===this.bodyLeftCol){const r=this.table.scenegraph.getColGroup(this.colStart);if(r){const o=r.attribute.x;this.deltaX=-o}}else if(this.colEnd===this.bodyRightCol){const r=this.table.scenegraph.getColGroup(this.colEnd);if(r){const o=r.attribute.x+r.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-o}}else if(Y(e)&&Y(i)){const r=this.table.scenegraph.getColGroup(i)||this.table.scenegraph.getColGroup(i,!0),o=t-this.deltaX,s=e-o,a=r.attribute.x-o+this.table.getFrozenColsWidth();this.deltaX=s-a}}release(){this.isRelease=!0}}function hE(n,t){if(!n)return null;if(n.row===t)return n;const e=n._prev,i=n._next;return n.row>t&&e&&e.row===n.row-1?hE(e,t):n.row<t&&i&&i.row===n.row+1?hE(i,t):null}function S4t(n,t,e,i,r,o){const s=o.scenegraph;for(let a=n;a<=t;a++){const l=o.getColWidth(a),h=o.scenegraph.getColGroup(a,!0),u=o.scenegraph.getColGroup(a),d=o.scenegraph.getColGroupInBottom(a),c=o.scenegraph.getColGroupInLeftBottomCorner(a),f=o.scenegraph.getColGroupInRightBottomCorner(a);h&&(h.setAttribute("width",l),h.forEachChildren(g=>{g.setAttribute("width",l)})),u&&(u.setAttribute("width",l),u.forEachChildren(g=>{g.setAttribute("width",l)})),d&&(d.setAttribute("width",l),d.forEachChildren(g=>{g.setAttribute("width",l)})),f&&(f.setAttribute("width",l),f.forEachChildren(g=>{g.setAttribute("width",l)})),c&&(c.setAttribute("width",l),c.forEachChildren(g=>{g.setAttribute("width",l)}))}if(s.updateContainer(),r==="column")for(let a=n;a<=t;a++){const l=o.scenegraph.getColGroup(a);l?.setAttribute("chartInstance",void 0);for(let h=0;h<=o.frozenRowCount-1;h++)s.updateCellContent(a,h);for(let h=s.bodyRowStart;h<=s.bodyRowEnd;h++)s.updateCellContent(a,h);for(let h=o.rowCount-o.bottomFrozenRowCount;h<=o.rowCount-1;h++)s.updateCellContent(a,h)}else{for(let a=0;a<=o.frozenColCount-1;a++){const l=o.scenegraph.getColGroup(a);l?.setAttribute("chartInstance",void 0);for(let h=e;h<=i;h++)s.updateCellContent(a,h)}for(let a=s.bodyColStart;a<=s.bodyColEnd;a++){const l=o.scenegraph.getColGroup(a);l?.setAttribute("chartInstance",void 0);for(let h=e;h<=i;h++)s.updateCellContent(a,h)}for(let a=o.colCount-o.rightFrozenColCount;a<=o.colCount-1;a++){const l=o.scenegraph.getColGroup(a);l?.setAttribute("chartInstance",void 0);for(let h=e;h<=i;h++)s.updateCellContent(a,h)}}}function kJ(n){n.customSelectedRangeComponents.forEach((t,e)=>{u2(t,e,n)}),n.selectingRangeComponents.forEach((t,e)=>{u2(t,e,n)}),n.selectedRangeComponents.forEach((t,e)=>{u2(t,e,n)})}function u2(n,t,e){var i,r,o,s,a,l,h,u,d,c;const f=e.table,[g,p,v,m]=t.split("-"),y=parseInt(g,10),b=parseInt(p,10),_=parseInt(v,10),w=parseInt(m,10);let C,x=y,S=b,A=_,T=w;switch(n.role){case"rowHeader":C=f.getBodyVisibleRowRange(),C&&(S=Math.max(b,C.rowStart-1),T=Math.min(w,C.rowEnd+1));break;case"columnHeader":case"bottomFrozen":C=f.getBodyVisibleCellRange(),C&&(x=Math.max(y,C.colStart-1),A=Math.min(_,C.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":C=f.getBodyVisibleCellRange(),C&&(S=Math.max(b,C.rowStart-1),T=Math.min(w,C.rowEnd+1));break;default:C=f.getBodyVisibleCellRange(),C&&(S=Math.max(b,C.rowStart-1),T=Math.min(w,C.rowEnd+1),x=Math.max(y,C.colStart-1),A=Math.min(_,C.colEnd+1))}const M=f.getColsWidth(x,A),R=f.getRowsHeight(S,T),E=e.highPerformanceGetCell(x,S).globalAABBBounds;if(n.rect.setAttributes({x:E.x1-e.tableGroup.attribute.x,y:E.y1-e.tableGroup.attribute.y,width:M,height:R,visible:!0}),n.fillhandle){const I=(i=e.table.options.excelOptions)===null||i===void 0?void 0:i.fillHandle;let H,F,G=!0;typeof I=="function"&&(G=I({selectRanges:e.table.stateManager.select.ranges,table:e.table})),_<f.colCount-1?(H=e.highPerformanceGetCell(_,w).globalAABBBounds,F=H.x2-e.tableGroup.attribute.x-3):y===0?(H=e.highPerformanceGetCell(0,w).globalAABBBounds,F=H.x1-e.tableGroup.attribute.x):(H=e.highPerformanceGetCell(y-1,w).globalAABBBounds,F=H.x2-e.tableGroup.attribute.x-3),H=w<f.rowCount-1?e.highPerformanceGetCell(_,w).globalAABBBounds:e.highPerformanceGetCell(_,b-1).globalAABBBounds;const j=H.y2-e.tableGroup.attribute.y-3;(r=n.fillhandle)===null||r===void 0||r.setAttributes({x:F,y:j,width:6,height:6,visible:G})}let P=!!f.frozenColCount&&y===f.frozenColCount;!P&&f.frozenColCount&&f.scrollLeft>0&&y>=f.frozenColCount&&f.getColsWidth(0,y-1)-f.scrollLeft<f.getFrozenColsWidth()&&(P=!0);let B=!!f.rightFrozenColCount&&f.rightFrozenColCount>0&&_===f.colCount-f.rightFrozenColCount-1;!B&&f.rightFrozenColCount&&_<f.colCount-f.rightFrozenColCount&&f.getColsWidth(0,_)-f.scrollLeft>f.tableNoFrameWidth-f.getRightFrozenColsWidth()&&(B=!0);let k=!f.frozenRowCount||b===f.frozenRowCount;!k&&f.frozenRowCount&&f.scrollTop>0&&b>=f.frozenRowCount&&f.getRowsHeight(0,b-1)-f.scrollTop<f.getFrozenRowsHeight()&&(k=!0);let L=!!f.bottomFrozenRowCount&&w===f.rowCount-f.bottomFrozenRowCount-1;!L&&f.bottomFrozenRowCount&&w<f.rowCount-f.bottomFrozenRowCount&&f.getRowsHeight(0,w)-f.scrollTop>f.tableNoFrameHeight-f.getBottomFrozenRowsHeight()&&(L=!0);const{dynamicUpdateSelectionSize:O}=f.theme.selectionStyle;if(P&&(n.rect.attribute.stroke[3]||O)||B&&(n.rect.attribute.stroke[1]||O)||k&&(n.rect.attribute.stroke[0]||O)||L&&(n.rect.attribute.stroke[2]||O)){if(P&&n.rect.attribute.stroke[3]&&e.tableGroup.insertAfter(n.rect,n.role==="columnHeader"?e.cornerHeaderGroup:n.role==="bottomFrozen"?e.leftBottomCornerGroup:e.rowHeaderGroup),L&&n.rect.attribute.stroke[2]&&e.tableGroup.insertAfter(n.rect,n.role==="rowHeader"?e.leftBottomCornerGroup:n.role==="rightFrozen"?e.rightBottomCornerGroup:e.bottomFrozenGroup),k&&n.rect.attribute.stroke[0]&&e.tableGroup.insertAfter(n.rect,n.role==="rowHeader"?e.cornerHeaderGroup:n.role==="rightFrozen"?e.rightTopCornerGroup:e.colHeaderGroup),B&&n.rect.attribute.stroke[1]&&e.tableGroup.insertAfter(n.rect,n.role==="columnHeader"?e.rightTopCornerGroup:n.role==="bottomFrozen"?e.rightBottomCornerGroup:e.rightFrozenGroup),n.rect.attribute.x<f.getFrozenColsWidth()&&f.scrollLeft>0&&(n.role==="body"||n.role==="columnHeader"||n.role==="bottomFrozen")){const I=n.rect.attribute.width-(f.getFrozenColsWidth()-n.rect.attribute.x);n.rect.setAttributes({x:n.rect.attribute.x+(f.getFrozenColsWidth()-n.rect.attribute.x),width:I>0?I:0}),(o=n.fillhandle)===null||o===void 0||o.setAttributes({visible:I>0})}if(f.getRightFrozenColsWidth()>0&&e.rightFrozenGroup.attribute.height>0&&n.rect.attribute.x+n.rect.attribute.width>e.rightFrozenGroup.attribute.x&&(n.role==="body"||n.role==="columnHeader"||n.role==="bottomFrozen")){const I=e.rightFrozenGroup.attribute.x-n.rect.attribute.x;n.rect.setAttributes({x:n.rect.attribute.x,width:I>0?I:0}),(s=n.fillhandle)===null||s===void 0||s.setAttributes({visible:I-M>0})}if(n.rect.attribute.y<e.colHeaderGroup.attribute.height&&f.scrollTop>0&&(n.role==="body"||n.role==="rowHeader"||n.role==="rightFrozen")){const I=n.rect.attribute.height-(e.colHeaderGroup.attribute.height-n.rect.attribute.y);n.rect.setAttributes({y:n.rect.attribute.y+(e.colHeaderGroup.attribute.height-n.rect.attribute.y),height:I>0?I:0}),(a=n.fillhandle)===null||a===void 0||a.setAttributes({visible:I>0})}if(e.bottomFrozenGroup.attribute.width>0&&e.bottomFrozenGroup.attribute.height>0&&n.rect.attribute.y+n.rect.attribute.height>e.bottomFrozenGroup.attribute.y&&(n.role==="body"||n.role==="rowHeader"||n.role==="rightFrozen")){const I=e.bottomFrozenGroup.attribute.y-n.rect.attribute.y;n.rect.setAttributes({y:n.rect.attribute.y,height:I>0?I:0}),(l=n.fillhandle)===null||l===void 0||l.setAttributes({visible:I-R>0})}}else e.tableGroup.insertAfter(n.rect,n.role==="body"?e.bodyGroup:n.role==="columnHeader"?e.colHeaderGroup:n.role==="rowHeader"?e.rowHeaderGroup:n.role==="cornerHeader"?e.cornerHeaderGroup:n.role==="rightTopCorner"?e.rightTopCornerGroup:n.role==="rightFrozen"?e.rightFrozenGroup:n.role==="leftBottomCorner"?e.leftBottomCornerGroup:n.role==="bottomFrozen"?e.bottomFrozenGroup:e.rightBottomCornerGroup);let D=0;typeof n.rect.attribute.lineWidth=="number"&&(D=Math.ceil(n.rect.attribute.lineWidth/2)),_===f.colCount-1&&(Array.isArray(n.rect.attribute.lineWidth)&&(D=Math.ceil(((h=n.rect.attribute.lineWidth[1])!==null&&h!==void 0?h:0)/2)),n.rect.setAttributes({width:n.rect.attribute.width-D})),y===0&&(Array.isArray(n.rect.attribute.lineWidth)&&(D=Math.ceil(((u=n.rect.attribute.lineWidth[3])!==null&&u!==void 0?u:0)/2)),n.rect.setAttributes({x:n.rect.attribute.x+D,width:n.rect.attribute.width-D})),w===f.rowCount-1&&(Array.isArray(n.rect.attribute.lineWidth)&&(D=Math.ceil(((d=n.rect.attribute.lineWidth[2])!==null&&d!==void 0?d:0)/2)),n.rect.setAttributes({height:n.rect.attribute.height-D})),b===0&&(Array.isArray(n.rect.attribute.lineWidth)&&(D=Math.ceil(((c=n.rect.attribute.lineWidth[0])!==null&&c!==void 0?c:0)/2)),n.rect.setAttributes({y:n.rect.attribute.y+D,height:n.rect.attribute.height-D}))}function FV(n,t,e=!0){const i=n.table,r=t.start.col,o=t.start.row,s=t.end.col,a=t.end.row,l=t.skipBodyMerge;let h=Math.max(Math.min(s,r),0),u=Math.max(Math.min(a,o),0),d=Math.min(Math.max(s,r),i.colCount-1),c=Math.min(Math.max(a,o),i.rowCount-1);const f=()=>{let x=!1;for(let S=h;S<=d;S++){if(S===h)for(let A=u;A<=c;A++){if(!i.isHeader(S,A)&&l)continue;const T=Ji(i,S,A);if(T&&T.start.col<h){h=T.start.col,x=!0;break}}if(!x&&S===d)for(let A=u;A<=c;A++){if(!i.isHeader(S,A)&&l)continue;const T=Ji(i,S,A);if(T&&Math.min(T.end.col,i.colCount-1)>d){d=T.end.col,x=!0;break}}if(x)break}if(!x)for(let S=u;S<=c;S++){if(S===u)for(let A=h;A<=d;A++){if(!i.isHeader(A,S)&&l)continue;const T=Ji(i,A,S);if(T&&T.start.row<u){u=T.start.row,x=!0;break}}if(!x&&S===c)for(let A=h;A<=d;A++){if(!i.isHeader(A,S)&&l)continue;const T=Ji(i,A,S);if(T&&Math.min(T.end.row,i.rowCount-1)>c){c=T.end.row,x=!0;break}}if(x)break}x&&f()};e&&(f(),t.start.col>t.end.col?(t.start.col=Math.max(h,d),t.end.col=Math.min(h,d)):(t.start.col=Math.min(h,d),t.end.col=Math.max(h,d)),t.start.row>t.end.row?(t.start.row=Math.max(u,c),t.end.row=Math.min(u,c)):(t.start.row=Math.min(u,c),t.end.row=Math.max(u,c))),n.selectingRangeComponents.forEach((x,S)=>{var A;x.rect.delete(),(A=x.fillhandle)===null||A===void 0||A.delete()}),n.selectingRangeComponents=new Map;const{needRowHeader:g,needRightRowHeader:p,needColumnHeader:v,needBottomColumnHeader:m,needBody:y,needCornerHeader:b,needRightTopCornerHeader:_,needLeftBottomCornerHeader:w,needRightBottomCornerHeader:C}=gJ(h,u,d,c,i);if(b){const x=Math.min(d,i.frozenColCount-1),S=Math.min(c,i.frozenRowCount-1),A=[!0,!v,!g,!0];n.createCellSelectBorder(h,u,x,S,"cornerHeader",`${h}${u}${d}${c}`,A)}if(_){const x=Math.max(h,i.colCount-i.rightFrozenColCount),S=Math.min(c,i.frozenRowCount-1),A=[!0,!0,!p,!v];n.createCellSelectBorder(x,u,d,S,"rightTopCorner",`${h}${u}${d}${c}`,A)}if(w){const x=Math.min(d,i.frozenColCount-1),S=Math.max(u,i.rowCount-i.bottomFrozenRowCount),A=[!g,!m,!0,!0];n.createCellSelectBorder(h,S,x,c,"leftBottomCorner",`${h}${u}${d}${c}`,A)}if(C){const x=Math.max(h,i.colCount-i.rightFrozenColCount),S=Math.max(u,i.rowCount-i.bottomFrozenRowCount),A=[!p,!0,!0,!m];n.createCellSelectBorder(x,S,d,c,"rightBottomCorner",`${h}${u}${d}${c}`,A)}if(v){const x=Math.max(h,i.frozenColCount),S=Math.min(d,i.colCount-i.rightFrozenColCount-1),A=Math.min(c,i.frozenRowCount-1),T=[!0,!_,!y,!b];n.createCellSelectBorder(x,u,S,A,"columnHeader",`${h}${u}${d}${c}`,T)}if(m){const x=Math.max(h,i.frozenColCount),S=Math.min(d,i.colCount-i.rightFrozenColCount-1),A=Math.max(u,i.rowCount-i.bottomFrozenRowCount),T=[!y,!C,!0,!w];n.createCellSelectBorder(x,A,S,c,"bottomFrozen",`${h}${u}${d}${c}`,T)}if(g){const x=Math.max(u,i.frozenRowCount),S=Math.min(c,i.rowCount-i.bottomFrozenRowCount-1),A=Math.min(d,i.frozenColCount-1),T=[!b,!y,!w,!0];n.createCellSelectBorder(h,x,A,S,"rowHeader",`${h}${u}${d}${c}`,T)}if(p){const x=Math.max(u,i.frozenRowCount),S=Math.min(c,i.rowCount-i.bottomFrozenRowCount-1),A=Math.max(h,i.colCount-i.rightFrozenColCount),T=[!_,!0,!C,!y];n.createCellSelectBorder(A,x,d,S,"rightFrozen",`${h}${u}${d}${c}`,T)}if(y){const x=Math.max(h,i.frozenColCount),S=Math.max(u,i.frozenRowCount),A=Math.min(d,i.colCount-i.rightFrozenColCount-1),T=Math.min(c,i.rowCount-i.bottomFrozenRowCount-1),M=[!v,!p,!m,!g];n.createCellSelectBorder(x,S,A,T,"body",`${h}${u}${d}${c}`,M)}}function zV(n){n.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)}),n.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)})}function NV(n){n.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)}),n.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)})}function A4t(n,t,e,i,r,o,s,a){var l,h,u,d,c,f,g,p,v;let m=!!(!((l=n.table.options.excelOptions)===null||l===void 0)&&l.fillHandle);if(((h=n.table.stateManager.select.ranges)===null||h===void 0?void 0:h.length)>1)m=!1,n.removeFillHandleFromSelectComponents();else if(((u=n.table.stateManager.select.ranges)===null||u===void 0?void 0:u.length)===1){const E=Math.max(n.table.stateManager.select.ranges[0].start.row,n.table.stateManager.select.ranges[0].end.row),P=Math.max(n.table.stateManager.select.ranges[0].start.col,n.table.stateManager.select.ranges[0].end.col);n.table.isHeader(P,E)&&(m=!1)}!Array.isArray(a)||a[1]!==!1&&a[2]!==!1||(m=!1);const y=Math.min(t,i),b=Math.min(e,r),_=Math.max(t,i),w=Math.max(e,r),C=n.highPerformanceGetCell(y,b).globalAABBBounds,x=n.highPerformanceGetCell(_,w).globalAABBBounds,S=n.table.theme,A=(d=S.selectionStyle)===null||d===void 0?void 0:d.cellBorderColor,T=(c=S.selectionStyle)===null||c===void 0?void 0:c.cellBorderLineWidth,M=Ne({pickable:!1,fill:((f=S.selectionStyle)===null||f===void 0?void 0:f.selectionFillMode)!=="replace"&&((p=(g=S.selectionStyle)===null||g===void 0?void 0:g.cellBgColor)!==null&&p!==void 0?p:"rgba(0, 0, 255,0.1)"),lineWidth:T,stroke:a.map(E=>!!E&&A),x:C.x1-n.tableGroup.attribute.x,y:C.y1-n.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:EJ(o,(v=n.table.theme.frameStyle)===null||v===void 0?void 0:v.cornerRadius,t,e,i,r,n.table)});let R;m&&(R=Ne({pickable:!1,fill:A,stroke:A,x:x.x2-3,y:x.y2-3,width:6,height:6,visible:!0})),n.lastSelectId=s,n.selectingRangeComponents.set(`${y}-${b}-${_}-${w}-${s}`,{rect:M,fillhandle:R,role:o}),n.tableGroup.insertAfter(M,o==="body"?n.bodyGroup:o==="columnHeader"?n.colHeaderGroup:o==="rowHeader"?n.rowHeaderGroup:o==="cornerHeader"?n.cornerHeaderGroup:o==="rightTopCorner"?n.rightTopCornerGroup:o==="rightFrozen"?n.rightFrozenGroup:o==="leftBottomCorner"?n.leftBottomCornerGroup:o==="bottomFrozen"?n.bottomFrozenGroup:n.rightBottomCornerGroup),m&&n.tableGroup.insertAfter(R,o==="body"?n.bodyGroup:o==="columnHeader"?n.colHeaderGroup:o==="rowHeader"?n.rowHeaderGroup:o==="cornerHeader"?n.cornerHeaderGroup:o==="rightTopCorner"?n.rightTopCornerGroup:o==="rightFrozen"?n.rightFrozenGroup:o==="leftBottomCorner"?n.leftBottomCornerGroup:o==="bottomFrozen"?n.bottomFrozenGroup:n.rightBottomCornerGroup)}function EJ(n,t,e,i,r,o,s){if(!t)return;const a=Array.isArray(t)?t:[t,t,t,t],l=s.colCount-1,h=s.rowCount-1,u=[0,0,0,0];let d=!1;return e===0&&i===0?(u[0]=a[0],d=!0):r===l&&o===h?(u[2]=a[2],d=!0):e===0&&o===h?(u[3]=a[3],d=!0):r===l&&i===0&&(u[1]=a[1],d=!0),d?u:void 0}function WV(n){n.selectingRangeComponents.forEach((t,e)=>{var i;n.selectedRangeComponents.get(e)&&(n.selectingRangeComponents.get(e).rect.delete(),(i=n.selectingRangeComponents.get(e).fillhandle)===null||i===void 0||i.delete()),n.selectedRangeComponents.set(e,t)}),n.selectingRangeComponents=new Map,n.updateNextFrame()}function T4t(n){n.selectedRangeComponents.forEach((t,e)=>{var i;e.split("-")[4]===n.lastSelectId&&(t.rect.delete(),(i=t.fillhandle)===null||i===void 0||i.delete(),n.selectedRangeComponents.delete(e))})}function VV(n){n.selectedRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),(i=t.fillhandle)===null||i===void 0||i.delete()}),n.selectedRangeComponents=new Map}function LJ(n){n.selectingRangeComponents.forEach((t,e)=>{var i;t.rect.delete(),(i=t.fillhandle)===null||i===void 0||i.delete()}),n.selectingRangeComponents=new Map}function M4t(n){n.selectedRangeComponents.forEach((t,e)=>{var i;(i=t.fillhandle)===null||i===void 0||i.delete(),t.fillhandle=void 0})}function R4t(n,t,e,i,r){var o,s;Rx(i)&&HD(i);const a=i.scenegraph,l=L0(n.map(m=>m.row)).sort((m,y)=>y-m),h=L0(t.map(m=>m.row)).sort((m,y)=>m-y),u=L0(e.map(m=>m.row)).sort((m,y)=>m-y);let d;if(u.length&&(d=c2(u[0]-1,u[u.length-1]+1,a)),h.length){const m=c2(h[0]-1,h[h.length-1]+1,a);d=Y(d)?Y(m)?Math.min(d,m):d:m}if(l.length){const m=c2(l[0]-1,l[l.length-1]+1,a);d=Y(d)?Y(m)?Math.min(d,m):d:m}l.forEach(m=>{B4t(m,a,r)});const c=i.rowHeightsMap;if(l.forEach(m=>{c.delete(m)}),l.length){k4t(a);const m=d2(l[l.length-1]-1,l[0]-l.length+1,a);d=Y(d)?Y(m)?Math.min(d,m):d:m}let f;if(a.table._clearRowRangeHeightsMap(),h.forEach(m=>{const y=P4t(m,a,r);f=f??y,c.insert(m)}),E4t(a),h.length){const m=d2(h[0]-1,h[h.length-1]+1,a);d=Y(d)?Y(m)?Math.min(d,m):d:m}const g=new Set;for(let m=0;m<i.colCount;m++)u.forEach(y=>{if(y<i.frozenRowCount){const b=Ji(a.table,m,y);if(b)for(let _=b.start.col;_<=b.end.col;_++)for(let w=b.start.row;w<=b.end.row;w++){const C=`${_}-${w}`;g.has(C)||(ss(_,w,a.table,!1),g.add(C))}else ss(m,y,a.table,!1)}else if(y>i.rowCount-1||y<a.table.rowCount-a.table.bottomFrozenRowCount&&(y<a.proxy.rowStart||y>a.proxy.rowEnd))OJ(y,a);else{const b=Ji(a.table,m,y);if(b)for(let _=b.start.col;_<=b.end.col;_++)for(let w=b.start.row;w<=b.end.row;w++){const C=`${_}-${w}`;g.has(C)||(ss(_,w,a.table,!1),g.add(C))}else ss(m,y,a.table,!1)}});if(u.length){const m=d2(u[0]-1,u[u.length-1]+1,a);d=Y(d)?Y(m)?Math.min(d,m):d:m}if(pt(f)){for(let m=0;m<Math.max(i.colCount,(o=i.internalProps._oldColCount)!==null&&o!==void 0?o:i.colCount);m++)for(let y=f;y<Math.max(i.rowCount,(s=i.internalProps._oldRowCount)!==null&&s!==void 0?s:i.rowCount);y++){const b=a.highPerformanceGetCell(m,y,!0);b&&(b.needUpdate=!0)}d=Y(d)?Y(f)?Math.min(d,f):d:f}if(pt(d)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,d)),h.length){if(!pt(f)){const m=Math.min(...h);a.proxy.rowUpdatePos=Math.min(m,a.proxy.rowUpdatePos)}a.proxy.rowUpdateDirection="up",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),v()}else l.length&&(L4t(l[l.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),v());a.proxy.progress();const p=i.getRowsHeight(i.frozenRowCount,i.rowCount-1-i.bottomFrozenRowCount);function v(){if(h?.[h?.length-1]>=i.rowCount-i.bottomFrozenRowCount||u?.[u?.length-1]>=i.rowCount-i.bottomFrozenRowCount||l?.[0]>=i.rowCount-i.bottomFrozenRowCount){for(let m=0;m<i.colCount;m++)for(let y=i.rowCount-i.bottomFrozenRowCount;y<i.rowCount;y++){const b=a.highPerformanceGetCell(m,y,!0);b&&(b.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,p-a.bodyGroup.attribute.height)}function B4t(n,t,e){const i=t.proxy;if(n>=i.rowStart&&n<=i.rowEnd&&(OJ(n,t),i.rowEnd--,i.currentRow--),!e){i.bodyBottomRow--;const r=Math.min(i.rowLimit,i.bodyBottomRow-i.bodyTopRow+1);i.totalActualBodyRowCount=r,i.totalRow=Math.min(i.table.rowCount-1,i.rowStart+r-1)}}function P4t(n,t,e){const i=t.proxy;if(!e){i.bodyBottomRow++;const r=Math.min(i.rowLimit,i.bodyBottomRow-i.bodyTopRow+1);i.totalActualBodyRowCount=r,i.totalRow=i.rowStart+r-1}if(!(n<i.rowStart))return n>i.rowEnd?i.rowEnd-i.rowStart+1<i.rowLimit?(i.rowEnd++,i.currentRow++,GV(n,t),n):void 0:(i.rowEnd-i.rowStart+1<i.rowLimit&&(i.rowEnd++,i.currentRow++,GV(n,t)),n)}function k4t(n){function t(e,i){e.row=i;const r=Ji(n.table,e.col,e.row);r?(e.mergeStartCol=r.start.col,e.mergeEndCol=r.end.col,e.mergeStartRow=r.start.row,e.mergeEndRow=r.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}n.bodyGroup.forEachChildren(e=>{let i=n.bodyRowStart;e?.forEachChildren(r=>{t(r,i),i++})}),n.rowHeaderGroup.forEachChildren(e=>{let i=n.bodyRowStart;e?.forEachChildren(r=>{t(r,i),i++})}),n.rightFrozenGroup.forEachChildren(e=>{let i=n.bodyRowStart;e?.forEachChildren(r=>{t(r,i),i++})}),n.bottomFrozenGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount;e?.forEachChildren(r=>{t(r,i),i++})}),n.leftBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount;e?.forEachChildren(r=>{t(r,i),i++})}),n.rightBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount;e?.forEachChildren(r=>{t(r,i),i++})})}function E4t(n){function t(e,i,r){e.row=i,e.setAttribute("y",r);const o=Ji(n.table,e.col,e.row);o?(e.mergeStartCol=o.start.col,e.mergeEndCol=o.end.col,e.mergeStartRow=o.start.row,e.mergeEndRow=o.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}n.bodyGroup.forEachChildren(e=>{let i=n.bodyRowStart,r=n.getCellGroupY(i);e?.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.rowHeaderGroup.forEachChildren(e=>{let i=n.bodyRowStart,r=n.getCellGroupY(i);e?.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.rightFrozenGroup.forEachChildren(e=>{let i=n.bodyRowStart,r=n.getCellGroupY(i);e?.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.bottomFrozenGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount,r=0;e?.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.leftBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount,r=0;e?.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})}),n.rightBottomCornerGroup.forEachChildren(e=>{let i=n.table.rowCount-n.table.bottomFrozenRowCount,r=0;e?.forEachChildren(o=>{t(o,i,r),i++,r+=o.attribute.height})})}function GV(n,t){for(let e=0;e<t.table.colCount;e++){const i=new re({x:0,y:0,width:t.table.getColWidth(e),height:t.table.getRowHeight(n)});if(i.role="cell",i.col=e,i.row=n,i.needUpdate=!0,!i)continue;const r=t.getColGroup(e);if(r)if(r.firstChild&&n<r.firstChild.row)r.insertBefore(i,r.firstChild),r.firstChild.row=r.firstChild.row+1;else if(r.lastChild&&n>r.lastChild.row)r.appendChild(i);else{const o=t.highPerformanceGetCell(e,n,!0);o!==i&&(r.insertBefore(i,o),o&&(o.row=o.row+1),o!==r.lastChild&&r.lastChild&&(r.lastChild.row=r.lastChild.row+1))}}}function OJ(n,t){for(let e=0;e<t.table.colCount;e++){const i=t.getColGroup(e,!1);if(!i)continue;let r;i.forEachChildren(o=>o.row===n&&(r=o,!0)),r&&(i.updateColumnHeight(-r.attribute.height),i.removeChild(r))}}function d2(n,t,e){let i;for(let r=0;r<e.table.colCount;r++){const o=e.table.getCellRange(r,n);let s;o.start.row<=n+1&&o.end.row>=n+1&&(Bx(o,e),s=o.start.row);const a=e.table.getCellRange(r,t);a.start.row<=t+1&&a.end.row>=t+1&&(Bx(a,e),s=a.start.row),Y(s)&&(i=Y(i)?Math.min(i,s):s)}return i}function c2(n,t,e){let i;for(let r=0;r<e.table.colCount;r++){let o;const s=e.highPerformanceGetCell(r,n);s.mergeStartRow&&s.mergeEndRow&&s.mergeEndRow>n&&(Bx({start:{row:s.mergeStartRow,col:e.table.isAutoRowHeight(t)?0:s.mergeStartCol},end:{row:s.mergeEndRow,col:e.table.isAutoRowHeight(t)?e.table.colCount-1:s.mergeEndCol}},e),o=s.mergeStartRow);const a=e.highPerformanceGetCell(r,t);a.mergeStartRow&&a.mergeEndRow&&a.mergeStartRow<t&&(Bx({start:{row:a.mergeStartRow,col:e.table.isAutoRowHeight(t)?0:a.mergeStartCol},end:{row:a.mergeEndRow,col:e.table.isAutoRowHeight(t)?e.table.colCount-1:a.mergeEndCol}},e),o=a.mergeStartRow),Y(o)&&(i=Y(i)?Math.min(i,o):o)}return i}function Bx(n,t){const{start:e,end:i}=n;for(let r=e.col;r<=i.col;r++)for(let o=e.row;o<=i.row;o++){const s=t.highPerformanceGetCell(r,o,!0);s&&(s.needUpdate=!0)}}function L4t(n,t){if(t.table.isHasSeriesNumber())for(let e=n;e<=t.table.rowCount-1;e++)ss(0,e,t.table,!1)}function O4t(n){const{internalProps:t}=n;t.bodyDomContainer=document.createElement("div"),t.bodyDomContainer.id="vtable-body-dom-container",t.bodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bodyDomContainer),t.headerDomContainer=document.createElement("div"),t.headerDomContainer.id="vtable-header-dom-container",t.headerDomContainer.classList.add("table-component-container"),t.element.appendChild(t.headerDomContainer),t.frozenBodyDomContainer=document.createElement("div"),t.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",t.frozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBodyDomContainer),t.frozenHeaderDomContainer=document.createElement("div"),t.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",t.frozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenHeaderDomContainer),t.rightFrozenBodyDomContainer=document.createElement("div"),t.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",t.rightFrozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBodyDomContainer),t.rightFrozenHeaderDomContainer=document.createElement("div"),t.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",t.rightFrozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenHeaderDomContainer),t.frozenBottomDomContainer=document.createElement("div"),t.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",t.frozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBottomDomContainer),t.bottomDomContainer=document.createElement("div"),t.bottomDomContainer.id="vtable-bottom-dom-container",t.bottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bottomDomContainer),t.rightFrozenBottomDomContainer=document.createElement("div"),t.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",t.rightFrozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBottomDomContainer)}function D4t(n){const{headerDomContainer:t,bodyDomContainer:e,frozenBodyDomContainer:i,frozenHeaderDomContainer:r,rightFrozenBodyDomContainer:o,rightFrozenHeaderDomContainer:s,bottomDomContainer:a,frozenBottomDomContainer:l,rightFrozenBottomDomContainer:h}=n.internalProps;if(!(t||e||i||r||o||s||a||l||h))return;const u=n.getAllColsWidth(),d=Math.min(u,n.tableNoFrameWidth),c=n.getFrozenColsWidth(),f=n.getRightFrozenColsWidth(),g=c+f,p=Math.min(u-g,d-g),v=n.getAllRowsHeight(),m=Math.min(v,n.tableNoFrameHeight),y=n.getFrozenRowsHeight(),b=n.getBottomFrozenRowsHeight(),_=y+b,w=Math.min(v-_,m-_);n.frozenColCount>0?(t.style.left=`${n.tableX+c}px`,e.style.left=`${n.tableX+c}px`,a.style.left=`${n.tableX+c}px`):n.frozenColCount===0&&(t.style.left=`${n.tableX}px`,e.style.left=`${n.tableX}px`,a.style.left=`${n.tableX}px`),i.style.left=`${n.tableX}px`,r.style.left=`${n.tableX}px`,t.style.width=`${p}px`,t.style.height=`${y}px`,e.style.top=`${n.tableY}px`,e.style.width=`${p}px`,e.style.height=`${w}px`,e.style.top=`${n.tableY+y}px`,i.style.width=`${c}px`,i.style.height=`${w}px`,i.style.top=`${n.tableY+y}px`,r.style.width=`${c}px`,r.style.height=`${y}px`,r.style.top=`${n.tableY}px`,o.style.width=`${f}px`,o.style.height=`${w}px`,o.style.top=`${n.tableY+y}px`,o.style.left=n.tableX+d-f+"px",s.style.width=`${f}px`,s.style.height=`${y}px`,s.style.top=`${n.tableY}px`,s.style.left=n.tableX+d-f+"px",a.style.width=`${p}px`,a.style.height=`${b}px`,a.style.top=n.tableY+m-b+"px",l.style.width=`${c}px`,l.style.height=`${b}px`,l.style.top=n.tableY+m-b+"px",h.style.width=`${f}px`,h.style.height=`${b}px`,h.style.top=n.tableY+m-b+"px",h.style.left=n.tableX+d-f+"px"}function DJ(n){if(!n.table.reactCustomLayout)return;const{table:t,stage:e}=n,i=e.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:r,renderId:o}=i;for(const s in r){const a=r[s],{graphic:l,wrapContainer:h,renderId:u}=a;if(u!==o)continue;let d;if(n.frozenColCount>t.frozenColCount){const c=wc(l);if(!c)continue;const{col:f,row:g}=c;g>=t.rowCount-t.bottomFrozenRowCount&&f<n.frozenColCount&&f>=t.frozenColCount&&l.attribute.react.container===t.frozenBottomDomContainer?d=t.bottomDomContainer:g>=t.frozenRowCount&&f<n.frozenColCount&&f>=t.frozenColCount&&l.attribute.react.container===t.frozenBodyDomContainer?d=t.bodyDomContainer:g<t.frozenRowCount&&f<n.frozenColCount&&f>=t.frozenColCount&&l.attribute.react.container===t.frozenHeaderDomContainer&&(d=t.headerDomContainer)}else if(n.frozenColCount<t.frozenColCount){const c=wc(l);if(!c)continue;const{col:f,row:g}=c;g>=t.rowCount-t.bottomFrozenRowCount&&f<t.frozenColCount&&f>=n.frozenColCount&&l.attribute.react.container===t.bottomDomContainer?d=t.frozenBottomDomContainer:g>=t.frozenRowCount&&f<t.frozenColCount&&f>=n.frozenColCount&&l.attribute.react.container===t.bodyDomContainer?d=t.frozenBodyDomContainer:g<t.frozenRowCount&&f<t.frozenColCount&&f>=n.frozenColCount&&l.attribute.react.container===t.headerDomContainer&&(d=t.frozenHeaderDomContainer)}d&&(d.appendChild(h),a.nativeContainer=d,a.container=d,l.attribute.react.container=d,i.updateStyleOfWrapContainer(l,e,h,d,l.attribute.react))}}function I4t(n){var t,e,i,r;if(n.table.frozenColCount>n.table.rowHeaderLevelCount){n.rowHeaderGroup.setAttribute("height",n.bodyGroup.attribute.height),n.rowHeaderGroup.setAttribute("y",n.bodyGroup.attribute.y),n.cornerHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height);for(let o=0;o<n.table.frozenColCount-n.table.rowHeaderLevelCount;o++)IJ(n),HJ(n),NJ(n)}else if(n.table.frozenColCount<n.table.rowHeaderLevelCount){n.bodyGroup.setAttribute("height",n.rowHeaderGroup.attribute.height),n.bodyGroup.setAttribute("y",n.rowHeaderGroup.attribute.y),n.colHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height);for(let o=0;o<n.table.rowHeaderLevelCount-n.table.frozenColCount;o++)FJ(n),zJ(n),WJ(n)}n.bodyGroup.setAttribute("x",n.rowHeaderGroup.attribute.width),n.colHeaderGroup.setAttribute("x",n.cornerHeaderGroup.attribute.width),n.updateContainer(),n.updateBorderSizeAndPosition(),n.isPivot||n.table.transpose?n.table.options.frozenColCount?n.component.setFrozenColumnShadow(n.table.frozenColCount-1):n.table.options.frozenColCount&&n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount):(n.component.setFrozenColumnShadow(n.table.frozenColCount-1),n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount)),n.hasFrozen=!0,n.frozenColCount=n.table.frozenColCount,n.frozenRowCount=(r=(e=(t=n.colHeaderGroup.firstChild)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:(i=n.cornerHeaderGroup.firstChild)===null||i===void 0?void 0:i.childrenCount)!==null&&r!==void 0?r:n.table.frozenRowCount}function H4t(n){var t,e,i,r,o,s;if(n.frozenColCount>n.table.frozenColCount){n.bodyGroup.setAttribute("height",n.rowHeaderGroup.attribute.height),n.bodyGroup.setAttribute("y",n.rowHeaderGroup.attribute.y),n.colHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height);for(let a=0;a<n.frozenColCount-n.table.frozenColCount;a++)FJ(n),zJ(n),WJ(n)}else if(n.frozenColCount<n.table.frozenColCount){n.rowHeaderGroup.setAttribute("height",n.bodyGroup.attribute.height),n.rowHeaderGroup.setAttribute("y",n.bodyGroup.attribute.y),n.cornerHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height);for(let a=0;a<n.table.frozenColCount-n.frozenColCount;a++)IJ(n),HJ(n),NJ(n)}DJ(n),n.recreateAllSelectRangeComponents(),n.frozenColCount=n.table.frozenColCount,n.frozenRowCount=(r=(e=(t=n.colHeaderGroup.firstChild)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:(i=n.cornerHeaderGroup.firstChild)===null||i===void 0?void 0:i.childrenCount)!==null&&r!==void 0?r:n.table.frozenRowCount,n.proxy.colStart=(s=(o=n.bodyGroup.firstChild)===null||o===void 0?void 0:o.col)!==null&&s!==void 0?s:n.table.frozenColCount,n.bodyGroup.setAttribute("x",n.rowHeaderGroup.attribute.width),n.colHeaderGroup.setAttribute("x",n.cornerHeaderGroup.attribute.width),n.updateContainer(),n.updateBorderSizeAndPosition(),n.isPivot||n.table.transpose?n.table.options.frozenColCount?n.component.setFrozenColumnShadow(n.table.frozenColCount-1):n.table.options.rightFrozenColCount&&n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount):(n.component.setFrozenColumnShadow(n.table.frozenColCount-1),n.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount)),n.hasFrozen=!0}function IJ(n){const t=n.bodyGroup.firstChild instanceof re?n.bodyGroup.firstChild:null;t&&(n.rowHeaderGroup.appendChild(t),n.rowHeaderGroup.setAttribute("width",n.rowHeaderGroup.attribute.width+t.attribute.width),n.bodyGroup.setAttribute("width",n.bodyGroup.attribute.width-t.attribute.width))}function HJ(n){const t=n.colHeaderGroup.firstChild instanceof re?n.colHeaderGroup.firstChild:null;t&&(n.cornerHeaderGroup.appendChild(t),n.cornerHeaderGroup.setAttribute("width",n.cornerHeaderGroup.attribute.width+t.attribute.width),n.colHeaderGroup.setAttribute("width",n.colHeaderGroup.attribute.width-t.attribute.width))}function FJ(n){var t;const e=n.rowHeaderGroup.lastChild instanceof re?n.rowHeaderGroup.lastChild:(t=n.rowHeaderGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(gs(n.bodyGroup,e,n.bodyGroup.firstChild),n.bodyGroup.setAttribute("width",n.bodyGroup.attribute.width+e.attribute.width),n.rowHeaderGroup.setAttribute("width",n.rowHeaderGroup.attribute.width-e.attribute.width))}function zJ(n){var t;const e=n.cornerHeaderGroup.lastChild instanceof re?n.cornerHeaderGroup.lastChild:(t=n.cornerHeaderGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(gs(n.colHeaderGroup,e,n.colHeaderGroup.firstChild),n.colHeaderGroup.setAttribute("width",n.colHeaderGroup.attribute.width+e.attribute.width),n.cornerHeaderGroup.setAttribute("width",n.cornerHeaderGroup.attribute.width-e.attribute.width))}function NJ(n){const t=n.bottomFrozenGroup.firstChild instanceof re?n.bottomFrozenGroup.firstChild:null;t&&(n.leftBottomCornerGroup.appendChild(t),n.leftBottomCornerGroup.setAttribute("width",n.leftBottomCornerGroup.attribute.width+t.attribute.width),n.bottomFrozenGroup.setAttribute("width",n.bottomFrozenGroup.attribute.width-t.attribute.width),n.table.isPivotChart()&&t.forEachChildren(e=>{e.setAttributes({stroke:!1,fill:!1})}))}function WJ(n){var t;const e=n.leftBottomCornerGroup.lastChild instanceof re?n.leftBottomCornerGroup.lastChild:(t=n.leftBottomCornerGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(gs(n.bottomFrozenGroup,e,n.bottomFrozenGroup.firstChild),n.bottomFrozenGroup.setAttribute("width",n.bottomFrozenGroup.attribute.width+e.attribute.width),n.leftBottomCornerGroup.setAttribute("width",n.leftBottomCornerGroup.attribute.width-e.attribute.width),n.table.isPivotChart()&&e.forEachChildren(i=>{var r,o,s,a;const l=n.table._getCellStyle(i.col,i.row),h=n.table.getCellRange(i.col,i.row),u=yu(l,n.table,h?h.start.col:i.col,h?h.start.row:i.row,ut).theme;i.setAttributes({fill:(o=(r=u?.group)===null||r===void 0?void 0:r.fill)!==null&&o!==void 0?o:void 0,stroke:(a=(s=u?.group)===null||s===void 0?void 0:s.stroke)!==null&&a!==void 0?a:void 0})}))}function F4t(n,t){const{table:e,proxy:i,rightTopCornerGroup:r,rightFrozenGroup:o,rightBottomCornerGroup:s,bottomFrozenGroup:a,bodyGroup:l,colHeaderGroup:h}=t,u=t.table.rightFrozenColCount;if(n>u){for(let c=e.colCount-u-1;c>=e.colCount-n;c--)gs(o,t.getColGroup(c),o.firstChild),gs(r,t.getColGroup(c,!0),r.firstChild),gs(s,t.getColGroupInBottom(c),s.firstChild);let d=0;o.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,r.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,s.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width})}else if(n<u){for(let c=e.colCount-u;c<e.colCount-n;c++){const f=t.getColGroup(c);f.setAttribute("x",l.lastChild.attribute.x+e.getColWidth(l.lastChild.col)),l.appendChild(f);const g=t.getColGroupInRightTopCorner(c);g.setAttribute("x",h.lastChild.attribute.x+e.getColWidth(h.lastChild.col)),h.appendChild(g);const p=t.getColGroupInRightBottomCorner(c);p.setAttribute("x",a.lastChild.attribute.x+e.getColWidth(a.lastChild.col)),a.appendChild(p)}let d=0;o.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,r.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width}),d=0,s.forEachChildren(c=>{c.setAttribute("x",d),d+=c.attribute.width})}o.setAttribute("width",e.getColsWidth(e.colCount-n,e.colCount-1)),r.setAttribute("width",e.getColsWidth(e.colCount-n,e.colCount-1)),s.setAttribute("width",e.getColsWidth(e.colCount-n,e.colCount-1)),e.internalProps.rightFrozenColCount=n,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}function z4t(n,t){const{table:e,proxy:i,bottomFrozenGroup:r,leftBottomCornerGroup:o,rightBottomCornerGroup:s}=t;r.childrenCount||(i.table.isPivotChart()||(ji(o,0,0,0,e.frozenColCount-1,0,-1,"rowHeader",e),ji(s,0,0,e.colCount-e.rightFrozenColCount,e.colCount-1,0,-1,"body",e)),ji(r,0,0,i.colStart,i.colEnd,0,-1,"body",e));const a=t.table.bottomFrozenRowCount;if(n>a){for(let l=0;l<e.frozenColCount;l++){const h=t.getColGroupInLeftBottomCorner(l);for(let d=e.rowCount-a-1;d>=e.rowCount-n;d--)gs(h,t.getCell(l,d,!0),h.firstChild);let u=0;h.forEachChildren(d=>{d.setAttribute("y",u),u+=e.getRowHeight(d.row)})}for(let l=i.colStart;l<=i.colEnd;l++){const h=t.getColGroupInBottom(l);for(let d=e.rowCount-a-1;d>=e.rowCount-n;d--)gs(h,t.getCell(l,d,!0),h.firstChild);let u=0;h.forEachChildren(d=>{d.setAttribute("y",u),u+=e.getRowHeight(d.row)})}if(e.rightFrozenColCount>0)for(let l=e.colCount-e.rightFrozenColCount;l<e.colCount;l++){const h=t.getColGroupInRightBottomCorner(l);for(let d=e.rowCount-a-1;d>=e.rowCount-n;d--)gs(h,t.getCell(l,d,!0),h.firstChild);let u=0;h.forEachChildren(d=>{d.setAttribute("y",u),u+=e.getRowHeight(d.row)})}}else if(n<a){for(let l=0;l<e.rowHeaderLevelCount;l++){const h=t.getColGroup(l);for(let c=e.rowCount-a;c<e.rowCount-n;c++){const f=t.getCell(l,c,!0);f.setAttribute("y",h.lastChild.attribute.y+e.getRowHeight(h.lastChild.row)),h.appendChild(f)}const u=t.getColGroupInLeftBottomCorner(l);let d=0;u.forEachChildren(c=>{c.setAttribute("y",d),d+=e.getRowHeight(c.row)})}for(let l=i.colStart;l<=i.colEnd;l++){const h=t.getColGroup(l);for(let c=e.rowCount-a;c<e.rowCount-n;c++){const f=t.getCell(l,c,!0);f.setAttribute("y",h.lastChild.attribute.y+e.getRowHeight(h.lastChild.row)),h.appendChild(f)}const u=t.getColGroupInBottom(l);let d=0;u.forEachChildren(c=>{c.setAttribute("y",d),d+=e.getRowHeight(c.row)})}if(e.rightFrozenColCount>0)for(let l=e.colCount-e.rightFrozenColCount;l<e.colCount;l++){const h=t.getColGroup(l);for(let c=e.rowCount-a;c<e.rowCount-n;c++){const f=t.getCell(l,c,!0);f.setAttribute("y",h.lastChild.attribute.y+e.getRowHeight(h.lastChild.row)),h.appendChild(f)}const u=t.getColGroupInRightBottomCorner(l);let d=0;u.forEachChildren(c=>{c.setAttribute("y",d),d+=e.getRowHeight(c.row)})}}r.setAttribute("height",e.getRowsHeight(e.rowCount-n,e.rowCount-1)),o.setAttribute("height",e.getRowsHeight(e.rowCount-n,e.rowCount-1)),s.setAttribute("height",e.getRowsHeight(e.rowCount-n,e.rowCount-1)),e.internalProps.bottomFrozenRowCount=n,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}function gs(n,t,e){t&&n&&(e?n.insertBefore(t,e):n.appendChild(t))}function N4t(n){var t,e,i,r,o;if(n.frozenRowCount>n.table.frozenRowCount){n.bodyGroup.setAttribute("width",n.colHeaderGroup.attribute.width),n.bodyGroup.setAttribute("x",n.colHeaderGroup.attribute.x),n.rowHeaderGroup.setAttribute("width",n.cornerHeaderGroup.attribute.width);for(let s=0;s<n.frozenRowCount-n.table.frozenRowCount;s++)$4t(n),j4t(n),U4t(n)}else if(n.frozenRowCount<n.table.frozenRowCount){n.colHeaderGroup.setAttribute("width",n.bodyGroup.attribute.width),n.colHeaderGroup.setAttribute("x",n.bodyGroup.attribute.x),n.cornerHeaderGroup.setAttribute("width",n.rowHeaderGroup.attribute.width);for(let s=0;s<n.table.frozenRowCount-n.frozenRowCount;s++)W4t(n),V4t(n),G4t(n)}DJ(n),n.recreateAllSelectRangeComponents(),n.frozenRowCount=n.table.frozenRowCount,n.frozenColCount=(e=(t=n.rowHeaderGroup)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:0,n.proxy.rowStart=(o=(r=(i=n.bodyGroup.firstChild)===null||i===void 0?void 0:i.firstChild)===null||r===void 0?void 0:r.row)!==null&&o!==void 0?o:n.table.frozenRowCount,n.bodyGroup.setAttribute("y",n.colHeaderGroup.attribute.height),n.rowHeaderGroup.setAttribute("y",n.cornerHeaderGroup.attribute.height),n.updateContainer({needUpdateCellY:!0}),n.updateBorderSizeAndPosition(),n.hasFrozen=!0}function W4t(n){var t;let e=!1;for(let i=0;i<n.bodyGroup.childrenCount;i++){const r=n.bodyGroup.children[i];if(!Op(r))continue;const o=r.firstChild;n.colHeaderGroup.children[i]||ji(n.colHeaderGroup,0,0,o.col,o.col,0,0,"columnHeader",n.table),(t=n.colHeaderGroup.children[i])===null||t===void 0||t.appendChild(o),e||(n.colHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height+o.attribute.height),n.bodyGroup.setAttribute("height",n.bodyGroup.attribute.height-o.attribute.height),e=!0)}}function V4t(n){var t;let e=!1;for(let i=0;i<n.rowHeaderGroup.childrenCount;i++){const r=n.rowHeaderGroup.children[i];if(!Op(r))continue;const o=r.firstChild;n.cornerHeaderGroup.children[i]||ji(n.cornerHeaderGroup,0,0,o.col,o.col,0,0,n.table.isListTable()?"columnHeader":"cornerHeader",n.table),(t=n.cornerHeaderGroup.children[i])===null||t===void 0||t.appendChild(o),e||(n.cornerHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height+o.attribute.height),n.rowHeaderGroup.setAttribute("height",n.rowHeaderGroup.attribute.height-o.attribute.height),e=!0)}}function G4t(n){let t=!1;for(let e=0;e<n.rightFrozenGroup.childrenCount;e++){const i=n.rightFrozenGroup.children[e];if(!Op(i))continue;const r=i.firstChild;n.rightTopCornerGroup.children[e]||ji(n.rightTopCornerGroup,0,0,r.col,r.col,0,0,"columnHeader",n.table),n.rightTopCornerGroup.children[e].appendChild(r),t||(n.rightTopCornerGroup.setAttribute("height",n.rightTopCornerGroup.attribute.height+r.attribute.height),n.rightFrozenGroup.setAttribute("height",n.rightFrozenGroup.attribute.height-r.attribute.height),t=!0)}}function $4t(n){let t=!1;for(let e=0;e<n.colHeaderGroup.childrenCount;e++){const i=n.colHeaderGroup.children[e];if(!Op(i))continue;const r=n.bodyGroup.children[e];if(!r)continue;const o=i.lastChild;gs(r,o,r.firstChild),t||(n.colHeaderGroup.setAttribute("height",n.colHeaderGroup.attribute.height-o.attribute.height),n.bodyGroup.setAttribute("height",n.bodyGroup.attribute.height+o.attribute.height),t=!0)}}function j4t(n){let t=!1;for(let e=0;e<n.cornerHeaderGroup.childrenCount;e++){const i=n.cornerHeaderGroup.children[e];if(!Op(i))continue;const r=n.rowHeaderGroup.children[e];if(!r)continue;const o=i.lastChild;gs(r,o,r.firstChild),t||(n.cornerHeaderGroup.setAttribute("height",n.cornerHeaderGroup.attribute.height-o.attribute.height),n.rowHeaderGroup.setAttribute("height",n.rowHeaderGroup.attribute.height+o.attribute.height),t=!0)}}function U4t(n){let t=!1;for(let e=0;e<n.rightTopCornerGroup.childrenCount;e++){const i=n.rightTopCornerGroup.children[e];if(!Op(i))continue;const r=n.rightFrozenGroup.children[e];if(!r)continue;const o=i.lastChild;gs(r,o,r.firstChild),t||(n.rightTopCornerGroup.setAttribute("height",n.rightTopCornerGroup.attribute.height-o.attribute.height),n.rightFrozenGroup.setAttribute("height",n.rightFrozenGroup.attribute.height+o.attribute.height),t=!0)}}function Op(n){return n instanceof re&&n?.name!=="table-border-rect"}function X4t(n,t){const{table:e}=n,i=e.internalProps.layoutMap,r=t===-1?"all":e.internalProps.columnResizeType;if(r==="column"){const o=n.getColGroup(t),s=n.getColGroup(t,!0),a=n.getColGroupInBottom(t,!0);if(o?.forEachChildren(l=>{Vo(l,e.getColWidth(l.col),e.getRowHeight(l.row))}),s?.forEachChildren(l=>{Vo(l,e.getColWidth(l.col),e.getRowHeight(l.row))}),a?.forEachChildren(l=>{Vo(l,e.getColWidth(l.col),e.getRowHeight(l.row))}),e.widthMode==="adaptive"&&t<e.colCount-1){const l=n.getColGroup(t+1),h=n.getColGroup(t+1,!0),u=n.getColGroupInBottom(t+1,!0);l?.forEachChildren(d=>{Vo(d,e.getColWidth(d.col),e.getRowHeight(d.row))}),h?.forEachChildren(d=>{Vo(d,e.getColWidth(d.col),e.getRowHeight(d.row))}),u?.forEachChildren(d=>{Vo(d,e.getColWidth(d.col),e.getRowHeight(d.row))})}}else{let o,s,a,l=e.rowHeaderLevelCount,h=e.colCount-1;if(r==="indicator")if(i.indicatorsAsCol)o=i.getIndicatorKey(t,e.columnHeaderLevelCount);else{const u=i.getCellHeaderPaths(t,e.columnHeaderLevelCount-1),d=u.colHeaderPaths[u.colHeaderPaths.length-1];s=d.dimensionKey,a=d.value}else if(r==="indicatorGroup"){const u=e.internalProps.layoutMap,d=u.getCellHeaderPaths(e.stateManager.columnResize.col,e.columnHeaderLevelCount),c=u.getHeadNodeByRowOrColDimensions(d.colHeaderPaths.slice(0,d.colHeaderPaths.length-1));l=c.startInTotal+e.frozenColCount,h=c.startInTotal+e.frozenColCount+c.size-1}for(let u=l;u<=h;u++){const d=n.getColGroup(u),c=n.getColGroup(u,!0),f=n.getColGroupInBottom(u,!0);if(d){if(r==="indicator"){const g=i.getIndicatorKey(u,e.columnHeaderLevelCount);if(i.indicatorsAsCol&&g!==o)continue;if(!i.indicatorsAsCol){const p=i.getCellHeaderPaths(u,e.columnHeaderLevelCount-1),v=p?.colHeaderPaths[p.colHeaderPaths.length-1];if(!v||s!==v.dimensionKey||a!==v.value)continue}}d.forEachChildren(g=>{Vo(g,e.getColWidth(g.col),e.getRowHeight(g.row))}),c?.forEachChildren(g=>{Vo(g,e.getColWidth(g.col),e.getRowHeight(g.row))}),f?.forEachChildren(g=>{Vo(g,e.getColWidth(g.col),e.getRowHeight(g.row))})}}}}function Y4t(n,t){var e;const{table:i}=n,r=i.internalProps.layoutMap,o=i.stateManager,s=t===-1?"all":i.internalProps.rowResizeType;let a,l,h,u=i.columnHeaderLevelCount,d=i.rowCount-1;if(s==="indicator")if(r.indicatorsAsCol){const f=r.getCellHeaderPaths(i.rowHeaderLevelCount-1,t),g=(e=f.rowHeaderPaths)===null||e===void 0?void 0:e[f.rowHeaderPaths.length-1];l=g?.dimensionKey,h=g?.value}else a=r.getIndicatorKey(i.rowHeaderLevelCount,t);else if(s==="indicatorGroup"){const f=i.internalProps.layoutMap,g=f.getCellHeaderPaths(i.rowHeaderLevelCount,t),p=f.getHeadNodeByRowOrColDimensions(g.rowHeaderPaths.slice(0,g.rowHeaderPaths.length-1));u=p.startInTotal+i.frozenRowCount,d=p.startInTotal+i.frozenRowCount+p.size-1}const c=[{startCol:n.proxy.colStart,endCol:n.proxy.colEnd}];i.frozenColCount&&c.push({startCol:0,endCol:i.frozenColCount-1}),i.rightFrozenColCount&&c.push({startCol:i.colCount-i.rightFrozenColCount,endCol:i.colCount-1}),c.forEach(({startCol:f,endCol:g})=>{for(let p=f;p<=g;p++)if(s==="row"){const v=n.highPerformanceGetCell(p,t);if(v.role!=="cell")continue;if(Vo(v,i.getColWidth(v.col),i.getRowHeight(v.row)),i.heightMode==="adaptive"&&t<i.rowCount-1){const m=n.highPerformanceGetCell(p,t+1);Vo(m,i.getColWidth(m.col),i.getRowHeight(m.row))}}else for(let v=u;v<=d;v++){if(s==="indicator"){const y=r.getIndicatorKey(o.table.rowHeaderLevelCount,v);if(!r.indicatorsAsCol&&y!==a)continue;if(r.indicatorsAsCol){const b=r.getCellHeaderPaths(o.table.rowHeaderLevelCount-1,v),_=b?.rowHeaderPaths[b.rowHeaderPaths.length-1];if(!_||l!==_.dimensionKey||h!==_.value)continue}}const m=n.highPerformanceGetCell(p,v);m.role==="cell"&&Vo(m,i.getColWidth(m.col),i.getRowHeight(m.row))}})}function uE(n){var t;for(let e=n.proxy.colStart;e<=n.proxy.colEnd;e++){const i=n.getColGroup(e);(t=i?.getChildren())===null||t===void 0||t.forEach(r=>{r.children.forEach(o=>{o.type==="chart"&&(o.cacheCanvas=null,o.addUpdateBoundTag())})})}}function K4t(n,t){const e=n.table;if(e.isPivotChart()){const i=e._selectedDataItemsInChart.length;if((t===null||t?.length===0||Object.keys(t).length===0)&&i===0)return;const r=[];if(Array.isArray(t))t.forEach(o=>{if(o&&o.key!==0&&Object.keys(o).length>0){const s={};for(const a in o)a.startsWith("VGRAMMAR_")||a.startsWith("__VCHART")||(s[a]=o[a]);r.push(s)}});else if(t&&t.key!==0&&Object.keys(t).length>0){const o={};for(const s in t)s.startsWith("VGRAMMAR_")||s.startsWith("__VCHART")||(o[s]=t[s]);r.push(o)}jm(e._selectedDataItemsInChart,r)||(e._selectedDataItemsInChart=r,e.internalProps.layoutMap.updateDataStateToChartInstance(),uE(n),e.scenegraph.updateNextFrame())}}function Vo(n,t,e){n.forEachChildren(i=>{i.type==="chart"&&(i.cacheCanvas=null,i.setAttributes({width:Math.ceil(t-i.attribute.cellPadding[3]-i.attribute.cellPadding[1]),height:Math.ceil(e-i.attribute.cellPadding[0]-i.attribute.cellPadding[2])}))})}function q4t(n){const t=n.table.tableNoFrameWidth,e=n.table.tableNoFrameHeight;n.tableGroup=new re({x:0,y:0,width:t,height:e,clip:!0,pickable:!1}),n.tableGroup.role="table";const i=ba(0,0,!n.table.internalProps.enableTreeStickCell);i.role="col-header",n.colHeaderGroup=i;const r=ba(0,0,!n.table.options.enableTreeStickCell);r.role="corner-header",n.cornerHeaderGroup=r;const o=ba(0,0,!0);o.role="row-header",n.rowHeaderGroup=o;const s=ba(t,0,!0);s.role="body",n.bodyGroup=s;const a=ba(0,0,!0);a.role="right-frozen",n.rightFrozenGroup=a;const l=ba(0,0,!0);l.role="bottom-frozen",n.bottomFrozenGroup=l;const h=ba(0,0);h.role="component",n.componentGroup=h;const u=ba(0,0,!0);u.role="corner-right-top-header",n.rightTopCornerGroup=u;const d=ba(0,0,!0);d.role="corner-right-bottom-header",n.rightBottomCornerGroup=d;const c=ba(0,0,!0);c.role="corner-left-bottom-header",n.leftBottomCornerGroup=c,n.tableGroup.addChild(s),n.tableGroup.addChild(o),n.tableGroup.addChild(l),n.tableGroup.addChild(i),n.tableGroup.addChild(a),n.tableGroup.addChild(d),n.tableGroup.addChild(u),n.tableGroup.addChild(c),n.tableGroup.addChild(r),n.tableGroup.addChild(h)}function ba(n,t,e){return new re({x:0,y:0,width:n,height:t,clip:e!=null&&e,pickable:!1})}function ul(n,t){return n.forEachChildrenSkipChild((e,i)=>{e.setAttribute("x",t),t+=e.attribute.width}),t}function dl(n,t){return n.forEachChildrenSkipChild((e,i)=>{e.setAttribute("y",t),t+=e.attribute.height}),t}function Z4t(n,t,e){n!==-1&&t!==-1&&(la(n,t,i=>i.attribute.visibleTime==="mouseenter_cell",i=>{i.setAttribute("opacity",0);const r=i.parent.getChildByName("icon-back");r&&r.setAttribute("visible",!1)},e),e.updateNextFrame())}function J4t(n,t,e){n!==-1&&t!==-1&&(la(n,t,i=>i.attribute.visibleTime==="mouseenter_cell",i=>{i.setAttribute("opacity",1)},e),e.updateNextFrame())}function Q4t(n,t,e){n!==-1&&t!==-1&&(la(n,t,i=>i.attribute.visibleTime==="click_cell",i=>{i.setAttribute("opacity",0)},e),e.updateNextFrame())}function t6t(n,t,e){n!==-1&&t!==-1&&(la(n,t,i=>i.attribute.visibleTime==="click_cell",i=>{i.setAttribute("opacity",1)},e),e.updateNextFrame())}function e6t(n,t,e,i,r){let o;return r.getCell(n,t).forEachChildren(s=>{s.role&&s.role.startsWith("icon")&&s.containsPoint(e,i,Tm.GLOBAL)&&(o=s)}),o}function i6t(n,t,e,i,r){var o,s;if((n.attribute.backgroundColor||n.attribute.hoverImage)&&la(t,e,a=>a.name===n.name,a=>{var l,h,u,d,c,f,g,p;if(a.attribute.backgroundColor){let v=a.parent.getChildByName("icon-back");v?v.setAttributes({x:((l=a.attribute.x)!==null&&l!==void 0?l:0)+(a.AABBBounds.width()-a.backgroundWidth)/2,y:((h=a.attribute.y)!==null&&h!==void 0?h:0)+(a.AABBBounds.height()-a.backgroundHeight)/2,dx:(u=a.attribute.dx)!==null&&u!==void 0?u:0,dy:(d=a.attribute.dy)!==null&&d!==void 0?d:0,width:a.backgroundWidth,height:a.backgroundHeight,fill:a.attribute.backgroundColor,cornerRadius:5,visible:!0}):(v=Ne({x:((c=a.attribute.x)!==null&&c!==void 0?c:0)+(a.AABBBounds.width()-a.backgroundWidth)/2,y:((f=a.attribute.y)!==null&&f!==void 0?f:0)+(a.AABBBounds.height()-a.backgroundHeight)/2,dx:(g=a.attribute.dx)!==null&&g!==void 0?g:0,dy:(p=a.attribute.dy)!==null&&p!==void 0?p:0,width:a.backgroundWidth,height:a.backgroundHeight,fill:a.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0}),v.name="icon-back"),a.parent.insertBefore(v,a)}a.attribute.hoverImage&&a.attribute.image!==a.attribute.hoverImage&&(a.image=a.attribute.hoverImage)},r),n.tooltip){const{x1:a,x2:l,y1:h,y2:u}=n.globalAABBBounds,d={content:n.tooltip.title,referencePosition:{rect:{left:a,right:l,top:h,bottom:u,width:n.globalAABBBounds.width(),height:n.globalAABBBounds.height()},placement:n.tooltip.placement},disappearDelay:n.tooltip.disappearDelay,style:Object.assign({},(o=r.table.internalProps.theme)===null||o===void 0?void 0:o.tooltipStyle,(s=n.tooltip)===null||s===void 0?void 0:s.style)};r.table.internalProps.tooltipHandler.isBinded(d)||r.table.showTooltip(t,e,d)}}function n6t(n,t,e,i){(n.attribute.backgroundColor||n.attribute.hoverImage)&&la(t,e,r=>r.name===n.name,r=>{const o=r.parent.getChildByName("icon-back");o&&o.setAttribute("visible",!1),r.attribute.hoverImage&&r.attribute.image!==r.attribute.originImage&&(r.image=r.attribute.originImage)},i)}function $V(n,t,e,i,r){const o=n.name;la(e,i,s=>s.name===o,s=>{yo(t,s),s.name=t.name},r),r.updateNextFrame()}function r6t(n,t,e,i){const r=i.getCell(n,t);if(Y(r.mergeStartCol)&&Y(r.mergeStartRow)&&Y(r.mergeEndCol)&&Y(r.mergeEndRow))for(let o=r.mergeStartCol;o<=r.mergeEndCol;o++)for(let s=r.mergeStartRow;s<=r.mergeEndRow;s++){let a;i.getCell(o,s).forEachChildren(l=>l.attribute.funcType==="sort"&&(a=l,!0)),a&&(yo(e,a),a.name=e.name)}else{let o;wD(r,"children",s=>s.attribute.funcType==="sort"&&(o=s,!0)),o&&(yo(e,o),o.name=e.name)}}function o6t(n,t,e,i,r){const o=r.getCellRange(n,t),s=r.getCellRange(e,i);return o.start.col===s.start.col&&o.start.row===s.start.row&&o.end.col===s.end.col&&o.end.row===s.end.row}function s6t(n){const{col:t,row:e,iconMark:i,order:r,oldSortCol:o,oldSortRow:s,oldIconMark:a,scene:l}=n,h=l.table.internalProps.headerHelper.getSortIcon(r,l.table,t,e);if(i&&$V(i,h,t,e,l),!o6t(t,e,o,s,l.table)){const u=l.table.internalProps.headerHelper.getSortIcon("normal",l.table,o,s);a?$V(a,u,o,s,l):r6t(o,s,u,l)}}function a6t(n){for(let t=0;t<n.table.colCount;t++)for(let e=0;e<n.table.columnHeaderLevelCount;e++)la(t,e,i=>i.attribute.funcType==="frozen",i=>{const r=n.table.internalProps.headerHelper.getFrozenIcon(t,e);yo(r,i),i.name=r.name},n)}function l6t(n,t,e){let i;i=e.table.isHeader(n,t)?e.table.internalProps.headerHelper.getHierarchyIcon(n,t):e.table.internalProps.bodyHelper.getHierarchyIcon(n,t),la(n,t,r=>r.attribute.funcType===Fe.collapse||r.attribute.funcType===Fe.expand,r=>{yo(i,r),r.name=i?.name},e)}function dE(n,t,e){n&&n.role!=="empty"&&n.forEachChildren(i=>{i.type==="group"?dE(i,t,e):t(i)&&e(i)})}function la(n,t,e,i,r){const o=r.getCell(n,t);if(o.role==="cell"&&Y(o.mergeStartCol)&&Y(o.mergeStartRow)&&Y(o.mergeEndCol)&&Y(o.mergeEndRow)){const{colStart:s,colEnd:a,rowStart:l,rowEnd:h}=bu(o,r);for(let u=s;u<=a;u++)for(let d=l;d<=h;d++)dE(r.highPerformanceGetCell(u,d),e,i)}else dE(o,e,i)}function h6t(n,t,e){la(n,t,i=>i.attribute.funcType===Fe.dropDown,i=>{i.oldVisibleTime=i.attribute.visibleTime,i.setAttribute("visibleTime","always"),i.setAttribute("opacity",1)},e)}function u6t(n,t,e){la(n,t,i=>i.attribute.funcType===Fe.dropDown,i=>{i.oldVisibleTime&&i.setAttribute("visibleTime",i.oldVisibleTime),i.setAttribute("opacity",i.attribute.visibleTime==="always"?1:0)},e)}function f2(n,t){const{bgColor:e,borderColor:i,borderLineWidth:r,borderLineDash:o}=t,s={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:e};return s.stroke=OD(i,void 0),s.lineWidth=r,o&&(s.lineDash=o),s.lineCap="butt",Array.isArray(i)&&(s.strokeArrayColor=ce(i)),Array.isArray(r)&&(s.strokeArrayWidth=ce(r),s.lineWidth=1),n.setAttributes(s),n.role="corner-frozen",n}function d6t(n,t,e,i){var r,o;Rx(i)&&HD(i);const s=i.scenegraph,a=g2(n.map(p=>p.col)).sort((p,v)=>v-p),l=g2(t.map(p=>p.col)).sort((p,v)=>p-v),h=g2(e.map(p=>p.col)).sort((p,v)=>p-v);a.forEach(p=>{c6t(p,s)});const u=i.colWidthsMap;let d;a.forEach(p=>{u.delAndReorder(p)}),a.length&&jV(s),s.table._clearColRangeWidthsMap(),l.forEach(p=>{const v=f6t(p,s);jV(s),d=d??v,u.addAndReorder(p)}),g6t(s);const c=new Set;if(h.forEach(p=>{for(let v=0;v<i.rowCount;v++){const m=Ji(s.table,p,v);if(m)for(let y=m.start.col;y<=m.end.col;y++)for(let b=m.start.col;b<=m.end.col;b++){const _=`${b}-${v}`;c.has(_)||(ss(b,v,s.table,!1),c.add(_))}else ss(p,v,s.table,!1)}}),pt(d)){for(let p=d;p<Math.max(i.colCount,(r=i.internalProps._oldColCount)!==null&&r!==void 0?r:i.colCount);p++)for(let v=0;v<Math.max(i.rowCount,(o=i.internalProps._oldRowCount)!==null&&o!==void 0?o:i.rowCount);v++){const m=s.highPerformanceGetCell(p,v,!0);m&&(m.needUpdate=!0)}s.proxy.colUpdatePos=d}if(l.length){if(!pt(d)){const p=Math.min(...l);s.proxy.colUpdatePos=p}s.proxy.colUpdateDirection="left",s.proxy.updateColGroups(2*s.proxy.screenColCount),g(),s.proxy.progress()}else a.length&&(s.proxy.updateColGroups(2*s.proxy.screenColCount),g(),s.proxy.progress());const f=i.getColsWidth(i.frozenColCount,i.colCount-1);function g(){if(l?.[l?.length-1]>=i.colCount-i.rightFrozenColCount||h?.[h?.length-1]>=i.colCount-i.rightFrozenColCount||a?.[0]>=i.colCount-i.rightFrozenColCount){for(let p=i.colCount-i.rightFrozenColCount;p<i.colCount;p++)for(let v=0;v<i.rowCount;v++){const m=s.highPerformanceGetCell(p,v,!0);m&&(m.needUpdate=!0)}s.proxy.updateRightFrozenCellGroups()}}s.updateContainerWidth(s.table.frozenColCount,f-s.bodyGroup.attribute.width)}function c6t(n,t){const e=t.proxy;if(n>=t.table.rowHeaderLevelCount&&!(n>=t.table.colCount-t.table.rightFrozenColCount)){const r=t.getColGroup(n,!1);r&&r.parent===t.bodyGroup&&t.bodyGroup.removeChild(r);const o=t.getColGroupInBottom(n);o&&o.parent===t.bottomFrozenGroup&&t.bottomFrozenGroup.removeChild(o);const s=t.getColGroup(n,!0);s&&s.parent===t.colHeaderGroup&&t.colHeaderGroup.removeChild(s)}n>=e.colStart&&n<=e.colEnd&&(e.colEnd--,e.currentCol--),e.bodyRightCol--;const i=Math.min(e.colLimit,e.bodyRightCol-e.bodyLeftCol+1);e.totalActualBodyColCount=i,e.totalCol=e.colStart+i-1}function f6t(n,t){const e=t.proxy;e.bodyRightCol++;const i=Math.min(e.colLimit,e.bodyRightCol-e.bodyLeftCol+1);if(e.totalActualBodyColCount=i,e.totalCol=e.colStart+i-1,!(n<e.colStart))return n>e.colEnd?e.colEnd-e.colStart+1<e.colLimit?(e.colEnd++,e.currentCol++,UV(n,t),n):void 0:(e.colEnd-e.colStart+1<e.colLimit&&(e.colEnd++,e.currentCol++,UV(n,t)),n)}function g2(n){const t=[];for(let e=0;e<n.length;e++)t.indexOf(n[e])===-1&&t.push(n[e]);return t}function jV(n){let t=n.bodyColStart;function e(i){i.col=t;const r=Ji(n.table,i.col,i.row);r&&(i.mergeStartCol=r.start.col,i.mergeStartCol=r.start.col,i.mergeEndCol=r.end.col,i.mergeEndCol=r.end.col),i.role}n.bodyGroup.forEachChildren(i=>{i.col=t,i?.forEachChildren(r=>{e(r)}),t++}),t=n.bodyColStart,n.colHeaderGroup.forEachChildren(i=>{i.col=t,i?.forEachChildren(r=>{e(r)}),t++}),t=n.bodyColStart,n.bottomFrozenGroup.forEachChildren(i=>{i.col=t,i?.forEachChildren(r=>{e(r)}),t++})}function g6t(n){let t=n.bodyColStart,e=n.getCellGroupX(t);function i(r){r.col=t;const o=Ji(n.table,r.col,r.row);o&&(r.mergeStartCol=o.start.col,r.mergeStartCol=o.start.col,r.mergeEndCol=o.end.col,r.mergeEndCol=o.end.col),r.role}n.bodyGroup.forEachChildren(r=>{r.col=t,r?.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.bodyColStart,e=n.getCellGroupX(t),n.colHeaderGroup.forEachChildren(r=>{r.col=t,r?.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.bodyColStart,e=n.getCellGroupX(t),n.bottomFrozenGroup.forEachChildren(r=>{r.col=t,r?.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.table.colCount-n.table.rightFrozenColCount,e=0,n.rightFrozenGroup.forEachChildren(r=>{r.col=t,r?.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.table.colCount-n.table.rightFrozenColCount,e=0,n.rightTopCornerGroup.forEachChildren(r=>{r.col=t,r?.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++}),t=n.table.colCount-n.table.rightFrozenColCount,e=0,n.rightBottomCornerGroup.forEachChildren(r=>{r.col=t,r?.forEachChildren(o=>{i(o)}),r.setAttribute("x",e),e+=r.attribute.width,t++})}function UV(n,t){if(t.colHeaderGroup&&t.table.columnHeaderLevelCount>0){const i=new re({x:0,y:0,width:t.table.getColWidth(n),height:0,clip:!1,pickable:!1});i.role="column",i.col=n;const r=t.getColGroup(n,!0);r?t.colHeaderGroup.insertBefore(i,r):t.colHeaderGroup.appendChild(i),e(i,n,0,t.table.columnHeaderLevelCount-1)}if(t.bodyGroup){const i=new re({x:0,y:0,width:t.table.getColWidth(n),height:0,clip:!1,pickable:!1});i.role="column",i.col=n;const r=t.getColGroup(n,!1);r?t.bodyGroup.insertBefore(i,r):t.bodyGroup.appendChild(i),e(i,n,t.bodyRowStart,t.bodyRowEnd)}if(t.bottomFrozenGroup&&t.table.bottomFrozenRowCount>0){const i=new re({x:0,y:0,width:t.table.getColWidth(n),height:0,clip:!1,pickable:!1});i.role="column",i.col=n;const r=t.getColGroupInBottom(n);r?t.bottomFrozenGroup.insertBefore(i,r):t.bottomFrozenGroup.appendChild(i),e(i,n,t.table.rowCount-t.table.bottomFrozenRowCount,t.table.rowCount-1)}function e(i,r,o,s){for(let a=o;a<=s;a++){const l=new re({x:0,y:0,width:t.table.getColWidth(r),height:t.table.getRowHeight(a)});l.role="cell",l.col=r,l.row=a,l.needUpdate=!0,i.appendChild(l)}}}function p6t(n){var t,e,i,r;if(!n.options.animationAppear)return;let o,s,a,l;n.options.animationAppear===!0?(o=500,s=0,a="one-by-one",l="column"):(o=(t=n.options.animationAppear.duration)!==null&&t!==void 0?t:500,s=(e=n.options.animationAppear.delay)!==null&&e!==void 0?e:0,a=(i=n.options.animationAppear.type)!==null&&i!==void 0?i:"one-by-one",l=(r=n.options.animationAppear.direction)!==null&&r!==void 0?r:"row");const{scenegraph:h,frozenColCount:u,frozenRowCount:d}=n,{colStart:c,colEnd:f,rowStart:g,rowEnd:p}=h.proxy;for(let v=0;v<=f;v++)for(let m=0;m<=p;m++){const y=h.highPerformanceGetCell(v,m);y&&y.role==="cell"&&y.forEachChildren(b=>{b.setAttribute("opacity",0),b.animate().wait(a==="one-by-one"?(l==="row"?m:v)*(o-s):s).to({opacity:1},o,"linear")})}}function v6t(n,t){const{selectedRangeComponents:e}=t;e.forEach((i,r)=>{i.rect.setAttributes(n)}),t.updateNextFrame()}wZ(),Nt.load(qWt),Nt.load(mWt);let m6t=class{constructor(t){let e,i;this._needUpdateContainer=!1,this.table=t,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,hLt(this.table.theme.textPopTipStyle),ye.mode==="node"?(Dt.setEnv("node",t.options.modeParams),e=t.canvasWidth,i=t.canvasHeight):t.options.canvas&&t.options.viewBox?(Dt.setEnv("browser"),e=t.options.viewBox.x2-t.options.viewBox.x1,i=t.options.viewBox.y2-t.options.viewBox.y1):(Dt.setEnv("browser"),e=t.canvas.width,i=t.canvas.height),this.stage=sq(Object.assign({canvas:t.canvas,width:e,height:i,disableDirtyBounds:!1,background:t.theme.underlayBackgroundColor,dpr:t.internalProps.pixelRatio,enableLayout:!0,beforeRender:r=>{this.table.options.beforeRender&&this.table.options.beforeRender(r),this.table.animationManager.ticker.start()},afterRender:r=>{this.table.options.afterRender&&this.table.options.afterRender(r),this.table.fireListeners("after_render",null)},canvasControled:!t.options.canvas,viewBox:t.options.viewBox},t.options.renderOption)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.width)!==null&&e!==void 0?e:0}get height(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.height)!==null&&e!==void 0?e:0}get x(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.x)!==null&&e!==void 0?e:0}get y(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.y)!==null&&e!==void 0?e:0}get bodyRowStart(){var t;return(t=this.proxy.rowStart)!==null&&t!==void 0?t:0}get bodyRowEnd(){var t;return(t=this.proxy.rowEnd)!==null&&t!==void 0?t:this.table.rowCount-1}get bodyColStart(){var t;return(t=this.proxy.colStart)!==null&&t!==void 0?t:0}get bodyColEnd(){var t;return(t=this.proxy.colEnd)!==null&&t!==void 0?t:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),q4t(this)}canvasShowMenu(){this.stage.addEventListener("rightdown",t=>{const e=sn(t);e.eventArgs||(this.table.stateManager.triggerContextMenu(-1,-1,e.abstractPos.x,e.abstractPos.y),this.table.fireListeners(ot.CONTEXTMENU_CANVAS,{event:t,x:e.abstractPos.x,y:e.abstractPos.y,col:-1,row:-1,target:void 0}))})}clearCells(){var t,e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(i=>{i.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),(t=this.proxy)===null||t===void 0||t.release(),(e=this.table.reactCustomLayout)===null||e===void 0||e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new LWt(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(t=!1){t||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(e=>{e.name==="poptipForText"&&this.stage.pluginService.register(e)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new x4t(this.table),Ss(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(f2(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),f2(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),f2(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(t,e,i){var r,o,s,a,l,h;let u;if(u=this.table.rightFrozenColCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e<this.table.frozenRowCount?(r=this.rightTopCornerGroup.getColGroup(t))===null||r===void 0?void 0:r.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<this.table.frozenColCount?(o=this.leftBottomCornerGroup.getColGroup(t))===null||o===void 0?void 0:o.getRowGroup(e):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e>=this.table.rowCount-this.table.bottomFrozenRowCount?(s=this.rightBottomCornerGroup.getColGroup(t))===null||s===void 0?void 0:s.getRowGroup(e):this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?(a=this.rightFrozenGroup.getColGroup(t))===null||a===void 0?void 0:a.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>this.table.rowCount-1-this.table.bottomFrozenRowCount?(l=this.bottomFrozenGroup.getColGroup(t))===null||l===void 0?void 0:l.getRowGroup(e):(h=this.getColGroup(t,e<this.frozenRowCount))===null||h===void 0?void 0:h.getRowGroup(e),u&&u.role==="shadow-cell"&&!i){const d=this.table.getCellRange(t,e);d.start.col===t&&d.start.row===e||(u=this.getCell(d.start.col,d.start.row))}return u||Mx}highPerformanceGetCell(t,e,i){return this.proxy.highPerformanceGetCell(t,e,i)}getColGroup(t,e=!1){let i;return i=t<this.frozenColCount&&e?this.cornerHeaderGroup.getColGroup(t):t<this.frozenColCount?this.rowHeaderGroup.getColGroup(t):e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(t):!e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(t):e?this.colHeaderGroup.getColGroup(t):this.bodyGroup.getColGroup(t),i||void 0}getColGroupInBottom(t,e=!1){var i;if(e){const r=(i=this.getColGroupInLeftBottomCorner(t))!==null&&i!==void 0?i:this.getColGroupInRightBottomCorner(t);if(r)return r}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(t)}getColGroupInLeftBottomCorner(t){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(t)}getColGroupInRightTopCorner(t){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(t)}getColGroupInRightBottomCorner(t){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(t)}getCellSize(t,e){const i=this.getCell(t,e),r=Ji(this.table,t,e);let o=i.attribute.width,s=i.attribute.height;return r&&(o/=r.end.col-r.start.col+1,s/=r.end.row-r.start.row+1),{width:o,height:s}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var t,e,i,r;(((e=(t=this.table.stateManager.select)===null||t===void 0?void 0:t.ranges)===null||e===void 0?void 0:e.length)>0||((r=(i=this.table.stateManager.select)===null||i===void 0?void 0:i.customSelectRanges)===null||r===void 0?void 0:r.length)>0)&&kJ(this)}hideHoverIcon(t,e){Z4t(t,e,this)}showHoverIcon(t,e){J4t(t,e,this)}hideClickIcon(t,e){Q4t(t,e,this)}showClickIcon(t,e){t6t(t,e,this)}getIcon(t,e,i,r){return e6t(t,e,i,r,this)}setIconHoverStyle(t,e,i,r){i6t(t,e,i,r,this)}updateSortIcon(t){const{col:e,row:i,iconMark:r,order:o,oldSortCol:s,oldSortRow:a,oldIconMark:l}=t;s6t({col:e,row:i,iconMark:r,order:o,oldSortCol:s,oldSortRow:a,oldIconMark:l,scene:this})}updateFrozenIcon(t,e){a6t(this)}updateHierarchyIcon(t,e){l6t(t,e,this)}setIconNormalStyle(t,e,i){n6t(t,e,i,this)}residentHoverIcon(t,e){h6t(t,e,this)}resetResidentHoverIcon(t,e){u6t(t,e,this)}deactivateChart(t,e){var i,r;if(t===-1||e===-1)return;const o=this.getCell(t,e);(r=(i=o?.firstChild)===null||i===void 0?void 0:i.deactivate)===null||r===void 0||r.call(i)}activateChart(t,e){var i,r,o;if(t===-1||e===-1)return;const s=this.getCell(t,e);return(r=(i=s?.firstChild)===null||i===void 0?void 0:i.activate)===null||r===void 0||r.call(i,this.table),(o=s?.firstChild)===null||o===void 0?void 0:o.activeChartInstance}removeInteractionBorder(t,e){const i=this.getCell(t,e);i.setAttribute("highlightStroke",void 0),i.setAttribute("highlightStrokeArrayWidth",void 0),i.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(t,e,i,r,o,s,a){A4t(this,t,e,i,r,o,s,a)}moveSelectingRangeComponentsToSelectedRangeComponents(){WV(this)}deleteLastSelectedRangeComponents(){T4t(this)}deleteAllSelectBorder(){VV(this),LJ(this)}updateCellSelectBorder(t,e=!0){FV(this,t,e)}removeFillHandleFromSelectComponents(){M4t(this)}recreateAllSelectRangeComponents(){VV(this),this.table.stateManager.select.ranges.forEach(t=>{FV(this,t),WV(this)})}updateColWidth(t,e,i,r){RWt(this,t,Math.round(e),r),i||this.updateContainer({async:!0})}updateChartSizeForResizeColWidth(t){X4t(this,t)}updateChartSizeForResizeRowHeight(t){Y4t(this,t)}updateChartState(t){this.table.isPivotChart()&&K4t(this,t)}updateCheckboxCellState(t,e,i){var r,o;if(this.table.transpose)(r=this.bodyGroup.children)===null||r===void 0||r.forEach(s=>{var a;(a=s.getChildAt(e))===null||a===void 0||a.getChildren().forEach(l=>{l.name==="checkbox"&&(i==="indeterminate"?(l.setAttribute("indeterminate",!0),l.setAttribute("checked",void 0)):(l.setAttribute("indeterminate",void 0),l.setAttribute("checked",i))),l.name==="checkbox-content"&&(i==="indeterminate"?(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})});else{const s=this.getColGroup(t);(o=s?.children)===null||o===void 0||o.forEach(a=>{a.getChildren().find(l=>{l.name==="checkbox"&&(i==="indeterminate"?(l.setAttribute("indeterminate",!0),l.setAttribute("checked",void 0)):(l.setAttribute("indeterminate",void 0),l.setAttribute("checked",i))),l.name==="checkbox-content"&&(i==="indeterminate"?(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(l._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),l._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}}updateHeaderCheckboxCellState(t,e,i){var r,o;this.table.transpose?(r=this.rowHeaderGroup.children)===null||r===void 0||r.forEach(s=>{s.getChildAt(e).getChildren().forEach(a=>{a.name==="checkbox"&&(i==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i))),a.name==="checkbox-content"&&(i==="indeterminate"?(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})}):(o=this.getColGroup(t,!0).children)===null||o===void 0||o.forEach(s=>{s.getChildren().find(a=>{a.name==="checkbox"&&(i==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",i))),a.name==="checkbox-content"&&(i==="indeterminate"?(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",!0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",void 0)):(a._checkboxGroup.getChildByName("checkbox").setAttribute("indeterminate",void 0),a._checkboxGroup.getChildByName("checkbox").setAttribute("checked",i)))})})}updateAutoColWidth(t){this.table.internalProps._widthResizedColMap.delete(t);const e=this.table.getColWidth(t),i=ag(t,0,this.table.rowCount-1,this.table,!0);i!==e&&this.updateColWidth(t,i-e)}recalculateColWidths(){const t=this.table;t.widthMode==="adaptive"||t.autoFillWidth||t.internalProps.transpose?ls(this.table,0,this.table.colCount-1,!0):(t._clearColRangeWidthsMap(),t.frozenColCount>0&&ls(this.table,0,t.frozenColCount-1,!0),t.rightFrozenColCount>0&&ls(this.table,t.rightFrozenColCount,t.colCount-1,!0),ls(t,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){const t=this.table;t.internalProps.useOneRowHeightFillAll=!1,t.heightMode==="adaptive"||t.autoFillHeight?as(this.table,0,this.table.rowCount-1,!0,!0):(t.frozenRowCount>0&&as(this.table,0,t.frozenRowCount-1,!0,!0),t.bottomFrozenRowCount>0&&as(this.table,t.bottomFrozenRowCount,t.rowCount-1,!0,!0),as(t,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){var t,e;this.proxy.resize(),(this.table.widthMode==="adaptive"||this.table.autoFillWidth)&&(this.table.internalProps._widthResizedColMap.size===0?this.recalculateColWidths():this.dealWidthMode()),this.table.heightMode==="adaptive"?this.table.internalProps._heightResizedRowMap.size===0?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),(this.table.widthMode==="adaptive"||this.table.heightMode==="adaptive"||this.table.autoFillWidth||this.table.autoFillHeight||!((t=this.table.containerFit)===null||t===void 0)&&t.width||!((e=this.table.containerFit)===null||e===void 0)&&e.height)&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p;const v=Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0),m=Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0);let y=v,b=m;if(y=!((t=this.table.containerFit)===null||t===void 0)&&t.width?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,v),b=!((e=this.table.containerFit)===null||e===void 0)&&e.height?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,m),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:y,height:b}),this.tableGroup.border){const _=(i=this.tableGroup.border)===null||i===void 0?void 0:i.attribute;let w,C,x,S;_?.strokeArrayWidth?(w=_.strokeArrayWidth?_.strokeArrayWidth[0]:(r=_.lineWidth)!==null&&r!==void 0?r:0,C=_.strokeArrayWidth?_.strokeArrayWidth[1]:(o=_.lineWidth)!==null&&o!==void 0?o:0,x=_.strokeArrayWidth?_.strokeArrayWidth[2]:(s=_.lineWidth)!==null&&s!==void 0?s:0,S=_.strokeArrayWidth?_.strokeArrayWidth[3]:(a=_.lineWidth)!==null&&a!==void 0?a:0):(w=(l=_?.lineWidth)!==null&&l!==void 0?l:0,C=(h=_?.lineWidth)!==null&&h!==void 0?h:0,x=(u=_?.lineWidth)!==null&&u!==void 0?u:0,S=(d=_?.lineWidth)!==null&&d!==void 0?d:0),this.tableGroup.border.type==="rect"?!((c=this.table.theme.frameStyle)===null||c===void 0)&&c.innerBorder?this.tableGroup.border.setAttributes({x:this.table.tableX+S/2,y:this.table.tableY+w/2,width:this.tableGroup.attribute.width-S/2-C/2,height:this.tableGroup.attribute.height-w/2-x/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-S/2,y:this.table.tableY-w/2,width:this.tableGroup.attribute.width+S/2+C/2,height:this.tableGroup.attribute.height+w/2+x/2}):this.tableGroup.border.type==="group"&&(!((f=this.table.theme.frameStyle)===null||f===void 0)&&f.innerBorder?(this.tableGroup.border.setAttributes({x:this.table.tableX+S/2,y:this.table.tableY+w/2,width:this.tableGroup.attribute.width-S/2-C/2,height:this.tableGroup.attribute.height-w/2-x/2}),(g=this.tableGroup.border.firstChild)===null||g===void 0||g.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-S/2-C/2,height:this.tableGroup.attribute.height-w/2-x/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-S/2,y:this.table.tableY-w/2,width:this.tableGroup.attribute.width+S/2+C/2,height:this.tableGroup.attribute.height+w/2+x/2}),(p=this.tableGroup.border.firstChild)===null||p===void 0||p.setAttributes({x:S/2,y:w/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(t,e,i){e=Math.round(e),yV(this,t,e,i),this.updateContainerHeight(t,e)}updateRowsHeight(t,e,i){for(let r=0;r<t.length;r++){const o=t[r];if(o>=this.proxy.rowStart&&o<=this.proxy.rowEnd){const s=e[r];yV(this,o,Math.round(s),i),this._updateContainerHeight(o,s)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(t,e){t<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(e),this.cornerHeaderGroup.setDeltaWidth(e),this.colHeaderGroup.setDeltaX(e),this.bodyGroup.setDeltaX(e)):(this.colHeaderGroup.setDeltaWidth(e),this.bodyGroup.setDeltaWidth(e)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(t,e){t<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(e),this.cornerHeaderGroup.setDeltaHeight(e),this.rowHeaderGroup.setDeltaY(e),this.bodyGroup.setDeltaY(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(e)):t>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(e),this.bottomFrozenGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(e)):(this.rowHeaderGroup.setDeltaHeight(e),this.bodyGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(e))}updateContainerHeight(t,e){this._updateContainerHeight(t,e),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(t,e){const i=this.table.getColWidth(t);i!==e&&(this.updateColWidth(t,e-i),this.table._clearColRangeWidthsMap(t))}setRowHeight(t,e){const i=this.table.getRowHeight(t);i!==e&&((t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1||t<this.table.frozenRowCount)&&this.updateRowHeight(t,e-i),this.table._clearRowRangeHeightsMap(t))}setX(t,e=!1){this.table.scenegraph.proxy.setX(-t,e)}setY(t,e=!1){this.table.scenegraph.proxy.setY(-t,e)}setBodyAndRowHeaderY(t){var e,i,r,o,s,a;const l=(i=(e=this.bodyGroup.firstChild)===null||e===void 0?void 0:e.firstChild)!==null&&i!==void 0?i:(r=this.rowHeaderGroup.firstChild)===null||r===void 0?void 0:r.firstChild,h=(s=(o=this.bodyGroup.firstChild)===null||o===void 0?void 0:o.lastChild)!==null&&s!==void 0?s:(a=this.rowHeaderGroup.firstChild)===null||a===void 0?void 0:a.lastChild;t===0&&l&&l.row===this.table.frozenRowCount&&l.attribute.y+t<0?t=-l.attribute.y:h&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&h.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&h.attribute.y+h.attribute.height+t<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(t=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-h.attribute.y-h.attribute.height),this.colHeaderGroup.attribute.height+t!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+t),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+t),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+t),this.updateNextFrame())}setBodyAndColHeaderX(t){const e=this.bodyGroup.firstChild,i=this.bodyGroup.lastChild;t===0&&e&&e.col===this.table.frozenColCount&&e.attribute.x+t<0?t=-e.attribute.x:i&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&i.col===this.table.colCount-this.table.rightFrozenColCount-1&&i.attribute.x+i.attribute.width+t<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(t=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-i.attribute.x-i.attribute.width),this.table.getFrozenColsWidth()+t!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.updateNextFrame())}afterScenegraphCreated(){var t;this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),N0(this.table),this.table.options.animationAppear&&p6t(this.table),((t=this.table.options.menu)===null||t===void 0?void 0:t.contextMenuWorkOnlyCell)===!1&&this.canvasShowMenu(),this.updateNextFrame()}dealWidthMode(){const t=this.table;if(t.widthMode==="adaptive"){t._clearColRangeWidthsMap();const s=t.tableNoFrameWidth;let a=0,l=0,h=t.colCount;if(t.widthAdaptiveMode==="only-body"){for(let u=0;u<t.colCount;u++)(u<t.rowHeaderLevelCount||t.isPivotChart()&&u>=t.colCount-t.rightFrozenColCount)&&(a+=t.getColWidth(u));l=t.rowHeaderLevelCount,h=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount}Tx(s-a,l,h,!1,[],t,!0)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();const s=t.tableNoFrameWidth;let a=0,l=0;for(let h=0;h<t.colCount;h++){const u=t.getColWidth(h);(h<t.rowHeaderLevelCount||t.isPivotChart()&&h>=t.colCount-t.rightFrozenColCount)&&(a+=u),l+=u}if(l<s&&l>a){const h=t.rowHeaderLevelCount,u=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount;Tx(s-a,h,u,!1,[],t,!0)}}let e=0;this.bodyGroup.forEachChildrenSkipChild(s=>{e+=s.attribute.width}),this.bodyGroup.setAttribute("width",e);let i=0;this.colHeaderGroup.forEachChildrenSkipChild(s=>{i+=s.attribute.width}),this.colHeaderGroup.setAttribute("width",i);let r=0;this.rowHeaderGroup.forEachChildrenSkipChild(s=>{r+=s.attribute.width}),this.rowHeaderGroup.setAttribute("width",r);let o=0;this.cornerHeaderGroup.forEachChildrenSkipChild(s=>{o+=s.attribute.width}),this.cornerHeaderGroup.setAttribute("width",o),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var t;const e=this.table;if(e.heightMode==="adaptive"){e._clearRowRangeHeightsMap();const i=e.getRowsHeight(0,e.columnHeaderLevelCount-1),r=e.isPivotChart()?e.getBottomFrozenRowsHeight():0,o=e.tableNoFrameHeight-i-r,s=e.columnHeaderLevelCount,a=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount;let l=0;for(let u=s;u<a;u++)l+=e.getRowHeight(u);const h=o/l;for(let u=s;u<a;u++){let d;d=u===a-1?o-e.getRowsHeight(s,a-2):Math.round(e.getRowHeight(u)*h),this.setRowHeight(u,d)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();const i=e.tableNoFrameHeight;let r=0,o=0;for(let s=0;s<e.rowCount;s++){const a=e.getRowHeight(s);(s<e.columnHeaderLevelCount||e.isPivotChart()&&s>=e.rowCount-e.bottomFrozenRowCount)&&(o+=a),r+=a}if(((t=this._dealAutoFillHeightOriginRowsHeight)!==null&&t!==void 0?t:r)<i&&r-o>0){const s=e.columnHeaderLevelCount,a=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,l=(i-o)/(r-o);for(let h=s;h<a;h++){let u;u=h===a-1?i-o-e.getRowsHeight(s,a-2):Math.round(e.getRowHeight(h)*l),this.setRowHeight(h,u)}}}}dealFrozen(){I4t(this)}resetFrozen(){H4t(this)}resetRowFrozen(){N4t(this)}updateCellLayoutWidthCertainWidth(t,e,i){const r=t.attribute.width;let o=!1;return t.forEachChildren((s,a)=>{a+=e;const l=Ji(this.table,i,a);l?s=this.getCell(l.start.col,l.start.row):s.setAttribute("width",r);const h=this.table._getCellStyle(i,a),u=ce(ut("padding",h,i,a,this.table)),d=s.getChildByName("text");let c=0,f=0;if(d)c=d.AABBBounds.height()+(u[0]+u[2]),d.setAttribute("maxLineWidth",r-(u[1]+u[3])),f=d.AABBBounds.height()+(u[0]+u[2]);else{const p=s.getChildAt(1);c=p.AABBBounds.height()+(u[0]+u[2]),p._cellWidth=r-(u[1]+u[3]),p.layout(),f=p.AABBBounds.height()+(u[0]+u[2])}const g=this.table.getRowHeight(a);s.attribute.height!==f&&(s.setAttribute("height",f),(g===c||f>g)&&(o=!0))}),o}updateHeaderPosition(t,e,i,r,o){S4t(t,e,i,r,o,this.table)}updateContainerAttrWidthAndX(){var t,e,i;const r=ul(this.cornerHeaderGroup,0),o=ul(this.rowHeaderGroup,0),s=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?ul(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth((t=this.table.frozenColCount)!==null&&t!==void 0?t:0,this.colHeaderGroup.firstChild.col-1):0):0,a=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?ul(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth((e=this.table.frozenColCount)!==null&&e!==void 0?e:0,this.bodyGroup.firstChild.col-1):0):0,l=ul(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&ul(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth((i=this.table.frozenColCount)!==null&&i!==void 0?i:0,this.bottomFrozenGroup.firstChild.col-1):0),ul(this.leftBottomCornerGroup,0),ul(this.rightTopCornerGroup,0),ul(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(r-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(r-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(s-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(o-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(s-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(l-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(l-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(l-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(a-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainerAttrHeightAndY(){var t,e,i;for(let r=0;r<this.cornerHeaderGroup.children.length;r++)dl(this.cornerHeaderGroup.children[r],0);for(let r=0;r<this.colHeaderGroup.children.length;r++)dl(this.colHeaderGroup.children[r],0);for(let r=0;r<this.rightTopCornerGroup.children.length;r++)dl(this.rightTopCornerGroup.children[r],0);for(let r=0;r<this.rowHeaderGroup.children.length;r++)this.rowHeaderGroup.children[r].firstChild&&dl(this.rowHeaderGroup.children[r],this.rowHeaderGroup.children[r].firstChild.row>0?this.table.getRowsHeight((t=this.table.frozenRowCount)!==null&&t!==void 0?t:0,this.rowHeaderGroup.children[r].firstChild.row-1):0);for(let r=0;r<this.bodyGroup.children.length;r++)this.bodyGroup.children[r].firstChild&&dl(this.bodyGroup.children[r],this.bodyGroup.children[r].firstChild.row>0?this.table.getRowsHeight((e=this.table.frozenRowCount)!==null&&e!==void 0?e:0,this.bodyGroup.children[r].firstChild.row-1):0);for(let r=0;r<this.rightFrozenGroup.children.length;r++)this.rightFrozenGroup.children[r].firstChild&&dl(this.rightFrozenGroup.children[r],this.rightFrozenGroup.children[r].firstChild.row>0?this.table.getRowsHeight((i=this.table.frozenRowCount)!==null&&i!==void 0?i:0,this.rightFrozenGroup.children[r].firstChild.row-1):0);for(let r=0;r<this.leftBottomCornerGroup.children.length;r++)dl(this.leftBottomCornerGroup.children[r],0);for(let r=0;r<this.bottomFrozenGroup.children.length;r++)dl(this.bottomFrozenGroup.children[r],0);for(let r=0;r<this.rightBottomCornerGroup.children.length;r++)dl(this.rightBottomCornerGroup.children[r],0)}updateContainer(t={async:!1,needUpdateCellY:!1}){var e;t.async?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{var i;this.updateContainerSync((i=t.needUpdateCellY)!==null&&i!==void 0&&i)},0)):(this._needUpdateContainer=!0,this.updateContainerSync((e=t.needUpdateCellY)!==null&&e!==void 0&&e))}updateContainerSync(t=!1){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),t&&this.updateContainerAttrHeightAndY(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(t,e){var i;const r=!((i=this.table.getCellRawRecord(t,e))===null||i===void 0)&&i.vtableMerge?"text":this.table.isHeader(t,e)?this.table._getHeaderLayoutMap(t,e).headerType:this.table.getBodyColumnType(t,e),o=this.getCell(t,e);r!=="image"&&r!=="video"||qm(o,t,e,0,0,this.table)}createFrameBorder(){var t,e,i,r,o;this.updateTableSize();const s=!this.isPivot&&!this.table.internalProps.transpose;Ss(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,s?[!0,!0,!0,!1]:void 0),Ss(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),Ss(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,s?[!0,!0,!0,!1]:void 0),Ss(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),!((t=this.table.theme.cornerLeftBottomCellStyle)===null||t===void 0)&&t.frameStyle&&Ss(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,s?[!0,!1,!0,!0]:void 0),!((e=this.table.theme.bottomFrozenStyle)===null||e===void 0)&&e.frameStyle&&Ss(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,s?[!0,!0,!0,!1]:void 0),!((i=this.table.theme.rightFrozenStyle)===null||i===void 0)&&i.frameStyle&&Ss(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),!((r=this.table.theme.cornerRightTopCellStyle)===null||r===void 0)&&r.frameStyle&&Ss(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),!((o=this.table.theme.cornerRightBottomCellStyle)===null||o===void 0)&&o.frameStyle&&Ss(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),Ss(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(t,e,i){const r=this.table.theme.columnResize.resizeHotSpotSize/2;let o;if(!i){const s=this.table.getDrawRange();return e>=s.top&&e<=s.bottom&&(o=this.table.getCellAtRelativePosition(t-r,e),o.col===this.table.colCount-1)?o:{col:-1,row:-1}}return i.stage?(t<i.globalAABBBounds.x1+r?o={col:i.col-1,row:i.row,x:i.globalAABBBounds.x1}:i.globalAABBBounds.x2-r<t&&(o={col:i.col,row:i.row,x:i.globalAABBBounds.x2}),o&&this.table.rightFrozenColCount>0&&o.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(o.col=o.col+1,o.rightFrozen=!0),o||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(t,e,i){const r=this.table.theme.columnResize.resizeHotSpotSize/2;if(i){let o;if(e<i.globalAABBBounds.y1+r?o={col:i.col,row:i.row-1,y:i.globalAABBBounds.y1}:i.globalAABBBounds.y2-r<e&&(o={col:i.col,row:i.row,y:i.globalAABBBounds.y2}),o&&this.table.bottomFrozenRowCount>0&&o.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(o.row=o.row+1,o.bottomFrozen=!0),o)return o}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(t){this.clear?this.table.internalProps.rightFrozenColCount=t:F4t(t,this)}dealWidthBottomFrozen(t){this.clear?this.table.internalProps.bottomFrozenRowCount=t:z4t(t,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),ll(this.bodyGroup),this.rowHeaderGroup.attribute.width,xV(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),ll(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,xV(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),ll(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),ll(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),ll(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),ll(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),ll(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),ll(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),ll(this.rightBottomCornerGroup)),OWt(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(t,e){const i=this.getCell(t,e).getChildByName("text",!0);if(i&&i.type==="text"){if(i.attribute.moreThanMaxCharacters)return this.table.getCellValue(t,e);if(i.cliped)return this.table.getCellValue(t,e)}else if(i&&i.type==="richtext"){const r=i;if(r.attribute.ellipsis&&r._frameCache&&r.attribute.height<r._frameCache.actualHeight)return r.attribute.textConfig.find(o=>o.text),this.table.getCellValue(t,e)}return null}updateDrill(t,e,i,r,o){this.component.drillIcon.update(t,e,i,r,o,this)}updateCellContent(t,e,i=!1){if(!this.clear)return ss(t,e,this.table,void 0,void 0,i)}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(t,e,i=[],r=!0,o){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;const s=L0(e.map(h=>h.row)).sort((h,u)=>h-u),a=L0(i.map(h=>h.row)).sort((h,u)=>h-u),l=this.table.getAllRowsHeight()-[...s,...a].reduce((h,u)=>h+this.table.getRowHeight(u),0)<=this.table.tableNoFrameHeight;if(R4t(t,e,i,this.table,o),r&&this.recalculateColWidths(),this.table.heightMode==="adaptive"||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||l))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let h=0;h<a.length;h++){const u=a[h],d=this.table.rowHeightsMap.get(u),c=qo(u,0,this.table.colCount-1,this.table);(u>=this.proxy.rowStart&&u<=this.proxy.rowEnd||u>=this.table.rowCount-this.table.bottomFrozenRowCount&&u<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(u,c-d)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(t,e,i=[]){d6t(t,e,i,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)ss(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)ss(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)ss(e,t,this.table,!1)}getColumnGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupY(t){return t<this.table.frozenRowCount?this.table.getRowsHeight(0,t-1):t<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.frozenRowCount,t-1):t<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,t-1):0}updateDomContainer(){D4t(this.table)}setLoadingHierarchyState(t,e){const i=this.getCell(t,e),r=i.getChildByName("collapse",!0)||i.getChildByName("expand",!0);if(r){const o=ms()[Un.loadingIconName];o&&yo(o,r,t,e)}}temporarilyUpdateSelectRectStyle(t){v6t(t,this)}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}};function y6t(n,t,e){for(let i=0;i<e.length;i++){const r=e[i];if(fs(r,n,t))return!0}return!1}function b6t(n,t,e,i){for(let r=0;r<e.length;r++){const o=e[r];if(tFt(o,{start:n,end:t}))return!0}return!1}function Dp(n,t,e){const i=n.highPerformanceGetCell(t,e);if(i.role==="cell"&&Y(i.mergeStartCol)&&Y(i.mergeStartRow)&&Y(i.mergeEndCol)&&Y(i.mergeEndRow)){const{colStart:r,colEnd:o,rowStart:s,rowEnd:a}=bu(i,n);for(let l=r;l<=o;l++)for(let h=s;h<=a;h++){const u=n.highPerformanceGetCell(l,h);u.role==="cell"&&u.addUpdateBoundTag()}}else i.addUpdateBoundTag()}function XV(n,t,e,i,r){const o=n.table;for(let a=0;a<o.columnHeaderLevelCount;a++)Dp(n,t,a);const s=n.getColGroup(t);return s?.addUpdateBoundTag(),!0}function YV(n,t,e,i,r,o){const s=n.table;for(let l=0;l<s.columnHeaderLevelCount;l++)Dp(n,t,l);const a=n.getColGroup(t);return a?.addUpdateBoundTag(),!0}function KV(n,t,e,i,r){const o=n.table;for(let s=0;s<o.colCount;s++)Dp(n,s,e);return!0}function qV(n,t,e,i,r,o){const s=n.table;for(let a=0;a<s.colCount;a++)Dp(n,a,e);return!0}function _6t(n,t,e,i,r){return Dp(n,t,e),!0}function C6t(n,t,e,i,r){return Dp(n,t,e),!0}function w6t(n,t,e){var i;const{table:r}=n,{scenegraph:o}=r,{highlightScope:s,singleStyle:a,disableHeader:l,cellPos:h,cellPosContainHeader:u}=n.hover,d=h.col,c=h.row;if(s===Ae.none||l&&(u.col!==t||u.row!==e)){const v=u.col,m=u.row;o.hideHoverIcon(v,m),o.showHoverIcon(t,e),u.col=t,u.row=e}if((l&&r.isHeader(t,e)||s===Ae.none)&&(t=-1,e=-1),d===t&&c===e)return;h.col=t,h.row=e,!((i=n.table.options.customConfig)===null||i===void 0)&&i.disableBuildInChartActive||(o.deactivateChart(d,c),o.activateChart(t,e));let f=!1;const{ranges:g,highlightScope:p}=n.select;if(d!==-1&&c!==-1&&(f=x6t(o,d,c,g,a,s),l||o.hideHoverIcon(d,c)),t===-1||e===-1)return h.col=-1,h.row=-1,void(!f||d===t&&c===e||n.table.scenegraph.updateNextFrame());s===Ae.single?f=!!C6t(o,t,e):s===Ae.row?f=!!qV(o,t,e):s===Ae.column?f=!!YV(o,t):s===Ae.cross&&(f=!!qV(o,t,e),f=!!YV(o,t)),s===Ae.none||l||o.showHoverIcon(t,e),f&&n.table.scenegraph.updateNextFrame()}function x6t(n,t,e,i,r,o,s){let a=!1;return o===Ae.single?a=!!_6t(n,t,e):o===Ae.row?a=!!KV(n,t,e):o===Ae.column?a=!!XV(n,t):o===Ae.cross&&(a=!!KV(n,t,e),a=!!XV(n,t)),a}function S6t(n,t,e){e.frozenColCount>0?n!==e.frozenColCount-1?e.setFrozenColCount(n+1):e.setFrozenColCount(0):e.setFrozenColCount(n+1)}function A6t(n,t,e,i){var r;let o,s=null,a=!1;if(Array.isArray(e.sortState))for(let c=0;c<e.sortState.length&&(o=e.sortState[c],o&&(s=e._getHeaderCellBySortState(o)),s&&(a=ZV(n,t,s.col,s.row,e)),!a);c++);else o=e.sortState,o&&(s=e._getHeaderCellBySortState(o)),s&&(a=ZV(n,t,s.col,s.row,e));const l=e.getHeaderDefine(n,t);if(o&&a&&l?.sort?o.order=o.order==="asc"?"desc":o.order==="desc"?"normal":"asc":l?.sort?o={field:e.getHeaderField(n,t),order:"asc"}:a&&l?.showSort||(o={field:e.getHeaderField(n,t),order:"normal"}),o.event=i,e.fireListeners(ot.SORT_CLICK,o).includes(!1))return;let h=!1,u=e.internalProps.sortState?Array.isArray(e.internalProps.sortState)&&(h=!0)?e.internalProps.sortState:[e.internalProps.sortState]:[];if(Array.isArray(u)){const c=u.findIndex(f=>f.field===o.field);c>=0?u[c]=o:u.push(o)}u=u.filter(c=>c.order!=="normal"),u=e.internalProps.multipleSort&&(h=!0)?u:u.splice(-1),u=h&&u.length?u:u[0],e.internalProps.sortState=u,e.stateManager.setSortState(u),l?.sort&&T6t(u,e),e.internalProps.useOneRowHeightFillAll=!1,e.internalProps.layoutMap.clearCellRangeMap(),e.scenegraph.sortCell();const d=!!(!((r=e.stateManager.select.ranges)===null||r===void 0)&&r.length);e.stateManager.updateSelectPos(-1,-1),e.stateManager.endSelectCells(!0,d)}function T6t(n,t,e){n=Array.isArray(n)||!n?n:[n],t.dataSource.sort((n||[]).map(i=>{var r,o;const s=t.internalProps.layoutMap.headerObjects.find(a=>a&&a.field===i.field);return{field:i.field,order:i.order||"asc",orderFn:typeof((r=s?.define)===null||r===void 0?void 0:r.sort)=="function"?(o=s?.define)===null||o===void 0?void 0:o.sort:Z1}}))}function ZV(n,t,e,i,r){return r._getLayoutCellId(n,t)===r._getLayoutCellId(e,i)}function M6t(n,t,e,i,r,o,s=!0,a=!1){var l,h;const{table:u,interactionState:d}=n,{scenegraph:c}=u,{cellPos:f}=n.select;if(n.select.isSelectAll=o,t!==-1&&e!==-1&&s&&u._makeVisibleCell(t,e),t!==-1&&e!==-1&&s)if(d===Ft.grabing&&n.select.ranges.length>0){const g=n.select.ranges[n.select.ranges.length-1];t>g.start.col&&t>g.end.col&&u._makeVisibleCell(t+1,e),e>g.start.row&&e>g.end.row&&u._makeVisibleCell(t,e+1),t<g.start.col&&t<g.end.col&&u._makeVisibleCell(t-1,e),e<g.start.row&&e<g.end.row&&u._makeVisibleCell(t,e-1)}else u._makeVisibleCell(t,e);if(o){n.select.ranges=[],c.deleteAllSelectBorder();let g=0,p=0;const{disableHeaderSelect:v,disableRowSeriesNumberSelect:m}=((l=u.options.keyboardOptions)===null||l===void 0?void 0:l.selectAllOnCtrlA)||{};v&&(g=u.rowHeaderLevelCount,p=u.columnHeaderLevelCount),(m||v&&u.transpose)&&u.options.rowSeriesNumber&&(g+=1),n.select.ranges.push({start:{col:g,row:p},end:{col:u.colCount-1,row:u.rowCount-1}});const y=n.select.ranges[n.select.ranges.length-1];c.updateCellSelectBorder(y,!1)}else if(f.col===-1||f.row===-1||t!==-1&&e!==-1)if(d!==Ft.default||u.eventManager.isDraging||u.stateManager.isResizeCol()){if((d===Ft.grabing||u.eventManager.isDraging)&&!u.stateManager.isResizeCol()){let g=!0;f.col===-1&&(f.col=t),f.row===-1&&(f.row=e),f.col=t,f.row=e;const p=n.select.ranges[n.select.ranges.length-1];if(p){if(u.internalProps.layoutMap.isSeriesNumberInBody(p.start.col,p.start.row))g=!1,p.end={col:u.colCount-1,row:e};else if(n.fillHandle.isFilling){if(n.fillHandle.direction==="top")if(e===n.fillHandle.beforeFillMinRow&&e===n.fillHandle.beforeFillMaxRow)p.start.row=p.end.row=e;else if(e<=n.fillHandle.beforeFillMinRow){if(p.start.row<p.end.row){const v=p.start.row;p.start.row=p.end.row,p.end.row=v}p.end.row=e}else e===n.fillHandle.beforeFillMaxRow&&(p.start.row>p.end.row?p.start.row=e:p.end.row=e);else if(n.fillHandle.direction==="bottom"){if(e>=n.fillHandle.beforeFillMaxRow){if(p.start.row>p.end.row){const v=p.start.row;p.start.row=p.end.row,p.end.row=v}p.end.row=e}}else if(n.fillHandle.direction==="left")if(t===n.fillHandle.beforeFillMinCol&&t===n.fillHandle.beforeFillMaxCol)p.start.col=p.end.col=t;else if(t<=n.fillHandle.beforeFillMinCol){if(p.start.col<p.end.col){const v=p.start.col;p.start.col=p.end.col,p.end.col=v}p.end.col=t}else t===n.fillHandle.beforeFillMaxCol&&(p.start.col>p.end.col?p.start.col=t:p.end.col=t);else if(n.fillHandle.direction==="right"&&t>=n.fillHandle.beforeFillMaxCol){if(p.start.col>p.end.col){const v=p.start.col;p.start.col=p.end.col,p.end.col=v}p.end.col=t}}else{p.end={col:t,row:e};const v=a?{start:{col:t,row:e},end:{col:t,row:e}}:u.getCellRange(t,e);p.start.col<v.end.col?p.end.col=v.end.col:p.start.col>v.start.col&&(p.end.col=v.start.col),p.start.row<v.end.row?p.end.row=v.end.row:p.start.row>v.start.row&&(p.end.row=v.start.row),n.select.headerSelectMode==="body"&&(u.isRowHeader(t,e)?(p.start.col=u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,p.end.col=u.colCount-1):u.isColumnHeader(t,e)?(p.start.row=u.columnHeaderLevelCount,p.end.row=u.rowCount-1):u.internalProps.layoutMap.isSeriesNumberInBody(t,e)?(p.start.col=u.leftRowSeriesNumberCount,p.end.col=u.colCount-1):u.isCornerHeader(t,e)?(p.start.col=u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,p.start.row=u.columnHeaderLevelCount,p.end.col=u.colCount-1,p.end.row=u.rowCount-1):u.isSeriesNumber(t,e)&&(p.start.col=u.leftRowSeriesNumberCount,p.start.row=u.columnHeaderLevelCount,p.end.col=u.colCount-1,p.end.row=u.rowCount-1)),a&&(p.skipBodyMerge=!0)}p&&p.start.row<=u.rowCount-1&&p.end.row<=u.rowCount-1&&p.start.col<=u.colCount-1&&p.end.col<=u.colCount-1&&c.updateCellSelectBorder(p,g)}}}else{const g=n.select.ranges[n.select.ranges.length-1];if(i&&g){if(n.select.headerSelectMode!=="cell"&&u.isColumnHeader(t,e)){const p=Math.min(g.start.col,g.end.col,t),v=Math.max(g.start.col,g.end.col,t),m=Math.min(g.start.row,g.end.row,e),y=u.rowCount-1;n.select.headerSelectMode==="body"?(g.start={col:p,row:u.columnHeaderLevelCount},g.end={col:v,row:u.rowCount-1}):(g.start={col:p,row:m},g.end={col:v,row:y})}else if(n.select.headerSelectMode!=="cell"&&u.isRowHeader(t,e)){const p=Math.min(g.start.col,g.end.col,t),v=u.colCount-1,m=Math.min(g.start.row,g.end.row,e),y=Math.max(g.start.row,g.end.row,e);n.select.headerSelectMode==="body"?(g.start={col:u.leftRowSeriesNumberCount+u.rowHeaderLevelCount,row:m},g.end={col:u.colCount-1,row:y}):(g.start={col:p,row:m},g.end={col:v,row:y})}else if(n.select.headerSelectMode!=="cell"&&u.isSeriesNumberInBody(t,e)){const p=Math.min(g.start.col,g.end.col,t),v=u.colCount-1,m=Math.min(g.start.row,g.end.row,e),y=Math.max(g.start.row,g.end.row,e);n.select.headerSelectMode==="body"?(g.start={col:u.leftRowSeriesNumberCount,row:m},g.end={col:u.colCount-1,row:y}):(g.start={col:p,row:m},g.end={col:v,row:y})}else g.end={col:t,row:e};i||(g.end=g.start),c.deleteLastSelectedRangeComponents(),c.updateCellSelectBorder(g)}else{let p=!0;if(f.col===-1||f.row===-1||r||(n.select.ranges=[],c.deleteAllSelectBorder()),n.select.headerSelectMode!=="cell"&&u.isColumnHeader(t,e)){const m=u.getCellRange(t,e);n.select.headerSelectMode==="body"?n.select.ranges.push({start:{col:m.start.col,row:u.columnHeaderLevelCount},end:{col:m.end.col,row:u.rowCount-1},skipBodyMerge:!0}):n.select.ranges.push({start:{col:m.start.col,row:m.start.row},end:{col:m.end.col,row:u.rowCount-1},skipBodyMerge:!0})}else if(n.select.headerSelectMode!=="cell"&&u.isRowHeader(t,e)){const m=u.getCellRange(t,e);n.select.headerSelectMode==="body"?n.select.ranges.push({start:{col:u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,row:m.start.row},end:{col:u.colCount-1,row:m.end.row},skipBodyMerge:!0}):n.select.ranges.push({start:{col:m.start.col,row:m.start.row},end:{col:u.colCount-1,row:m.end.row},skipBodyMerge:!0})}else if(u.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){p=!1;const{cornerHeaderSelectMode:m}=n.select;if(m==="body")n.select.ranges.push({start:{col:u.leftRowSeriesNumberCount,row:u.columnHeaderLevelCount},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0});else if(m==="inline"){const y=a?{start:{col:t,row:e},end:{col:t}}:u.getCellRange(t,e);n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:y.end.col,row:u.rowCount-1},skipBodyMerge:!0})}else if(m==="cell"){const y=a?{start:{col:t,row:e},end:{col:t,row:e}}:u.getCellRange(t,e);n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:y.end.col,row:y.end.row},skipBodyMerge:a||void 0})}else n.select.ranges.push({start:{col:0,row:0},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0})}else if(u.internalProps.layoutMap.isSeriesNumberInBody(t,e))p=!1,n.select.headerSelectMode==="body"?n.select.ranges.push({start:{col:u.leftRowSeriesNumberCount,row:e},end:{col:u.colCount-1,row:e},skipBodyMerge:!0}):n.select.ranges.push({start:{col:t,row:e},end:{col:u.colCount-1,row:e},skipBodyMerge:!0});else if(u.internalProps.layoutMap.isCornerHeader(t,e)){p=!1;const{cornerHeaderSelectMode:m}=n.select;if(m==="body")n.select.ranges.push({start:{col:u.rowHeaderLevelCount+u.leftRowSeriesNumberCount,row:u.columnHeaderLevelCount},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0});else if(m==="cell"){const y=a?{start:{col:t,row:e},end:{col:t,row:e}}:u.getCellRange(t,e);n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:y.end.col,row:y.end.row},skipBodyMerge:a||void 0})}else if(m==="inline"){const y=a?{start:{col:t,row:e},end:{col:t}}:u.getCellRange(t,e);n.select.ranges.push({start:{col:y.start.col,row:y.start.row},end:{col:y.end.col,row:u.rowCount-1},skipBodyMerge:!0})}else n.select.ranges.push({start:{col:u.leftRowSeriesNumberCount,row:0},end:{col:u.colCount-1,row:u.rowCount-1},skipBodyMerge:!0})}else if(t>=0&&e>=0){const m=a?{start:{col:t,row:e},end:{col:t,row:e}}:u.getCellRange(t,e);n.select.ranges.push({start:{col:m.start.col,row:m.start.row},end:{col:m.end.col,row:m.end.row},skipBodyMerge:a||void 0})}f.col=t,f.row=e;const v=(h=n.select.ranges)===null||h===void 0?void 0:h[n.select.ranges.length-1];v&&v.start.row<=u.rowCount-1&&v.end.row<=u.rowCount-1&&v.start.col<=u.colCount-1&&v.end.col<=u.colCount-1&&c.updateCellSelectBorder(v,p)}}else f.col=-1,f.row=-1,n.select.ranges=[],c.deleteAllSelectBorder();c.updateNextFrame()}function R6t(n){n.moveSelectingRangeComponentsToSelectedRangeComponents()}const qv=Iy(ot,{PIVOT_SORT_CLICK:"pivot_sort_click",DRILLMENU_CLICK:"drillmenu_click"});Iy(ot,{VCHART_EVENT_TYPE:"vchart_event_type"});function B6t(n,t,e,i,r){const o=r.getCellLocation(n,t);let s=0,a=0,l=!1;o==="columnHeader"?(s=r.getColsWidth(0,r.rowHeaderLevelCount-1)-(r.frozenColCount===0?r.scrollLeft:0),a=r.getRowsHeight(0,t-1)+r.getRowHeight(t)/2,l=!0):o==="rowHeader"&&(a=r.getRowsHeight(0,r.columnHeaderLevelCount-1),s=r.getColsWidth(0,n-1)+r.getColWidth(n)/2,l=!0),r.scenegraph.updateDrill(l,s,a,e,i)}function P6t(n,t,e){const i=e.scenegraph.getCell(n,t).getChildByName("sparkline"),r=i?.getChildByName("highlight-line"),o=i?.getChildByName("highlight-symbol");r&&r.setAttributes({visible:!1,pickable:!1}),o&&o.setAttributes({visible:!1,pickable:!1}),e.scenegraph.updateNextFrame()}function k6t(n,t,e,i,r){var o,s;const a=r.scenegraph.getCell(n,t).getChildByName("sparkline"),l=a?.getChildByName("sparkline-line"),h=a?.getChildByName("sparkline-symbol-group");if(!l)return!1;const u=l.bandwidth,d=l.min,c=l.max,f=l.attribute.points;let g;e-=a.globalAABBBounds.x1,a.globalAABBBounds.y1;for(let p=0;p<f.length;p++){const{x:v,y:m,defined:y,rawData:b}=f[p];if(Math.abs(e-v)<u/2&&(g={point:f[p],points:f,pointsBandWidth:u,pointData:b},y)){const _=a.getChildByName("highlight-line");if(_)_.setAttributes({points:[{x:v,y:c},{x:v,y:d}],visible:!0,pickable:!0});else{const C=Ri({points:[{x:v,y:c},{x:v,y:d}],lineWidth:(o=l.hover)===null||o===void 0?void 0:o.strokeWidth,stroke:(s=l.hover)===null||s===void 0?void 0:s.stroke});C.name="highlight-line",a.addChild(C)}const w=a.getChildByName("highlight-symbol");if(w)w.setAttributes({x:v,y:m,visible:!0,pickable:!0});else{const C=Qg({x:v,y:m,stroke:h.hover.stroke,lineWidth:h.hover.strokeWidth,fill:h.hover.fill,size:2*h.hover.size,symbolType:"circle"});C.name="highlight-symbol",a.addChild(C)}break}}if(r.scenegraph.updateNextFrame(),g){const p={col:n,row:t,field:r.getHeaderField(n,t),value:r.getCellValue(n,t),dataValue:r.getCellOriginValue(n,t),cellHeaderPaths:r.internalProps.layoutMap.getCellHeaderPaths(n,t),title:r.getBodyColumnDefine(n,t).title,cellRange:r.getCellRelativeRect(n,t),sparkline:{pointData:g.pointData},scaleRatio:r.canvas.getBoundingClientRect().width/r.canvas.offsetWidth};r.fireListeners(ot.MOUSEOVER_CHART_SYMBOL,p)}return!0}function E6t(n,t,e){const i=e.getCellRange(n.col,n.row);if(e.isColumnHeader(n.col,n.row)){const r=e.getCellRange(t.col,i.start.row);t.row>=e.columnHeaderLevelCount&&(t.row=e.columnHeaderLevelCount-1),t.col>=n.col?t.col=r.end.col:t.col=r.start.col}else if(e.isRowHeader(n.col,n.row)){const r=e.internalProps.layoutMap,o=e.getCellRange(i.start.col,t.row);if(t.col>=e.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount&&(t.col=e.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount-1),r.rowHierarchyType==="tree"){const s=r.getCellHeaderPathsWithTreeNode(n.col,n.row).rowHeaderPaths,a=r.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths;if(s.length<=a.length){const l=a[s.length-1];l&&(t.row>=n.row?t.row=l.startInTotal+l.size-1+e.columnHeaderLevelCount:t.row=l.startInTotal+e.columnHeaderLevelCount)}}else t.row>=n.row?t.row=o.end.row:t.row=o.start.row}return t}function L6t(n,t,e,i,r,o){var s;if(!("canMoveHeaderPosition"in r.table.internalProps.layoutMap))return;if(r.columnMove.moving=!0,r.columnMove.colSource=n,r.columnMove.rowSource=t,r.table.isListTable()){const g=r.table.getRecordIndexByCell(n,t),p=r.table.getRecordByCell(n,t),v=r.table.getRecordHierarchyState(n,t);r.columnMove.rowSourceSize=RA(g,v,p)+1}r.columnMove.x=e-r.table.tableX,r.columnMove.y=i-r.table.tableY;const a=r.table.getCellLocation(n,t),l=a==="columnHeader"?r.columnMove.x:a==="rowHeader"||r.table.internalProps.layoutMap.isSeriesNumberInBody(n,t)?r.columnMove.y:0,{backX:h,lineX:u,backY:d,lineY:c}=r.table.scenegraph.component.showMoveCol(n,t,l);r.table.fireListeners(ot.CHANGE_HEADER_POSITION_START,{col:n,row:t,x:e,y:i,backX:h,lineX:u,backY:d,lineY:c,event:o});const f=!!(!((s=r.select.ranges)===null||s===void 0)&&s.length);r.table.stateManager.updateSelectPos(-1,-1),r.table.stateManager.endSelectCells(!0,f),r.table.scenegraph.updateNextFrame()}function O6t(n,t,e,i,r,o){if(!("canMoveHeaderPosition"in r.table.internalProps.layoutMap))return;const s=E6t({col:r.columnMove.colSource,row:r.columnMove.rowSource},{col:n,row:t},r.table);if(r.table.internalProps.layoutMap.canMoveHeaderPosition({col:r.columnMove.colSource,row:r.columnMove.rowSource},{col:s.col,row:s.row})){if(r.columnMove.x=e-r.table.tableX,r.columnMove.y=i-r.table.tableY,r.columnMove.colTarget=s.col,r.columnMove.rowTarget=s.row,r.table.isListTable()){const c=r.table.getRecordIndexByCell(s.col,s.row),f=r.table.getRecordByCell(s.col,s.row),g=r.table.getRecordHierarchyState(s.col,s.row);r.columnMove.rowTargetSize=RA(c,g,f)+1}let a,l,h,u;r.updateCursor("grabbing");const d=r.table.getCellLocation(r.columnMove.colSource,r.columnMove.rowSource);d==="columnHeader"?(l=r.columnMove.x,a=r.table.isLeftFrozenColumn(n)?r.columnMove.colTarget>=r.columnMove.colSource?r.table.getColsWidth(0,r.columnMove.colTarget):r.table.getColsWidth(0,r.columnMove.colTarget-1):r.table.isRightFrozenColumn(n)?r.table.tableNoFrameWidth-r.table.getColsWidth(s.col+1,r.table.colCount-1):(r.columnMove.colTarget>=r.columnMove.colSource?r.table.getColsWidth(0,r.columnMove.colTarget):r.table.getColsWidth(0,r.columnMove.colTarget-1))-r.table.stateManager.scroll.horizontalBarPos):(d==="rowHeader"||r.table.internalProps.layoutMap.isSeriesNumberInBody(n,t))&&(u=r.columnMove.y,h=r.table.isFrozenRow(t)?r.columnMove.rowTarget>=r.columnMove.rowSource?r.table.getRowsHeight(0,r.columnMove.rowTarget):r.table.getRowsHeight(0,r.columnMove.rowTarget-1):r.table.isBottomFrozenRow(t)?r.table.tableNoFrameHeight-r.table.getRowsHeight(s.row+1,r.table.rowCount-1):(r.columnMove.rowTarget>=r.columnMove.rowSource?r.table.getRowsHeight(0,r.columnMove.rowTarget):r.table.getRowsHeight(0,r.columnMove.rowTarget-1))-r.table.stateManager.scroll.verticalBarPos),r.table.scenegraph.component.updateMoveCol(l,a,u,h),r.table.fireListeners(ot.CHANGING_HEADER_POSITION,{col:n,row:t,x:e,y:i,backX:l,lineX:a,backY:u,lineY:h,event:o}),r.table.scenegraph.updateNextFrame()}else r.updateCursor("not-allowed"),r.columnMove.colTarget=r.columnMove.colSource,r.columnMove.rowTarget=r.columnMove.rowSource}function D6t(n){var t,e;let i=!1;if("canMoveHeaderPosition"in n.table.internalProps.layoutMap&&n.columnMove.moving&&n.columnMove.colSource>=0&&n.columnMove.rowSource>=0&&n.columnMove.colTarget>=0&&n.columnMove.rowTarget>=0&&((t=n.table.options.customConfig)===null||t===void 0?void 0:t.notUpdateInColumnRowMove)!==!0){const r=n.table.getCellRange(n.columnMove.colSource,n.columnMove.rowSource),o=n.table.getCellRange(n.columnMove.colTarget,n.columnMove.rowTarget),s=n.table._moveHeaderPosition({col:n.columnMove.colSource,row:n.columnMove.rowSource},{col:n.columnMove.colTarget,row:n.columnMove.rowTarget});if(!s||s.targetIndex===s.sourceIndex)return n.updateCursor(),n.columnMove.moving=!1,delete n.columnMove.colSource,delete n.columnMove.rowSource,delete n.columnMove.colTarget,delete n.columnMove.rowTarget,n.table.scenegraph.component.hideMoveCol(),n.table.scenegraph.updateNextFrame(),!1;{n.table.internalProps.useOneRowHeightFillAll=!1,n.table.internalProps.layoutMap.clearCellRangeMap();const a=n.table.getCellRange(n.columnMove.colSource,n.columnMove.rowSource),l=n.table.getCellRange(n.columnMove.colTarget,n.columnMove.rowTarget),h=Math.min(a.start.col,l.start.col,r.start.col,o.start.col),u=Math.max(a.end.col,l.end.col,r.end.col,o.end.col),d=Math.min(a.start.row,l.start.row,r.start.row,o.start.row);let c=Math.max(a.end.row,l.end.row,r.end.row,o.end.row);s.moveType==="row"&&n.table.internalProps.layoutMap.rowHierarchyType==="tree"&&(c=s.targetIndex>s.sourceIndex?c+s.targetSize-1:c+s.sourceSize-1),!n.table.transpose&&n.table.internalProps.layoutMap.isSeriesNumberInBody(n.columnMove.colSource,n.columnMove.rowSource)&&(n.table.changeRecordOrder(s.sourceIndex,s.targetIndex),n.changeCheckboxAndRadioOrder(s.sourceIndex,s.targetIndex)),s.moveType==="column"?JV(h,u,0,-1,n.table):JV(0,-1,d,c,n.table),n.table.clearCellStyleCache(),n.table.internalProps.layoutMap.isSeriesNumberInBody(n.columnMove.colSource,n.columnMove.rowSource)?n.table.scenegraph.updateHeaderPosition(n.table.scenegraph.proxy.colStart,n.table.scenegraph.proxy.colEnd,n.table.scenegraph.proxy.rowStart,n.table.scenegraph.proxy.rowEnd,s.moveType):s.moveType==="column"?n.table.scenegraph.updateHeaderPosition(h,u,0,-1,s.moveType):n.table.scenegraph.updateHeaderPosition(0,-1,d,c,s.moveType),n.table.internalProps.frozenColDragHeaderMode==="adjustFrozenCount"&&n.table.isListTable()&&(n.table.isLeftFrozenColumn(n.columnMove.colTarget)&&!n.table.isLeftFrozenColumn(n.columnMove.colSource)?n.table.frozenColCount+=a.end.col-a.start.col+1:n.table.isLeftFrozenColumn(n.columnMove.colSource)&&!n.table.isLeftFrozenColumn(n.columnMove.colTarget)&&(n.table.frozenColCount-=a.end.col-a.start.col+1),n.table.isRightFrozenColumn(n.columnMove.colTarget)&&!n.table.isRightFrozenColumn(n.columnMove.colSource)?n.table.rightFrozenColCount+=a.end.col-a.start.col+1:n.table.isRightFrozenColumn(n.columnMove.colSource)&&!n.table.isRightFrozenColumn(n.columnMove.colTarget)&&(n.table.rightFrozenColCount-=a.end.col-a.start.col+1)),i=!0}}return n.columnMove.moving=!1,setTimeout(()=>{delete n.columnMove.colSource,delete n.columnMove.rowSource,delete n.columnMove.colTarget,delete n.columnMove.rowTarget},0),n.table.scenegraph.component.hideMoveCol(),n.columnResize.col<n.table.frozenColCount&&!n.table.isPivotTable()&&!n.table.transpose?(n.table.scenegraph.component.setFrozenColumnShadow(n.table.frozenColCount-1,n.columnResize.isRightFrozen),n.table.scenegraph.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount)):n.columnResize.col>=n.table.colCount-n.table.rightFrozenColCount&&!n.table.isPivotTable()&&!n.table.transpose?n.table.scenegraph.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount):n.table.options.frozenColCount?n.table.scenegraph.component.setFrozenColumnShadow(n.table.frozenColCount-1):n.table.options.rightFrozenColCount&&n.table.scenegraph.component.setRightFrozenColumnShadow(n.table.colCount-n.table.rightFrozenColCount),n.table.scenegraph.updateNextFrame(),((e=n.table.options.customConfig)===null||e===void 0?void 0:e.notUpdateInColumnRowMove)===!0||i}function JV(n,t,e,i,r){for(let o=n;o<=t;o++)r._clearColRangeWidthsMap(o);for(let o=e;o<=i;o++)r._clearRowRangeHeightsMap(o)}function W0(n){var t;if(!n)return;const e=!((t=n.role)===null||t===void 0)&&t.startsWith("icon")?n:n.type==="richtext"?n._currentHoverIcon:void 0;return e?n.type==="richtext"?{icon:e,position:{left:n.globalAABBBounds.x1+e.globalAABBBounds.x1,right:n.globalAABBBounds.x1+e.globalAABBBounds.x2,top:n.globalAABBBounds.y1+e.globalAABBBounds.y1,bottom:n.globalAABBBounds.y1+e.globalAABBBounds.y2,width:e.globalAABBBounds.x2-e.globalAABBBounds.x1,height:e.globalAABBBounds.y2-e.globalAABBBounds.y1},type:"richtext-icon"}:{icon:e,position:{left:e.globalAABBBounds.x1,right:e.globalAABBBounds.x2,top:e.globalAABBBounds.y1,bottom:e.globalAABBBounds.y2,width:e.globalAABBBounds.x2-e.globalAABBBounds.x1,height:e.globalAABBBounds.y2-e.globalAABBBounds.y1},type:"icon"}:void 0}function I6t(n,t,e){n=Math.ceil(n),t=Math.ceil(t);let i=e.columnResize.isRightFrozen?e.columnResize.x-n:n-e.columnResize.x;if(Math.abs(i)<1)return;const r=e.table.getColWidth(e.columnResize.col);let o=r;o+=i;const s=e.table.getMinColWidth(e.columnResize.col),a=e.table.getMaxColWidth(e.columnResize.col);if(o<s||o>a){if(r===s||r===a)return;i=r-s>a-r?a-r:s-r}let l=e.table.getColWidth(e.columnResize.col)+i;if(l<e.table.internalProps.limitMinWidth&&(l=e.table.internalProps.limitMinWidth,i=l-e.table.getColWidth(e.columnResize.col)),e.table.widthMode==="adaptive"&&e.columnResize.col<e.table.colCount-1){const h=e.table.getColWidth(e.columnResize.col+1),u=e.table.getMinColWidth(e.columnResize.col+1),d=e.table.getMaxColWidth(e.columnResize.col+1);let c=h;if(c-=i,c<u||c>d){if(h===u||h===d)return;i=h-u>d-h?d-h:u-h}c-i<e.table.internalProps.limitMinWidth&&(i=c-e.table.internalProps.limitMinWidth)}i=Math.ceil(i),e.columnResize.col<e.table.rowHeaderLevelCount||e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount?QV(i,e):e.table.internalProps.columnResizeType==="indicator"?F6t(i,e):e.table.internalProps.columnResizeType==="indicatorGroup"?z6t(i,e):e.table.internalProps.columnResizeType==="all"?H6t(i,e):QV(i,e),e.columnResize.x=n,e.table.scenegraph.component.updateResizeCol(e.columnResize.col,t,e.columnResize.isRightFrozen),e.table._updateSize(),e.columnResize.col<e.table.frozenColCount&&!e.table.isPivotTable()&&!e.table.transpose?e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen):e.table.options.frozenColCount&&e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1),(e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount&&!e.table.isPivotTable()&&!e.table.transpose||e.table.options.rightFrozenColCount)&&e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount),e.table.scenegraph.updateNextFrame()}function QV(n,t){t.table.widthMode==="adaptive"&&t.columnResize.col<t.table.colCount-1?(t.table.scenegraph.updateColWidth(t.columnResize.col,n),t.table.scenegraph.updateColWidth(t.columnResize.col+1,-n),t.table.internalProps._widthResizedColMap.add(t.columnResize.col),t.table.internalProps._widthResizedColMap.add(t.columnResize.col+1)):(t.table.scenegraph.updateColWidth(t.columnResize.col,n),t.table.internalProps._widthResizedColMap.add(t.columnResize.col))}function H6t(n,t){const e=t.table.internalProps.layoutMap;for(let i=t.table.frozenColCount;i<t.table.colCount-t.table.rightFrozenColCount;i++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!e.indicatorsAsCol)){const r=e.getBody(i,t.table.columnHeaderLevelCount);if(r?.disableColumnResize)continue}t.table.scenegraph.updateColWidth(i,n),t.table.internalProps._widthResizedColMap.add(i)}}function F6t(n,t){const e=t.table.internalProps.layoutMap;let i,r,o;if(e.indicatorsAsCol)i=e.getIndicatorKey(t.columnResize.col,t.table.columnHeaderLevelCount);else{const s=e.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount-1),a=s.colHeaderPaths[s.colHeaderPaths.length-1];r=a.dimensionKey,o=a.value}for(let s=t.table.rowHeaderLevelCount;s<t.table.colCount-t.table.rightFrozenColCount;s++){const a=e.getIndicatorKey(s,t.table.columnHeaderLevelCount);if(e.indicatorsAsCol&&a===i)t.table.scenegraph.updateColWidth(s,n),t.table.internalProps._widthResizedColMap.add(s);else if(!e.indicatorsAsCol){const l=e.getCellHeaderPaths(s,t.table.columnHeaderLevelCount-1),h=l?.colHeaderPaths[l.colHeaderPaths.length-1];h&&r===h.dimensionKey&&o===h.value&&(t.table.scenegraph.updateColWidth(s,n),t.table.internalProps._widthResizedColMap.add(s))}}}function z6t(n,t){const e=t.table.internalProps.layoutMap,i=e.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount),r=e.getHeadNodeByRowOrColDimensions(i.colHeaderPaths.slice(0,i.colHeaderPaths.length-1)),o=r.startInTotal+t.table.frozenColCount,s=r.startInTotal+t.table.frozenColCount+r.size-1,a=t.table.getColsWidth(o,s),l=n;for(let h=o;h<=s;h++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!e.indicatorsAsCol)){const d=e.getBody(h,t.table.columnHeaderLevelCount);if(d?.disableColumnResize)continue}let u=t.table.getColWidth(h)/a*l;u>0&&u<.5?u=.5:u<0&&u>=-.5&&(u=-.5),t.table.scenegraph.updateColWidth(h,u),t.table.internalProps._widthResizedColMap.add(h)}}function N6t(n,t,e,i,r,o){const s=o.table.getRecordShowIndexByCell(n,t);if(s>=0){const a=o.table.dataSource.getIndexKey(s);i==="column"?pt(r)?(o.radioState[e]={},o.radioState[e][a]=r):o.radioState[e]=a:(o.radioState[e]||(o.radioState[e]={}),pt(r)?o.radioState[e][a]=r:o.radioState[e][a]=!0)}}function W6t(n,t,e){var i;const r=e.getBodyColumnDefine(n,t),o=r?.field,s=e.getCellType(n,t);if(Y(o)&&s==="radio"){const a=e.dataSource.getIndexKey(e.getRecordShowIndexByCell(n,t)),l=(i=e.stateManager.radioState)===null||i===void 0?void 0:i[o];if(pt(l)){if(l===a)return!0}else if(pn(l)){const h=l[a];if(pt(h))return h}}return!1}function V6t(n,t,e,i,r,o,s){var a,l,h,u,d;const c=s.table.getRecordShowIndexByCell(n,t);if(c>=0){const f=s.table.dataSource.getIndexKey(c);if(i==="column"){if(!Y(s.radioState[e])&&o)return pt(r)?(s.radioState[e]={},s.radioState[e][f]=r):s.radioState[e]=f,!0;if(pt(s.radioState[e])&&!pt(r))return s.radioState[e]===f;if(pt(s.radioState[e])&&pt(r)||pn(s.radioState[e])&&!pt(r))return!1;if(pn(s.radioState[e])&&pt(r))return s.radioState[e][f]===r}else if(i==="cell"){if(!Y(s.radioState[e])&&o)return s.radioState[e]={},pt(r)?s.radioState[e][f]=r:s.radioState[e][f]=!0,!0;if(!Y((a=s.radioState[e])===null||a===void 0?void 0:a[f])&&o)return pt(r)?s.radioState[e][f]=r:s.radioState[e][f]=!0,!0;if(La((l=s.radioState[e])===null||l===void 0?void 0:l[f])&&!pt(r))return s.radioState[e][f];if(La((h=s.radioState[e])===null||h===void 0?void 0:h[f])&&pt(r)||pt((u=s.radioState[e])===null||u===void 0?void 0:u[f])&&!pt(r))return!1;if(pt((d=s.radioState[e])===null||d===void 0?void 0:d[f])&&pt(r))return s.radioState[e][f]===r}}return o}function G6t(n,t,e,i){const r=i.scenegraph.getCell(n,t);if(r)if(pt(e)){const o=r.getChildAt(e);o?._handlePointerUp()}else{const o=r.getChildByName("radio");o?._handlePointerUp()}}function $6t(n,t,e){const{radioState:i,table:r}=e;if(r.internalProps.transpose?(n=r.getRecordShowIndexByCell(n,0),t=r.getRecordShowIndexByCell(t,0)):(n=r.getRecordShowIndexByCell(0,n),t=r.getRecordShowIndexByCell(0,t)),n>t){const o=i[n];for(let s=n;s>t;s--)i[s]=i[s-1];i[t]=o}else if(n<t){const o=i[n];for(let s=n;s<t;s++)i[s]=i[s+1];i[t]=o}}function j6t(n,t,e,i,r){const o=r.table.getCellRange(n,t);if(o.start.col!==o.end.col||o.start.row!==o.end.row)for(let s=o.start.col;s<=o.end.col;s++)for(let a=o.start.row;a<=o.end.row;a++)tG(s,a,e,i,r);else tG(n,t,e,i,r)}function tG(n,t,e,i,r){const o=r.table.getRecordShowIndexByCell(n,t);if(o>=0){const s=r.table.dataSource.getIndexKey(o).toString();r.checkedState.get(s)?r.checkedState.get(s)[e]=i:r.checkedState.set(s,{[e]:i})}}function U6t(n,t,e){var i;e.headerCheckedState[n]=t,e.table.internalProps.enableCheckboxCascade&&((i=e.checkedState)===null||i===void 0||i.forEach(r=>{r[n]=t}))}function X6t(n,t,e,i,r){var o,s;if(r.table.isHeader(n,t)){if(Y(r.headerCheckedState[e]))return r.headerCheckedState[e];if(typeof i=="function")return;if(Y(i))r.headerCheckedState[e]=i;else if(((o=r.checkedState)===null||o===void 0?void 0:o.size)>0)return r.updateHeaderCheckedState(e,n,t);return r.headerCheckedState[e]}const a=r.table.getRecordShowIndexByCell(n,t);if(a>=0){const l=r.table.dataSource.getIndexKey(a).toString();if(Y((s=r.checkedState.get(l))===null||s===void 0?void 0:s[e]))return r.checkedState.get(l)[e];if(r.checkedState.get(l))r.checkedState.get(l)[e]=i;else if(r.table.internalProps.enableCheckboxCascade&&l.includes(",")){const h=l.split(",").slice(0,-1).join(",");r.checkedState.has(h)&&r.checkedState.get(h)[e]===!0?r.checkedState.set(l,{[e]:!0}):r.checkedState.set(l,{[e]:i})}else r.checkedState.set(l,{[e]:i})}return i}function Y6t(n,t){t.checkedState.clear(),t.headerCheckedState={},t.radioState={};let e=!1;if(t._checkboxCellTypeFields=[],t._headerCheckFuncs={},t.table.internalProps.layoutMap.headerObjects.forEach((i,r)=>{if(i.headerType==="checkbox"){const o=i.define.checked;o==null||typeof o=="function"?(e=!0,typeof o=="function"&&(t._headerCheckFuncs[i.field]=o)):t.headerCheckedState[i.field]=o,i.define.cellType!=="checkbox"&&!Bo(i.define.cellType)||i.fieldFormat||t._checkboxCellTypeFields.push(i.field)}}),t.table.leftRowSeriesNumberCount===1)t.headerCheckedState._vtable_rowSeries_number=!1,t._checkboxCellTypeFields.push("_vtable_rowSeries_number"),e=!0;else if(t.table.leftRowSeriesNumberCount>1){for(let i=0;i<t.table.leftRowSeriesNumberCount;i++)t.headerCheckedState[`_vtable_rowSeries_number_${i}`]=!1,t._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${i}`);e=!0}e&&tVt(n,t)}function K6t(n,t,e,i){let r=!0,o=!0,s=!1;return t.checkedState.forEach((a,l)=>{var h;l=l.includes(",")?l.split(",").map(f=>Number(f)):Number(l);const u=t.table.getTableIndexByRecordIndex(l),d=t.table.transpose?t.table.getCustomMerge(u,i):t.table.getCustomMerge(e,u),c=(h=t.table.dataSource)===null||h===void 0?void 0:h.get(l);d||!t.table.internalProps.enableCheckboxCascade&&c?.vtableMerge||(a?.[n]!==!0?r=!1:(o=!1,s=!0))}),r?(t.headerCheckedState[n]=!0,r):o?(t.headerCheckedState[n]=!1,!1):!!s&&(t.headerCheckedState[n]="indeterminate","indeterminate")}function q6t(n,t){for(let e=t.checkedState.size;e<n.length;e++){const i=n[e];t._checkboxCellTypeFields.forEach(r=>{const o=i[r];let s;pn(o)?s=o.checked:typeof o=="boolean"&&(s=o);const a=e.toString();t.checkedState.get(a)||t.checkedState.set(a,{}),t.checkedState.get(a)[r]=s})}}function Z6t(n,t,e,i){var r,o;const s=i.scenegraph.getCell(n,t),a=s?.getChildByName("checkbox")||((o=(r=s?.getChildByName("checkbox-content"))===null||r===void 0?void 0:r._checkboxGroup)===null||o===void 0?void 0:o.getChildByName("checkbox"));if(!a){const u=i.getHeaderField(n,t);if(i.isHeader(n,t))i.stateManager.setHeaderCheckedState(u,e),i.getCellType(n,t)==="checkbox"&&i.scenegraph.updateCheckboxCellState(n,t,e);else if(i.stateManager.setCheckedState(n,t,u,e),i.getCellType(n,t)==="checkbox"){const d=i.stateManager.headerCheckedState[u],c=i.stateManager.updateHeaderCheckedState(u,n,t);d!==c&&i.scenegraph.updateHeaderCheckboxCellState(n,t,c)}return}const{checked:l,indeterminate:h}=a.attribute;h?(e||a._handlePointerUp(),a._handlePointerUp()):l?e||a._handlePointerUp():e&&a._handlePointerUp()}function wC(n,t,e,i){var r,o;const s=i.scenegraph.getCell(n,t),a=s?.getChildByName("checkbox")||((o=(r=s?.getChildByName("checkbox-content"))===null||r===void 0?void 0:r._checkboxGroup)===null||o===void 0?void 0:o.getChildByName("checkbox"));a&&(e==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",e)))}function J6t(n,t,e){const{checkedState:i,table:r}=e;let o,s;if(r.internalProps.transpose?(n=r.getRecordShowIndexByCell(n,0),t=r.getRecordShowIndexByCell(t,0)):(o=r.isPivotTable()?void 0:r.getRecordIndexByCell(0,n),s=r.isPivotTable()?void 0:r.getRecordIndexByCell(0,t)),pt(o)&&pt(s)){if((n=o)>(t=s)){const a=i.get(n.toString());for(let l=n;l>t;l--)i.set(l.toString(),i.get((l-1).toString()));i.set(t.toString(),a)}else if(n<t){const a=i.get(n.toString());for(let l=n;l<t;l++)i.set(l.toString(),i.get((l+1).toString()));i.set(t.toString(),a)}}else if(Mt(o)&&Mt(s)){if((n=o[o.length-1])>(t=s[s.length-1])){const a=i.get(o.toString());for(let l=n;l>t;l--){const h=[...o];h[h.length-1]=l;const u=[...o];u[u.length-1]=l-1,i.set(h.toString(),i.get(u.toString()))}i.set(s.toString(),a)}else if(n<t){const a=i.get(o.toString());for(let l=n;l<t;l++){const h=[...o];h[h.length-1]=l;const u=[...o];u[u.length-1]=l+1,i.set(h.toString(),i.get(u.toString()))}i.set(s.toString(),a)}}}function Q6t(n){const t=[],e=n.dataSource,i=e.dataConfig.groupByRules.length+1;return e.currentIndexedData.forEach((r,o)=>{if(Mt(r)&&r.length===i){const s=e.getOriginRecordIndexForGroup(r);t[s]=n.stateManager.checkedState.get(r.toString())}}),t}function tVt(n,t){const e=t.table,i=e.isPivotTable()?0:e.internalProps.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,r=e.isPivotTable()?Mt(n)?n.length:0:e.internalProps.transpose?e.colCount:e.rowCount;for(let o=0;o+i<r;o++){const s=e.isPivotTable()?n[o]:e.dataSource.get(o);t._checkboxCellTypeFields.forEach(a=>{const l=s&&s[a];let h;if(pn(l)?h=l.checked:typeof l=="boolean"&&(h=l),h==null){const d=t._headerCheckFuncs[a];if(d){const c=t.table.getCellAddrByFieldRecord(a,o);h=Ie(d,{col:c.col,row:c.row,table:t.table,context:null,value:l})}}const u=e.isPivotTable()?o.toString():t.table.dataSource.getIndexKey(o).toString();t.checkedState.get(u)||t.checkedState.set(u,{}),t.checkedState.get(u)[a]=h})}}function eVt(n,t,e){n=Math.ceil(n),t=Math.ceil(t);let i=e.rowResize.isBottomFrozen?e.rowResize.y-t:t-e.rowResize.y;if(Math.abs(i)<1)return;e.table.getRowHeight(e.rowResize.row);let r=e.table.getRowHeight(e.rowResize.row)+i;if(r<e.table.internalProps.limitMinHeight&&(r=e.table.internalProps.limitMinHeight,i=r-e.table.getRowHeight(e.rowResize.row)),e.table.heightMode==="adaptive"&&e.rowResize.row<e.table.rowCount-1){let o=e.table.getRowHeight(e.rowResize.row+1);o-=i,o-i<e.table.internalProps.limitMinHeight&&(i=o-e.table.internalProps.limitMinHeight)}i=Math.ceil(i),e.rowResize.row<e.table.columnHeaderLevelCount||e.rowResize.row>=e.table.rowCount-e.table.bottomFrozenRowCount?eG(i,e):e.table.internalProps.rowResizeType==="indicator"?nVt(i,e):e.table.internalProps.rowResizeType==="indicatorGroup"?rVt(i,e):e.table.internalProps.rowResizeType==="all"?iVt(i,e):eG(i,e),e.rowResize.y=t,e.table.scenegraph.component.updateResizeRow(e.rowResize.row,n,e.rowResize.isBottomFrozen),e.table._updateSize(),e.table.scenegraph.updateNextFrame()}function eG(n,t){t.table.heightMode==="adaptive"&&t.rowResize.row<t.table.rowCount-1?(t.table.scenegraph.updateRowHeight(t.rowResize.row,n),t.table.scenegraph.updateRowHeight(t.rowResize.row+1,-n),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row+1)):(t.table.scenegraph.updateRowHeight(t.rowResize.row,n),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row))}function iVt(n,t){for(let e=t.table.frozenRowCount;e<t.table.rowCount-t.table.bottomFrozenRowCount;e++)t.table.scenegraph.updateRowHeight(e,n),t.table.internalProps._heightResizedRowMap.add(e)}function nVt(n,t){var e,i;const r=t.table.internalProps.layoutMap;let o,s,a;if(r.indicatorsAsCol){const l=r.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,t.rowResize.row),h=(e=l.rowHeaderPaths)===null||e===void 0?void 0:e[l.rowHeaderPaths.length-1];s=h?.dimensionKey,a=h?.value}else o=r.getIndicatorKey(t.table.rowHeaderLevelCount,t.rowResize.row);for(let l=t.table.columnHeaderLevelCount;l<t.table.rowCount-t.table.bottomFrozenRowCount;l++){const h=r.getIndicatorKey(t.table.rowHeaderLevelCount,l);if(r.indicatorsAsCol||h!==o){if(r.indicatorsAsCol){const u=r.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,l),d=(i=u?.rowHeaderPaths)===null||i===void 0?void 0:i[u.rowHeaderPaths.length-1];d&&s===d.dimensionKey&&a===d.value&&(t.table.scenegraph.updateRowHeight(l,n),t.table.internalProps._heightResizedRowMap.add(l))}}else t.table.scenegraph.updateRowHeight(l,n),t.table.internalProps._heightResizedRowMap.add(l)}}function rVt(n,t){const e=t.table.internalProps.layoutMap,i=e.getCellHeaderPaths(t.table.rowHeaderLevelCount,t.rowResize.row),r=e.getHeadNodeByRowOrColDimensions(i.rowHeaderPaths.slice(0,i.rowHeaderPaths.length-1)),o=r.startInTotal+t.table.frozenRowCount,s=r.startInTotal+t.table.frozenRowCount+r.size-1,a=t.table.getRowsHeight(o,s),l=n;for(let h=o;h<=s;h++){let u=t.table.getRowHeight(h)/a*l;u>0&&u<.5?u=.5:u<0&&u>=-.5&&(u=-.51),t.table.scenegraph.updateRowHeight(h,u),t.table.internalProps._heightResizedRowMap.add(h)}}function oVt(n,t,e){const i=n.table,r=t.start.col,o=t.start.row,s=t.end.col,a=t.end.row,l=(t.skipBodyMerge,Math.max(Math.min(s,r),0)),h=Math.max(Math.min(a,o),0),u=Math.min(Math.max(s,r),i.colCount-1),d=Math.min(Math.max(a,o),i.rowCount-1),{needRowHeader:c,needRightRowHeader:f,needColumnHeader:g,needBottomColumnHeader:p,needBody:v,needCornerHeader:m,needRightTopCornerHeader:y,needLeftBottomCornerHeader:b,needRightBottomCornerHeader:_}=gJ(l,h,u,d,i);if(m&&cl(n,l,h,Math.min(u,i.frozenColCount-1),Math.min(d,i.frozenRowCount-1),"cornerHeader",`${l}${h}${u}${d}`,[!0,!g,!c,!0],e),y&&cl(n,Math.max(l,i.colCount-i.rightFrozenColCount),h,u,Math.min(d,i.frozenRowCount-1),"rightTopCorner",`${l}${h}${u}${d}`,[!0,!0,!f,!g],e),b){const w=Math.min(u,i.frozenColCount-1);cl(n,l,Math.max(h,i.rowCount-i.bottomFrozenRowCount),w,d,"leftBottomCorner",`${l}${h}${u}${d}`,[!c,!p,!0,!0],e)}if(_&&cl(n,Math.max(l,i.colCount-i.rightFrozenColCount),Math.max(h,i.rowCount-i.bottomFrozenRowCount),u,d,"rightBottomCorner",`${l}${h}${u}${d}`,[!f,!0,!0,!p],e),g&&cl(n,Math.max(l,i.frozenColCount),h,Math.min(u,i.colCount-i.rightFrozenColCount-1),Math.min(d,i.frozenRowCount-1),"columnHeader",`${l}${h}${u}${d}`,[!0,!y,!v,!m],e),p){const w=Math.max(l,i.frozenColCount),C=Math.min(u,i.colCount-i.rightFrozenColCount-1);cl(n,w,Math.max(h,i.rowCount-i.bottomFrozenRowCount),C,d,"bottomFrozen",`${l}${h}${u}${d}`,[!v,!_,!0,!b],e)}if(c){const w=Math.max(h,i.frozenRowCount),C=Math.min(d,i.rowCount-i.bottomFrozenRowCount-1);cl(n,l,w,Math.min(u,i.frozenColCount-1),C,"rowHeader",`${l}${h}${u}${d}`,[!m,!v,!b,!0],e)}if(f){const w=Math.max(h,i.frozenRowCount),C=Math.min(d,i.rowCount-i.bottomFrozenRowCount-1);cl(n,Math.max(l,i.colCount-i.rightFrozenColCount),w,u,C,"rightFrozen",`${l}${h}${u}${d}`,[!y,!0,!_,!v],e)}v&&cl(n,Math.max(l,i.frozenColCount),Math.max(h,i.frozenRowCount),Math.min(u,i.colCount-i.rightFrozenColCount-1),Math.min(d,i.rowCount-i.bottomFrozenRowCount-1),"body",`${l}${h}${u}${d}`,[!g,!f,!p,!c],e)}function cl(n,t,e,i,r,o,s,a,l){var h,u,d,c;const f=Math.min(t,i),g=Math.min(e,r),p=Math.max(t,i),v=Math.max(e,r),m=n.highPerformanceGetCell(f,g).globalAABBBounds,y=Ne({pickable:!1,fill:(h=l.cellBgColor)!==null&&h!==void 0&&h,lineWidth:(u=l.cellBorderLineWidth)!==null&&u!==void 0?u:0,lineDash:(d=l.cellBorderLineDash)!==null&&d!==void 0?d:[],stroke:a.map(b=>!!b&&l.cellBorderColor),x:m.x1-n.tableGroup.attribute.x,y:m.y1-n.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:EJ(o,(c=n.table.theme.frameStyle)===null||c===void 0?void 0:c.cornerRadius,t,e,i,r,n.table)});n.customSelectedRangeComponents.set(`${f}-${g}-${p}-${v}-${s}`,{rect:y,role:o}),n.tableGroup.insertAfter(y,o==="body"?n.bodyGroup:o==="columnHeader"?n.colHeaderGroup:o==="rowHeader"?n.rowHeaderGroup:o==="cornerHeader"?n.cornerHeaderGroup:o==="rightTopCorner"?n.rightTopCornerGroup:o==="rightFrozen"?n.rightFrozenGroup:o==="leftBottomCorner"?n.leftBottomCornerGroup:o==="bottomFrozen"?n.bottomFrozenGroup:n.rightBottomCornerGroup)}function sVt(n){const{customSelectedRangeComponents:t}=n.table.scenegraph;t.forEach((e,i)=>{e.rect.delete()}),t.clear(),n.select.customSelectRanges=[]}function aVt(n,t){n.forEach(e=>{oVt(t.table.scenegraph,e.range,e.style)}),t.select.customSelectRanges=n,kJ(t.table.scenegraph),t.table.scenegraph.updateNextFrame()}let lVt=class{constructor(t){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=DZ(e=>{this.updateInteractionState(e??Ft.default)},100),this.table=t,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=Ft.default,this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new lu,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=Ft.default,this.select={highlightScope:Ae.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:Ae.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,rowSourceSize:0,rowTargetSize:0,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new lu,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var t;const{highlightMode:e,disableHover:i,disableHeaderHover:r}=(t=this.table.options.hover)!==null&&t!==void 0?t:{highlightMode:"cell"};i?this.hover.highlightScope=Ae.none:e==="cross"?this.hover.highlightScope=Ae.cross:e==="row"?this.hover.highlightScope=Ae.row:e==="column"?this.hover.highlightScope=Ae.column:e==="cell"&&(this.hover.highlightScope=Ae.single),this.hover.singleStyle=!i,this.hover.disableHeader=r,(this.hover.highlightScope===Ae.none||r)&&(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var t,e,i,r,o,s;const{headerSelectMode:a,disableSelect:l,disableHeaderSelect:h,highlightMode:u,highlightInRange:d}=Object.assign({},{headerSelectMode:"inline",disableSelect:!1,disableHeaderSelect:!1,highlightMode:"cell",highlightInRange:!1},this.table.options.select),c=!((t=this.table.options.select)===null||t===void 0)&&t.cornerHeaderSelectMode?(e=this.table.options.select)===null||e===void 0?void 0:e.cornerHeaderSelectMode:((i=this.table.options.select)===null||i===void 0?void 0:i.headerSelectMode)==="body"?(r=this.table.options.select)===null||r===void 0?void 0:r.headerSelectMode:"all";this.select.highlightScope=l===!0?Ae.none:u==="cross"?Ae.cross:u==="row"?Ae.row:u==="column"?Ae.column:Ae.single,this.select.singleStyle=!l,this.select.disableHeader=h,this.select.headerSelectMode=a,this.select.cornerHeaderSelectMode=c,this.select.highlightInRange=d,this.select.disableCtrlMultiSelect=((o=this.table.options.keyboardOptions)===null||o===void 0?void 0:o.ctrlMultiSelect)===!1,this.select.disableShiftMultiSelect=((s=this.table.options.keyboardOptions)===null||s===void 0?void 0:s.shiftMultiSelect)===!1}isSelected(t,e){let i=!1;return this.select.ranges.forEach(r=>{fs(r,t,e)&&(i=!0)}),i}setSortState(t){const e=this,i=(t=!t||Array.isArray(t)?t:[t])&&t.reduce((r,o)=>{var s,a,l;const h=(s=function(u){const d=[];return function c(f,g=0){f.forEach(p=>{var v;const m=p.startInTotal?(v=p.startInTotal+e.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&v!==void 0?v:0:g;p.columns?c(p.columns,m):d.push(Object.assign(Object.assign({},p),{startIndex:m}))})}(u),d}(this.table.internalProps.columns))===null||s===void 0?void 0:s.find(u=>u?.field===o?.field);return this.table.internalProps.transpose?r.push({field:o.field,order:o.order,row:(a=h?.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&a!==void 0?a:0,col:h?.level}):r.push({field:o.field,order:o.order,col:(l=h?.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&l!==void 0?l:0,row:h?.level}),r},[]);this.sort=i||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(t){if(this.interactionState===t)return;t===Ft.scrolling&&(this.interactionStateBeforeScroll=this.interactionState);const e=this.interactionState;this.interactionState=t,e===Ft.scrolling&&Ft.default}updateHoverhighlightScope(t){this.hover.highlightScope!==t&&(this.hover.highlightScope=t)}updateHoverPos(t,e){w6t(this,t,e)}updateSelectPos(t,e,i=!1,r=!1,o=!1,s=!0,a=!1){e!==-1&&e!==-1&&(this.select.selecting=!0),t<0&&(t=-1),e<0&&(e=-1),t>this.table.colCount-1&&(t=this.table.colCount-1),e>this.table.rowCount-1&&(e=this.table.rowCount-1);const l=this.select.cellPos.col,h=this.select.cellPos.row;M6t(this,t,e,i,r,o,s,a),!this.table.hasListeners(ot.SELECTED_CHANGED)||l===t&&h===e||this.table.fireListeners(ot.SELECTED_CHANGED,{ranges:this.select.ranges,col:t,row:e})}checkCellRangeInSelect(t,e){return b6t(t,e,this.select.ranges,this.select.highlightScope)}updateHoverIcon(t,e,i,r){var o,s,a,l,h,u,d,c,f;if(!((o=this.residentHoverIcon)===null||o===void 0)&&o.icon&&i===((s=this.residentHoverIcon)===null||s===void 0?void 0:s.icon))return;const g=W0(i);if(g)if(g.type==="richtext-icon"){const p=g.icon;if(this.hoverIcon.icon&&this.hoverIcon.icon!==((l=this.residentHoverIcon)===null||l===void 0?void 0:l.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),p.attribute.tooltip){const v={content:p.attribute.tooltip.title,referencePosition:{rect:g.position,placement:p.attribute.tooltip.placement},style:Object.assign({},(h=this.table.internalProps.theme)===null||h===void 0?void 0:h.tooltipStyle,(u=p.tooltip)===null||u===void 0?void 0:u.style,(c=(d=p.attribute)===null||d===void 0?void 0:d.tooltip)===null||c===void 0?void 0:c.style),disappearDelay:p.attribute.tooltip.disappearDelay};this.table.internalProps.tooltipHandler.isBinded(v)||this.table.showTooltip(t,e,v)}}else{const p=g.icon;p!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==((f=this.residentHoverIcon)===null||f===void 0?void 0:f.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=t,this.hoverIcon.row=e,this.hoverIcon.icon=p,this.table.scenegraph.setIconHoverStyle(p,t,e,r),this.table.scenegraph.updateNextFrame())}else this.hoverIcon.icon&&this.hoverIcon.icon!==((a=this.residentHoverIcon)===null||a===void 0?void 0:a.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame())}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(t=!0,e=!0){if(this.select.selecting){if(this.select.selecting=!1,this.select.ranges.length===0)return;const i=this.select.ranges[this.select.ranges.length-1];this.table.isSeriesNumber(this.select.cellPos.col,this.select.cellPos.row)||this.table.isHeader(this.select.cellPos.col,this.select.cellPos.row)||TWt(i,this.table);let r=!1;for(let a=0;a<this.select.ranges.length-1;a++){const l=this.select.ranges[a];if(l&&l.start.col===i.start.col&&l.start.row===i.start.row&&l.end.col===i.end.col&&l.end.row===i.end.row){r=!0;break}}r?(this.select.ranges.pop(),LJ(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):R6t(this.table.scenegraph);const o=this.select.ranges[this.select.ranges.length-1].end.col,s=this.select.ranges[this.select.ranges.length-1].end.row;t&&this.table.fireListeners(ot.SELECTED_CELL,{ranges:this.select.ranges,col:o,row:s})}else e&&this.select.ranges.length===0&&this.table.fireListeners(ot.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(t,e,i,r){this.columnResize.resizing=!0,this.columnResize.col=t,this.columnResize.x=e,this.columnResize.isRightFrozen=r,this.table.scenegraph.component.showResizeCol(t,i,r),this.table.scenegraph.updateNextFrame()}updateResizeCol(t,e){I6t(t,e,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(t,e,i,r){this.rowResize.resizing=!0,this.rowResize.row=t,this.rowResize.y=i,this.rowResize.isBottomFrozen=r,this.table.scenegraph.component.showResizeRow(t,e,r),this.table.scenegraph.updateNextFrame()}updateResizeRow(t,e){eVt(t,e,this)}startFillSelect(t,e){this.fillHandle.isFilling=!0,this.fillHandle.startX=t,this.fillHandle.startY=e;const i=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(i.start.col,i.end.col),this.fillHandle.beforeFillMinRow=Math.min(i.start.row,i.end.row),this.fillHandle.beforeFillMaxCol=Math.max(i.start.col,i.end.col),this.fillHandle.beforeFillMaxRow=Math.max(i.start.row,i.end.row),this.table.fireListeners(ot.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;const t=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),e=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),i=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),r=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===t&&this.fillHandle.beforeFillMinRow===e&&this.fillHandle.beforeFillMaxCol===i&&this.fillHandle.beforeFillMaxRow===r||this.table.eventManager.isDraging&&this.table.fireListeners(ot.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(t,e,i,r,o){L6t(t,e,i,r,this,o)}updateMoveCol(t,e,i,r,o){O6t(t,e,i,r,this,o)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return D6t(this)}checkFrozen(){var t;let e=this.table.options.frozenColCount?this.table.options.frozenColCount:this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?((t=this.table.rowHeaderLevelCount)!==null&&t!==void 0?t:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0;if(e){e=Math.min(e,this.table.colCount);const i=this.table.getContainer();if(i&&i.clientWidth===0)return this._frozenObserver?void 0:(this._frozenObserver=new ResizeObserver(r=>{for(const o of r)if(o.contentRect.width>0)return this.clearFrozenObserver(),this.table.resize(),void setTimeout(()=>{this.checkFrozen()},0)}),void this._frozenObserver.observe(i));if(this.table.getColsWidth(0,e-1)>this.table._getMaxFrozenWidth())if(this.table.internalProps.unfreezeAllOnExceedsMaxWidth)this.table._setFrozenColCount(0),this.setFrozenCol(-1);else{const r=this.table._getComputedFrozenColCount(e);this.table._setFrozenColCount(r),this.setFrozenCol(r)}else this.table.frozenColCount!==e&&(this.table._setFrozenColCount(e),this.setFrozenCol(e))}else this.clearFrozenObserver()}clearFrozenObserver(){this._frozenObserver&&(this._frozenObserver.disconnect(),this._frozenObserver=null)}setFrozenCol(t){t!==this.frozen.col?(this.frozen.col=t,this.table.scenegraph.updateFrozen(),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)):this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(t){t!==this.frozen.row&&(this.frozen.row=t,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var t,e;const i=this.table.getAllRowsHeight(),r=this.scroll.verticalBarPos,o=this.table.tableNoFrameHeight;r+o>=i&&this.table.fireListeners(ot.SCROLL_VERTICAL_END,{scrollTop:r,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(t=this.table.theme.scrollStyle)===null||t===void 0?void 0:t.width,scrollWidth:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,viewHeight:o,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var t,e;const i=this.table.getAllColsWidth(),r=this.scroll.horizontalBarPos,o=this.table.tableNoFrameWidth;r+o>=i&&this.table.fireListeners(ot.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:r,scrollHeight:(t=this.table.theme.scrollStyle)===null||t===void 0?void 0:t.width,scrollWidth:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:o})}updateVerticalScrollBar(t){var e,i,r,o;const s=this.table.getAllRowsHeight(),a=this.scroll.verticalBarPos;let l=Math.ceil(t*(s-this.table.scenegraph.height));Y(l)&&!isNaN(l)||(l=0);const h=l-this.table.scenegraph.proxy.deltaY-a;if(this.table.fireListeners(ot.CAN_SCROLL,{event:void 0,scrollTop:l-this.table.scenegraph.proxy.deltaY,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,scrollWidth:(i=this.table.theme.scrollStyle)===null||i===void 0?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:h}).some(u=>u===!1)){const u=this.scroll.verticalBarPos/(s-this.table.scenegraph.height);this.table.scenegraph.component.updateVerticalScrollBarPos(u)}else this.scroll.verticalBarPos=l,this.table.scenegraph.setY(-this.scroll.verticalBarPos,t===1),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(ot.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(r=this.table.theme.scrollStyle)===null||r===void 0?void 0:r.width,scrollWidth:(o=this.table.theme.scrollStyle)===null||o===void 0?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t,dy:h}),a!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd()}updateHorizontalScrollBar(t){var e,i,r,o;const s=this.table.getAllColsWidth(),a=this.scroll.horizontalBarPos;let l=Math.ceil(t*(s-this.table.scenegraph.width));Y(l)&&!isNaN(l)||(l=0);const h=l-this.table.scenegraph.proxy.deltaX-a;if(this.table.fireListeners(ot.CAN_SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:l-this.table.scenegraph.proxy.deltaX,scrollHeight:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,scrollWidth:(i=this.table.theme.scrollStyle)===null||i===void 0?void 0:i.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:h}).some(u=>u===!1)){const u=this.scroll.horizontalBarPos/(s-this.table.scenegraph.width);this.table.scenegraph.component.updateHorizontalScrollBarPos(u)}else this.scroll.horizontalBarPos=l,this.table.scenegraph.setX(-this.scroll.horizontalBarPos,t===1),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(ot.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(r=this.table.theme.scrollStyle)===null||r===void 0?void 0:r.width,scrollWidth:(o=this.table.theme.scrollStyle)===null||o===void 0?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t,dx:h}),a!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd()}setScrollTop(t,e,i=!0){var r,o,s,a,l,h,u;const d=this.table.getAllRowsHeight(),c=!((r=this.table.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound?1:0;t=Math.max(0,Math.min(t,d-this.table.scenegraph.height-c)),t=Math.ceil(t);const f=this.scroll.verticalBarPos,g=t/(d-this.table.scenegraph.height);if((f!==t||((s=(o=this.table.options)===null||o===void 0?void 0:o.customConfig)===null||s===void 0?void 0:s.scrollEventAlwaysTrigger)===!0)&&i){let v=t;Y(v)&&!isNaN(v)||(v=0);const m=v-f;if(this.table.fireListeners(ot.CAN_SCROLL,{event:e?.nativeEvent,scrollTop:v,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(a=this.table.theme.scrollStyle)===null||a===void 0?void 0:a.width,scrollWidth:(l=this.table.theme.scrollStyle)===null||l===void 0?void 0:l.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:g,dy:m}).some(y=>y===!1)){const y=this.scroll.verticalBarPos/(d-this.table.scenegraph.height);return void this.table.scenegraph.component.updateVerticalScrollBarPos(y)}}(t!==this.scroll.verticalBarPos||this.table.isPivotChart())&&this.updateHoverPos(-1,-1),this.scroll.verticalBarPos=t,Y(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-t),this.table.scenegraph.component.updateVerticalScrollBarPos(g);const p=this.scroll.verticalBarPos-f;this.table.fireListeners(ot.SCROLL,{event:e?.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(h=this.table.theme.scrollStyle)===null||h===void 0?void 0:h.width,scrollWidth:(u=this.table.theme.scrollStyle)===null||u===void 0?void 0:u.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:g,dy:p}),f!==t&&i&&this.checkVerticalScrollBarEnd()}setScrollLeft(t,e,i=!0){var r,o,s,a,l,h,u;this.table.scrollLeft;const d=this.table.getAllColsWidth(),c=(this.table.getFrozenColsWidth(),!((r=this.table.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound?1:0);t=Math.max(0,Math.min(t,d-this.table.scenegraph.width-c)),t=Math.ceil(t);const f=this.scroll.horizontalBarPos,g=t/(d-this.table.scenegraph.width);if((f!==t||((s=(o=this.table.options)===null||o===void 0?void 0:o.customConfig)===null||s===void 0?void 0:s.scrollEventAlwaysTrigger)===!0)&&i){let v=t;Y(v)&&!isNaN(v)||(v=0);const m=v-f;if(this.table.fireListeners(ot.CAN_SCROLL,{event:e?.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:v,scrollHeight:(a=this.table.theme.scrollStyle)===null||a===void 0?void 0:a.width,scrollWidth:(l=this.table.theme.scrollStyle)===null||l===void 0?void 0:l.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:g,dx:m}).some(y=>y===!1)){const y=this.scroll.horizontalBarPos/(d-this.table.scenegraph.width);return void this.table.scenegraph.component.updateHorizontalScrollBarPos(y)}}t!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1),this.scroll.horizontalBarPos=t,Y(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-t),this.table.scenegraph.component.updateHorizontalScrollBarPos(g);const p=this.scroll.horizontalBarPos-f;this.table.fireListeners(ot.SCROLL,{event:e?.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(h=this.table.theme.scrollStyle)===null||h===void 0?void 0:h.width,scrollWidth:(u=this.table.theme.scrollStyle)===null||u===void 0?void 0:u.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:g,dx:p}),f!==t&&i&&this.checkHorizontalScrollBarEnd()}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(t){this.table.scenegraph.component.showVerticalScrollBar(),t&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var e;(e=this.table.scenegraph)===null||e===void 0||e.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(t){var e;this.table.scenegraph.component.showHorizontalScrollBar(),(e=this.table.scenegraph)===null||e===void 0||e.component.showFrozenColumnShadow(),t&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var i,r;(i=this.table.scenegraph)===null||i===void 0||i.component.hideFrozenColumnShadow(),(r=this.table.scenegraph)===null||r===void 0||r.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(t,e,i,r){this.menu.isShow&&this.menu.x===i&&this.menu.y===r?this.hideMenu():this.showContextMenu(t,e,i,r)}showContextMenu(t,e,i,r){var o;!((o=this.table.internalProps.menu)===null||o===void 0)&&o.contextMenuItems&&(this.table.internalProps.menu.renderMode==="html"?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=i,this.menu.y=r,this.table.scenegraph.component.menu.attach(i,r,t,e,lo.contextmenu)),this.table.fireListeners(ot.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"contextmenu"}))}triggerDropDownMenu(t,e,i,r,o){this.table.fireListeners(ot.DROPDOWN_ICON_CLICK,{col:t,row:e,event:o}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(t,e,i,r)}showDropDownMenu(t,e,i,r){this.table.internalProps.menu.renderMode==="html"?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(i,r,t,e,lo.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(ot.SHOW_MENU,{x:i,y:r,col:t,row:e,type:"dropDown"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);const o=this.table.scenegraph.getCell(t,e);let s;o.forEachChildren(a=>a.attribute.funcType===Fe.dropDown&&(s=a,!0)),s&&(this.residentHoverIcon={col:t,row:e,icon:s},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,o),this.table.scenegraph.residentHoverIcon(t,e))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(ot.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(ot.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null))}setDropDownMenuHighlight(t){this.menu.dropDownMenuHighlight=t;for(let e=0;e<t.length;e++){const{col:i,row:r}=t[e],o=this.table.getCellRange(i,r);if(o)for(let s=o.start.col;s<=o.end.col;s++)for(let a=o.start.row;a<=o.end.row;a++)this.table.scenegraph.updateCellContent(s,a)}}dropDownMenuIsHighlight(t,e,i){const r=this.menu.dropDownMenuHighlight;if(Array.isArray(r))for(let o=0;o<r.length;o++){const s=r[o];let{col:a,row:l}=s;const{field:h,menuKey:u}=s;if(typeof a!="number"||typeof l!="number")if(this.table.isPivotTable()){const d=this.table.internalProps.layoutMap.getPivotCellAdress(h);if(!d)continue;a=d.col,l=d.row}else{const d=this.table.internalProps.layoutMap.getHeaderCellAddressByField(h);if(!d)continue;a=d.col,l=d.row}if(Y(a)&&Y(l)&&this.table.isCellRangeEqual(t,e,a,l)){let d=this.table._getHeaderLayoutMap(a??t,l??e).dropDownMenu||this.table.globalDropDownMenu;if(typeof d=="function"&&(d=d({row:l,col:a,table:this.table})),d)for(let c=0;c<d.length;c++){const f=d[c];if(pn(f)&&(f.menuKey||f.text)===(u||"")&&c===i||Si(f)&&f===u&&c===i)return!0}}}return!1}triggerSort(t,e,i,r){if(this.table.isPivotTable()){const c=this.table.getPivotSortState(t,e),f=c?c.toUpperCase():"NORMAL",g=f==="ASC"?"DESC":f==="DESC"?"NORMAL":"ASC";return this.table.sort(t,e,g),void this.table.fireListeners(qv.PIVOT_SORT_CLICK,{col:t,row:e,order:f||"normal",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(t,e),cellLocation:this.table.getCellLocation(t,e),event:r})}const o=[...this.sort],s=this.table.internalProps.multipleSort||!o.length?null:this.sort[this.sort.length-1];A6t(t,e,this.table,r);const a=this.table.getCellRange(t,e),l=this.sort.find(c=>c.col===a.start.col&&c.row===a.start.row),h=this.table.internalProps.multipleSort||!s?null:s.col,u=this.table.internalProps.multipleSort||!s?null:s.row,d=o.findIndex(c=>c.col===t&&c.row===e);d>=0&&o.splice(d,1),this.table.scenegraph.updateSortIcon({col:t,row:e,iconMark:i,order:l?.order,oldSortCol:h,oldSortRow:u,oldIconMark:s?.icon}),l&&(l.icon=i),this.table.internalProps.multipleSort||o.forEach(c=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:"normal",oldSortCol:c.col,oldSortRow:c.row,oldIconMark:null})}),this.table.fireListeners(qv.AFTER_SORT,{order:l?.order,field:this.table.getHeaderField(t,e),event:r})}setSelectInline(t){this.select.selectInline=t}updateSortState(t){var e,i,r,o,s,a,l,h;t=Array.isArray(t)?t:[t];for(let d=0;d<t.length;d++){if(t[d].field===((e=this.sort[d])===null||e===void 0?void 0:e.field)&&t[t.length-1].order===((i=this.sort[d])===null||i===void 0?void 0:i.order))return;const c=this.table.internalProps.multipleSort?null:((r=this.sort[d])===null||r===void 0?void 0:r.col)||null,f=this.table.internalProps.multipleSort?null:((o=this.sort[d])===null||o===void 0?void 0:o.row)||null;((s=this.sort[d])===null||s===void 0?void 0:s.order)==="asc"||(a=this.sort[d])===null||a===void 0||a.order,this.setSortState(t.slice(0,d+1));const g=this.table.internalProps.layoutMap.getHeaderCellAddressByField(t[d].field);this.sort[d].col=g.col,this.sort[d].row=g.row;const p=this.table.scenegraph.getCell(this.sort[d].col,this.sort[d].row);let v;wD(p,"children",m=>m.attribute.funcType==="sort"&&(v=m,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[d].col,row:this.sort[d].row,iconMark:v,order:this.sort[d].order,oldSortCol:c,oldSortRow:f,oldIconMark:(l=this.sort[d])===null||l===void 0?void 0:l.icon})}const u=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(d=>{t.some(c=>c.field===d.field)||u.push(d)});for(let d=0;d<u.length;d++){const c=u[d];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:(h=c.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&h!==void 0?h:0,oldSortRow:c.level,oldIconMark:null})}}triggerFreeze(t,e,i){if(!this.table.isPivotTable()&&!this.table.transpose){if(S6t(t,e,this.table),this.table.hasListeners(qv.FREEZE_CLICK)){const r=this.table.internalProps.layoutMap.columnObjects.slice(0,t+1);this.table.fireListeners(qv.FREEZE_CLICK,{col:t,row:e,fields:r.reduce((o,s)=>o.concat(s.field),[]),colCount:this.table.frozenColCount})}this.frozen.icon=i}}updateCursor(t){var e;t||(t=(e=this.table.options.defaultCursor)!==null&&e!==void 0?e:"default"),this.table.getElement().style.cursor=t}updateDrillState(t,e,i,r,o,s){this.drill.dimensionKey=t,this.drill.title=e,this.drill.drillDown=i,this.drill.drillUp=r,this.drill.col=o,this.drill.row=s,B6t(o,s,i,r,this.table)}updateSparklineHoverPose(t,e,i,r){this.sparkLine.col!==-1&&this.sparkLine.row!==-1&&P6t(this.sparkLine.col,this.sparkLine.row,this.table);let o=!1;t!==-1&&e!==-1&&(o=k6t(t,e,i,r,this.table)),o?(this.sparkLine.col=t,this.sparkLine.row=e):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(t,e,i,r){return j6t(t,e,i,r,this)}setHeaderCheckedState(t,e){return U6t(t,e,this)}syncCheckedState(t,e,i,r){return X6t(t,e,i,r,this)}initCheckedState(t){return Y6t(t,this)}updateHeaderCheckedState(t,e,i){return K6t(t,this,e,i)}initLeftRecordsCheckState(t){return q6t(t,this)}setRadioState(t,e,i,r,o){N6t(t,e,i,r,o,this)}syncRadioState(t,e,i,r,o,s){return V6t(t,e,i,r,o,s,this)}changeCheckboxAndRadioOrder(t,e){this.checkedState.size&&J6t(t,e,this),this.radioState.length&&$6t(t,e,this)}setCustomSelectRanges(t){sVt(this),aVt(t,this)}};function hVt(n){ye.mode==="browser"&&n.on(ot.CLICK_CELL,t=>{const{col:e,row:i}=t;if(t.target.type==="image"&&t.target.role&&t.target.role.startsWith("icon"))return;let r;r=n.internalProps.layoutMap.isHeader(e,i)?n.isPivotTable()?n._getHeaderLayoutMap(e,i).headerType:n.getHeaderDefine(e,i).headerType:n.getBodyColumnType(e,i);const o=n.isHeader(e,i)?n.getHeaderDefine(e,i):n.getBodyColumnDefine(e,i),s=n.getCellValue(e,i),a=n.getCellOriginValue(e,i);if(r==="link"){let l=Ie(o.linkJump,{col:e,row:i,table:n,value:s,dataValue:a,cellHeaderPaths:void 0});if(l=l!==!1,!l)return;const h=o.templateLink;let u,d=Ie(o.linkDetect,{col:e,row:i,table:n,value:s,dataValue:a,cellHeaderPaths:void 0});if(d=d!==!1,h){const g=n.getCellOriginRecord(e,i);if(g&&g.vtableMerge)return;const p=Object.assign({__value:s,__dataValue:a},g);if(Bo(h))u=h(p,e,i,n);else{const v=/\{\s*(\S+?)\s*\}/g;u=h.replace(v,(m,y)=>p[y])}}else if(d){if(!xD.test(s))return;u=s}else u=s;if(!u)return;const c=o.linkTarget,f=o.linkWindowFeatures;window.open(u,c,f)}else if(r==="image"){const{clickToPreview:l}=o;if(l===!1)return;const h=document.createElement("div");h.style.width="100%",h.style.height="100%",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.backgroundColor="rgba(30, 30, 30, 0.4)",h.style.display="flex",h.style.justifyContent="center",h.style.alignItems="center",h.style.overflow="hidden",h.style.zIndex="9999",h.addEventListener("click",d=>{d.target===h&&document.body.removeChild(h)});const u=new Image;u.src=s,u.style.maxWidth="80%",u.style.maxHeight="80%",h.appendChild(u),document.body.appendChild(h)}else if(r==="video"){const{clickToPreview:l}=o;if(l===!1)return;const h=document.createElement("div");h.style.width="100%",h.style.height="100%",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.backgroundColor="rgba(30, 30, 30, 0.4)",h.style.display="flex",h.style.justifyContent="center",h.style.alignItems="center",h.style.overflow="hidden",h.style.zIndex="9999",h.addEventListener("click",d=>{d.target===h&&document.body.removeChild(h)});const u=document.createElement("video");u.src=s,u.style.maxWidth="80%",u.style.maxHeight="80%",u.setAttribute("preload","auto"),u.setAttribute("controls","true"),h.appendChild(u),document.body.appendChild(h)}})}function uVt(n){n.on(ot.MOUSEENTER_CELL,t=>{const{col:e,row:i}=t;if(e===-1||i===-1)return;const r=n.internalProps.layoutMap.getHeaderDimension(e,i);r?.drillDown||r?.drillUp?n.stateManager.updateDrillState(r.dimensionKey,r.title,r.drillDown,r.drillUp,e,i):n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),n.on(ot.MOUSELEAVE_TABLE,t=>{n.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})}function dVt(n){n.fireListeners(qv.DRILLMENU_CLICK,n.stateManager.drill)}function cVt(n){const t=n.internalProps.layoutMap.rowsDefine,e=n.internalProps.layoutMap.columnsDefine;for(let i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&(r.drillDown||r.drillUp))return!0}for(let i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&(r.drillDown||r.drillUp))return!0}return!1}function iG(n){if(n.eventManager.bindSparklineHoverEvent)return;let t=!1;n.isPivotTable()?t=n.internalProps.layoutMap.indicatorsDefine.some(e=>typeof e!="string"&&e.cellType==="sparkline"):t=n.internalProps.layoutMap.columnObjects.some(e=>e.cellType==="sparkline"||typeof e.cellType=="function"),t&&(n.eventManager.bindSparklineHoverEvent=!0,n.on(ot.MOUSEMOVE_CELL,e=>{const{col:i,row:r,x:o,y:s}=e;n.getBodyColumnType(i,r)!=="sparkline"&&n.stateManager.updateSparklineHoverPose(-1,-1,0,0),n.stateManager.updateSparklineHoverPose(i,r,o,s)}),n.on(ot.MOUSELEAVE_TABLE,e=>{n.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}function Px(n,t,e=!0){var i,r,o;let{deltaX:s,deltaY:a}=n;n.shiftKey&&n.deltaY&&(s=a,a=0);const[l,h]=fVt(s,a,{horizontal:1,vertical:1});(l||h)&&t.interactionState!==Ft.scrolling&&t.updateInteractionState(Ft.scrolling);const u=((r=(i=t.table.options.theme)===null||i===void 0?void 0:i.scrollStyle)===null||r===void 0?void 0:r.visible)==="scrolling";l&&(t.setScrollLeft(t.scroll.horizontalBarPos+l,n),t.showHorizontalScrollBar(u)),h&&(t.setScrollTop(t.scroll.verticalBarPos+h,n),t.showVerticalScrollBar(u)),e&&t.resetInteractionState(t.interactionStateBeforeScroll),!((o=n.nativeEvent)===null||o===void 0)&&o.cancelable&&(t.table.internalProps.overscrollBehavior==="none"||Math.abs(a)>=Math.abs(s)&&a!==0&&VJ(a,t)||Math.abs(a)<=Math.abs(s)&&s!==0&&GJ(s,t))&&n.nativeEvent.preventDefault()}function fVt(n,t,e){var i,r;const o=Math.abs(n/t),s=o<=.5?0:n,a=o>2?0:t;return[Math.ceil(s*((i=e.horizontal)!==null&&i!==void 0?i:0)),Math.ceil(a*((r=e.vertical)!==null&&r!==void 0?r:0))]}function VJ(n,t){return t.table.getAllRowsHeight()-t.table.scenegraph.height!=0&&!gVt(n,t)&&!pVt(n,t)}function GJ(n,t){return t.table.getAllColsWidth()-t.table.scenegraph.width!=0&&!vVt(n,t)&&!mVt(n,t)}function gVt(n,t){return t.table.getAllRowsHeight()-t.table.scenegraph.height!==0&&n<=0&&t.scroll.verticalBarPos<1}function pVt(n,t){var e;const i=!((e=t.table.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound?1:0,r=t.table.getAllRowsHeight()-t.table.scenegraph.height;return r!==0&&n>=0&&Math.abs(t.scroll.verticalBarPos-r)<1+i}function vVt(n,t){return t.table.getAllColsWidth()-t.table.scenegraph.width!==0&&n<=0&&t.scroll.horizontalBarPos<1}function mVt(n,t){var e;const i=!((e=t.table.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound?1:0,r=t.table.getAllColsWidth()-t.table.scenegraph.width;return r!==0&&n>=0&&Math.abs(t.scroll.horizontalBarPos-r)<1+i}class yVt{constructor(t){this.stateManager=t}setScrollHandle(t){this.scrollHandle=t}startInertia(t,e,i){this.lastTime=Date.now(),this.speedX=t,this.speedY=e,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var t;const e=Date.now(),i=e-this.lastTime;let r=!0;const o=Math.pow(this.friction,i/16),s=o*this.speedX,a=o*this.speedY;let l=0,h=0;Math.abs(s)>.05&&(r=!1,l=(this.speedX+s)/2*i),Math.abs(a)>.05&&(r=!1,h=(this.speedY+a)/2*i),(t=this.scrollHandle)===null||t===void 0||t.call(this,l,h),r?this.runingId=null:(this.lastTime=e,this.speedX=s,this.speedY=a,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function cE(n,t,e){var i,r,o,s,a,l,h,u;if(t&&((i=n.stateManager.columnMove)===null||i===void 0?void 0:i.colSource)!==-1&&((r=n.stateManager.columnMove)===null||r===void 0?void 0:r.rowSource)!==-1&&((o=n.stateManager.columnMove)===null||o===void 0?void 0:o.colTarget)!==-1&&((s=n.stateManager.columnMove)===null||s===void 0?void 0:s.rowTarget)!==-1){if(n.hasListeners(ot.CHANGE_HEADER_POSITION)){const{colSource:d,rowSource:c,colTarget:f,rowTarget:g}=n.stateManager.columnMove,p=(a=n.stateManager.columnMove.rowSourceSize)!==null&&a!==void 0?a:0,v=(l=n.stateManager.columnMove.rowTargetSize)!==null&&l!==void 0?l:0;n.fireListeners(ot.CHANGE_HEADER_POSITION,{target:{col:f,row:g+v-p},source:{col:d,row:c},event:e})}}else if(!t&&n.hasListeners(ot.CHANGE_HEADER_POSITION_FAIL)){const d=(h=n.stateManager.columnMove.rowSourceSize)!==null&&h!==void 0?h:0,c=(u=n.stateManager.columnMove.rowTargetSize)!==null&&u!==void 0?u:0;n.fireListeners(ot.CHANGE_HEADER_POSITION_FAIL,{target:{col:n.stateManager.columnMove.colTarget,row:n.stateManager.columnMove.rowTarget+c-d},source:{col:n.stateManager.columnMove.colSource,row:n.stateManager.columnMove.rowSource},event:e})}}function bVt(n){const t=n.table,e=t.stateManager;t.scenegraph.tableGroup.addEventListener("pointermove",i=>{var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w;const C=(o=(r=t.eventManager.LastPointerXY)===null||r===void 0?void 0:r.x)!==null&&o!==void 0?o:i.x,x=(a=(s=t.eventManager.LastPointerXY)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:i.y;t.eventManager.LastPointerXY={x:i.x,y:i.y},n.touchSetTimeout&&(clearTimeout(n.touchSetTimeout),n.touchSetTimeout=void 0);const S=sn(i);if(S.eventArgs&&t.hasListeners(ot.MOUSEMOVE_TABLE)&&t.fireListeners(ot.MOUSEMOVE_TABLE,{col:S.eventArgs.col,row:S.eventArgs.row,x:S.abstractPos.x,y:S.abstractPos.y,event:i.nativeEvent,target:(l=S?.eventArgs)===null||l===void 0?void 0:l.target,mergeCellInfo:(h=S.eventArgs)===null||h===void 0?void 0:h.mergeInfo}),e.interactionState===Ft.grabing)return void(Math.abs(C-i.x)+Math.abs(x-i.y)>=1&&(e.isResizeCol()||e.isResizeRow()||(e.isMoveCol()?n.dealColumnMover(S):e.isFillHandle()?n.dealFillSelect(S,!0):((u=t.options.select)===null||u===void 0?void 0:u.disableDragSelect)||n.dealTableSelect(S,!0))));!(!((d=t.options.select)===null||d===void 0)&&d.disableDragSelect)&&t.eventManager.isDraging&&e.isSelecting()&&!(!((c=t.editorManager)===null||c===void 0)&&c.editingEditor)&&n.dealTableSelect(S,!0);const A=i.path.find(T=>T.role==="cell");if(t.hasListeners(ot.MOUSELEAVE_CELL)&&(t.stateManager.hover.cellPos.col===-1||t.stateManager.hover.cellPos.row===-1||A?.col===t.stateManager.hover.cellPos.col&&A?.row===t.stateManager.hover.cellPos.row||t.fireListeners(ot.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:(f=S?.eventArgs)===null||f===void 0?void 0:f.target})),t.hasListeners(ot.MOUSEENTER_CELL)&&(A?.role!=="cell"||!Y(A.col)||!Y(A.row)||A.col===t.stateManager.hover.cellPos.col&&A.row===t.stateManager.hover.cellPos.row||A.col===((g=t.stateManager.hover.cellPosContainHeader)===null||g===void 0?void 0:g.col)&&A.row===((p=t.stateManager.hover.cellPosContainHeader)===null||p===void 0?void 0:p.row)||t.fireListeners(ot.MOUSEENTER_CELL,{col:A.col,row:A.row,cellRange:t.getCellRangeRelativeRect({col:A.col,row:A.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:(v=S?.eventArgs)===null||v===void 0?void 0:v.target,mergeCellInfo:(m=S.eventArgs)===null||m===void 0?void 0:m.mergeInfo})),n.dealIconHover(S),n.dealTableHover(S),t.theme.columnResize.visibleOnHover&&n.checkColumnResize(S,!0),S.eventArgs&&t.hasListeners(ot.MOUSEMOVE_CELL)){let T,M;if(!((y=S.eventArgs)===null||y===void 0)&&y.target){const R=W0((b=S.eventArgs)===null||b===void 0?void 0:b.target);R&&(T=R.icon,M=R.position)}t.fireListeners(ot.MOUSEMOVE_CELL,{col:S.eventArgs.col,row:S.eventArgs.row,x:S.abstractPos.x,y:S.abstractPos.y,event:i.nativeEvent,targetIcon:T?{name:T.name,position:M,funcType:T.attribute.funcType}:void 0,target:(_=S?.eventArgs)===null||_===void 0?void 0:_.target,mergeCellInfo:(w=S.eventArgs)===null||w===void 0?void 0:w.mergeInfo})}}),t.scenegraph.tableGroup.addEventListener("pointerout",i=>{var r;const o=sn(i),s=(r=o?.eventArgs)===null||r===void 0?void 0:r.target;s?.role==="table"&&n.dealTableHover()}),t.scenegraph.tableGroup.addEventListener("pointerover",i=>{var r,o;const s=sn(i),a=(r=s?.eventArgs)===null||r===void 0?void 0:r.target;if(a&&t.hasListeners(ot.MOUSEOVER_CHART_SYMBOL)&&a.type==="symbol"){const l=i.composedPath().find(h=>h.roll==="cell");if(l){const{col:h,row:u}=l,d={col:h,row:u,field:t.getHeaderField(h,u),value:t.getCellValue(h,u),dataValue:t.getCellOriginValue(h,u),cellHeaderPaths:t.internalProps.layoutMap.getCellHeaderPaths(h,u),title:t.getBodyColumnDefine(h,u).title,cellRange:t.getCellRelativeRect(h,u),event:i.nativeEvent,sparkline:{pointData:void 0},scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:(o=s?.eventArgs)===null||o===void 0?void 0:o.target};t.fireListeners(ot.MOUSEOVER_CHART_SYMBOL,d)}}}),t.scenegraph.tableGroup.addEventListener("pointerenter",i=>{(t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.horizontalVisible==="focus"||!t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.visible==="focus")&&e.showHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.verticalVisible==="focus"||!t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.visible==="focus")&&e.showVerticalScrollBar(),t.hasListeners(ot.MOUSEENTER_TABLE)&&t.fireListeners(ot.MOUSEENTER_TABLE,{event:i.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerleave",i=>{e.isResizeCol()||e.isResizeRow()||e.isMoveCol()||e.isSelecting()||(e.updateInteractionState(Ft.default),e.updateCursor()),(t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.horizontalVisible==="focus"||!t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.visible==="focus")&&e.hideHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.verticalVisible==="focus"||!t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.visible==="focus")&&e.hideVerticalScrollBar(),t.hasListeners(ot.MOUSELEAVE_CELL)&&t.stateManager.hover.cellPos.col!==-1&&t.stateManager.hover.cellPos.row!==-1&&t.fireListeners(ot.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:void 0}),n.dealTableHover();const r=i.target;r&&!r.isDescendantsOf(t.scenegraph.tableGroup)&&t.fireListeners(ot.MOUSELEAVE_TABLE,{event:i.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerdown",i=>{var r,o,s,a,l;if(t.hasListeners(ot.MOUSEDOWN_TABLE)&&t.fireListeners(ot.MOUSEDOWN_TABLE,{event:i.nativeEvent}),LHt(),t.eventManager.isDown=!0,t.eventManager.LastBodyPointerXY={x:i.x,y:i.y},t.eventManager.LastPointerXY={x:i.x,y:i.y},i.button!==0)return;const h=sn(i);if(n.downIcon=void 0,e.interactionState!==Ft.default||(t.isPivotChart()&&((r=h?.eventArgs)===null||r===void 0?void 0:r.target.type)!=="chart"&&t.scenegraph.updateChartState(null),((o=h.eventArgs)===null||o===void 0?void 0:o.target)!==((s=e.residentHoverIcon)===null||s===void 0?void 0:s.icon)&&e.hideMenu(),((a=h?.eventArgs)===null||a===void 0?void 0:a.target.type)==="chart"))return;const u=(l=t.editorManager)===null||l===void 0?void 0:l.completeEdit(i.nativeEvent);J1(u,d=>{var c,f,g,p,v,m,y,b,_,w,C,x;if(!(!((c=t.options.customConfig)===null||c===void 0)&&c.selectCellWhenCellEditorNotExists)&&d===!1)return;const S=!((p=(g=(f=h?.eventArgs)===null||f===void 0?void 0:f.target)===null||g===void 0?void 0:g.role)===null||p===void 0)&&p.startsWith("icon")?h.eventArgs.target:!((v=i.target.role)===null||v===void 0)&&v.startsWith("icon")?i.target:void 0;if(n.downIcon=S,S&&S.attribute.interactive!==!1)S.attribute.funcType===Fe.dragReorder&&(e.startMoveCol(h.eventArgs.col,h.eventArgs.row,h.abstractPos.x,h.abstractPos.y,(C=(w=h.eventArgs)===null||w===void 0?void 0:w.event)===null||C===void 0?void 0:C.nativeEvent),e.updateInteractionState(Ft.grabing));else{if(n.cellIsHeaderCheck(h))return;if(i.pointerType==="touch"){if(n.touchEnd=!1,n.touchSetTimeout=setTimeout(()=>{n.isTouchdown=!1,n.isLongTouch=!0,(n.touchEnd||!n.checkColumnResize(h,!0)&&!n.checkRowResize(h,!0))&&(n.touchEnd||!n.checkColumnMover(h))?n.dealTableSelect(h)&&!n.touchEnd&&e.updateInteractionState(Ft.grabing):e.updateInteractionState(Ft.grabing)},500),t.hasListeners(ot.MOUSEENTER_CELL)){const A=i.path.find(T=>T.role==="cell");A?.role!=="cell"||!Y(A.col)||!Y(A.row)||A.col===t.stateManager.hover.cellPos.col&&A.row===t.stateManager.hover.cellPos.row||A.col===((m=t.stateManager.hover.cellPosContainHeader)===null||m===void 0?void 0:m.col)&&A.row===((y=t.stateManager.hover.cellPosContainHeader)===null||y===void 0?void 0:y.row)||t.fireListeners(ot.MOUSEENTER_CELL,{col:A.col,row:A.row,cellRange:t.getCellRangeRelativeRect({col:A.col,row:A.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:i.nativeEvent,target:(b=h?.eventArgs)===null||b===void 0?void 0:b.target,mergeCellInfo:(_=h.eventArgs)===null||_===void 0?void 0:_.mergeInfo})}n.dealTableHover(h)}else{if(!n.checkCellFillhandle(h)&&(n.checkColumnResize(h,!0)||n.checkRowResize(h,!0)))return t.scenegraph.updateChartState(null),void e.updateInteractionState(Ft.grabing);if(n.checkColumnMover(h)||n.checkCellFillhandle(h,!0)&&n.dealFillSelect(h))return void e.updateInteractionState(Ft.grabing);n.dealTableSelect(h)&&e.updateInteractionState(Ft.grabing)}}if(t.hasListeners(ot.MOUSEDOWN_CELL)){const A=sn(i);A.eventArgs&&t.fireListeners(ot.MOUSEDOWN_CELL,{col:A.eventArgs.col,row:A.eventArgs.row,event:i.nativeEvent,target:(x=A?.eventArgs)===null||x===void 0?void 0:x.target,mergeCellInfo:A.eventArgs.mergeInfo})}})}),t.scenegraph.tableGroup.addEventListener("pointerup",i=>{var r,o,s,a,l,h,u,d;if(i.button===0){if(e.interactionState==="grabing"){if(e.updateInteractionState(Ft.default),e.isResizeCol())kx(t);else if(e.isResizeRow())Ex(t);else if(e.isMoveCol()){const c=t.stateManager.endMoveCol();cE(t,c,i.nativeEvent)}else if(e.isSelecting()){t.stateManager.endSelectCells(),t.stateManager.isFillHandle()&&t.stateManager.endFillSelect();const c=sn(i);if(t.eventManager.isDraging&&c.eventArgs&&t.hasListeners(ot.DRAG_SELECT_END)){const f={event:i.nativeEvent,cells:[],col:c.eventArgs.target.col,row:c.eventArgs.target.row,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:(r=c?.eventArgs)===null||r===void 0?void 0:r.target,mergeCellInfo:(o=c.eventArgs)===null||o===void 0?void 0:o.mergeInfo};f.cells=t.getSelectedCellInfos(),t.fireListeners(ot.DRAG_SELECT_END,f)}}}else e.interactionState===Ft.scrolling&&e.updateInteractionState(Ft.default);if(!t.eventManager.isDraging){const c=sn(i);if(!n.isTouchMove&&i.button===0&&c.eventArgs&&t.hasListeners(ot.CLICK_CELL)){const{col:f,row:g}=c.eventArgs,p=t.getCellInfo(f,g);let v,m;if(!((s=c.eventArgs)===null||s===void 0)&&s.target){const b=W0((a=c.eventArgs)===null||a===void 0?void 0:a.target);b&&(v=b.icon,m=b.position)}const y=Object.assign(Object.assign({},p),{event:i.nativeEvent,federatedEvent:i,cells:[],targetIcon:v?{name:v.name,position:m,funcType:v.attribute.funcType}:void 0,target:(l=c?.eventArgs)===null||l===void 0?void 0:l.target,mergeCellInfo:(h=c.eventArgs)===null||h===void 0?void 0:h.mergeInfo});t.fireListeners(ot.CLICK_CELL,y)}}if(t.hasListeners(ot.MOUSEUP_CELL)){const c=sn(i);c.eventArgs&&t.fireListeners(ot.MOUSEUP_CELL,{col:c.eventArgs.col,row:c.eventArgs.row,event:i.nativeEvent,target:(u=c?.eventArgs)===null||u===void 0?void 0:u.target,mergeCellInfo:(d=c.eventArgs)===null||d===void 0?void 0:d.mergeInfo})}setTimeout(()=>{n.isDown=!1,n.isTouchdown=!1,n.isTouchMove=!1,n.isDraging=!1,n.touchMovePoints=[]},0)}}),t.scenegraph.tableGroup.addEventListener("rightdown",i=>{var r,o,s,a,l,h,u;const d=sn(i);if(d.eventArgs){e.triggerContextMenu(d.eventArgs.col,d.eventArgs.row,d.abstractPos.x,d.abstractPos.y);const{col:c,row:f}=d.eventArgs;if(c>=0&&f>=0){const g=t.getSelectedCellRanges();let p=!1;if(g.length>0)for(let m=0;m<g.length;m++){const y=g[m],b=y.start.col,_=y.end.col,w=y.start.row,C=y.end.row;if(c>=b&&c<=_&&f>=w&&f<=C||c>=_&&c<=b&&f>=C&&f<=w||c>=b&&c<=_&&f>=C&&f<=w||c>=_&&c<=b&&f>=w&&f<=C){p=!0;break}}const v=(r=t.options.select)===null||r===void 0?void 0:r.disableSelectOnContextMenu;if(p||v||t.selectCell(c,f),t.hasListeners(ot.CONTEXTMENU_CELL)){const m=t.getCellInfo(c,f);let y,b;if(!((o=d.eventArgs)===null||o===void 0)&&o.target){const w=W0((s=d.eventArgs)===null||s===void 0?void 0:s.target);w&&(y=w.icon,b=w.position)}const _=Object.assign(Object.assign({},m),{event:i.nativeEvent,cells:[],targetIcon:y?{name:y.name,position:b,funcType:y.attribute.funcType}:void 0,target:(a=d?.eventArgs)===null||a===void 0?void 0:a.target,mergeCellInfo:(l=d.eventArgs)===null||l===void 0?void 0:l.mergeInfo});((u=(h=t.options.eventOptions)===null||h===void 0?void 0:h.contextmenuReturnAllSelectedCells)===null||u===void 0||u)&&(QHt(t.stateManager.select.ranges,c,f)?_.cells=t.getSelectedCellInfos():_.cells=[[m]]),t.fireListeners(ot.CONTEXTMENU_CELL,_)}}}}),t.scenegraph.tableGroup.addEventListener("pointertap",i=>{var r;if(t.stateManager.columnResize.resizing)return;const o=sn(i);if(!t.stateManager.columnResize.resizing&&!t.stateManager.columnMove.moving&&(n.dealIconClick(i,o),o?.eventArgs&&n.touchSetTimeout&&i.pointerType==="touch")){const s=sn(i);if(n.touchSetTimeout){clearTimeout(n.touchSetTimeout);const a=!!(!((r=e.select.ranges)===null||r===void 0)&&r.length);n.dealTableSelect(s),e.endSelectCells(!0,a),n.touchSetTimeout=void 0}}}),t.scenegraph.stage.addEventListener("pointerdown",i=>{var r,o,s,a;const l=sn(i);!((r=l.eventArgs)===null||r===void 0)&&r.target&&((o=l.eventArgs)===null||o===void 0?void 0:o.target)===((s=e.residentHoverIcon)===null||s===void 0?void 0:s.icon)||e.hideMenu();let h=!1;const u=i.target;u===t.scenegraph.tableGroup||u.isDescendantsOf(t.scenegraph.tableGroup)||(h=(a=t.editorManager)===null||a===void 0?void 0:a.completeEdit(i.nativeEvent)),J1(h,d=>{var c,f;if(!(!((c=t.options.customConfig)===null||c===void 0)&&c.selectCellWhenCellEditorNotExists)&&d===!1)return;const g=!((f=i.target.role)===null||f===void 0)&&f.startsWith("icon")?i.target:void 0;if(n.downIcon=g,!(i.pointerType==="touch"||g||n.checkCellFillhandle(l)||e.columnResize.resizing||!n.checkColumnResize(l,!0))){t.scenegraph.updateChartState(null),e.updateInteractionState(Ft.grabing);const{eventArgs:p}=l;p?.targetCell||t.getCellAt(l.abstractPos.x-t.theme.columnResize.resizeHotSpotSize/2,l.abstractPos.y)&&t.hasListeners(ot.MOUSEDOWN_TABLE)&&t.fireListeners(ot.MOUSEDOWN_TABLE,{event:i.nativeEvent})}})}),t.scenegraph.stage.addEventListener("pointerup",i=>{e.interactionState==="grabing"&&(e.updateInteractionState(Ft.default),e.isResizeCol()?kx(t):e.isResizeRow()&&Ex(t))}),t.scenegraph.stage.addEventListener("pointertap",i=>{var r,o,s,a,l;const h=i.target;if(t.eventManager.isDraging||!h||!h.isDescendantsOf(t.scenegraph.stage)&&h.stage!==h||h.isDescendantsOf(t.scenegraph.tableGroup))t.eventManager.isDraging&&e.isSelecting()&&e.endSelectCells();else{e.updateInteractionState(Ft.default),n.dealTableHover();const u=!!(!((r=e.select.ranges)===null||r===void 0)&&r.length);!((o=t.options.customConfig)===null||o===void 0)&&o.cancelSelectCellHook?!((s=t.options.customConfig)===null||s===void 0)&&s.cancelSelectCellHook(i)&&n.dealTableSelect():((l=(a=t.options.select)===null||a===void 0?void 0:a.blankAreaClickDeselect)===null||l===void 0||l)&&n.dealTableSelect(),e.endSelectCells(!0,u),e.updateCursor(),t.scenegraph.updateChartState(null)}}),t.scenegraph.stage.addEventListener("pointermove",i=>{const r=sn(i);e.isResizeCol()||n.checkColumnResize(r)?t.stateManager.select&&n.checkCellFillhandle(r)?e.updateCursor("crosshair"):e.updateCursor("col-resize"):e.isResizeRow()||n.checkRowResize(r)?t.stateManager.select&&n.checkCellFillhandle(r)?e.updateCursor("crosshair"):e.updateCursor("row-resize"):e.isMoveCol()||e.updateCursor()}),t.scenegraph.tableGroup.addEventListener("checkbox_state_change",i=>{var r,o;const s=sn(i),{col:a,row:l}=s.eventArgs,h=t.getCellInfo(a,l),u=Ji(t,a,l);if(u)for(let c=u.start.col;c<=u.end.col;c++)for(let f=u.start.row;f<=u.end.row;f++)t.scenegraph.getCell(c,f).forEachChildren(g=>{g.name==="checkbox"&&g.setAttributes({checked:i.target.attribute.checked,indeterminate:i.target.attribute.indeterminate})});const d=Object.assign(Object.assign({},h),{event:i.nativeEvent,target:(r=s?.eventArgs)===null||r===void 0?void 0:r.target,mergeCellInfo:(o=s?.eventArgs)===null||o===void 0?void 0:o.mergeInfo,checked:i.detail.checked});if(t.isHeader(a,l))t.stateManager.setHeaderCheckedState(h.field,i.detail.checked),t.internalProps.enableHeaderCheckboxCascade&&t.getCellType(a,l)==="checkbox"&&t.scenegraph.updateCheckboxCellState(a,l,i.detail.checked);else if(t.stateManager.setCheckedState(a,l,h.field,i.detail.checked),t.internalProps.enableCheckboxCascade&&t.getCellType(a,l)==="checkbox"){const c=t.stateManager.headerCheckedState[h.field],f=t.stateManager.updateHeaderCheckedState(h.field,a,l);c!==f&&t.scenegraph.updateHeaderCheckboxCellState(a,l,f)}t.fireListeners(ot.CHECKBOX_STATE_CHANGE,d),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("radio_checked",i=>{var r,o,s;const a=sn(i),{col:l,row:h,target:u}=a.eventArgs,d=t.getCellInfo(l,h),c=(r=q5t.exec(u.id))===null||r===void 0?void 0:r[1],f=Ji(t,l,h);if(f)for(let m=f.start.col;m<=f.end.col;m++)for(let y=f.start.row;y<=f.end.row;y++)t.scenegraph.getCell(m,y).forEachChildren(b=>{b.name==="radio"&&b.id===u.id&&b.setAttributes({checked:!0})});const g=t.getBodyColumnDefine(l,h).radioCheckType||"column";if(g==="cell")if(f)for(let m=f.start.col;m<=f.end.col;m++)for(let y=f.start.row;y<=f.end.row;y++)t.scenegraph.getCell(m,y).forEachChildren(b=>{b.name==="radio"&&b.id!==u.id&&b.setAttributes({checked:!1})});else t.scenegraph.getCell(l,h).forEachChildren(m=>{m.name==="radio"&&m.id!==u.id&&m.setAttributes({checked:!1})});else g==="column"&&t.scenegraph.getColGroup(l).forEachChildren(m=>{m.forEachChildren(y=>{y.name==="radio"&&y.id!==u.id&&y.setAttributes({checked:!1})})});const p=c?Number(c):void 0;t.stateManager.setRadioState(l,h,d.field,g,p);const v=Object.assign(Object.assign({},d),{event:i.nativeEvent,target:(o=a?.eventArgs)===null||o===void 0?void 0:o.target,mergeCellInfo:(s=a?.eventArgs)===null||s===void 0?void 0:s.mergeInfo,radioIndexInCell:p});t.fireListeners(ot.RADIO_STATE_CHANGE,v),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("switch_state_change",i=>{var r,o;const s=sn(i),{col:a,row:l,target:h}=s.eventArgs,u=t.getCellInfo(a,l),d=Ji(t,a,l);if(d)for(let f=d.start.col;f<=d.end.col;f++)for(let g=d.start.row;g<=d.end.row;g++)t.scenegraph.getCell(f,g).forEachChildren(p=>{p.name==="switch"&&p.setAttributes({checked:i.target.attribute.checked})});const c=Object.assign(Object.assign({},u),{event:i.nativeEvent,target:(r=s?.eventArgs)===null||r===void 0?void 0:r.target,mergeCellInfo:(o=s?.eventArgs)===null||o===void 0?void 0:o.mergeInfo,checked:i.detail.checked});t.stateManager.setCheckedState(a,l,u.field,i.detail.checked),t.fireListeners(ot.SWITCH_STATE_CHANGE,c),t.scenegraph.updateNextFrame()}),t.scenegraph.stage.addEventListener("wheel",i=>{var r;i.path.find(o=>o.name==="legend")||((r=t.editorManager)===null||r===void 0||r.completeEdit(),t.eventManager._enableTableScroll&&Px(i,e))})}function _Vt(n){const t=n.table;n.gesture=new kPt(t.scenegraph.tableGroup,{tap:{interval:300}}),n.gesture.on("doubletap",e=>{CVt(e,t)})}function kx(n){n.stateManager.endResizeCol();const t=[];for(let e=0;e<n.colCount;e++)t.push(n.getColWidth(e));n.fireListeners(ot.RESIZE_COLUMN_END,{col:n.stateManager.columnResize.col,colWidths:t})}function Ex(n){n.stateManager.endResizeRow(),n.fireListeners(ot.RESIZE_ROW_END,{row:n.stateManager.rowResize.row,rowHeight:n.getRowHeight(n.stateManager.rowResize.row)})}function CVt(n,t){var e,i,r,o,s,a;const l=sn(n);let h=-1,u=-1;l.eventArgs&&(h=l.eventArgs.col,u=l.eventArgs.row);const d=t.getCellValue(h,u),c=(i=(e=l.eventArgs)===null||e===void 0?void 0:e.targetCell)===null||i===void 0?void 0:i.globalAABBBounds;if(c&&t.internalProps.focusControl.setFocusRect(new Ma(c.x1+t.scrollLeft,c.y1+t.scrollTop,c.x2-c.x1,c.y2-c.y1),d),t.hasListeners(ot.DBLCLICK_CELL)){const f=t.getCellInfo(h,u);let g,p;if(!((r=l.eventArgs)===null||r===void 0)&&r.target){const m=W0((o=l.eventArgs)===null||o===void 0?void 0:o.target);m&&(g=m.icon,p=m.position)}const v=Object.assign(Object.assign({},f),{event:n.nativeEvent,federatedEvent:n,cells:[],targetIcon:g?{name:g.name,position:p,funcType:g.attribute.funcType}:void 0,target:(s=l?.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(a=l?.eventArgs)===null||a===void 0?void 0:a.mergeInfo});t.fireListeners(ot.DBLCLICK_CELL,v)}}function wVt(n){const t=n.table,e=t.stateManager,i=t.scenegraph;i.component.vScrollBar.addEventListener("pointerover",s=>{e.showVerticalScrollBar()}),i.component.hScrollBar.addEventListener("pointerover",s=>{e.showHorizontalScrollBar()}),i.component.vScrollBar.addEventListener("pointerout",s=>{e.interactionState!==Ft.scrolling&&e.hideVerticalScrollBar()}),i.component.hScrollBar.addEventListener("pointerout",s=>{e.interactionState!==Ft.scrolling&&e.hideHorizontalScrollBar()}),i.component.vScrollBar.addEventListener("pointermove",s=>{i.table.stateManager.updateCursor("default"),s.stopPropagation()}),i.component.vScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation(),i.table.hasListeners(ot.MOUSEDOWN_TABLE)&&i.table.fireListeners(ot.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.vScrollBar.addEventListener("scrollDown",s=>{var a;i.table.eventManager.LastBodyPointerXY={x:s.x,y:s.y},i.table.eventManager.isDown=!0,e.interactionState!==Ft.scrolling&&e.updateInteractionState(Ft.scrolling),i.table.stateManager.hideMenu(),(a=i.table.editorManager)===null||a===void 0||a.completeEdit(),i.table.hasListeners(ot.MOUSEDOWN_TABLE)&&i.table.fireListeners(ot.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.vScrollBar.addEventListener("pointerup",()=>{e.fastScrolling=!1,i.table.eventManager.isDraging=!1,e.interactionState===Ft.scrolling&&e.updateInteractionState(Ft.default)}),i.component.vScrollBar.addEventListener("pointerupoutside",()=>{e.fastScrolling=!1,e.interactionState===Ft.scrolling&&e.updateInteractionState(Ft.default)}),i.component.vScrollBar.addEventListener("scrollUp",s=>{i.table.eventManager.isDraging=!1}),i.component.hScrollBar.addEventListener("pointermove",s=>{i.table.stateManager.updateCursor(),s.stopPropagation()}),i.component.hScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation(),i.table.hasListeners(ot.MOUSEDOWN_TABLE)&&i.table.fireListeners(ot.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.hScrollBar.addEventListener("scrollDown",s=>{var a;i.table.eventManager.LastBodyPointerXY={x:s.x,y:s.y},i.table.eventManager.isDown=!0,e.interactionState!==Ft.scrolling&&e.updateInteractionState(Ft.scrolling),i.table.stateManager.hideMenu(),(a=i.table.editorManager)===null||a===void 0||a.completeEdit(),i.table.hasListeners(ot.MOUSEDOWN_TABLE)&&i.table.fireListeners(ot.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),i.component.hScrollBar.addEventListener("pointerup",()=>{e.fastScrolling=!1,i.table.eventManager.isDraging=!1,e.interactionState===Ft.scrolling&&e.updateInteractionState(Ft.default)}),i.component.hScrollBar.addEventListener("pointerupoutside",()=>{e.fastScrolling=!1,e.interactionState===Ft.scrolling&&e.updateInteractionState(Ft.default)}),i.component.hScrollBar.addEventListener("scrollUp",s=>{i.table.eventManager.isDraging=!1});const r=F6(e.updateVerticalScrollBar,20),o=F6(e.updateHorizontalScrollBar,20);i.component.vScrollBar.addEventListener("scrollDrag",s=>{i.table.eventManager.isDown&&(i.table.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==Ft.scrolling&&e.updateInteractionState(Ft.scrolling);const a=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);r(a,s)}),i.component.hScrollBar.addEventListener("scrollDrag",s=>{i.table.eventManager.isDown&&(i.table.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==Ft.scrolling&&e.updateInteractionState(Ft.scrolling);const a=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);o(a)})}let hd=1;function $J(){return kZ?hd=1:(hd=Math.ceil(window.devicePixelRatio||1),hd>1&&hd%2!=0&&(hd+=1)),hd}$J();var p2=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function xVt(n){const t=n.table,e=t.stateManager,i=t.internalProps.handler;function r(l){var h;if(t.hasListeners(ot.KEYDOWN)){const u={keyCode:(h=l.keyCode)!==null&&h!==void 0?h:l.which,code:l.code,event:l,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth};t.fireListeners(ot.KEYDOWN,u)}}i.on(t.getElement(),"blur",l=>{n.dealTableHover()}),i.on(t.getElement(),"keydown",l=>{var h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K;const J={keyCode:(h=l.keyCode)!==null&&h!==void 0?h:l.which,code:l.code,event:l};if(t.fireListeners(ot.BEFORE_KEYDOWN,J),l.key==="a"&&(l.ctrlKey||l.metaKey))!((u=t.keyboardOptions)===null||u===void 0)&&u.selectAllOnCtrlA&&(l.preventDefault(),n.deelTableSelectAll());else if(e.select.cellPos.col>=0&&e.select.cellPos.row>=0&&(l.key==="ArrowUp"||l.key==="ArrowDown"||l.key==="ArrowLeft"||l.key==="ArrowRight")){if(((c=(d=t.options.keyboardOptions)===null||d===void 0?void 0:d.moveEditCellOnArrowKeys)===null||c===void 0||!c)&&(!((f=t.editorManager)===null||f===void 0)&&f.editingEditor)||((g=t.options.keyboardOptions)===null||g===void 0?void 0:g.moveSelectedCellOnArrowKeys)===!1)return;let q,X;if(l.preventDefault(),l.stopPropagation(),l.key==="ArrowUp"?l.ctrlKey||l.metaKey?(q=e.select.cellPos.col,X=0):(l.shiftKey,q=e.select.cellPos.col,X=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row-1))):l.key==="ArrowDown"?l.ctrlKey||l.metaKey?(q=e.select.cellPos.col,X=t.rowCount-1):(l.shiftKey,q=e.select.cellPos.col,X=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1))):l.key==="ArrowLeft"?l.ctrlKey||l.metaKey?(q=0,X=e.select.cellPos.row):(l.shiftKey,X=e.select.cellPos.row,q=Math.min(t.colCount-1,Math.max(0,e.select.cellPos.col-1))):l.key==="ArrowRight"&&(l.ctrlKey||l.metaKey?(q=t.colCount-1,X=e.select.cellPos.row):(l.shiftKey,X=e.select.cellPos.row,q=Math.min(t.colCount-1,Math.max(0,e.select.cellPos.col+1)))),zh(t,q,X))return;const it=(v=(p=t.options.keyboardOptions)===null||p===void 0?void 0:p.shiftMultiSelect)===null||v===void 0||v;t.selectCell(q,X,l.shiftKey&&it),(y=(m=t.options.keyboardOptions)===null||m===void 0?void 0:m.moveEditCellOnArrowKeys)!==null&&y!==void 0&&y&&(!((b=t.editorManager)===null||b===void 0)&&b.editingEditor)&&((_=t.editorManager)===null||_===void 0||_.completeEdit(),t.getElement().focus(),t.getEditor(q,X)&&((w=t.editorManager)===null||w===void 0||w.startEditCell(q,X)))}else if(l.key==="Escape")(C=t.editorManager)===null||C===void 0||C.cancelEdit(),t.getElement().focus();else if(l.key==="Enter"){if(!((x=t.editorManager)===null||x===void 0)&&x.editingEditor){if(r(l),(S=t.editorManager)===null||S===void 0||S.completeEdit(),t.getElement().focus(),((A=t.options.keyboardOptions)===null||A===void 0?void 0:A.moveFocusCellOnEnter)===!0){const q=e.select.cellPos.col,X=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1));if(zh(t,q,X))return;const it=(M=(T=t.options.keyboardOptions)===null||T===void 0?void 0:T.shiftMultiSelect)===null||M===void 0||M;t.selectCell(q,X,l.shiftKey&&it)}return}if(((R=t.options.keyboardOptions)===null||R===void 0?void 0:R.moveFocusCellOnEnter)===!0){const q=e.select.cellPos.col,X=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1));if(zh(t,q,X))return;const it=(P=(E=t.options.keyboardOptions)===null||E===void 0?void 0:E.shiftMultiSelect)===null||P===void 0||P;t.selectCell(q,X,l.shiftKey&&it)}else if(((k=(B=t.options.keyboardOptions)===null||B===void 0?void 0:B.editCellOnEnter)===null||k===void 0||k)&&((O=(L=t.stateManager.select.ranges)===null||L===void 0?void 0:L.length)!==null&&O!==void 0?O:0)===1){const q=t.stateManager.select.ranges[0].start.col,X=t.stateManager.select.ranges[0].start.row,it=t.stateManager.select.ranges[0].end.col,Z=t.stateManager.select.ranges[0].end.row;q===it&&X===Z&&t.getEditor(q,X)&&((D=t.editorManager)===null||D===void 0||D.startEditCell(q,X))}}else if(l.key==="Tab"){if(((H=(I=t.options.keyboardOptions)===null||I===void 0?void 0:I.moveFocusCellOnTab)===null||H===void 0||H)&&e.select.cellPos.col>=0&&e.select.cellPos.row>=0){if(e.select.cellPos.col===t.colCount-1&&e.select.cellPos.row===t.rowCount-1)return;let q,X;if(l.preventDefault(),e.select.cellPos.col===t.colCount-1?(X=Math.min(t.rowCount-1,e.select.cellPos.row+1),q=t.rowHeaderLevelCount):(X=e.select.cellPos.row,q=e.select.cellPos.col+1),zh(t,q,X))return;t.selectCell(q,X),!((F=t.editorManager)===null||F===void 0)&&F.editingEditor&&((G=t.editorManager)===null||G===void 0||G.completeEdit(),t.getElement().focus(),t.getEditor(q,X)&&((j=t.editorManager)===null||j===void 0||j.startEditCell(q,X)))}}else if(!l.ctrlKey&&!l.metaKey){const q=t.options.editCellTrigger;if((q==="keydown"||Array.isArray(q)&&q.includes("keydown"))&&!(!((W=t.editorManager)===null||W===void 0)&&W.editingEditor)){const X=/^[a-zA-Z0-9+\-*\/%=.,\s]$/;l.key.match(X)&&(t.editorManager&&(t.editorManager.beginTriggerEditCellMode="keydown"),(K=t.editorManager)===null||K===void 0||K.startEditCell(e.select.cellPos.col,e.select.cellPos.row,""))}}r(l)}),i.on(t.getElement(),"copy",l=>p2(this,void 0,void 0,function*(){var h;!((h=t.keyboardOptions)===null||h===void 0)&&h.copySelected&&n.handleCopy(l)})),i.on(t.getElement(),"cut",l=>p2(this,void 0,void 0,function*(){var h;!((h=t.keyboardOptions)===null||h===void 0)&&h.cutSelected&&n.handleCut(l)})),i.on(t.getElement(),"paste",l=>p2(this,void 0,void 0,function*(){var h;!((h=t.keyboardOptions)===null||h===void 0)&&h.pasteValueToCell&&n.handlePaste(l)})),i.on(t.getElement(),"contextmenu",l=>{var h;((h=t.eventOptions)===null||h===void 0?void 0:h.preventDefaultContextMenu)!==!1?l.preventDefault():s(l)}),t.options.canvas||i.on(t.getContainer(),"resize",l=>{var h;t.isReleased||l.width===0&&l.height===0||((t.autoFillWidth||t.autoFillHeight)&&((h=t.editorManager)===null||h===void 0||h.completeEdit()),Y(t.options.pixelRatio)||t.setPixelRatio($J()),l.windowSizeNotChange||t.resize())});const o=l=>{var h;if(t.isReleased)return;t.eventManager.LastBodyPointerXY={x:l.x,y:l.y},t.eventManager.isDown=!0;const u=l.target;if(!t.getElement().contains(u)&&!t.internalProps.menuHandler.containElement(u)){const d=(h=t.editorManager)===null||h===void 0?void 0:h.completeEdit(l);J1(d,c=>{var f,g;if(c!==!1&&(!((f=t.options.select)===null||f===void 0)&&f.outsideClickDeselect)){const p=!!(!((g=e.select.ranges)===null||g===void 0)&&g.length);n.dealTableSelect(),e.endSelectCells(!0,p)}})}};n.globalEventListeners.push({name:"pointerdown",env:"vglobal",callback:o}),Dt.addEventListener("pointerdown",o);const s=l=>{var h,u;if(t.isReleased)return;const d=l.target;if(d!==t.canvas&&(c=>{var f,g;if(e.menu.isShow&&setTimeout(()=>{t.internalProps.menuHandler.pointInMenuElement(c.clientX,c.clientY)||e.menu.isShow&&e.hideMenu()},0),e.isResizeCol())kx(t);else if(e.isResizeRow())Ex(t);else if(e.isMoveCol()){const p=t.stateManager.endMoveCol();cE(t,p,c)}else if(e.isSelecting()&&(!((g=(f=t.stateManager.select)===null||f===void 0?void 0:f.ranges)===null||g===void 0)&&g.length)){const p=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.col,v=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.row;if(t.stateManager.endSelectCells(),t.hasListeners(ot.DRAG_SELECT_END)){const m={event:c,cells:[],col:p,row:v,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:void 0};m.cells=t.getSelectedCellInfos(),t.fireListeners(ot.DRAG_SELECT_END,m)}}})(l),t.eventManager.LastBodyPointerXY=null,t.eventManager.isDown=!1,t.eventManager.isDraging=!1,t.eventManager.inertiaScroll.endInertia(),e.interactionState==="grabing"&&e.isResizeCol())kx(t);else if(e.interactionState==="grabing"&&e.isResizeRow())Ex(t);else if(e.isMoveCol()){const c=t.stateManager.endMoveCol();cE(t,c,l)}else if(!((h=t.editorManager)===null||h===void 0)&&h.editingEditor&&!t.getElement().contains(d)){const c=(u=t.editorManager)===null||u===void 0?void 0:u.completeEdit(l);J1(c,f=>{f!==!1&&(e.updateInteractionState(Ft.default),n.dealTableHover())})}e.updateInteractionState(Ft.default)};n.globalEventListeners.push({name:"pointerup",env:"vglobal",callback:s}),Dt.addEventListener("pointerup",s);const a=l=>{var h,u,d,c,f;if(t.eventManager.isDown&&t.eventManager.LastBodyPointerXY){const m=(u=(h=t.eventManager.LastBodyPointerXY)===null||h===void 0?void 0:h.x)!==null&&u!==void 0?u:l.x,y=(c=(d=t.eventManager.LastBodyPointerXY)===null||d===void 0?void 0:d.y)!==null&&c!==void 0?c:l.y;(Math.abs(m-l.x)>1||Math.abs(y-l.y)>1)&&(t.eventManager.isDraging=!0)}const{x:g,y:p}=t._getMouseAbstractPoint(l);e.interactionState===Ft.grabing&&(e.isResizeCol()?(n.dealColumnResize(g,p),t.hasListeners(ot.RESIZE_COLUMN)&&t.fireListeners(ot.RESIZE_COLUMN,{col:t.stateManager.columnResize.col,colWidth:t.getColWidth(t.stateManager.columnResize.col)})):e.isResizeRow()&&(n.dealRowResize(g,p),t.hasListeners(ot.RESIZE_ROW)&&t.fireListeners(ot.RESIZE_ROW,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})));const v=t.stateManager.isSelecting();if(n._enableTableScroll&&n.isDraging&&v&&((f=t.stateManager.select.ranges)===null||f===void 0?void 0:f.length)>0){const m=t.getDrawRange(),y=t.getFrozenRowsHeight(),b=t.getBottomFrozenRowsHeight(),_=t.getFrozenColsWidth(),w=t.getRightFrozenColsWidth(),C=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].start;if(t.isSeriesNumber(C.col,C.row))return;const x=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end,S=(t.isFrozenRow(C.row)===!1||t.isFrozenRow(x.row)===!1)&&t.getAllRowsHeight()>t.tableNoFrameHeight,A=(t.isFrozenColumn(C.col)===!1||t.isFrozenColumn(x.col)===!1)&&t.getAllColsWidth()>t.tableNoFrameWidth;if((p>m.bottom-b||p<m.top+y)&&S||(g>m.right-w||g<m.left+_)&&A){t.eventManager.scrollXSpeed=0,t.eventManager.scrollYSpeed=0;let T=!1,M=!1,R=!1,E=!1;p>m.bottom-b&&S&&t.scrollTop+t.tableNoFrameHeight<t.getAllRowsHeight()?(T=!0,t.eventManager.scrollYSpeed=-(p-m.bottom+b)/50):p<m.top+y&&S&&t.scrollTop>0&&(M=!0,t.eventManager.scrollYSpeed=-(p-m.top-y)/50),g>m.right-w&&A&&t.scrollLeft+t.tableNoFrameWidth<t.getAllColsWidth()?(R=!0,t.eventManager.scrollXSpeed=-(g-m.right+w)/50):g<m.left+_&&A&&t.scrollLeft>0&&(E=!0,t.eventManager.scrollXSpeed=-(g-m.left-_)/50),t.eventManager.inertiaScroll.startInertia(t.eventManager.scrollXSpeed,t.eventManager.scrollYSpeed,1),t.eventManager.inertiaScroll.setScrollHandle((P,B)=>{var k;let L,O;Px({deltaX:-P,deltaY:-B},t.stateManager,!1),T?O=t.scrollTop+m.height-b-20:M&&(O=t.scrollTop+y+20),R?L=t.scrollLeft+m.width-w-20:E&&(L=t.scrollLeft+_+20);let D=!1,I=!1;R||E||(g>t.tableNoFrameWidth-t.getRightFrozenColsWidth()&&g<t.tableNoFrameWidth||g>0&&g<t.getFrozenColsWidth()?(L=g,I=!0):L=t.scrollLeft+g),T||M||(p>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()&&p<t.tableNoFrameHeight||p>0&&p<t.getFrozenRowsHeight()?(O=p,D=!0):O=t.scrollTop+p),t.stateManager.updateInteractionState(Ft.grabing);const H=t.getTargetColAtConsiderRightFrozen(L,I),F=t.getTargetRowAtConsiderBottomFrozen(O,D);!(!((k=t.options.select)===null||k===void 0)&&k.disableDragSelect)&&Y(H)&&Y(F)&&t.stateManager.updateSelectPos(t.stateManager.select.selectInline==="row"?t.colCount-1:H.col,t.stateManager.select.selectInline==="col"?t.rowCount-1:F.row,!1,!1,!1,!1)})}else t.eventManager.inertiaScroll.isInertiaScrolling()?t.eventManager.inertiaScroll.endInertia():t.eventManager.scrollYSpeed=0}};n.globalEventListeners.push({name:"pointermove",env:"vglobal",callback:a}),Dt.addEventListener("pointermove",a)}function SVt(n){const t=n.table,e=t.stateManager,i=t.scenegraph;if(Dt.envContribution.supportsTouchEvents===!1)return;Dt.addEventListener("contextmenu",a=>{a.stopPropagation(),a.preventDefault()},{capture:!0}),n.touchMovePoints=[],t.scenegraph.tableGroup.addEventListener("touchstart",a=>{var l,h,u,d,c,f,g,p;if(a.target.isChildOf(i.component.vScrollBar)||a.target.isChildOf(i.component.vScrollBar))return;n.isTouchdown=!0;const v=a.nativeEvent;n.touchMovePoints.push({x:t.rotateDegree?(u=(h=(l=v.changedTouches)===null||l===void 0?void 0:l[0])===null||h===void 0?void 0:h._canvasX)!==null&&u!==void 0?u:(d=a.canvas)===null||d===void 0?void 0:d.x:a.page.x,y:t.rotateDegree?(g=(f=(c=v.changedTouches)===null||c===void 0?void 0:c[0])===null||f===void 0?void 0:f._canvasY)!==null&&g!==void 0?g:(p=a.canvas)===null||p===void 0?void 0:p.y:a.page.y,timestamp:Date.now()})});const r=a=>{var l,h;if(n.isLongTouch&&a.preventDefault(),n.isTouchdown&&nG(a)){if(n.isTouchMove=!0,((h=(l=n.downIcon)===null||l===void 0?void 0:l.attribute)===null||h===void 0?void 0:h.funcType)===Fe.dragReorder)a.preventDefault();else if(n.touchMovePoints.length>4&&n.touchMovePoints.shift(),n.touchMovePoints.push({x:t.rotateDegree?a.changedTouches[0]._canvasX:a.changedTouches[0].pageX,y:t.rotateDegree?a.changedTouches[0]._canvasY:a.changedTouches[0].pageY,timestamp:Date.now()}),n._enableTableScroll){const u=-n.touchMovePoints[n.touchMovePoints.length-1].x+n.touchMovePoints[n.touchMovePoints.length-2].x,d=-n.touchMovePoints[n.touchMovePoints.length-1].y+n.touchMovePoints[n.touchMovePoints.length-2].y;Px({deltaX:u,deltaY:d},e),a.cancelable&&(t.internalProps.overscrollBehavior==="none"||Math.abs(d)>=Math.abs(u)&&d!==0&&VJ(d,e)||Math.abs(d)<=Math.abs(u)&&u!==0&&GJ(u,e))&&a.preventDefault()}}};Dt.addEventListener("touchmove",r,{passive:!1}),n.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:r});const o=a=>{var l,h,u,d;if(n.touchEnd=!0,n.isLongTouch=!1,n.isTouchdown&&nG(a)){if(((h=(l=n.downIcon)===null||l===void 0?void 0:l.attribute)===null||h===void 0?void 0:h.funcType)===Fe.dragReorder)a.preventDefault();else if(!((u=n.touchMovePoints)===null||u===void 0)&&u.length&&(n.touchMovePoints.length>4&&n.touchMovePoints.shift(),n.touchMovePoints.push({x:t.rotateDegree?a.changedTouches[0]._canvasX:a.changedTouches[0].pageX,y:t.rotateDegree?a.changedTouches[0]._canvasY:a.changedTouches[0].pageY,timestamp:Date.now()}),n._enableTableScroll)){const c=n.touchMovePoints[0],f=n.touchMovePoints[((d=n.touchMovePoints)===null||d===void 0?void 0:d.length)-1],g=(f.x-c.x)/(f.timestamp-c.timestamp),p=(f.y-c.y)/(f.timestamp-c.timestamp);n.inertiaScroll.startInertia(g,p,.95),t.eventManager.inertiaScroll.setScrollHandle((v,m)=>{Px({deltaX:-v,deltaY:-m},t.stateManager)})}n.isTouchdown=!1,n.isTouchMove=!1,n.isDraging=!1,n.touchMovePoints=[]}};Dt.addEventListener("touchend",o),n.globalEventListeners.push({name:"touchend",env:"vglobal",callback:o});const s=a=>{n.touchEnd=!0,n.isLongTouch=!1,n.isTouchdown&&(n.isTouchdown=!1,n.isTouchMove=!1,n.touchMovePoints=[],n.isDraging=!1)};Dt.addEventListener("touchcancel",s),n.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:s})}function nG(n){return!!n.changedTouches}function AVt(n){n.isPivotChart()&&n.scenegraph.tableGroup.addEventListener("click",t=>{var e;if(!n.stateManager.columnMove.moving&&!n.stateManager.columnResize.resizing)if(t.target.name==="axis-label"){const i=sn(t),{col:r,row:o}=i.eventArgs,s=n.internalProps.layoutMap;let a,l;s.indicatorsAsCol?(a=s.getDimensionKeyInChartSpec(s.rowHeaderLevelCount,o),l=s.getCellHeaderPaths(s.rowHeaderLevelCount-2,o).rowHeaderPaths):(a=s.getDimensionKeyInChartSpec(r,s.columnHeaderLevelCount),l=s.getCellHeaderPaths(r,s.columnHeaderLevelCount-1).colHeaderPaths);const h=l.map(u=>({key:u.dimensionKey,value:u.value})).filter(u=>u.key);if(h.push({key:a,value:t.target.attribute.text}),n._selectedDimensionInChart.length&&TVt(n._selectedDimensionInChart,h))return;n._selectedDimensionInChart=h,s.updateDataStateToChartInstance(),uE(n.scenegraph),n.scenegraph.updateNextFrame()}else!((e=n._selectedDimensionInChart)===null||e===void 0)&&e.length&&(n._selectedDimensionInChart.length=0,n.internalProps.layoutMap.updateDataStateToChartInstance(),uE(n.scenegraph),n.scenegraph.updateNextFrame())})}function TVt(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e].key!==t[e].key||n[e].value!==t[e].value)return!1;return!0}function MVt(n){n.isPivotChart()&&(n.on(ot.MOUSEENTER_CELL,t=>{n.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if(e.name==="axis"){const i=rG(t.col,t.row,n.internalProps.layoutMap);t.axisPosition=i,n.fireListeners(ot.MOUSEENTER_AXIS,t)}})}),n.on(ot.MOUSELEAVE_CELL,t=>{n.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if(e.name==="axis"){const i=rG(t.col,t.row,n.internalProps.layoutMap);t.axisPosition=i,n.fireListeners(ot.MOUSELEAVE_AXIS,t)}})}))}function rG(n,t,e){if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return"top";if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return"bottom";if(n===e.rowHeaderLevelCount-1&&t>=e.rowHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"left"}else{if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"left";if(n===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"right";if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return"bottom"}return"bottom"}function RVt(n){n.on("checkbox_state_change",t=>{var e;const{col:i,row:r,checked:o,field:s}=t;if(!n.internalProps.layoutMap.isSeriesNumber(i,r)||n.internalProps.enableCheckboxCascade!==!0||n.isHeader(i,r))return;const a=n.getCellOriginRecord(i,r),l=n.dataSource.currentPagerIndexedData,h=n.getRecordShowIndexByCell(i,r);let u=l[h];if(pt(u)&&(u=[u]),a.vtableMerge||((e=a.children)===null||e===void 0?void 0:e.length))if(o)Dx(n,i,r)===Lt.collapse?Ox(!0,u,n,s):Lx(!0,h,u,l,n,i),lg(h,u,l,n,i);else{Dx(n,i,r)===Lt.collapse?Ox(!1,u,n,s):Lx(!1,h,u,l,n,i),lg(h,u,l,n,i);const d=n.stateManager.headerCheckedState._vtable_rowSeries_number,c=n.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",i,r);d!==c&&n.scenegraph.updateHeaderCheckboxCellState(i,r,c)}else lg(h,u,l,n,i)})}function BVt(n){n.on("checkbox_state_change",t=>{var e;if(n.internalProps.enableCheckboxCascade!==!0)return;const{col:i,row:r,checked:o,field:s}=t,a=n.internalProps.columns.some(c=>c.tree);if(n.internalProps.enableCheckboxCascade,!a||n.isHeader(i,r))return;const l=n.getCellOriginRecord(i,r),h=n.dataSource.currentPagerIndexedData,u=n.getRecordShowIndexByCell(i,r);let d=h[u];if(pt(d)&&(d=[d]),l.vtableMerge||((e=l.children)===null||e===void 0?void 0:e.length))if(o)Dx(n,i,r)===Lt.collapse?Ox(!0,d,n,s):Lx(!0,u,d,h,n,i,s),lg(u,d,h,n,i,s);else{Dx(n,i,r)===Lt.collapse?Ox(!1,d,n,s):Lx(!1,u,d,h,n,i,s),lg(u,d,h,n,i,s);const c=n.stateManager.headerCheckedState._vtable_rowSeries_number,f=n.stateManager.updateHeaderCheckedState(s,i,r);c!==f&&n.scenegraph.updateHeaderCheckboxCellState(i,r,f)}else lg(u,d,h,n,i,s)})}function Lx(n,t,e,i,r,o,s){var a;const l=s||"_vtable_rowSeries_number";let h=t+1;for(;Mt(i[h])&&((a=i[h])===null||a===void 0?void 0:a.length)>e.length;){const u=r.columnHeaderLevelCount+h;r.stateManager.setCheckedState(o,u,l,n),wC(o,u,n,r),h++}}function lg(n,t,e,i,r,o){var s;let a=t.length-1;if(a>0){let l=n-1;for(;a>0&&l>=0;)(Mt(e[l])&&((s=e[l])===null||s===void 0?void 0:s.length)===a||a===1&&pt(e[l]))&&(PVt(r,i.columnHeaderLevelCount+l,e[l],i,o),a--),l--}}function PVt(n,t,e,i,r){const{checkedState:o}=i.stateManager,s=e.toString(),a=r||"_vtable_rowSeries_number";Mt(e)&&e.length;let l=!1;const h=[],u=Array.from(o.keys()).sort((p,v)=>{var m,y;const b=p.split(","),_=v.split(","),w=Math.max(b.length,_.length);for(let C=0;C<w;C++){const x=(m=Number(b[C]))!==null&&m!==void 0?m:0,S=(y=Number(_[C]))!==null&&y!==void 0?y:0;if(x!==S)return x-S}return 0}),d=u.map(p=>o.get(p)),c=u.filter(p=>p.startsWith(s+",")&&p!==s);if(d.forEach((p,v)=>{const m=u[v],y=p,b=c.includes(m);l&&(b?h.push(y[a]):l=!1),m===s&&(l=!0)}),h.length===0)return;const f=h.every(p=>!!p),g=h.every(p=>!p);f?(i.stateManager.setCheckedState(n,t,a,!0),wC(n,t,!0,i)):g?(i.stateManager.setCheckedState(n,t,a,!1),wC(n,t,!1,i)):(i.stateManager.setCheckedState(n,t,a,"indeterminate"),wC(n,t,"indeterminate",i))}function Ox(n,t,e,i){const{checkedState:r}=e.stateManager,o=t.toString();Mt(t)&&t.length;let s=!1;const a=Array.from(r.keys()).sort((u,d)=>{var c,f;const g=u.split(","),p=d.split(","),v=Math.max(g.length,p.length);for(let m=0;m<v;m++){const y=(c=Number(g[m]))!==null&&c!==void 0?c:0,b=(f=Number(p[m]))!==null&&f!==void 0?f:0;if(y!==b)return y-b}return 0}),l=a.filter(u=>u.startsWith(o+",")&&u!==o);a.map(u=>r.get(u)).forEach((u,d)=>{const c=a[d],f=u,g=l.length!==0&&l.includes(c);s&&(g?f[i]=n:s=!1),c===o&&(s=!0)})}function kVt(n){n.on("checkbox_state_change",t=>{if(n.internalProps.enableHeaderCheckboxCascade!==!0)return;const{col:e,row:i,checked:r,field:o}=t;if(n.isHeader(e,i))n.stateManager.setHeaderCheckedState(o,r),n.getCellType(e,i)==="checkbox"&&n.scenegraph.updateCheckboxCellState(e,i,r);else if(n.stateManager.setCheckedState(e,i,o,r),n.getCellType(e,i)==="checkbox"){const s=n.stateManager.headerCheckedState[o],a=n.stateManager.updateHeaderCheckedState(o,e,i);s!==a&&n.scenegraph.updateHeaderCheckboxCellState(e,i,a)}})}function Dx(n,t,e){const i=n.getRecordShowIndexByCell(t,e);return n.dataSource.getHierarchyState(i)}function EVt(n){n.on(ot.CLICK_CELL,t=>{const{col:e,row:i,target:r}=t;r.name!=="button"||r.attribute.disable||n.hasListeners(ot.BUTTON_CLICK)&&n.fireListeners(ot.BUTTON_CLICK,{col:e,row:i,event:t.event})})}function LVt(n){n.on(ot.ICON_CLICK,t=>{var e;const{col:i,row:r,x:o,y:s,funcType:a,icon:l,event:h}=t,{stateManager:u}=n;if(a===Fe.dropDown)u.triggerDropDownMenu(i,r,o,s,h);else if(a===Fe.sort)u.triggerSort(i,r,l,h);else if(a===Fe.frozen)u.triggerFreeze(i,r,l);else if(a===Fe.drillDown)dVt(n);else if(a===Fe.collapse||a===Fe.expand){const d=!!(!((e=u.select.ranges)===null||e===void 0)&&e.length);u.updateSelectPos(-1,-1),u.endSelectCells(!0,d),n.toggleHierarchyState(i,r)}})}function OVt(n){n.on(ot.DROPDOWN_MENU_CLICK,()=>{n.stateManager.hideMenu()}),n.on(ot.SCROLL,()=>{n.stateManager.hideMenu()})}function DVt(n){n.on(ot.DBLCLICK_CELL,t=>{var e,i,r;if(t.federatedEvent){const o=sn(t.federatedEvent),s=n.scenegraph.getResizeColAt(o.abstractPos.x,o.abstractPos.y,(e=o.eventArgs)===null||e===void 0?void 0:e.targetCell),a=(i=n.options.disableDblclickAutoResizeColWidth)!==null&&i!==void 0?i:(r=n.options.resize)===null||r===void 0?void 0:r.disableDblclickAutoResizeColWidth;if(n.eventManager.checkCellFillhandle(o))n.fireListeners(ot.DBLCLICK_FILL_HANDLE,{});else if(n._canResizeColumn(s.col,s.row)&&s.col>=0&&!a){n.scenegraph.updateAutoColWidth(s.col),n.internalProps._widthResizedColMap.add(s.col),n.scenegraph.updateChartSizeForResizeColWidth(s.col);const l=n.stateManager;l.columnResize.col<l.table.frozenColCount&&!l.table.isPivotTable()&&!l.table.transpose&&l.table.scenegraph.component.setFrozenColumnShadow(l.table.frozenColCount-1,l.columnResize.isRightFrozen);const h=[];for(let u=0;u<n.colCount;u++)h.push(n.getColWidth(u));n.fireListeners(ot.RESIZE_COLUMN_END,{col:s.col,colWidths:h})}}})}var Xu=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};let IVt=class{constructor(t){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.cutWaitPaste=!1,this.clipboardCheckTimer=null,this.cutOperationTime=0,this.lastClipboardContent="",this.cutCellRange=null,this.table=t,this.handleTextStickBindId=[],this.inertiaScroll=new yVt(t.stateManager),ye.mode==="node"||t.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){bVt(this),xVt(this),wVt(this),SVt(this),_Vt(this)}updateEventBinder(){setTimeout(()=>{var t;this.table.isReleased||(Rx(this.table)&&((t=this.handleTextStickBindId)===null||t===void 0?void 0:t.length)===0?(this.handleTextStickBindId.push(this.table.on(ot.SCROLL,e=>{N0(this.table)})),this.handleTextStickBindId.push(this.table.on(ot.RESIZE_COLUMN_END,e=>{N0(this.table)})),this.handleTextStickBindId.push(this.table.on(ot.RESIZE_ROW_END,e=>{N0(this.table)}))):!Rx(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(e=>{this.table.off(e)}),this.handleTextStickBindId=[]),iG(this.table))},0)}bindSelfEvent(){this.table.isReleased||(LVt(this.table),OVt(this.table),this.updateEventBinder(),hVt(this.table),DVt(this.table),this.table.isPivotTable()&&cVt(this.table)&&uVt(this.table),iG(this.table),AVt(this.table),MVt(this.table),RVt(this.table),BVt(this.table),kVt(this.table),EVt(this.table))}dealTableHover(t){if(!t)return void this.table.stateManager.updateHoverPos(-1,-1);const{eventArgs:e}=t;e?this.table.stateManager.updateHoverPos(e.col,e.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(t){const{eventArgs:e}=t;e?this.table.stateManager.updateHoverIcon(e.col,e.row,e.target,e.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(t){}dealTableSelect(t,e){var i,r,o,s,a,l,h,u,d;if(!t)return this.table.stateManager.updateSelectPos(-1,-1),!1;const{eventArgs:c}=t;if(c){if(c.target.name==="checkbox"||c.target.name==="radio"||c.target.name==="switch"||c.target.name==="button")return!1;if(this.table.isHeader(c.col,c.row)&&zh(this.table,c.col,c.row))return e||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(c.col,c.row)&&zh(this.table,c.col,c.row)){if(!e){const p=!!(!((i=this.table.stateManager.select.ranges)===null||i===void 0)&&i.length);this.table.stateManager.updateSelectPos(-1,-1),p&&this.table.stateManager.endSelectCells(!0,p)}return!1}if(this.table.isPivotChart()&&(((r=t?.eventArgs)===null||r===void 0?void 0:r.target.name)==="axis-label"||((o=t?.eventArgs)===null||o===void 0?void 0:o.target.type)==="chart"))return this.table.stateManager.updateSelectPos(-1,-1),!1;const f=(a=(s=this.table.keyboardOptions)===null||s===void 0?void 0:s.shiftMultiSelect)===null||a===void 0||a,g=(h=(l=this.table.keyboardOptions)===null||l===void 0?void 0:l.ctrlMultiSelect)===null||h===void 0||h;return this.table.stateManager.updateSelectPos(this.table.stateManager.select.selectInline==="row"?this.table.colCount-1:c.col,this.table.stateManager.select.selectInline==="col"?this.table.rowCount-1:c.row,c.event.shiftKey&&f,(c.event.ctrlKey||c.event.metaKey)&&g,!1,!e&&((d=(u=this.table.options.select)===null||u===void 0?void 0:u.makeSelectCellVisible)===null||d===void 0||d)),!0}return!1}dealFillSelect(t,e){var i,r,o,s,a,l,h,u;const{eventArgs:d}=t;if(d){if(!((r=(i=this.table.stateManager.select)===null||i===void 0?void 0:i.ranges)===null||r===void 0)&&r.length&&this.table.stateManager.isFillHandle()){let c,f;const g=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];e&&(Y(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.startY-t.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-t.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(c=d.row,f=g.end.col):(c=g.end.row,f=d.col));const p=(s=(o=this.table.keyboardOptions)===null||o===void 0?void 0:o.ctrlMultiSelect)===null||s===void 0||s;this.table.stateManager.updateSelectPos(e?f:g.end.col,e?c:g.end.row,!0,(d.event.ctrlKey||d.event.metaKey)&&p,!1,!e)}else{const c=(l=(a=this.table.keyboardOptions)===null||a===void 0?void 0:a.shiftMultiSelect)===null||l===void 0||l,f=(u=(h=this.table.keyboardOptions)===null||h===void 0?void 0:h.ctrlMultiSelect)===null||u===void 0||u;this.table.stateManager.updateSelectPos(d.col,d.row,d.event.shiftKey&&c,(d.event.ctrlKey||d.event.metaKey)&&f,!1,!e)}return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(ot.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(t){}checkColumnResize(t,e){const{eventArgs:i}=t;if(this.table.internalProps.enableTreeStickCell&&!i)return!1;const r=this.table.scenegraph.getResizeColAt(t.abstractPos.x,t.abstractPos.y,i?.targetCell);return this.table._canResizeColumn(r.col,r.row)&&r.col>=0?(e&&this.table.stateManager.startResizeCol(r.col,t.abstractPos.x,t.abstractPos.y,r.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(t,e){const{eventArgs:i}=t;if(i){const r=this.table.scenegraph.getResizeRowAt(t.abstractPos.x,t.abstractPos.y,i.targetCell);if(this.table._canResizeRow(r.col,r.row)&&r.row>=0)return e&&this.table.stateManager.startResizeRow(r.row,t.abstractPos.x,t.abstractPos.y,r.bottomFrozen),!0}return!1}cellIsHeaderCheck(t,e){const{eventArgs:i}=t,{col:r,row:o,target:s}=i;return this.table.isHeader(r,o)?this.table.getCellType(i.col,i.row)==="checkbox"&&s.name==="checkbox":!1}checkCellFillhandle(t,e){var i,r,o,s,a;let l=!1;if(l=typeof((i=this.table.options.excelOptions)===null||i===void 0?void 0:i.fillHandle)=="function"?this.table.options.excelOptions.fillHandle({selectRanges:this.table.stateManager.select.ranges,table:this.table}):(r=this.table.options.excelOptions)===null||r===void 0?void 0:r.fillHandle,l){const{eventArgs:h}=t;if(h&&(!((s=(o=this.table.stateManager.select)===null||o===void 0?void 0:o.ranges)===null||s===void 0)&&s.length)){const u=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),d=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),c=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),f=Math.min(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row);let g;u<this.table.colCount-1?g=this.table.scenegraph.highPerformanceGetCell(u,d).globalAABBBounds.x2:c===0?g=this.table.scenegraph.highPerformanceGetCell(0,d).globalAABBBounds.x1:g=this.table.scenegraph.highPerformanceGetCell(c-1,d).globalAABBBounds.x2;const p=Math.abs(t.abstractPos.x-g);let v;d<this.table.rowCount-1?v=this.table.scenegraph.highPerformanceGetCell(u,d).globalAABBBounds.y2:v=this.table.scenegraph.highPerformanceGetCell(u,f-1).globalAABBBounds.y2;const m=Math.abs(t.abstractPos.y-v),y=18;if(!((a=this.table.stateManager.fillHandle)===null||a===void 0)&&a.isFilling||p<=y/2&&m<=y/2)return e&&this.table.stateManager.startFillSelect(t.abstractPos.x,t.abstractPos.y),!0}}return!1}dealColumnResize(t,e){this.table.stateManager.updateResizeCol(t,e)}dealRowResize(t,e){this.table.stateManager.updateResizeRow(t,e)}checkColumnMover(t){var e;const{eventArgs:i}=t;return!(!i||!this.table._canDragHeaderPosition(i.col,i.row))&&(this.table.stateManager.startMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,(e=i?.event)===null||e===void 0?void 0:e.nativeEvent),!0)}dealColumnMover(t){var e;const{eventArgs:i}=t;Y(i.col)&&Y(i.row)&&this.table.stateManager.updateMoveCol(i.col,i.row,t.abstractPos.x,t.abstractPos.y,(e=i?.event)===null||e===void 0?void 0:e.nativeEvent)}startColumnResize(t){}dealIconClick(t,e){const{eventArgs:i}=e,{target:r,event:o,col:s,row:a}=i||{target:t.target,event:t,col:-1,row:-1},l=r;if(l.role&&l.role.startsWith("icon-"))return this.table.fireListeners(ot.ICON_CLICK,{name:l.name,x:(l.globalAABBBounds.x1+l.globalAABBBounds.x2)/2,y:l.globalAABBBounds.y2,col:s,row:a,funcType:l.attribute.funcType,icon:l,event:o}),!0;if(r instanceof Ei){const h=r.pickIcon(o.global);if(h)return this.table.fireListeners(ot.ICON_CLICK,{name:h.attribute.id,x:h.globalX+h.globalAABBBounds.width()/2,y:h.globalY+h.AABBBounds.height(),col:s,row:a,funcType:h.attribute.funcType,icon:h,event:o}),!0}return!1}release(){var t;(t=this.gesture)===null||t===void 0||t.release(),this.globalEventListeners.forEach(e=>{e.env==="document"?document.removeEventListener(e.name,e.callback):e.env==="body"?document.body.removeEventListener(e.name,e.callback):e.env==="window"?window.removeEventListener(e.name,e.callback):e.env==="vglobal"&&Dt.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}handleCopy(t,e=!1){var i,r;return Xu(this,void 0,void 0,function*(){const o=this.table;!e&&(this.cutWaitPaste=!1);const s=this.table.getCopyValue();if(Y(s)){t.preventDefault();const a=yield navigator.permissions.query({name:"clipboard-write"});if(!((i=navigator.clipboard)===null||i===void 0)&&i.write&&a.state==="granted"){const l=u=>{const d=["<table>"],c=['<meta name="author" content="Visactor"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),f=u.split(`\r
`);return f.forEach(function(g,p){const v=g.split("	"),m=[];p===0&&d.push("<tbody>"),v.forEach(function(y,b){const _=y?y.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,w=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(w.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";m.push(`<td>${_}</td>`)}),d.push("<tr>",...m,"</tr>"),p===f.length-1&&d.push("</tbody>")}),d.push("</table>"),[c,d.join("")].join("")},h=l(s);navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([h],{type:"text/html"}),"text/plain":new Blob([s],{type:"text/plain"})})])}else eFt.IE?window.clipboardData.setData("Text",s):t.clipboardData.setData("text/plain",s);o.fireListeners(ot.COPY_DATA,{cellRange:o.stateManager.select.ranges,copyData:s,isCut:e})}!((r=o.keyboardOptions)===null||r===void 0)&&r.showCopyCellBorder&&(HHt(o),o.clearSelected())})}handleCut(t){return Xu(this,void 0,void 0,function*(){this.handleCopy(t,!0),this.cutWaitPaste=!0,this.cutCellRange=this.table.getSelectedCellInfos(),this.clipboardCheckTimer&&clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=window.setTimeout(()=>{this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer=null)},3e4),this.saveClipboardContent()})}handlePaste(t){this.cutWaitPaste?this.checkClipboardChanged().then(e=>{this.executePaste(t),e||this.clearCutArea(this.table),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}).catch(()=>{this.executePaste(t),this.cutWaitPaste&&(this.cutWaitPaste=!1,this.cutCellRange=null,this.clipboardCheckTimer&&(clearTimeout(this.clipboardCheckTimer),this.clipboardCheckTimer=null))}):this.executePaste(t)}executePaste(t){var e,i,r,o;return Xu(this,void 0,void 0,function*(){const s=this.table;if(s.changeCellValues){if(!((e=s.editorManager)===null||e===void 0)&&e.editingEditor)return;if(((i=s.stateManager.select.ranges)===null||i===void 0?void 0:i.length)>0)if(!((r=navigator.clipboard)===null||r===void 0)&&r.read)navigator.clipboard.read().then(a=>{for(const l of a)l.types.includes("text/html")?this.pasteHtmlToTable(l):l.types.length===1&&l.types[0]==="text/plain"&&this.pasteTextToTable(l)});else{const a=s.stateManager.select.ranges,l=Math.min(a[0].start.col,a[0].end.col),h=Math.min(a[0].start.row,a[0].end.row),u=(t.clipboardData||window.Clipboard).getData("text").split(`
`),d=[];u.forEach(function(f,g){const p=f.split("	"),v=[];d.push(v),p.forEach(function(m,y){y===p.length-1&&(m=m.trim()),v.push(m)})});const c=yield s.changeCellValues(l,h,d,!0);s.hasListeners(ot.PASTED_DATA)&&s.fireListeners(ot.PASTED_DATA,{col:l,row:h,pasteData:d,changedCellResults:c})}}!((o=s.keyboardOptions)===null||o===void 0)&&o.showCopyCellBorder&&FHt(s)})}clearCutArea(t){try{const e=this.cutCellRange;if(!e||e.length===0)return;for(let i=0;i<e.length;i++)for(let r=0;r<e[i].length;r++)e[i][r]&&t.changeCellValue(e[i][r].col,e[i][r].row,void 0)}catch{}}checkClipboardChanged(){return Xu(this,void 0,void 0,function*(){if(!navigator.clipboard||!navigator.clipboard.readText)return!1;try{return(yield navigator.clipboard.readText())!==this.lastClipboardContent}catch{return!1}})}saveClipboardContent(){navigator.clipboard&&navigator.clipboard.readText&&setTimeout(()=>{navigator.clipboard.readText().then(t=>{this.lastClipboardContent=t}).catch(t=>{})},50)}pasteHtmlToTable(t){const e=/<tr[^>]*>([\s\S]*?)<\/tr>/g,i=/<td[^>]*>([\s\S]*?)<\/td>/g,r=this.table,o=r.stateManager.select.ranges,s=o.length,a=Math.min(o[s-1].start.col,o[s-1].end.col),l=Math.min(o[s-1].start.row,o[s-1].end.row),h=Math.max(o[s-1].start.col,o[s-1].end.col),u=Math.max(o[s-1].start.row,o[s-1].end.row);let d=0,c=0,f=[];t.getType("text/html").then(g=>{g.text().then(p=>Xu(this,void 0,void 0,function*(){var v,m;if(p&&/(<table)|(<TABLE)/g.test(p)){const y=Array.from(p.matchAll(e));for(const _ of y){const w=_[1],C=Array.from(w.matchAll(i)).map(x=>x[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,`
`).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));f.push(C),d=Math.max(d,(v=C?.length)!==null&&v!==void 0?v:0)}c=(m=f.length)!==null&&m!==void 0?m:0,f=this.handlePasteValues(f,c,d,u-l+1,h-a+1);const b=yield r.changeCellValues(a,l,f,!0);r.hasListeners(ot.PASTED_DATA)&&r.fireListeners(ot.PASTED_DATA,{col:a,row:l,pasteData:f,changedCellResults:b})}else navigator.clipboard.read().then(y=>{for(const b of y)b.types.includes("text/plain")&&b.getType("text/plain").then(_=>{_.text().then(this._pasteValue)})})}))})}_pasteValue(t){var e;return Xu(this,void 0,void 0,function*(){const i=this.table,r=i.stateManager.select.ranges,o=r.length,s=Math.min(r[o-1].start.col,r[o-1].end.col),a=Math.min(r[o-1].start.row,r[o-1].end.row),l=Math.max(r[o-1].start.col,r[o-1].end.col),h=Math.max(r[o-1].start.row,r[o-1].end.row);let u=0,d=0,c=[];t.split(`
`).forEach(function(g,p){var v;const m=g.split("	"),y=[];c.push(y),m.forEach(function(b,_){_===m.length-1&&(b=b.trim()),y.push(b)}),u=Math.max(u,(v=y?.length)!==null&&v!==void 0?v:0)}),d=(e=c.length)!==null&&e!==void 0?e:0,c=this.handlePasteValues(c,d,u,h-a+1,l-s+1);const f=yield i.changeCellValues(s,a,c,!0);i.hasListeners(ot.PASTED_DATA)&&i.fireListeners(ot.PASTED_DATA,{col:s,row:a,pasteData:c,changedCellResults:f})})}pasteTextToTable(t){const e=this.table,i=e.stateManager.select.ranges,r=i.length,o=Math.min(i[r-1].start.col,i[r-1].end.col),s=Math.min(i[r-1].start.row,i[r-1].end.row),a=Math.max(i[r-1].start.col,i[r-1].end.col),l=Math.max(i[r-1].start.row,i[r-1].end.row);let h=0,u=0;t.getType("text/plain").then(d=>{d.text().then(c=>Xu(this,void 0,void 0,function*(){var f;const g=c.replace(/\r(?!\n)/g,`\r
`).split(`\r
`);let p=[];g.length>1&&g[g.length-1]===""&&g.pop(),g.forEach(function(m,y){var b;const _=m.split("	"),w=[];p.push(w),_.forEach(function(C,x){C.includes(`
`)&&(C=C.replace(/^"(.*)"$/,"$1").replace(/["]*/g,S=>new Array(Math.floor(S.length/2)).fill('"').join(""))),w.push(C)}),h=Math.max(h,(b=w?.length)!==null&&b!==void 0?b:0)}),u=(f=p.length)!==null&&f!==void 0?f:0,p=this.handlePasteValues(p,u,h,l-s+1,a-o+1);const v=yield e.changeCellValues(o,s,p,!0);e.hasListeners(ot.PASTED_DATA)&&e.fireListeners(ot.PASTED_DATA,{col:o,row:s,pasteData:p,changedCellResults:v})}))})}handlePasteValues(t,e,i,r,o){if(o>i||r>e){if(o%i==0&&r%e==0){const s=[];for(let a=0;a<r;a++){const l=[];s.push(l);for(let h=0;h<o;h++){const u=a%e,d=h%i;l.push(t[u][d])}}return s}return t}return t}},oG;const HVt=n=>{const t=n.value;return Number(t)>80?"#20a8d8":Number(t)>50?"#4dbd74":Number(t)>20?"#ffc107":"#f86c6b"};class Ix extends Qs{static get DEFAULT(){return oG||(oG=new Ix)}constructor(t={},e={}){var i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y;super(t,e),this._showBar=(i=t.showBar)===null||i===void 0||i,this._barColor=(r=t.barColor)!==null&&r!==void 0?r:HVt,this._barPositiveColor=(o=t.barPositiveColor)!==null&&o!==void 0?o:"#4dbd74",this._barNegativeColor=(s=t.barNegativeColor)!==null&&s!==void 0?s:"#f86c6b",this._barAxisColor=(a=t.barAxisColor)!==null&&a!==void 0?a:"black",this._barBgColor=t.barBgColor,this._barHeight=(l=t.barHeight)!==null&&l!==void 0?l:3,this._barHeight=(h=t.barHeight)!==null&&h!==void 0?h:3,this._barBottom=(u=t.barBottom)!==null&&u!==void 0?u:0,this._barPadding=(d=t.barPadding)!==null&&d!==void 0?d:[0,0,0,0],this._showBarMark=(c=t.showBarMark)!==null&&c!==void 0&&c,this._barMarkPositiveColor=(f=t.barMarkPositiveColor)!==null&&f!==void 0?f:"#4dbd74",this._barMarkNegativeColor=(g=t.barMarkNegativeColor)!==null&&g!==void 0?g:"#f86c6b",this._barMarkWidth=(p=t.barMarkWidth)!==null&&p!==void 0?p:2,this._barMarkPosition=(v=t.barMarkPosition)!==null&&v!==void 0?v:"right",this._barRightToLeft=(m=t.barRightToLeft)!==null&&m!==void 0&&m,this._barMarkInBar=(y=t.barMarkInBar)===null||y===void 0||y}get showBar(){return this._showBar}set showBar(t){this._showBar=t}get barColor(){return this._barColor}set barColor(t){this._barColor=t}get barBgColor(){return this._barBgColor}set barBgColor(t){this._barBgColor=t}get barHeight(){return this._barHeight}set barHeight(t){this._barHeight=t}get barBottom(){return this._barBottom}set barBottom(t){this._barBottom=t}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(t){this._barPositiveColor=t}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(t){this._barNegativeColor=t}get barAxisColor(){return this._barAxisColor}set barAxisColor(t){this._barAxisColor=t}get barPadding(){return this._barPadding}set barPadding(t){this._barPadding=t}get showBarMark(){return this._showBarMark}set showBarMark(t){this._showBarMark=t}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(t){this._barMarkPositiveColor=t}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(t){this._barMarkNegativeColor=t}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(t){this._barMarkWidth=t}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(t){this._barMarkPosition=t}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(t){this._barRightToLeft=t}get barMarkInBar(){return this._barMarkInBar}set barMarkInBar(t){this._barMarkInBar=t}clone(){return new Ix(this,null)}}const FVt=["type","content","style","color","width","height","marginRight","marginLeft","src","svg","name","path","positionType","tooltip","hover","cursor","shape","interactive","isGif"],zVt=FVt;class NVt{constructor(t){this._table=t;const e=ms();this.expandIcon=e[Un.expandIconName],this.collapseIcon=e[Un.collapseIconName]}getIcons(t,e,i,r,o){const s=[],a=this.getHierarchyIcon(t,e);a&&s.push(a);const{icon:l}=this._table.getBodyColumnDefine(t,e);if(l){let h;typeof l=="function"?h=l({col:t,row:e,value:i,dataValue:r,table:this._table}):h=l;const u=ms(),d=c=>{let f;f=typeof c=="string"?u[c]:c,f&&s.push(f)};Array.isArray(h)?h.forEach((c,f)=>{d(c)}):d(h)}return o&&s.forEach((h,u)=>{(h.content||h.src)&&(s[u]=this.getCellIconFromRecordValue(h,t,e))}),s}getStyleClass(t){switch(t){case"text":case"link":return Um;case"image":case"video":return kHt;case"chart":case"sparkline":return Qs;case"progressbar":return Ix;case"checkbox":return jk;case"radio":return Xd;case"switch":return Yd;case"button":return Kd}return Um}getCellIconFromRecordValue(t,e,i){if(Array.isArray(t))return t.map(s=>this.getCellIconFromRecordValue(s,e,i));if(!OZ.isObject(t)||typeof t=="function")return this._table.getFieldData(t,e,i);const r={},o=t;return zVt.forEach(s=>{var a,l;if(o[s]!==void 0){const h=this._table.getFieldData(o[s],e,i);Y(h)?r[s]=h:!((l=(a=this._table)._hasField)===null||l===void 0)&&l.call(a,o[s],e,i)||(r[s]=o[s])}}),r}getHierarchyIcon(t,e){const i=this._table.getHierarchyState(t,e);return i===Lt.expand?this.expandIcon:i===Lt.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+((t=this.expandIcon.marginLeft)!==null&&t!==void 0?t:0)+((e=this.expandIcon.marginRight)!==null&&e!==void 0?e:0)}}function Ra(n,t){const e=document.createElement(n);return t&&e.classList.add(...t),e}function WVt(){if(ye.mode==="node")return;const n=document.createElement("style");n.id="vtable-menu-styleSheet",n.textContent=`
@keyframes vtable__menu-element--shown-animation {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}
.vtable__menu-element {
	position: absolute;
	box-sizing: border-box;
	border-radius: 4px;
	background-color: #fff;
	padding: 6px 0;
	/* pointer-events: none; */
	user-select: none;
	color: #000;
	max-width: 300px;
	z-index: 99999;
	border: #CCC 0.5px solid;
	cursor: default;
	width: max-content;
	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);
  max-height: 100%;
  overflow-y: auto;
}
.vtable__menu-element--hidden {
	opacity: 0;
	/* transform: translate(-50%, -50%); */
	transition: opacity 75ms linear;
	z-index: -9999;
}
.vtable__menu-element--shown {
	opacity: 1;
	/* transform: translate(-50%, -50%); */
	animation: vtable__menu-element--shown-animation 150ms ease-out;
}
.vtable__menu-element__content {
	font-family: Roboto;
	font-size: 12px;
	overflow: hidden;
	display: inline-block;
	/* height: 100%; */
	line-height: 30px;
}
.vtable__menu-element__item {
	height: 32px;
	padding: 0px 12px;
	cursor: pointer;
	position: relative;
	display: flex;
	align-items: center;
	justify-content: flex-start;
}
.vtable__menu-element__item:hover {
	background-color: rgba(27, 31, 35, 0.06);
}
.vtable__menu-element__icon{
	/* vertical-align: top; */
	display: flex;
	/* line-height: 30px; */
	margin-right: 6px;
}
.vtable__menu-element__no-event {
	pointer-events: none;
}
.vtable__menu-element--select {
	color: #2E68CF;
}
.vtable__menu-element--normal {
	color: rgba(20, 20, 20, 0.9);;
}
.vtable__menu-element__item-disabled {
    color: rgba(0, 0, 0, 0.25);
    cursor: not-allowed;
	  background-color: #fff;
}
.vtable__menu-element__item-disabled:hover {
	  background-color: #fff;
}
.vtable__menu-element__split {
	height: 0px;
	border: 1px solid rgb(209, 213, 218);
	margin: 5px 0;
}
.vtable__menu-element__title {
	color: rgb(149, 149, 149);
}
.vtable__menu-element__arrow {
	position: absolute;
	right: 3px;
	font-weight: bold;
	margin-top: 1px;
}
.vtable__menu-element__item-text {
	margin-right: 15px;
}
`,document.head.appendChild(n)}WVt();const io="vtable__menu-element",VVt=`${io}__item`,v2=`${io}__content`,Or=`${io}--hidden`,fl=`${io}--shown`,GVt=`${io}--normal`,$Vt=`${io}--select`,jVt=`${io}__icon`,UVt=`${io}__split`,XVt=`${io}__title`,YVt=`${io}__arrow`,Av=`${io}__no-event`,sG=`${io}__item-text`,xC=`${io}__item-disabled`;function aG(){return Ra("div",[io,Or])}function Zv(n,t,e,i,r,o){const s=n.getCellRange(i,r);for(let a=0;a<t.length;a++){const l=t[a];let{col:h,row:u}=l;const{field:d,menuKey:c}=l;if(typeof h!="number"||typeof u!="number")if(n.isPivotTable()){const f=n.internalProps.layoutMap.getPivotCellAdress(d);if(!f)continue;h=f.col,u=f.row}else{const f=n.internalProps.layoutMap.getHeaderCellAddressByField(d);if(!f)continue;h=f.col,u=f.row}if(Y(h)&&Y(u)&&fs(s,h,u)&&e===c)return!0}return!1}class KVt{constructor(t){var e,i,r,o,s,a,l,h,u,d,c;this._handler=new BA,this._rootElement=aG(),this._secondElement=aG(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",f=>{f.stopPropagation()}),(e=this._rootElement)===null||e===void 0||e.addEventListener("mousedown",f=>{f.stopPropagation(),f.preventDefault()}),(i=this._rootElement)===null||i===void 0||i.addEventListener("contextmenu",f=>{f.stopPropagation(),f.preventDefault()}),(r=this._rootElement)===null||r===void 0||r.addEventListener("touchend",f=>{if(f.stopPropagation(),f.preventDefault(),f.target.classList.contains(xC)||this._rootElement.classList.contains(Or))return;const{col:g,row:p,dropDownIndex:v,menuKey:m,text:y,hasChildren:b}=f.target;if(typeof v!="number"||b)return void f.stopPropagation();const _=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,p):t.getHeaderField(g,p),w=t._dropDownMenuIsHighlight(g,p,v);t.fireListeners(ot.DROPDOWN_MENU_CLICK,{col:g,row:p,field:_,menuKey:m,text:y,highlight:w,cellLocation:t.getCellLocation(g,p),event:f}),t.fireListeners(ot.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ot.HIDE_MENU,null),f.stopPropagation()}),(o=this._rootElement)===null||o===void 0||o.addEventListener("click",f=>{if(f.stopPropagation(),f.preventDefault(),f.target.classList.contains(xC)||this._rootElement.classList.contains(Or))return;const{col:g,row:p,dropDownIndex:v,menuKey:m,text:y,hasChildren:b}=f.target;if(typeof v!="number"||b)return void f.stopPropagation();const _=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,p):t.getHeaderField(g,p),w=t._dropDownMenuIsHighlight(g,p,v);t.fireListeners(ot.DROPDOWN_MENU_CLICK,{col:g,row:p,field:_,menuKey:m,text:y,highlight:w,cellLocation:t.getCellLocation(g,p),event:f}),t.fireListeners(ot.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ot.HIDE_MENU,null),f.stopPropagation()}),(s=this._rootElement)===null||s===void 0||s.addEventListener("mousemove",f=>{var g,p;if(this._rootElement.classList.contains(Or))return;f.stopPropagation();const{hasChildren:v,dropDownIndex:m,col:y,row:b,sub:_}=f.target;if(v){this._showChildrenIndex=m;const w=this._secondElement;w?.classList.remove(Or),w?.classList.add(fl),w.innerHTML="";const C=(g=this._menuInstanceInfo.content[m])===null||g===void 0?void 0:g.children;for(let S=0;S<C.length;S++){const A=C[S],T=lG(A,!!t.stateManager.menu.dropDownMenuHighlight&&Zv(t,t.stateManager.menu.dropDownMenuHighlight,typeof A=="object"?A?.menuKey||A?.text:A,y,b));T.col=y,T.row=b,T.dropDownIndex=S,typeof A=="string"?(T.text=A,T.menuKey=A):typeof A=="object"&&(T.text=A.text,T.menuKey=A.menuKey||A.text),T.sub=!0,T.sub=!0,w.appendChild(T)}const x=f.target.getBoundingClientRect();this._bindSecondElement(t,y,b,x.right,x.top)}else if(v&&this._showChildrenIndex===m){const w=this._secondElement;w?.classList.remove(Or),w?.classList.add(fl)}else!_&&(!((p=this._secondElement)===null||p===void 0)&&p.classList.contains(fl))&&setTimeout(()=>{if(this._mouseEnterSecondElement!==!0){this._showChildrenIndex=-1;const w=this._secondElement;w?.classList.remove(fl),w?.classList.add(Or)}},300)}),(a=this._secondElement)===null||a===void 0||a.addEventListener("wheel",f=>{f.stopPropagation()}),(l=this._secondElement)===null||l===void 0||l.addEventListener("mousemove",f=>{this._rootElement.classList.contains(Or)||f.stopPropagation()}),(h=this._secondElement)===null||h===void 0||h.addEventListener("mouseenter",f=>{this._mouseEnterSecondElement=!0}),(u=this._secondElement)===null||u===void 0||u.addEventListener("mouseleave",f=>{this._mouseEnterSecondElement=!1}),(d=this._secondElement)===null||d===void 0||d.addEventListener("mousedown",f=>{f.stopPropagation(),f.preventDefault()}),(c=this._secondElement)===null||c===void 0||c.addEventListener("click",f=>{if(f.stopPropagation(),f.preventDefault(),f.target.classList.contains(xC)||this._secondElement.classList.contains(Or))return;const{col:g,row:p,dropDownIndex:v,menuKey:m,text:y,hasChildren:b}=f.target;if(typeof v!="number"||b)return void f.stopPropagation();const _=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,p):t.getHeaderField(g,p);let w=!1;this._menuInstanceInfo.content.forEach((C,x)=>{if(typeof C=="object"&&C.children&&C.children.length)for(let S=0;S<C.children.length;S++){const A=C.children[S];if(Zv(t,t.stateManager.menu.dropDownMenuHighlight,typeof A=="object"?A?.menuKey:A,g,p)&&m===(typeof A=="object"?A?.menuKey:A))return void(w=!0)}}),t.fireListeners(ot.DROPDOWN_MENU_CLICK,{col:g,row:p,field:_,cellHeaderPaths:t.isPivotTable()?t.getCellHeaderPaths(g,p):void 0,menuKey:m,text:y,highlight:w,cellLocation:t.getCellLocation(g,p),event:f}),t.fireListeners(ot.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ot.HIDE_MENU,null),f.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();const t=this._rootElement;t?.parentElement&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){var o,s;const a=this._rootElement,l=this._secondElement;if(this._menuInstanceInfo=r,a?.classList.remove(fl),a?.classList.add(Or),l?.classList.remove(fl),l?.classList.add(Or),this._canBindToCell(t,e,i)){if(a.innerHTML="",Array.isArray(r.content)){const h=r.content;for(let u=0;(o=u<h?.length)!==null&&o!==void 0&&o;u++){const d=h[u];let c=!!t.stateManager.menu.dropDownMenuHighlight&&Zv(t,t.stateManager.menu.dropDownMenuHighlight,typeof d=="object"?d?.menuKey||d?.text:d,e,i);if(t.stateManager.menu.dropDownMenuHighlight&&typeof d=="object"&&Array.isArray(d.children)&&d.children.length)for(let g=0;g<d.children.length;g++){const p=d.children[g];if(Zv(t,t.stateManager.menu.dropDownMenuHighlight,typeof p=="object"?p?.menuKey||p?.text:p,e,i)){c=!0;break}}const f=lG(d,c);f.col=e,f.row=i,f.dropDownIndex=u,typeof d=="string"?(f.text=d,f.menuKey=d):typeof d=="object"&&(f.text=d.text,f.menuKey=d.menuKey||d.text,!((s=d.children)===null||s===void 0)&&s.length&&(f.hasChildren=!0)),a.appendChild(f)}}if(this._bindToCell(t,e,i,r.position,r.referencePosition))return a?.classList.add(fl),a?.classList.remove(Or),!0}else this.unbindFromCell();return!1}unbindFromCell(){const t=this._rootElement,e=this._secondElement;this._menuInstanceInfo=void 0,t?.parentElement&&(t.classList.remove(fl),t.classList.add(Or)),e?.parentElement&&(e.classList.remove(fl),e.classList.add(Or))}_canBindToCell(t,e,i){var r;const o=t.getCellRangeRelativeRect({col:e,row:i}),s=(r=t.internalProps.menu.parentElement)!==null&&r!==void 0?r:t.getElement(),{top:a,bottom:l,left:h,right:u}=o;if(e===-1&&i===-1||t.isFrozenCell(e,i))return!0;if(l<t.getFrozenRowsHeight()||u<t.getFrozenColsWidth()||h>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||a>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:d,offsetWidth:c}=s;return!(d<a)&&!(c<h)}_bindToCell(t,e,i,r,o){var s;const a=this._rootElement,l=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:h,height:u,left:d,top:c}=l.getBoundingClientRect();if(a){a.parentElement!==l&&l.appendChild(a),a.style.left="0px";const f=.8*h;a.style.maxWidth=`${f}px`;const g=a.offsetWidth,p=a.offsetHeight;let v,m;r?(v=r.x,m=r.y):o&&(v=o.rect.right-g,m=o.rect.bottom);const y=l.getBoundingClientRect(),b=y.width/l.offsetWidth,_=y.height/l.offsetHeight;m*_+p>u&&(m=(u-p)/_),m<0&&(m/=2);let w=0,C=0;if(t.getElement()!==l){const{left:x,top:S}=t.getElement().getBoundingClientRect();w=S-c,C=x-d}return a.style.top=`${m+w}px`,v<0?v=0:v*b+g>h&&(v=(h-g)/b),a.style.left=`${v+C}px`,!0}return!1}_bindSecondElement(t,e,i,r,o){var s;const a=this._secondElement,l=this._rootElement,h=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:u,height:d,left:c,top:f}=h.getBoundingClientRect(),{x:g,y:p,width:v,height:m}=l.getBoundingClientRect();if(a){a.parentElement!==h&&h.appendChild(a),a.style.left="0px";const y=.8*u;a.style.maxWidth=`${y}px`;const b=a.clientWidth,_=a.clientHeight,w=r-c;let C=o-4-f;C+_>d&&(C=C-_+a.firstElementChild.clientHeight+4),a.style.top=`${C}px`;let x=w;return x+b>u?x=x-b-v:x+=4,a.style.left=`${x}px`,!0}return!1}pointInMenuElement(t,e){const i=this._rootElement,{x:r,y:o,width:s,height:a}=i.getBoundingClientRect();if(t>r-5&&t<r+s+5&&e>o-5&&e<o+a+5)return!0;const l=this._secondElement;if(l){const{x:h,y:u,width:d,height:c}=l.getBoundingClientRect();if(t>h-5&&t<h+d+5&&e>u-5&&e<u+c+5)return!0}return!1}}function lG(n,t){var e,i,r;const o=Ra("div",[VVt,t?$Vt:GVt]);if(typeof n=="object"&&n.disabled&&o.classList.add(xC),typeof n=="string"){const s=Ra("span",[v2,Av,sG]);s.innerHTML=n,o.appendChild(s)}else if(typeof n=="object"){const s=(e=n.type)!==null&&e!==void 0?e:"item";if(s==="split")return o?.classList.add(UVt),o;if(!((i=n?.icon)===null||i===void 0)&&i.svg)if(xD.test(n.icon.svg)){const l=new Image;n.icon.width?l.style.width=n.icon.width.toString()+"px":l.style.width="16px",n.icon.height?l.style.height=n.icon.height.toString()+"px":l.style.height="16px",l.src=n.icon.svg,o.appendChild(l)}else{const l=Ra("span",[jVt,Av]);l.innerHTML=t&&n.selectedIcon&&n.selectedIcon.svg?n.selectedIcon.svg:n.icon.svg,n.icon.width&&l.children[0].setAttribute("width",n.icon.width.toString()),n.icon.height&&l.children[0].setAttribute("height",n.icon.height.toString()),o.appendChild(l)}const a=Ra("span",[v2,Av,sG]);if(a.innerHTML=n.text,o.appendChild(a),s==="title")o?.classList.add(Av,XVt);else if(!((r=n?.children)===null||r===void 0)&&r.length){const l=Ra("span",[v2,Av,YVt]);l.innerHTML=t?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',o.appendChild(l)}}return o}let hG;const qVt={CHANGE_STYLE:"change_style"};class xc extends AA{static get EVENT_TYPE(){return qVt}static get DEFAULT(){return hG||(hG=new xc)}constructor(t={},e={}){var i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O;super(),this._defaultPadding=[10,16,10,16],this._color=(i=t.color)!==null&&i!==void 0?i:e?.color,this._strokeColor=(r=t?.strokeColor)!==null&&r!==void 0?r:e?.strokeColor,this._fontSize=(o=t.fontSize)!==null&&o!==void 0?o:e?.fontSize,this._fontFamily=(s=t.fontFamily)!==null&&s!==void 0?s:e?.fontFamily,this._fontWeight=(a=t.fontWeight)!==null&&a!==void 0?a:e?.fontWeight,this._fontVariant=(l=t.fontVariant)!==null&&l!==void 0?l:e?.fontVariant,this._fontStyle=(h=t.fontStyle)!==null&&h!==void 0?h:e?.fontStyle,this._textOverflow=((u=t.textOverflow)!==null&&u!==void 0?u:e?.textOverflow)||"ellipsis",this._textStick=(c=(d=t.textStick)!==null&&d!==void 0?d:e?.textStick)!==null&&c!==void 0&&c,this._textStickBaseOnAlign=(g=(f=t.textStickBaseOnAlign)!==null&&f!==void 0?f:e?.textStickBaseOnAlign)!==null&&g!==void 0&&g,this._marked=(v=(p=t.marked)!==null&&p!==void 0?p:e?.marked)!==null&&v!==void 0&&v,this._textAlign=((m=t.textAlign)!==null&&m!==void 0?m:e?.textAlign)||"left",this._textBaseline=((y=t.textBaseline)!==null&&y!==void 0?y:e?.textBaseline)||"middle",this._bgColor=(b=t.bgColor)!==null&&b!==void 0?b:e?.bgColor,this._padding=(w=(_=t.padding)!==null&&_!==void 0?_:e?.padding)!==null&&w!==void 0?w:this._defaultPadding,this._borderColor=(C=t.borderColor)!==null&&C!==void 0?C:e?.borderColor,this._lineHeight=(x=t.lineHeight)!==null&&x!==void 0?x:e?.lineHeight,this._underline=(S=t.underline)!==null&&S!==void 0?S:e?.underline,this._underlineColor=(A=t.underlineColor)!==null&&A!==void 0?A:e?.underlineColor,this._underlineDash=(T=t.underlineDash)!==null&&T!==void 0?T:e?.underlineDash,this._underlineOffset=(M=t.underlineOffset)!==null&&M!==void 0?M:e?.underlineOffset,this._lineThrough=(R=t.lineThrough)!==null&&R!==void 0?R:e?.lineThrough,this._lineThroughColor=(E=t.lineThroughColor)!==null&&E!==void 0?E:e?.lineThroughColor,this._lineThroughDash=(P=t.lineThroughDash)!==null&&P!==void 0?P:e?.lineThroughDash,this._linkColor=(B=t.linkColor)!==null&&B!==void 0?B:e?.linkColor,this._cursor=(k=t.cursor)!==null&&k!==void 0?k:e?.cursor,this._borderLineWidth=(L=t.borderLineWidth)!==null&&L!==void 0?L:e?.borderLineWidth,this._borderLineDash=(O=t.borderLineDash)!==null&&O!==void 0?O:e?.borderLineDash}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get padding(){var t;return(t=this._padding)!==null&&t!==void 0?t:this._defaultPadding}set padding(t){this._padding=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get marked(){return this._marked}set marked(t){this._marked=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}clone(){return new xc(this)}}let uG;class Hx extends xc{static get DEFAULT(){return uG||(uG=new Hx)}constructor(t={},e={}){var i;super(t,e),this.textAlign=((i=t.textAlign)!==null&&i!==void 0?i:e?.textAlign)||"center"}clone(){return new Hx(this)}}let dG;class Fx extends xc{static get DEFAULT(){return dG||(dG=new Fx)}constructor(t={},e=null){var i,r;super(t,e),this._autoWrapText=(i=t?.autoWrapText)!==null&&i!==void 0?i:e?.autoWrapText,this._lineClamp=(r=t?.lineClamp)!==null&&r!==void 0?r:e?.lineClamp}clone(){return new Fx(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let cG;class qd extends xc{static get DEFAULT(){return cG||(cG=new qd)}constructor(t={},e={},i={}){var r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A;super(t,e),this._size=((o=(r=t?.size)!==null&&r!==void 0?r:e?.size)!==null&&o!==void 0?o:i?.size)||14,this._spaceBetweenTextAndIcon=((a=(s=t?.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e?.spaceBetweenTextAndIcon)!==null&&a!==void 0?a:i?.spaceBetweenTextAndIcon)||8,this._defaultFill=(h=(l=t?.checkboxStyle)===null||l===void 0?void 0:l.defaultFill)!==null&&h!==void 0?h:i?.defaultFill,this._defaultStroke=(d=(u=t?.checkboxStyle)===null||u===void 0?void 0:u.defaultStroke)!==null&&d!==void 0?d:i?.defaultStroke,this._disableFill=(f=(c=t?.checkboxStyle)===null||c===void 0?void 0:c.disableFill)!==null&&f!==void 0?f:i?.disableFill,this._checkedFill=(p=(g=t?.checkboxStyle)===null||g===void 0?void 0:g.checkedFill)!==null&&p!==void 0?p:i?.checkedFill,this._checkedStroke=(m=(v=t?.checkboxStyle)===null||v===void 0?void 0:v.checkedStroke)!==null&&m!==void 0?m:i?.checkedStroke,this._disableCheckedFill=(b=(y=t?.checkboxStyle)===null||y===void 0?void 0:y.disableCheckedFill)!==null&&b!==void 0?b:i?.disableCheckedFill,this._disableCheckedStroke=(w=(_=t?.checkboxStyle)===null||_===void 0?void 0:_.disableCheckedStroke)!==null&&w!==void 0?w:i?.disableCheckedStroke,this._checkIconImage=(x=(C=t?.checkboxStyle)===null||C===void 0?void 0:C.checkIconImage)!==null&&x!==void 0?x:i?.checkIconImage,this._indeterminateIconImage=(A=(S=t?.checkboxStyle)===null||S===void 0?void 0:S.indeterminateIconImage)!==null&&A!==void 0?A:i?.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new qd(t,this)}clone(){return new qd(this)}}function SC(n,t,e,i,r,o){var s;return n||t?n instanceof xc?n:typeof n=="function"?SC(n(e),t,e,i,r,o):(n||(n={}),r&&!Y(n.autoWrapText)&&(n.autoWrapText=!0),i===qd?new qd(n??{},t??{},(s=o.checkboxStyle)!==null&&s!==void 0?s:{}):new i(n??{},t??{})):i.DEFAULT}class ZVt{constructor(t){this._table=t;const e=ms();this.freezeIcon=e[Un.freezeIconName],this.frozenIcon=e[Un.frozenIconName],this.frozenCurrentIcon=e[Un.frozenCurrentIconName],this.normalIcon=e[Un.normalIconName],this.upIcon=e[Un.upwardIconName],this.downIcon=e[Un.downwardIconName],this.dropDownAbsoluteIcon=e[Un.dropdownIconName],this.expandIcon=e[Un.expandIconName],this.collapseIcon=e[Un.collapseIconName]}getIcons(t,e){const i=[];if(this._table.isPivotTable()){const{showSort:a,sort:l}=this._table.internalProps.layoutMap.getHeader(t,e);let h;if(h=typeof a=="function"?a({col:t,row:e,table:this._table}):a,h){let u=this._table.getPivotSortState(t,e);u&&(u=u.toUpperCase());const d=u==="ASC"?this.upIcon:u==="DESC"?this.downIcon:this.normalIcon;d&&i.push(d)}else if(l){const u=this.getSortIconForPivotTable(this._table.getPivotSortState(t,e),this._table,t,e);u&&i.push(u)}}else{const a=this._table.sortState;let l;l=void 0;const h=this._table.getCellRange(t,e);if(a)if(Array.isArray(a))for(let d=0;d<a.length;d++){const c=a[d],f=this._table._getHeaderCellBySortState(c);if(f&&fs(h,f.col,f.row)){({order:l}=c);break}}else{const d=this._table._getHeaderCellBySortState(a);d&&fs(h,d.col,d.row)&&({order:l}=a)}const u=this.getSortIcon(l,this._table,t,e);u&&i.push(u)}if(this._table.showFrozenIcon&&t<this._table.allowFrozenColCount){const a=this.getFrozenIcon(t,e);a&&i.push(a)}if(this.checkDropDownIcon(this._table,t,e)){const a=this.dropDownAbsoluteIcon;i.push(a)}const r=this.getDropDownStateIcons(this._table,t,e);r.length&&i.push(...r);const{headerIcon:o}=this._table._getHeaderLayoutMap(t,e),s=this.getHierarchyIcon(t,e);if(s&&i.push(s),o){let a;typeof o=="function"?a=o({col:t,row:e,value:this._table.getCellValue(t,e),dataValue:this._table.getCellOriginValue(t,e),table:this._table}):a=o;const l=ms(),h=u=>{let d;d=typeof u=="string"?l[u]:u,d&&i.push(d)};Array.isArray(a)?a.forEach((u,d)=>{h(u)}):h(a)}return i}getFrozenIcon(t,e){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&t>=this._table.colCount-this._table.rightFrozenColCount)return null;const i=this._table.getHeaderDefine(t,e);if(i.columns&&i.columns.length>0)return null;let r=this.freezeIcon;return this._table.options.frozenColCount-1>t?r=this.frozenIcon:this._table.options.frozenColCount-1===t&&(r=this.frozenCurrentIcon),r}getSortIcon(t,e,i,r){const o=t==="asc"?this.upIcon:t==="desc"?this.downIcon:this.normalIcon,s=e.getHeaderDefine(i,r);let a;return s&&(a=typeof s.showSort=="function"?s.showSort({col:i,row:r,table:this._table}):s.showSort),!s||a===!1||!Y(a)&&!s.sort||s.columns&&s.columns.length>0?null:o}getSortIconForPivotTable(t,e,i,r){const o=e.getHeaderDefine(i,r);let s;return o&&(s=typeof o.showSort=="function"?o.showSort({col:i,row:r,table:this._table}):o.showSort),!o||s===!1||!Y(s)&&!o.sort||o.columns&&o.columns.length>0?null:t?.toUpperCase()==="ASC"?this.upIcon:t?.toUpperCase()==="DESC"?this.downIcon:this.normalIcon}getDropDownStateIcons(t,e,i){var r,o,s;const a=t.getHeaderDefine(e,i),l=t._getHeaderLayoutMap(e,i);let{dropDownMenu:h}=l;typeof h=="function"&&(h=h({row:i,col:e,table:t}));let u=t.globalDropDownMenu;typeof u=="function"&&(u=u({row:i,col:e,table:t}));const d=[];if(Array.isArray(h)&&h.length||Array.isArray(u)&&u.length&&!(!((r=a?.columns)===null||r===void 0)&&r.length)){const c=h||u;let f=-1,g=-1;for(let p=0;p<c.length;p++){const v=c[p];if(typeof v=="object"&&v.children&&v.children.length)for(let m=0;m<v.children.length;m++){const y=v.children[m];if(!((o=t.stateManager.menu)===null||o===void 0)&&o.dropDownMenuHighlight&&Zv(t,(s=t.stateManager.menu)===null||s===void 0?void 0:s.dropDownMenuHighlight,typeof y=="object"?y?.menuKey:y,e,i)){f=p,g=m;break}}if(t._dropDownMenuIsHighlight(e,i,p)){f=p;break}}if(f!==-1){let p;p=g!==-1?c[f].children[g]:c[f],p.stateIcon&&(p.stateIcon.svg?d.push({type:"svg",name:p.stateIcon.src||p.stateIcon.svg,width:p.stateIcon.width||22,height:p.stateIcon.height||22,svg:p.stateIcon.svg,positionType:He.right,marginRight:0,funcType:Fe.dropDownState,interactive:!1}):p.stateIcon.src&&d.push({type:"image",name:p.stateIcon.src||p.stateIcon.svg,width:p.stateIcon.width||22,height:p.stateIcon.height||22,src:p.stateIcon.src,positionType:He.right,marginRight:0,funcType:Fe.dropDownState,interactive:!1}))}}return d}getDropDownIconRect(t,e,i){var r,o,s,a,l,h,u,d;const c=(a=(o=(r=this.downIcon.hover)===null||r===void 0?void 0:r.width)!==null&&o!==void 0?o:(s=this.downIcon)===null||s===void 0?void 0:s.width)!==null&&a!==void 0?a:0,f=(d=(h=(l=this.downIcon.hover)===null||l===void 0?void 0:l.height)!==null&&h!==void 0?h:(u=this.downIcon)===null||u===void 0?void 0:u.height)!==null&&d!==void 0?d:0,g=t.right-2-c,p=t.right-2;let v;return v=i==="middle"?t.top+t.height/2-c/2:i==="top"?t.top+e/2:i==="bottom"?t.bottom-2*e:t.top,{left:g,right:p,top:v,bottom:f+v,width:c,height:f}}getHierarchyIcon(t,e){const{hierarchyState:i}=this._table._getHeaderLayoutMap(t,e);if(i){if(i===Lt.expand)return this.expandIcon;if(i===Lt.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+((t=this.expandIcon.marginLeft)!==null&&t!==void 0?t:0)+((e=this.expandIcon.marginRight)!==null&&e!==void 0?e:0)}checkDropDownIcon(t,e,i){var r;if(t.isPivotTable()){let o=t._getHeaderLayoutMap(e,i).dropDownMenu;if(typeof o=="function"&&(o=o({row:i,col:e,table:t})),Array.isArray(o)&&o.length)return!0}else{const o=t.getHeaderDefine(e,i),s=o.dropDownMenu;let a=t.globalDropDownMenu;if(typeof a=="function"&&(a=a({row:i,col:e,table:t})),Array.isArray(s)&&s.length||(!Array.isArray(o.dropDownMenu)||o.dropDownMenu.length!==0)&&Array.isArray(a)&&a.length&&!(!((r=o?.columns)===null||r===void 0)&&r.length))return!0}return!1}getStyleClass(t){switch(t){case"text":case"link":return Fx;case"image":case"video":return Hx;case"checkbox":return qd}}setTableColumnsEditor(){const t=(e,i)=>{e?.forEach((r,o)=>{r.editor&&(i[o].editor=r.editor),r.columns&&t(r.columns,i[o].columns)})};t(this._table.options.columns,this._table.internalProps.columns)}}class fG extends EventTarget{constructor(t,e){if(super(),this._table=t,ye.mode==="node")return;const i=document.createElement("div");i.style.opacity="0",i.dataset.vtable="vtable",i.style.pointerEvents="none",i.classList.add("input-container");const r=this._input=document.createElement("input");i.appendChild(r),r.classList.add("table-focus-control"),r.dataset.vtable="vtable",r.readOnly=!0,e.appendChild(i),this._container=i}focus(){this._input.focus({preventScroll:!0})}setFocusRect(t,e){const i=this._input;i.value=e,i.select();const r=t.top-this._table.scrollTop,o=t.left-this._table.scrollLeft;i.style.top=`${r.toFixed()}px`,i.style.left=`${o.toFixed()}px`,i.style.width=`${t.width.toFixed()}px`,i.style.height=`${t.height.toFixed()}px`}get input(){return this._input}release(){var t;(t=this._container.parentElement)===null||t===void 0||t.removeChild(this._container)}}class gG{constructor(t){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=t}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}add(t,e){if(!Y(e))return;const i=this.table.getRowHeight(t);this.data.has(t)||(this._keys.push(t),this._sorted=!1),this.data.set(t,e),this.totalSum+=e,this.updateDifference(t,e-i)}remove(t){if(this.data.has(t)){const e=this.data.get(t);this.data.delete(t);const i=this._keys.indexOf(t);i!==-1&&this._keys.splice(i,1),this.totalSum-=e;const r=this.table.getRowHeight(t);this.updateDifference(t,r-e)}}put(t,e){if(Y(e))if(this.data.has(t)){const i=this.data.get(t);if(i===e)return;this.data.set(t,e);const r=e-i;this.totalSum+=r,this.updateDifference(t,r)}else this.add(t,e)}get(t){return this.data.get(t)}has(t){return this.data.has(t)}_sort(){const{_keys:t}=this;this._sorted||(t.sort((e,i)=>e<i?-1:e>i?1:0),this._sorted=!0)}updateDifference(t,e){var i;const r=(i=this.difference.get(t))!==null&&i!==void 0?i:0;this.difference.set(t,r+e),this.update()}getSumInRange(t,e){return this.calculatePrefixSum(e)-this.calculatePrefixSum(t-1)}updateCumulativeSum(t,e){for(const[i,r]of this.cumulativeSum)i>=t&&this.cumulativeSum.set(i,r+e)}calculatePrefixSum(t){if(t<0)return 0;if(this.cumulativeSum.has(t)){let e=this.cumulativeSum.get(t);for(const[i,r]of this.difference)i<=t&&(e+=r);return e}return this.dealDiffenence(),this.getCumulativeSum(t)}getCumulativeSum(t){var e,i;let r=0,o=0,s=!1;const a=this.table.rowCount>0&&this.table.bottomFrozenRowCount>0?this.table.rowCount-this.table.bottomFrozenRowCount:-1;for(let l=t;l>=0;l--){if(this.cumulativeSum.has(l)){r+=this.cumulativeSum.get(l);break}r+=(e=this.data.get(l))!==null&&e!==void 0?e:this.table.getRowHeight(l),l>=a&&a!==-1&&(o=r,s=l===a)}if(s&&(!((i=this.table.containerFit)===null||i===void 0)&&i.height)&&this.table.bottomFrozenRowCount){const l=this.table.tableNoFrameHeight||0;r<l&&(r=l-this.table.getBottomFrozenRowsHeight()+o)}return this.cumulativeSum.set(t,r),r}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(const[t]of this.cumulativeSum)for(const[e,i]of this.difference)if(t>=e){const r=this.cumulativeSum.get(t);this.cumulativeSum.set(t,r+i)}this.difference.clear()}insert(t,e){for(let r=t;r<=this.getLastIndex();r++)this.cumulativeSum.delete(r);const i=this.getLastIndex()+1;this.adjustOrder(t,t+1,i-t),Y(e)&&this.put(t,e)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){const t=this.getLastIndex();this.remove(t)}delete(t){if(!this.has(t))return;for(let i=t;i<=this.getLastIndex();i++)this.cumulativeSum.delete(i);const e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}adjustOrder(t,e,i){this.clearRange(),this._sort();const{_keys:r}=this;if(t>e){const s=[];for(let a=ff(r,t+i-1);a>=0;a--){const l=r[a];if(l>=t)s.push(this.get(l));else if(e<=l&&l<t)this.put(l+i,this.get(l));else if(l<e)break}for(let a=0;a<i;a++)this.put(e+a,s[i-1-a])}const{length:o}=r;if(t<e){const s=[];for(let a=ff(r,t);a<o;a++){const l=r[a];if(l>=t&&l<t+i)s.push(this.get(l));else if(t+i<=l&&l<=e)this.put(l-i,this.get(l));else if(l>e)break}for(let a=0;a<i;a++)this.put(e+a,s[a])}}exchangeOrder(t,e,i,r,o){const{_keys:s}=this;if(this._sorted||(s.sort((a,l)=>a<l?-1:a>l?1:0),this._sorted=!0),t>i){const a=[],l=[];for(let h=ff(s,i);h<ff(s,t)+e;h++){const u=s[h];u>=t&&u<t+e?l.push(this.get(u)):a.push(this.get(u))}for(let h=0;h<e;h++)this.put(o+h,l[h]);for(let h=0;h<a.length;h++)this.put(o+e+h,a[h])}else{const a=[],l=[];for(let h=ff(s,t);h<ff(s,i)+r;h++){const u=s[h];u>=t&&u<t+e?l.push(this.get(u)):a.push(this.get(u))}for(let h=0;h<e;h++)this.put(o+h,l[h]);for(let h=0;h<a.length;h++)this.put(t+h,a[h])}}}function ff(n,t){let e=0,i=n.length-1;for(;e<=i;){const r=Math.floor((e+i)/2);if(n[r]===t)return r;n[r]>t?i=r-1:e=r+1}return i<0?0:i}class JVt{constructor(t){this._table=t;const e=ms();this.dragReorderIconName=e[Un.dragReorderIconName]}getIcons(t,e){return[this.dragReorderIconName]}}class QVt{constructor(t,e,i="grid",r=void 0){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:"",value:"",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new Fh,this.dimensionKeysIncludeVirtual=new Fh,this.cache=new Map,this.sizeIncludeParent=r!=null,this.setExpandLevel=r,this.hierarchyType=i,this.sharedVar=e,this.reset(t)}reset(t){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new Fh,this.dimensionKeysIncludeVirtual=new Fh,this.tree.children=t,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(t,e,i){var r,o,s,a;t.startIndex=e,t.startInTotal=((r=i.startInTotal)!==null&&r!==void 0?r:0)+t.startIndex,t.hide&&(this.hasHideNode=!0),((o=t.dimensionKey)!==null&&o!==void 0?o:t.indicatorKey)&&(t.virtual||this.dimensionKeys.contain(t.indicatorKey?R_:t.dimensionKey)||this.dimensionKeys.put(t.level,t.indicatorKey?R_:t.dimensionKey),this.dimensionKeysIncludeVirtual.contain(t.indicatorKey?R_:t.dimensionKey)||this.dimensionKeysIncludeVirtual.put(t.level,t.indicatorKey?R_:t.dimensionKey),t.id||(t.id=++this.sharedVar.seqId));let l=t.dimensionKey&&this.sizeIncludeParent?1:0;const h=t.children||t.columns;return this.hierarchyType==="grid"||this.hierarchyType===null?h?.length>=1?h.forEach(u=>{var d,c,f;u.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.hierarchyType==="grid"&&(u.afterSpanLevel=((c=t.afterSpanLevel)!==null&&c!==void 0?c:0)+((f=t.levelSpan)!==null&&f!==void 0?f:1)),this.totalLevel=Math.max(this.totalLevel,u.level+1),l+=this.setTreeNode(u,l,t)}):l=t.level===-1?0:1:t.hierarchyState===Lt.expand&&h?.length>=1?h.forEach(u=>{var d;u.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,u.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,u.level+1),l+=this.setTreeNode(u,l,t)}):t.hierarchyState===Lt.collapse&&h?.length>=1?h.forEach(u=>{var d;u.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,u.level+1),this.setTreeNode(u,l,t)}):!t.hierarchyState&&t.level+1<this.setExpandLevel&&(h?.length>=1||h===!0)?(!((s=h[0])===null||s===void 0)&&s.indicatorKey&&this.hierarchyType==="grid-tree"||(t.hierarchyState=Lt.expand),h?.length>=1&&h.forEach(u=>{var d;u.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,u.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,u.level+1),l+=this.setTreeNode(u,l,t)})):h?.length>=1||h===!0?(!((a=h[0])===null||a===void 0)&&a.indicatorKey&&this.hierarchyType==="grid-tree"||(t.hierarchyState=Lt.collapse),h?.length>=1&&h.forEach(u=>{var d;u.level=((d=t.level)!==null&&d!==void 0?d:0)+1,this.totalLevel=Math.max(this.totalLevel,u.level+1),this.setTreeNode(u,l,t)})):(t.hierarchyState=Lt.none,l=t.level===-1?0:1),t.size=l,l}getTreePath(t,e=30){const i=[];return this.searchPath(t,this.tree,i,e),i.shift(),i}findNodeById(t,e){return t.find(i=>i.id===e)}searchPath(t,e,i,r){if(!e||t<e.startIndex||t>=e.startIndex+e.size||(i.push(e),!e.children||e.children.length===0||e.level>=r))return;const o=t-e.startIndex;if(this.cache.has(e.level+1)){const l=this.cache.get(e.level+1);if(o>=l.startIndex&&o<l.startIndex+l.size)return void this.searchPath(o,l,i,r)}let s=0,a=e.children.length-1;for(;s<=a;){const l=Math.floor((s+a)/2),h=e.children[l];if(o>=h.startIndex&&o<h.startIndex+h.size){this.cache.set(h.level,h);const u=[];this.cache.forEach((d,c)=>{c>h.level&&u.push(c)}),u.forEach(d=>{this.cache.delete(d)}),this.searchPath(o,h,i,r);break}o<h.startIndex?a=l-1:s=l+1}}movePosition(t,e,i){let r,o,s;const a=(u,d)=>{if(o!==void 0&&s!==void 0)return;u.level===t&&(u.startInTotal===e&&(o=d),u.startInTotal<=i&&i<=u.startInTotal+u.size-1&&(s=d));const c=u.children||u.columns;if(c&&u.level<t){r=u;for(let f=0;f<c.length;f++)(e>=c[f].startInTotal&&e<=c[f].startInTotal+c[f].size||i>=c[f].startInTotal&&i<=c[f].startInTotal+c[f].size)&&a(c[f],f)}};a(this.tree,0);const l=r.children||r.columns,h=l.splice(o,1);h.unshift(s,0),Array.prototype.splice.apply(l,h)}getCopiedTree(){const t=kc(this.tree.children);return jJ(t),t}setAllNodesState(t){this._updateNodeHierarchyState(this.tree,t)}_updateNodeHierarchyState(t,e){t.children&&t.children.length>0&&t.children[0].dimensionKey?(t.level!==-1&&(t.hierarchyState=e),t.children.forEach(i=>{this._updateNodeHierarchyState(i,e)})):t.hierarchyState=Lt.none}}function jJ(n){for(let t=0;t<n.length;t++){const e=n[t];delete e.level,delete e.startIndex,delete e.id,delete e.levelSpan,delete e.size,delete e.startInTotal;const i=e.children||e.columns;i&&jJ(i)}}function tGt(n){const t=n.columnObjects;for(let e=0;e<t.length;e++){const i=t[e];if(i?.aggregation)return!0}return!1}function eGt(n){const t=n.columnObjects;let e=0;for(let i=0;i<t.length;i++){const r=t[i];r?.aggregation&&(Array.isArray(r?.aggregation)?e=Math.max(e,r.aggregation.filter(o=>o.showOnTop).length):r.aggregation.showOnTop&&(e=Math.max(e,1)))}return e}function iGt(n){const t=n.columnObjects;let e=0;for(let i=0;i<t.length;i++){const r=t[i];r?.aggregation&&(Array.isArray(r?.aggregation)?e=Math.max(e,r.aggregation.filter(o=>!o.showOnTop).length):r.aggregation.showOnTop||(e=Math.max(e,1)))}return e}function nGt(n){if(n._table.internalProps.groupBy)return!0;const{columns:t}=n._table.options;if(Mt(t)&&t.length>0)for(let e=0;e<t.length;e++){const i=t[e];if(!Si(i)&&i.tree)return!0}return!1}function rGt(n){const{columns:t,rows:e,indicators:i}=n.options;if(n.isPivotTable()){if(Mt(t)&&t.length>0)for(let r=0;r<t.length;r++){const o=t[r];if(!Si(o)&&(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing)return!0}if(Mt(e)&&e.length>0)for(let r=0;r<e.length;r++){const o=e[r];if(!Si(o)&&(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing)return!0}if(Mt(i)&&i.length>0)for(let r=0;r<i.length;r++){const o=i[r];if(!Si(o)&&((o.cellType==="image"||o.cellType==="video"||typeof o.cellType=="function")&&o.imageAutoSizing||(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing))return!0}}else if(Mt(t)&&t.length>0)for(let r=0;r<t.length;r++){const o=t[r];if((o.cellType==="image"||o.cellType==="video"||typeof o.cellType=="function")&&o.imageAutoSizing||(o.headerType==="image"||o.headerType==="video"||typeof o.headerType=="function")&&o.imageAutoSizing)return!0}return!1}function UJ(n,t){var e;return z5t(t,n)||((e=zD(n,t))!==null&&e!==void 0?e:{top:-1,row:-1,bottom:-1,height:-1})}function XJ(n,t){var e;return N5t(t,n)||((e=FD(n,t))!==null&&e!==void 0?e:{left:-1,col:-1,right:-1,width:1})}function oGt(n,t,e){const i=UJ(t,e),{row:r,top:o,bottom:s,height:a}=i,l=XJ(n,e),{col:h,left:u,right:d,width:c}=l;return{row:r,col:h,rect:{left:u,right:d,top:o,bottom:s,width:c,height:a}}}function FD(n,t){if(n===0)return{left:0,col:0,right:0,width:0};const e=aGt(n,t),i=t.getColsWidth(0,e);return n>=i?((r,o)=>{let s=o-t.getColWidth(r);const{colCount:a}=t.internalProps;for(let l=r;l<a;l++){const h=t.getColWidth(l),u=s+h;if(Math.round(s)<=n&&n<Math.round(u))return{left:s,col:l,right:u,width:h};s=u}return null})(e,i):((r,o)=>{let s=o;for(let a=r;a>=0;a--){const l=t.getColWidth(a),h=s-l;if(Math.round(h)<=n&&n<Math.round(s))return{left:h,col:a,right:s,width:l};s=h}return null})(e,i)}function zD(n,t){var e;if(n===0)return{top:0,row:0,bottom:0,height:0};const i=((e=t.options.customConfig)===null||e===void 0?void 0:e._disableColumnAndRowSizeRound)===!0?Math.floor:Math.round,r=sGt(n,t),o=t.getRowsHeight(0,r);return n>=o?((s,a)=>{let l=a-t.getRowHeight(s);const{rowCount:h}=t.internalProps;for(let u=s;u<h;u++){const d=t.getRowHeight(u),c=l+d;if(i(l)<=i(n)&&i(n)<i(c))return{top:l,row:u,bottom:c,height:d};l=c}return null})(r,o):((s,a)=>{let l=a;for(let h=s;h>=0;h--){const u=t.getRowHeight(h),d=l-u;if(i(d)<=i(n)&&i(n)<i(l))return{top:d,row:h,bottom:l,height:u};l=d}return null})(r,o)}function YJ(n,t,e){if(n===0)return{left:0,col:0,right:0,width:0};if(n-=e.tableX,t&&n>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&n<e.tableNoFrameWidth&&n<=e.getAllColsWidth()){for(let i=0;i<e.rightFrozenColCount;i++)if(n>e.tableNoFrameWidth-e.getColsWidth(e.colCount-i-1,e.colCount-1))return{col:e.colCount-i-1,left:void 0,right:void 0,width:void 0}}return FD(n,e)}function KJ(n,t,e){if(n===0)return{top:0,row:0,bottom:0,height:0};if(n-=e.tableY,t&&n>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&n<e.tableNoFrameHeight){for(let i=0;i<e.rightFrozenColCount;i++)if(n>e.tableNoFrameHeight-e.getRowsHeight(e.rowCount-i-1,e.rowCount-1))return{row:e.rowCount-i-1,top:void 0,bottom:void 0,height:void 0}}return zD(n,e)}function sGt(n,t){let e=t.defaultRowHeight;return t._rowRangeHeightsMap.get("$0$"+(t.rowCount-1))&&(e=t._rowRangeHeightsMap.get("$0$"+(t.rowCount-1))/t.rowCount),Math.min(Math.ceil(n/e),t.rowCount-1)}function aGt(n,t){if(t._colRangeWidthsMap.get("$0$"+(t.colCount-1))){let e=0,i=t.colCount-1;for(;i-e>1;){const r=Math.floor((e+i)/2);if(n<t._colRangeWidthsMap.get(`$0$${r}`))i=r;else{if(!(n>t._colRangeWidthsMap.get(`$0$${r}`)))return r;e=r}}return i}return Math.min(Math.ceil(n/t.internalProps.defaultColWidth),t.colCount-1)}function lGt(n,t,e){n-=e.tableX;let i=!1;(t-=e.tableY)>0&&t<e.getFrozenRowsHeight()&&(i=!0);let r=!1;n>0&&n<e.getFrozenColsWidth()&&(r=!0);let o=!1;t>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&t<e.tableNoFrameHeight&&t<=e.getAllRowsHeight()&&(o=!0);let s=!1;n>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&n<e.tableNoFrameWidth&&n<=e.getAllColsWidth()&&(s=!0);const a=YJ((r||s?n:n+e.scrollLeft)+e.tableX,s,e),l=KJ((i||o?t:t+e.scrollTop)+e.tableY,o,e);if(a&&l){const{row:h,top:u,bottom:d,height:c}=l,{col:f,left:g,right:p,width:v}=a;return{row:h,col:f,rect:{left:g,right:p,top:u,bottom:d,width:v,height:c}}}return{col:-1,row:-1}}function pG(n){return n.length===2&&Dd(n[0])&&Dd(n[1])&&n[1]>=n[0]}function vG(n){const t=n[1]-n[0],e=n[1]*n[0]<0;let i=n[0]<=0?0-n[0]:0,r=n[1]>0?n[1]-0:0;return t===0?n[0]<0?(i=1,r=0):n[0]>0&&(i=0,r=1):(i/=t,r/=t),{total:t,negative:i,positive:r,includeZero:e,domain:n,extendable_min:!0,extendable_max:!0}}function mG(n,t){const{positive:e,negative:i,extendable_min:r,extendable_max:o,domain:s}=n,{positive:a,negative:l,extendable_min:h,extendable_max:u,domain:d}=t;if(a>0){if(!h)return!1;let c=i/e;o&&(c=i/Math.max(e,a),s[1]=-s[0]/c),d[0]=-d[1]*c}else if(l>0){if(!u)return!1;let c=e/i;r&&(c=e/Math.max(i,i),s[0]=-s[1]/c),d[1]=-d[0]*c}return!0}function yG(n,t){const{extendable_min:e,extendable_max:i,domain:r}=n,{positive:o,negative:s,domain:a}=t;return(o!==0||s!==0)&&!(o>0&&!i)&&!(s>0&&!e)&&(r[0]=a[0],r[1]=a[1],!0)}function bG(n,t){const{positive:e,negative:i,extendable_max:r,domain:o}=n,{positive:s,negative:a,extendable_min:l,domain:h}=t;if(r&&l){const u=Math.max(i,a)/Math.max(e,s);o[1]=-o[0]/u,h[0]=-h[1]*u}else if(l){const u=i/e;h[0]=-h[1]*u}else{if(!r)return!1;{const u=a/s;o[1]=-o[0]/u}}return!0}function _G(n,t){const{extendable_min:e,domain:i}=n,{extendable_max:r,domain:o}=t;return!(!e||!r)&&(i[0]=-i[1],o[1]=-o[0],!0)}function hGt(n,t){const e=[n.min,n.max],i=[t.min,t.max];if(!pG(e)||!pG(i))return;const r=vG(e),o=vG(i),{positive:s,negative:a,extendable_max:l,includeZero:h}=r,{positive:u,negative:d,extendable_max:c,includeZero:f}=o;if(s===0&&a===0){if(!yG(r,o))return}else if(u===0&&d===0){if(!yG(o,r))return}else if(h||f)if(h&&!f){if(!mG(r,o))return}else if(f&&!h){if(!mG(o,r))return}else{if(a===d)return;if(a>d){if(!bG(r,o))return}else if(!bG(o,r))return}else{if(a===0&&u===0){if(!_G(r,o))return}else if(d===0&&s===0&&!_G(o,r))return;if(a===0&&d===0)if(e[0]===0&&i[0]>0)i[0]=0;else{if(!(i[0]===0&&e[0]>0))return;e[0]=0}if(s===0&&u===0)if(e[1]===0&&i[1]>0){if(!c)return;i[1]=0}else{if(!(i[1]===0&&e[1]>0)||!l)return;e[1]=0}}return{range1:e,range2:i}}function uGt(n,t,e,i,r,o){const s=Bt.getFunction("getAxisDomainRangeAndLabels"),{axisOption:a,isZeroAlign:l}=yd(t,e,i===0?"right":"left",o),{ticks:h}=s(n.min,n.max,a,l,r==="bottom"||r==="top"?o._table.getColWidth(t)||o._table.tableNoFrameWidth:o._table.getRowHeight(e)||o._table.tableNoFrameHeight);return h}function D_(n,t,e,i){return i!==0&&n?()=>n.map(r=>{const o=(r-t.min)/(t.max-t.min),s=(e.max-e.min)*o+e.min;return Math.round(100*s)/100}):void 0}function dGt(n,t,e){var i,r,o,s,a,l,h,u,d,c,f,g,p;if(e._table.isPivotChart())if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount){const v=I_("top",n,t+1,n,e.columnHeaderLevelCount-1,n,t,1,e);if(!v)return;const m=e._table._getCellStyle(n,t+1),y=ce(ut("padding",m,n,t+1,e._table)),{range:b,ticks:_,axisOption:w,targetTicks:C,targetRange:x,index:S,theme:A}=v;return pt(w?.min)&&(b.min=w.min,b.min>0&&(w.zero=!1)),pt(w?.max)&&(b.max=w.max,b.max<0&&(w.zero=!1)),Ue({range:b},w,{orient:"top",type:w?.type||"linear",label:{flush:!0},tick:{tickMode:D_(C,x,b,S)},__ticksForVTable:_,__vtableChartTheme:A,__vtablePadding:y})}if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount){const v=e.getIndicatorKeyInChartSpec(n,t);let m=null;v?.forEach(P=>{const B=e.getIndicatorInfo(P);B&&(m=B)});const y=I_("bottom",n,t-1,n,t,n,t,0,e),{chartType:b}=yd(n,t-1,"bottom",e);if(!y)return;const _=e._table._getCellStyle(n,t-1),w=ce(ut("padding",_,n,t-1,e._table)),{range:C,ticks:x,axisOption:S,index:A,targetTicks:T,targetRange:M,theme:R}=y;pt(S?.min)&&(C.min=S.min,C.min>0&&(S.zero=!1)),pt(S?.max)&&(C.max=S.max,C.max<0&&(S.zero=!1));let E=[];if(b==="heatmap"){const P=e.getDimensionKeyInChartSpec(n,e.rowCount-e.bottomFrozenRowCount-1,"xField"),B=(i=e.dataset.collectedValues[P])!==null&&i!==void 0?i:[],k=e.getColKeysPath(n,t);E=(r=B?.[k??""])!==null&&r!==void 0?r:[]}return Ue({title:{visible:!0,text:m?.title},range:C,domain:S?.type==="linear"?void 0:Array.from(E)},S,{orient:"bottom",type:S?.type||"linear",label:{flush:!0},tick:{tickMode:D_(T,M,C,A)},__ticksForVTable:x,__vtableChartTheme:R,__vtablePadding:w})}if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){let v=e.getDimensionKeyInChartSpec(e.rowHeaderLevelCount,t);Mt(v)&&(v=v[0]);const m=(o=e.dataset.collectedValues[v])!==null&&o!==void 0?o:[],y=e.getRowKeysPath(n,t),b=(s=m[y??""])!==null&&s!==void 0?s:[],{axisOption:_,theme:w,chartType:C}=yd(n+1,t,"left",e);if(_?.visible===!1)return;const x=e._table._getCellStyle(n+1,t),S=ce(ut("padding",x,n+1,t,e._table)),A=e.getRawChartSpec(n+1,t);return Ue({domain:_?.type==="linear"?void 0:Array.from(b),range:_?.type==="linear"?b:void 0,title:{autoRotate:!0}},_,{orient:"left",type:(a=_?.type)!==null&&a!==void 0?a:"band",__vtableChartTheme:w,inverse:gGt(_,((l=A?.direction)!==null&&l!==void 0?l:C==="scatter"?"vertical":"horizontal")==="horizontal"),__vtablePadding:S})}}else{if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){const v=e.getIndicatorKeyInChartSpec(n,t);let m=null;v?.forEach(P=>{const B=e.getIndicatorInfo(P);B&&(m=B)});const y=I_("left",n+1,t,n,t,n,t,0,e),{chartType:b}=yd(n+1,t,"left",e);if(!y)return;const _=e._table._getCellStyle(n+1,t),w=ce(ut("padding",_,n+1,t,e._table)),{range:C,ticks:x,axisOption:S,index:A,targetTicks:T,targetRange:M,theme:R}=y;pt(S?.min)&&(C.min=S.min,C.min>0&&(S.zero=!1)),pt(S?.max)&&(C.max=S.max,C.max<0&&(S.zero=!1));let E=[];if(b==="heatmap"){const P=e.getDimensionKeyInChartSpec(e.rowHeaderLevelCount,t,"yField"),B=(h=e.dataset.collectedValues[P])!==null&&h!==void 0?h:[],k=e.getRowKeysPath(n,t);E=(u=B?.[k??""])!==null&&u!==void 0?u:[]}return Ue({title:{visible:!0,text:m?.title,autoRotate:!0},range:C,domain:S?.type==="linear"?void 0:Array.from(E)},S,{orient:"left",type:S?.type||"linear",label:{flush:!0},tick:{tickMode:D_(T,M,C,A)},__ticksForVTable:x,__vtableChartTheme:R,__vtablePadding:w})}if(n===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){const v=I_("right",n-1,t,e.rowHeaderLevelCount-1,t,n,t,1,e),{chartType:m}=yd(n-1,t,"right",e);if(!v)return;const y=e._table._getCellStyle(n-1,t),b=ce(ut("padding",y,n-1,t,e._table)),{range:_,ticks:w,axisOption:C,index:x,targetTicks:S,targetRange:A,theme:T}=v;pt(C?.min)&&(_.min=C.min,_.min>0&&(C.zero=!1)),pt(C?.max)&&(_.max=C.max,_.max<0&&(C.zero=!1));let M=[];if(m==="heatmap"){const R=e.getDimensionKeyInChartSpec(e.colCount-e.rightFrozenColCount-1,t,"yField"),E=(d=e.dataset.collectedValues[R])!==null&&d!==void 0?d:[],P=e.getRowKeysPath(n,t);M=(c=E?.[P??""])!==null&&c!==void 0?c:[]}return Ue({range:_,title:{autoRotate:!0},domain:C?.type==="linear"?void 0:Array.from(M)},C,{orient:"right",type:C?.type||"linear",label:{flush:!0},tick:{tickMode:D_(S,A,_,x)},__ticksForVTable:w,__vtableChartTheme:T,__vtablePadding:b})}if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount){let v=e.getDimensionKeyInChartSpec(n,e.columnHeaderLevelCount);Mt(v)&&(v=v[0]);const m=(f=e.dataset.collectedValues[v])!==null&&f!==void 0?f:[],y=e.getColKeysPath(n,t),b=(g=m?.[y??""])!==null&&g!==void 0?g:[],{axisOption:_,isPercent:w,theme:C,chartType:x}=yd(n,t-1,"bottom",e);if(_?.visible===!1)return;const S=e._table._getCellStyle(n,t-1),A=ce(ut("padding",S,n,t-1,e._table));return Ue({domain:_?.type==="linear"?void 0:Array.from(b),range:_?.type==="linear"?b:void 0},_,{orient:"bottom",type:(p=_?.type)!==null&&p!==void 0?p:"band",__vtableChartTheme:C,__vtablePadding:A})}}}function yd(n,t,e,i){var r,o;const s=i.getRawChartSpec(n,t),a=(r=s.axes)!==null&&r!==void 0?r:[];if(i._table.pivotChartAxes.forEach(d=>{a.findIndex(c=>d.orient===c.orient)===-1&&a.push(d)}),s&&Mt(a)){const d=a.find(c=>c.orient===e);if(d){const{seriesIndex:c,seriesId:f}=d;let g,p;Y(f)&&Mt(s.series)?g=(Mt(f)?f:[f]).map(y=>{const b=s.series.findIndex(_=>_.id===y);return b>=0&&(p=s.series[b]),b}):Y(c)&&Mt(s.series)&&(g=c);const{isZeroAlign:v,isTickAlign:m}=CG(s,e,i);return{axisOption:d,isPercent:s.percent,isZeroAlign:v,isTickAlign:m,seriesIndice:g,theme:s.theme,chartType:(o=p?.type)!==null&&o!==void 0?o:s.type}}}const l=i._table.pivotChartAxes.find(d=>d.orient===e),{isZeroAlign:h,isTickAlign:u}=CG(s,e,i);return{axisOption:l,isPercent:!1,isZeroAlign:h,isTickAlign:u,theme:s.theme,chartType:s.type}}function CG(n,t,e){const i=[];let r;t==="left"||t==="right"?i.push("left","right"):t!=="top"&&t!=="bottom"||i.push("top","bottom"),r=n&&Mt(n.axes)?n.axes:e._table.pivotChartAxes;let o=!1,s=!1;if(Mt(r)){const a=[];r.forEach(l=>{i.includes(l.orient)&&a.push(l)});for(let l=0;l<a.length;l++){const h=a[l];h.sync&&h.sync.axisId&&a.find(u=>u.id===h.sync.axisId)&&(o=o||h.sync.zeroAlign,s=s||h.sync.tickAlign)}}return{isZeroAlign:o,isTickAlign:s}}function qJ(n,t,e,i,r){var o;if(Mt(r)){const h={min:1/0,max:-1/0};for(let u=0;u<r.length;u++){const d=qJ(n,t,e,i,r[u]);d&&(h.min=Math.min(h.min,d.min),h.max=Math.max(h.max,d.max))}return isFinite(h.min)&&isFinite(h.max)?h:null}let s=t?.[r];if(Mt(s)&&(s=s[0]),!s)return null;const a=n[s],l=Ue({},(o=a?.[i??""])!==null&&o!==void 0?o:{min:0,max:1});return l.positiveMax&&l.positiveMax>l.max&&(l.max=l.positiveMax),l.negativeMin&&l.negativeMin<l.min&&(l.min=l.negativeMin),l.min===l.max&&(l.min>0?l.min=0:l.max=0),l}function cGt(n,t,e){if(!e._table.isPivotChart())return!1;if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount||t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return!0}else if(t===e.rowCount-e.bottomFrozenRowCount&&n>=e.rowHeaderLevelCount&&n<e.colCount-e.rightFrozenColCount)return!0;return!1}function fGt(n,t,e){if(!e._table.isPivotChart())return!1;if(e.indicatorsAsCol){if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return!0}else if(n===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount||n===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return!0;return!1}var wG;function gGt(n,t){let e=n?.inverse;return t&&!pGt(n?.orient)&&(e=!Y(n?.inverse)||!n?.inverse),e}function pGt(n){return n==="bottom"||n==="top"}(function(n){n.vertical="vertical",n.horizontal="horizontal"})(wG||(wG={}));function I_(n,t,e,i,r,o,s,a,l){const h=l.getIndicatorKeyInChartSpec(i,r);let u;u=n==="top"||n==="bottom"?l.getColKeysPath(o,s):l.getRowKeysPath(o,s);const d=ZJ(t,e,a,n,h,u,l);if(!d)return;const c=n==="bottom"?"top":n==="top"?"bottom":n==="left"?"right":"left",{targetRange:f,targetTicks:g}=vGt(t,e,d.index,d.isZeroAlign,d.isTickAlign,d.range,h,c,u,l);if(d.index!==0&&g){const p=Bt.getFunction("getAxisDomainRangeAndLabels"),{range:v,ticks:m}=p(d.range.min,d.range.max,d.axisOption,d.isZeroAlign,n==="bottom"||n==="top"?l._table.getColWidth(o)||l._table.tableNoFrameWidth:l._table.getRowHeight(s)||l._table.tableNoFrameHeight,{targetTicks:g,targetRange:f});d.range.min=v[0],d.range.max=v[1],d.ticks=m}return d.targetRange=f,d.targetTicks=g,d}function ZJ(n,t,e,i,r,o,s){const{axisOption:a,isPercent:l,isZeroAlign:h,isTickAlign:u,seriesIndice:d,theme:c,chartType:f}=yd(n,t,i,s),g=qJ(s.dataset.collectedValues,r,h,o,d??e);if(!g)return;l&&(g.min=g.min<0?-1:0,g.max=g.max>0?1:0),(a?.zero||g.min===g.max)&&(g.min=Math.min(g.min,0),g.max=Math.max(g.max,0));const p=Bt.getFunction("getAxisDomainRangeAndLabels"),{range:v,ticks:m}=p(g.min,g.max,a,h,i==="bottom"||i==="top"?s._table.getColWidth(n)||s._table.tableNoFrameWidth:s._table.getRowHeight(t)||s._table.tableNoFrameHeight);a?.nice&&(g.min=v[0],g.max=v[1]);const y=m;return pt(a?.min)&&(g.min=a.min),pt(a?.max)&&(g.max=a.max),{index:d??e,range:g,ticks:y,isZeroAlign:h,isTickAlign:u,axisOption:a,theme:c,chartType:f}}function vGt(n,t,e,i,r,o,s,a,l,h){let u,d;if(!i&&!r)return{targetTicks:u,targetRange:d};const c=ZJ(n,t,s.length-1-e,a,s,l,h);if(c){const{range:f,ticks:g}=c;if(d=f,i){const p=hGt(o,f);p&&(o.min=p.range1[0],o.max=p.range1[1],d.min=p.range2[0],d.max=p.range2[1])}r&&(u=i?uGt(d,n,t,e,a,h):g)}return{targetTicks:u,targetRange:d}}class mGt{constructor(t,e,i){this.table=t,this.customCellStyle=e,this.customCellStyleArrangement=i}getCustomCellStyle(t,e){const i=this.getCustomCellStyleIds(t,e);if(i.length){const r=[];return i.forEach(o=>{const s=this.getCustomCellStyleOption(o);if(Bo(s?.style)){const a=s.style({col:t,row:e,table:this.table,value:this.table.getCellValue(t,e),dataValue:this.table.getCellOriginValue(t,e),cellHeaderPaths:this.table.getCellHeaderPaths(t,e)});r.push(a)}else s?.style&&r.push(s.style)}),Ue({},...r)}}getCustomCellStyleIds(t,e){const i=[],r=this.table.getCellRange(t,e);for(let o=r.start.col;o<=r.end.col;o++)for(let s=r.start.row;s<=r.end.row;s++)this.customCellStyleArrangement.forEach(a=>{a.cellPosition.range?a.cellPosition.range.start.col<=o&&a.cellPosition.range.end.col>=o&&a.cellPosition.range.start.row<=s&&a.cellPosition.range.end.row>=s&&i.push(a.customStyleId):a.cellPosition.col===o&&a.cellPosition.row===s&&i.push(a.customStyleId)});return i}getCustomCellStyleOption(t){return this.customCellStyle.find(e=>e.id===t)}registerCustomCellStyle(t,e){const i=this.customCellStyle.findIndex(r=>r.id===t);i===-1?this.customCellStyle.push({id:t,style:e}):this.customCellStyle[i]={id:t,style:e},this.customCellStyleArrangement.forEach(r=>{const o=r.cellPosition;if(r.customStyleId===t)if(o.range)for(let s=Math.max(0,o.range.start.col);s<=Math.min(this.table.colCount-1,o.range.end.col);s++)for(let a=Math.max(0,o.range.start.row);a<=Math.min(this.table.rowCount-1,o.range.end.row);a++)this.table.scenegraph.updateCellContent(s,a);else this.table.scenegraph.updateCellContent(o.col,o.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(t,e,i){var r;const o=this.customCellStyleArrangement.findIndex(a=>a.cellPosition.range&&t.range?a.cellPosition.range.start.col===t.range.start.col&&a.cellPosition.range.start.row===t.range.start.row&&a.cellPosition.range.end.col===t.range.end.col&&a.cellPosition.range.end.row===t.range.end.row:a.cellPosition.col===t.col&&a.cellPosition.row===t.row);if(o===-1&&!e)return;if(o===-1&&e)this.customCellStyleArrangement.push({cellPosition:{col:t.col,row:t.row,range:t.range},customStyleId:e});else{if(this.customCellStyleArrangement[o].customStyleId===e)return;e?this.customCellStyleArrangement[o].customStyleId=e:this.customCellStyleArrangement.splice(o,1)}const s=(r=this.getCustomCellStyleOption(e))===null||r===void 0?void 0:r.style;if(s){i=!0;for(const a in s)if(_Ht.indexOf(a)===-1){i=!1;break}}if(t.range)for(let a=Math.max(0,t.range.start.col);a<=Math.min(this.table.colCount-1,t.range.end.col);a++)for(let l=Math.max(0,t.range.start.row);l<=Math.min(this.table.rowCount-1,t.range.end.row);l++){const h=this.table.getCellRange(a,l);for(let u=h.start.col;u<=h.end.col;u++)for(let d=h.start.row;d<=h.end.row;d++)this.table.scenegraph.updateCellContent(u,d,i)}else this.table.scenegraph.updateCellContent(t.col,t.row,i);this.table.scenegraph.updateNextFrame()}updateCustomCell(t,e){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,t.forEach(i=>{this.registerCustomCellStyle(i.id,i.style)}),e.forEach(i=>{this.arrangeCustomCellStyle(i.cellPosition,i.customStyleId)})}hasCustomCellStyle(t){return this.customCellStyle.some(e=>e.id===t)}}function Tv(n,t){n=n.clone();for(const e in t){const i=t[e];Y(i)&&(n[`_${e}`]=i)}return n}const yGt=()=>{Bt.registerComponent("customCellStylePlugin",mGt)},bGt={};function _Gt(n,t,e){var i,r,o,s,a,l,h,u,d,c;const f=(i=e.customCellStylePlugin)===null||i===void 0?void 0:i.getCustomCellStyle(n,t),{layoutMap:g}=e.internalProps;if(g.isHeader(n,t)){let x;if(!e.isPivotTable()||e.isBottomFrozenRow(t)||e.isRightFrozenColumn(n))x=`${n}-${t}`;else{const R=e.getHeaderDefine(n,t),E=e.isCornerHeader(n,t);x=R?.dimensionKey?E?`dim-cor-${R.dimensionKey}`:`dim-${R.dimensionKey}`:R?.indicatorKey?`ind-${R.indicatorKey}`:`${n}-${t}`}let S=e.headerStyleCache.get(x);if(S)return f?Tv(S,f):S;const A=g.getHeader(n,t);let T;if(e.isPivotChart()&&cGt(n,t,g)&&g.isAxisCell(n,t)?T=(o=(r=g.getBody(n,e.rowHeaderLevelCount).style)===null||r===void 0?void 0:r.padding)!==null&&o!==void 0?o:e.theme.bodyStyle.padding:e.isPivotChart()&&fGt(n,t,g)&&g.isAxisCell(n,t)&&(T=(a=(s=g.getBody(e.columnHeaderLevelCount,t).style)===null||s===void 0?void 0:s.padding)!==null&&a!==void 0?a:e.theme.bodyStyle.padding),(!A||A.isEmpty)&&(g.isLeftBottomCorner(n,t)||g.isRightBottomCorner(n,t)||g.isCornerHeader(n,t)||g.isRightTopCorner(n,t)))return bGt;const M=e.internalProps.headerHelper.getStyleClass(A?.headerType||"text");if(g.isBottomFrozenRow(n,t)&&e.theme.bottomFrozenStyle)S=SC(T?{padding:T}:{},e.theme.bottomFrozenStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},M,e.options.autoWrapText,e.theme);else if(g.isRightFrozenColumn(n,t)&&e.theme.rightFrozenStyle)S=SC(T?{padding:T}:{},e.theme.rightFrozenStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},M,e.options.autoWrapText,e.theme);else{const R=A?.style||{};T&&(R.padding=T),S=SC(R,g.isColumnHeader(n,t)||g.isBottomFrozenRow(n,t)?e.theme.headerStyle:g.isRowHeader(n,t)||g.isRightFrozenColumn(n,t)?e.theme.rowHeaderStyle:e.theme.cornerHeaderStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},M,e.options.autoWrapText,e.theme)}return e.headerStyleCache.set(x,S),f?Tv(S,f):S}let p,v;!((h=(l=e.internalProps)===null||l===void 0?void 0:l.dataConfig)===null||h===void 0)&&h.mappingRules&&!e.isHeader(n,t)&&((c=(d=(u=e.internalProps)===null||u===void 0?void 0:u.dataConfig)===null||d===void 0?void 0:d.mappingRules)===null||c===void 0||c.forEach((x,S)=>{x.bgColor&&e.internalProps.layoutMap.getIndicatorKey(n,t)===x.bgColor.indicatorKey&&(p=x.bgColor.mapping)}));const m=e.getCellType(n,t),y=e.getCellOriginRecord(n,t);let b;if(v=y?.vtableMerge?"merge-title":e.isSeriesNumberInBody(n,t)?`${n}-series-`+m:e.isListTable()&&!e.transpose||e.isPivotTable()&&e.internalProps.layoutMap.indicatorsAsCol?n+m:t+m,b=y?.vtableMerge?e.bodyMergeTitleCache.get(v):g.isBottomFrozenRow(t)?e.bodyBottomStyleCache.get(v):e.bodyStyleCache.get(v),b)return f?Tv(b,f):b;const _=g.getBody(n,t),w=e.internalProps.bodyHelper.getStyleClass(e.getCellType(n,t)),C=_?.style;return b=CD(C,y?.vtableMerge&&e.theme.groupTitleStyle?e.theme.groupTitleStyle:g.isBottomFrozenRow(t)&&e.theme.bottomFrozenStyle?e.theme.bottomFrozenStyle:g.isRightFrozenColumn(n)&&e.theme.rightFrozenStyle?e.theme.rightFrozenStyle:e.theme.bodyStyle,{col:n,row:t,table:e,value:e.getCellValue(n,t),dataValue:e.getCellOriginValue(n,t),cellHeaderPaths:e.getCellHeaderPaths(n,t)},w,e.options.autoWrapText,e.theme),p&&(b=Tv(b,{bgColor:p})),Bo(C)||(g.isBottomFrozenRow(t)?e.bodyBottomStyleCache.set(v,b):e.bodyStyleCache.set(v,b)),f?Tv(b,f):b}function xG(n){return Math.floor(n)===n}class CGt extends fe{onUpdate(t,e,i){if(this.from.x!==this.to.x){const r=t?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*e);this.params.table.scrollLeft=r}if(this.from.y!==this.to.y){const r=t?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*e);this.params.table.scrollTop=r}}}class wGt{constructor(t){this.table=t,this.timeline=new hD,this.ticker=new qq(this.table.scenegraph.stage),this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=Ne({})}scrollTo(t,e){var i,r;const o={x:this.table.scrollLeft,y:this.table.scrollTop},{col:s,row:a}=t;let l,h,u=s,d=a;pt(s)&&!xG(s)&&(u=Math.floor(s),l=s-u),pt(a)&&!xG(a)&&(d=Math.floor(a),h=a-d);const c=this.table.getCellRect(u??0,d??0);let{left:f,top:g}=c;l&&(f+=l*c.width),h&&(g+=h*c.height);const p={x:pt(s)?f-this.table.getFrozenColsWidth():this.table.scrollLeft,y:pt(a)?g-this.table.getFrozenRowsHeight():this.table.scrollTop},v=La(e)?e?3e3:0:(i=e?.duration)!==null&&i!==void 0?i:3e3,m=La(e)?e?"linear":"":(r=e?.easing)!==null&&r!==void 0?r:"linear";new Kq(nn.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new CGt(o,p,v,m,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}function zx(n){return Bo(n)?n:Mt(n)?(t,e)=>n.find(i=>i.range.start.col<=t&&i.range.end.col>=t&&i.range.start.row<=e&&i.range.end.row>=e):void 0}let xGt=class{constructor(t,e){var i;this.plugins=new Map,this.table=t,(i=e.plugins)===null||i===void 0||i.map(r=>{this.register(r),this._bindTableEventForPlugin(r)})}register(t){this.plugins.set(t.id,t)}registerAll(t){t.forEach(e=>this.register(e))}getPlugin(t){return this.plugins.get(t)}getPluginByName(t){return Array.from(this.plugins.values()).find(e=>e.name===t)}_bindTableEventForPlugin(t){var e;(e=t.runTime)===null||e===void 0||e.forEach(i=>{this.table.on(i,(...r)=>{var o;(o=t.run)===null||o===void 0||o.call(t,...r,i,this.table)})})}updatePlugins(t){Array.from(this.plugins.values()).filter(i=>!t?.some(r=>r.id===i.id)).forEach(i=>{this.release(),this.plugins.delete(i.id)}),this.plugins.forEach(i=>{i.update&&i.update()});const e=t?.filter(i=>!this.plugins.has(i.id));e?.forEach(i=>{this.register(i),this._bindTableEventForPlugin(i)})}release(){this.plugins.forEach(t=>{var e;(e=t.release)===null||e===void 0||e.call(t,this.table)})}};const{toBoxArray:gh}=nFt,{isTouchEvent:SGt}=iFt,AGt=/^\$(\d+)\$(\d+)$/;OHt();class TGt extends AA{static get EVENT_TYPE(){return ot}constructor(t,e={}){var i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T;if(super(),this.showFrozenIcon=!0,this.version="1.20.1",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=GHt(this.render.bind(this),200),ye.mode==="node"?(e=t,t=null):t instanceof HTMLElement||(e=t,t=t.container?t.container:null),!t&&e.mode!=="node"&&!e.canvas)throw new Error("vtable's container is undefined");this.pluginManager=new xGt(this,e),this.fireListeners(ot.BEFORE_INIT,{options:e,container:t}),t=e.container&&e.container instanceof HTMLElement?e.container:t,((i=e.customConfig)===null||i===void 0?void 0:i.imageAnonymous)===!1&&(Dt.isImageAnonymous=!1);const{frozenColCount:M=0,unfreezeAllOnExceedsMaxWidth:R,frozenRowCount:E,defaultRowHeight:P=40,defaultHeaderRowHeight:B,defaultColWidth:k=80,defaultHeaderColWidth:L,widthMode:O="standard",heightMode:D="standard",autoFillWidth:I=!1,autoFillHeight:H=!1,containerFit:F={width:!1,height:!1},widthAdaptiveMode:G="only-body",heightAdaptiveMode:j="only-body",keyboardOptions:W,eventOptions:K,rowSeriesNumber:J,enableCheckboxCascade:q,enableHeaderCheckboxCascade:X,columnResizeMode:it,rowResizeMode:Z="none",resize:et,dragHeaderMode:nt,dragOrder:z,showFrozenIcon:V,allowFrozenColCount:$,padding:U,hover:Q,menu:rt,select:st,customRender:at,pixelRatio:ht=hd,renderChartAsync:gt,renderChartAsyncBatchCount:dt,mode:vt,modeParams:oe,canvasWidth:Se,canvasHeight:fi,contentOffsetX:me,contentOffsetY:bn,overscrollBehavior:Gi,limitMinWidth:Ii,limitMinHeight:Yt,clearDOM:ai=!0}=e,{groupConfig:We,groupBy:Hi,groupTitleFieldFormat:br,groupTitleCustomLayout:At,enableTreeStickCell:_i}=e;this.container=t,this.options=e,this._widthMode=O,this._heightMode=D,this._widthAdaptiveMode=G,this._heightAdaptiveMode=j,this._autoFillWidth=I,this._autoFillHeight=H,F!==void 0&&(this._containerFit=typeof F=="boolean"?{width:F,height:F}:F&&typeof F=="object"?{width:(r=F.width)===null||r===void 0||r,height:(o=F.height)===null||o===void 0||o}:{width:!1,height:!1}),this.customRender=at,this.padding={top:0,right:0,left:0,bottom:0},U&&(typeof U=="number"?(this.padding.top=U,this.padding.left=U,this.padding.bottom=U,this.padding.right=U):(U.top&&(this.padding.top=U.top),U.bottom&&(this.padding.bottom=U.bottom),U.left&&(this.padding.left=U.left),U.right&&(this.padding.right=U.right))),(Y(fi)||Y(Se))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.contentOffsetX=me??0,this.contentOffsetY=bn??0,this.canvasWidth=pt(Se)?Se:void 0,this.canvasHeight=pt(fi)?fi:void 0,this.columnWidthComputeMode=(s=e.columnWidthComputeMode)!==null&&s!==void 0?s:"normal";const wt=this.internalProps={};V!==void 0&&(this.showFrozenIcon=V),typeof $=="number"&&$<=0&&(this.showFrozenIcon=!1),this.options.canvas?(ye.mode!=="node"&&(wt.element=this.options.canvas.parentElement,wt.element.style.position="relative"),wt.focusControl=new fG(this,wt.element),wt.canvas=this.options.canvas,wt.context=wt.canvas.getContext("2d")):ye.mode!=="node"&&(wt.element=I5t(this.padding),wt.focusControl=new fG(this,wt.element),wt.canvas=document.createElement("canvas"),wt.element.appendChild(wt.canvas),wt.context=wt.canvas.getContext("2d"),!((a=e.customConfig)===null||a===void 0)&&a.createReactContainer&&O4t(this)),wt.handler=new BA,pt(this.options.resizeTime)&&(wt.handler.resizeTime=this.options.resizeTime),wt.pixelRatio=ht,wt.frozenColCount=M,wt.frozenRowCount=E,wt.unfreezeAllOnExceedsMaxWidth=R==null||R,wt.defaultRowHeight=P,wt.defaultHeaderRowHeight=B??P,wt.defaultColWidth=k,wt.defaultHeaderColWidth=L??k,wt.keyboardOptions=W,wt.eventOptions=K,wt.rowSeriesNumber=J,wt.enableCheckboxCascade=(l=q??J?.enableTreeCheckbox)===null||l===void 0||l,wt.enableHeaderCheckboxCascade=q||X==null||X,wt.columnResizeMode=(h=et?.columnResizeMode)!==null&&h!==void 0?h:it,wt.rowResizeMode=(u=et?.rowResizeMode)!==null&&u!==void 0?u:Z,wt.dragHeaderMode=(c=(d=z?.dragHeaderMode)!==null&&d!==void 0?d:nt)!==null&&c!==void 0?c:"none",wt.renderChartAsync=gt,AV(dt),wt.overscrollBehavior=Gi??"auto",wt.groupBy=(f=We?.groupBy)!==null&&f!==void 0?f:Hi,wt.groupTitleCheckbox=(g=We?.titleCheckbox)!==null&&g!==void 0?g:!!J?.enableTreeCheckbox,wt.groupTitleFieldFormat=(p=We?.titleFieldFormat)!==null&&p!==void 0?p:br,wt.groupTitleCustomLayout=(v=We?.titleCustomLayout)!==null&&v!==void 0?v:At,wt.enableTreeStickCell=(m=We?.enableTreeStickCell)!==null&&m!==void 0?m:_i,wt._rowHeightsMap=new gG(this),wt._rowRangeHeightsMap=new Map,wt._colRangeWidthsMap=new Map,wt._widthResizedColMap=new Set,wt._heightResizedRowMap=new Set,this.colWidthsMap=new Fh,this.colContentWidthsMap=new Fh,this.colWidthsLimit={};const Ec=this;if(wt.calcWidthContext={_:wt,get full(){var _r,_s;return ye.mode==="node"?Ec.canvasWidth/(ht??1):this._.canvas.width/((_s=(_r=this._.context.pixelRatio)!==null&&_r!==void 0?_r:Ec.internalProps.pixelRatio)!==null&&_s!==void 0?_s:window.devicePixelRatio)}},wt.cellTextOverflows={},wt.focusedTable=!1,wt.theme=fh.of((y=e.theme)!==null&&y!==void 0?y:fh.DEFAULT),wt.theme.isPivot=this.isPivotTable(),E_(wt.theme.functionalIconsStyle),t?(ai&&(t.innerHTML=""),t.appendChild(wt.element),this._updateSize()):this._updateSize(),wt.bodyHelper=new NVt(this),wt.headerHelper=new ZVt(this),wt.rowSeriesNumberHelper=new JVt(this),wt.autoWrapText=e.autoWrapText,wt.enableLineBreak=e.enableLineBreak,wt.allowFrozenColCount=(b=e.allowFrozenColCount)!==null&&b!==void 0?b:0,wt.limitMaxAutoWidth=(_=e.limitMaxAutoWidth)!==null&&_!==void 0?_:450,wt.limitMinWidth=Ii!=null?typeof Ii=="number"?Ii:Ii?10:0:10,wt.limitMinHeight=Yt!=null?typeof Yt=="number"?Yt:Yt?10:0:10,this.scenegraph=new m6t(this),this.stateManager=new lVt(this),this.eventManager=new IVt(this),this.animationManager=new wGt(this),e.legends){wt.legends=[];const _r=Bt.getFunction("createLegend");if(Array.isArray(e.legends)){for(let _s=0;_s<e.legends.length;_s++)wt.legends.push(_r(e.legends[_s],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else wt.legends.push(_r(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(wt.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:ao.bottom},e.tooltip),wt.tooltip.renderMode==="html"){const _r=Bt.getComponent("tooltipHandler");_r&&(wt.tooltipHandler=new _r(this,wt.tooltip.confine))}if(wt.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray((w=e.menu)===null||w===void 0?void 0:w.dropDownMenuHighlight)&&this.setDropDownMenuHighlight((C=e.menu)===null||C===void 0?void 0:C.dropDownMenuHighlight),(Array.isArray((x=e.menu)===null||x===void 0?void 0:x.defaultHeaderMenuItems)||typeof((S=e.menu)===null||S===void 0?void 0:S.defaultHeaderMenuItems)=="function")&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),wt.menu.renderMode==="html"){const _r=Bt.getComponent("menuHandler");wt.menuHandler=new _r(this)}this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,wt.stick={changedCells:new Map},wt.customMergeCell=zx(e.customMergeCell);const Lc=Bt.getComponent("customCellStylePlugin");Lc&&(this.customCellStylePlugin=new Lc(this,(A=e.customCellStyle)!==null&&A!==void 0?A:[],(T=e.customCellStyleArrangement)!==null&&T!==void 0?T:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){this.options.canvasHeight!=="auto"&&this.options.canvasWidth!=="auto"||setTimeout(()=>{var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S;let A,T;if(this.options.canvasHeight==="auto"){let M=0;if(!((t=this.theme.frameStyle)===null||t===void 0)&&t.innerBorder)M+=(r=gh((i=(e=this.internalProps.theme.frameStyle)===null||e===void 0?void 0:e.shadowBlur)!==null&&i!==void 0?i:[0])[1])!==null&&r!==void 0?r:0;else if(this.theme.frameStyle){const R=gh((s=(o=this.internalProps.theme.frameStyle)===null||o===void 0?void 0:o.borderLineWidth)!==null&&s!==void 0?s:[null]),E=gh((l=(a=this.internalProps.theme.frameStyle)===null||a===void 0?void 0:a.shadowBlur)!==null&&l!==void 0?l:[0]);M+=((h=R[0])!==null&&h!==void 0?h:0)+((u=E[0])!==null&&u!==void 0?u:0)+(((d=R[2])!==null&&d!==void 0?d:0)+((c=E[2])!==null&&c!==void 0?c:0))}T=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-M:2e4,this.getAllRowsHeight())+M}else T=this.canvasHeight;if(this.options.canvasWidth==="auto"){let M=0;if(!((f=this.theme.frameStyle)===null||f===void 0)&&f.innerBorder)M+=(v=gh((p=(g=this.internalProps.theme.frameStyle)===null||g===void 0?void 0:g.shadowBlur)!==null&&p!==void 0?p:[0])[2])!==null&&v!==void 0?v:0;else if(this.theme.frameStyle){const R=gh((y=(m=this.internalProps.theme.frameStyle)===null||m===void 0?void 0:m.borderLineWidth)!==null&&y!==void 0?y:[null]),E=gh((_=(b=this.internalProps.theme.frameStyle)===null||b===void 0?void 0:b.shadowBlur)!==null&&_!==void 0?_:[0]);M+=((w=R[1])!==null&&w!==void 0?w:0)+((C=E[1])!==null&&C!==void 0?C:0)+(((x=R[3])!==null&&x!==void 0?x:0)+((S=E[3])!==null&&S!==void 0?S:0))}A=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-M:2e4,this.getAllColsWidth())+M}else A=this.canvasWidth;this.setCanvasSize(A,T)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(t,e){this.canvasWidth=t,this.canvasHeight=e,this.options.canvasHeight=e,this.options.canvasWidth=t,this.resize()}setContentInsetXY(t,e){this.contentOffsetX=t,this.contentOffsetY=e,this.options.contentOffsetX=t,this.options.contentOffsetY=e,this.resize()}resize(){var t;this._updateSize(),(t=this.internalProps.legends)===null||t===void 0||t.forEach(e=>{e?.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(t){this.internalProps.rowCount=t}get colCount(){var t;return(t=this.internalProps.colCount)!==null&&t!==void 0?t:0}set colCount(t){this.internalProps.colCount=t}get frozenColCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.frozenColCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.frozenColCount)!==null&&o!==void 0?o:0}set frozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;const e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{const i=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=i}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;const e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{const i=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=i}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.frozenRowCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.frozenRowCount)!==null&&o!==void 0?o:0}set frozenRowCount(t){this.internalProps.frozenRowCount=t,this.options.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}_setFrozenRowCount(t){this.internalProps.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.rightFrozenColCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.rightFrozenColCount)!==null&&o!==void 0?o:0}set rightFrozenColCount(t){this.scenegraph.dealWidthRightFrozen(t)}get bottomFrozenRowCount(){var t,e,i,r,o;return(o=(i=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.bottomFrozenRowCount)!==null&&i!==void 0?i:(r=this.internalProps)===null||r===void 0?void 0:r.bottomFrozenRowCount)!==null&&o!==void 0?o:0}set bottomFrozenRowCount(t){this.scenegraph.dealWidthBottomFrozen(t)}get defaultRowHeight(){return pt(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(t){this.internalProps.defaultRowHeight=t,this.options.defaultRowHeight=t}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(t){this.internalProps.defaultHeaderRowHeight=t,this.options.defaultHeaderRowHeight=t}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(t){this.internalProps.defaultColWidth=t,this.options.defaultColWidth=t}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(t){this.internalProps.defaultHeaderColWidth=t,this.options.defaultHeaderColWidth=t}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(t){this.internalProps._colWidthsMap=t}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(t){this.internalProps._colContentWidthsMap=t}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(t){this.internalProps._colRangeWidthsMap=t}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(t){this.internalProps._rowRangeHeightsMap=t}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(t){this.internalProps._rowHeightsMap=t}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(t){this.internalProps._colWidthsLimit=t}get keyboardOptions(){var t;return(t=this.internalProps.keyboardOptions)!==null&&t!==void 0?t:null}set keyboardOptions(t){this.internalProps.keyboardOptions=t??void 0}get eventOptions(){var t;return(t=this.internalProps.eventOptions)!==null&&t!==void 0?t:null}set eventOptions(t){this.internalProps.eventOptions=t??void 0}get widthMode(){return this._widthMode}set widthMode(t){t!==this._widthMode&&(this._widthMode=t,this.options.widthMode=t)}get heightMode(){return this._heightMode}set heightMode(t){t!==this._heightMode&&(this._heightMode=t,this.options.heightMode=t)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(t){t!==this._autoFillWidth&&(this._autoFillWidth=t)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(t){t!==this._autoFillHeight&&(this._autoFillHeight=t)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(t){t!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=t)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(t){t!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=t)}_colWidthDefineToPxWidth(t){return t==="auto"?0:uf(this,t)}_getMaxFrozenWidth(){var t;const e=(t=this.options.maxFrozenWidth)!==null&&t!==void 0?t:"80%";return uf(this,e)}_getComputedFrozenColCount(t){const e=this._getMaxFrozenWidth();let i=t;for(;this.getColsWidth(0,i-1)>e&&(i--,!(i<=0)););return i}_getColWidthLimits(t){const e=this.colWidthsLimit[t];if(!e)return null;const i={};return e.min&&(i.min=uf(this,e.min),i.minDef=e.min),e.max&&(i.max=uf(this,e.max),i.maxDef=e.max),i}_adjustColWidth(t,e){const i=this._getColWidthLimits(t);return Math.max(W5t(i,e),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(t){var e;if(t!==((e=this.internalProps)===null||e===void 0?void 0:e.pixelRatio)){this.internalProps.pixelRatio=t;const i=this,r=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var o,s;return ye.mode==="node"?r/(t??1):this._.canvas.width/((s=(o=this._.context.pixelRatio)!==null&&o!==void 0?o:i.internalProps.pixelRatio)!==null&&s!==void 0?s:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(t)}}_updateSize(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P;const{padding:B}=this;let k=0,L=0;if(this.tableX=this.contentOffsetX,this.tableY=this.contentOffsetY,this.options.canvas&&this.options.viewBox)k=this.options.viewBox.x2-this.options.viewBox.x1,L=this.options.viewBox.y2-this.options.viewBox.y1,!((t=this==null?void 0:this.scenegraph)===null||t===void 0)&&t.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(k,L));else if(ye.mode==="browser"){const G=this.getElement();let j=0,W=0;const K=Y(this.canvasWidth),J=Y(this.canvasHeight);if(this.canvasSizeSeted&&(K&&(j=this.canvasWidth),J&&(W=this.canvasHeight)),(!K||!J)&&G.parentElement){const X=G.parentElement.style||window.getComputedStyle(G.parentElement);K||(j=G.parentElement.offsetWidth-(parseInt(X.paddingLeft,10)||0)-(parseInt(X.paddingRight,10)||0)),J||(W=G.parentElement.offsetHeight-parseInt(X.paddingTop||"0px",10)-parseInt(X.paddingBottom||"0px",20)),j=(j??1)-(this.options.tableSizeAntiJitter?1:0),W=(W??1)-(this.options.tableSizeAntiJitter?1:0)}G.style.width=j&&j-B.left-B.right+"px"||"0px",G.style.height=W&&W-B.top-B.bottom+"px"||"0px";const{canvas:q}=this.internalProps;k=((i=(e=q.parentElement)===null||e===void 0?void 0:e.offsetWidth)!==null&&i!==void 0?i:1)-(this.options.tableSizeAntiJitter?1:0),L=((o=(r=q.parentElement)===null||r===void 0?void 0:r.offsetHeight)!==null&&o!==void 0?o:1)-(this.options.tableSizeAntiJitter?1:0),!((s=this==null?void 0:this.scenegraph)===null||s===void 0)&&s.stage?!((a=this.options)===null||a===void 0)&&a.viewBox&&!(!((l=this.options)===null||l===void 0)&&l.canvas)&&this.scenegraph.stage.resize(k,L):(q.style.width="",q.style.height="",q.width=k,q.height=L,q.style.width=`${k}px`,q.style.height=`${L}px`),!((h=this.options)===null||h===void 0)&&h.viewBox&&(k=this.options.viewBox.x2-this.options.viewBox.x1,L=this.options.viewBox.y2-this.options.viewBox.y1),!((u=this==null?void 0:this.scenegraph)===null||u===void 0)&&u.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(k,L))}else ye.mode==="node"&&(k=this.canvasWidth-1,L=this.canvasHeight-1);const O=this.getTheme().scrollStyle;let D=0,I=0;D=this.shouldVScrollBarWidthShow(k,L,O)?KR(O):0,I=this.shouldHScrollBarWidthShow(k,L,O)?YR(O):0;const H=Math.floor(k-D),F=Math.floor(L-I);if(!((d=this.internalProps.theme)===null||d===void 0)&&d.frameStyle){const G=gh((f=(c=this.internalProps.theme.frameStyle)===null||c===void 0?void 0:c.borderLineWidth)!==null&&f!==void 0?f:[null]),j=gh((p=(g=this.internalProps.theme.frameStyle)===null||g===void 0?void 0:g.shadowBlur)!==null&&p!==void 0?p:[0]);if(!((v=this.theme.frameStyle)===null||v===void 0)&&v.innerBorder)this.tableX+=this.contentOffsetX,this.tableY+=this.contentOffsetY,this.tableNoFrameWidth=H-((m=j[1])!==null&&m!==void 0?m:0)-this.contentOffsetX,this.tableNoFrameHeight=F-((y=j[2])!==null&&y!==void 0?y:0)-this.contentOffsetY;else{this.tableX+=((b=G[3])!==null&&b!==void 0?b:0)+((_=j[3])!==null&&_!==void 0?_:0),this.tableY+=((w=G[0])!==null&&w!==void 0?w:0)+((C=j[0])!==null&&C!==void 0?C:0);const W=((x=G[1])!==null&&x!==void 0?x:0)+((S=j[1])!==null&&S!==void 0?S:0);this.tableNoFrameWidth=H-(W>D?W-D:0)-(((A=G[3])!==null&&A!==void 0?A:0)+((T=j[3])!==null&&T!==void 0?T:0))-this.contentOffsetX;const K=((M=G[2])!==null&&M!==void 0?M:0)+((R=j[2])!==null&&R!==void 0?R:0);this.tableNoFrameHeight=F-(K>I?K-I:0)-(((E=G[0])!==null&&E!==void 0?E:0)+((P=j[0])!==null&&P!==void 0?P:0))-this.contentOffsetY}}this._clearColRangeWidthsMap(),this._clearRowRangeHeightsMap()}shouldVScrollBarWidthShow(t,e,i){if(i.hoverOn||i.visible==="none")return!1;const r=this.getAllRowsHeight(),o=i.visible?YR(i):0;if(r>e-o&&r<=e){const s=this.getAllColsWidth(),a=i.visible?KR(i):0;if(s>t-a&&s<=t)return!1;if(s>t)return!0;if(s<=t-a)return!1}return!(r<=e-o)}shouldHScrollBarWidthShow(t,e,i){if(i.hoverOn||i.visible==="none")return!1;const r=this.getAllColsWidth(),o=i.visible?KR(i):0;if(r>t-o&&r<=t){const s=this.getAllRowsHeight(),a=i.visible?YR(i):0;if(s>e-a&&s<=e)return!1;if(s>e)return!0;if(s<=e-a)return!1}return!(r<=t-o)}updateViewBox(t){var e,i,r,o,s,a,l,h,u,d,c,f;const g=((r=(i=(e=this.options)===null||e===void 0?void 0:e.viewBox)===null||i===void 0?void 0:i.x2)!==null&&r!==void 0?r:0)-((a=(s=(o=this.options)===null||o===void 0?void 0:o.viewBox)===null||s===void 0?void 0:s.x1)!==null&&a!==void 0?a:0),p=((u=(h=(l=this.options)===null||l===void 0?void 0:l.viewBox)===null||h===void 0?void 0:h.y2)!==null&&u!==void 0?u:0)-((f=(c=(d=this.options)===null||d===void 0?void 0:d.viewBox)===null||c===void 0?void 0:c.y1)!==null&&f!==void 0?f:0),v=t.x2-t.x1,m=t.y2-t.y1;this.options.viewBox=t,g!==v||p!==m?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(t,e,i,r,o,s){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(t,e,i,r,o,s)}get rowHierarchyType(){return this.dataSource.rowHierarchyType}getColsWidth(t,e){var i;if(t>e)return 0;t=Math.max(t,0),e=Math.min(e,((i=this.colCount)!==null&&i!==void 0?i:1/0)-1);const r=this._colRangeWidthsMap.get(`$${t}$${e}`);if(r!=null)return r;const o=this._colRangeWidthsMap.get(`$${t}$${e-1}`);if(o!=null){let a=o+this.getColWidth(e);return this.rightFrozenColCount>0&&e===this.colCount-this.rightFrozenColCount&&(a=this._getRangeSizeForContainerFit(t,e,a,"col")),t>=0&&e>=0&&!Number.isNaN(a)&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(a)),Math.round(a)}let s=0;for(let a=t;a<=e;a++)s+=this.getColWidth(a);return s=this._getRangeSizeForContainerFit(t,e,s,"col"),t>=0&&e>=0&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(s)),Math.round(s)}getRowHeight(t){var e;if(Y(this.rowHeightsMap.get(t))){if(!((e=this.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound){const r=this.rowHeightsMap.get(t);let o;return o=t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t),o=Number(o.toFixed(2)),Number.isInteger(o)?Math.ceil(r):Math.floor(r)}return this.rowHeightsMap.get(t)}const i=this.getDefaultRowHeight(t);return pt(i)?i:this.defaultRowHeight}getDefaultColumnWidth(t){var e,i;return this.isRowHeader(t,0)||this.isCornerHeader(t,0)?Array.isArray(this.defaultHeaderColWidth)?(e=this.defaultHeaderColWidth[t])!==null&&e!==void 0?e:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(t,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?(i=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])!==null&&i!==void 0?i:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(t){var e,i;return this.isColumnHeader(0,t)||this.isCornerHeader(0,t)||this.isSeriesNumberInHeader(0,t)?Array.isArray(this.defaultHeaderRowHeight)?(e=this.defaultHeaderRowHeight[t])!==null&&e!==void 0?e:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(t)?Array.isArray(this.defaultHeaderRowHeight)?(i=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])!==null&&i!==void 0?i:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(t,e,i){var r;this.rowHeightsMap.put(t,!((r=this.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound?e:Math.round(e)),i&&this._clearRowRangeHeightsMap(t)}setRowHeight(t,e){this.scenegraph.setRowHeight(t,e),this.scenegraph.updateChartSizeForResizeRowHeight(t),this.internalProps._heightResizedRowMap.add(t)}getRowsHeight(t,e){var i,r;if(t>e||this.rowCount===0)return 0;t=Math.max(t,0),e=Math.min(e,((i=this.rowCount)!==null&&i!==void 0?i:1/0)-1);let o=0;const s=this.options.defaultRowHeight==="auto";if(this.heightMode!=="standard"||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||s||this.internalProps._heightResizedRowMap.size!==0){if(!((r=this.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound){const a=this.rowHeightsMap.getSumInRange(t,e);let l;return l=e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e),l=Number(l.toFixed(2)),Number.isInteger(l)?Math.ceil(a):Math.floor(a)}o=this.rowHeightsMap.getSumInRange(t,e)}else{const a=this.rowCount-this.bottomFrozenRowCount;for(let h=t;h<Math.min(e+1,this.columnHeaderLevelCount);h++)o+=this.getRowHeight(h);e>=this.columnHeaderLevelCount&&(o+=this.defaultRowHeight*(Math.min(e,a-1)-Math.max(this.columnHeaderLevelCount,t)+1));let l=0;for(let h=a;h<e+1;h++)l+=this.getRowHeight(h);o=this._getRangeSizeForContainerFit(t,e,o+l,"row")}return Math.round(o)}_getRangeSizeForContainerFit(t,e,i,r="col"){var o;if(!isFinite(t)||!isFinite(e))return i;const s=r==="col"?{totalCount:"colCount",frozenCount:"rightFrozenColCount",fitType:"width",tableSize:"tableNoFrameWidth",getSize:"getColWidth"}:{totalCount:"rowCount",frozenCount:"bottomFrozenRowCount",fitType:"height",tableSize:"tableNoFrameHeight",getSize:"getRowHeight"},a=this[s.tableSize];if(i>=a)return i;const l=this[s.totalCount]-this[s.frozenCount];if(!isFinite(this[s.totalCount])||this[s.frozenCount]<=0||l<0||t>l||e<l||t===e||!(!((o=this.containerFit)===null||o===void 0)&&o[s.fitType]))return i;const h=this[s.totalCount]-1;let u=a;if(t>0){for(let d=0;d<t;d++)if(u-=this[s.getSize](d),u<=0)return i}if(e!==h){for(let d=e+1;d<=h;d++)if(u-=this[s.getSize](d),u<=0)return i}return u}getColWidthDefined(t){var e;const{layoutMap:i}=this.internalProps;if(this.widthMode==="autoWidth")return"auto";const{width:r}=(e=i?.getColumnWidthDefined(t))!==null&&e!==void 0?e:{};return typeof r=="number"&&r<=0?0:r||this.getDefaultColumnWidth(t)}getColWidthDefinedNumber(t){const e=this.getColWidthDefined(t);return this._adjustColWidth(t,this._colWidthDefineToPxWidth(e))}isAutoRowHeight(t){return this.heightMode==="autoHeight"||!!this.options.customComputeRowHeight||(t>=0&&t<this.columnHeaderLevelCount?this.getDefaultRowHeight(t)==="auto":this.internalProps.defaultRowHeight==="auto")}getColWidth(t){var e;const i=(e=this.colWidthsMap.get(t))!==null&&e!==void 0?e:this.getDefaultColumnWidth(t);return this.widthMode==="adaptive"&&typeof i=="number"||this.transpose&&typeof i=="number"?this._colWidthDefineToPxWidth(i):this._adjustColWidth(t,this._colWidthDefineToPxWidth(i))}_setColWidth(t,e,i,r){this.colWidthsMap.put(t,typeof e=="number"?Math.round(e):e),i&&this._clearColRangeWidthsMap(t),r||this.stateManager.checkFrozen()}setColWidth(t,e){this.scenegraph.setColWidth(t,e),this.scenegraph.updateChartSizeForResizeColWidth(t),this.internalProps._widthResizedColMap.add(t)}_clearColRangeWidthsMap(t){if(typeof t!="number")this._colRangeWidthsMap.clear();else{const e=this._colRangeWidthsMap.keys();for(const i of e){const r=AGt.exec(i);if(r){const o=Number(r[1]),s=Number(r[2]);t>=o&&t<=s&&this._colRangeWidthsMap.delete(i)}}}}_clearRowRangeHeightsMap(t){this.rowHeightsMap.clearRange()}_getColContentWidth(t){return Number(this.colContentWidthsMap.get(t))}_setColContentWidth(t,e){this.colContentWidthsMap.put(t,e)}getAllRowsHeight(){return this.internalProps.rowCount<=0?0:this.getRowsHeight(0,this.internalProps.rowCount-1)}getAllColsWidth(){return this.internalProps.colCount<=0?0:this.getColsWidth(0,this.internalProps.colCount-1)}getColsWidths(){const t=this.colCount,e=[];for(let i=0;i<t;i++)e.push(this.getColWidth(i));return e}getMaxColWidth(t){var e;const i=this.colWidthsLimit[t];let r=(e=i&&i.max)!==null&&e!==void 0?e:1/0;return typeof r=="string"&&(r=uf(this,r)),r}setMaxColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).max=e}getMinColWidth(t){var e;const i=this.colWidthsLimit[t];let r=(e=i&&i.min)!==null&&e!==void 0?e:0;return typeof r=="string"&&(r=uf(this,r)),r}setMinColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).min=e}getCellRect(t,e){var i,r;const o=this.isFrozenCell(t,e);let s;const a=this.getColWidth(t);let l;s=o&&o.col&&this.isRightFrozenColumn(t,e)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,t-1)||0:this.tableNoFrameWidth-((i=this.getColsWidth(t,this.colCount-1))!==null&&i!==void 0?i:0):this.getColsWidth(0,t-1)||0;const h=this.getRowHeight(e);return l=o&&o.row&&this.isBottomFrozenRow(t,e)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,e-1):this.tableNoFrameHeight-((r=this.getRowsHeight(e,this.rowCount-1))!==null&&r!==void 0?r:0):this.getRowsHeight(0,e-1),new Ma(Math.round(s),Math.round(l),Math.round(a),Math.round(h))}getMergeCellRect(t,e){const i=this.getCellRange(t,e),r=this.getColsWidth(0,i.start.col-1)||0,o=this.getColsWidth(i.start.col,i.end.col),s=this.getRowsHeight(0,i.start.row-1)||0,a=this.getRowsHeight(i.start.row,i.end.row);return new Ma(Math.round(r),Math.round(s),Math.round(o),Math.round(a))}getCellRelativeRect(t,e){const i=this.isFrozenCell(t,e);let r=!0,o=!0;i?.col&&i?.row?(r=!1,o=!1):i?.col?r=!1:i?.row&&(o=!1);const s=this.getCellRect(t,e);return this._toRelativeRect(s,r,o)}getCellRangeRelativeRect(t){if(t.start){const s=this.isFrozenCell(t.start.col,t.start.row);let a=!0,l=!0;return s?.col&&s?.row?(a=!1,l=!1):s?.col?a=!1:s?.row&&(l=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),a,l)}const e=this.getCellRange(t.col,t.row),i=this.isFrozenCell(t.col,t.row);let r=!0,o=!0;return i?.col&&i?.row?(r=!1,o=!1):i?.col?r=!1:i?.row&&(o=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),r,o)}getVisibleCellRangeRelativeRect(t){let e;return e=t.start?t:this.getCellRange(t.col,t.row),this._getVisiableRect(this.getCellRangeRelativeRect(t),e)}_getVisiableRect(t,e){const i=e.start.col>=this.frozenColCount?Math.max(t.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):t.left,r=Math.min(t.right,this.tableNoFrameWidth),o=t.copy();o.left=i,o.right=r;const s=e.start.row>=this.frozenRowCount?Math.max(t.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):t.top,a=Math.min(t.bottom,this.tableNoFrameHeight);return o.top=s,o.bottom=a,o}getCellsRect(t,e,i,r){var o,s,a,l,h,u;let d=this.getColsWidth(0,t-1)||0,c=this.getColsWidth(t,i);const f=this.scrollLeft,g=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),p=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());this.isLeftFrozenColumn(t)&&this.isRightFrozenColumn(i)?c=this.tableNoFrameWidth-((o=this.getColsWidth(t+1,this.colCount-1))!==null&&o!==void 0?o:0)-d:this.isLeftFrozenColumn(t)&&!this.isLeftFrozenColumn(i)?c=Math.max(c-f,this.getColsWidth(t,this.frozenColCount-1)):!this.isRightFrozenColumn(t)&&this.isRightFrozenColumn(i)?(d=Math.min(d-f,g-this.getRightFrozenColsWidth()),c=g-((s=this.getColsWidth(t+1,this.colCount-1))!==null&&s!==void 0?s:0)-d):this.isRightFrozenColumn(t)&&(d=g-((a=this.getColsWidth(t,this.colCount-1))!==null&&a!==void 0?a:0));let v=this.getRowsHeight(0,e-1),m=this.getRowsHeight(e,r);const y=this.scrollTop;return this.isTopFrozenRow(e)&&this.isBottomFrozenRow(r)?m=this.tableNoFrameHeight-((l=this.getRowsHeight(e+1,this.rowCount-1))!==null&&l!==void 0?l:0)-v:this.isTopFrozenRow(e)&&!this.isTopFrozenRow(r)?m=Math.max(m-y,this.getRowsHeight(e,this.frozenRowCount-1)):!this.isBottomFrozenRow(e)&&this.isBottomFrozenRow(r)?(v=Math.min(v-y,p-this.getBottomFrozenRowsHeight()),m=p-((h=this.getRowsHeight(e+1,this.rowCount-1))!==null&&h!==void 0?h:0)-v):this.isBottomFrozenRow(e)&&(v=p-((u=this.getRowsHeight(e,this.rowCount-1))!==null&&u!==void 0?u:0)),new Ma(Math.round(d),Math.round(v),Math.round(c),Math.round(m))}getCellsRectWidth(t,e,i,r){const o=this.isFrozenCell(t,e),s=this.isFrozenCell(i,r);let a=this.getColsWidth(t,i);if(o&&o.col){const l=this.scrollLeft;s&&s.col||(a-=l,a=Math.max(a,this.getColsWidth(t,this.frozenColCount-1)))}return a}getCellRangeRect(t){if(t.start)return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row);const e=this.getCellRange(t.col,t.row);return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row)}getCellRangeRectWidth(t){if(t.start)return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row);const e=this.getCellRange(t.col,t.row);return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row)}isFrozenCell(t,e){const i=this.isFrozenRow(e),r=this.isFrozenColumn(t);return i||r?{row:i,col:r}:null}getRowAt(t){return UJ(t,this)}getColAt(t){return XJ(t,this)}getCellAt(t,e){return oGt(t,e,this)}getCellAtRelativePosition(t,e){return lGt(t,e,this)}_checkRowCol(t,e){return t>=0&&t<this.colCount&&e>=0&&e<this.rowCount}_makeVisibleCell(t,e){if(this._checkRowCol(t,e)){const i=this.isFrozenCell(t,e);if(i&&i.col&&i.row)return;const r=this.getCellRect(t,e),o=V5t(this);if(o.contains(r))return;i&&i.col||this.getColsWidth(0,this.frozenColCount-1)+r.width>this.canvas.width||(r.left<o.left?this.scrollLeft-=o.left-r.left:o.right<r.right&&(this.scrollLeft-=o.right-r.right)),i&&i.row||this.getRowsHeight(0,this.frozenRowCount-1)+r.height>this.canvas.height||(r.top<o.top?this.scrollTop-=o.top-r.top:o.bottom<r.bottom&&(this.scrollTop-=o.bottom-r.bottom))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((t,e)=>{setTimeout(()=>{t()},0)})}_toRelativeRect(t,e=!0,i=!0){var r,o,s,a;const l=t.copy(),h=this.getVisibleRect();return l.offsetLeft(this.tableX-(e?h.left:0)),l.offsetTop(this.tableY-(i?h.top:0)),l.offsetLeft((o=(r=this.options.viewBox)===null||r===void 0?void 0:r.x1)!==null&&o!==void 0?o:0),l.offsetTop((a=(s=this.options.viewBox)===null||s===void 0?void 0:s.y1)!==null&&a!==void 0?a:0),l}getVisibleRect(){const{scrollTop:t,scrollLeft:e}=this,i=this.tableNoFrameWidth,r=this.tableNoFrameHeight;return new Ma(e,t,i,r)}get visibleRowCount(){const{frozenRowCount:t}=this,e=this.getVisibleRect(),i=t>0?e.top+this.getRowsHeight(0,t-1):e.top,r=this.getTargetRowAt(i);if(!r)return 0;const o=Math.max(r.top>=i?r.row:r.row+1,t);let s=this.getRowsHeight(0,o-1),a=0;const{rowCount:l}=this;for(let h=o;h<l;h++){const u=s+this.getRowHeight(h);if(e.bottom<u)break;a++,s=u}return a}getBodyVisibleCellRange(){const{scrollTop:t,scrollLeft:e}=this,i=this.getFrozenRowsHeight(),r=this.getFrozenColsWidth(),o=this.getBottomFrozenRowsHeight(),s=this.getRightFrozenColsWidth(),{row:a}=this.getRowAt(t+i+1),{col:l}=this.getColAt(e+r+1),h=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-o).row:this.rowCount-1,u=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-s).col:this.colCount-1;return u<0||h<0?null:{rowStart:a,colStart:l,rowEnd:h,colEnd:u}}getBodyVisibleRowRange(){const{scrollTop:t}=this,e=this.getFrozenRowsHeight(),i=this.getBottomFrozenRowsHeight(),{row:r}=this.getRowAt(t+e+1),o=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-i).row:this.rowCount-1;return o<0?null:{rowStart:r,rowEnd:o}}getBodyVisibleColRange(){const{scrollLeft:t}=this,e=this.getFrozenColsWidth(),i=this.getRightFrozenColsWidth(),{col:r}=this.getColAt(t+e+1),o=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-i).col:this.colCount-1;return o<0?null:{colStart:r,colEnd:o}}get visibleColCount(){const{frozenColCount:t}=this,e=this.getVisibleRect(),i=t>0?e.left+this.getColsWidth(0,t-1):e.left,r=this.getTargetColAt(i);if(!r)return 0;const o=Math.max(r.left>=i?r.col:r.col+1,t);let s=this.getColsWidth(0,o-1),a=0;const{colCount:l}=this;for(let h=o;h<l;h++){const u=s+this.getColWidth(h);if(e.right<u)break;a++,s=u}return a}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(t){this.stateManager.setScrollTop(t)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(t){this.stateManager.setScrollLeft(t)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(t){this.scrollLeft=Math.ceil(t)}setScrollTop(t){this.scrollTop=Math.ceil(t)}getCellOverflowText(t,e){return this.scenegraph.getCellOverflowText(t,e)}addReleaseObj(t){if(!t||!t.release||typeof t.release!="function")throw new Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(t)}dispose(){this.release()}release(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m;const y=this.internalProps;if(this.isReleased)return;(e=(t=y.tooltipHandler)===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t),(r=(i=y.menuHandler)===null||i===void 0?void 0:i.release)===null||r===void 0||r.call(i),(o=super.release)===null||o===void 0||o.call(this),this.pluginManager.release(),(a=(s=y.handler)===null||s===void 0?void 0:s.release)===null||a===void 0||a.call(s),this.eventManager.release(),(h=(l=y.focusControl)===null||l===void 0?void 0:l.release)===null||h===void 0||h.call(l),(u=y.legends)===null||u===void 0||u.forEach(_=>{_?.release()}),(d=y.title)===null||d===void 0||d.release(),y.title=null,(c=y.emptyTip)===null||c===void 0||c.release(),y.emptyTip=null,y.layoutMap.release(),y.releaseList&&(y.releaseList.forEach(_=>{var w;return(w=_?.release)===null||w===void 0?void 0:w.call(_)}),y.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release(),y.focusControl.release();const b=(f=y.element)===null||f===void 0?void 0:f.parentElement;b&&!this.options.canvas&&b.removeChild(y.element),(v=(p=(g=this.editorManager)===null||g===void 0?void 0:g.editingEditor)===null||p===void 0?void 0:p.onEnd)===null||v===void 0||v.call(p),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,(m=this.reactCustomLayout)===null||m===void 0||m.clearCache(),aE()}fireListeners(t,e){return super.fireListeners(t,e)}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R;this.fireListeners(ot.BEFORE_UPDATE_OPTION,{options:t,container:this.container}),(i=this.editorManager)===null||i===void 0||i.cancelEdit(),this.options=t,this._hasAutoImageColumn=void 0;const{frozenColCount:E=0,unfreezeAllOnExceedsMaxWidth:P,defaultRowHeight:B=40,defaultHeaderRowHeight:k,defaultColWidth:L=80,defaultHeaderColWidth:O=80,keyboardOptions:D,eventOptions:I,rowSeriesNumber:H,enableCheckboxCascade:F,enableHeaderCheckboxCascade:G,columnResizeMode:j,rowResizeMode:W="none",resize:K,dragHeaderMode:J,dragOrder:q,showFrozenIcon:X,allowFrozenColCount:it,padding:Z,hover:et,menu:nt,select:z,pixelRatio:V,widthMode:$,heightMode:U,autoFillWidth:Q,autoFillHeight:rt,containerFit:st,widthAdaptiveMode:at,heightAdaptiveMode:ht,customRender:gt,renderChartAsync:dt,renderChartAsyncBatchCount:vt,canvasWidth:oe,canvasHeight:Se,contentOffsetX:fi=0,contentOffsetY:me=0,overscrollBehavior:bn,limitMinWidth:Gi,limitMinHeight:Ii}=t,{groupConfig:Yt,groupBy:ai,groupTitleFieldFormat:We,groupTitleCustomLayout:Hi,enableTreeStickCell:br}=t;V&&V!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=V),Z&&(typeof Z=="number"?(this.padding.top=Z,this.padding.left=Z,this.padding.bottom=Z,this.padding.right=Z):(Z.top&&(this.padding.top=Z.top),Z.bottom&&(this.padding.bottom=Z.bottom),Z.left&&(this.padding.left=Z.left),Z.right&&(this.padding.right=Z.right))),this.showFrozenIcon=typeof X!="boolean"||X,typeof it=="number"&&it<=0&&(this.showFrozenIcon=!1),this.widthMode=$??"standard",this.heightMode=U??"standard",this._widthAdaptiveMode=at??"only-body",this._heightAdaptiveMode=ht??"only-body",this.autoFillWidth=Q!=null&&Q,this.autoFillHeight=rt!=null&&rt,st!==void 0&&(this._containerFit=typeof st=="boolean"?{width:st,height:st}:st&&typeof st=="object"?{width:(r=st.width)===null||r===void 0||r,height:(o=st.height)===null||o===void 0||o}:{width:!1,height:!1}),this.customRender=gt,this.contentOffsetX=fi??0,this.contentOffsetY=me??0,this.canvasWidth=pt(oe)?oe:void 0,this.canvasHeight=pt(Se)?Se:void 0;const At=this.internalProps;if(ye.mode==="node"||t.canvas||H5t(At.element,this.padding),this.columnWidthComputeMode=(s=t.columnWidthComputeMode)!==null&&s!==void 0?s:"normal",At.frozenColCount=E,At.unfreezeAllOnExceedsMaxWidth=P==null||P,At.defaultRowHeight=B,At.defaultHeaderRowHeight=k??B,At.defaultColWidth=L,At.defaultHeaderColWidth=O??L,At.keyboardOptions=D,At.eventOptions=I,At.rowSeriesNumber=H,At.enableCheckboxCascade=(a=F??H?.enableTreeCheckbox)===null||a===void 0||a,At.enableHeaderCheckboxCascade=F||G==null||G,At.columnResizeMode=(l=K?.columnResizeMode)!==null&&l!==void 0?l:j,At.rowResizeMode=(h=K?.rowResizeMode)!==null&&h!==void 0?h:W,At.dragHeaderMode=(d=(u=q?.dragHeaderMode)!==null&&u!==void 0?u:J)!==null&&d!==void 0?d:"none",At.renderChartAsync=dt,AV(vt),At.overscrollBehavior=bn??"auto",At.cellTextOverflows={},At.groupBy=(c=Yt?.groupBy)!==null&&c!==void 0?c:ai,At.groupTitleCheckbox=Yt?.titleCheckbox,At.groupTitleFieldFormat=(f=Yt?.titleFieldFormat)!==null&&f!==void 0?f:We,At.groupTitleCustomLayout=(g=Yt?.titleCustomLayout)!==null&&g!==void 0?g:Hi,At.enableTreeStickCell=(p=Yt?.enableTreeStickCell)!==null&&p!==void 0?p:br,e?.clearColWidthCache&&(At._widthResizedColMap.clear(),this.colWidthsMap=new Fh,this.colContentWidthsMap=new Fh,this.colWidthsLimit={}),e?.clearRowHeightCache&&(At._heightResizedRowMap.clear(),At._rowHeightsMap=new gG(this),At._rowRangeHeightsMap=new Map,At._colRangeWidthsMap=new Map),At.stick.changedCells.clear(),At.theme=fh.of((v=t.theme)!==null&&v!==void 0?v:fh.DEFAULT),At.theme.isPivot=this.isPivotTable(),E_(At.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),At.autoWrapText=t.autoWrapText,At.enableLineBreak=t.enableLineBreak,At.allowFrozenColCount=(m=t.allowFrozenColCount)!==null&&m!==void 0?m:0,At.limitMaxAutoWidth=(y=t.limitMaxAutoWidth)!==null&&y!==void 0?y:450,At.limitMinWidth=Gi!=null?typeof Gi=="number"?Gi:Gi?10:0:10,At.limitMinHeight=Ii!=null?typeof Ii=="number"?Ii:Ii?10:0:10,(b=At.legends)===null||b===void 0||b.forEach(_i=>{_i?.release()}),(_=At.title)===null||_===void 0||_.release(),At.title=null,(w=At.emptyTip)===null||w===void 0||w.release(),At.emptyTip=null,At.layoutMap.release(),aE(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),t.legends){At.legends=[];const _i=Bt.getFunction("createLegend");if(Array.isArray(t.legends)){for(let wt=0;wt<t.legends.length;wt++)At.legends.push(_i(t.legends[wt],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else At.legends.push(_i(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(At.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:ao.bottom},t.tooltip),At.tooltip.renderMode==="html"&&!At.tooltipHandler){const _i=Bt.getComponent("tooltipHandler");At.tooltipHandler=new _i(this,At.tooltip.confine)}if(At.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray((C=t.menu)===null||C===void 0?void 0:C.dropDownMenuHighlight)&&this.setDropDownMenuHighlight((x=t.menu)===null||x===void 0?void 0:x.dropDownMenuHighlight),(Array.isArray((S=t.menu)===null||S===void 0?void 0:S.defaultHeaderMenuItems)||typeof((A=t.menu)===null||A===void 0?void 0:A.defaultHeaderMenuItems)=="function")&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),At.menu.renderMode==="html"&&!At.menuHandler){const _i=Bt.getComponent("menuHandler");At.menuHandler=new _i(this)}this.clearCellStyleCache(),e?.clearColWidthCache&&this.clearColWidthCache(),e?.clearRowHeightCache&&this.clearRowHeightCache(),At.customMergeCell=zx(t.customMergeCell),(T=this.customCellStylePlugin)===null||T===void 0||T.updateCustomCell((M=t.customCellStyle)!==null&&M!==void 0?M:[],(R=t.customCellStyleArrangement)!==null&&R!==void 0?R:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();const t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let t=0;for(let e=this.rowCount-this.bottomFrozenRowCount;e<=this.rowCount-1;e++)t+=this.getRowHeight(e);return t}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let t=0;for(let e=this.colCount-this.rightFrozenColCount;e<=this.colCount-1;e++)t+=this.getColWidth(e);return t}return 0}getDrawRange(){var t,e;const i=!((t=this.containerFit)===null||t===void 0)&&t.width?this.tableNoFrameWidth:Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),r=!((e=this.containerFit)===null||e===void 0)&&e.height?this.tableNoFrameHeight:Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new Ma(this.tableX,this.tableY,i,r)}_getMouseAbstractPoint(t){var e,i,r,o,s,a,l,h;let u;if(!t)return{inTable:!1,x:void 0,y:void 0};u=SGt(t)?t.changedTouches[0]:t;const d=u.clientX||u.pageX+window.scrollX,c=u.clientY||u.pageY+window.scrollY,f=this.internalProps.canvas.getBoundingClientRect();let g=!0;f.right<=d&&(g=!1),f.bottom<=c&&(g=!1);const p=f.width,v=p/((this.rotateDegree===90?this.canvas.offsetHeight:this.canvas.offsetWidth)||p),m=f.height,y=m/((this.rotateDegree===90?this.canvas.offsetWidth:this.canvas.offsetHeight)||m),b=this.pluginManager.getPluginByName("Rotate Table");if(b&&this.rotateDegree===90){const w={x:d/v-((i=(e=this.options.viewBox)===null||e===void 0?void 0:e.x1)!==null&&i!==void 0?i:0),y:c/y-((o=(r=this.options.viewBox)===null||r===void 0?void 0:r.y1)!==null&&o!==void 0?o:0),inTable:g};return b.matrix.transformPoint(w,w),w}const _={x:(d-f.left)/v-((a=(s=this.options.viewBox)===null||s===void 0?void 0:s.x1)!==null&&a!==void 0?a:0),y:(c-f.top)/y-((h=(l=this.options.viewBox)===null||l===void 0?void 0:l.y1)!==null&&h!==void 0?h:0),inTable:g};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(_,_),_}getTheme(){return this.internalProps.theme}getTargetColAt(t){return FD(t,this)}getTargetRowAt(t){const e=zD(t,this);return e&&(e.row=Math.min(e.row,this.rowCount-1)),e}getTargetColAtConsiderRightFrozen(t,e){return YJ(t,e,this)}getTargetRowAtConsiderBottomFrozen(t,e){return KJ(t,e,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(t,e,i,r,o,s=!1){var a,l,h;const u=!!(!((a=this.stateManager.select.ranges)===null||a===void 0)&&a.length);this.stateManager.updateSelectPos(t,e,i,r,!1,(h=o??((l=this.options.select)===null||l===void 0?void 0:l.makeSelectCellVisible))===null||h===void 0||h,s),this.stateManager.endSelectCells(!0,u)}selectCells(t){const{scrollLeft:e,scrollTop:i}=this;t.forEach((r,o)=>{var s,a,l,h,u,d;const c=r.start.row,f=r.start.col,g=r.end.row,p=r.end.col;f===p&&c===g?this.stateManager.updateSelectPos(f,c,!1,o>=1,!1,(a=(s=this.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||a===void 0||a,!0):(this.stateManager.updateSelectPos(f,c,!1,o>=1,!1,(h=(l=this.options.select)===null||l===void 0?void 0:l.makeSelectCellVisible)===null||h===void 0||h,!0),this.stateManager.updateInteractionState(Ft.grabing),this.stateManager.updateSelectPos(p,g,!1,o>=1,!1,(d=(u=this.options.select)===null||u===void 0?void 0:u.makeSelectCellVisible)===null||d===void 0||d,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(Ft.default)}),this.setScrollTop(i),this.setScrollLeft(e)}selectRow(t,e,i){const r=this.stateManager.select.ranges;if(e)r.push({start:{col:0,row:t},end:{col:this.colCount-1,row:t}}),this.selectCells(r);else if(i){const o=r[r.length-1];o&&(o.end.row=t),this.selectCells(r)}else this.selectCells([{start:{col:0,row:t},end:{col:this.colCount-1,row:t}}])}selectCol(t,e,i){const r=this.stateManager.select.ranges;if(e)r.push({start:{col:t,row:0},end:{col:t,row:this.rowCount-1}}),this.selectCells(r);else if(i){const o=r[r.length-1];o&&(o.end.col=t),this.selectCells(r)}else this.selectCells([{start:{col:t,row:0},end:{col:t,row:this.rowCount-1}}])}startDragSelectCol(t,e,i){var r,o,s,a,l,h;const u=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],d=i&&(!((r=u?.start)===null||r===void 0)&&r.col)?(o=u?.start)===null||o===void 0?void 0:o.col:t,c=t,f=this.rowCount-1;this.stateManager.updateSelectPos(d,0,i,e,!1,(a=(s=this.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||a===void 0||a,!0),this.stateManager.updateInteractionState(Ft.grabing),this.stateManager.updateSelectPos(c,f,i,e,!1,(h=(l=this.options.select)===null||l===void 0?void 0:l.makeSelectCellVisible)===null||h===void 0||h,!0)}dragSelectCol(t,e){var i,r;const o=this.stateManager.select.ranges,s=o[o.length-1];s&&(s.end.col=t),this.stateManager.updateSelectPos(t,this.rowCount-1,!1,e,!1,(r=(i=this.options.select)===null||i===void 0?void 0:i.makeSelectCellVisible)===null||r===void 0||r,!0)}endDragSelect(){this.stateManager.updateInteractionState(Ft.default),this.stateManager.endSelectCells(!1,!1)}startDragSelectRow(t,e,i){var r,o,s,a,l,h;const u=this.stateManager.select.ranges[this.stateManager.select.ranges.length-1],d=i&&(!((r=u?.start)===null||r===void 0)&&r.row)?(o=u?.start)===null||o===void 0?void 0:o.row:t,c=this.colCount-1,f=t;this.stateManager.updateSelectPos(0,d,i,e,!1,(a=(s=this.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||a===void 0||a,!0),this.stateManager.updateInteractionState(Ft.grabing),this.stateManager.updateSelectPos(c,f,i,e,!1,(h=(l=this.options.select)===null||l===void 0?void 0:l.makeSelectCellVisible)===null||h===void 0||h,!0)}dragSelectRow(t,e){var i,r;const o=this.stateManager.select.ranges,s=o[o.length-1];s&&(s.end.row=t),this.stateManager.updateSelectPos(this.colCount-1,t,!1,e,!1,(r=(i=this.options.select)===null||i===void 0?void 0:i.makeSelectCellVisible)===null||r===void 0||r,!0)}get recordsCount(){var t;return(t=this.records)===null||t===void 0?void 0:t.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(t){this.scenegraph.clearCells(),F5t(this,t),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(t){this.internalProps.autoWrapText=t,this.options.autoWrapText=t}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(t){this.internalProps.enableLineBreak=t,this.options.enableLineBreak=t}updateAutoWrapText(t){this.internalProps.autoWrapText!==t&&(this.internalProps.autoWrapText=t,this.options.autoWrapText=t,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(t){this.internalProps.theme=fh.of(t??fh.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=t,E_(this.internalProps.theme.functionalIconsStyle)}updateTheme(t){const e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=fh.of(t??fh.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),E_(this.internalProps.theme.functionalIconsStyle),this.options.theme=t,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getBodyField(t,e){return this.internalProps.layoutMap.getBody(t,e).field}getBodyColumnDefine(t,e){const i=this.internalProps.layoutMap.getBody(t,e);return i?.define}getBodyColumnType(t,e){var i,r;const o=(r=(i=this.internalProps.layoutMap.getBody(t,e))===null||i===void 0?void 0:i.cellType)!==null&&r!==void 0?r:"text";return ut("cellType",{cellType:o},t,e,this)}getCellType(t,e){let i;return this.isSeriesNumberInHeader(t,e)?this.internalProps.layoutMap.getSeriesNumberHeader(t,e).cellType:(i=this.isHeader(t,e)?this.internalProps.layoutMap.getHeader(t,e).headerType:this.internalProps.layoutMap.getBody(t,e).cellType,ut("cellType",{cellType:i},t,e,this))}getHeaderField(t,e){return this.internalProps.layoutMap.getHeaderField(t,e)}getHeaderDefine(t,e){const i=this.internalProps.layoutMap.getHeader(t,e);return i?.define}getCellLocation(t,e){return this.internalProps.layoutMap.getCellLocation(t,e)}getCellHeaderPaths(t,e){return this.internalProps.layoutMap.getCellHeaderPaths(t,e)}getHeadersDefine(t,e){const i=[];for(;;){const r=this.getHeaderDefine(t,e);if(!r||!r.field&&!r.columns)break;i.push(r),e++}return i}_getHeaderLayoutMap(t,e){return this.internalProps.layoutMap.getHeader(t,e)}_getBodyLayoutMap(t,e){return this.internalProps.layoutMap.getBody(t,e)}getContext(){return this.internalProps.context}getRecordByCell(t,e){if(!this.internalProps.layoutMap.isHeader(t,e))return this.getCellOriginRecord(t,e)}getRecordByRowCol(t,e){return this.getRecordByCell(t,e)}getRecordStartRowByRecordIndex(t){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(t)}_getHeaderCellBySortState(t){const{layoutMap:e}=this.internalProps,i=e.headerObjects.find(r=>r&&r.field===t.field);if(i)return e.getHeaderCellAdressById(i.id)}getCellRange(t,e){var i;if(this.internalProps.customMergeCell){const r=this.internalProps.customMergeCell(t,e,this);if(r&&r.range&&(Y(r.text)||r.customLayout||r.customRender))return{start:{col:Math.max(r.range.start.col,0),row:Math.max(r.range.start.row,0)},end:{col:Math.min(r.range.end.col,this.colCount-1),row:Math.min(r.range.end.row,this.rowCount-1)},isCustom:!0}}return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.getCellRange(t,e)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(t,e){if(this.internalProps.customMergeCell){const i=this.internalProps.customMergeCell(t,e,this);if(i&&i.range&&(Y(i.text)||i.customLayout||this.customRender)){if(i.style){const r=this.internalProps.bodyHelper.getStyleClass("text"),o=i.style,s=CD(o,this.theme.bodyStyle,{col:t,row:e,table:this,value:i.text,dataValue:this.getCellOriginValue(t,e),cellHeaderPaths:this.getCellHeaderPaths(t,e)},r,this.options.autoWrapText,this.theme);i.style=s}return i.range={start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)},isCustom:!0},i}}}isCellRangeEqual(t,e,i,r){return this.internalProps.layoutMap.isCellRangeEqual(t,e,i,r)}_getLayoutCellId(t,e){return this.internalProps.layoutMap.getCellId(t,e)}getHeaderDescription(t,e){var i;const r=this._getHeaderLayoutMap(t,e),o=r?.define,s=(i=o?.description)!==null&&i!==void 0?i:r?.description;return typeof s=="function"?s({col:t,row:e,value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e)}):s}setDropDownMenuHighlight(t){this.stateManager.setDropDownMenuHighlight(t)}_dropDownMenuIsHighlight(t,e,i){return this.stateManager.dropDownMenuIsHighlight(t,e,i)}isSeriesNumberInBody(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(t,e)}isSeriesNumberInHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)}isHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(t,e)}isColumnHeader(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isColumnHeader(t,e)}isRowHeader(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isRowHeader(t,e)}isCornerHeader(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isCornerHeader(t,e)}isFrozenColumn(t,e){return this.isLeftFrozenColumn(t,e)||this.isRightFrozenColumn(t,e)}isLeftFrozenColumn(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isFrozenColumn(t,e)}isRightFrozenColumn(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isRightFrozenColumn(t,e)}isFrozenRow(t,e){return this.isTopFrozenRow(t,e)||this.isBottomFrozenRow(t,e)}isTopFrozenRow(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isFrozenRow(t,e)}isBottomFrozenRow(t,e){var i;return(i=this.internalProps.layoutMap)===null||i===void 0?void 0:i.isBottomFrozenRow(t,e)}getCellInfo(t,e){if(t>=0&&e>=0){const i=this.isHeader(t,e)?this.getHeaderDefine(t,e):this.getBodyColumnDefine(t,e);return{col:t,row:e,field:this.getHeaderField(t,e),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(t,e),title:i?.title,cellType:this.getCellType(t,e),originData:this.getCellOriginRecord(t,e),cellRange:this.getCellRangeRelativeRect({col:t,row:e}),value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e),cellLocation:this.getCellLocation(t,e),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(t,e,i){var r;if(t===null||this.internalProps.layoutMap.isHeader(e,i))return!1;const o=this.getRecordShowIndexByCell(e,i);return(r=this.internalProps.dataSource)===null||r===void 0?void 0:r.hasField(o,t)}_getCellStyle(t,e){return _Gt(t,e,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t+1,e)||this.internalProps.columnResizeMode==="none")return!1;if(this.internalProps.columnResizeMode==="header"){if(!this.isHeader(t,e))return!1}else if(this.internalProps.columnResizeMode==="body"&&this.isHeader(t,e))return!1;const i=this.colWidthsLimit[t];return!(i&&i.min&&i.max)||i.max!==i.min}_canResizeRow(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t,e+1)||this.internalProps.rowResizeMode==="none")return!1;if(this.internalProps.rowResizeMode==="header"){if(!this.isHeader(t,e))return!1}else if(this.internalProps.rowResizeMode==="body"&&this.isHeader(t,e))return!1;return!0}_canDragHeaderPosition(t,e){var i;if(this.isHeader(t,e)&&(this.stateManager.isSelected(t,e)||((i=this.options.select)===null||i===void 0?void 0:i.headerSelectMode)==="body"&&y6t(t,e,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||zh(this,t,e))){if(this.internalProps.frozenColDragHeaderMode==="disabled"&&this.isFrozenColumn(t))return!1;if(this.stateManager.isSelected(t,e)){const o=this.stateManager.select.ranges[0];if(this.isColumnHeader(t,e)){if(o.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(t,e)||o.end.col!==this.colCount-1)return!1}const r=this.getHeaderDefine(t,e);if(!r)return!1;if(r.dragHeader===void 0){if(this.internalProps.dragHeaderMode==="all")return!0;if(this.internalProps.dragHeaderMode==="column"){if(this.isColumnHeader(t,e))return!0}else if(this.internalProps.dragHeaderMode==="row"&&this.isRowHeader(t,e))return!0;return!1}return r.dragHeader}return!1}getCellIcons(t,e){var i,r,o;let s;if(this.isHeader(t,e))s=this.internalProps.headerHelper.getIcons(t,e);else if(this.internalProps.layoutMap.isSeriesNumber(t,e)){(!this.internalProps.groupBy||!(!((i=this.getCellRawRecord(t,e))===null||i===void 0)&&i.vtableMerge))&&!((o=(r=this.internalProps.layoutMap.getSeriesNumberBody(t,e))===null||r===void 0?void 0:r.define)===null||o===void 0)&&o.dragOrder&&(s=this.internalProps.rowSeriesNumberHelper.getIcons(t,e));const a=this.getCellValue(t,e),l=this.getCellOriginValue(t,e),h=this.internalProps.context,u=this.internalProps.bodyHelper.getIcons(t,e,a,l,h);s?.length>0?s=s.concat(u):u?.length>0&&(s=u)}else{const a=this.getCellValue(t,e),l=this.getCellOriginValue(t,e),h=this.internalProps.context;s=this.internalProps.bodyHelper.getIcons(t,e,a,l,h)}return s}showDropDownMenu(t,e,i){let r="dropdown-menu";i&&(r=Array.isArray(i.content)?"dropdown-menu":"container"),this.internalProps.menu.renderMode==="html"&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(t,e,r,i))}showTooltip(t,e,i){this.internalProps.tooltip.renderMode==="html"&&this.internalProps.tooltipHandler._bindToCell(t,e,i)}getCellStyle(t,e){const i=this._getCellStyle(t,e),r=yu(i,this,t,e,ut).theme,{autoWrapText:o,lineClamp:s,textOverflow:a}=i;return{textAlign:r.text.textAlign,textBaseline:r.text.textBaseline,bgColor:La(r.group.fill)?ut("bgColor",i,t,e,this):r.group.fill,color:La(r.text.fill)?ut("color",i,t,e,this):r.text.fill,strokeColor:La(r.text.stroke)?ut("strokeColor",i,t,e,this):r.text.stroke,fontFamily:r.text.fontFamily,fontSize:r.text.fontSize,fontWeight:r.text.fontWeight,fontVariant:r.text.fontVariant,fontStyle:r.text.fontStyle,lineHeight:r.text.lineHeight,autoWrapText:o!=null&&o,lineClamp:s??"auto",textOverflow:a,borderColor:La(r.group.stroke)?ut("borderColor",i,t,e,this):r.group.stroke,borderLineWidth:r.group.lineWidth,borderLineDash:r.group.lineDash,underline:!!r.text.underline,underlineDash:r.text.underlineDash,underlineOffset:r.text.underlineOffset,lineThrough:!!r.text.lineThrough,padding:r._vtable.padding,underlineWidth:r.text.underline,lineThroughLineWidth:r.text.lineThrough,_strokeArrayWidth:r.group.strokeArrayWidth,_strokeArrayColor:r.group.strokeArrayColor,_linkColor:ut("linkColor",i,t,e,this)}}getAllBodyCells(t,e){const i=this.rowHeaderLevelCount,r=this.columnHeaderLevelCount,o=this.colCount-1,s=this.rowCount-1;return Array(Math.min(e??2e3,s-r+1,this.rowCount)).fill(0).map((a,l)=>Array(Math.min(t??2e3,o-i+1,this.colCount)).fill(0).map((h,u)=>this.getCellInfo(u+i,l+r)))}getAllCells(t,e){const o=this.colCount-1,s=this.rowCount-1;return Array(Math.min(e??2e3,s-0+1,this.rowCount)).fill(0).map((a,l)=>Array(Math.min(t??2e3,o-0+1,this.colCount)).fill(0).map((h,u)=>this.getCellInfo(u+0,l+0)))}getAllColumnHeaderCells(){const t=this.rowHeaderLevelCount,e=0,i=this.colCount-1,r=this.columnHeaderLevelCount-1;return Array(r-e+1).fill(0).map((o,s)=>Array(i-t+1).fill(0).map((a,l)=>this.getCellInfo(l+t,s+e)))}getAllRowHeaderCells(){const e=this.columnHeaderLevelCount,i=this.rowHeaderLevelCount-1,r=this.rowCount-1;return Array(r-e+1).fill(0).map((o,s)=>Array(i-0+1).fill(0).map((a,l)=>this.getCellInfo(l+0,s+e)))}getCopyValue(){var t,e,i;if(((e=(t=this.stateManager.select)===null||t===void 0?void 0:t.ranges)===null||e===void 0?void 0:e.length)>0){const r=this.stateManager.select.ranges;let o=Math.min(r[0].start.col,r[0].end.col),s=Math.max(r[0].start.col,r[0].end.col),a=Math.min(r[0].start.row,r[0].end.row),l=Math.max(r[0].start.row,r[0].end.row);r.forEach(g=>{o=Math.min(o,g.start.col,g.end.col),s=Math.max(s,g.start.col,g.end.col),a=Math.min(a,g.start.row,g.end.row),l=Math.max(l,g.start.row,g.end.row)});const h=g=>{let p=!1;return r.forEach(v=>{const m=Math.min(v.start.row,v.end.row),y=Math.max(v.start.row,v.end.row);m<=g&&y>=g&&(p=!0)}),p},u=g=>{let p=!1;return r.forEach(v=>{const m=Math.min(v.start.col,v.end.col),y=Math.max(v.start.col,v.end.col);m<=g&&y>=g&&(p=!0)}),p},d=(g,p)=>{let v;return r.forEach(m=>{const y=Math.min(m.start.row,m.end.row),b=Math.max(m.start.row,m.end.row),_=Math.min(m.start.col,m.end.col),w=Math.max(m.start.col,m.end.col);_<=g&&w>=g&&y<=p&&b>=p&&(v=m)}),v},c=(g,p,v)=>{const m=this.getCellRange(g,p);let y=m.start.col,b=m.start.row;if(v){const _=Math.min(v.start.col,v.end.col),w=Math.min(v.start.row,v.end.row);y=Math.max(_,m.start.col),b=Math.max(w,m.start.row)}return y!==g||b!==p?"":this.getCellValue(g,p)};let f="";for(let g=a;g<=l;g++)if(h(g)){for(let p=o;p<=s;p++)if(u(p)){const v=d(p,g);if(v){const m=c(p,g,v);if(!(typeof Promise<"u"&&m instanceof Promise)){const y=Y(m)?`${m}`:"";/^\[object .*\]$/.exec(y)||(f+=y)}(p<v.end.col||p<s)&&(f+="	")}else f+="	"}g<l&&(f+=`\r
`)}return!((i=this.options)===null||i===void 0)&&i.formatCopyValue&&(f=this.options.formatCopyValue(f)),f}return""}getSelectedCellInfos(){var t;if(!(!((t=this.stateManager.select)===null||t===void 0)&&t.ranges))return null;const e=this.stateManager.select.ranges;if(!e.length)return[];let i=Math.min(e[0].start.col,e[0].end.col),r=Math.max(e[0].start.col,e[0].end.col),o=Math.min(e[0].start.row,e[0].end.row),s=Math.max(e[0].start.row,e[0].end.row);e.forEach(d=>{i=Math.min(i,d.start.col,d.end.col),r=Math.max(r,d.start.col,d.end.col),o=Math.min(o,d.start.row,d.end.row),s=Math.max(s,d.start.row,d.end.row)});const a=d=>{let c=!1;return e.forEach(f=>{const g=Math.min(f.start.row,f.end.row),p=Math.max(f.start.row,f.end.row);g<=d&&p>=d&&(c=!0)}),c},l=d=>{let c=!1;return e.forEach(f=>{const g=Math.min(f.start.col,f.end.col),p=Math.max(f.start.col,f.end.col);g<=d&&p>=d&&(c=!0)}),c},h=(d,c)=>{let f;return e.forEach(g=>{const p=Math.min(g.start.row,g.end.row),v=Math.max(g.start.row,g.end.row),m=Math.min(g.start.col,g.end.col),y=Math.max(g.start.col,g.end.col);m<=d&&y>=d&&p<=c&&v>=c&&(f=g)}),f},u=[];for(let d=o;d<=s;d++)if(a(d)){const c=[];for(let f=i;f<=r;f++)if(l(f)&&h(f,d)){const g=this.getCellInfo(f,d);c.push(g)}u.push(c)}return u}getSelectedCellRanges(){const t=this.stateManager.select.ranges;return t.length?kc(t):[]}measureText(t,e){return LD.measureText(t,e)}measureTextBounds(t){return bJ(t)}getCustomRender(t,e){let i;if(this.getCellLocation(t,e)!=="body"){const r=this.getHeaderDefine(t,e);i=r?.headerCustomRender}else{const r=this.getBodyColumnDefine(t,e);i=r?.customRender||this.customRender}return i}getCustomLayout(t,e){let i;if(this.getCellLocation(t,e)!=="body"){const r=this.getHeaderDefine(t,e);i=r?.headerCustomLayout}else{const r=this.getBodyColumnDefine(t,e);i=r?.customLayout}return i}hasAutoImageColumn(){return this._hasAutoImageColumn===void 0&&(this._hasAutoImageColumn=rGt(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var t,e,i,r,o,s;const a=this.scenegraph.getCell((e=(t=this.stateManager.hover)===null||t===void 0?void 0:t.cellPos)===null||e===void 0?void 0:e.col,(r=(i=this.stateManager.hover)===null||i===void 0?void 0:i.cellPos)===null||r===void 0?void 0:r.row);return((s=(o=a?.getChildren())===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.type)==="chart"?a.getChildren()[0].activeChartInstance:null}cellIsInVisualView(t,e){var i,r,o,s;const a=this.getDrawRange(),l=this.getCellRelativeRect(t,e);if(t<this.frozenColCount&&e<this.frozenRowCount)return!0;let h,u,d,c;return this.frozenRowCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(u=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(d=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(c=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),!!(l.top>=a.top&&l.bottom<=a.bottom&&l.left>=a.left&&l.right<=a.right&&(this.isFrozenCell(t,e)||l.top>=((i=h?.bottom)!==null&&i!==void 0?i:l.top)&&l.left>=((r=u?.right)!==null&&r!==void 0?r:l.left)&&l.bottom<=((o=d?.top)!==null&&o!==void 0?o:l.bottom)&&l.right<=((s=c?.left)!==null&&s!==void 0?s:l.right)))}getCustomMergeValue(t,e){if(this.internalProps.customMergeCell){const i=this.getCustomMerge(t,e);if(i){const{text:r}=i;return r}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(t,e,i){var r,o,s,a;const l=this.cellIsInVisualView(t,e),{scrollTop:h,scrollLeft:u}=this;l||this.scrollToCell({col:t,row:e});const d=this.getCellRelativeRect(t,e);((o=(r=this.stateManager.select)===null||r===void 0?void 0:r.ranges)===null||o===void 0?void 0:o.length)>0&&zV(this.scenegraph);const{col:c,row:f}=this.stateManager.hover.cellPos;let g,p;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),i?.disableBackground){const y=this.scenegraph.getCell(t,e);g=y.attribute.fill,y.setAttribute("fill","transparent")}if(i?.disableBorder){const y=this.scenegraph.getCell(t,e);p=y.attribute.stroke,y.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let v=0;this.theme.cellBorderClipDirection==="bottom-right"&&(v=1);const m=this.scenegraph.stage.toCanvas(!1,new k0().set(d.left+this.tableX+1,d.top+this.tableY+1,d.right+this.tableX-v,d.bottom+this.tableY-v));return l||(this.setScrollTop(h),this.setScrollLeft(u)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),g&&this.scenegraph.getCell(t,e).setAttribute("fill",g),p&&this.scenegraph.getCell(t,e).setAttribute("stroke",p),((a=(s=this.stateManager.select)===null||s===void 0?void 0:s.ranges)===null||a===void 0?void 0:a.length)>0&&NV(this.scenegraph),this.stateManager.updateHoverPos(c,f),this.scenegraph.updateNextFrame(),m.toDataURL()}exportCellRangeImg(t){var e,i,r,o;const{scrollTop:s,scrollLeft:a}=this,l=Math.min(t.start.col,t.end.col),h=Math.min(t.start.row,t.end.row),u=Math.max(t.start.col,t.end.col),d=Math.max(t.start.row,t.end.row),c=this.cellIsInVisualView(l,h),f=this.cellIsInVisualView(u,d);c&&f||this.scrollToCell({col:l,row:h});const g=this.getCellRangeRelativeRect({start:{col:l,row:h},end:{col:u,row:d}});((i=(e=this.stateManager.select)===null||e===void 0?void 0:e.ranges)===null||i===void 0?void 0:i.length)>0&&zV(this.scenegraph);const{col:p,row:v}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();const m=this.scenegraph.stage.toCanvas(!1,new k0().set(g.left+this.tableX+1,g.top+this.tableY+1,g.right+this.tableX,g.bottom+this.tableY)).toDataURL();return c&&f||(this.setScrollTop(s),this.setScrollLeft(a)),((o=(r=this.stateManager.select)===null||r===void 0?void 0:r.ranges)===null||o===void 0?void 0:o.length)>0&&NV(this.scenegraph),this.stateManager.updateHoverPos(p,v),m}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(t="image/png"){if(this.options.mode!=="node")return;this.render();const e=this.scenegraph.stage;if(e){let i=this.tableX+this.getAllColsWidth(),r=this.tableY+this.getAllRowsHeight();return this.internalProps.legends&&this.internalProps.legends.forEach(o=>{o.orient==="right"?i=Math.max(i,o.legendComponent.globalAABBBounds.x2):o.orient==="bottom"&&(r=Math.max(r,o.legendComponent.globalAABBBounds.y2))}),this.internalProps.title&&(this.internalProps.title._titleOption.orient==="right"?i=Math.max(i,this.internalProps.title.getComponentGraphic().globalAABBBounds.x2):this.internalProps.title._titleOption.orient==="bottom"&&(r=Math.max(r,this.internalProps.title.getComponentGraphic().globalAABBBounds.y2))),i>=this.canvasWidth&&r>=this.canvasHeight?(e.render(),e.window.getImageBuffer(t)):this.scenegraph.stage.toCanvas(!1,new k0().set(0,0,Math.min(this.canvasWidth,i),Math.min(this.canvasHeight,r))).toBuffer(t)}return null}getBodyIndexByTableIndex(t,e){return{col:t-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:e-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(t,e){return{col:t+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:e+this.columnHeaderLevelCount}}onVChartEvent(t,e,i){this._chartEventMap[t]||(this._chartEventMap[t]=[]),typeof e=="function"?this._chartEventMap[t].push({callback:e}):this._chartEventMap[t].push({callback:i,query:e})}offVChartEvent(t,e){this._chartEventMap[t]&&(this._chartEventMap[t]=e?this._chartEventMap[t].filter(i=>i.callback!==e):[])}_bindChartEvent(t){if(t)for(const e in this._chartEventMap)(this._chartEventMap[e]||[]).forEach(i=>{i.query?t.on(e,i.query,i.callback):t.on(e,i.callback)})}changeRecordOrder(t,e){}hasCustomCellStyle(t){var e;return(e=this.customCellStylePlugin)===null||e===void 0?void 0:e.hasCustomCellStyle(t)}registerCustomCellStyle(t,e){var i;(i=this.customCellStylePlugin)===null||i===void 0||i.registerCustomCellStyle(t,e)}arrangeCustomCellStyle(t,e,i){var r;(r=this.customCellStylePlugin)===null||r===void 0||r.arrangeCustomCellStyle(t,e,i)}isSeriesNumber(t,e){return this.internalProps.layoutMap.isSeriesNumber(t,e)}isHasSeriesNumber(){var t;return((t=this.internalProps.layoutMap)===null||t===void 0?void 0:t.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var t,e;return(e=(t=this.internalProps.layoutMap)===null||t===void 0?void 0:t.leftRowSeriesNumberColumnCount)!==null&&e!==void 0?e:0}setMinMaxLimitWidth(t=!1){var e,i;const r=this.internalProps;for(let o=0;o<r.layoutMap.columnWidths.length;o++){if(this.internalProps._widthResizedColMap.has(o))continue;const{width:s,minWidth:a,maxWidth:l}=(i=(e=r.layoutMap.columnWidths)===null||e===void 0?void 0:e[o])!==null&&i!==void 0?i:{};t&&s&&(typeof s=="string"&&s!=="auto"||typeof s=="number"&&s>0)&&this._setColWidth(o,s),a&&(typeof a=="number"&&a>0||typeof a=="string")&&this.setMinColWidth(o,a),l&&(typeof l=="number"&&l>0||typeof l=="string")&&this.setMaxColWidth(o,l)}}setSortedIndexMap(t,e){var i;(i=this.dataSource)===null||i===void 0||i.setSortedIndexMap(t,e)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new U5t(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(t,e){this.scenegraph.component.showMoveCol(t,e,0),this.scenegraph.renderSceneGraph()}hideMoverLine(t,e){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(t,e){}scrollToRow(t,e){e?this.animationManager.scrollTo({row:t},e):this.scrollToCell({row:t})}scrollToCol(t,e){e?this.animationManager.scrollTo({col:t},e):this.scrollToCell({col:t})}scrollToCell(t,e){if(e)return void this.animationManager.scrollTo(t,e);const i=this.getDrawRange();if(Y(t.col)&&t.col>=this.frozenColCount){const r=this.getFrozenColsWidth(),o=this.getColsWidth(0,t.col-1);this.scrollLeft=Math.min(o-r,this.getAllColsWidth()-i.width)}if(Y(t.row)&&t.row>=this.frozenRowCount){const r=this.getFrozenRowsHeight(),o=this.getRowsHeight(0,t.row-1);this.scrollTop=Math.min(o-r,this.getAllRowsHeight()-i.height)}this.render()}checkHasColumnAutoWidth(){return G5t(this)}get containerFit(){return this._containerFit}set containerFit(t){var e,i;this._containerFit=typeof t=="boolean"?{width:t,height:t}:t&&typeof t=="object"?{width:(e=t.width)===null||e===void 0||e,height:(i=t.height)===null||i===void 0||i}:{width:!1,height:!1}}}const MGt={},RGt={};function BGt(){return Iy(RGt,MGt)}const SG={};function PGt(n){if(SG[n])return SG[n]}const Fy=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,kGt=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||Fy(n,"Boolean"),EGt=n=>n!=null,LGt=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||Fy(n,"String")},OGt=n=>Array.isArray?Array.isArray(n):Fy(n,"Array"),DGt=n=>Fy(n,"Date"),IGt=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||Fy(n,"Number")};function HGt(n){try{return n instanceof Element}catch{const e=["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"],i=Object.keys(n);return e.every(r=>i.includes(r))}}const Ip=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,FGt=(n,t=!1)=>t?typeof n=="boolean":n===!0||n===!1||Ip(n,"Boolean"),AG=n=>n==null,fE=n=>n!=null,zGt=n=>typeof n=="object"&&n!==null,NGt=function(n){if(!zGt(n)||!Ip(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t},WGt=(n,t=!1)=>{const e=typeof n;return t?e==="string":e==="string"||Ip(n,"String")},Nx=n=>Array.isArray?Array.isArray(n):Ip(n,"Array"),VGt=function(n){return n!==null&&typeof n!="function"&&Number.isFinite(n.length)},GGt=n=>Ip(n,"Date"),JJ=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||Ip(n,"Number")};function QJ(n,t,e){let i;if(!fE(n)||typeof n!="object"||t)return n;const r=Nx(n),o=n.length;i=r?new Array(o):typeof n=="object"?{}:FGt(n)||JJ(n)||WGt(n)?n:GGt(n)?new Date(+n):void 0;const s=r?void 0:Object.keys(Object(n));let a=-1;if(i)for(;++a<(s||n).length;){const l=s?s[a]:a,h=n[l];i[l]=QJ(h,t)}return i}function tQ(n,t,e=!1,i=!1){if(t){if(n===t)return;if(fE(t)&&typeof t=="object"){const r=Object(t),o=[];for(const l in r)o.push(l);let{length:s}=o,a=-1;for(;s--;){const l=o[++a];!fE(r[l])||typeof r[l]!="object"||i&&Nx(n[l])?eQ(n,l,r[l]):$Gt(n,t,l,e,i)}}}}function $Gt(n,t,e,i=!1,r=!1){const o=n[e],s=t[e];let a=t[e],l=!0;if(Nx(s)){if(i)a=[];else if(Nx(o))a=o;else if(VGt(o)){a=new Array(o.length);let h=-1;const u=o.length;for(;++h<u;)a[h]=o[h]}}else NGt(s)?(a=o??{},typeof o!="function"&&typeof o=="object"||(a={})):l=!1;l&&tQ(a,s,i,r),eQ(n,e,a)}function eQ(n,t,e){(e!==void 0&&!jGt(n[t],e)||e===void 0&&!(t in n))&&(n[t]=e)}function jGt(n,t){return n===t||Number.isNaN(n)&&Number.isNaN(t)}function UGt(n,...t){let e=-1;const i=t.length;for(;++e<i;)tQ(n,t[e],!0);return n}const XGt=typeof console<"u";function H_(n,t,e){const i=[t].concat([].slice.call(e))}var ks;(function(n){n[n.None=0]="None",n[n.Error=1]="Error",n[n.Warn=2]="Warn",n[n.Info=3]="Info",n[n.Debug=4]="Debug"})(ks||(ks={}));class wr{static getInstance(t,e){return wr._instance&&JJ(t)?wr._instance.level(t):wr._instance||(wr._instance=new wr(t,e)),wr._instance}static setInstance(t){return wr._instance=t}static setInstanceLevel(t){wr._instance?wr._instance.level(t):wr._instance=new wr(t)}static clearInstance(){wr._instance=null}constructor(t=ks.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){const e=this._onErrorHandler.findIndex(i=>i===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=ks.Info}canLogDebug(){return this._level>=ks.Debug}canLogError(){return this._level>=ks.Error}canLogWarn(){return this._level>=ks.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=ks.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):H_((e=this._method)!==null&&e!==void 0?e:"error","ERROR",t)),this}warn(...t){return this._level>=ks.Warn&&H_(this._method||"warn","WARN",t),this}info(...t){return this._level>=ks.Info&&H_(this._method||"log","INFO",t),this}debug(...t){return this._level>=ks.Debug&&H_(this._method||"log","DEBUG",t),this}}wr._instance=null;const YGt=(n,t)=>{var e,i;if(!t?.fields||n.length===0)return n;const r=t.fields,o=n[0],s={},a=[];for(const l in r)if(Object.prototype.hasOwnProperty.call(r,l)){const h=r[l];if(!h.type){let d=o;l in o||(d=(e=n.find(c=>l in c))!==null&&e!==void 0?e:o),h.type=typeof d[l]=="number"?"linear":"ordinal"}let u;if(typeof h.sortIndex=="number"&&(u={key:l,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:h.sortReverse===!0},a.push(u)),((i=h.domain)===null||i===void 0?void 0:i.length)>0)if(h.type==="ordinal"){h._domainCache={},s[l]=h;const d={};h.domain.forEach((c,f)=>{d[c]=f,h._domainCache[c]=f}),u&&(u.sortIndex=d,u.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(s[l]=h)}return Object.keys(s).length>0&&(n=n.filter(l=>{for(const h in s){const u=s[h];if(u.type==="ordinal"){if(!(l[h]in u._domainCache))return!1}else if(u.domain[0]>l[h]||u.domain[1]<l[h])return!1}return!0})),a.sort((l,h)=>l.index-h.index),n.sort((l,h)=>KGt(l,h,a)),n};function KGt(n,t,e){for(let i=0;i<e.length;i++){const r=e[i];let o=0;if(r.type==="ordinal"?(r.sortIndex[t[r.key]]===void 0&&(r.sortIndex[t[r.key]]=r.sortIndexCount++),r.sortIndex[n[r.key]]===void 0&&(r.sortIndex[n[r.key]]=r.sortIndexCount++),o=r.sortIndex[n[r.key]]-r.sortIndex[t[r.key]]):r.type==="linear"&&(o=n[r.key]-t[r.key]),r.sortReverse&&(o=-o),o!==0)return o}return 0}let m2=0;const qGt=1e8;function iQ(n="dataset"){return m2>qGt&&(m2=0),n+"_"+m2++}class ZGt{constructor(t){var e;let i;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new Bc,i=t?.name?t.name:iQ("dataset"),this.name=i,this._logger=(e=t?.logger)!==null&&e!==void 0?e:wr.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var i;this.dataViewMap[t]&&((i=this._logger)===null||i===void 0||i.error(`Error: dataView ${t} `)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var i;this.parserMap[t]&&((i=this._logger)===null||i===void 0||i.warn(`Warn: transform ${t} `)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var i;this.transformMap[t]&&((i=this._logger)===null||i===void 0||i.warn(`Warn: transform ${t} `)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,i){this._callMap||(this._callMap=new Map);let r=this._callMap.get(i);r||(r=()=>{t.some(o=>o.isRunning)||i()}),t.forEach(o=>{o.target.addListener(e,r)}),this._callMap.set(i,r)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,i){if(this._callMap){const r=this._callMap.get(i);r&&t.forEach(o=>{o.target.removeListener(e,r)}),this._callMap.delete(i)}}multipleDataViewUpdateInParse(t){t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.markRunning()}),t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.parseNewData(e.data,e.options)})}multipleDataViewUpdateInRawData(t){t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.markRunning()}),t.forEach(e=>{var i;return(i=this.getDataView(e.name))===null||i===void 0?void 0:i.updateRawData(e.data,e.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}const y2="_data-view-diff-rank";let nQ=class rQ{constructor(t,e){let i;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new Bc,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(r={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(o=>{this.executeTransform(o,{pushHistory:r.pushHistory,emitMessage:!1}),this.isLastTransform(o)&&this.diffLastData()}),this.isRunning=!1,r.emitMessage!==!1&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},i=e?.name?e.name:iQ("dataview"),this.name=i,e?.history&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(e?.fields)}parse(t,e,i=!1){var r;this.isRunning=!0,i&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);const o=this.cloneParseData(t,e);if(e?.type){const s=((r=this.dataSet.getParser(e.type))!==null&&r!==void 0?r:this.dataSet.getParser("bytejson"))(o,e.options,this);this.rawData=o,this.parserData=s,this.history&&this.historyData.push(o,s),this.latestData=s}else this.parserData=o,this.rawData=o,this.history&&this.historyData.push(o),this.latestData=o;return this.isRunning=!1,i&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let i=!0;if(t.type==="fields"){this._fields=t.options.fields;const r=this.transformsArr.findIndex(o=>o.type===t.type);r>=0&&(i=!1,this.transformsArr[r].options.fields=this._fields)}if(i&&this.transformsArr.push(t),e){const r=this.isLastTransform(t);this.executeTransform(t),r&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(t){return this.transformsArr[this.transformsArr.length-1]===t}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var i,r;return((i=t.level)!==null&&i!==void 0?i:0)-((r=e.level)!==null&&r!==void 0?r:0)})}executeTransform(t,e={pushHistory:!0,emitMessage:!0}){const{pushHistory:i,emitMessage:r}=e,o=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&i!==!1&&this.historyData.push(o),this.latestData=o,r!==!1&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var t;if(!this._diffData||!this.latestData.forEach||!(!((t=this._diffKeys)===null||t===void 0)&&t.length))return;const e=this._diffRank+1;if(this._diffRank===0)this.latestData.forEach(i=>{i[y2]=e,this._diffMap.set(this._diffKeys.reduce((r,o)=>r+i[o],""),i)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let i;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(r=>{r[y2]=e,i=this._diffKeys.reduce((o,s)=>o+r[s],""),this._diffMap.get(i)?this.latestDataAUD.update.push(r):this.latestDataAUD.add.push(r),this._diffMap.set(i,r)}),this._diffMap.forEach((r,o)=>{r[y2]<e&&(this.latestDataAUD.del.push(r),this._diffMap.delete(o))})}this._diffRank=e}cloneParseData(t,e){let i=!1;return t instanceof rQ||e?.clone!==!0||(i=!0),i?QJ(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){const i=this.cloneParseData(t,e);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:((t=this.parseOption)===null||t===void 0?void 0:t.type)==="dataview"&&this.rawData.length===1&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?UGt({},this._fields,t):t;const i=this.transformsArr.find(r=>r.type==="fields");!AG(this._fields)&&AG(i)?(this.dataSet.registerTransform("fields",YGt),this.transform({type:"fields",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}};function JGt(n){return n instanceof nQ}function _f(n,t=["data"]){const e=n;let i;if(!EGt(e)||typeof e!="object"||JGt(e)||HGt(e))return e;const r=OGt(e),o=e.length;i=r?new Array(o):typeof e=="object"?{}:kGt(e)||IGt(e)||LGt(e)?e:DGt(e)?new Date(+e):void 0;const s=r?void 0:Object.keys(Object(e));let a=-1;if(i)for(;++a<(s||e).length;){const l=s?s[a]:a,h=e[l];t?.includes(l.toString())?i[l]=h:i[l]=_f(h,t)}return i}function oQ(n){var t,e;const i=Object.assign({},n);return Jn(n.style)||(i.textStyle=Yi(n.style)),Jn(n.textStyle)||Ue(i.textStyle,Yi(n.textStyle)),!((t=n.shape)===null||t===void 0)&&t.style&&Yi(i.shape.style),!((e=n.background)===null||e===void 0)&&e.style&&Yi(i.background.style),i}function Yi(n){return Jn(n)||n.angle&&(n.angle=K1(n.angle)),n}function zs(n={}){return Jn(n.style)||(n.style=Yi(n.style)),Jn(n.state)||Object.keys(n.state).forEach(t=>{Jn(n.state[t])||(n.state[t]=Yi(n.state[t]))}),n}function Yu(n){return Jn(n)?null:(Object.keys(n).forEach(t=>{Jn(n[t])||(n[t]=Yi(n[t]))}),n)}function QGt(n){return zs(n),zs(n.startSymbol),zs(n.endSymbol),n}const t8t={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},hg="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",ug=14,Jv={LABEL_FONT_SIZE:14,AXIS_TICK_SIZE:4},Wx={domainLine:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:Jv.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:Jv.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:Jv.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:Jv.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function e8t(n){var t,e;return!((e=(t=n?.colorScheme)===null||t===void 0?void 0:t.default)===null||e===void 0)&&e.palette?Ue({},Wx,{tick:{style:{stroke:n.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:n.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:n.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:n.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):Wx}function TG(n){var t,e,i,r,o,s,a,l,h,u,d,c,f;const g=Ue({},n);let p,v=(e=(t=g.title)===null||t===void 0?void 0:t.angle)!==null&&e!==void 0?e:0;g.orient!=="left"&&g.orient!=="right"||!((i=g.title)===null||i===void 0)&&i.autoRotate&&Pe(g.title.angle)&&(v=g.orient==="left"?-90:90,p=t8t[g.orient]);const m=VIt(g.label,["style","formatMethod","state"]);return{orient:g.orient,select:g.select,hover:g.hover,line:QGt(g.domainLine),label:Object.assign({style:Yi(g.label.style),formatMethod:g.label.formatMethod?(y,b,_)=>g.label.formatMethod(b.rawValue,b):null,state:Yu(g.label.state)},m),tick:{visible:g.tick.visible,length:g.tick.tickSize,inside:g.tick.inside,alignWithLabel:g.tick.alignWithLabel,style:Yi(g.tick.style),state:Yu(g.tick.state),dataFilter:g.tick.dataFilter},subTick:{visible:g.subTick.visible,length:g.subTick.tickSize,inside:g.subTick.inside,count:g.subTick.tickCount,style:Yi(g.subTick.style),state:Yu(g.subTick.state)},grid:{type:"line",visible:g.grid.visible,alternateColor:g.grid.alternateColor,alignWithLabel:g.grid.alignWithLabel,style:Yi(g.grid.style)},subGrid:{type:"line",visible:g.subGrid.visible,alternateColor:g.subGrid.alternateColor,style:Yi(g.subGrid.style)},title:{visible:g.title.visible,position:g.title.position,space:g.title.space,autoRotate:!1,angle:v?K1(v):null,textStyle:Ue({},p,Yi(g.title.style)),padding:g.title.padding,shape:{visible:(r=g.title.shape)===null||r===void 0?void 0:r.visible,space:(o=g.title.shape)===null||o===void 0?void 0:o.space,style:Yi((s=g.title.shape)===null||s===void 0?void 0:s.style)},background:{visible:(a=g.title.background)===null||a===void 0?void 0:a.visible,style:Yi((l=g.title.background)===null||l===void 0?void 0:l.style)},state:{text:Yu(g.title.state),shape:Yu((h=g.title.shape)===null||h===void 0?void 0:h.state),background:Yu((u=g.title.background)===null||u===void 0?void 0:u.state)}},panel:{visible:(d=g.background)===null||d===void 0?void 0:d.visible,style:Yi((c=g.background)===null||c===void 0?void 0:c.style),state:Yu((f=g.background)===null||f===void 0?void 0:f.state)}}}function i8t(n,t,e){var i;const r=e.getRawChartSpec(n,t);if(r?.series){const o={};return!((i=r.data)===null||i===void 0)&&i.id&&(o[r.data.id]=void 0),r?.series.forEach(s=>{var a,l,h,u,d,c,f,g,p,v,m;if(!(!((a=s.data)===null||a===void 0)&&a.fromDataId))if(!((l=s.data)===null||l===void 0)&&l.transforms)o[(m=(p=(g=s.data)===null||g===void 0?void 0:g.id)!==null&&p!==void 0?p:(v=r.data)===null||v===void 0?void 0:v.id)!==null&&m!==void 0?m:"data"]=void 0;else{const y=s.direction==="horizontal"?s.xField:s.yField;o[(c=(u=(h=s.data)===null||h===void 0?void 0:h.id)!==null&&u!==void 0?u:(d=r.data)===null||d===void 0?void 0:d.id)!==null&&c!==void 0?c:"data"]=!((f=s.data)===null||f===void 0)&&f.id?y:void 0}}),o}return r.data.id}function n8t(n){let t=!1;for(let e=0;e<n.columnObjects.length;e++)if(n.columnObjects[e].chartSpec){t=!0;break}return t}function r8t(n,t,e){var i,r,o;if(n===-1||t===-1)return{start:{col:n,row:t},end:{col:n,row:t}};if(e._cellRangeMap.has(`$${n}$${t}`))return e._cellRangeMap.get(`$${n}$${t}`);let s={start:{col:n,row:t},end:{col:n,row:t}};if(e.transpose)s=s8t(n,t,e);else if(e.headerLevelCount<=t){if(e.headerLevelCount<=t&&(!((r=(i=e.columnObjects[n-e.leftRowSeriesNumberColumnCount])===null||i===void 0?void 0:i.define)===null||r===void 0)&&r.mergeCell)){const a=e._table.getCellValue(n,t);for(let l=t-1;l>=e.headerLevelCount;l--){const h=e._table.getCellValue(n,l);if(typeof e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell=="boolean"){if(a!==h)break}else if(!e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell(a,h,{source:{col:n,row:t},target:{col:n,row:l},table:e._table}))break;s.start.row=l}for(let l=t+1;l<e.rowCount;l++){const h=e._table.getCellValue(n,l);if(typeof e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell=="boolean"){if(a!==h)break}else if(!e.columnObjects[n-e.leftRowSeriesNumberColumnCount].define.mergeCell(a,h,{source:{col:n,row:t},target:{col:n,row:l},table:e._table}))break;s.end.row=l}}o8t(n,t,s,e)}else{const a=e.getCellId(n,t);for(let l=n-1;l>=0&&a===e.getCellId(l,t);l--)s.start.col=l;for(let l=n+1;l<((o=e.colCount)!==null&&o!==void 0?o:0)&&a===e.getCellId(l,t);l++)s.end.col=l;for(let l=t-1;l>=0&&a===e.getCellId(n,l);l--)s.start.row=l;for(let l=t+1;l<e.headerLevelCount&&a===e.getCellId(n,l);l++)s.end.row=l}return e._cellRangeMap.set(`$${n}$${t}`,s),s}function o8t(n,t,e,i){if(i.rowHierarchyType!=="tree")return;const r=i._table.getCellRawRecord(n,t);i._table.internalProps.groupTitleCheckbox&&i._table.internalProps.rowSeriesNumber?r?.vtableMerge&&n>=i.leftRowSeriesNumberColumnCount&&(e.start.col=i.rowHeaderLevelCount+i.leftRowSeriesNumberColumnCount,e.end.col=i.colCount-1,e.start.row=e.end.row=t):r?.vtableMerge&&(e.start.col=i.rowHeaderLevelCount,e.end.col=i.colCount-1,e.start.row=e.end.row=t)}function s8t(n,t,e){var i,r,o,s;const a={start:{col:n,row:t},end:{col:n,row:t}};if(e.headerLevelCount+e.leftRowSeriesNumberColumnCount<=n||n===-1&&t===-1){if(e.headerLevelCount+e.leftRowSeriesNumberColumnCount<=n&&(!((r=(i=e.columnObjects[t])===null||i===void 0?void 0:i.define)===null||r===void 0)&&r.mergeCell)){const h=e._table.getCellValue(n,t);for(let u=n-1;u>=e.headerLevelCount+e.leftRowSeriesNumberColumnCount;u--){const d=e._table.getCellValue(u,t);if(typeof e.columnObjects[t].define.mergeCell=="boolean"){if(h!==d)break}else if(!e.columnObjects[t].define.mergeCell(h,d,{source:{col:n,row:t},target:{col:u,row:t},table:e._table}))break;a.start.col=u}for(let u=n+1;u<((o=e.colCount)!==null&&o!==void 0?o:0);u++){const d=e._table.getCellValue(u,t);if(typeof e.columnObjects[t].define.mergeCell=="boolean"){if(h!==d)break}else if(!e.columnObjects[t].define.mergeCell(h,d,{source:{col:n,row:t},target:{col:u,row:t},table:e._table}))break;a.end.col=u}}return a}const l=e.getCellId(n,t);for(let h=t-1;h>=0&&l===e.getCellId(n,h);h--)a.start.row=h;for(let h=t+1;h<((s=e.rowCount)!==null&&s!==void 0?s:0)&&l===e.getCellId(n,h);h++)a.end.row=h;for(let h=n-1;h>=0&&l===e.getCellId(h,t);h--)a.start.col=h;for(let h=n+1;h<e.headerLevelCount+e.leftRowSeriesNumberColumnCount&&l===e.getCellId(h,t);h++)a.end.col=h;return a}class a8t{constructor(t,e,i,r){var o,s;this.seqId=0,this._columnMaxDepth=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=i,this._table=t,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this._columnMaxDepth=this._calculateMaxDepth(e),this.hierarchyIndent=r??20,this.hierarchyTextStartAlignment=t.options.hierarchyTextStartAlignment,this.columnHierarchyType=t.options.headerHierarchyType,this.columnExpandLevel=(o=t.options.headerExpandLevel)!==null&&o!==void 0?o:1,this.columnTree=new QVt(e,{seqId:0},(s=this.columnHierarchyType)!==null&&s!==void 0?s:null,this.columnHierarchyType==="grid-tree"?this.columnExpandLevel:void 0),this._headerObjectsIncludeHided=this._addHeaders(0,e,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(a=>a.define.hide!==!0),this._headerObjectMap=this._headerObjects.reduce((a,l)=>(a[l.id]=l,a),{}),this.rowHierarchyType=nGt(this)?"tree":"grid",this._hasAggregation=tGt(this),this._hasAggregationOnBottomCount=iGt(this),this._hasAggregationOnTopCount=eGt(this),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber)}handleRowSeriesNumber(t){var e,i,r;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map((o,s)=>{var a,l;return{id:this.seqId++,title:o.title,define:Ue({field:"_vtable_rowSeries_number_"+s},o),cellType:(a=o.cellType)!==null&&a!==void 0?a:"text",headerType:o.cellType==="checkbox"?"checkbox":"text",style:o.style,width:o.width,format:o.format,field:(l=o.field)!==null&&l!==void 0?l:"_vtable_rowSeries_number_"+s,icon:o.icon,headerIcon:o.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:t.title,define:Ue({field:"_vtable_rowSeries_number"},t),cellType:(e=t.cellType)!==null&&e!==void 0?e:"text",headerType:(i=t.headerType)!==null&&i!==void 0?i:t.cellType==="checkbox"?"checkbox":"text",style:t.style,width:t.width,format:t.format,field:(r=t.field)!==null&&r!==void 0?r:"_vtable_rowSeries_number",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(t){this._transpose=t}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}isSeriesNumberInHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}if(this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(t,e){return!!(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)||this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount))}isSeriesNumber(t,e){return!!(Y(t)&&Y(e)&&(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(e<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount){if(this.transpose)return;if(e<this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}getSeriesNumberBody(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return this.leftRowSeriesNumberColumn[t];if(e>=this.headerLevelCount)return this.leftRowSeriesNumberColumn[t]}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)];if(e>=this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}isHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&e>=0&&e<this.headerLevelCount}isAggregation(t,e){if(this.hasAggregation){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}}return!1}isTopAggregation(t,e){if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isBottomAggregation(t,e){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(t,e){return this.getColumnDefine(t,e).vtable_aggregator}getAggregatorsByCellRange(t,e,i,r){let o=[];if(!this.transpose){for(let s=t;s<=i;s++){const a=this.getColumnDefine(s,e);a.vtable_aggregator&&(o=o.concat(Array.isArray(a.vtable_aggregator)?a.vtable_aggregator:[a.vtable_aggregator]))}return o}for(let s=e;s<=r;s++){const a=this.getColumnDefine(t,s);a.vtable_aggregator&&(o=o.concat(Array.isArray(a.vtable_aggregator)?a.vtable_aggregator:[a.vtable_aggregator]))}return[]}getAggregatorOnTop(t,e){const i=this.getColumnDefine(t,e),r=i.vtable_aggregator,o=i.aggregation;if(Array.isArray(o)){const s=o.reduce((a,l,h)=>(l.showOnTop&&a.push(h),a),[]).map(a=>r[a]);return this.transpose?s[t-this.rowHeaderLevelCount]:s[e-this.columnHeaderLevelCount]}return this.transpose&&t-this.rowHeaderLevelCount==0?o?.showOnTop?r:null:this.transpose||e-this.columnHeaderLevelCount!=0?null:o?.showOnTop?r:null}getAggregatorOnBottom(t,e){const i=this.getColumnDefine(t,e),r=i.vtable_aggregator,o=i.aggregation;if(Array.isArray(o)){const s=o.reduce((a,l,h)=>(l.showOnTop||a.push(h),a),[]).map(a=>r[a]);return this.transpose?s[t-(this.colCount-this.hasAggregationOnBottomCount)]:s[e-(this.rowCount-this.hasAggregationOnBottomCount)]}return this.transpose&&t-(this.colCount-this.hasAggregationOnBottomCount)==0?o?.showOnTop?null:r:this.transpose||e-(this.rowCount-this.hasAggregationOnBottomCount)!=0||o?.showOnTop?null:r}getAggregatorCellAddress(t,e,i,r){const o=[],s=this.hasAggregationOnTopCount,a=this.hasAggregationOnBottomCount;if(this.transpose){for(let l=e;l<=r;l++)if(this.getColumnDefine(t,l).vtable_aggregator){for(let h=0;h<s;h++)o.push({col:this.headerLevelCount+h,row:l});for(let h=0;h<a;h++)o.push({col:this.rowCount-a+h,row:l})}}else for(let l=t;l<=i;l++)if(this.getColumnDefine(l,e).vtable_aggregator){for(let h=0;h<s;h++)o.push({col:l,row:this.headerLevelCount+h});for(let h=0;h<a;h++)o.push({col:l,row:this.rowCount-a+h})}return o}getCellLocation(t,e){return this.isHeader(t,e)?this.transpose?"rowHeader":"columnHeader":"body"}isRowHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(t,e){return!this.transpose&&e>=0&&e<=this.headerLevelCount-1&&t>=this.leftRowSeriesNumberColumnCount&&t<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(t,e){if(Y(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if(Y(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if(Y(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if(Y(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(t,e){return!1}getColumnHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:((t=this.rowCount)!==null&&t!==void 0?t:0)-1}}:{start:{col:0,row:0},end:{col:((e=this.colCount)!==null&&e!==void 0?e:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:((t=this.rowCount)!==null&&t!==void 0?t:0)-1}}:{start:{col:0,row:0},end:{col:((e=this.colCount)!==null&&e!==void 0?e:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var t,e,i,r;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:((t=this.colCount)!==null&&t!==void 0?t:0)-1,row:((e=this.rowCount)!==null&&e!==void 0?e:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:((i=this.colCount)!==null&&i!==void 0?i:0)-1,row:((r=this.rowCount)!==null&&r!==void 0?r:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(t){this._recordsCount=t}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){if(this.leftRowSeriesNumberColumnCount){const t=this.leftRowSeriesNumberColumn.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}));return t.push(...this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))),t}return this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))}getColumnWidthDefined(t){var e;if(t>=0){if(t<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[t];if(this.transpose){let i,r,o=0;if(t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let s;return this.columnObjects.forEach((a,l)=>{typeof a.width=="number"?o=Math.max(a.width,o):a.width==="auto"&&(s=!0),typeof a.minWidth=="number"&&(r=Math.max(a.minWidth,r)),typeof a.maxWidth=="number"&&(i=Math.max(a.maxWidth,i))}),o=o>0?o:s?"auto":void 0,{width:o,minWidth:r,maxWidth:i}}if(this.isRowHeader(t,0)){const s=Array.isArray(this._table.defaultHeaderColWidth)?(e=this._table.defaultHeaderColWidth[t])!==null&&e!==void 0?e:this._table.defaultColWidth:this._table.defaultHeaderColWidth;return s==="auto"?{width:"auto"}:{width:s}}}return this._columns[t-this.leftRowSeriesNumberColumnCount]}}getCellId(t,e){var i,r,o,s;return this.transpose?t>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?(i=this._columns[e])===null||i===void 0?void 0:i.id:this.isSeriesNumber(t,e)?e+"_series_number":(r=this._headerCellIds[t-this.leftRowSeriesNumberColumnCount])===null||r===void 0?void 0:r[e]:this.isSeriesNumber(t,e)?this.rowSeriesNumberColumn[t].id:this.headerLevelCount<=e?(o=this._columns[t-this.leftRowSeriesNumberColumnCount])===null||o===void 0?void 0:o.id:(s=this._headerCellIds[e])===null||s===void 0?void 0:s[t-this.leftRowSeriesNumberColumnCount]}getHeader(t,e){if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);const i=this.getCellId(t,e);return this._headerObjectMap[i]}getHeaderField(t,e){var i,r,o;if(this.isSeriesNumberInHeader(t,e))return(i=this.getSeriesNumberHeader(t,e))===null||i===void 0?void 0:i.field;if(this.isSeriesNumberInBody(t,e))return(r=this.getSeriesNumberBody(t,e))===null||r===void 0?void 0:r.field;const s=this.getCellId(t,e);return((o=this._headerObjectMap[s])===null||o===void 0?void 0:o.field)||(this.transpose?this._columns[e]&&this._columns[e].field:this._columns[t-this.leftRowSeriesNumberColumnCount]&&this._columns[t-this.leftRowSeriesNumberColumnCount].field)}getHeaderCellAdressById(t){for(let e=0;e<this._headerCellIds.length;e++){const i=this._headerCellIds[e];for(let r=0;r<i.length;r++)if(i[r]===t)return this.transpose?{col:e,row:r}:{col:r+this.leftRowSeriesNumberColumnCount,row:e}}}getHeaderCellAddressByField(t){const e=this.headerObjects.find(i=>i&&i.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){return this.isSeriesNumber(t,e)?this.getSeriesNumberBody(t,e):this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(t){var e,i;if(this.transpose){for(let r=0;r<((e=this.rowCount)!==null&&e!==void 0?e:0);r++)if(t===this._columns[r].id)return{start:{col:0,row:r},end:{col:0,row:r}}}else for(let r=this.leftRowSeriesNumberColumnCount;r<((i=this.colCount)!==null&&i!==void 0?i:0);r++)if(t===this._columns[r-this.leftRowSeriesNumberColumnCount].id)return{start:{col:r,row:0},end:{col:r,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(t,e){return r8t(t,e,this)}isCellRangeEqual(t,e,i,r){const o=this.getCellRange(t,e),s=this.getCellRange(i,r);return o.start.col===s.start.col&&o.end.col===s.end.col&&o.start.row===s.start.row&&o.end.row===s.end.row}getRecordShowIndexByCell(t,e){const i=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?t<i?-1:t-i:e<i?-1:e-i}getRecordStartRowByRecordIndex(t){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+t}_calculateMaxDepth(t,e=0){let i=e;return t.forEach(r=>{if(r.columns&&r.columns.length>0){const o=this._calculateMaxDepth(r.columns,e+1);o>i&&(i=o)}}),i}_addHeaders(t,e,i,r,o){const s=[],a=this._newRow(t,r);return e.forEach(l=>{var h,u,d,c;const f=this._columns.length,g=this.seqId++,p={id:g,title:(h=l.title)!==null&&h!==void 0?h:l.caption,headerIcon:l.headerIcon,field:l.field,style:l.headerStyle,headerType:(u=l.headerType)!==null&&u!==void 0?u:"text",dropDownMenu:l.dropDownMenu,define:l,hierarchyState:l.hierarchyState,columnWidthComputeMode:l.columnWidthComputeMode};s[g]=p;let v=t;if(l.levelSpan){v=Math.min(t+l.levelSpan-1,this._columnMaxDepth-1);for(let y=t;y<=v;y++)this._headerCellIds[y]||(this._headerCellIds[y]=[]),this._headerCellIds[y][f]===void 0&&(this._headerCellIds[y][f]=g)}if(o)for(let y=v-1;y>=0;y--)this._headerCellIds[y]&&this._headerCellIds[y][f]===void 0&&i[v-o]!==void 0&&(this._headerCellIds[y][f]=i[v-o]);else for(let y=v-1;y>=0;y--)this._headerCellIds[y]&&this._headerCellIds[y][f]===void 0&&i[y]!==void 0&&(this._headerCellIds[y][f]=i[y]);r?this._headerCellIds[t-1]&&this._headerCellIds[t-1][f]!==void 0&&(a[f]=this._headerCellIds[t-1][f]):a[f]=g;const m=!l.hierarchyState||l.hierarchyState===Lt.expand;if(l.columns&&m)!(l.columns.every(y=>y.hide)||l.hide)&&this._addHeaders(v+1,l.columns,[...i,g],l.hideColumnsSubHeader||r,l.levelSpan).forEach(y=>s.push(y));else{const y={id:this.seqId++,field:l.field,fieldFormat:l.fieldFormat,width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth,icon:l.icon,cellType:(c=(d=l.cellType)!==null&&d!==void 0?d:l.columnType)!==null&&c!==void 0?c:"text",chartModule:"chartModule"in l?l.chartModule:null,chartSpec:"chartSpec"in l?l.chartSpec:null,sparklineSpec:"sparklineSpec"in l?l.sparklineSpec:SFt,style:l.style,define:l,columnWidthComputeMode:l.columnWidthComputeMode,disableColumnResize:l?.disableColumnResize,aggregation:l.aggregation,isChildNode:t>=1};if(this._columnsIncludeHided.push(y),l.hide!==!0){this._columns.push(y);for(let b=t+1;b<this._headerCellIds.length;b++)this._headerCellIds[b][f]=g}}}),s}_newRow(t,e=!1){if(this._headerCellIds[t]){const o=this._headerCellIds[t-1];if(o.length>this._headerCellIds[t].length)for(let s=this._headerCellIds[t].length;s<o.length;s++)this._headerCellIds[t][s]=o[s];return this._headerCellIds[t]}if(e)return[];const i=this._headerCellIds[t]=[];if(!this._columns.length)return i;const r=this._headerCellIds[t-1];for(let o=0;o<r.length;o++)i[o]=r[o];return i}getCellHeaderPaths(t,e){if(this.isSeriesNumber(t,e))return;let i=[],r=[];return this.transpose?r=[{field:this._columns[e].field}]:i=[{field:this._columns[t-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:i,rowHeaderPaths:r,cellLocation:this.getCellLocation(t,e)}}getParentCellId(t,e){if(e!==0){if(this.isColumnHeader(t,e))return this.getCellId(t,e-1);if(this.isRowHeader(t,e))return this.isSeriesNumberInBody(t-1,e)?void 0:this.getCellId(t-1,e)}}canMoveHeaderPosition(t,e){if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row))return!1;if(!this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)){const r=this.getRecordShowIndexByCell(0,t.row),o=this.getRecordShowIndexByCell(0,e.row);return this._table.dataSource.canChangeOrder(r,o)}if(this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)&&(this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode&&this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode?(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(t.col=t.col+this.leftRowSeriesNumberColumnCount,e.col=e.col+this.leftRowSeriesNumberColumnCount)),t.col<0||t.row<0||e.col<0||e.row<0||this._table.internalProps.frozenColDragHeaderMode==="disabled"&&this._table.isFrozenColumn(e.col))return!1;const i=this.getCellRange(t.col,t.row);return this.isColumnHeader(t.col,t.row)?this.getParentCellId(t.col,i.start.row)===this.getParentCellId(e.col,i.start.row):this.isRowHeader(t.col,t.row)?this.getParentCellId(i.start.col,t.row)===this.getParentCellId(i.start.col,e.row):!1}moveHeaderPosition(t,e){var i,r;if((!(!((i=this._table.options.dragOrder)===null||i===void 0)&&i.validateDragOrderOnEnd)||!((r=this._table.options.dragOrder)===null||r===void 0)&&r.validateDragOrderOnEnd(t,e))&&this.canMoveHeaderPosition(t,e)){let o=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){const s=o.end.col-o.start.col+1;let a;const l=this.getCellRange(e.col,o.start.row);if(a=e.col>=t.col?l.end.col-s+1:l.start.col,a===o.start.col)return null;for(let u=0;u<this._headerCellIds.length;u++){const d=this._headerCellIds[u].splice(o.start.col-this.leftRowSeriesNumberColumnCount,s);d.unshift(a-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[u],d)}const h=this._columns.splice(o.start.col-this.leftRowSeriesNumberColumnCount,s);return h.unshift(a-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,h),this.columnTree.movePosition(o.start.row,o.start.col-this.leftRowSeriesNumberColumnCount,a-this.leftRowSeriesNumberColumnCount),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:o.start.col,targetIndex:a,sourceSize:s,targetSize:l.end.col-l.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)||this.isSeriesNumberInBody(t.col,t.row)&&this.transpose){this.isSeriesNumberInBody(t.col,t.row)&&(o=this.getCellRange(t.col+this.leftRowSeriesNumberColumnCount,t.row));const s=o.end.row-o.start.row+1;let a;const l=this.getCellRange(o.start.col,e.row);if(a=e.row>=t.row?l.end.row-s+1:l.start.row,a===o.start.row)return null;for(let u=0;u<this._headerCellIds.length;u++){const d=this._headerCellIds[u].splice(o.start.row,s);d.unshift(a,0),Array.prototype.splice.apply(this._headerCellIds[u],d)}const h=this._columns.splice(o.start.row,s);return h.unshift(a,0),Array.prototype.splice.apply(this._columns,h),this.columnTree.movePosition(o.start.col-this.leftRowSeriesNumberColumnCount,o.start.row,a+(e.row>t.row?o.end.row-o.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:o.start.row,targetIndex:a,sourceSize:s,targetSize:l.end.row-l.start.row+1,moveType:"row"}}if(this.isSeriesNumberInBody(t.col,t.row))return{sourceIndex:t.row,targetIndex:e.row,sourceSize:1,targetSize:1,moveType:"row"}}return null}toggleHierarchyState(t){return{addCellPositions:t.add.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e})),removeCellPositions:t.remove.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e}))}}setChartInstance(t,e,i){const r=this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount];typeof r.chartSpec!="function"&&(r.chartInstance=i)}getChartInstance(t,e){return(this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return n8t(this)}getAxisConfigInPivotChart(t,e){}isEmpty(t,e){return!1}isAxisCell(t,e){return!1}getChartAxes(t,e){return[]}isShareChartSpec(t,e){const i=this.getBody(t,e);return typeof i?.chartSpec!="function"}isNoChartDataRenderNothing(t,e){const i=this.getBody(t,e);return(i?.define).noDataRenderNothing}getChartSpec(t,e){return this.getRawChartSpec(t,e)}getRawChartSpec(t,e){const i=this.getBody(t,e),r=i?.chartSpec;return typeof r=="function"?r({col:t,row:e,dataValue:this._table.getCellOriginValue(t,e)||"",value:this._table.getCellValue(t,e)||"",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(t,e)),table:this._table}):r}getChartDataId(t,e){return i8t(t,e,this)}release(){const t=this._table._getActiveChartInstance();t?.release(),this.columnObjects.forEach(e=>{var i;(i=e.chartInstance)===null||i===void 0||i.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(t,e,i){const r=this._table.internalProps.layoutMap.getHeader(t,e);r.title=i,r.define.title=i}getColumnByField(t){var e;return(e=this.columnObjects)===null||e===void 0?void 0:e.reduce((i,r,o)=>(r.field===t&&i.push({col:o,columnDefine:r}),i),[])}getColumnByKey(t){var e;let i;return{columnDefine:(e=this.columnObjects)===null||e===void 0?void 0:e.find((r,o)=>{var s;return((s=r.define)===null||s===void 0?void 0:s.key)===t&&(i=o+this.leftRowSeriesNumberColumnCount,!0)}),col:i}}getColumnDefine(t,e){if(t>=0)return t<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[t].define:this.transpose?this._columns[e].define:this._columns[t-this.leftRowSeriesNumberColumnCount].define}}class l8t{constructor(t){this.isValidatingValue=!1,this.listenersId=[],this.table=t,this.bindEvent()}bindEvent(){const t=this.table,e=t.on(ot.DBLCLICK_CELL,r=>{var o,s,a;const{editCellTrigger:l="doubleclick"}=t.options;if(!l.includes("doubleclick"))return;const{col:h,row:u}=r,d=sn(r.federatedEvent),c=t.scenegraph.getResizeColAt(d.abstractPos.x,d.abstractPos.y,(o=d.eventArgs)===null||o===void 0?void 0:o.targetCell);t._canResizeColumn(c.col,c.row)&&c.col>=0||!((a=(s=r.target)===null||s===void 0?void 0:s.attribute)===null||a===void 0)&&a.funcType||(this.beginTriggerEditCellMode="doubleclick",this.startEditCell(h,u))}),i=t.on(ot.CLICK_CELL,r=>{var o,s;const{editCellTrigger:a="doubleclick"}=t.options;if(a==="click"||Array.isArray(a)&&a.includes("click")){if(!((s=(o=r.target)===null||o===void 0?void 0:o.attribute)===null||s===void 0)&&s.funcType)return;this.beginTriggerEditCellMode="click";const{col:l,row:h}=r;this.startEditCell(l,h)}});this.listenersId.push(e,i)}startEditCell(t,e,i){var r,o,s,a,l,h,u,d,c;if(this.editingEditor)return;const f=this.table.getEditor(t,e);if(f){if(!((o=(r=this.table.internalProps.layoutMap)===null||r===void 0?void 0:r.isAggregation)===null||o===void 0)&&o.call(r,t,e)){const y=(a=(s=this.table).isPivotTable)===null||a===void 0?void 0:a.call(s),b=!!y&&((h=(l=this.table.internalProps)===null||l===void 0?void 0:l.dataConfig)===null||h===void 0?void 0:h.updateAggregationOnEditCell);if(!y||y&&b)return}const g=this.table.getCellRawRecord(t,e);if(g?.vtableMerge)return;this.editingEditor||(this.editCell={col:t,row:e}),this.table._makeVisibleCell(t,e),this.editingEditor=f;const p=Y(i)?i:this.table.getCellOriginValue(t,e),v=this.table.getCellRangeRelativeRect(this.table.getCellRange(t,e)),m={rect:{left:v.left,top:v.top,width:v.width,height:v.height}};t===this.table.colCount-1?m.rect.width=v.width-1:m.rect.width=v.width+1,e===this.table.rowCount-1?m.rect.height=v.height-1:m.rect.height=v.height+1,f.beginEditing,(u=f.beginEditing)===null||u===void 0||u.call(f,this.table.getElement(),m,p),f.bindSuccessCallback,(d=f.bindSuccessCallback)===null||d===void 0||d.call(f,()=>{this.completeEdit()}),(c=f.onStart)===null||c===void 0||c.call(f,{value:p,endEdit:()=>{this.completeEdit()},referencePosition:m,container:this.table.getElement(),col:t,row:e,table:this.table})}}completeEdit(t){var e,i;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;const r=t?.target,{editingEditor:o}=this;if(r){if(o.targetIsOnEditor){if(o.targetIsOnEditor(r))return!1}else if(!o.isEditorElement||o.isEditorElement(r))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;const s=this.editingEditor.getValue(),a=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),l=t?.target,h=(i=(e=this.editingEditor).validateValue)===null||i===void 0?void 0:i.call(e,s,a,this.editCell,this.table,!!this.table.getElement().contains(l));return aa(h)?(this.isValidatingValue=!0,new Promise((u,d)=>{h.then(c=>{MG(c,this,a,u)}).catch(c=>{this.isValidatingValue=!1,d(c)})})):MG(h,this,a)}return this.doExit(),!0}doExit(){var t,e,i,r,o,s,a,l;const h=(e=(t=this.editingEditor).getValue)===null||e===void 0?void 0:e.call(t),u=this.table.getCellRange(this.editCell.col,this.editCell.row),d=[];for(let c=u.start.row;c<=u.end.row;c++){const f=[];for(let g=u.start.col;g<=u.end.col;g++)f.push(h);d.push(f)}(r=(i=this.editingEditor).beforeEnd)===null||r===void 0||r.call(i),this.table.changeCellValues(u.start.col,u.start.row,d),this.editingEditor.exit,(s=(o=this.editingEditor).exit)===null||s===void 0||s.call(o),(l=(a=this.editingEditor).onEnd)===null||l===void 0||l.call(a),this.editingEditor=null,this.isValidatingValue=!1,this.beginTriggerEditCellMode=null}cancelEdit(){var t,e,i,r;this.editingEditor&&((e=(t=this.editingEditor).exit)===null||e===void 0||e.call(t),(r=(i=this.editingEditor).onEnd)===null||r===void 0||r.call(i),this.editingEditor=null)}release(){this.listenersId.forEach(t=>{this.table.off(t)})}}function MG(n,t,e,i){return t.isValidatingValue=!1,n==="validate-exit"?(t.doExit(),i?.(!0),!0):n==="invalidate-exit"?(t.editingEditor.setValue(e),t.doExit(),i?.(!0),!0):n==="validate-not-exit"||n==="invalidate-not-exit"?(i?.(!1),!1):n===!0?(t.doExit(),i?.(!0),!0):(i?.(!1),!1)}function RG(n,t){return Si(n)?{groupByRules:[n],addRecordRule:t}:Mt(n)?{groupByRules:n.map(e=>Si(e)?e:e.key),addRecordRule:t}:{addRecordRule:t}}var h8t=function(n,t,e,i){return new(e||(e=Promise))(function(r,o){function s(h){try{l(i.next(h))}catch(u){o(u)}}function a(h){try{l(i.throw(h))}catch(u){o(u)}}function l(h){var u;h.done?r(h.value):(u=h.value,u instanceof e?u:new e(function(d){d(u)})).then(s,a)}l((i=i.apply(n,t||[])).next())})};function u8t(n,t,e,i,r,o){if(i&&o.isHasEditorDefine(n,t)||i===!1){const s=o.getRecordShowIndexByCell(n,t),{field:a}=o.internalProps.layoutMap.getBody(n,t),l=o.getCellRawValue(n,t),h=o.getCellOriginValue(n,t);o.isHeader(n,t)?o.internalProps.layoutMap.updateColumnTitle(n,t,e):o.dataSource.changeFieldValue(e,s,a,n,t,o);const u=o.getCellRange(n,t),d=o.internalProps.layoutMap.getAggregatorsByCell(n,t);if(d){if(Array.isArray(d))for(let g=0;g<d?.length;g++)d[g].recalculate();else d.recalculate();const f=o.internalProps.layoutMap.getAggregatorCellAddress(u.start.col,u.start.row,u.end.col,u.end.row);for(let g=0;g<f.length;g++){const p=o.getCellRange(f[g].col,f[g].row);for(let v=p.start.col;v<=p.end.col;v++)for(let m=p.start.row;m<=p.end.row;m++)o.scenegraph.updateCellContent(v,m)}}for(let f=u.start.col;f<=u.end.col;f++)for(let g=u.start.row;g<=u.end.row;g++)o.scenegraph.updateCellContent(f,g);if(o.widthMode==="adaptive"||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)o.internalProps._widthResizedColMap.size===0&&o.scenegraph.recalculateColWidths();else if(!o.internalProps._widthResizedColMap.has(n)){const f=o.getColWidth(n),g=ag(n,0,o.rowCount-1,o,!1);g!==f&&o.scenegraph.updateColWidth(n,g-f)}if(o.heightMode==="adaptive"||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.internalProps._heightResizedRowMap.size===0&&o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight(t)&&!o.internalProps._heightResizedRowMap.has(t)){const f=o.getRowHeight(t),g=qo(t,0,o.colCount-1,o);o.scenegraph.updateRowHeight(t,g-f)}const c=o.getCellOriginValue(n,t);h!==c&&r&&o.fireListeners(ot.CHANGE_CELL_VALUE,{col:n,row:t,rawValue:l,currentValue:h,changedValue:c}),o.scenegraph.updateNextFrame()}}function d8t(n,t,e,i,r,o){var s,a;return h8t(this,void 0,void 0,function*(){const l=[];let h=n,u=t;const d=[],c=[];let f;for(let m=0;m<e.length&&!(t+m>o.rowCount-1);m++){const y=e[m],b=[],_=[];d.push(b),c.push(_);for(let w=0;w<y.length&&!(n+w>o.colCount-1);w++){f=c8t(n+w,t+m,o,f);const C=o.getCellRawValue(n+w,t+m);b.push(C);const x=o.getCellOriginValue(n+w,t+m);_.push(x)}}for(let m=0;m<e.length&&!(t+m>o.rowCount-1);m++){l[m]=[],u=t+m;const y=e[m];let b=n;for(let _=0;_<y.length&&!(n+_>o.colCount-1);_++){b=n+_;let w=!1;if(i===!1)w=!0;else if(o.isHasEditorDefine(n+_,t+m)){const C=o.getEditor(n+_,t+m),x=c[m][_],S=y[_],A=(a=(s=C?.validateValue)===null||s===void 0?void 0:s.call(C,S,x,{col:n+_,row:t+m},o))===null||a===void 0||a;if(aa(A)){const T=yield A;w=T===!0||T==="validate-exit"||T==="validate-not-exit"}else w=A===!0||A==="validate-exit"||A==="validate-not-exit"}if(w){l[m][_]=!0;const C=y[_],x=o.getRecordShowIndexByCell(n+_,t+m),{field:S}=o.internalProps.layoutMap.getBody(n+_,t+m),A=d[m][_],T=c[m][_];o.isHeader(n+_,t+m)?o.internalProps.layoutMap.updateColumnTitle(n+_,t+m,C):o.dataSource.changeFieldValue(C,x,S,n+_,t+m,o);const M=o.getCellOriginValue(n+_,t+m);T!==M&&r&&o.fireListeners(ot.CHANGE_CELL_VALUE,{col:n+_,row:t+m,rawValue:A,currentValue:T,changedValue:M})}else l[m][_]=!1}h=Math.max(h,b)}const g=o.getCellRange(n,t),p=o.getCellRange(h,u),v=o.internalProps.layoutMap.getAggregatorsByCellRange(g.start.col,g.start.row,p.end.col,p.end.row);if(v){for(let m=0;m<v?.length;m++)v[m].recalculate();if(f==="normal"){const m=o.internalProps.layoutMap.getAggregatorCellAddress(g.start.col,g.start.row,p.end.col,p.end.row);for(let y=0;y<m.length;y++){const b=o.getCellRange(m[y].col,m[y].row);for(let _=b.start.col;_<=b.end.col;_++)for(let w=b.start.row;w<=b.end.row;w++)o.scenegraph.updateCellContent(_,w)}}}if(f==="group"&&o.dataSource.updateRecordsForGroup([],[]),f==="sort"||f==="group")return o.dataSource.sortedIndexMap.clear(),Xr(o),o.refreshRowColCount(),o.internalProps.layoutMap.clearCellRangeMap(),o.scenegraph.clearCells(),o.scenegraph.createSceneGraph(),l;for(let m=g.start.col;m<=p.end.col;m++)for(let y=g.start.row;y<=p.end.row;y++)o.scenegraph.updateCellContent(m,y);if(o.widthMode==="adaptive"||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)o.internalProps._widthResizedColMap.size===0&&o.scenegraph.recalculateColWidths();else for(let m=n;m<=p.end.col;m++)if(!o.internalProps._widthResizedColMap.has(m)){const y=o.getColWidth(m),b=ag(m,0,o.rowCount-1,o,!1);b!==y&&o.scenegraph.updateColWidth(m,b-y)}if(o.heightMode==="adaptive"||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight(t)){const m=[],y=[];for(let b=t;b<=p.end.row;b++)if(o.rowHeightsMap.get(b)){const _=o.getRowHeight(b),w=qo(b,0,o.colCount-1,o);m.push(b),y.push(w-_)}o.scenegraph.updateRowsHeight(m,y)}return o.scenegraph.updateNextFrame(),l})}function c8t(n,t,e,i){if(i==="group"||i==="sort"&&!e.internalProps.groupBy)return i;let r="normal";return e.internalProps.groupBy?r="group":!e.isHeader(n,t)&&e.dataSource.lastOrderField&&e.getBodyField(n,t)===e.dataSource.lastOrderField&&(r="sort"),r}function Xr(n){let t=n.sortState;t=!t||Array.isArray(t)?t:[t],t&&(t=t.map(e=>{var i;return e.orderFn=(i=n._getSortFuncFromHeaderOption(void 0,e.field))!==null&&i!==void 0?i:Z1,e}),n.dataSource.sort(t))}function f8t(n,t,e){var i,r,o,s;if(e.internalProps.groupBy)(r=(i=e.dataSource).addRecordsForGroup)===null||r===void 0||r.call(i,[n],t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Xr(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(o=e.dataSource).addRecordsForTree)===null||s===void 0||s.call(o,[n],t),Vx(e,t,1),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Xr(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.addRecordForSorted(n),e.stateManager.checkedState.clear(),Xr(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{(t===void 0||t>e.dataSource.sourceLength)&&(t=e.dataSource.sourceLength);const a=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;e.dataSource.addRecord(n,t),Vx(e,t,1);const l=e.rowCount;if(e.refreshRowColCount(),e.scenegraph.proxy.totalActualBodyRowCount===0)return e.scenegraph.clearCells(),void e.scenegraph.createSceneGraph();const h=e.transpose?e.colCount:e.rowCount;if(e.pagination){const{perPageCount:u,currentPage:d}=e.pagination,c=u*(d||0)+u;if(t<c)if(t<c-u)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const f=t-(c-u)+a;if(l-a===e.pagination.perPageCount){const g=[];for(let p=f;p<h;p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],[],g):e.scenegraph.updateRow([],[],g)}else{const g=[];for(let p=f;p<Math.min(h,f+1);p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],g,[]):e.scenegraph.updateRow([],g,[])}}}else{const u=[];for(let g=t+a;g<t+a+1;g++)e.transpose?u.push({col:g,row:0}):u.push({col:0,row:g});const d=[],c=e.internalProps.layoutMap.hasAggregationOnTopCount,f=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let g=a;g<a+c;g++)e.transpose?d.push({col:g,row:0}):d.push({col:0,row:g});for(let g=(e.transpose?e.colCount:e.rowCount)-f;g<(e.transpose?e.colCount:e.rowCount);g++)e.transpose?d.push({col:g,row:0}):d.push({col:0,row:g});e.transpose?e.scenegraph.updateCol([],u,[]):e.scenegraph.updateRow([],u,[])}}}function g8t(n,t,e){var i,r,o,s;if(e.internalProps.groupBy)(r=(i=e.dataSource).addRecordsForGroup)===null||r===void 0||r.call(i,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Xr(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(o=e.dataSource).addRecordsForTree)===null||s===void 0||s.call(o,n,t),Vx(e,t,n.length),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Xr(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.addRecordsForSorted(n),Xr(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{t===void 0||t>e.dataSource.sourceLength?t=e.dataSource.sourceLength:t<0&&(t=0);const a=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;e.dataSource.addRecords(n,t),Vx(e,t,n.length);const l=e.transpose?e.colCount:e.rowCount;if(e.refreshRowColCount(),e.scenegraph.proxy.totalActualBodyRowCount===0)return e.scenegraph.clearCells(),void e.scenegraph.createSceneGraph();const h=e.transpose?e.colCount:e.rowCount;if(e.pagination){const{perPageCount:u,currentPage:d}=e.pagination,c=u*(d||0)+u;if(t<c)if(t<c-u)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const f=t-(c-u)+a;if(l-a===e.pagination.perPageCount){const g=[];for(let p=f;p<h;p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],[],g):e.scenegraph.updateRow([],[],g)}else{const g=[];for(let p=f;p<Math.min(h,f+(Array.isArray(n)?n.length:1));p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],g,[]):e.scenegraph.updateRow([],g,[])}}}else{const u=[];for(let g=t+a;g<t+a+(Array.isArray(n)?n.length:1);g++)e.transpose?u.push({col:g,row:0}):u.push({col:0,row:g});const d=e.internalProps.layoutMap.hasAggregationOnTopCount,c=e.internalProps.layoutMap.hasAggregationOnBottomCount,f=[];for(let g=a;g<a+d;g++)e.transpose?f.push({col:g,row:0}):f.push({col:0,row:g});for(let g=(e.transpose?e.colCount:e.rowCount)-c;g<(e.transpose?e.colCount:e.rowCount);g++)e.transpose?f.push({col:g,row:0}):f.push({col:0,row:g});e.transpose?e.scenegraph.updateCol([],u,f):e.scenegraph.updateRow([],u,f)}}}function p8t(n,t){var e,i,r,o,s,a,l,h;if(n?.length>0)if(t.internalProps.groupBy)(i=(e=t.dataSource).deleteRecordsForGroup)===null||i===void 0||i.call(e,n),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&Xr(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if(t.dataSource.rowHierarchyType==="tree"){const u=(o=(r=t.dataSource).deleteRecordsForTree)===null||o===void 0?void 0:o.call(r,n);if(u.length===0)return;for(let d=0;d<u.length;d++)BG(t,u[d],1);t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&Xr(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph()}else if(t.sortState)t.dataSource.deleteRecordsForSorted(n),Xr(t),t.refreshRowColCount(),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{const u=t.dataSource.deleteRecords(n);if(u.length===0)return;for(let p=0;p<u.length;p++)BG(t,u[p],1);const d=t.transpose?t.colCount:t.rowCount;t.refreshRowColCount();const c=t.transpose?t.colCount:t.rowCount,f=u.sort((p,v)=>p-v),g=f[0];if(t.pagination){const{perPageCount:p,currentPage:v}=t.pagination,m=p*(v||0)+p;if(g<m)if(g<m-p)t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{const y=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,b=t.internalProps.layoutMap.hasAggregationOnTopCount,_=[],w=[];for(let C=g-(m-p)+(t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount)+b;C<c;C++)t.transpose?_.push({col:C,row:0}):_.push({col:0,row:C});for(let C=y;C<y+b;C++)t.transpose?_.push({col:C,row:0}):_.push({col:0,row:C});if(c<d)for(let C=c;C<d;C++)t.transpose?w.push({col:C,row:0}):w.push({col:0,row:C});(s=t.reactCustomLayout)===null||s===void 0||s.clearCache(),t.transpose?t.scenegraph.updateCol(w,[],_):t.scenegraph.updateRow(w,[],_),(a=t.reactCustomLayout)===null||a===void 0||a.updateAllCustomCell()}}else{const p=[],v=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,m=t.internalProps.layoutMap.hasAggregationOnTopCount,y=t.internalProps.layoutMap.hasAggregationOnBottomCount;for(let _=0;_<f.length;_++){const w=f[_]+v+m;t.transpose?p.push({col:w,row:0}):p.push({col:0,row:w})}const b=[];for(let _=v;_<v+m;_++)t.transpose?b.push({col:_,row:0}):b.push({col:0,row:_});for(let _=(t.transpose?t.colCount:t.rowCount)-y;_<(t.transpose?t.colCount:t.rowCount);_++)t.transpose?b.push({col:_,row:0}):b.push({col:0,row:_});(l=t.reactCustomLayout)===null||l===void 0||l.clearCache(),t.transpose?t.scenegraph.updateCol(p,[],b):t.scenegraph.updateRow(p,[],b),(h=t.reactCustomLayout)===null||h===void 0||h.updateAllCustomCell()}}}function v8t(n,t,e){var i,r,o,s;if(t?.length>0)if(e.internalProps.groupBy)(r=(i=e.dataSource).updateRecordsForGroup)===null||r===void 0||r.call(i,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Xr(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(o=e.dataSource).updateRecordsForTree)===null||s===void 0||s.call(o,n,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Xr(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.updateRecordsForSorted(n,t),Xr(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const a=e.dataSource.updateRecords(n,t);if(a.length===0)return;const l=a.map(h=>e.getBodyRowIndexByRecordIndex(h)).sort((h,u)=>h-u);if(e.pagination){const{perPageCount:h,currentPage:u}=e.pagination,d=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,c=e.internalProps.layoutMap.hasAggregationOnTopCount,f=h*(u||0)+h,g=[];for(let p=0;p<l.length;p++){const v=l[p];if(v<f&&v>=f-h){const m=v-(f-h)+(e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount)+c;g.push(m)}}if(g.length>=1){const p=[];for(let v=0;v<g.length;v++){const m=g[v];e.transpose?p.push({col:m,row:0}):p.push({col:0,row:m})}for(let v=d;v<d+c;v++)e.transpose?p.push({col:v,row:0}):p.push({col:0,row:v});e.transpose?e.scenegraph.updateCol([],[],p):e.scenegraph.updateRow([],[],p)}}else{const h=[],u=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,d=e.internalProps.layoutMap.hasAggregationOnTopCount,c=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let f=0;f<l.length;f++){const g=l[f]+u+d;e.transpose?h.push({col:g,row:0}):h.push({col:0,row:g})}for(let f=u;f<u+d;f++)e.transpose?h.push({col:f,row:0}):h.push({col:0,row:f});for(let f=(e.transpose?e.colCount:e.rowCount)-c;f<(e.transpose?e.colCount:e.rowCount);f++)e.transpose?h.push({col:f,row:0}):h.push({col:0,row:f});e.transpose?e.scenegraph.updateCol([],[],h):e.scenegraph.updateRow([],[],h)}}}function BG(n,t,e){const{checkedState:i}=n.stateManager;if(i)if(n.dataSource.rowHierarchyType==="tree"){let r;r=pt(t)?[t]:t;const o=r.length,s=[];i.forEach((a,l)=>{var h;const u=l.split(",");if(u.length>=r.length)for(let d=0;d<u.length;d++){const c=(h=r[d])!==null&&h!==void 0?h:-1,f=Number(u[d]);if(!(c===f&&d<u.length-1)){if(c===f&&d===u.length-1||c===-1){s.push({originKey:l,value:a});break}if(c<f&&d===o-1){u[d]=(f-e).toString(),s.push({originKey:l,targetKey:u.toString(),value:a});break}break}}}),s.sort((a,l)=>{const h=a.originKey.split(","),u=l.originKey.split(","),d=h.length,c=u.length,f=Math.min(d,c);for(let g=0;g<f;g++){const p=Number(h[g]),v=Number(u[g]);if(p!==v)return p-v}return d-c}),s.forEach(({originKey:a,targetKey:l,value:h})=>{i.delete(a),l&&i.set(l,h)})}else{const r=[],o=[];i.forEach((s,a)=>{const l=Number(a);!isNaN(l)&&l>=t&&(l===t?r.push(a):l>t&&o.push({originKey:a,targetKey:(l-e).toString(),value:s}))}),r.forEach(s=>i.delete(s)),o.forEach(({originKey:s,targetKey:a,value:l})=>{i.delete(s),i.set(a,l)})}}function Vx(n,t,e){const{checkedState:i}=n.stateManager;if(i)if(n.dataSource.rowHierarchyType==="tree"){let r;r=pt(t)?[t]:t;const o=r.length,s=[];i.forEach((a,l)=>{var h;const u=l.split(",");if(u.length>=r.length)for(let d=0;d<u.length;d++){const c=(h=r[d])!==null&&h!==void 0?h:-1,f=Number(u[d]);if(c===f&&(d===u.length-1||d===o-1)){u[d]=(f+e).toString(),s.push({originKey:l,targetKey:u.toString(),value:a});break}if(!(c===f&&d<u.length-1)){if(c<f&&d===o-1){u[d]=(f+e).toString(),s.push({originKey:l,targetKey:u.toString(),value:a});break}break}}}),s.sort((a,l)=>{const h=a.originKey.split(","),u=l.originKey.split(","),d=h.length,c=u.length,f=Math.min(d,c);for(let g=0;g<f;g++){const p=Number(h[g]),v=Number(u[g]);if(p!==v)return-p+v}return-d+c}),s.forEach(({originKey:a,targetKey:l,value:h})=>{i.delete(a),l&&i.set(l,h)})}else for(let r=i.size-1;r>=t;r--){const o=i.get(r.toString());i.delete(r.toString()),i.set((r+e).toString(),o)}}function m8t(n,t,e,i){const r=[{col:t,row:e}],o=[],s=[],{addCellPositions:a,removeCellPositions:l}=n,h=i.scenegraph.proxy,{rowStart:u,rowLimit:d}=h;let{rowEnd:c}=h,f=1/0;for(let v=0;v<a.length;v++){const{row:m}=a[v];c-u+1===d?m>=u&&m<=c&&(f=Math.min(f,m)):(o.push({col:t,row:m}),c++)}const g=Math.min(u+d,i.rowCount-1-i.bottomFrozenRowCount),p=g<u+d;for(let v=0;v<l.length;v++){const{row:m}=l[l.length-v-1];m<u||m>c||(m>g||p?(s.push({col:t,row:m}),f--):f=Math.min(f,m))}if(f!==1/0)for(let v=f;v<=c;v++)r.push({col:t,row:v});return i.scenegraph.proxy.refreshRowCount(),{updateCells:r,addCells:o,removeCells:s}}class y8t extends TGt{constructor(t,e){var i,r,o,s,a,l,h,u;super(t,e),this.showHeader=!0,e=this.options;const d=this.internalProps;if(d.frozenColDragHeaderMode=(r=(i=e.dragOrder)===null||i===void 0?void 0:i.frozenColDragHeaderMode)!==null&&r!==void 0?r:e.frozenColDragHeaderMode,this.pagination=e.pagination,d.sortState=e.sortState,d.multipleSort=!!e.multipleSort,d.dataConfig=this.internalProps.groupBy?RG(this.internalProps.groupBy,e.addRecordRule):{addRecordRule:e.addRecordRule},d.columns=e.columns?_f(e.columns,["children"]):e.header?_f(e.header,["children"]):[],k_(this),d.enableTreeNodeMerge=(s=(o=e.enableTreeNodeMerge)!==null&&o!==void 0?o:Y(this.internalProps.groupBy))!==null&&s!==void 0&&s,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=(a=e.showHeader)===null||a===void 0||a,this.internalProps.columnWidthConfig=e.columnWidthConfig,this.transpose=(l=e.transpose)!==null&&l!==void 0&&l,ye.mode!=="node"&&(this.editorManager=new l8t(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:d.sortState}):this.setRecords([]),e.title){const c=Bt.getComponent("title");d.title=new c(e.title,this)}if(this.options.emptyTip)if(this.internalProps.emptyTip)(h=this.internalProps.emptyTip)===null||h===void 0||h.resetVisible();else{const c=Bt.getComponent("emptyTip");this.internalProps.emptyTip=new c(this.options.emptyTip,this),(u=this.internalProps.emptyTip)===null||u===void 0||u.resetVisible()}if(this.internalProps.enableTreeStickCell){const c=Bt.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new c(this)}setTimeout(()=>{this.isReleased||(this.resize(),this.fireListeners(ot.INITIALIZED,null))},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var t;return(t=this.dataSource)===null||t===void 0?void 0:t.records}get recordsCount(){return this.dataSource.records.length}updateColumns(t,e){var i,r,o,s;this.scenegraph.clearCells();const a={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=_f(t,["children"]),k_(this),e?.clearColWidthCache&&this.internalProps._widthResizedColMap.clear(),this.options.columns=t,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),(r=(i=this.dataSource).updateColumns)===null||r===void 0||r.call(i,this.internalProps.columns),this.records&&uV(this.internalProps.columns)&&this.dataSource.processRecords((s=(o=this.dataSource.dataSourceObj)===null||o===void 0?void 0:o.records)!==null&&s!==void 0?s:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(a.col,a.row),this.renderAsync(),this.eventManager.updateEventBinder()}_recreateSceneForStateChange(){var t,e;this.scenegraph.clearCells();const i={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this._hasAutoImageColumn=void 0,this.refreshHeader(),this.records&&uV(this.internalProps.columns)&&this.dataSource.processRecords((e=(t=this.dataSource.dataSourceObj)===null||t===void 0?void 0:t.records)!==null&&e!==void 0?e:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this._updateSize(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(i.col,i.row),this.renderAsync(),this.eventManager.updateEventBinder()}addColumn(t,e,i=!0){const r=this.options.columns;if(e===void 0)r.push(t);else{if(i)for(let o=0;o<r.length;o++)typeof r[o].field=="number"&&r[o].field>=e&&(r[o].field=r[o].field+1);r.splice(e,0,t)}if(i)for(let o=0;o<this.records.length;o++){const s=this.records[o];Array.isArray(s)&&s.splice(e,0,void 0)}this.updateColumns(r)}deleteColumn(t){const e=this.options.columns;e.splice(t,1),this.updateColumns(e)}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(t){this.internalProps.columns=t,k_(this),this.options.header=t,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var t;return(t=this.internalProps.transpose)!==null&&t!==void 0&&t}set transpose(t){this.internalProps.transpose!==t&&(this.internalProps.transpose=t,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=t,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(t,e,i){var r;if(t===-1||e===-1)return null;if(!i){const l=this.getCustomMergeValue(t,e);if(l)return l}const o=this;if(o.internalProps.layoutMap.isSeriesNumber(t,e)){if(o.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){const{title:u}=o.internalProps.layoutMap.getSeriesNumberHeader(t,e);return u}let l;if(this.internalProps.groupBy){const u=o.getCellRawRecord(t,e);if(u?.vtableMerge)return"";o.internalProps.layoutMap.isAggregation(t,e)||(l=this.dataSource.getGroupSeriesNumber(e-this.columnHeaderLevelCount))}else{const u=o.getBodyColumnDefine(t,e),d=o.getFieldData(u.field,t,e);l=["number","string"].includes(typeof d)?d:d?.text?(r=d.text)!==null&&r!==void 0?r:"":e-this.columnHeaderLevelCount+1}const{format:h}=o.internalProps.layoutMap.getSeriesNumberBody(t,e);return typeof h=="function"?h(t,e,this,l):l}if(o.internalProps.layoutMap.isHeader(t,e)){const{title:l}=o.internalProps.layoutMap.getHeader(t,e);return typeof l=="function"?l():l}if(o.internalProps.layoutMap.isAggregation(t,e)){if(o.internalProps.layoutMap.isTopAggregation(t,e)){const l=o.internalProps.layoutMap.getAggregatorOnTop(t,e);return l?.formatValue?l.formatValue(t,e,this):""}if(o.internalProps.layoutMap.isBottomAggregation(t,e)){const l=o.internalProps.layoutMap.getAggregatorOnBottom(t,e);return l?.formatValue?l.formatValue(t,e,this):""}}const{field:s,fieldFormat:a}=o.internalProps.layoutMap.getBody(t,e);return o.getFieldData(a||s,t,e)}getCellOriginValue(t,e){if(t===-1||e===-1)return null;const i=this;if(i.internalProps.layoutMap.isSeriesNumber(t,e)){if(i.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){const{title:s}=i.internalProps.layoutMap.getSeriesNumberHeader(t,e);return s}const{format:o}=i.internalProps.layoutMap.getSeriesNumberBody(t,e);return typeof o=="function"?o(t,e,this):e-this.columnHeaderLevelCount}if(i.internalProps.layoutMap.isHeader(t,e)){const{title:o}=i.internalProps.layoutMap.getHeader(t,e);return typeof o=="function"?o():o}if(i.internalProps.layoutMap.isAggregation(t,e)){if(i.internalProps.layoutMap.isTopAggregation(t,e)){const o=i.internalProps.layoutMap.getAggregatorOnTop(t,e);return o?.value()}if(i.internalProps.layoutMap.isBottomAggregation(t,e)){const o=i.internalProps.layoutMap.getAggregatorOnBottom(t,e);return o?.value()}}const{field:r}=i.internalProps.layoutMap.getBody(t,e);return i.getFieldData(r,t,e)}getCellRawValue(t,e){if(t===-1||e===-1)return null;const i=this;if(i.internalProps.layoutMap.isHeader(t,e)){const{title:o}=i.internalProps.layoutMap.getHeader(t,e);return typeof o=="function"?o():o}const{field:r}=i.internalProps.layoutMap.getBody(t,e);return i.getRawFieldData(r,t,e)}getRecordShowIndexByCell(t,e){const{layoutMap:i}=this.internalProps;return i.getRecordShowIndexByCell(t,e)}getRecordIndexByCell(t,e){const{layoutMap:i}=this.internalProps,r=i.getRecordShowIndexByCell(t,e);return this.dataSource.getRecordIndexPaths(r)}getTableIndexByRecordIndex(t){return this.transpose?this.dataSource.getTableIndex(t)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(t)+this.columnHeaderLevelCount}getTableIndexByField(t){const e=this.internalProps.layoutMap.columnObjects.find(r=>r.field===t);if(!e)return-1;const i=this.internalProps.layoutMap.getBodyLayoutRangeById(e.id);return this.transpose?i.start.row:i.start.col}getCellAddrByFieldRecord(t,e){return this.transpose?{col:this.getTableIndexByRecordIndex(e),row:this.getTableIndexByField(t)}:{col:this.getTableIndexByField(t),row:this.getTableIndexByRecordIndex(e)}}getCellOriginRecord(t,e){const i=this,r=i.getRecordShowIndexByCell(t,e);if(r>-1)return i.dataSource.get(r)}getCellRawRecord(t,e){const i=this,r=i.getRecordShowIndexByCell(t,e);if(r>-1)return i.dataSource.getRaw(r)}_canResizeColumn(t,e){const i=super._canResizeColumn(t,e);if(i&&!this.transpose){const r=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount),o=this.internalProps.layoutMap.isSeriesNumber(t,e);if(r?.disableColumnResize||o&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1}return i}updateOption(t,e={clearColWidthCache:!0,clearRowHeightCache:!0}){var i,r,o,s,a,l,h,u,d;const c=this.internalProps;if(super.updateOption(t,e),c.frozenColDragHeaderMode=(r=(i=t.dragOrder)===null||i===void 0?void 0:i.frozenColDragHeaderMode)!==null&&r!==void 0?r:t.frozenColDragHeaderMode,this.pagination=t.pagination,c.sortState=t.sortState,c.dataConfig=this.internalProps.groupBy?RG(this.internalProps.groupBy,t.addRecordRule):{addRecordRule:t.addRecordRule},this.showHeader=(o=t.showHeader)===null||o===void 0||o,c.columns=t.columns?_f(t.columns,["children"]):t.header?_f(t.header,["children"]):[],k_(this),c.enableTreeNodeMerge=(a=(s=t.enableTreeNodeMerge)!==null&&s!==void 0?s:Y(this.internalProps.groupBy))!==null&&a!==void 0&&a,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=(l=t.transpose)!==null&&l!==void 0&&l,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=t.columnWidthConfig,c.releaseList)for(let f=c.releaseList.length-1;f>=0;f--){const g=c.releaseList[f];g instanceof Nl?g.updateColumns(this.internalProps.columns):((h=g?.release)===null||h===void 0||h.call(g),c.releaseList.splice(f,1))}if(t.dataSource&&this.dataSource!==t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:t.sortState}):(this.refreshRowColCount(),this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),t.title){const f=Bt.getComponent("title");c.title=new f(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(u=this.internalProps.emptyTip)===null||u===void 0||u.resetVisible();else{const f=Bt.getComponent("emptyTip");this.internalProps.emptyTip=new f(this.options.emptyTip,this),(d=this.internalProps.emptyTip)===null||d===void 0||d.resetVisible()}return this.pluginManager.updatePlugins(t.plugins),setTimeout(()=>{this.fireListeners(ot.UPDATED,null)},0),new Promise(f=>{setTimeout(f,0)})}updatePagination(t){this.pagination&&(typeof t.currentPage=="number"&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var t;const e=this.internalProps,i=this.transpose,r=this.showHeader;(e.layoutMap=new a8t(this,(t=e.columns)!==null&&t!==void 0?t:[],r,this.options.hierarchyIndent)).transpose=i,i||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y;const b=this,{layoutMap:_}=b.internalProps;if(!_)return;const w=(e=(t=b.internalProps.dataSource)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0;_.recordsCount=w+(w>0||this.options.showAggregationWhenEmpty?_.hasAggregationOnTopCount+_.hasAggregationOnBottomCount:0),b.transpose?(b.rowCount=(i=_.rowCount)!==null&&i!==void 0?i:0,b.colCount=(r=_.colCount)!==null&&r!==void 0?r:0,this.internalProps.frozenColCount=Math.max(((o=_.headerLevelCount)!==null&&o!==void 0?o:0)+_.leftRowSeriesNumberColumnCount,(s=this.options.frozenColCount)!==null&&s!==void 0?s:0),this.internalProps.frozenRowCount=(a=this.options.frozenRowCount)!==null&&a!==void 0?a:0,b.bottomFrozenRowCount!==((l=this.options.bottomFrozenRowCount)!==null&&l!==void 0?l:0)&&(b.bottomFrozenRowCount=(h=this.options.bottomFrozenRowCount)!==null&&h!==void 0?h:0),b.rightFrozenColCount!==((u=this.options.rightFrozenColCount)!==null&&u!==void 0?u:0)&&(b.rightFrozenColCount=(d=this.options.rightFrozenColCount)!==null&&d!==void 0?d:0)):(b.colCount=(c=_.colCount)!==null&&c!==void 0?c:0,b.rowCount=_.recordsCount*_.bodyRowSpanCount+_.headerLevelCount,this.internalProps.frozenColCount=(f=this.options.frozenColCount)!==null&&f!==void 0?f:0,this.options.frozenColCount>=this.colCount&&(this.internalProps.frozenColCount=0),b._setFrozenRowCount(Math.max(_.headerLevelCount,(g=this.options.frozenRowCount)!==null&&g!==void 0?g:0)),b.bottomFrozenRowCount!==((p=this.options.bottomFrozenRowCount)!==null&&p!==void 0?p:0)&&(b.bottomFrozenRowCount=(v=this.options.bottomFrozenRowCount)!==null&&v!==void 0?v:0),b.rightFrozenColCount!==((m=this.options.rightFrozenColCount)!==null&&m!==void 0?m:0)&&(b.rightFrozenColCount=(y=this.options.rightFrozenColCount)!==null&&y!==void 0?y:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(t,e,i){if(t===null||this.internalProps.layoutMap.isHeader(e,i))return null;const r=this.getRecordShowIndexByCell(this.transpose?e-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:e,i);return this.internalProps.dataSource.getField(r,t,e,i,this)}getRawFieldData(t,e,i){if(t===null||this.internalProps.layoutMap.isHeader(e,i))return null;const r=this.getRecordShowIndexByCell(e,i);return this.internalProps.dataSource.getRawField(r,t,e,i,this)}_moveHeaderPosition(t,e){const i=this.getCellRange(t.col,t.row),r=this.getCellRange(e.col,e.row),o=this.internalProps.layoutMap.moveHeaderPosition(t,e);return o?(o.moveType==="column"?(this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,o.targetIndex),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):o.targetIndex>o.sourceIndex?this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex+o.sourceSize-o.targetSize,o.targetSize,o.targetIndex):this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex,o.targetSize,o.targetIndex),o):null}changeRecordOrder(t,e){this.transpose?(t=this.getRecordShowIndexByCell(t,0),e=this.getRecordShowIndexByCell(e,0)):(t=this.getRecordShowIndexByCell(0,t),e=this.getRecordShowIndexByCell(0,e)),this.dataSource.changeOrder(t,e)}getCellAddress(t,e){let i;for(let o=0;o<this.internalProps.records.length;o++){const s=this.internalProps.records[o];if(typeof t=="function")t(s)&&(i=o);else{let a=!0;for(const l in t)if(s[l]!==t[l]){a=!1;break}a&&(i=o)}if(Y(i))break}const r=this.getCellRangeByField(e,i);if(r)return{row:r.start.row,col:r.start.col}}getCellRangeByField(t,e){const{layoutMap:i}=this.internalProps,r=i.columnObjects.find(o=>o.field===t);if(r){const o=i.getBodyLayoutRangeById(r.id);let s;return Y(e)&&(s=i.getRecordStartRowByRecordIndex(e)),this.transpose?{start:{row:o.start.row,col:Y(s)?s+o.start.col:void 0},end:{row:o.end.row,col:Y(s)?s+o.end.col:void 0}}:{start:{col:o.start.col,row:Y(s)?s+o.start.row:void 0},end:{col:o.end.col,row:Y(s)?s+o.end.row:void 0}}}return null}getHierarchyState(t,e){var i;if(this.isHeader(t,e))return(i=this._getHeaderLayoutMap(t,e))===null||i===void 0?void 0:i.hierarchyState;if((!this.internalProps.groupBy||Mt(this.internalProps.groupBy)&&this.internalProps.groupBy.length===0)&&!this.getBodyColumnDefine(t,e).tree)return Lt.none;const r=this.getRecordShowIndexByCell(t,e);return this.dataSource.getHierarchyState(r)}getRecordHierarchyState(t,e){let i;return this.transpose?this.getRecordShowIndexByCell(t,0):i=this.getRecordShowIndexByCell(0,e),this.dataSource.getHierarchyState(i)}toggleHierarchyState(t,e,i=!0){this.stateManager.updateHoverIcon(t,e,void 0,void 0);const r=this.getHierarchyState(t,e);if(this.isHeader(t,e)){const o=this.internalProps.layoutMap.getHeader(t,e),{hierarchyState:s,define:a}=o;if(![Lt.collapse,Lt.expand].includes(s)||!a)return;const l=a.columns;if(Array.isArray(l)&&l.length>0){const h=s===Lt.expand?Lt.collapse:Lt.expand;o.hierarchyState=h,o.define.hierarchyState=h,this.updateColumns(this.internalProps.columns)}this.fireListeners(ot.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:r,originData:o,cellLocation:this.getCellLocation(t,e)})}else if(r===Lt.expand)this._refreshHierarchyState(t,e,i),this.fireListeners(ot.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:Lt.collapse});else if(r===Lt.collapse){const o=this.getCellOriginRecord(t,e);Array.isArray(o.children)&&this._refreshHierarchyState(t,e,i),this.fireListeners(ot.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:Lt.expand,originData:o})}}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}_refreshHierarchyState(t,e,i=!0){var r,o;let s=!1,a=!1;const l=this.internalProps.layoutMap.checkHasChart();l&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight));const h=this.getRecordShowIndexByCell(t,e),u=this.dataSource.toggleHierarchyState(h,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),d=this.internalProps.layoutMap.toggleHierarchyState(u);this.refreshRowColCount();for(let p=this.rowCount-this.bottomFrozenRowCount;p<this.rowCount;p++){const v=qo(p,0,this.colCount-1,this);this._setRowHeight(p,v)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;const{updateCells:c,addCells:f,removeCells:g}=m8t(d,t,e,this);(r=this.reactCustomLayout)===null||r===void 0||r.clearCache(),this.scenegraph.updateRow(g,f,c,i,!0),(o=this.reactCustomLayout)===null||o===void 0||o.updateAllCustomCell(),l&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!a&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||s||this.heightMode==="adaptive"||a)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var t,e;return(e=(t=this.options.columns)!==null&&t!==void 0?t:this.options.header)===null||e===void 0?void 0:e.some((i,r)=>i.tree)}getMenuInfo(t,e,i){return{field:this.getHeaderField(t,e),value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),event:void 0}}_getSortFuncFromHeaderOption(t,e,i){if(t||(t=this.internalProps.columns),e&&t&&t.length>0)for(let r=0;r<t.length;r++){const o=t[r];if((i&&i===o.fieldKey||!i&&o.field===e)&&o.sort&&typeof o.sort=="function")return o.sort;if(o.columns){const s=this._getSortFuncFromHeaderOption(o.columns,e,i);if(s)return s}}}updateSortState(t,e=!0){var i;if(t)this.internalProps.sortState=t;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let r=0;r<this.internalProps.sortState.length;r++)(t=(i=this.internalProps.sortState)===null||i===void 0?void 0:i[r])&&(t.order="normal");else this.internalProps.sortState.order="normal",t=this.internalProps.sortState;(t=Array.isArray(t)?t:[t]).some(r=>r.field)&&e&&this.internalProps.layoutMap.headerObjects.some(r=>r.define.sort!==!1)&&(this.dataSource.sort(t.map(r=>{const o=this._getSortFuncFromHeaderOption(this.internalProps.columns,r.field);return this.internalProps.layoutMap.headerObjects.find(s=>s&&s.field===r.field),{field:r.field,order:r.order,orderFn:o??Z1}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),t.length&&this.stateManager.updateSortState(t)}updateFilterRules(t){this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(t),Xr(this)):this.dataSource.updateFilterRules(t),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.resize()}getCheckboxState(t){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),Y(t)){let e=Array.from(this.stateManager.checkedState.keys()).sort((i,r)=>{var o,s;const a=i.split(","),l=r.split(","),h=Math.max(a.length,l.length);for(let u=0;u<h;u++){const d=(o=Number(a[u]))!==null&&o!==void 0?o:0,c=(s=Number(l[u]))!==null&&s!==void 0?s:0;if(d!==c)return d-c}return 0}).map(i=>this.stateManager.checkedState.get(i));return this.options.groupBy&&(e=Q6t(this)),Array.from(e,i=>i&&i[t])}return new Array(...this.stateManager.checkedState.values())}getCellCheckboxState(t,e){var i;const r=this.getBodyColumnDefine(t,e),o=r?.field,s=this.getCellType(t,e);if(Y(o)&&(s==="checkbox"||s==="switch")){const a=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)).toString();return(i=this.stateManager.checkedState.get(a))===null||i===void 0?void 0:i[o]}}getRadioState(t){return Y(t)?this.stateManager.radioState[t]:this.stateManager.radioState}getCellRadioState(t,e){return W6t(t,e,this)}setCellCheckboxState(t,e,i){Z6t(t,e,i,this)}setCellRadioState(t,e,i){G6t(t,e,i,this)}getSwitchState(t){return this.getCheckboxState(t)}getCellSwitchState(t,e){return this.getCellCheckboxState(t,e)}setCellSwitchState(t,e,i){this.setCellCheckboxState(t,e,i)}setRecords(t,e){var i,r,o,s;let a;aE(),(i=this.internalProps.dataSource)===null||i===void 0||i.release(),this.internalProps.releaseList=(r=this.internalProps.releaseList)===null||r===void 0?void 0:r.filter(h=>!h.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(e)||e?.order?a=e:e?a=e.sortState:e===null&&(a=null),typeof window<"u"&&window.performance.now();const l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),a!==void 0&&(a===null||!Array.isArray(a)&&Y(a.field)||Array.isArray(a))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(a)?a:[a]:a,this.stateManager.setSortState(this.sortState)),t){if(hV(this,t),this.sortState){const h=Array.isArray(this.sortState)?this.sortState:[this.sortState];h.some(u=>u.order&&u.field&&u.order!=="normal")&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(u=>u.define.sort!==!1)&&this.dataSource.sort(h.map(u=>{const d=this._getSortFuncFromHeaderOption(void 0,u.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(c=>c&&c.field===u.field),{field:u.field,order:u.order||"asc",orderFn:d??Z1}}))}this.refreshRowColCount()}else hV(this,t);if(this.stateManager.initCheckedState(t),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this._updateSize(),this.internalProps.title&&!this.internalProps.title.isReleased&&this.internalProps.title.resize(),this.scenegraph.resize(),this.options.emptyTip)if(this.internalProps.emptyTip)(o=this.internalProps.emptyTip)===null||o===void 0||o.resetVisible();else{const h=Bt.getComponent("emptyTip");this.internalProps.emptyTip=new h(this.options.emptyTip,this),(s=this.internalProps.emptyTip)===null||s===void 0||s.resetVisible()}this.render(),Y(l.col)&&Y(l.row)&&l.col>=0&&l.row>=0&&setTimeout(()=>{var h;(h=this.internalProps)===null||h===void 0||h.tooltipHandler.showTooltip(l.col,l.row)},0)}setRecordChildren(t,e,i,r=!0){const o=this.getCellOriginRecord(e,i);o.children=t;const s=this.getRecordShowIndexByCell(e,i);this.dataSource.setRecord(o,s),this._refreshHierarchyState(e,i,r)}startEditCell(t,e,i){var r;if(Y(t)&&Y(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,i);else if(!((r=this.stateManager.select)===null||r===void 0)&&r.cellPos){const{col:o,row:s}=this.stateManager.select.cellPos;Y(o)&&Y(s)&&this.editorManager.startEditCell(o,s,i)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var i,r;const o=this.getBodyColumnDefine(t,e);let s=this.isHeader(t,e)?(i=o?.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor:(r=o?.editor)!==null&&r!==void 0?r:this.options.editor;return typeof s=="function"&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),typeof s=="string"?PGt(s):s}isHasEditorDefine(t,e){var i,r;const o=this.getBodyColumnDefine(t,e);let s=this.isHeader(t,e)?(i=o?.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor:(r=o?.editor)!==null&&r!==void 0?r:this.options.editor;return typeof s=="function"&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),Y(s)}changeCellValue(t,e,i,r=!1,o=!0){return u8t(t,e,i,r,o,this)}changeCellValues(t,e,i,r=!1,o=!0){return d8t(t,e,i,r,o,this)}addRecord(t,e){var i;f8t(t,e,this),(i=this.internalProps.emptyTip)===null||i===void 0||i.resetVisible()}addRecords(t,e){var i;g8t(t,e,this),(i=this.internalProps.emptyTip)===null||i===void 0||i.resetVisible()}deleteRecords(t){var e;p8t(t,this),(e=this.internalProps.emptyTip)===null||e===void 0||e.resetVisible()}updateRecords(t,e){v8t(t,e,this)}_hasCustomRenderOrLayout(){var t,e,i,r;const{headerObjects:o}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let s=0;s<o.length;s++){const a=o[s];if(!((t=a?.define)===null||t===void 0)&&t.customLayout||!((e=a?.define)===null||e===void 0)&&e.headerCustomLayout||!((i=a?.define)===null||i===void 0)&&i.customRender||!((r=a?.define)===null||r===void 0)&&r.headerCustomRender)return!0}return!1}getAggregateValuesByField(t){const e=this.internalProps.layoutMap.getColumnByField(t),i=[];for(let r=0;r<e.length;r++){const o=e[r].columnDefine.aggregator;if(delete e[r].columnDefine,o){const s={col:e[r].col,aggregateValue:null};if(s.aggregateValue=[],Array.isArray(o))for(let a=0;a<o.length;a++)s.aggregateValue.push({aggregationType:o[a].type,value:o[a].value()});else s.aggregateValue.push({aggregationType:o.type,value:o.value()});i.push(s)}}return i}isAggregation(t,e){return this.internalProps.layoutMap.isAggregation(t,e)}getGroupTitleLevel(t,e){var i;if(!this.internalProps.groupBy)return;const r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)),o=(i=this.dataSource.getGroupLength())!==null&&i!==void 0?i:0;let s=Mt(r)?r.length-1:0;return o>0&&s===o&&(s=void 0),s}getBodyRowIndexByRecordIndex(t){return Array.isArray(t)&&t.length===1&&(t=t[0]),this.dataSource.getTableIndex(t)}release(){var t;(t=this.editorManager)===null||t===void 0||t.release(),super.release()}expandAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&typeof this.dataSource.expandAllNodes=="function"&&(this.dataSource.expandAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(ot.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:Lt.expand,originData:{children:this.records}}))}collapseAllTreeNode(){if(!this._hasHierarchyTreeHeader())return;let t=!1;this.dataSource&&typeof this.dataSource.collapseAllNodes=="function"&&(this.dataSource.collapseAllNodes(),t=!0),t&&(this._recreateSceneForStateChange(),this.fireListeners(ot.TREE_HIERARCHY_STATE_CHANGE,{col:-1,row:-1,hierarchyState:Lt.collapse,originData:{children:this.records}}))}mergeCells(t,e,i,r){for(let o=t;o<=i;o++)for(let s=e;s<=r;s++){const a=this.getCellRange(o,s);if(a.start.col!==a.end.col||a.start.row!==a.end.row)return}this.options.customMergeCell?typeof this.options.customMergeCell=="function"&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell.push({text:this.getCellValue(t,e),range:{start:{col:t,row:e},end:{col:i,row:r}}}),this.internalProps.customMergeCell=zx(this.options.customMergeCell);for(let o=t;o<=i;o++)for(let s=e;s<=r;s++)this.scenegraph.updateCellContent(o,s);this.scenegraph.updateNextFrame()}unmergeCells(t,e,i,r){this.options.customMergeCell?typeof this.options.customMergeCell=="function"&&(this.options.customMergeCell=[]):this.options.customMergeCell=[],this.options.customMergeCell=this.options.customMergeCell.filter(o=>{const{start:s,end:a}=o.range;return!(s.col===t&&s.row===e&&a.col===i&&a.row===r)}),this.internalProps.customMergeCell=zx(this.options.customMergeCell);for(let o=t;o<=i;o++)for(let s=e;s<=r;s++)this.scenegraph.updateCellContent(o,s);this.scenegraph.updateNextFrame()}}function gE(n){return n==="bottom"||n==="top"}function b8t(n){return n==="left"||n==="right"}const sQ=(n,t)=>Object.prototype.toString.call(n)===`[object ${t}]`,_8t=n=>typeof n=="function",qn=n=>n==null,cn=n=>n!=null,aQ=n=>Array.isArray?Array.isArray(n):sQ(n,"Array"),Go=(n,t=!1)=>{const e=typeof n;return t?e==="number":e==="number"||sQ(n,"Number")};function C8t(n){if(!n)return[];if(Object.keys)return Object.keys(n);const t=[];for(const e in n)n.hasOwnProperty(e)&&t.push(e);return t}function w8t(n,t,e){const i=C8t(t);for(let r=0;r<i.length;r++){const o=i[r];(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}return n}function lQ(n,t,e=!0){if(n="prototype"in n?n.prototype:n,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){const i=Object.getOwnPropertyNames(t);for(let r=0;r<i.length;r++){const o=i[r];o!=="constructor"&&(e?t[o]!=null:n[o]==null)&&(n[o]=t[o])}}else w8t(n,t,e)}function x8t(n,t,e){cn(t)||(t=n,n=0),cn(e)||(e=1);let i=-1;const r=0|Math.max(0,Math.ceil((t-n)/e)),o=new Array(r);for(;++i<r;)o[i]=n+i*e;return o}function S8t(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function Qv(n){return Number(n)}function A8t(n,t,e=0,i){for(qn(i)&&(i=n.length);e<i;){const r=e+i>>>1;S8t(n[r],t)>0?i=r:e=r+1}return e}const T8t=1e-10,M8t=1e-10;function hQ(n,t,e=M8t,i=T8t){const r=i,o=e*Math.max(n,t);return Math.abs(n-t)<=Math.max(r,o)}function PG(n,t,e,i){return n>t&&!hQ(n,t,e,i)}function kG(n,t,e,i){return n<t&&!hQ(n,t,e,i)}const zy=n=>{let t=null,e=null;return(...i)=>(t&&i.every((r,o)=>r===t[o])||(t=i,e=n(...i)),e)},uQ=function(n,t,e){return n<t?t:n>e?e:n};function ND(n,t){let e;return n>t&&(e=n,n=t,t=e),i=>Math.max(n,Math.min(t,i))}function AC(n,t){return e=>n*(1-e)+t*e}function R8t(n,t){return function(e){return Math.round(n*(1-e)+t*e)}}function B8t(n,t){const e=n.valueOf(),i=t.valueOf(),r=new Date;return o=>(r.setTime(e*(1-o)+i*o),r)}function pE(n,t,e){t/=100,e/=100;const i=(1-Math.abs(2*e-1))*t,r=i*(1-Math.abs(n/60%2-1)),o=e-i/2;let s=0,a=0,l=0;return 0<=n&&n<60?(s=i,a=r,l=0):60<=n&&n<120?(s=r,a=i,l=0):120<=n&&n<180?(s=0,a=i,l=r):180<=n&&n<240?(s=0,a=r,l=i):240<=n&&n<300?(s=r,a=0,l=i):300<=n&&n<360&&(s=i,a=0,l=r),s=Math.round(255*(s+o)),a=Math.round(255*(a+o)),l=Math.round(255*(l+o)),{r:s,g:a,b:l}}function WD(n,t,e){n/=255,t/=255,e/=255;const i=Math.min(n,t,e),r=Math.max(n,t,e),o=r-i;let s=0,a=0,l=0;return s=o===0?0:r===n?(t-e)/o%6:r===t?(e-n)/o+2:(n-t)/o+4,s=Math.round(60*s),s<0&&(s+=360),l=(r+i)/2,a=o===0?0:o/(1-Math.abs(2*l-1)),a=+(100*a).toFixed(1),l=+(100*l).toFixed(1),{h:s,s:a,l}}const P8t=/^#([0-9a-f]{3,8})$/,EG={transparent:4294967040},TC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function F_(n){return((n=Math.max(0,Math.min(255,Math.round(n)||0)))<16?"0":"")+n.toString(16)}function dQ(n){return Go(n)?new Pr(n>>16,n>>8&255,255&n,1):aQ(n)?new Pr(n[0],n[1],n[2]):new Pr(255,255,255)}function k8t(n){return Go(n)?new Pr(n>>>24,n>>>16&255,n>>>8&255,255&n):aQ(n)?new Pr(n[0],n[1],n[2],n[3]):new Pr(255,255,255,1)}function b2(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function _2(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}const LG=(n,t)=>{const e=P8t.exec(n);if(t||e){const i=parseInt(e[1],16),r=e[1].length;return r===3?new Pr((i>>8&15)+((i>>8&15)<<4),(i>>4&15)+((i>>4&15)<<4),(15&i)+((15&i)<<4),1):r===6?dQ(i):r===8?new Pr(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):null}};class Ds{static Brighter(t,e=1){return e===1?t:new Ds(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return e===1?t:new Ds(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){const i=t instanceof Ds?t:new Ds(t);switch(e){case"hsv":default:return i.getHSVBrightness();case"hsl":return i.getHSLBrightness();case"lum":return i.getLuminance();case"lum2":return i.getLuminance2();case"lum3":return i.getLuminance3()}}static parseColorString(t){if(cn(EG[t]))return k8t(EG[t]);if(cn(TC[t]))return dQ(TC[t]);const e=`${t}`.trim().toLowerCase(),i=LG(e);if(i!==void 0)return i;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){const r=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Pr(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10),parseFloat(r[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){const r=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),o=pE(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10));return new Pr(o.r,o.g,o.b,parseFloat(r[3]))}}constructor(t){const e=Ds.parseColorString(t);e?this.color=e:this.color=new Pr(255,255,255)}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t))),this}add(t){const{r:e,g:i,b:r}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,i+t.color.g),this.color.b+=Math.min(255,r+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){const{r:e,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,i){const r=this.color.opacity,o=WD(this.color.r,this.color.g,this.color.b),s=pE(qn(t)?o.h:uQ(t,0,360),qn(e)?o.s:e>=0&&e<=1?100*e:e,qn(i)?o.l:i<=1&&i>=0?100*i:i);return this.color=new Pr(s.r,s.g,s.b,r),this}setRGB(t,e,i){return!qn(t)&&(this.color.r=t),!qn(e)&&(this.color.g=e),!qn(i)&&(this.color.b=i),this}setHex(t){const e=`${t}`.trim().toLowerCase(),i=LG(e,!0);return i??this}setColorName(t){const e=TC[t.toLowerCase()];return e!==void 0&&this.setHex(e),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}clone(){return new Ds(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){const i=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,i),this.color.g=Math.pow(t.color.g,i),this.color.b=Math.pow(t.color.b,i),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=b2(t.color.r),this.color.g=b2(t.color.g),this.color.b=b2(t.color.b),this}copyLinearToSRGB(t){return this.color.r=_2(t.color.r),this.color.g=_2(t.color.g),this.color.b=_2(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class Pr{constructor(t,e,i,r){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),cn(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return`#${F_(this.r)+F_(this.g)+F_(this.b)+(this.opacity===1?"":F_(255*this.opacity))}`}formatRgb(){const t=this.opacity;return`${t===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${t===1?")":`,${t})`}`}formatHsl(){const t=this.opacity,{h:e,s:i,l:r}=WD(this.r,this.g,this.b);return`${t===1?"hsl(":"hsla("}${e},${i}%,${r}%${t===1?")":`,${t})`}`}toString(){return this.formatHex()}}function E8t(n){let t="",e="",i="";const r=n[0]==="#"?1:0;for(let o=r;o<n.length;o++)n[o]!=="#"&&(o<r+2?t+=n[o]:o<r+4?e+=n[o]:o<r+6&&(i+=n[o]));return[parseInt(t,16),parseInt(e,16),parseInt(i,16)]}function L8t(n,t,e){return Number((1<<24)+(n<<16)+(t<<8)+e).toString(16).slice(1)}function O8t(n,t){const e=n.r,i=t.r,r=n.g,o=t.g,s=n.b,a=t.b,l=n.opacity,h=t.opacity;return u=>{const d=Math.round(e*(1-u)+i*u),c=Math.round(r*(1-u)+o*u),f=Math.round(s*(1-u)+a*u);return new Pr(d,c,f,l*(1-u)+h*u)}}const D8t=Object.freeze(Object.defineProperty({__proto__:null,Color:Ds,DEFAULT_COLORS:TC,RGB:Pr,hexToRgb:E8t,hslToRgb:pE,interpolateRgb:O8t,rgbToHex:L8t,rgbToHsl:WD},Symbol.toStringTag,{value:"Module"}));var Kl;(function(n){n.Identity="identity",n.Linear="linear",n.Log="log",n.Pow="pow",n.Sqrt="sqrt",n.Symlog="symlog",n.Time="time",n.Quantile="quantile",n.Quantize="quantize",n.Threshold="threshold",n.Ordinal="ordinal",n.Point="point",n.Band="band"})(Kl||(Kl={}));Object.values(Kl).forEach(n=>{});function Cf(n){return n}const I8t=n=>-Math.log(-n),H8t=n=>-Math.exp(-n),F8t=n=>isFinite(n)?Math.pow(10,n):n<0?0:n,OG=n=>n===10?F8t:n===Math.E?Math.exp:t=>Math.pow(n,t),DG=n=>n===Math.E?Math.log:n===10?Math.log10:n===2?Math.log2:(n=Math.log(n),t=>Math.log(t)/n),IG=n=>t=>Math.sign(t)*Math.log1p(Math.abs(t/n)),HG=n=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*n;function vE(n,t){if(n=Number(n),t=Number(t),t-=n)return i=>(i-n)/t;const e=Number.isNaN(t)?NaN:.5;return()=>e}function FG(n,t,e){const i=n[0],r=n[1],o=t[0],s=t[1];let a,l;return r<i?(a=vE(r,i),l=e(s,o)):(a=vE(i,r),l=e(o,s)),h=>l(a(h))}function VD(n,t,e){let i;return i=n===1?n+2*e:n-t+2*e,n?i>0?i:1:0}function z8t(n,t,e,i){return e===1&&(e=0),VD(n,e,i)*(t/(1-e))}function N8t(n,t,e,i,r){const o=VD(n,e,i);let s=t/Math.max(1,o||1);r&&(s=Math.floor(s));let a=s*(1-e);return r&&(a=Math.round(a)),a}function cQ(n,t){const e=(n[1]-n[0])/(t[1]-t[0]),i=n[0]-e*t[0];return[i,e+i]}function W8t(n,t,e){const i=Math.min(n.length,t.length)-1,r=new Array(i),o=new Array(i);let s=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=vE(n[s],n[s+1]),o[s]=e(t[s],t[s+1]);return function(a){const l=A8t(n,a,1,i)-1;return o[l](r[l](a))}}const V8t=(n,t)=>{const e=n.slice();let i=0,r=e.length-1,o=e[i],s=e[r];return s<o&&([i,r]=[r,i],[o,s]=[s,o]),e[i]=t.floor(o),e[r]=t.ceil(s),e},fQ=(n,t=!1)=>{const e=Math.floor(Math.log10(n)),i=n/Math.pow(10,e);let r;return r=t?i<1.5?1:i<3?2:i<7?5:10:i<=1?1:i<=2?2:i<=5?5:10,r*Math.pow(10,e)},G8t=(n,t)=>{let e,i;return t[0]<t[1]?(e=t[0],i=t[1]):(e=t[1],i=t[0]),Math.min(Math.max(n,e),i)};class gQ{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)&&t.length===2?(this._wholeRange=cQ(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,i){return t?(t.length===2&&t.every(r=>r>=0&&r<=1)&&(this._wholeRange=null,t[0]===0&&t[1]===1?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):i?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var i;return qn(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!qn(this._rangeFactorEnd)&&this._rangeFactorEnd!==1?(this._rangeFactorStart=t,this._rangeFactorEnd=(i=this._rangeFactorEnd)!==null&&i!==void 0?i:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}rangeFactorEnd(t,e){var i;return qn(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!qn(this._rangeFactorStart)&&this._rangeFactorStart!==0?(this._rangeFactorEnd=t,this._rangeFactorStart=(i=this._rangeFactorStart)!==null&&i!==void 0?i:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);const{distortion:e=2,radiusRatio:i=.1,radius:r}=this._fishEyeOptions,o=this.range(),s=o[0],a=o[o.length-1],l=Math.min(s,a),h=Math.max(s,a),u=uQ((t=this._fishEyeOptions.focus)!==null&&t!==void 0?t:0,l,h),d=qn(r)?(h-l)*i:r;let c=Math.exp(e);c=c/(c-1)*d;const f=e/d;this._fishEyeTransform=g=>{const p=Math.abs(g-u);if(p>=d)return g;if(p<=1e-6)return u;const v=c*(1-Math.exp(-p*f))/p*.75+.25;return u+(g-u)*v}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var i;return(i=this==null?void 0:this[t])!==null&&i!==void 0?i:e}}const mE=Symbol("implicit");class GD extends gQ{specified(t){var e;return t?(this._specified=Object.assign((e=this._specified)!==null&&e!==void 0?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=Kl.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=mE}clone(){const t=new GD().domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){const e=`${t}`,i=this._getSpecifiedValue(e);if(i!==void 0)return i;let r=this._index.get(e);if(!r){if(this._unknown!==mE)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}const o=this._ordinalRange[(r-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(o):o}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;for(const e of t){const i=`${e}`;this._index.has(i)||this._index.set(i,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();const e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&(e=this._index.get(`${t}`))!==null&&e!==void 0?e:-1}}function pQ(n,t,e,i){const r=[];let o=n;for(;o<=t;)r.push(o),o+=e;return i&&r.reverse(),r}function zG(n,t,e,i){let r,o;if(t=Math.floor(+t),n=Math.floor(+n),!(e=Math.floor(+e)))return[];if(n===t)return[n];if(r=t<n){const a=n;n=t,t=a}let s=ND(1,t-n+1)(e);if(o=Math.floor((t-n+1)/s),!i)for(;Math.ceil((t-n+1)/o)>e&&s>1;)s-=1,o=Math.floor((t-n)/s);return pQ(n,t,o,r)}function $8t(n,t,e){let i;if(t=Math.floor(+t),n=Math.floor(+n),e=ND(1,t-n+1)(Math.floor(+e)),i=t<n){const r=n;n=t,t=r}return pQ(n,t,e,i)}class zA extends GD{constructor(t){super(),this.type=Kl.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;const i=this._calculateWholeRange(this._range,e),r=super.domain().length,o=i[1]<i[0];let s=i[Number(o)-0];const a=i[1-Number(o)],l=VD(r,this._paddingInner,this._paddingOuter);return this._step=(a-s)/Math.max(1,l||1),this._round&&(this._step=Math.floor(this._step)),s+=(a-s-this._step*(r-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(s=Math.round(s),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:o,start:o?s+this._step*(r-1):s,count:r},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;const e=`${t}`,i=this._getSpecifiedValue(e);if(i!==void 0)return i;let r=this._index.get(e);if(!r){if(this._unknown!==mE)return this._unknown;r=this._domain.push(t),this._index.set(e,r)}const{count:o,start:s,reverse:a}=this._bandRangeState,l=s+(a?-1:1)*((r-1)%o)*this._step;return this._fishEyeTransform?this._fishEyeTransform(l):l}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){let i;if(cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)&&t.length===2){const o=cQ(t,[this._rangeFactorStart,this._rangeFactorEnd]);i=Math.abs(o[1]-o[0])}else i=Math.abs(t[1]-t[0]);const r=N8t(super.domain().length,i,this._paddingInner,this._paddingOuter,this._round);r<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):r>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=r,this._isFixed=!1)}if(this.isBandwidthFixed()){const i=z8t(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),r=Math.min((t[1]-t[0])/i,1);if(cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)){if(i>0){const a=t[0]-i*this._rangeFactorStart,l=a+i;this._wholeRange=[a,l]}else{const a=t[1]+i*(1-this._rangeFactorEnd),l=a-i;this._wholeRange=[l,a]}const o=this._rangeFactorStart+r<=1,s=this._rangeFactorEnd-r>=0;e==="rangeFactorStart"&&o?this._rangeFactorEnd=this._rangeFactorStart+r:e==="rangeFactorEnd"&&s?this._rangeFactorStart=this._rangeFactorEnd-r:t[0]<=t[1]?o?this._rangeFactorEnd=this._rangeFactorStart+r:s?this._rangeFactorStart=this._rangeFactorEnd-r:(this._rangeFactorStart=0,this._rangeFactorEnd=r):s?this._rangeFactorStart=this._rangeFactorEnd-r:o?this._rangeFactorEnd=this._rangeFactorStart+r:(this._rangeFactorStart=1-r,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=r,this._wholeRange=[t[0],t[0]+i];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){const t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){const e=this._domain;if(cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)&&e.length){const i=this._getInvertIndex(t[0]),r=this._getInvertIndex(t[1]);return e.slice(Math.min(i,r),Math.max(i,r)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[Qv(t[0]),Qv(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[Qv(t[0]),Qv(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return t===-1?e:zG(0,e.length-1,t,!1).map(i=>e[i])}tickData(t=10){return this.ticks(t).map((e,i)=>({index:i,tick:e,value:(this.scale(e)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return zG(0,e.length-1,t,!0).filter(i=>i<e.length).map(i=>e[i])}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return $8t(0,e.length-1,t).map(i=>e[i])}_getInvertIndex(t){let e=0;const i=this.step()/2,r=this.bandwidth()/2,o=this._domain.length,s=this.range(),a=s[0]>s[s.length-1];for(e=0;e<o;e++){const l=this.scale(this._domain[e])+r;if(e===0&&(!a&&!PG(t,l+i)||a&&!kG(t,l-i))||e===o-1||!kG(t,l-i)&&!PG(t,l+i))break}return e>=0&&e<=o-1?e:o-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return t!==void 0?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return t!==void 0?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return t!==void 0?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return t!==void 0?(this._round=t,this.rescale(e)):this._round}align(t,e){return t!==void 0?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return qn(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return qn(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?(t==="auto"?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth=t==="auto"?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth=t==="auto"?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&Go(this._userBandwidth)}clone(){var t,e,i;return new zA(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth((t=this._userBandwidth)!==null&&t!==void 0?t:"auto",!0).maxBandwidth((e=this._maxBandwidth)!==null&&e!==void 0?e:"auto",!0).minBandwidth((i=this._maxBandwidth)!==null&&i!==void 0?i:"auto")}}const{interpolateRgb:C2}=D8t;function j8t(n,t){const e=typeof t;let i;if(qn(t)||e==="boolean")return()=>t;if(e==="number")return AC(n,t);if(e==="string"){if(i=Ds.parseColorString(t)){const r=C2(Ds.parseColorString(n),i);return o=>r(o).formatRgb()}return AC(Number(n),Number(t))}return t instanceof Pr?C2(n,t):t instanceof Ds?C2(n.color,t.color):t instanceof Date?B8t(n,t):AC(Number(n),Number(t))}class vQ extends gQ{constructor(t=Cf,e=Cf){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=Cf,this._piecewise=FG,this._interpolate=j8t}calculateVisibleDomain(t){var e;return cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:(e=this._niceDomain)!==null&&e!==void 0?e:this._domain}fishEye(t,e,i){return t||i?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const i=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(i):i}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),AC)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var i;if(!t)return((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;const r=Array.from(t,Qv);return this._domain=r,this.rescale(e)}range(t,e){if(!t)return this._range.slice();const i=Array.from(t);return this._range=i,this.rescale(e)}rangeRound(t,e){const i=Array.from(t);return this._range=i,this._interpolate=R8t,this.rescale(e)}rescale(t){var e;if(t)return this;const i=(e=this._niceDomain)!==null&&e!==void 0?e:this._domain,r=i.length,o=this._range.length;let s=Math.min(r,o);if(r&&r<o&&this._forceAlign){const a=o-r+1,l=i[r-1],h=r>=2?(l-i[r-2])/a:0;for(let u=1;u<=a;u++)i[r-2+u]=l-h*(a-u);s=o}return this._autoClamp&&(this._clamp=ND(i[0],i[s-1])),this._piecewise=s>2?W8t:FG,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,i){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:Cf),this.rescale(i)):this._clamp!==Cf}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){const e=this.ticks(t);return(e??[]).map((i,r)=>({index:r,tick:i,value:(this.scale(i)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return qn(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return qn(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}const U8t=Math.sqrt(50),X8t=Math.sqrt(10),Y8t=Math.sqrt(2),z_=[1,2,5,10],NG=(n,t,e)=>{let i=1,r=n;const o=Math.floor((t-1)/2),s=Math.abs(n);return n>=0&&n<=Number.MIN_VALUE?r=0:n<0&&n>=-Number.MIN_VALUE?r=-(t-1):!e&&s<1?i=mQ(s).step:(e||s>1)&&(r=Math.floor(n)-o*i),i>0?(n>0?r=Math.max(r,0):n<0&&(r=Math.min(r,-(t-1)*i)),x8t(0,t).map(a=>r+a*i)):n>0?Gx(0,-(t-1)/i,i):Gx((t-1)/i,0,i)},K8t=zy((n,t,e,i)=>{let r,o,s,a,l=-1;if(e=+e,(n=+n)==(t=+t))return[n];if(Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return[n];if((r=t<n)&&(o=n,n=t,t=o),a=$D(n,t,e).step,!isFinite(a))return[];if(a>0){let h=Math.round(n/a),u=Math.round(t/a);for(h*a<n&&++h,u*a>t&&--u,s=new Array(o=u-h+1);++l<o;)s[l]=(h+l)*a}else if(a<0&&i?.noDecimals){a=1;const h=Math.ceil(n),u=Math.floor(t);if(!(h<=u))return[];for(s=new Array(o=u-h+1);++l<o;)s[l]=h+l}else{a=-a;let h=Math.round(n*a),u=Math.round(t*a);for(h/a<n&&++h,u/a>t&&--u,s=new Array(o=u-h+1);++l<o;)s[l]=(h+l)/a}return r&&s.reverse(),s}),Gx=(n,t,e)=>{let i,r,o=-1;if(e>0){let s=Math.floor(n/e),a=Math.ceil(t/e);for((s+1)*e<n&&++s,(a-1)*e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)*e}else{e=-e;let s=Math.floor(n*e),a=Math.ceil(t*e);for((s+1)/e<n&&++s,(a-1)/e>t&&--a,r=new Array(i=a-s+1);++o<i;)r[o]=(s+o)/e}return r},q8t=(n,t,e)=>{let i;const r=n[0],o=n[n.length-1],s=t-n.length;if(o<=0){const h=[];for(i=s;i>=1;i--)h.push(r-i*e);return h.concat(n)}if(r>=0){for(i=1;i<=s;i++)n.push(o+i*e);return n}let a=[];const l=[];for(i=1;i<=s;i++)i%2==0?a=[r-Math.floor(i/2)*e].concat(a):l.push(o+Math.ceil(i/2)*e);return a.concat(n).concat(l)},$x=zy((n,t,e,i)=>{let r,o,s;if(e=+e,(n=+n)==(t=+t)||Math.abs(n-t)<=Number.MIN_VALUE&&e>0)return NG(n,e,i?.noDecimals);(r=t<n)&&(s=n,n=t,t=s);const a=$D(n,t,e);let l=a.step;if(!isFinite(l))return[];if(l>0){let h=1;const{power:u,gap:d}=a,c=d===10?2*10**u:1*10**u;for(;h<=5&&(o=Gx(n,t,l),o.length>e+1)&&e>2;)l+=c,h+=1;e>2&&o.length<e-1&&(o=q8t(o,e,l))}else i?.noDecimals&&l<0&&(l=1),o=Gx(n,t,l);return r&&o.reverse(),o}),mQ=n=>{const t=Math.floor(Math.log(n)/Math.LN10),e=n/10**t;let i=z_[0];return e>=U8t?i=z_[3]:e>=X8t?i=z_[2]:e>=Y8t&&(i=z_[1]),t>=0?{step:i*10**t,gap:i,power:t}:{step:-(10**-t)/i,gap:i,power:t}};function $D(n,t,e){const i=(t-n)/Math.max(0,e);return mQ(i)}function yQ(n,t,e){let i;if(e=+e,(n=+n)==(t=+t)&&e>0)return[n];if(e<=0||(i=Z8t(n,t,e))===0||!isFinite(i))return[];const r=new Array(e);for(let o=0;o<e;o++)r[o]=n+o*i;return r}function Z8t(n,t,e){return(t-n)/Math.max(1,e-1)}function J8t(n,t,e){let i,r,o=-1;if(e=+e,(r=(t=+t)<(n=+n))&&(i=n,n=t,t=i),!isFinite(e)||t-n<=e)return[n];const s=Math.floor((t-n)/e+1),a=new Array(s);for(;++o<s;)a[o]=n+o*e;return r&&a.reverse(),a}function w2(n,t=10){let e,i,r=0,o=n.length-1,s=n[r],a=n[o],l=10;for(a<s&&(i=s,s=a,a=i,i=r,r=o,o=i);l-- >0;){if(i=$D(s,a,t).step,i===e)return n[r]=s,n[o]=a,n;if(i>0)s=Math.floor(s/i)*i,a=Math.ceil(a/i)*i;else{if(!(i<0))break;s=Math.ceil(s*i)/i,a=Math.floor(a*i)/i}e=i}}function bQ(n,t){const e=Go(t.forceMin),i=Go(t.forceMax);let r=null;const o=[];let s=null;const a=e&&i?l=>l>=t.forceMin&&l<=t.forceMax:e?l=>l>=t.forceMin:i?l=>l<=t.forceMax:null;return e?o[0]=t.forceMin:Go(t.min)&&t.min<=Math.min(n[0],n[n.length-1])&&(o[0]=t.min),i?o[1]=t.forceMax:Go(t.max)&&t.max>=Math.max(n[0],n[n.length-1])&&(o[1]=t.max),Go(o[0])&&Go(o[1])?(s=n.slice(),s[0]=o[0],s[s.length-1]=o[1]):r=Go(o[0])||Go(o[1])?Go(o[0])?"max":"min":"all",{niceType:r,niceDomain:s,niceMinMax:o,domainValidator:a}}const x2=(n,t,e)=>Math.abs(t-n)<1?+e.toFixed(1):Math.round(+e),_Q=zy((n,t,e,i,r,o,s)=>{let a=n,l=t;const h=l<a;h&&([a,l]=[l,a]);let u,d,c=r(a),f=r(l),g=[];if(!(i%1)&&f-c<e){if(c=Math.floor(c),f=Math.ceil(f),a>0){for(;c<=f;++c)for(u=1;u<i;++u)if(d=c<0?u/o(-c):u*o(c),!(d<a)){if(d>l)break;g.push(d)}}else for(;c<=f;++c)for(u=i-1;u>=1;--u)if(d=c>0?u/o(-c):u*o(c),!(d<a)){if(d>l)break;g.push(d)}2*g.length<e&&(g=$x(a,l,e))}else g=$x(c,f,Math.min(f-c,e)).map(o);return g=g.filter(p=>p!==0),s?.noDecimals&&(g=Array.from(new Set(g.map(p=>Math.floor(p))))),h?g.reverse():g}),CQ=zy((n,t,e,i,r,o)=>{const s=[],a={},l=r(n),h=r(t);let u=[];if(Number.isInteger(i))u=$x(l,h,e);else{const d=(h-l)/(e-1);for(let c=0;c<e;c++)u.push(l+c*d)}return u.forEach(d=>{const c=o(d),f=Number.isInteger(i)?x2(n,t,c):x2(n,t,fQ(c)),g=x2(n,t,G8t(f,[n,t]));!a[g]&&!isNaN(g)&&u.length>1&&(a[g]=1,s.push(g))}),s}),jx=zy((n,t,e,i,r)=>yQ(i(n),i(t),e).map(o=>fQ(r(o))));class Hp extends vQ{constructor(){super(...arguments),this.type=Kl.Linear}clone(){return new Hp().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(t=10,e){const i=this.calculateVisibleDomain(this._range);return K8t(i[0],i[i.length-1],t,e)}ticks(t=10,e){var i;if(_8t(e?.customTicks))return e.customTicks(this,t);if(cn(this._rangeFactorStart)&&cn(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&this._range.length===2||!this._niceType)return this.d3Ticks(t,e);const r=(i=this._niceDomain)!==null&&i!==void 0?i:this._domain,o=this._domain,s=r[0],a=r[r.length-1];let l=$x(o[0],o[o.length-1],t,e);if(!l.length)return l;if(this._domainValidator)l=l.filter(this._domainValidator);else if((l[0]!==s||l[l.length-1]!==a)&&this._niceType){const h=r.slice();if(this._niceType==="all"?(h[0]=l[0],h[h.length-1]=l[l.length-1],this._niceDomain=h,this.rescale()):this._niceType==="min"&&l[0]!==s?(h[0]=l[0],this._niceDomain=h,this.rescale()):this._niceType==="max"&&l[l.length-1]!==a&&(h[h.length-1]=l[l.length-1],this._niceDomain=h,this.rescale()),this._niceType!=="all"){const u=Math.min(h[0],h[h.length-1]),d=Math.max(h[0],h[h.length-1]);l=l.filter(c=>c>=u&&c<=d)}}return l}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return yQ(e[0],e[e.length-1],t)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return J8t(e[0],e[e.length-1],t)}nice(t=10,e){var i,r;const o=this._domain;let s=[];if(e){const a=bQ(o,e);if(s=a.niceMinMax,this._domainValidator=a.domainValidator,this._niceType=a.niceType,a.niceDomain)return this._niceDomain=a.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){const a=w2(o.slice(),t);this._niceType==="min"?a[a.length-1]=(i=s[1])!==null&&i!==void 0?i:a[a.length-1]:this._niceType==="max"&&(a[0]=(r=s[0])!==null&&r!==void 0?r:a[0]),this._niceDomain=a,this.rescale()}return this}niceMin(t=10){this._niceType="min";const e=this._domain[this._domain.length-1],i=w2(this.domain(),t);return i&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(t=10){this._niceType="max";const e=this._domain[0],i=w2(this._domain.slice(),t);return i&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}class wQ{nice(t=10,e){var i,r,o,s;const a=this._domain;let l=[],h=null;if(e){const u=bQ(a,e);if(l=u.niceMinMax,this._domainValidator=u.domainValidator,h=u.niceType,u.niceDomain)return this._niceDomain=u.niceDomain,this.rescale(),this}else h="all";if(h){const u=V8t(a.slice(),(r=(i=this.getNiceConfig)===null||i===void 0?void 0:i.call(this))!==null&&r!==void 0?r:{floor:d=>Math.floor(d),ceil:d=>Math.ceil(d)});return h==="min"?u[u.length-1]=(o=l[1])!==null&&o!==void 0?o:u[u.length-1]:h==="max"&&(u[0]=(s=l[0])!==null&&s!==void 0?s:u[0]),this._niceDomain=u,this.rescale(),this}return this}niceMin(){const t=this._domain[this._domain.length-1];this.nice();const e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){const t=this._domain[0];this.nice();const e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}function WG(n){return t=>-n(-t)}function VG(n=Number.EPSILON){return t=>Math.max(t,n)}function Q8t(n=Number.EPSILON){return t=>Math.min(t,-n)}class Ny extends vQ{constructor(){super(DG(10),OG(10)),this.type=Kl.Log,this._limit=VG(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return new Ny().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e;if(t)return this;super.rescale();const i=DG(this._base),r=OG(this._base);return((e=this._niceDomain)!==null&&e!==void 0?e:this._domain)[0]<0?(this._logs=WG(i),this._pows=WG(r),this._limit=Q8t(),this.transformer=I8t,this.untransformer=H8t):(this._logs=i,this._pows=r,this._limit=VG(),this.transformer=this._logs,this.untransformer=r),this}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const i=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(i):i}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return Cf}d3Ticks(t=10,e){const i=this.domain(),r=this._limit(i[0]),o=this._limit(i[i.length-1]);return _Q(r,o,t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return CQ(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return jx(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return jx(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}lQ(Ny,wQ);class t9t extends zA{constructor(t){super(!1),this.type=Kl.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}}class Wy extends Hp{constructor(){super(IG(1),HG(1)),this.type=Kl.Symlog,this._const=1}clone(){return new Wy().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=IG(t),this.untransformer=HG(t),this.rescale(e)):this._const}d3Ticks(t=10,e){const i=this.domain(),r=i[0],o=i[i.length-1];return _Q(r,o,t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return CQ(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return jx(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return jx(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}lQ(Wy,wQ);class e9t{constructor(){this._scale=new zA,this._scales=[this._scale]}valueToPosition(t){return this._scale.scale(t)}getPosition(t){let e=0,i=this._scale;if(this._scales.length===1||t.length===1)e=this.valueToPosition(t[0]);else{const r=Math.min(t.length,this._scales.length);for(let o=0;o<r;o++)e+=this._scales[o].scale(t[o]);i=this._scales[r-1]}return{position:e,bandScale:i}}calcScales(t,e){var i,r;const{bandPadding:o,paddingInner:s,paddingOuter:a}=this,l=Mt(o),h=Mt(s),u=Mt(a);for(let d=0;d<this._scales.length;d++){const c=l?o[d]:o,f=h?s[d]:s,g=u?a[d]:a;this._scales[d].paddingInner((i=f??c)!==null&&i!==void 0?i:t,!0).paddingOuter((r=g??c)!==null&&r!==void 0?r:e)}}dataToPosition(t,e={}){var i;if(t.length===0||this._scales.length===0)return 0;const{position:r,bandScale:o}=this.getPosition(t);return r+o.bandwidth()*((i=e.bandPosition)!==null&&i!==void 0?i:.5)}updateScaleDomain(t){for(let e=0;e<this._scales.length;e++)this._scales[e].domain(t)}updateRange(t){const[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}function i9t(n,t,e){n.getTransform(t)||n.registerTransform(t,e)}function n9t(n,t,e){n.getParser(t)||n.registerParser(t,e)}const r9t=Math.sqrt(50),o9t=Math.sqrt(10),s9t=Math.sqrt(2);class a9t{constructor(t){this._extend={},this.type=t??"linear",this._scale=t==="log"?new Ny:t==="symlog"?new Wy:new Hp,this._scales=[this._scale]}setExtraAttrFromSpec(t,e,i,r,o,s){this.nice=!1,this.zero=e,this.zero&&(i.min=Math.min(i.min,0),i.max=Math.max(i.max,0)),this.domain=i,this.expand=r,this.type==="log"?this._scale.base(o??10):this.type==="symlog"&&this._scale.constant(s??10)}transformScaleDomain(){this.type==="symlog"||this.type==="log"||this.setScaleNice()}setScaleNice(){this.type==="log"?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var t,e,i,r,o,s;Pe((t=this.domain)===null||t===void 0?void 0:t.min)&&Pe((e=this.domain)===null||e===void 0?void 0:e.max)?this.nice&&this._scale.nice():Y((i=this.domain)===null||i===void 0?void 0:i.min)&&Pe((r=this.domain)===null||r===void 0?void 0:r.max)?this.nice&&this._scale.niceMax():Pe((o=this.domain)===null||o===void 0?void 0:o.min)&&Y((s=this.domain)===null||s===void 0?void 0:s.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var t,e,i,r,o,s,a,l;let h=(e=(t=this.forceTickCount)!==null&&t!==void 0?t:this.tickCount)!==null&&e!==void 0?e:10;this.niceType==="accurateFirst"&&(h=Math.max(10,h)),Pe((i=this.domain)===null||i===void 0?void 0:i.min)&&Pe((r=this.domain)===null||r===void 0?void 0:r.max)?this.nice&&this._scale.nice(h):Y((o=this.domain)===null||o===void 0?void 0:o.min)&&Pe((s=this.domain)===null||s===void 0?void 0:s.max)?this.nice&&this._scale.niceMax(h):Pe((a=this.domain)===null||a===void 0?void 0:a.min)&&Y((l=this.domain)===null||l===void 0?void 0:l.max)?this.nice&&this._scale.niceMin(h):this.nice&&this._scale.nice(h)}dataToPosition(t){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){const e=[];return t.forEach(i=>{const{min:r,max:o}=i;e[0]=e[0]===void 0?r:Math.min(e[0],r),e[1]=e[1]===void 0?o:Math.max(e[1],o)}),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this.expand)return;const e=t[0],i=t[t.length-1];Y(this.expand.min)&&(t[0]=e-(i-e)*this.expand.min),Y(this.expand.max)&&(t[t.length-1]=i+(i-e)*this.expand.max)}niceDomain(t){if(Y(t[0])||Y(t[1])||this.type!=="linear")return t;if(Math.abs(jIt(t)-$It(t))<=1e-12){let e=t[0];const i=e>=0?1:-1;if(e=Math.abs(e),e<1)t[0]=0,t[1]=1;else{let r=e/5;const o=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,o);r=(s>=r9t?10:s>=o9t?5:s>=s9t?2:1)*Math.pow(10,o),t[0]=0,t[1]=10*r}i<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t}niceMinMax(){var t,e,i,r,o,s,a,l;if(this.nice){let h=(e=(t=this.forceTickCount)!==null&&t!==void 0?t:this.tickCount)!==null&&e!==void 0?e:10;this.niceType==="accurateFirst"&&(h=Math.max(10,h)),Pe((i=this.domain)===null||i===void 0?void 0:i.min)&&Pe((r=this.domain)===null||r===void 0?void 0:r.max)?this._scale.nice(h):Y((o=this.domain)===null||o===void 0?void 0:o.min)&&Pe((s=this.domain)===null||s===void 0?void 0:s.max)?this._scale.niceMax(h):Pe((a=this.domain)===null||a===void 0?void 0:a.min)&&Y((l=this.domain)===null||l===void 0?void 0:l.max)?this._scale.niceMin(h):this._scale.nice(h)}}includeZero(t){this.zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))}setExtendDomain(t,e){if(e===void 0)return void delete this._extend[t];this._extend[t]=e;const i=this._scale.domain();this.extendDomain(i),this.includeZero(i),this.setDomainMinMax(i),this.niceDomain(i),this._scale.domain(i,this.nice),this.niceMinMax()}extendDomain(t){let e;const i=t.length-1,r=t[0]-t[i]>0,o=r?i:0,s=r?0:i;for(const a in this._extend)e=this._extend[a],e>t[s]&&(t[s]=e),e<t[o]&&(t[o]=e)}setDomainMinMax(t){if(!this.domain)return;const{min:e,max:i}=this.domain;Y(e)&&(t[0]=e),Y(i)&&(t[1]=i)}setZero(t){this.zero!==t&&(this.zero=t,this.updateScaleDomain())}updateScaleDomain(){const t=this.computeDomain([this.domain]);this.updateScaleDomainByModel(t)}computeDomain(t){return this.computeLinearDomain(t)}updateScaleDomainByModel(t){t=t??this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this.nice),this.niceMinMax()}updateRange(t){const[e,i]=this._scale.range();t[0]===e&&t[1]===i||this._scale.range(t)}}function l9t(n,t){const e=n.find(r=>r.name==="axis-label-container-layer-0",!0),i=n.find(r=>r.name==="axis-label-container-layer-1",!0);GG(e?e.getChildren():[],t),GG(i?i.getChildren():[],t)}function h9t(n,t){const{width:e,height:i}=t.getLayoutRect(),r=gE(t.orient),o=t.option.inverse===!0,s=n[0],a=GIt(n);if(r)if(o){const l=e,h=0,u=s.AABBBounds.x2,d=a.AABBBounds.x1;u>l&&s.setAttributes({x:l,textAlign:"right"}),d<h&&a.setAttributes({x:h,textAlign:"left"})}else{const h=e,u=s.AABBBounds.x1,d=a.AABBBounds.x2;u<0&&s.setAttributes({x:0,textAlign:"left"}),d>h&&a.setAttributes({x:h,textAlign:"right"})}else if(o){const l=s.AABBBounds.y1,h=a.AABBBounds.y2,u=0,d=i;l<u&&s.setAttributes({y:u,textBaseline:"top"}),h>d&&a.setAttributes({y:d,textBaseline:"bottom"})}else{const l=i,h=0,u=s.AABBBounds.y2,d=a.AABBBounds.y1;u>l&&s.setAttributes({y:l,textBaseline:"bottom"}),d<h&&a.setAttributes({y:h,textBaseline:"top"})}}function GG(n,t){var e;const i=t.option;Jn(n)||!((e=i?.label)===null||e===void 0)&&e.flush&&h9t(n,t)}const u9t=n=>n;class d9t{constructor(t,e,i,r,o){var s,a,l;this.x=0,this.y=0,this.padding=r,this.table=o,this.orient=(s=t.orient)!==null&&s!==void 0?s:"left",this.type=(a=t.type)!==null&&a!==void 0?a:"band",this.option=Ue({},e8t(t.__vtableChartTheme),c9t(this.orient,o.theme),f9t(this.orient,this.type,t.__vtableChartTheme),t),this.orient==="left"||this.orient==="right"?(this.width=e,this.height=i-r[0]-r[2]-0,this.y=r[0]+0):(this.orient==="top"||this.orient==="bottom")&&(this.width=e-r[1]-r[3]-0,this.height=i,this.x=r[3]+0),this.visible=(l=t.visible)===null||l===void 0||l,this.inverse="inverse"in t&&!!t.inverse,t.type==="band"&&(this.data=t.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){const t=this.option;this.type==="band"||this.type==="point"?(this.scale=new e9t,this.scale.bandPadding=t.bandPadding,this.scale.paddingInner=t.paddingInner,this.scale.paddingOuter=t.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):this.type!=="linear"&&this.type!=="time"&&this.type!=="log"&&this.type!=="symlog"||(this.scale=new a9t(this.type),this.scale.setExtraAttrFromSpec(t.nice,t.zero,t.range,t.expand,t.base,t.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){this.table._vDataSet||(this.table._vDataSet=new ZGt),n9t(this.table._vDataSet,"scale",u9t),i9t(this.table._vDataSet,"ticks",uIt);const t=this.option.label||{},e=this.option.tick||{},i=new nQ(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:this.option.sampling!==!1,tickCount:e.tickCount,forceTickCount:e.forceTickCount,tickStep:e.tickStep,tickMode:e.tickMode,noDecimals:e.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:t.style,labelFormatter:t.formatMethod,labelGap:t.minGap,labelLastVisible:t.lastVisible,labelFlush:t.flush}},!1);this.tickData=i,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){const t=TG(this.option),e=this.getUpdateAttribute();e.verticalFactor=this.orient==="top"||this.orient==="right"?-1:1,this.component=new Vm(Ue({disableTriggerEvent:this.table.options.disableInteraction},t,e)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(t,e){this.width=t-(this.orient==="top"||this.orient==="bottom"?this.padding[1]+this.padding[3]:0),this.height=e-(this.orient==="left"||this.orient==="right"?this.padding[2]+this.padding[0]:0),this.updateScaleRange(),this.computeData();const i=TG(this.option),r=this.getUpdateAttribute();r.verticalFactor=this.orient==="top"||this.orient==="right"?-1:1,this.component.setAttributes(Ue({},i,r)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){l9t(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;const{width:t,height:e}=this.getLayoutRect(),i=gE(this.orient),r=b8t(this.orient);let o={x:0,y:0},s=0;i?(o={x:t,y:0},s=t):r&&(o={x:0,y:e},s=e);const a=this.orient==="top"||this.orient==="bottom"?e:t;return{start:{x:0,y:0},end:o,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(i)},items:this.getLabelItems(s),verticalLimitSize:a,verticalMinSize:a}}getLabelItems(t){return[this.tickData.latestData.map(e=>({id:e.value,label:e.value,value:t===0?0:this.scale.dataToPosition([e.value])/t,rawValue:e.value})).filter(e=>e.value>=0&&e.value<=1)]}updateScaleRange(){var t,e,i,r,o,s,a,l;const h=(e=(t=this.option.innerOffset)===null||t===void 0?void 0:t.right)!==null&&e!==void 0?e:0,u=(r=(i=this.option.innerOffset)===null||i===void 0?void 0:i.left)!==null&&r!==void 0?r:0,d=(s=(o=this.option.innerOffset)===null||o===void 0?void 0:o.top)!==null&&s!==void 0?s:0,c=(l=(a=this.option.innerOffset)===null||a===void 0?void 0:a.bottom)!==null&&l!==void 0?l:0,{width:f,height:g}=this.getLayoutRect(),p=this.option.inverse||!1;let v=[0,0];gE(this.orient)?Dd(f)&&(v=p?[f-h,u]:[u,f-h]):Dd(g)&&(v=p?[d,g-c]:[g-c,d]),this.scale.updateRange(v)}setLayoutStartPosition(t){let{x:e,y:i}=t;return Dd(e)&&(e+=+(this.orient==="left")*this.getLayoutRect().width),Dd(i)&&(i+=+(this.orient==="top")*this.getLayoutRect().height),{x:e,y:i}}_getTitleLimit(t){var e,i,r;if(this.option.title.visible&&Pe((e=this.option.title.style)===null||e===void 0?void 0:e.maxLineWidth)){let o=((i=this.option.title.style)===null||i===void 0?void 0:i.angle)||0;if(!((r=this.option.title)===null||r===void 0)&&r.autoRotate&&Pe(this.option.title.angle)&&(o=this.option.orient==="left"?-90:90),t){const l=this.getLayoutRect().width,h=Math.abs(Math.cos(K1(o)));return h<1e-6?1/0:l/h}const s=this.getLayoutRect().height,a=Math.abs(Math.sin(K1(o)));return a<1e-6?1/0:s/a}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}function c9t(n,t){let e;return n==="left"?e=t.axisStyle.leftAxisStyle:n==="right"?e=t.axisStyle.rightAxisStyle:n==="top"?e=t.axisStyle.topAxisStyle:n==="bottom"&&(e=t.axisStyle.bottomAxisStyle),Ue({},t.axisStyle.defaultAxisStyle,e)}function f9t(n,t,e){if(!e)return{};const i=e.axis;let r,o;return t==="linear"||t==="log"||t==="symlog"?r=e.axisLinear:t==="band"&&(r=e.axisBand),n==="top"||n==="bottom"?o=e.axisX:n!=="left"&&n!=="right"||(o=e.axisY),Ue({},i,r,o)}function g9t(n,t){var e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b;const _=Ue({},Wx,n);let w=0;_.tick.visible!==!1&&(w=(e=_.tick.width)!==null&&e!==void 0?e:4);let C=0;if(_.label.visible){if(_.type==="band")_.domain.forEach(S=>{var A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j;_.label.formatMethod&&(S=_.label.formatMethod(S));const{width:W,height:K}=t.measureText(S,{fontSize:(M=(T=(A=_.label)===null||A===void 0?void 0:A.style)===null||T===void 0?void 0:T.fontSize)!==null&&M!==void 0?M:ug,fontWeight:(P=(E=(R=_.label)===null||R===void 0?void 0:R.style)===null||E===void 0?void 0:E.fontWeight)!==null&&P!==void 0?P:"normal",fontFamily:(L=(k=(B=_.label)===null||B===void 0?void 0:B.style)===null||k===void 0?void 0:k.fontFamily)!==null&&L!==void 0?L:hg}),J=((D=(O=_.label)===null||O===void 0?void 0:O.style)===null||D===void 0?void 0:D.maxLineWidth)||1/0,q=((F=(H=(I=_.label)===null||I===void 0?void 0:I.style)===null||H===void 0?void 0:H.angle)!==null&&F!==void 0?F:0)+(((j=(G=_.label)===null||G===void 0?void 0:G.style)===null||j===void 0?void 0:j.direction)==="vertical"?90:0);C=Math.max(C,dg(Math.min(W,J),K,q).width)});else{let S;if(!((i=n.sync)===null||i===void 0)&&i.tickAlign&&Bo((r=n.tick)===null||r===void 0?void 0:r.tickMode))S=n.tick.tickMode();else if(Mt(n.__ticksForVTable))S=n.__ticksForVTable;else{const A=_.range,T=Math.abs(A.min)>1?Math.round(A.min):A.min,M=Math.abs(A.max)>1?Math.round(A.max):A.max;S=[Ux(T),Ux(M)]}S.forEach(A=>{var T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W;_.label.formatMethod&&(A=_.label.formatMethod(A));const{width:K,height:J}=t.measureText(A,{fontSize:(R=(M=(T=_.label)===null||T===void 0?void 0:T.style)===null||M===void 0?void 0:M.fontSize)!==null&&R!==void 0?R:ug,fontWeight:(B=(P=(E=_.label)===null||E===void 0?void 0:E.style)===null||P===void 0?void 0:P.fontWeight)!==null&&B!==void 0?B:"normal",fontFamily:(O=(L=(k=_.label)===null||k===void 0?void 0:k.style)===null||L===void 0?void 0:L.fontFamily)!==null&&O!==void 0?O:hg}),q=((I=(D=_.label)===null||D===void 0?void 0:D.style)===null||I===void 0?void 0:I.maxLineWidth)||1/0,X=((G=(F=(H=_.label)===null||H===void 0?void 0:H.style)===null||F===void 0?void 0:F.angle)!==null&&G!==void 0?G:0)+(((W=(j=_.label)===null||j===void 0?void 0:j.style)===null||W===void 0?void 0:W.direction)==="vertical"?90:0);C=Math.max(C,dg(Math.min(K,q),J,X).width)})}C+=(o=_.label.space)!==null&&o!==void 0?o:4}let x=0;if(_.title.visible&&Si(_.title.text)){const{width:S,height:A}=t.measureText(_.title.text,{fontSize:(l=(a=(s=_.title)===null||s===void 0?void 0:s.style)===null||a===void 0?void 0:a.fontSize)!==null&&l!==void 0?l:ug,fontWeight:(d=(u=(h=_.title)===null||h===void 0?void 0:h.style)===null||u===void 0?void 0:u.fontWeight)!==null&&d!==void 0?d:"normal",fontFamily:(g=(f=(c=_.title)===null||c===void 0?void 0:c.style)===null||f===void 0?void 0:f.fontFamily)!==null&&g!==void 0?g:hg}),T=((v=(p=_.label)===null||p===void 0?void 0:p.style)===null||v===void 0?void 0:v.maxLineWidth)||1/0,M=dg(Math.min(S,T),A,(y=(m=_.title)===null||m===void 0?void 0:m.style)===null||y===void 0?void 0:y.angle);x=n.orient!=="left"&&n.orient!=="right"||!_.title.autoRotate?M.width:M.height,x+=(b=_.title.space)!==null&&b!==void 0?b:4}return Math.ceil(w+C+x+1)}function p9t(n,t){var e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b;const _=Ue({},Wx,n);let w=0;_.tick.visible!==!1&&(w=(e=_.tick.width)!==null&&e!==void 0?e:4);let C=0;if(_.label.visible){if(_.type==="band")_.domain.forEach(S=>{var A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j;_.label.formatMethod&&(S=_.label.formatMethod(S));const{width:W,height:K}=t.measureText(S,{fontSize:(M=(T=(A=_.label)===null||A===void 0?void 0:A.style)===null||T===void 0?void 0:T.fontSize)!==null&&M!==void 0?M:ug,fontWeight:(P=(E=(R=_.label)===null||R===void 0?void 0:R.style)===null||E===void 0?void 0:E.fontWeight)!==null&&P!==void 0?P:"normal",fontFamily:(L=(k=(B=_.label)===null||B===void 0?void 0:B.style)===null||k===void 0?void 0:k.fontFamily)!==null&&L!==void 0?L:hg}),J=((D=(O=_.label)===null||O===void 0?void 0:O.style)===null||D===void 0?void 0:D.maxLineWidth)||1/0,q=((F=(H=(I=_.label)===null||I===void 0?void 0:I.style)===null||H===void 0?void 0:H.angle)!==null&&F!==void 0?F:0)+(((j=(G=_.label)===null||G===void 0?void 0:G.style)===null||j===void 0?void 0:j.direction)==="vertical"?90:0);C=Math.max(C,dg(Math.min(W,J),K,q).height)});else{let S;if(!((i=n.sync)===null||i===void 0)&&i.tickAlign&&Bo((r=n.tick)===null||r===void 0?void 0:r.tickMode))S=n.tick.tickMode();else if(Mt(n.__ticksForVTable))S=n.__ticksForVTable;else{const A=_.range,T=Math.abs(A.min)>1?Math.round(A.min):A.min,M=Math.abs(A.max)>1?Math.round(A.max):A.max;S=[Ux(T),Ux(M)]}S.forEach(A=>{var T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W;_.label.formatMethod&&(A=_.label.formatMethod(A));const{width:K,height:J}=t.measureText(A,{fontSize:(R=(M=(T=_.label)===null||T===void 0?void 0:T.style)===null||M===void 0?void 0:M.fontSize)!==null&&R!==void 0?R:ug,fontWeight:(B=(P=(E=_.label)===null||E===void 0?void 0:E.style)===null||P===void 0?void 0:P.fontWeight)!==null&&B!==void 0?B:"normal",fontFamily:(O=(L=(k=_.label)===null||k===void 0?void 0:k.style)===null||L===void 0?void 0:L.fontFamily)!==null&&O!==void 0?O:hg}),q=((I=(D=_.label)===null||D===void 0?void 0:D.style)===null||I===void 0?void 0:I.maxLineWidth)||1/0,X=((G=(F=(H=_.label)===null||H===void 0?void 0:H.style)===null||F===void 0?void 0:F.angle)!==null&&G!==void 0?G:0)+(((W=(j=_.label)===null||j===void 0?void 0:j.style)===null||W===void 0?void 0:W.direction)==="vertical"?90:0);C=Math.max(C,dg(Math.min(K,q),J,X).height)})}C+=(o=_.label.space)!==null&&o!==void 0?o:4}let x=0;if(_.title.visible&&_.title.text){const{width:S,height:A}=t.measureText(_.title.text,{fontSize:(l=(a=(s=_.title)===null||s===void 0?void 0:s.style)===null||a===void 0?void 0:a.fontSize)!==null&&l!==void 0?l:ug,fontWeight:(d=(u=(h=_.title)===null||h===void 0?void 0:h.style)===null||u===void 0?void 0:u.fontWeight)!==null&&d!==void 0?d:"normal",fontFamily:(g=(f=(c=_.title)===null||c===void 0?void 0:c.style)===null||f===void 0?void 0:f.fontFamily)!==null&&g!==void 0?g:hg}),T=((v=(p=_.label)===null||p===void 0?void 0:p.style)===null||v===void 0?void 0:v.maxLineWidth)||1/0,M=dg(Math.min(S,T),A,(y=(m=_.title)===null||m===void 0?void 0:m.style)===null||y===void 0?void 0:y.angle);x=n.orient!=="bottom"&&n.orient!=="top"||!_.title.autoRotate?M.height:M.width,x+=(b=_.title.space)!==null&&b!==void 0?b:4}return w+C+x+1}function Ux(n){return typeof n!="number"&&(n=Number(n)),Number(n.toPrecision(1)).toString()}function dg(n,t,e=0){const i=e*Math.PI/180,r=-n/2,o=-t/2,s=n/2,a=-t/2,l=n/2,h=t/2,u=-n/2,d=t/2,c={x:r*Math.cos(i)-o*Math.sin(i),y:r*Math.sin(i)+o*Math.cos(i)},f={x:s*Math.cos(i)-a*Math.sin(i),y:s*Math.sin(i)+a*Math.cos(i)},g={x:l*Math.cos(i)-h*Math.sin(i),y:l*Math.sin(i)+h*Math.cos(i)},p={x:u*Math.cos(i)-d*Math.sin(i),y:u*Math.sin(i)+d*Math.cos(i)},v=Math.min(c.x,f.x,g.x,p.x),m=Math.max(c.x,f.x,g.x,p.x),y=Math.min(c.y,f.y,g.y,p.y);return{width:m-v,height:Math.max(c.y,f.y,g.y,p.y)-y}}const v9t='<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>';class m9t{constructor(t,e){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:v9t,width:100,height:100}},this.isReleased=!1,this.table=e,this._emptyTipOption=Object.assign(this._emptyTipOption,t===!0?{}:t),Y(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(t){if(this._emptyTipComponent)jm(t,this._cacheAttrs)||this._emptyTipComponent.setAttributes(t);else{const e=new _Z(t);e.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._emptyTipComponent=e,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",t=>{const e=new k0;this._emptyTipComponent.forEachChildren(i=>{e.union(i.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_click",t)}),this._emptyTipComponent.on("dblclick",t=>{const e=new k0;this._emptyTipComponent.forEachChildren(i=>{e.union(i.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_dblclick",t)})}resize(){var t;if(!this._emptyTipComponent)return;const{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:o}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:o,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:(t=this._emptyTipOption.textStyle)===null||t===void 0?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&this.table.recordsCount!==0||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){const t=this.table.transpose||this.table.options.indicatorsAsCol===!1?this.table.getFrozenColsWidth():0,e=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:t,topHeaderHeight:e,width:(this._emptyTipOption.displayMode!=="basedOnContainer"&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-t-this.table.getTheme().scrollStyle.width,height:(this._emptyTipOption.displayMode!=="basedOnContainer"&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-e-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var t;const{leftHeaderWidth:e,topHeaderHeight:i,width:r,height:o}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+i,width:r,height:o,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:(t=this._emptyTipOption.textStyle)===null||t===void 0?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}var y9t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const b9t={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};function _9t(n,t){const e=Ue({},b9t,n),{title:i={},item:r={},pager:o={},background:s={},type:a,id:l,visible:h,orient:u,position:d,data:c,filter:f,regionId:g,regionIndex:p,seriesIndex:v,seriesId:m,padding:y}=e,b=y9t(e,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(b.title=oQ(i)),Jn(r.focusIconStyle)||Yi(r.focusIconStyle),zs(r.shape),zs(r.label),zs(r.value),zs(r.background),e2(r.maxWidth)&&(r.maxWidth=Number(r.maxWidth.substring(0,r.maxWidth.length-1))*t.width/100),e2(r.width)&&(r.width=Number(r.width.substring(0,r.width.length-1))*t.width/100),e2(r.height)&&(r.height=Number(r.height.substring(0,r.height.length-1))*t.width/100),b.item=r,Jn(o.textStyle)||Yi(o.textStyle),zs(o.handler),b.pager=o,s.visible&&!Jn(s.style)&&(Ue(b,s.style),Y(s.padding)&&(b.padding=s.padding)),b}class C9t{constructor(t,e){var i,r,o,s;this.table=e,this.option=kc(t),this.orient=(i=t.orient)!==null&&i!==void 0?i:"left",this.visible=(r=t.visible)===null||r===void 0||r,this.position=(o=t.position)!==null&&o!==void 0?o:"middle",this.selectedData=(s=t.defaultSelected)!==null&&s!==void 0?s:null,this.createComponent(),this.initEvent()}createComponent(){const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),e=new wA(Ue({},t,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));e.name="legend",this.legendComponent=e,this.visible===!1&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){if(!this.legendComponent||this.visible===!1)return;const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});this.legendComponent.setAttributes(t),this.adjustTableSize(this.legendComponent.attribute)}adjustTableSize(t){var e,i;if(!this.legendComponent||this.visible===!1)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,o=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||o<=0)return;const s=this.table.tableNoFrameWidth,a=this.table.tableNoFrameHeight,l=ce((i=(e=t.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&i!==void 0?i:10);let h=0,u=0;this.orient==="left"?(h=l[3],u=0,r+=l[1]+l[3]):this.orient==="top"?(h=0,u=l[0],o+=l[0]+l[2]):this.orient==="right"?(h=s-r-l[1],u=0,r+=l[1]+l[3]):this.orient==="bottom"&&(h=0,u=a-o-l[2],o+=l[0]+l[2]);const d=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",c=this.position;let f=0,g=0;d==="horizontal"?f=c==="middle"?(s-r)/2:c==="end"?s-r-l[1]:l[3]:g=c==="middle"?(a-o)/2:c==="end"?a-o-l[2]:l[0],this.legendComponent.setAttributes({dx:f,dy:g,x:h,y:u}),this.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):this.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o),this.table.tableY+=Math.ceil(o)):this.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):this.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o))}getLegendAttributes(t){var e,i;const r=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",o=_9t(this.option,t),s=ce((i=(e=o.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&i!==void 0?i:10);return Object.assign({layout:r,items:this.getLegendItems(),maxWidth:t.width-s[1]-s[3],maxHeight:t.height-s[0]-s[2]},o)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(Yo.legendItemClick,t=>{const e=mC(t,"detail.currentSelected");this.table.fireListeners(ot.LEGEND_ITEM_CLICK,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(Yo.legendItemHover,t=>{const e=mC(t,"detail");this.table.fireListeners(ot.LEGEND_ITEM_HOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(Yo.legendItemUnHover,t=>{const e=mC(t,"detail");this.table.fireListeners(ot.LEGEND_ITEM_UNHOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",t=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var w9t=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]])}return e};const Xx={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},x9t={horizontal:Object.assign(Object.assign({},Xx),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},Xx),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},S9t={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},Xx),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},Xx)};function A9t(n,t){const e=Ue({},(n.type==="color"?x9t:S9t)[n.orient==="bottom"||n.orient==="top"?"horizontal":"vertical"],n),{title:i={},handler:r={},rail:o={},track:s={},startText:a,endText:l,handlerText:h,sizeBackground:u,background:d={},type:c,id:f,visible:g,orient:p,position:v,data:m,defaultSelected:y,field:b,filter:_,regionId:w,regionIndex:C,seriesIndex:x,seriesId:S,padding:A}=e,T=w9t(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(T.title=oQ(i)),T.showHandler=r.visible!==!1,Jn(r.style)||(T.handlerStyle=Yi(r.style)),Y(o.width)&&(T.railWidth=o.width),Y(o.height)&&(T.railHeight=o.height),Jn(o.style)||(T.railStyle=Yi(o.style)),Jn(s.style)||(T.trackStyle=Yi(s.style)),T.startText=zs(a),T.endText=zs(l),T.handlerText=zs(h),Jn(u)||(T.sizeBackground=Yi(u)),d.visible&&!Jn(d.style)&&(Ue(T,d.style),Y(d.padding)&&(T.padding=d.padding)),T}class T9t{constructor(t,e){var i,r,o,s;this.table=e,this.option=kc(t),this.orient=(i=t.orient)!==null&&i!==void 0?i:"left",this.visible=(r=t.visible)===null||r===void 0||r,this.position=(o=t.position)!==null&&o!==void 0?o:"middle",this.selectedData=(s=t.defaultSelected)!==null&&s!==void 0?s:null,this.createComponent(),this.initEvent()}createComponent(){const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});let e;e=this.option.type==="color"?new xA(Ue({},t,{slidable:!0})):new SA(Ue({},t,{slidable:!0})),e.name="legend",this.legendComponent=e,this.visible===!1&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&this.visible!==!1&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,i;if(!this.legendComponent||this.visible===!1)return;let r=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,o=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(r<=0||o<=0)return;const s=this.table.tableNoFrameWidth,a=this.table.tableNoFrameHeight,l=ce((i=(e=t.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&i!==void 0?i:10);let h=0,u=0;this.orient==="left"?(h=l[3],u=0,r+=l[1]+l[3]):this.orient==="top"?(h=0,u=l[0],o+=l[0]+l[2]):this.orient==="right"?(h=s-r-l[1],u=0,r+=l[1]+l[3]):this.orient==="bottom"&&(h=0,u=a-o-l[2],o+=l[0]+l[2]);const d=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",c=this.position;let f=0,g=0;d==="horizontal"?f=c==="middle"?(s-r)/2:c==="end"?s-r-l[1]:l[3]:g=c==="middle"?(a-o)/2:c==="end"?a-o-l[2]:l[0],this.legendComponent.setAttributes({dx:f,dy:g,x:h,y:u}),this.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r),this.table.tableX+=Math.ceil(r)):this.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o),this.table.tableY+=Math.ceil(o)):this.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(r):this.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(o))}getLegendAttributes(t){const e=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",i=e==="horizontal"?"bottom":this.orient;return Object.assign(Object.assign({},A9t(this.option)),{layout:e,align:i,min:this.option.min,max:this.option.max,value:this.option.value,[this.option.type==="color"?"colors":"sizeRange"]:this.option.type==="color"?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",t=>{const e=mC(t,"detail.value");this.table.fireListeners(ot.LEGEND_CHANGE,{model:this,value:e,event:t}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}function M9t(n,t){return n.type==="color"||n.type==="size"?new T9t(n,t):new C9t(n,t)}class xQ{constructor(t){this._table=t}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(t,e,i){return this._getMenuElement().bindToCell(this._table,t,e,i)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(t,e){return this._getMenuElement().pointInMenuElement(t,e)}getRootElement(){return this._getMenuElement().rootElement}}const jD="vtable__menu-element",wf=`${jD}--hidden`,S2=`${jD}--shown`;function R9t(){return Ra("div",[jD,wf])}class B9t{constructor(t){var e,i,r;this._handler=new BA,this._rootElement=R9t(),this._rootElement.addEventListener("wheel",o=>{o.stopPropagation()}),(e=this._rootElement)===null||e===void 0||e.addEventListener("mousedown",o=>{o.stopPropagation(),o.preventDefault()}),(i=this._rootElement)===null||i===void 0||i.addEventListener("click",o=>{if(o.stopPropagation(),o.preventDefault(),this._rootElement.classList.contains(wf))return;const{col:s,row:a,dropDownIndex:l,menuKey:h,text:u,hasChildren:d}=o.target;if(typeof l!="number"||d)return void o.stopPropagation();const c=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(s,a):t.getHeaderField(s,a),f=t._dropDownMenuIsHighlight(s,a,l);t.fireListeners(ot.DROPDOWN_MENU_CLICK,{col:s,row:a,field:c,menuKey:h,text:u,highlight:f,cellLocation:t.getCellLocation(s,a),event:o}),t.fireListeners(ot.DROPDOWN_MENU_CLEAR,null),t.fireListeners(ot.HIDE_MENU,null),o.stopPropagation()}),(r=this._rootElement)===null||r===void 0||r.addEventListener("mousemove",o=>{this._rootElement.classList.contains(wf)||o.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();const t=this._rootElement;t?.parentElement&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,i,r){const o=this._rootElement;if(this._menuInstanceInfo=r,o?.classList.remove(S2),o?.classList.add(wf),this._canBindToCell(t,e,i)){if(o.innerHTML="",o.appendChild(r.content),this._bindCell(t,e,i,r.position,r.referencePosition))return o?.classList.add(S2),o?.classList.remove(wf),!0}else this.unbindFromCell();return!1}unbindFromCell(){const t=this._rootElement;this._menuInstanceInfo=void 0,t?.parentElement&&(t.classList.remove(S2),t.classList.add(wf))}_canBindToCell(t,e,i){var r;const o=t.getCellRangeRelativeRect({col:e,row:i}),s=(r=t.internalProps.menu.parentElement)!==null&&r!==void 0?r:t.getElement(),{top:a,bottom:l,left:h,right:u}=o;if(t.isFrozenCell(e,i))return!0;if(l<t.getFrozenRowsHeight()||u<t.getFrozenColsWidth()||h>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||a>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:d,offsetWidth:c}=s;return!(d<a)&&!(c<h)}_bindCell(t,e,i,r,o){var s;const a=this._rootElement,l=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:h,height:u,left:d,top:c}=l.getBoundingClientRect();if(a){a.parentElement!==l&&l.appendChild(a),a.style.left="0px";const f=.8*h;a.style.maxWidth=`${f}px`;const g=a.clientWidth,p=a.clientHeight;let v,m;r&&(v=r.x,m=r.y),o&&(v=o.rect.right-g,m=o.rect.bottom),m+p>u&&(m=u-p,v+=g-2),m<0&&(m/=2);let y=0,b=0;if(t.getElement()!==l){const{left:_,top:w}=t.getElement().getBoundingClientRect();y=w-c,b=_-d}return a.style.top=`${m+y}px`,v<0?v=0:v+g>h&&(v=h-g),a.style.left=`${v+b}px`,!0}return!1}pointInMenuElement(t,e){const i=this._rootElement,{x:r,y:o,width:s,height:a}=i.getBoundingClientRect();return t>r-5&&t<r+s+5&&e>o-5&&e<o+a+5}}class $G extends xQ{createMenuElementInternal(){return new KVt(this._table)}}class P9t extends xQ{createMenuElementInternal(){return new B9t(this._table)}}const k9t={"dropdown-menu":function(n){return new $G(n)},"context-menu":function(n){return new $G(n)},container:n=>new P9t(n)};function E9t(n,t,e,i,r){var o,s,a;if(t===-1&&e===-1&&i==="context-menu")return r?.content?{type:i,position:r.position,referencePosition:(o=r.referencePosition)!==null&&o!==void 0?o:{rect:{left:0,right:0,top:0,bottom:0,width:0,height:0}},content:r.content}:null;const{lineHeight:l,textBaseline:h,textStick:u}=n._getCellStyle(t,e);let d=n.getCellRangeRelativeRect(n.getCellRange(t,e));u&&(d=n.getVisibleCellRangeRelativeRect({col:t,row:e}));let{left:c,right:f,bottom:g,top:p,width:v,height:m}=d;if(n.isHeader(t,e)&&({left:c,right:f,bottom:g,top:p,width:v,height:m}=n.internalProps.headerHelper.getDropDownIconRect(d,l,h||"middle")),r?.content)return{type:i,position:r.position,referencePosition:(s=r.referencePosition)!==null&&s!==void 0?s:{rect:{left:c,right:f,top:p,bottom:g,width:v,height:m}},content:r.content};if(i==="dropdown-menu"){let y=n.globalDropDownMenu;const b=n._getHeaderLayoutMap(t,e);y=(a=b.dropDownMenu)!==null&&a!==void 0?a:y;const _=b.pivotInfo;return typeof y=="function"&&(y=y({row:e,col:t,table:n})),{type:i,referencePosition:{rect:{left:c,right:f,top:p,bottom:g,width:v,height:m}},content:y,pivotInfo:_}}return null}class L9t{constructor(t){this._table=t,this._menuInstances={},this._bindTableEvent(t)}release(){const t=this._menuInstances;for(const e in t)t[e].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(t,e,i,r){var o;const s=this._attachInfo,a=this._getMenuInstanceInfo(t,e,i,r);if(!s||a&&s.instance===a.instance||((o=s.instance)===null||o===void 0||o.unbindMenuElement(),this._attachInfo=null),!a)return;const{instance:l,info:h}=a;if(l&&l.bindMenuElement(t,e,h)){const u=t===-1&&e===-1?{start:{col:-1,row:-1},end:{col:-1,row:-1}}:this._table.getCellRange(t,e);this._attachInfo={range:u,instance:l}}}_unbindFromCell(){const t=this._attachInfo;if(!t)return;const{instance:e}=t;e?.unbindMenuElement(),this._attachInfo=null}_isBindToCell(t,e){const i=this._attachInfo;return!!i&&fs(i.range,t,e)}pointInMenuElement(t,e){if(!this._attachInfo)return!1;const i=this._attachInfo,{instance:r}=i;return r.pointInMenuElement(t,e)}_bindTableEvent(t){t.on(ot.DROPDOWN_ICON_CLICK,e=>{this._attachInfo&&this._isBindToCell(e.col,e.row)?this._unbindFromCell():this._bindToCell(e.col,e.row,"dropdown-menu")}),t.on(ot.DROPDOWN_MENU_CLEAR,e=>{this._unbindFromCell()}),t.on(ot.CONTEXTMENU_CELL,e=>{var i,r,o,s;if(((i=t.internalProps.menu)===null||i===void 0?void 0:i.renderMode)==="html"){const a=t._getMouseAbstractPoint(e.event);let l=null;a.inTable&&typeof((r=t.internalProps.menu)===null||r===void 0?void 0:r.contextMenuItems)=="function"?l=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):a.inTable&&Array.isArray((o=t.internalProps.menu)===null||o===void 0?void 0:o.contextMenuItems)&&(l=(s=t.internalProps.menu)===null||s===void 0?void 0:s.contextMenuItems),this._bindToCell(e.col,e.row,"context-menu",{content:l,position:{x:a.x,y:a.y}})}}),t.on(ot.CONTEXTMENU_CANVAS,e=>{var i,r,o,s;if(((i=t.internalProps.menu)===null||i===void 0?void 0:i.renderMode)==="html"){const a=t._getMouseAbstractPoint(e.event);let l=null;a.inTable&&typeof((r=t.internalProps.menu)===null||r===void 0?void 0:r.contextMenuItems)=="function"?l=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):a.inTable&&Array.isArray((o=t.internalProps.menu)===null||o===void 0?void 0:o.contextMenuItems)&&(l=(s=t.internalProps.menu)===null||s===void 0?void 0:s.contextMenuItems),this._bindToCell(-1,-1,"context-menu",{content:l,position:{x:a.x,y:a.y}})}})}_getMenuInstanceInfo(t,e,i,r){const o=this._table,s=this._menuInstances,a=E9t(o,t,e,i,r);return a?{instance:s&&s[i]||s&&(s[i]=k9t[i](o)),type:i,info:a}:null}containElement(t){var e;for(const i in this._menuInstances)if(!((e=this._menuInstances[i].getRootElement())===null||e===void 0)&&e.contains(t))return!0;return!1}}class O9t{constructor(t,e){this.isReleased=!1,this.table=e,this._titleOption=Ue({orient:"top"},t),t.visible!==!1&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(t){if(this._titleComponent)jm(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{const e=new yZ(t);e.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._titleComponent=e}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var t,e,i,r,o;if(!this._titleComponent)return;const s=ce((t=this._titleOption.padding)!==null&&t!==void 0?t:10),a=(e=this._titleOption.width)!==null&&e!==void 0?e:(this.table.widthMode==="adaptive"?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-s[1]-s[3],l=(i=this._titleOption.height)!==null&&i!==void 0?i:(this.table.heightMode==="adaptive"?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-s[0]-s[2];this._titleComponent.setAttributes({x:((r=this._titleOption.x)!==null&&r!==void 0?r:this._titleOption.orient==="right")?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:((o=this._titleOption.y)!==null&&o!==void 0?o:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:this._titleOption.orient==="top"||this._titleOption.orient==="bottom"?a:this._titleOption.width,height:this._titleOption.orient==="left"||this._titleOption.orient==="right"?l:this._titleOption.height,textStyle:Object.assign({width:a},this._titleOption.textStyle),subtextStyle:Object.assign({width:a},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(t){var e,i,r,o;const s=isFinite((e=this._titleComponent)===null||e===void 0?void 0:e.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,a=isFinite((i=this._titleComponent)===null||i===void 0?void 0:i.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;this._titleOption.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s),this.table.tableX+=Math.ceil(s)):this._titleOption.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(a),this.table.tableY+=Math.ceil(a)):this._titleOption.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s):this._titleOption.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(a)),this._cacheAttrs=t,this._titleOption.orient!=="right"&&this._titleOption.orient!=="bottom"||this._titleComponent.setAttributes({x:((r=this._titleOption.x)!==null&&r!==void 0?r:this._titleOption.orient==="right")?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:((o=this._titleOption.y)!==null&&o!==void 0?o:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var t,e,i,r,o,s,a,l,h,u,d;const c=this._titleOption.text||this._titleOption.subtext?10:0,f=ce((t=this._titleOption.padding)!==null&&t!==void 0?t:c),g=(e=this._titleOption.width)!==null&&e!==void 0?e:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-f[1]-f[3],p=(i=this._titleOption.height)!==null&&i!==void 0?i:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-f[0]-f[2];return{text:(r=this._titleOption.text)!==null&&r!==void 0?r:"",subtext:(o=this._titleOption.subtext)!==null&&o!==void 0?o:"",x:((s=this._titleOption.x)!==null&&s!==void 0?s:this._titleOption.orient==="right")?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:((a=this._titleOption.y)!==null&&a!==void 0?a:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:this._titleOption.orient==="top"||this._titleOption.orient==="bottom"?g:this._titleOption.width,height:this._titleOption.orient==="left"||this._titleOption.orient==="right"?p:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:(l=this._titleOption.align)!==null&&l!==void 0?l:"left",verticalAlign:(h=this._titleOption.verticalAlign)!==null&&h!==void 0?h:"top",textStyle:Object.assign({width:g},this._titleOption.textStyle),subtextStyle:Object.assign({width:g},this._titleOption.subtextStyle),dx:(u=this._titleOption.dx)!==null&&u!==void 0?u:0,dy:(d=this._titleOption.dy)!==null&&d!==void 0?d:0}}getComponentGraphic(){return this._titleComponent}}class D9t{constructor(t){this._table=t}release(){var t,e;this.unbindTooltipElement(),this._tooltipElement&&((e=(t=this._tooltipElement).release)===null||e===void 0||e.call(t)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(t,e,i,r){return this._getTooltipElement().bindToCell(this._table,t,e,i,r)}moveTooltipElement(t,e,i,r){this._getTooltipElement().move(this._table,t,e,i,r)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(t,e,i,r,o){this._getTooltipElement()._locate(this._table,t,e,i,r,o)}}function I9t(){if(ye.mode==="node")return;const n=document.createElement("style");n.id="vtable-tooltip-styleSheet",n.textContent=`
@keyframes vtable__bubble-tooltip-element--shown-animation {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}
.vtable__bubble-tooltip-element {
	position: absolute;
	
	// pointer-events: none;
	//user-select: none;
	max-width: 300px;
	z-index: 99999;

	background: #FFFFFF;
    border: 1px solid #E6E8ED;
    box-sizing: border-box;
    border-radius: 4px;
    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);
    color: #141414;
    font-size: 13px;
}
.vtable__bubble-tooltip-element--hidden {
	opacity: 0;
  pointer-events: none;
	user-select: none;
	/* transform: translate(-50%, -50%); */
	transition: opacity 75ms linear;
}
.vtable__bubble-tooltip-element--shown {
	opacity: 1;
	/* transform: translate(-50%, -50%); */
	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;
}
.vtable__bubble-tooltip-element__content {
	/* font-size: .75rem; */
	padding: 6px 8px;
	min-height: 1em;
	line-height: 1.5;
	width: 100%;
	display: block;
	white-space: pre-wrap;
	margin: 0;
	box-sizing: border-box;
	overflow: auto;
	word-wrap: break-word;
	position: relative;
	background-color: #FFF;
	z-index: 2;
	border-radius: 4px;
}
/*  WebKit Microsoft Edge */
.vtable__bubble-tooltip-element__content::-webkit-scrollbar {
  width: 0;
  height: 0;
  background-color: transparent;
}
/*  Opera Firefox  */
.vtable__bubble-tooltip-element__content > scrollbar-track {
  width: 0;
  height: 0;
  background-color: transparent;
}
/* Internet Explorer 11  Microsoft Edge */
.vtable__bubble-tooltip-element__content > scrollbar {
  width: 0;
  height: 0;
  background-color: transparent;
}
.vtable__bubble-tooltip-element__triangle {
	/* font-size: .75rem; */
	position: absolute;
	width: 10px;
	height: 10px;
	display: block;
	transform: rotate(45deg);
    transform-origin: 50% 50% 0;
	z-index: 1;
	background-color: #FFF;
	border: 1px solid #E6E8ED;
}
`,document.head.appendChild(n)}I9t();const Vy="vtable__bubble-tooltip-element",jG=`${Vy}__content`,UG=`${Vy}__triangle`,gf=`${Vy}--hidden`,Mv=`${Vy}--shown`;class H9t{constructor(){this._handler=new BA;const t=this._rootElement=Ra("div",[Vy,gf]),e=Ra("div",[jG]),i=Ra("span",[UG]);t.appendChild(i),t.appendChild(e),this._messageElement=t.querySelector(`.${jG}`)||void 0,this._triangleElement=t.querySelector(`.${UG}`)||void 0,t.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),t.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),e.addEventListener("wheel",r=>{r.stopPropagation()}),e.addEventListener("copy",r=>{UHt(e)&&r.stopPropagation()})}bindToCell(t,e,i,r,o){var s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S;this._disappearDelay=r?.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);const A=this._rootElement,T=this._messageElement,M=this._triangleElement;if(A?.classList.remove(Mv),A?.classList.add(gf),this._canBindToCell(t,e,i)){if(T.setAttribute("style",""),M.setAttribute("style",""),r?.className&&A.classList.add(r.className),!((s=r?.style)===null||s===void 0)&&s.bgColor&&(T.style.backgroundColor=(a=r?.style)===null||a===void 0?void 0:a.bgColor),!((l=r?.style)===null||l===void 0)&&l.bgColor&&(M.style.backgroundColor=(h=r?.style)===null||h===void 0?void 0:h.bgColor),M.style.display=((u=r?.style)===null||u===void 0?void 0:u.arrowMark)===!0?"block":"none",!((d=r?.style)===null||d===void 0)&&d.fontSize&&(T.style.fontSize=((f=(c=r?.style)===null||c===void 0?void 0:c.fontSize)!==null&&f!==void 0?f:12)+"px"),!((g=r?.style)===null||g===void 0)&&g.fontFamily&&(T.style.fontFamily=(p=r?.style)===null||p===void 0?void 0:p.fontFamily),!((v=r?.style)===null||v===void 0)&&v.color&&(T.style.color=(m=r?.style)===null||m===void 0?void 0:m.color),!((y=r?.style)===null||y===void 0)&&y.padding&&(T.style.padding=`${(b=r?.style)===null||b===void 0?void 0:b.padding.join("px ")}px`),!((_=r?.style)===null||_===void 0)&&_.maxHeight&&(T.style.maxHeight=`${(w=r?.style)===null||w===void 0?void 0:w.maxHeight}px`),!((C=r?.style)===null||C===void 0)&&C.maxWidth&&(T.style.maxWidth=`${(x=r?.style)===null||x===void 0?void 0:x.maxWidth}px`),T&&(T.textContent=r?.content),this._bindToCell(t,e,i,r?.position,r?.referencePosition,o,(S=r?.style)===null||S===void 0?void 0:S.arrowMark))return A?.classList.add(Mv),A?.classList.remove(gf),!0}else this.unbindFromCell();return!1}release(){var t,e;this.unbindFromCell();const i=this._rootElement;i?.parentElement&&i.parentElement.removeChild(i),(e=(t=this._handler)===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t),delete this._rootElement,delete this._messageElement}move(t,e,i,r,o){const s=this._rootElement;this._canBindToCell(t,e,i)?(this._bindToCell(t,e,i,r?.position,r?.referencePosition,o),s?.classList.add(Mv),s?.classList.remove(gf)):this.unbindFromCell()}unbindFromCell(){var t;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{const e=this._rootElement;e?.parentElement&&(e.classList.remove(Mv),e.classList.add(gf))},(t=this._disappearDelay)!==null&&t!==void 0?t:0);else{const e=this._rootElement;e?.parentElement&&(e.classList.remove(Mv),e.classList.add(gf))}}_canBindToCell(t,e,i){const r=t.getCellRangeRelativeRect({col:e,row:i}),o=t.getElement(),{bottom:s,left:a,right:l,top:h}=r;if(t.isFrozenCell(e,i))return!0;if(s<t.getFrozenRowsHeight()||l<t.getFrozenColsWidth()||a>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||h>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:u,offsetWidth:d}=o;return!(h>u)&&!(a>d)}_bindToCell(t,e,i,r,o,s,a){const l=this._rootElement,h=t.getCellRangeRelativeRect({col:e,row:i}),u=t.internalProps.tooltip.parentElement,d=t.internalProps.element.offsetWidth,{width:c}=h;if(l){let f,g;l.parentElement!==u&&u.appendChild(l),l.style.left="0px";const p=Math.min(.8*d,4*c);l.style.maxWidth=`${p}px`;const v=l.clientWidth,m=l.clientHeight;if(!r&&!o)return!1;{const T=this.getComputedPosition(t,e,i,r,o,s,a);g=T.x,f=T.y}l.style.left=`${g}px`,l.style.top=`${f}px`,Uk()&&(l.style.fontSize="11px");const{x1:y,x2:b,y1:_,y2:w}=t.stateManager.menu.bounds,C=g,x=C+v,S=f,A=C+m;return!(t.stateManager.menu.isShow&&y<x&&b>C&&w>S&&_<A)}return!1}getComputedPosition(t,e,i,r,o,s,a){var l;const h=this._rootElement,u=t.getCellRangeRelativeRect({col:e,row:i}),{x:d,y:c}=t.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:f,height:g,x:p,y:v}=t.internalProps.element.getBoundingClientRect(),{width:m}=u;let y,b;const _=Math.min(.8*f,4*m);h.style.maxWidth=`${_}px`;const w=h.clientWidth,C=h.clientHeight,x=a?6:0;if(r)b=r.x,y=r.y+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(o){let S=(l=o.placement)!==null&&l!==void 0?l:ao.bottom;const A=o.rect.left+o.rect.width/2,T=o.rect.top+o.rect.height/2,M=o.rect.top,R=o.rect.bottom,E=o.rect.left,P=o.rect.right;let B=0;const k=()=>{B++,B>=4||(this.removeStyleFromTriangle(),S===ao.top?(b=A-w/2,y=M-C-x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",s&&y<0&&(S=ao.right,k())):S===ao.bottom?(b=A-w/2,y=R+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",s&&y+C>g&&(S=ao.left,k())):S===ao.left?(y=T-C/2,b=E-w-x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",s&&b<0&&(S=ao.top,k())):S===ao.right&&(y=T-C/2,b=P+x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",s&&b+w>f&&(S=ao.bottom,k())))};k()}return s&&(b<0?b=0:b+h.offsetWidth>f&&(b=f-h.offsetWidth)),{x:b+p-d,y:y+v-c}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(t,e,i,r,o,s){const a=this.getComputedPosition(t,e,i,r,o,s),l=a.x,h=a.y;this._rootElement.style.left=`${l}px`,this._rootElement.style.top=`${h}px`}}class F9t extends D9t{createTooltipElementInternal(){return new H9t}}const z9t={"bubble-tooltip":function(n){return new F9t(n)}};class N9t{constructor(t,e){this._table=t,this._tooltipInstances={},this._bindTableEvent(t),this.confine=e}release(){var t,e;const i=this._tooltipInstances;for(const r in i)(e=(t=i[r])===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(t,e,i){var r;const o=this._attachInfo,s=this._getTooltipInstanceInfo(t,e);if(!o||s&&o.instance===s||((r=o.instance)===null||r===void 0||r.unbindTooltipElement(),this._attachInfo=null),!!s&&s&&s.bindTooltipElement(t,e,i,this.confine)){const a=this._table.getCellRange(t,e);this._attachInfo={range:a,instance:s,tooltipOptions:i}}}_move(t,e,i){const r=this._attachInfo;if(!r||!fs(r.range,t,e))return;const{instance:o}=r;o?.moveTooltipElement(t,e,i,this.confine)}moveToPosition(t,e,i,r){const o=this._attachInfo;if(!o||!fs(o.range,t,e))return;const{instance:s}=o;this._attachInfo.tooltipOptions.position=i,this._attachInfo.tooltipOptions.referencePosition=r,s?.locateTooltipElement(t,e,i,r,this.confine)}_unbindFromCell(){const t=this._attachInfo;if(!t)return;const{instance:e}=t;e?.unbindTooltipElement(),this._attachInfo=null}_isBindCell(t,e){const i=this._attachInfo;return!!i&&fs(i.range,t,e)}_bindTableEvent(t){t.on(ot.MOUSEENTER_CELL,e=>{if(Uk())return;const{x1:i,x2:r,y1:o,y2:s}=t.stateManager.menu.bounds;if(t.stateManager.menu.isShow&&typeof e.x=="number"&&typeof e.y=="number"&&e.x>i&&e.x<r&&e.y>o&&e.y<s)return;const{col:a,row:l}=e;this.showTooltip(a,l)}),t.on(ot.MOUSEMOVE_CELL,e=>{var i,r;if(!Uk()){if(!((r=(i=this._attachInfo)===null||i===void 0?void 0:i.tooltipOptions)===null||r===void 0)&&r.referencePosition){const o=this._attachInfo.tooltipOptions.referencePosition,{event:s}=e,{left:a,right:l,top:h,bottom:u}=o.rect,d=t._getMouseAbstractPoint(s);d.inTable&&d.x>=a-5&&d.x<=l+5&&d.y>=h-5&&d.y<=u+5||this._unbindFromCell()}this._attachInfo&&t.stateManager.menu.isShow&&this._bindToCell(e.col,e.row)}}),t.on(ot.MOUSELEAVE_CELL,e=>{this._unbindFromCell()}),t.on(ot.SELECTED_CELL,e=>{this._isBindCell(e.col,e.row)&&this._unbindFromCell()}),t.on(ot.MOUSELEAVE_TABLE,e=>{this._unbindFromCell()}),t.on(ot.SCROLL,e=>{this._unbindFromCell()})}showTooltip(t,e){var i,r,o;let s;const a=this._table,l=a.getHeaderDescription(t,e);if(l){const h=a.getCellRangeRelativeRect({col:t,row:e});s={content:l,referencePosition:{placement:a.internalProps.tooltip.position,rect:h},disappearDelay:(i=a.internalProps.tooltip.overflowTextTooltipDisappearDelay)!==null&&i!==void 0?i:0,style:a.theme.tooltipStyle}}else if(Bo((r=a.internalProps.tooltip)===null||r===void 0?void 0:r.isShowOverflowTextTooltip)?a.internalProps.tooltip.isShowOverflowTextTooltip(t,e,a):a.internalProps.tooltip.isShowOverflowTextTooltip){const h=a.getCellOverflowText(t,e),u=a.getCellRangeRelativeRect({col:t,row:e});h&&(s={content:l?`${l}
  ${h}`:h,referencePosition:{placement:a.internalProps.tooltip.position,rect:u},disappearDelay:(o=a.internalProps.tooltip.overflowTextTooltipDisappearDelay)!==null&&o!==void 0?o:0,style:a.theme.tooltipStyle})}s?this._bindToCell(t,e,s):this._unbindFromCell()}_getTooltipInstanceInfo(t,e){const i=this._table,r=this._tooltipInstances;return r&&r["bubble-tooltip"]||r&&(r["bubble-tooltip"]=z9t["bubble-tooltip"](i))}isBinded(t){var e;return JSON.stringify(t)===JSON.stringify((e=this._attachInfo)===null||e===void 0?void 0:e.tooltipOptions)}}const W9t=()=>{Bt.registerComponent("axis",d9t),Bt.registerFunction("computeAxisComponentWidth",g9t),Bt.registerFunction("computeAxisComponentHeight",p9t),Bt.registerFunction("getAxisConfigInPivotChart",dGt)},V9t=()=>{Bt.registerComponent("emptyTip",m9t)},G9t=()=>{Bt.registerFunction("createLegend",M9t)},$9t=()=>{Bt.registerComponent("menuHandler",L9t)},j9t=()=>{Bt.registerComponent("title",O9t)},U9t=()=>{Bt.registerComponent("tooltipHandler",N9t)},X9t=()=>{ODt(),iOt()};class Y9t{constructor(t){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=t,this.table.on("scroll",e=>{e.scrollDirection==="vertical"&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",e=>{this.updateGroupTitle()}),this.table.on("resize_column",e=>{this.updateGroupTitle()})}updateGroupTitle(){this.table.scrollTop===0?(this.titleRows=[],this.showedTitleRows=[]):this.skipStartRow!==-1&&this.skipEndRow!==-1&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;const t=this.table.getRecordIndexByCell(0,this.rowNow),e=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(t,e)}getTitleRowsByRecordIndex(t,e){Mt(t)||(t=[t]),Mt(e)||(e=[e]);for(let a=0;a<t.length;a++){const l=t.slice(0,a+1);this.table.dataSource.getRaw(l)}const i=[],r=e.length===t.length+1;let o=t.slice(0,r?t.length:t.length-1);const s=this.table.dataSource.currentIndexedData;for(let a=this.rowNow-this.table.columnHeaderLevelCount;a>=0;a--){const l=s[a];if(Mt(l)&&o.length===l.length){let h=!0;for(let u=0;u<l.length;u++)if(l[u]!==o[u]){h=!1;break}h&&(i.push(a+this.table.columnHeaderLevelCount),o=o.slice(0,o.length-1))}else if(l===t[0]){i.push(a+this.table.columnHeaderLevelCount);break}}this.titleRows=i.reverse()}updateScenegraph(){const{table:t}=this,{shadowGroup:e,shadowGroupFrozen:i}=q9t(t);this.showedTitleRows.length=0;let r=0;for(let o=0;o<t.colCount;o++){let s;o<t.frozenColCount?(s=new re({x:t.getColsWidth(0,o-1),y:t.getFrozenRowsHeight()}),i.add(s)):(s=new re({x:t.getColsWidth(t.frozenColCount,o-1),y:t.getFrozenRowsHeight()}),e.add(s)),s.col=o;for(let a=0;a<this.titleRows.length;a++){const l=this.titleRows[a];if(K9t(l,this.rowNow,t.scenegraph.proxy.screenTopRow,this.titleRows)){o===0&&r++;continue}o===0&&this.showedTitleRows.push(l);const h=t.scenegraph.getCell(o,l);if(h.role==="cell"){const u=SQ(h);u.setAttributes({y:40*a}),s.add(u)}else{const u=ss(o,l,t,!0,!0);u.setAttributes({y:40*a}),s.add(u)}}}r>0&&this.skipStartRow===-1&&this.skipEndRow===-1&&(this.skipStartRow=t.scenegraph.proxy.screenTopRow-1,this.skipEndRow=t.scenegraph.proxy.screenTopRow+1)}}function K9t(n,t,e,i){return n===t&&n!==e+i.length-1?!0:n===e+i.indexOf(n)+1&&n<t}function SQ(n){const t=n.clone();if(t.role=n.role,t.col=n.col,t.row=n.row,t.mergeStartCol=n.mergeStartCol,t.mergeStartRow=n.mergeStartRow,t.mergeEndCol=n.mergeEndCol,t.mergeEndRow=n.mergeEndRow,t.contentWidth=n.contentWidth,t.contentHeight=n.contentHeight,t.role==="cell"){const e=Ne({x:0,y:0,width:t.attribute.width,height:t.attribute.height});t.add(e)}if(n.type==="group"){const e=t;n.forEachChildren(i=>{const r=SQ(i);e.add(r)})}return t}function q9t(n){const t=n.scenegraph.colHeaderGroup,e=n.scenegraph.cornerHeaderGroup;if(!t.border){const o=Ne({x:0,y:0,width:0,height:0,cursor:"pointer"});t.add(o),t.border=o,o.attachShadow(o.shadowRoot),o.name="border-rect",o.addEventListener("click",s=>{const a=n.listTreeStickCellPlugin.titleRows,{shadowTarget:l}=s.pickParams,h=wc(l),{col:u,row:d}=h;XG(d-a.indexOf(d),n)})}if(!e.border){const o=Ne({x:0,y:0,width:0,height:0,cursor:"pointer"});e.add(o),e.border=o,o.attachShadow(o.shadowRoot),o.name="border-rect",o.addEventListener("click",s=>{const a=n.listTreeStickCellPlugin.titleRows,{shadowTarget:l}=s.pickParams,h=wc(l),{col:u,row:d}=h;XG(d-a.indexOf(d),n)})}const i=t.border.shadowRoot,r=e.border.shadowRoot;return i.removeAllChild(),r.removeAllChild(),{shadowGroup:i,shadowGroupFrozen:r}}function XG(n,t){const e=t.getDrawRange();if(Y(n)&&n>=t.frozenRowCount){const i=t.getFrozenRowsHeight(),r=t.getRowsHeight(0,n-1);t.scrollTop=Math.min(r-i,t.getAllRowsHeight()-e.height)-1}t.scenegraph.updateNextFrame()}const Z9t=()=>{Bt.registerComponent("listTreeStickCellPlugin",Y9t)};function J9t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y){var b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K,J,q;const X=BGt()[u],it=g._getCellStyle(r,o),Z=HA("padding",it,r,o,g);if(Y(Z)&&(l=Z),!n){const et=tl(r,o,p,g);m&&(n=g.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:s,height:a,lineWidth:(_=(b=p?.group)===null||b===void 0?void 0:b.lineWidth)!==null&&_!==void 0?_:void 0,fill:(C=(w=p?.group)===null||w===void 0?void 0:w.fill)!==null&&C!==void 0?C:void 0,stroke:(S=(x=p?.group)===null||x===void 0?void 0:x.stroke)!==null&&S!==void 0?S:void 0,strokeArrayWidth:et,strokeArrayColor:(T=(A=p?.group)===null||A===void 0?void 0:A.strokeArrayColor)!==null&&T!==void 0?T:void 0,cursor:(R=(M=p?.group)===null||M===void 0?void 0:M.cursor)!==null&&R!==void 0?R:void 0,lineDash:(P=(E=p?.group)===null||E===void 0?void 0:E.lineDash)!==null&&P!==void 0?P:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius}),n&&n.role==="cell"||((n=new re({x:e,y:i,width:s,height:a,lineWidth:(k=(B=p?.group)===null||B===void 0?void 0:B.lineWidth)!==null&&k!==void 0?k:void 0,fill:(O=(L=p?.group)===null||L===void 0?void 0:L.fill)!==null&&O!==void 0?O:void 0,stroke:(I=(D=p?.group)===null||D===void 0?void 0:D.stroke)!==null&&I!==void 0?I:void 0,strokeArrayWidth:et,strokeArrayColor:(F=(H=p?.group)===null||H===void 0?void 0:H.strokeArrayColor)!==null&&F!==void 0?F:void 0,cursor:(j=(G=p?.group)===null||G===void 0?void 0:G.cursor)!==null&&j!==void 0?j:void 0,lineDash:(K=(W=p?.group)===null||W===void 0?void 0:W.lineDash)!==null&&K!==void 0?K:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius})).role="cell",n.col=r,n.row=o,t?.addCellGroup(n))}if(n.AABBBounds.width(),y&&Array.isArray(g.getCellValue(r,o))||!y){const et=new sg(v,{stroke:!1,x:l[3],y:l[0],canvas:(J=g.canvas)!==null&&J!==void 0?J:g.scenegraph.stage.window.getContext().canvas,mode:g.options.mode,modeParams:g.options.modeParams,spec:g.options.specTransformInCell?g.options.specTransformInCell(d,r,o):d,ClassType:X,width:s-l[3]-l[1],height:a-l[2]-l[0],chartInstance:c,dataId:f,data:g.getCellValue(r,o)||[],cellPadding:l,dpr:g.internalProps.pixelRatio,detectPickChartItem:(q=g.options.customConfig)===null||q===void 0?void 0:q.detectPickChartItem,axes:g.isPivotChart()?g.internalProps.layoutMap.getChartAxes(r,o):[],tableChartOption:g.options.chartOption,col:r,row:o});n.appendChild(et),g.internalProps.layoutMap.setChartInstance(r,o,et.chartInstance)}return n}class Q9t extends re{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new re({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new re({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._checkboxGroup=new re({pickable:!1,fill:!1,stroke:!1}),this._checkboxGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._checkboxGroup)}addLeftOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._leftGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,i,r;t.setAttribute("x",this._rightGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth(((i=t.attribute.marginLeft)!==null&&i!==void 0?i:0)+((r=t.attribute.marginRight)!==null&&r!==void 0?r:0)+t.attribute.width)}addCheckbox(t){this._checkboxGroup.appendChild(t)}setCheckboxContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){const s=this._checkboxGroup.width;this._cellWidth=t+e+s,this.setAttribute("width",this._cellWidth)}else{const s=this._cellWidth-t-e;this.updateCenterLayout(s);const a=this._checkboxGroup.width;this._cellWidth=t+e+a,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();const i=this._leftGroup.height,r=this._rightGroup.height,o=this._checkboxGroup.height;this._cellHeight=Math.max(i,r,o),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._checkboxGroup.forEachChildren(o=>{o instanceof au&&(e-=o.AABBBounds.width())});const i=this._checkboxGroup.getChildByName("checkbox-content");i instanceof au&&i.setAttribute("width",e);let r=0;this._checkboxGroup.forEachChildren(o=>{o.setAttribute("x",r),r+=o.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._checkboxGroup.setAttribute("x",4),this._align==="left"||this._align==="start"?this.setAttribute("dx",0):this._align==="center"?this.setAttribute("dx",-this.attribute.width/2):this._align!=="right"&&this._align!=="end"||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){this._baseline==="top"?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._checkboxGroup.setAttribute("y",0)):this._baseline==="middle"?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._checkboxGroup.setAttribute("y",this._cellHeight/2-this._checkboxGroup.height/2)):this._baseline==="bottom"&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._checkboxGroup.setAttribute("y",this._cellHeight-this._checkboxGroup.height))}}function t$t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y){var b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K;if(!n){const z=tl(r,o,g,f);m&&(n=f.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:a,height:l,lineWidth:(_=(b=g?.group)===null||b===void 0?void 0:b.lineWidth)!==null&&_!==void 0?_:void 0,fill:(C=(w=g?.group)===null||w===void 0?void 0:w.fill)!==null&&C!==void 0?C:void 0,stroke:(S=(x=g?.group)===null||x===void 0?void 0:x.stroke)!==null&&S!==void 0?S:void 0,strokeArrayWidth:z,strokeArrayColor:(T=(A=g?.group)===null||A===void 0?void 0:A.strokeArrayColor)!==null&&T!==void 0?T:void 0,cursor:(R=(M=g?.group)===null||M===void 0?void 0:M.cursor)!==null&&R!==void 0?R:void 0,lineDash:(P=(E=g?.group)===null||E===void 0?void 0:E.lineDash)!==null&&P!==void 0?P:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),n&&n.role==="cell"||((n=new re({x:e,y:i,width:a,height:l,lineWidth:(k=(B=g?.group)===null||B===void 0?void 0:B.lineWidth)!==null&&k!==void 0?k:void 0,fill:(O=(L=g?.group)===null||L===void 0?void 0:L.fill)!==null&&O!==void 0?O:void 0,stroke:(I=(D=g?.group)===null||D===void 0?void 0:D.stroke)!==null&&I!==void 0?I:void 0,strokeArrayWidth:z,strokeArrayColor:(F=(H=g?.group)===null||H===void 0?void 0:H.strokeArrayColor)!==null&&F!==void 0?F:void 0,cursor:(j=(G=g?.group)===null||G===void 0?void 0:G.cursor)!==null&&j!==void 0?j:void 0,lineDash:(K=(W=g?.group)===null||W===void 0?void 0:W.lineDash)!==null&&K!==void 0?K:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",n.col=r,n.row=o,t?.addCellGroup(n))}let J;if(c){let z=r,V=o;v&&(z=v.start.col,V=v.start.row),J=f.getCellIcons(z,V)}let q=0,X=0,it=0,Z=0,et=[];if(Array.isArray(J)&&J.length!==0){const{leftIconWidth:z,rightIconWidth:V,contentLeftIcons:$,absoluteRightIconWidth:U}=Lp(J,n,v,f);q=z+V,X=z,it=V,et=$,Z=U,n.forEachChildren(Q=>{Q.role==="icon-left"?Q.setAttribute("x",Q.attribute.x+h[3]):Q.role==="icon-right"?Q.setAttribute("x",Q.attribute.x+a-V-h[1]):Q.role==="icon-absolute-right"&&Q.setAttribute("x",Q.attribute.x+a-U-h[1])}),n.forEachChildren(Q=>{d==="middle"?Q.setAttribute("y",(l-Q.AABBBounds.height())/2):d==="bottom"?Q.setAttribute("y",l-Q.AABBBounds.height()-h[2]):Q.setAttribute("y",h[0])})}const nt=e$t(r,o,s-q,a,l,h,g,p,f,y);if(et.length!==1||et[0].name!==Un.expandIconName&&et[0].name!==Un.collapseIconName)nt&&n.appendChild(nt),nt.render();else{const z=new Q9t({x:0,y:0,fill:!1,stroke:!1,pickable:!1});z.name="checkbox-content",z.setCheckboxContentOption({autoWidth:!1,autoHeight:!1,cellWidth:a-(h[1]+h[3]),cellHeight:l-h[0]-h[2],align:u,baseline:d});const V={addedHierarchyOffset:0};et.forEach(Q=>{const rt=yo(Q,void 0,n.col,n.row,v,f,V);rt.role="icon-content-left",rt.name=Q.name,z.addLeftOccupyingIcon(rt)}),nt&&z.addCheckbox(nt),n.appendChild(z),z.layout(),z.AABBBounds.width(),z.AABBBounds.height();const $=a-(h[1]+h[3]),U=l-(h[0]+h[2]);n.forEachChildren(Q=>{Q.role==="icon-left"?Q.setAttribute("x",Q.attribute.x+h[3]):Q.role==="icon-right"?Q.setAttribute("x",Q.attribute.x+$-it+h[3]):Q.role==="icon-absolute-right"?Q.setAttribute("x",Q.attribute.x+$-Z+h[3]+h[1]):Q.name!=="content"&&Q.name!=="checkbox-content"||(u==="center"&&Q.type!=="richtext"?Q.setAttribute("x",h[3]+X+($-X-it)/2):u==="right"&&Q.type!=="richtext"?Q.setAttribute("x",h[3]+$-it):Q.setAttribute("x",h[3]+X))}),n.forEachChildren(Q=>{Q.name!==ta&&(d==="middle"?Q?._checkboxGroup&&Q._leftGroup.setAttribute("y",h[0]+(U-Q._checkboxGroup.AABBBounds.height())/2):d==="bottom"?Q.setAttribute("y",h[0]+U-Q.AABBBounds.height()):Q.setAttribute("y",h[0]))})}return a-=h[1]+h[3]+q,l-=h[0]+h[2],u==="center"?nt.setAttribute("x",h[3]+X+(a-nt.AABBBounds.width())/2):u==="right"?nt.setAttribute("x",h[3]+X+a-nt.AABBBounds.width()):nt.setAttribute("x",h[3]+X),d==="middle"?nt.setAttribute("y",h[0]+(l-nt.AABBBounds.height())/2):d==="bottom"?nt.setAttribute("y",h[0]+l-nt.AABBBounds.height()):nt.setAttribute("y",h[0]),n}function e$t(n,t,e,i,r,o,s,a,l,h){var u,d,c,f;const g=l._getCellStyle(n,t),p=ut("size",g,n,t,l),v=ut("spaceBetweenTextAndIcon",g,n,t,l),m=ut("defaultFill",g,n,t,l),y=ut("defaultStroke",g,n,t,l),b=ut("disableFill",g,n,t,l),_=ut("checkedFill",g,n,t,l),w=ut("checkedStroke",g,n,t,l),C=ut("disableCheckedFill",g,n,t,l),x=ut("disableCheckedStroke",g,n,t,l),S=ut("checkIconImage",g,n,t,l),A=ut("indeterminateIconImage",g,n,t,l),T=l.getCellValue(n,t),M=l.getCellOriginValue(n,t);let R,E,P=(u=T)!==null&&u!==void 0?u:"";if(pn(T)?(R=T.checked,E=T.disable,P=(d=T.text)!==null&&d!==void 0?d:""):typeof T=="boolean"&&(R=T,P=""),l.internalProps.layoutMap.isSeriesNumber(n,t)){const J=l.getFieldData(a.field,n,t);J&&(typeof J=="string"||(typeof J=="object"?(R=J.checked,E=J.disable):typeof J=="boolean"&&(R=J)))}R=l.stateManager.syncCheckedState(n,t,a.field,R);const B=jr(n,t,l),k=l._getCellStyle(n,t),L=(c=k.autoWrapText)!==null&&c!==void 0?c:l.internalProps.autoWrapText,{lineClamp:O}=k,{checked:D,disable:I}=a;if(R==null||typeof R=="function"){const J=Ie(D,{col:n,row:t,table:l,context:null,value:T,dataValue:M});R=l.stateManager.syncCheckedState(n,t,a.field,J)}const H=Ie(I,{col:n,row:t,table:l,context:null,value:T,dataValue:M}),F=e==="auto",G=l.isAutoRowHeight(t),j={text:P.length===1?P[0]:P,maxLineWidth:F?1/0:i-(o[1]+o[3]+B)-p-v,textAlign:"left",textBaseline:"top",autoWrapText:L,lineClamp:O,wordBreak:"break-word",heightLimit:G?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:h?0:B,whiteSpace:P.length!==1||L?"normal":"no-wrap"},W={x:0,y:0,text:s.text?Object.assign({},s.text,j):j,icon:{width:Math.floor(p/1.4),height:Math.floor(p/1.4)},box:{width:p,height:p},dx:h?B:0,spaceBetweenTextAndIcon:v,disabled:(f=E??H)!==null&&f!==void 0&&f};R==="indeterminate"?(W.checked=void 0,W.indeterminate=!0):(W.checked=R,W.indeterminate=void 0),m&&(W.box.fill=m),y&&(W.box.stroke=y),b&&(W.box.disableFill=b),_&&(W.box.checkedFill=_),w&&(W.box.checkedStroke=w),C&&(W.box.disableCheckedFill=C),x&&(W.box.disableCheckedStroke=x),S&&(W.icon.checkIconImage=S),A&&(W.icon.indeterminateIconImage=A);const K=new au(W);return K.name="checkbox",K}function i$t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p){var v,m,y,b,_,w,C,x,S,A,T,M;if(!n){const P=tl(r,o,f,c);(n=new re({x:e,y:i,width:a,height:l,lineWidth:(m=(v=f?.group)===null||v===void 0?void 0:v.lineWidth)!==null&&m!==void 0?m:void 0,fill:(b=(y=f?.group)===null||y===void 0?void 0:y.fill)!==null&&b!==void 0?b:void 0,stroke:(w=(_=f?.group)===null||_===void 0?void 0:_.stroke)!==null&&w!==void 0?w:void 0,strokeArrayWidth:P,strokeArrayColor:(x=(C=f?.group)===null||C===void 0?void 0:C.strokeArrayColor)!==null&&x!==void 0?x:void 0,cursor:(A=(S=f?.group)===null||S===void 0?void 0:S.cursor)!==null&&A!==void 0?A:void 0,lineDash:(M=(T=f?.group)===null||T===void 0?void 0:T.lineDash)!==null&&M!==void 0?M:void 0,lineCap:"butt",clip:!0,cornerRadius:f.group.cornerRadius})).role="cell",n.col=r,n.row=o,t?.addCellGroup(n)}const{width:R,height:E}=n$t(r,o,s,a,l,h,f,g,n,p,c);return a-=h[1]+h[3],l-=h[0]+h[2],n.forEachChildren(P=>{u==="center"?P.setAttribute("x",h[3]+P.attribute.x+(a-R)/2):u==="right"?P.setAttribute("x",h[3]+P.attribute.x+a-R):P.setAttribute("x",h[3]+P.attribute.x),d==="middle"?P.setAttribute("y",h[0]+P.attribute.y+(l-E)/2):d==="bottom"?P.setAttribute("y",h[0]+P.attribute.y+l-E):P.setAttribute("y",h[0]+P.attribute.y)}),n}function n$t(n,t,e,i,r,o,s,a,l,h,u){var d,c,f,g;const p=u._getCellStyle(n,t);let v=ut("size",p,n,t,u),m=ut("innerRadius",p,n,t,u),y=ut("outerRadius",p,n,t,u);const b=ut("spaceBetweenTextAndIcon",p,n,t,u),_=ut("spaceBetweenRadio",p,n,t,u),w=ut("defaultFill",p,n,t,u),C=ut("defaultStroke",p,n,t,u),x=ut("disableFill",p,n,t,u),S=ut("checkedFill",p,n,t,u),A=ut("checkedStroke",p,n,t,u),T=ut("disableCheckedFill",p,n,t,u),M=ut("disableCheckedStroke",p,n,t,u);pt(y)?v=2*y:y=Math.round(v/2),(!pt(m)||m<0)&&(m=Math.round(y/7*3));const R=u.getCellValue(n,t),E=u.getCellOriginValue(n,t),P=jr(n,t,u),B=u._getCellStyle(n,t),k=(d=B.autoWrapText)!==null&&d!==void 0?d:u.internalProps.autoWrapText,{lineClamp:L}=B,O=e==="auto",D=u.isAutoRowHeight(t),I={maxLineWidth:O?1/0:i-(o[1]+o[3]+P)-v-b,textAlign:"left",textBaseline:"top",autoWrapText:k,lineClamp:L,wordBreak:"break-word",heightLimit:D?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:P},H={x:0,y:0,text:s.text?Object.assign({},s.text,I):I,circle:{innerRadius:m,outerRadius:y},spaceBetweenTextAndIcon:b};w&&(H.circle.fill=w),C&&(H.circle.stroke=C),x&&(H.circle.disableFill=x),S&&(H.circle.checkedFill=S),A&&(H.circle.checkedStroke=A),T&&(H.circle.disableCheckedFill=T),M&&(H.circle.disableCheckedStroke=M);let F=0,G=0;const j=(c=a.radioDirectionInCell)!==null&&c!==void 0?c:"vertical";if(Mt(R))R.forEach((W,K)=>{var J,q;const X=YG(W,E,K,n,t,a,k,H,u);X&&l.appendChild(X),X.id=`radio-${(J=h?.start.col)!==null&&J!==void 0?J:n}-${(q=h?.start.row)!==null&&q!==void 0?q:t}-${K}`,X.render();const it=X.AABBBounds;j==="vertical"?(X.setAttribute("y",G),G+=it.height()+(K!==R.length-1?_:0),F=Math.max(F,it.width())):j==="horizontal"&&(X.setAttribute("x",F),F+=it.width()+(K!==R.length-1?_:0),G=Math.max(G,it.height()))});else{const W=YG(R,E,void 0,n,t,a,k,H,u);W&&l.appendChild(W),W.id=`radio-${(f=h?.start.col)!==null&&f!==void 0?f:n}-${(g=h?.start.row)!==null&&g!==void 0?g:t}`,W.render();const K=W.AABBBounds;F=K.width(),G=K.height()}return{width:F,height:G}}function YG(n,t,e,i,r,o,s,a,l){const h=r$t(n,t,e,i,r,o,l),u=o$t(n,t,i,r,o,l),d=pn(n)?n.text:La(n)?"":n??"",c=Ue({},a,{checked:h,disabled:u,text:{text:d.length===1?d[0]:d,whiteSpace:d.length!==1||s?"normal":"no-wrap"},boundsPadding:0}),f=new sp(c);return f.name="radio",f}function r$t(n,t,e,i,r,o,s){var a,l;const h=(a=o.radioCheckType)!==null&&a!==void 0?a:"column";let u,d;return pn(n)?u=n.checked:typeof n=="boolean"&&(u=n),u=s.stateManager.syncRadioState(i,r,o.field,h,e,u),u!=null&&typeof u!="function"||(d=Ie(o.checked,{col:i,row:r,table:s,context:null,value:n,dataValue:t}),u=s.stateManager.syncRadioState(i,r,o.field,h,e,d)),(l=u??d)!==null&&l!==void 0&&l}function o$t(n,t,e,i,r,o){var s;let a;pn(n)&&(a=n.disable);const l=Ie(r.disable,{col:e,row:i,table:o,context:null,value:n,dataValue:t});return(s=a??l)!==null&&s!==void 0&&s}function s$t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m){var y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W;if(!n){const it=tl(r,o,g,f);m&&(n=f.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:a,height:l,lineWidth:(b=(y=g?.group)===null||y===void 0?void 0:y.lineWidth)!==null&&b!==void 0?b:void 0,fill:(w=(_=g?.group)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:void 0,stroke:(x=(C=g?.group)===null||C===void 0?void 0:C.stroke)!==null&&x!==void 0?x:void 0,strokeArrayWidth:it,strokeArrayColor:(A=(S=g?.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&A!==void 0?A:void 0,cursor:(M=(T=g?.group)===null||T===void 0?void 0:T.cursor)!==null&&M!==void 0?M:void 0,lineDash:(E=(R=g?.group)===null||R===void 0?void 0:R.lineDash)!==null&&E!==void 0?E:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),n&&n.role==="cell"||((n=new re({x:e,y:i,width:a,height:l,lineWidth:(B=(P=g?.group)===null||P===void 0?void 0:P.lineWidth)!==null&&B!==void 0?B:void 0,fill:(L=(k=g?.group)===null||k===void 0?void 0:k.fill)!==null&&L!==void 0?L:void 0,stroke:(D=(O=g?.group)===null||O===void 0?void 0:O.stroke)!==null&&D!==void 0?D:void 0,strokeArrayWidth:it,strokeArrayColor:(H=(I=g?.group)===null||I===void 0?void 0:I.strokeArrayColor)!==null&&H!==void 0?H:void 0,cursor:(G=(F=g?.group)===null||F===void 0?void 0:F.cursor)!==null&&G!==void 0?G:void 0,lineDash:(W=(j=g?.group)===null||j===void 0?void 0:j.lineDash)!==null&&W!==void 0?W:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",n.col=r,n.row=o,t?.addCellGroup(n))}let K;if(c){let it=r,Z=o;v&&(it=v.start.col,Z=v.start.row),K=f.getCellIcons(it,Z)}let J=0,q=0;if(Array.isArray(K)&&K.length!==0){const{leftIconWidth:it,rightIconWidth:Z,absoluteRightIconWidth:et}=Lp(K,n,v,f);J=it+Z,q=it,n.forEachChildren(nt=>{nt.role==="icon-left"?nt.setAttribute("x",nt.attribute.x+h[3]):nt.role==="icon-right"?nt.setAttribute("x",nt.attribute.x+a-Z-h[1]):nt.role==="icon-absolute-right"&&nt.setAttribute("x",nt.attribute.x+a-et-h[1])}),n.forEachChildren(nt=>{d==="middle"?nt.setAttribute("y",(l-nt.AABBBounds.height())/2):d==="bottom"?nt.setAttribute("y",l-nt.AABBBounds.height()-h[2]):nt.setAttribute("y",h[0])})}const X=a$t(r,o,s-J,a,l,h,g,p,f);return X&&n.appendChild(X),X.render(),a-=h[1]+h[3]+J,l-=h[0]+h[2],u==="center"?X.setAttribute("x",h[3]+q+(a-X.AABBBounds.width())/2):u==="right"?X.setAttribute("x",h[3]+q+a-X.AABBBounds.width()):X.setAttribute("x",h[3]+q),d==="middle"?X.setAttribute("y",h[0]+(l-X.AABBBounds.height())/2):d==="bottom"?X.setAttribute("y",h[0]+l-X.AABBBounds.height()):X.setAttribute("y",h[0]),n}function a$t(n,t,e,i,r,o,s,a,l){var h,u,d,c;const f=l._getCellStyle(n,t),g=ut("spaceBetweenTextAndCircle",f,n,t,l),p=ut("circleRadius",f,n,t,l),v=ut("boxWidth",f,n,t,l),m=ut("boxHeight",f,n,t,l),y=ut("checkedFill",f,n,t,l),b=ut("uncheckedFill",f,n,t,l),_=ut("disableCheckedFill",f,n,t,l),w=ut("disableUncheckedFill",f,n,t,l),C=ut("circleFill",f,n,t,l),x=l.getCellValue(n,t),S=l.getCellOriginValue(n,t);let A,T,M=(h=x)!==null&&h!==void 0?h:"";pn(x)?(A=x.checked,T=x.disable,M=(u=x.text)!==null&&u!==void 0?u:""):typeof x=="boolean"&&(A=x,M=""),A=l.stateManager.syncCheckedState(n,t,a.field,A);const R=jr(n,t,l),E=l._getCellStyle(n,t),P=(d=E.autoWrapText)!==null&&d!==void 0?d:l.internalProps.autoWrapText,{lineClamp:B}=E,{checked:k,disable:L,uncheckedText:O,checkedText:D}=a;if(A==null||typeof A=="function"){const q=Ie(k,{col:n,row:t,table:l,context:null,value:x,dataValue:S});A=l.stateManager.syncCheckedState(n,t,a.field,q)}const I=Ie(L,{col:n,row:t,table:l,context:null,value:x,dataValue:S}),H=Ie(D,{col:n,row:t,table:l,context:null,value:x,dataValue:S}),F=Ie(O,{col:n,row:t,table:l,context:null,value:x,dataValue:S}),G=e==="auto",j=l.isAutoRowHeight(t),W={text:M.length===1?M[0]:M,maxLineWidth:G?1/0:i-(o[1]+o[3]+R)-2*p-g,textAlign:"left",textBaseline:"top",autoWrapText:P,lineClamp:B,wordBreak:"break-word",heightLimit:j?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:R,whiteSpace:M.length!==1||P?"normal":"no-wrap",checkedText:H,uncheckedText:F},K={x:0,y:0,text:s.text?Object.assign({},s.text,W):W,circle:{radius:p},box:{width:v,height:m},spaceBetweenTextAndCircle:g,disabled:(c=T??I)!==null&&c!==void 0&&c};K.checked=A,b&&(K.box.uncheckedFill=b),w&&(K.box.disableUncheckedFill=w),y&&(K.box.checkedFill=y),_&&(K.box.disableCheckedFill=_),C&&(K.circle.fill=C);const J=new $m(K);return J.name="switch",J}const ph=new t9t,vh=new Hp;function l$t(n,t,e,i,r,o,s,a,l,h,u,d){var c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D;if(!n){const H=tl(r,o,u,h);d&&(n=h.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:s,height:a,lineWidth:(f=(c=u?.group)===null||c===void 0?void 0:c.lineWidth)!==null&&f!==void 0?f:void 0,fill:(p=(g=u?.group)===null||g===void 0?void 0:g.fill)!==null&&p!==void 0?p:void 0,stroke:(m=(v=u?.group)===null||v===void 0?void 0:v.stroke)!==null&&m!==void 0?m:void 0,strokeArrayWidth:H,strokeArrayColor:(b=(y=u?.group)===null||y===void 0?void 0:y.strokeArrayColor)!==null&&b!==void 0?b:void 0,cursor:(w=(_=u?.group)===null||_===void 0?void 0:_.cursor)!==null&&w!==void 0?w:void 0,lineDash:(x=(C=u?.group)===null||C===void 0?void 0:C.lineDash)!==null&&x!==void 0?x:void 0,lineCap:"butt",clip:!0,cornerRadius:u.group.cornerRadius}),n&&n.role==="cell"||((n=new re({x:e,y:i,width:s,height:a,lineWidth:(A=(S=u?.group)===null||S===void 0?void 0:S.lineWidth)!==null&&A!==void 0?A:void 0,fill:(M=(T=u?.group)===null||T===void 0?void 0:T.fill)!==null&&M!==void 0?M:void 0,stroke:(E=(R=u?.group)===null||R===void 0?void 0:R.stroke)!==null&&E!==void 0?E:void 0,strokeArrayWidth:H,strokeArrayColor:(B=(P=u?.group)===null||P===void 0?void 0:P.strokeArrayColor)!==null&&B!==void 0?B:void 0,cursor:(L=(k=u?.group)===null||k===void 0?void 0:k.cursor)!==null&&L!==void 0?L:void 0,lineDash:(D=(O=u?.group)===null||O===void 0?void 0:O.lineDash)!==null&&D!==void 0?D:void 0,lineCap:"butt",clip:!0,cornerRadius:u.group.cornerRadius})).role="cell",n.col=r,n.row=o,t?.addCellGroup(n))}const I=h$t(r,o,s,a,l,h);return I&&n.appendChild(I),n}function h$t(n,t,e,i,r,o){let s,a;const l=o.internalProps.layoutMap.getBody(n,t).sparklineSpec,h=o.getCellValue(n,t);if(!Array.isArray(h))return;const u=r[3],d=r[0];e-=r[1]+r[3];const c=i-=r[0]+r[2];if(typeof l=="function"){const b={col:n,row:t,dataValue:o.getCellOriginValue(n,t)||"",value:o.getCellValue(n,t)||"",rect:o.getCellRangeRelativeRect(o.getCellRange(n,t)),table:o};s=l(b),a=KG(s,u,d,e,i)}else s=l,a=KG(l,u,d,e,i);const f=[],g=[];let p,v;if(typeof s.xField=="object")ph.domain(s.xField.domain),p=s.xField.field;else if(typeof s.xField=="string"){const b=h.map(_=>_[s.xField]);ph.domain(b),p=s.xField}else Array.isArray(h)&&(ph.domain(Array.from({length:h.length},(b,_)=>_)),p=s.xField);if(ph.range([0,e]),typeof s.yField=="object")vh.domain(s.yField.domain),v=s.yField.field;else if(typeof s.yField=="string"){const b=qG(h,s.yField);vh.domain([Math.min(...b),Math.max(...b)]),v=s.yField}else if(Array.isArray(h)){const b=qG(h);vh.domain([Math.min(...b),Math.max(...b)]),v=s.yField}if(vh.range([0,i]),typeof s.xField=="object"&&Array.isArray(s.xField.domain)){const b=h.map(w=>w[s.xField.field]),_=s.xField.domain;for(let w=0;w<_.length;w++){let C=!1;for(let x=0;x<b.length;x++)if(_[w]===b[x]){const S=h[x];if(!Y(S[p])||!Y(S[v]))break;f.push({x:0+ph.scale(S[p]),y:c-vh.scale(S[v]),defined:Y(S[v])}),g.push(S),C=!0;break}C||(f.push({x:0+ph.scale(_[w]),y:0,defined:!1}),g.push({[p]:_[w],[v]:null}))}}else for(let b=0;b<h.length;b++){const _=h[b];f.push({x:0+ph.scale(p?_[p]:b),y:c-vh.scale(v?_[v]:_),defined:Y(v?_[v]:_),rawData:_}),g.push(_)}const m=a.getChildByName("sparkline-line");m&&m.setAttribute("points",f),m.bandwidth=ph.step(),m.min=vh.range()[0],m.max=vh.range()[1];const y=a.getChildByName("sparkline-symbol-group");if(y){const b=s.pointShowRule==="isolatedPoint";if(s.pointShowRule==="all")for(let _=0;_<f.length;_++){const{x:w,y:C,defined:x}=f[_];if(x){const S=Qg({x:w,y:C});y.appendChild(S)}}else if(b)for(let _=0;_<f.length;_++){const{x:w,y:C,defined:x}=f[_];if(x&&(!f[_-1]||!f[_-1].defined)&&(!f[_+1]||!f[_+1].defined)){const S=Qg({x:w,y:C});y.appendChild(S)}}}return a}function KG(n,t,e,i,r){var o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T;let M;M=typeof n=="function"?n(null):n;const R=new re({x:t,y:e,width:i,height:r,stroke:!1,fill:!1});if(R.name="sparkline",M.type==="line"){const E=Ri({x:0,y:0,curveType:M.smooth?"monotoneX":"linear",stroke:(a=(s=(o=M.line)===null||o===void 0?void 0:o.style)===null||s===void 0?void 0:s.stroke)!==null&&a!==void 0?a:"blue",lineWidth:(u=(h=(l=M.line)===null||l===void 0?void 0:l.style)===null||h===void 0?void 0:h.strokeWidth)!==null&&u!==void 0?u:2});E.name="sparkline-line",R.addChild(E),M.crosshair&&(E.hover=(c=(d=M.crosshair)===null||d===void 0?void 0:d.style)!==null&&c!==void 0?c:{stroke:"#000",interpolate:"linear"});const P=new re({x:0,y:0,width:i,height:r,stroke:!1,fill:!1});P.name="sparkline-symbol-group",P.setTheme({symbol:{stroke:(p=(g=(f=M.point)===null||f===void 0?void 0:f.style)===null||g===void 0?void 0:g.stroke)!==null&&p!==void 0?p:"#000",lineWidth:(y=(m=(v=M.point)===null||v===void 0?void 0:v.style)===null||m===void 0?void 0:m.strokeWidth)!==null&&y!==void 0?y:1,fill:(w=(_=(b=M.point)===null||b===void 0?void 0:b.style)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:"#000",size:2*((S=(x=(C=M.point)===null||C===void 0?void 0:C.style)===null||x===void 0?void 0:x.size)!==null&&S!==void 0?S:3),symbolType:"circle"}}),R.addChild(P),P.hover=(T=(A=M.point)===null||A===void 0?void 0:A.hover)!==null&&T!==void 0&&T}return R}function qG(n,t){const e=[];for(let i=0;i<n.length;i++){const r=n[i];Y(t)&&Y(r[t])?e.push(r[t]):!Y(t)&&Y(r)&&e.push(r)}return e}const A2=ms();function u$t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v){var m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K,J,q,X,it;const Z=f._getCellStyle(i,r),et=HA("padding",Z,i,r,f);!((m=f.options.customConfig)===null||m===void 0)&&m.imageMargin?h=ce((y=f.options.customConfig)===null||y===void 0?void 0:y.imageMargin):Y(et)&&(h=et),!((b=g?.text)===null||b===void 0)&&b.textAlign&&(u=(_=g?.text)===null||_===void 0?void 0:_.textAlign),!((w=g?.text)===null||w===void 0)&&w.textBaseline&&(d=(C=g?.text)===null||C===void 0?void 0:C.textBaseline);const nt=tl(i,r,g,f);let z,V;if(v&&(z=f.scenegraph.highPerformanceGetCell(i,r,!0),z&&z.role==="cell"&&z.setAttributes({x:t,y:e,width:o,height:s,lineWidth:(S=(x=g?.group)===null||x===void 0?void 0:x.lineWidth)!==null&&S!==void 0?S:void 0,fill:(T=(A=g?.group)===null||A===void 0?void 0:A.fill)!==null&&T!==void 0?T:void 0,stroke:(R=(M=g?.group)===null||M===void 0?void 0:M.stroke)!==null&&R!==void 0?R:void 0,strokeArrayWidth:nt,strokeArrayColor:(P=(E=g?.group)===null||E===void 0?void 0:E.strokeArrayColor)!==null&&P!==void 0?P:void 0,cursor:(k=(B=g?.group)===null||B===void 0?void 0:B.cursor)!==null&&k!==void 0?k:void 0,lineDash:(O=(L=g?.group)===null||L===void 0?void 0:L.lineDash)!==null&&O!==void 0?O:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})),z&&z.role==="cell"||(z=new re({x:t,y:e,width:o,height:s,lineWidth:(I=(D=g?.group)===null||D===void 0?void 0:D.lineWidth)!==null&&I!==void 0?I:void 0,fill:(F=(H=g?.group)===null||H===void 0?void 0:H.fill)!==null&&F!==void 0?F:void 0,stroke:(j=(G=g?.group)===null||G===void 0?void 0:G.stroke)!==null&&j!==void 0?j:void 0,strokeArrayWidth:nt,strokeArrayColor:(K=(W=g?.group)===null||W===void 0?void 0:W.strokeArrayColor)!==null&&K!==void 0?K:void 0,cursor:(q=(J=g?.group)===null||J===void 0?void 0:J.cursor)!==null&&q!==void 0?q:void 0,lineDash:(it=(X=g?.group)===null||X===void 0?void 0:X.lineDash)!==null&&it!==void 0?it:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),z.role="cell",z.col=i,z.row=r,n?.addCellGroup(z)),c){let at=i,ht=r;p&&(at=p.start.col,ht=p.start.row),V=f.getCellIcons(at,ht)}let $=0,U=0;if(Array.isArray(V)&&V.length!==0){const{leftIconWidth:at,rightIconWidth:ht,absoluteRightIconWidth:gt}=Lp(V,z,p,f);$=at,U=ht,z.forEachChildren(dt=>{dt.role==="icon-left"?dt.setAttribute("x",dt.attribute.x+h[3]):dt.role==="icon-right"?dt.setAttribute("x",dt.attribute.x+o-ht-h[1]):dt.role==="icon-absolute-right"&&dt.setAttribute("x",dt.attribute.x+o-gt-h[1])}),z.forEachChildren(dt=>{d==="middle"?dt.setAttribute("y",(s-dt.AABBBounds.height())/2):d==="bottom"?dt.setAttribute("y",s-dt.AABBBounds.height()-h[2]):dt.setAttribute("y",h[0])}),z._cellLeftIconWidth=$,z._cellRightIconWidth=U}const Q=f.getCellValue(i,r),rt=document.createElement("video");rt.addEventListener("loadeddata",()=>{l&&pJ(i,r,rt.videoWidth,rt.videoHeight,f.scenegraph,h,z);const{width:at,height:ht,isMerge:gt}=lp(z,f);if(a){const{width:Yt,height:ai}=IA(rt.videoWidth,rt.videoHeight,at-h[1]-h[3],ht-h[0]-h[2]),We=PD(0,0,at,ht,Yt,ai,u,d,h);st.setAttributes({width:Yt,height:ai,x:We.x,y:We.y,dx:0})}else st.setAttributes({x:h[3],y:h[0],width:at-h[1]-h[3],height:ht-h[2]-h[0],dy:0});gt&&kD(z.mergeStartCol,z.mergeEndCol,z.mergeStartRow,z.mergeEndRow,f);const{width:dt,height:vt}=lp(z,f),oe=Math.floor(Math.min(dt-h[1]-h[3],vt-h[2]-h[0])/2),Se=0+(dt>st.attribute.width?st.attribute.x-0+st.attribute.width/2:dt/2),fi=0+(vt>st.attribute.height?st.attribute.y-0+st.attribute.height/2:vt/2),me=z.getChildByName("image",!0),{dx:bn,dy:Gi}=me.attribute,Ii=new Cc({x:Se-oe/2,y:fi-oe/2,width:oe,height:oe,image:A2.play.svg,cursor:A2.play.cursor,dx:bn,dy:Gi});Ii.name="play-icon",z.appendChild(Ii),f.scenegraph.updateNextFrame()}),rt.onerror=()=>{st.image=A2.damage_pic.svg},rt.src=Q,rt.setAttribute("preload","auto");const st=uA({x:h[3],y:h[0],width:o-h[1]-h[3],height:s-h[2]-h[0],image:rt,cursor:"pointer"});return st.name="image",st.keepAspectRatio=a,st.textAlign=u,st.textBaseline=d,z.appendChild(st),z}function d$t(n,t,e){if(typeof n=="boolean"){const i=Kw({x:t.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});i.name="mark",t.appendChild(i)}else{const{bgColor:i="#3073F2",shape:r="sector",position:o="right-top",size:s=10,offset:a=0}=n;let l,h,u,d,c,f;if(r==="sector")o==="right-top"?(l=t.attribute.width-a,h=a,u=Math.PI/2,d=Math.PI):o==="left-top"?(l=a,h=a,u=0,d=Math.PI/2):o==="right-bottom"?(l=t.attribute.width-a,h=t.attribute.height-a,u=Math.PI,d=Math.PI/2*3):o==="left-bottom"&&(l=a,h=t.attribute.height-a,u=Math.PI/2*3,d=2*Math.PI),c=i,f=Kw({x:l,y:h,startAngle:u,endAngle:d,outerRadius:s,fill:c,pickable:!1});else if(r==="triangle"){let g,p,v,m;o==="right-top"?(l=t.attribute.width-a,h=a,g=l-s,p=h,v=l,m=h+s):o==="left-top"?(l=a,h=a,g=l+s,p=h,v=l,m=h+s):o==="right-bottom"?(l=t.attribute.width-a,h=t.attribute.height-a,g=l-s,p=h,v=l,m=h-s):o==="left-bottom"&&(l=a,h=t.attribute.height-a,g=l+s,p=h,v=l,m=h-s),c=i,f=YK({points:[{x:l,y:h},{x:g,y:p},{x:v,y:m}],fill:c,pickable:!1})}else r==="rect"&&(o==="right-top"?(l=t.attribute.width-s-a,h=a):o==="left-top"?(l=a,h=a):o==="right-bottom"?(l=t.attribute.width-s-a,h=t.attribute.height-s-a):o==="left-bottom"&&(l=a,h=t.attribute.height-s-a),c=i,f=Ne({x:l,y:h,width:s,height:s,fill:c,pickable:!1}));f.name="mark",t.appendChild(f)}}function c$t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y){var b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K,J,q,X,it,Z,et,nt,z,V;const $=n._getCellStyle(o,s),U=HA("padding",$,o,s,n);Y(U)&&(u=U),!((b=v?.text)===null||b===void 0)&&b.textAlign&&(d=(_=v?.text)===null||_===void 0?void 0:_.textAlign),!((w=v?.text)===null||w===void 0)&&w.textBaseline&&(c=(C=v?.text)===null||C===void 0?void 0:C.textBaseline);const Q=n.isAutoRowHeight(s),rt=a==="auto",st=(x=$.autoWrapText)!==null&&x!==void 0?x:n.internalProps.autoWrapText,at=$.lineClamp,ht=tl(o,s,v,n);let gt;if(y&&(gt=n.scenegraph.getCell(o,s,!0),gt&&gt.role==="cell"&&gt.setAttributes({x:i,y:r,width:l,height:h,lineWidth:(A=(S=v?.group)===null||S===void 0?void 0:S.lineWidth)!==null&&A!==void 0?A:void 0,fill:(M=(T=v?.group)===null||T===void 0?void 0:T.fill)!==null&&M!==void 0?M:void 0,stroke:(E=(R=v?.group)===null||R===void 0?void 0:R.stroke)!==null&&E!==void 0?E:void 0,strokeArrayWidth:ht??void 0,strokeArrayColor:(B=(P=v?.group)===null||P===void 0?void 0:P.strokeArrayColor)!==null&&B!==void 0?B:void 0,cursor:(L=(k=v?.group)===null||k===void 0?void 0:k.cursor)!==null&&L!==void 0?L:void 0,lineDash:(D=(O=v?.group)===null||O===void 0?void 0:O.lineDash)!==null&&D!==void 0?D:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius})),gt&&gt.role==="cell"||(gt=new re({x:i,y:r,width:l,height:h,lineWidth:(H=(I=v?.group)===null||I===void 0?void 0:I.lineWidth)!==null&&H!==void 0?H:void 0,fill:(G=(F=v?.group)===null||F===void 0?void 0:F.fill)!==null&&G!==void 0?G:void 0,stroke:(W=(j=v?.group)===null||j===void 0?void 0:j.stroke)!==null&&W!==void 0?W:void 0,strokeArrayWidth:ht??void 0,strokeArrayColor:(J=(K=v?.group)===null||K===void 0?void 0:K.strokeArrayColor)!==null&&J!==void 0?J:void 0,cursor:(X=(q=v?.group)===null||q===void 0?void 0:q.cursor)!==null&&X!==void 0?X:void 0,lineDash:(Z=(it=v?.group)===null||it===void 0?void 0:it.lineDash)!==null&&Z!==void 0?Z:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius}),gt.role="cell",gt.col=o,gt.row=s,e?.addCellGroup(gt)),g&&gt.appendChild(g),p){const dt=t;let vt;if(f){let oe=o,Se=s;m&&(oe=m.start.col,Se=m.start.row),vt=n.getCellIcons(oe,Se)}nWt(gt,vt,dt,u,rt,Q,st,typeof at=="number"?at:void 0,gt.attribute.width,gt.attribute.height,d,c,n,v,m),!((et=v?._vtable)===null||et===void 0)&&et.marked&&d$t((nt=v?._vtable)===null||nt===void 0?void 0:nt.marked,gt)}return g&&gt.setAttributes({width:Math.max(gt.attribute.width,(z=g.attribute.width)!==null&&z!==void 0?z:0),height:Math.max(gt.attribute.height,(V=g.attribute.height)!==null&&V!==void 0?V:0)}),gt}function f$t(n,t,e,i,r,o,s,a,l,h){var u,d,c,f,g;if(n.dependField){const Z=Ie(n.dependField,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0});r=(d=(u=l.getCellOriginRecord(o,s))===null||u===void 0?void 0:u[Z])!==null&&d!==void 0?d:r}const p=(c=Ie(n.barType,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0}))!==null&&c!==void 0?c:"default",v=(f=Ie(n.min,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0}))!==null&&f!==void 0?f:0,m=(g=Ie(n.max,{col:o,row:s,table:l,value:i,dataValue:r,cellHeaderPaths:void 0}))!==null&&g!==void 0?g:v+100;let y=0;y=h?l.getRowsHeight(h.start.row,h.end.row):l.getRowHeight(s);let b=e,_=y,w=0;pt(l.theme._contentOffset)&&(w=l.theme._contentOffset);const C=new re({x:-w,y:-w,width:b,height:_});C.name="progress-bar";const{showBar:x,barColor:S,barBgColor:A,barPositiveColor:T,barNegativeColor:M,barAxisColor:R,barRightToLeft:E,showBarMark:P,barMarkPositiveColor:B,barMarkNegativeColor:k,barMarkWidth:L,barMarkPosition:O,barMarkInBar:D}=t;let{barHeight:I,barBottom:H,barPadding:F}=t;F.length===1?F=[F[0],F[0],F[0],F[0]]:F.length===2?F=[F[0],F[1],F[0],F[1]]:F.length===3&&(F=[F[0],F[1],F[2],F[1]]),F=F.map((Z,et)=>{if(typeof Z=="string"&&M_.endsWith(Z,"%")){const nt=Number(Z.substr(0,Z.length-1));return et===0||et===2?y*nt/100:e*nt/100}return Number(Z)});const G=ce(ut("borderLineWidth",t,o,s,l)),j=Math.max(F[0],Math.ceil(G[0]/2));let W=Math.max(F[1],Math.floor(G[1]/2));const K=Math.max(F[2],Math.floor(G[2]/2));let J=Math.max(F[3],Math.ceil(G[3]/2));P&&L>0&&O==="right"&&D===!1&&(W+=L,J+=L),b-=W+J,_-=K+j,s===l.rowCount-1&&[0,"0"].includes(H)&&(_-=1);const q=j,X=J,it=b;if(typeof I=="string"&&M_.endsWith(I,"%")?(I=Number(I.substr(0,I.length-1)),I=_*I/100):I=Number(I),typeof H=="string"&&M_.endsWith(H,"%")?(H=Number(H.substr(0,H.length-1)),H=_*H/100):H=Number(H),Ie(x,{col:o,row:s,table:l,context:null,value:i,dataValue:r})){let Z=`${r}`;M_.endsWith(Z,"%")&&(Z=Z.substr(0,Z.length-1));const et=Number(Z);if(isNaN(et))return C;if((p??"default")==="default"){const nt=et<v?0:et>m?1:(et-v)/(m-v),z=b,V=q+_-I-H;let $=Math.min(z*nt,z);const U=E?X+it-$:X;o!==l.colCount-1||nt!==1||E||($-=1);const Q=Ie(A,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:nt});if(Q){const at=Ne({x:U,y:V,width:z,height:I,fill:Q});C.addChild(at)}const rt=Ie(S,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:nt})||"#20a8d8",st=Ne({x:U,y:V,width:$,height:I,fill:rt});C.addChild(st)}else if(p==="negative"){const nt=v<0?-v:0,z=m>0?m:0,V=nt/(nt+z),$=1-V,U=et>0?et/z:0,Q=et<0?-et/nt:0,rt=b,st=q+_-I-H,at=X,ht=Ie(A,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:U});if(ht){const We=Ne({x:at,y:st,width:rt,height:I,fill:ht});C.addChild(We)}const gt=E?$*rt:V*rt,dt=Math.min(rt*V*Q,rt),vt=E?{left:at+gt,top:st,width:dt,height:I}:{left:at+gt-dt,top:st,width:dt,height:I},oe=Ie(M,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:Q})||"#20a8d8",Se=Ne({x:vt.left,y:vt.top,width:vt.width,height:vt.height,fill:oe});C.addChild(Se);let fi=Math.min(rt*$*U,rt);o!==l.colCount-1||U!==1||E||(fi-=1);const me=E?{left:at+gt-fi,top:st,width:fi,height:I}:{left:at+gt,top:st,width:fi,height:I},bn=Ie(T,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:U})||"#20a8d8",Gi=Ne({x:me.left,y:me.top,width:me.width,height:me.height,fill:bn});C.addChild(Gi);const Ii=E?vt.left:me.left,Yt=Ie(R,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:U}),ai=Ri({x:0,y:0,stroke:Yt,lineWidth:1,lineDash:[2,2],points:[{x:Ii,y:0},{x:Ii,y}]});if(C.addChild(ai),P&&(U||Q)){const We=L,Hi=[];let br;if(U>0)if(br=Ie(B,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:U})||"#20a8d8",O==="right"){const _i=E?me.left+L/2:me.left+me.width+(D?-L/2:L/2);Hi.push({x:_i,y:me.top}),Hi.push({x:_i,y:me.top+me.height})}else O==="bottom"&&(Hi.push({x:me.left,y:me.top+me.height-L/2}),Hi.push({x:me.left+me.width,y:me.top+me.height-L/2}));else if(Q>0)if(br=Ie(k,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:Q})||"#20a8d8",O==="right"){const _i=E?vt.left+vt.width-L/2:vt.left+L/2;Hi.push({x:_i,y:vt.top}),Hi.push({x:_i,y:vt.top+vt.height})}else O==="bottom"&&(Hi.push({x:vt.left,y:vt.top+vt.height-L/2}),Hi.push({x:vt.left+vt.width,y:vt.top+vt.height-L/2}));const At=Ri({x:0,y:0,stroke:br,lineWidth:We,points:Hi});C.addChild(At)}}else if(p==="negative_no_axis"){const nt=v<0?-v:0,z=m>0?m:0,V=Math.max(nt,z),$=V===0?0:Math.abs(et)/V,U=b;let Q=Math.min(U*$,U);o!==l.colCount-1||$!==1||E||(Q-=1);const rt=q+_-I-H,st=E?X+it-Q:X,at=Ie(A,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:$});if(at){const vt=Ne({x:st,y:rt,width:U,height:I,fill:at});C.addChild(vt)}const ht={left:st,top:rt,width:Q,height:I};let gt;gt=et>=0?Ie(T,{col:o,row:s,table:l,context:null,value:i,percentile:$,dataValue:r})||"#20a8d8":Ie(M,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:$})||"#20a8d8";const dt=Ne({x:ht.left,y:ht.top,width:ht.width,height:ht.height,fill:gt});if(C.addChild(dt),P&&et){const vt=L,oe=[];let Se;if(Se=et>=0?Ie(B,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:$})||"#20a8d8":Ie(k,{col:o,row:s,table:l,context:null,value:i,dataValue:r,percentile:$})||"#20a8d8",O==="right"){const me=E?ht.left+L/2:ht.left+ht.width-L/2;oe.push({x:me,y:ht.top}),oe.push({x:me,y:ht.top+ht.height})}else O==="bottom"&&(oe.push({x:ht.left,y:ht.top+ht.height-L/2}),oe.push({x:ht.left+ht.width,y:ht.top+ht.height-L/2}));const fi=Ri({x:0,y:0,stroke:Se,lineWidth:vt,points:oe});C.addChild(fi)}}}return C}function g$t(n,t,e,i,r,o){var s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w;if(e?.zero&&(n=Math.min(n,0),t=Math.max(t,0)),e?.expand){const S=n,A=t;Y(e.expand.min)&&(n=S-(A-S)*e.expand.min),Y(e.expand.max)&&(t=A+(A-S)*e.expand.max)}let C,x;if(pt(e?.min)&&(n=e.min),pt(e?.max)&&(t=e.max),e?.type==="log"?(C=new Ny,C.base((s=e?.base)!==null&&s!==void 0?s:10)):e?.type==="symlog"?(C=new Wy,C.constant((a=e?.constant)!==null&&a!==void 0?a:10)):C=new Hp,C.domain([n,t],!!e?.nice),o)p$t(C,o);else if(e?.nice){let S=(d=(h=(l=e.tick)===null||l===void 0?void 0:l.forceTickCount)!==null&&h!==void 0?h:(u=e.tick)===null||u===void 0?void 0:u.tickCount)!==null&&d!==void 0?d:10;Bo(S)&&(S=S({axisLength:r,labelStyle:(f=(c=e?.label)===null||c===void 0?void 0:c.style)!==null&&f!==void 0?f:{fontSize:Jv.LABEL_FONT_SIZE}})),e.niceType==="accurateFirst"&&(S=Math.max(10,S)),Pe(e.min)&&Pe(e.max)?C.nice(S):Y(e.min)&&Pe(e.max)?C.niceMax(S):Pe(e.min)&&Y(e.max)&&C.niceMin(S)}return delete C._niceType,x=((p=(g=o?.targetTicks)===null||g===void 0?void 0:g.length)!==null&&p!==void 0?p:!((v=e?.tick)===null||v===void 0)&&v.forceTickCount)?C.forceTicks((y=(m=o?.targetTicks)===null||m===void 0?void 0:m.length)!==null&&y!==void 0?y:(b=e?.tick)===null||b===void 0?void 0:b.forceTickCount):C.ticks(pt((_=e?.tick)===null||_===void 0?void 0:_.tickCount)?e.tick.tickCount:5,{noDecimals:(w=e?.tick)===null||w===void 0?void 0:w.noDecimals}),{range:C.domain(),ticks:x}}function p$t(n,t){n.niceMax(t.targetTicks.length)}function v$t(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m){var y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W;if(!n){const it=tl(r,o,g,f);m&&(n=f.scenegraph.highPerformanceGetCell(r,o,!0))&&n.role==="cell"&&n.setAttributes({x:e,y:i,width:a,height:l,lineWidth:(b=(y=g?.group)===null||y===void 0?void 0:y.lineWidth)!==null&&b!==void 0?b:void 0,fill:(w=(_=g?.group)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:void 0,stroke:(x=(C=g?.group)===null||C===void 0?void 0:C.stroke)!==null&&x!==void 0?x:void 0,strokeArrayWidth:it,strokeArrayColor:(A=(S=g?.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&A!==void 0?A:void 0,cursor:(M=(T=g?.group)===null||T===void 0?void 0:T.cursor)!==null&&M!==void 0?M:void 0,lineDash:(E=(R=g?.group)===null||R===void 0?void 0:R.lineDash)!==null&&E!==void 0?E:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),n&&n.role==="cell"||((n=new re({x:e,y:i,width:a,height:l,lineWidth:(B=(P=g?.group)===null||P===void 0?void 0:P.lineWidth)!==null&&B!==void 0?B:void 0,fill:(L=(k=g?.group)===null||k===void 0?void 0:k.fill)!==null&&L!==void 0?L:void 0,stroke:(D=(O=g?.group)===null||O===void 0?void 0:O.stroke)!==null&&D!==void 0?D:void 0,strokeArrayWidth:it,strokeArrayColor:(H=(I=g?.group)===null||I===void 0?void 0:I.strokeArrayColor)!==null&&H!==void 0?H:void 0,cursor:(G=(F=g?.group)===null||F===void 0?void 0:F.cursor)!==null&&G!==void 0?G:void 0,lineDash:(W=(j=g?.group)===null||j===void 0?void 0:j.lineDash)!==null&&W!==void 0?W:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",n.col=r,n.row=o,t?.addCellGroup(n))}let K;if(c){let it=r,Z=o;v&&(it=v.start.col,Z=v.start.row),K=f.getCellIcons(it,Z)}let J=0,q=0;if(Array.isArray(K)&&K.length!==0){const{leftIconWidth:it,rightIconWidth:Z,absoluteRightIconWidth:et}=Lp(K,n,v,f);J=it+Z,q=it,n.forEachChildren(nt=>{nt.role==="icon-left"?nt.setAttribute("x",nt.attribute.x+h[3]):nt.role==="icon-right"?nt.setAttribute("x",nt.attribute.x+a-Z-h[1]):nt.role==="icon-absolute-right"&&nt.setAttribute("x",nt.attribute.x+a-et-h[1])}),n.forEachChildren(nt=>{d==="middle"?nt.setAttribute("y",(l-nt.AABBBounds.height())/2):d==="bottom"?nt.setAttribute("y",l-nt.AABBBounds.height()-h[2]):nt.setAttribute("y",h[0])})}const X=m$t(r,o,s-J,a,l,h,g,p,f);return X&&n.appendChild(X),a-=h[1]+h[3]+J,l-=h[0]+h[2],u==="center"?X.setAttribute("x",h[3]+q+(a-X.AABBBounds.width())/2):u==="right"?X.setAttribute("x",h[3]+q+a-X.AABBBounds.width()):X.setAttribute("x",h[3]+q),d==="middle"?X.setAttribute("y",h[0]+(l-X.AABBBounds.height())/2):d==="bottom"?X.setAttribute("y",h[0]+l-X.AABBBounds.height()):X.setAttribute("y",h[0]),n}function m$t(n,t,e,i,r,o,s,a,l){var h,u;const d=l._getCellStyle(n,t),c=ut("buttonColor",d,n,t,l),f=ut("buttonBorderColor",d,n,t,l),g=ut("buttonLineWidth",d,n,t,l),p=ut("buttonBorderRadius",d,n,t,l),v=ut("buttonHoverColor",d,n,t,l),m=ut("buttonHoverBorderColor",d,n,t,l),y=ut("buttonPadding",d,n,t,l),b=ut("buttonTextHoverColor",d,n,t,l),_=ut("buttonDisableColor",d,n,t,l),w=ut("buttonDisableBorderColor",d,n,t,l),C=ut("buttonTextDisableColor",d,n,t,l),x=l.getCellValue(n,t),S=l.getCellOriginValue(n,t),A=jr(n,t,l),T=l._getCellStyle(n,t),M=(h=T.autoWrapText)!==null&&h!==void 0?h:l.internalProps.autoWrapText,{lineClamp:R}=T,E=e==="auto",P=l.isAutoRowHeight(t),{disable:B,text:k}=a,L=Ie(B,{col:n,row:t,table:l,context:null,value:x,dataValue:S}),O=Ie(k,{col:n,row:t,table:l,context:null,value:x,dataValue:S}),D=(u=O??x)!==null&&u!==void 0?u:"",I={maxLineWidth:E?1/0:i-(o[1]+o[3]+A),textAlign:"left",textBaseline:"top",autoWrapText:M,lineClamp:R,wordBreak:"break-word",heightLimit:P?-1:r-Math.floor(o[0]+o[2]),pickable:!1,dx:A,whiteSpace:D.length!==1||M?"normal":"no-wrap"},H=s.text?Object.assign({},s.text,I):I,F={x:0,y:0,cursor:L?"not-allowed":"pointer",disable:L,childrenPickable:!1,text:D.length===1?D[0]:D,textStyle:H,padding:y,panel:{visible:!0,fill:L?_:c,stroke:L?w:f,lineWidth:g,cornerRadius:p},state:{text:{hover:{}},panel:{hover:{fill:v,stroke:m}}}};C&&(F.state.text.fill=C),b&&(F.state.text.hover.fill=b);const G=new ou(F);return G.name="button",L||(G.addEventListener("mouseenter",()=>{G.addState("hover",!0,!1),G.stage.renderNextFrame()}),G.addEventListener("mouseleave",()=>{G.removeState("hover",!1),G.stage.renderNextFrame()})),G}const y$t=()=>{Bt.registerFunction("createChartCellGroup",J9t),Bt.registerFunction("getAxisDomainRangeAndLabels",g$t)},b$t=()=>{Bt.registerFunction("createCheckboxCellGroup",t$t)},_$t=()=>{Bt.registerFunction("createImageCellGroup",sWt)},C$t=()=>{Bt.registerFunction("createProgressBarCell",f$t)},w$t=()=>{Bt.registerFunction("createRadioCellGroup",i$t)},x$t=()=>{Bt.registerFunction("createSwitchCellGroup",s$t)},S$t=()=>{Bt.registerFunction("createButtonCellGroup",v$t)},A$t=()=>{Bt.registerFunction("createSparkLineCellGroup",l$t)},T$t=()=>{Bt.registerFunction("createTextCellGroup",c$t)},M$t=()=>{Bt.registerFunction("createVideoCellGroup",u$t)};W9t(),V9t(),G9t(),$9t(),j9t(),U9t(),Z9t(),yGt(),X9t(),y$t(),b$t(),_$t(),C$t(),w$t(),x$t(),S$t(),A$t(),T$t(),M$t();class R$t extends y8t{}wZ();class B$t extends ge{constructor(t){super(t),this._lastWidth=t.width,this._lastHeight=t.height,this._lastX=t.x,this._lastY=t.y}updateTextPosition(){var t,e,i;if(!this.textLabel||!this.barRect)return;const r=this.labelStyle||{},{textAlign:o="left",textBaseline:s="middle",textOverflow:a,color:l="#333333",outsideColor:h="#333333",padding:u=8}=r,d=Array.isArray(u)?u[3]:u,c=this.barRect.attribute.width,f=this.barRect.attribute.height,g=this.textLabel.attribute.fontSize||12,p=this.textLabel.attribute.fontFamily||"Arial",v=String(this.textLabel.attribute.text||""),m=LD.measureTextWidth(v,{fontSize:g,fontFamily:p})+2*d<=c,y=Dy(Oy(d),o,s,c,f),b=r.orient||(!m&&r.orientHandleWithOverflow?r.orientHandleWithOverflow:null);if(this.textLabel.setAttribute("visible",!0),this.textLabel.setAttribute("textBaseline",s),b){(t=this.textLabel.parent)===null||t===void 0||t.removeChild(this.textLabel),this.appendChild(this.textLabel),this.textLabel.setAttribute("fill",h),this.textLabel.setAttribute("ellipsis",void 0),this.textLabel.setAttribute("maxLineWidth",void 0),this.textLabel.setAttribute("zIndex",1e4),this.setAttribute("zIndex",1e4);const _={left:{x:-d,y:f/2,align:"right",baseline:"middle"},right:{x:c+d,y:f/2,align:"left",baseline:"middle"},top:{x:c/2,y:-d,align:"center",baseline:"bottom"},bottom:{x:c/2,y:f+d,align:"center",baseline:"top"}}[b];_&&(this.textLabel.setAttribute("x",_.x),this.textLabel.setAttribute("y",_.y),this.textLabel.setAttribute("textAlign",_.align),this.textLabel.setAttribute("textBaseline",_.baseline))}else(e=this.textLabel.parent)===null||e===void 0||e.removeChild(this.textLabel),(i=this.clipGroupBox)===null||i===void 0||i.appendChild(this.textLabel),this.textLabel.setAttribute("x",y.x),this.textLabel.setAttribute("y",y.y),this.textLabel.setAttribute("textAlign",o),this.textLabel.setAttribute("fill",l),this.textLabel.setAttribute("maxLineWidth",c-d),this.textLabel.setAttribute("ellipsis",a==="clip"?"":a==="ellipsis"?"...":Y(a)?a:void 0)}}const ZG=`<svg width="100" height="200" xmlns="http://www.w3.org/2000/svg">
  <line x1="30" y1="10" x2="30" y2="190" stroke="black" stroke-width="4"/>
  <line x1="70" y1="10" x2="70" y2="190" stroke="black" stroke-width="4"/>
</svg>`,AQ=10;class P$t{formatMilestoneText(t,e){if(!t)return"";const i=t.match(/{([^}]+)}/g);return i&&i.forEach(r=>{const o=r.substring(1,r.length-1),s=e[o];s!==void 0&&(t=t.replace(r,String(s)))}),t}calculateMilestoneTextPosition(t,e,i=4){const r=typeof i=="number"?i:4;let o=0,s=0,a="left",l="middle";const h=e/2;switch(t){case"left":o=-r,s=h,a="end",l="middle";break;case"right":default:o=e+r,s=h,a="start",l="middle";break;case"top":o=h,s=-r,a="center",l="bottom";break;case"bottom":o=h,s=e+r,a="center",l="top"}return{textX:o,textY:s,textAlignValue:a,textBaselineValue:l}}constructor(t){this.selectedBorders=[],this._scene=t,this.width=t._gantt.tableNoFrameWidth,this.height=t._gantt.gridHeight,this.group=new ge({x:0,y:t._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="task-bar-container",t.ganttGroup.addChild(this.group),this.initBars(),this.initHoverBarIcons()}initBars(){var t,e,i;this.barContainer=new ge({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.barContainer);for(let r=0;r<this._scene._gantt.itemCount;r++)if(this._scene._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Inline&&this._scene._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Separate&&this._scene._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Arrange&&this._scene._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Compact)if(this._scene._gantt.parsedOptions.tasksShowMode!==mt.Project_Sub_Tasks_Inline){const o=this.initBar(r);o&&this.barContainer.appendChild(o)}else{const o=this._scene._gantt.getRecordByIndex(r),s=o.hierarchyState==="expand";if(o.type===Me.PROJECT&&((i=o.children)===null||i===void 0?void 0:i.length)>0&&!s){const a=this._scene._gantt.getRecordIndexByTaskShowIndex(r),l=Array.isArray(a)?[...a]:[a],h=(u,d)=>{var c,f;if(((c=u.children)===null||c===void 0?void 0:c.length)>0)for(let g=0;g<((f=u.children)===null||f===void 0?void 0:f.length);g++){const p=u.children[g];if(p.type!==Me.PROJECT){const v=this.initBar(r,[...d,g],u.children.length);v&&this.barContainer.appendChild(v)}else h(p,[...d,g])}};h(o,l)}else{const a=this.initBar(r);a&&this.barContainer.appendChild(a)}}else{const o=this._scene._gantt.getRecordByIndex(r);if(((t=o.children)===null||t===void 0?void 0:t.length)>0)for(let s=0;s<((e=o.children)===null||e===void 0?void 0:e.length);s++){const a=this.initBar(r,s,o.children.length);a&&this.barContainer.appendChild(a)}else{const s=this.initBar(r);s&&this.barContainer.appendChild(s)}}}initBar(t,e,i){var r,o,s,a,l;const h=this._scene._gantt.parsedOptions.taskBarCustomLayout,{startDate:u,endDate:d,taskDays:c,progress:f,taskRecord:g}=this._scene._gantt.getTaskInfoByTaskListIndex(t,e),p=g.type===Me.MILESTONE;if(p&&!u||!p&&(c<=0||!u||!d||u.getTime()>d.getTime()))return null;const{unit:v,step:m}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0];let y=Oe(d,u,v,m,1)*this._scene._gantt.parsedOptions.timelineColWidth;const b=this._scene._gantt.getTaskBarStyle(t,e),_=b.width;Y(b.minSize)&&(y=Math.max(y,b.minSize));const w=this._scene._gantt.parsedOptions.rowHeight,C=this._scene._gantt.parsedOptions.taskBarMilestoneStyle.width,x=Oe(u,this._scene._gantt.parsedOptions.minDate,v,m)*this._scene._gantt.parsedOptions.timelineColWidth-(p?C/2:0),S=this._scene._gantt.getRowsHeightByIndex(0,t-1)+(this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate?((r=e)!==null&&r!==void 0?r:0)*w:this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?g.vtable_gantt_showIndex*w:0)+(w-(p?C:_))/2,A=new B$t({x,y:S,width:p?C:y,height:p?C:_,cornerRadius:p?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.cornerRadius:b.cornerRadius,lineWidth:p?2*this._scene._gantt.parsedOptions.taskBarMilestoneStyle.borderLineWidth:2*((o=b.borderLineWidth)!==null&&o!==void 0?o:b.borderWidth),stroke:p?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.borderColor:b.borderColor,angle:p?.25*Math.PI:0,anchor:p?[x+C/2,S+C/2]:void 0});A.name="task-bar",A.task_index=t,A.sub_task_index=e,A.record=g;const T=new ge({x:0,y:0,width:A.attribute.width,height:A.attribute.height,cornerRadius:p?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.cornerRadius:b.cornerRadius,clip:!0});let M;T.name="task-bar-group",A.appendChild(T),A.clipGroupBox=T;let R=!0,E=!0;if(h){let P;typeof h=="function"?P=h({width:y,height:_,index:t,startDate:u,endDate:d,taskDays:c,progress:f,taskRecord:g,ganttInstance:this._scene._gantt}):P=h,P&&(M=P.rootContainer,R=(s=P.renderDefaultBar)!==null&&s!==void 0&&s,E=(a=P.renderDefaultText)!==null&&a!==void 0&&a,M&&(M.name="task-bar-custom-render"))}if(R){const P=Ne({x:0,y:0,width:A.attribute.width,height:A.attribute.height,fill:p?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.fillColor:b.barColor,pickable:!1});if(P.name="task-bar-rect",T.appendChild(P),A.barRect=P,g.type!==Me.MILESTONE){const B=Ne({x:0,y:0,width:y*f/100,height:_,fill:b.completedBarColor,pickable:!1});B.name="task-bar-progress-rect",T.appendChild(B),A.progressRect=B}}if(M&&T.appendChild(M),E&&g.type!==Me.MILESTONE){const{textAlign:P,textBaseline:B,fontSize:k,fontFamily:L,textOverflow:O,color:D,padding:I}=this._scene._gantt.parsedOptions.taskBarLabelStyle,H=Dy(Oy(I),P,B,y,_),F=Om({x:H.x,y:H.y,fontSize:k,fill:D,fontFamily:L,text:xZ(this._scene._gantt.parsedOptions.taskBarLabelText,g),maxLineWidth:y-10,textBaseline:B,textAlign:P,ellipsis:O==="clip"?"":O==="ellipsis"?"...":Y(O)?O:void 0,poptip:{position:"bottom"}});T.appendChild(F),A.textLabel=F,A.labelStyle=this._scene._gantt.parsedOptions.taskBarLabelStyle,A.updateTextPosition()}if(E&&g.type==="milestone"&&this._scene._gantt.parsedOptions.taskBarMilestoneStyle.labelText){const P=this._scene._gantt.parsedOptions.taskBarMilestoneStyle,B=P.labelTextStyle||{},k=this.calculateMilestoneTextPosition(P.textOrient||"right",P.width,(l=B.padding)!==null&&l!==void 0?l:4),L=new ge({x,y:S,width:P.width,height:P.width,angle:0,pickable:!1}),O=Om({x:k.textX,y:k.textY,fontSize:B.fontSize||16,fontFamily:B.fontFamily||"Arial",fill:B.color||"#ff0000",textBaseline:B.textBaseline||k.textBaselineValue,textAlign:B.textAlign||k.textAlignValue,text:this.formatMilestoneText(P.labelText,g),pickable:!1});L.appendChild(O),this.barContainer.appendChild(L),A.milestoneTextLabel=O,A.milestoneTextContainer=L}return A}updateTaskBarNode(t,e){const i=this.getTaskBarNodeByIndex(t,e);i&&this.barContainer.removeChild(i);const r=this.initBar(t,e);r&&(this.barContainer.insertInto(r,t),r.updateTextPosition())}initHoverBarIcons(){var t,e;const i=new ge({x:0,y:0,width:100,height:100,clip:!1,pickable:!1,cornerRadius:(e=(t=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&t!==void 0?t:q1.cornerRadius)!==null&&e!==void 0?e:0,fill:this._scene._gantt.parsedOptions.taskBarHoverStyle.barOverlayColor,visibleAll:!1});if(this.hoverBarGroup=i,i.name="task-bar-hover-shadow",this._scene._gantt.parsedOptions.taskBarResizable){const s=new Ga({x:0,y:0,width:10,height:20,image:ZG,pickable:!0,cursor:"col-resize"});s.name="task-bar-hover-shadow-left-icon",this.hoverBarLeftIcon=s,i.appendChild(s);const a=new Ga({x:0,y:0,width:10,height:20,image:ZG,pickable:!0,cursor:"col-resize"});a.name="task-bar-hover-shadow-right-icon",this.hoverBarRightIcon=a,i.appendChild(a)}const r=new ge({x:0,y:0,width:12,height:12,pickable:!0,cursor:"ew-resize",visible:!1}),o=new mc({points:[{x:6,y:0},{x:0,y:6},{x:12,y:6}],fill:"#0064ff",stroke:"#ffffff",lineWidth:1,pickable:!1});r.appendChild(o),r.name="task-bar-progress-handle",this.hoverBarProgressHandle=r,i.appendChild(r)}setX(t){this.barContainer.setAttribute("x",t)}setY(t){this.barContainer.setAttribute("y",t)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()});const t=this.barContainer.attribute.x,e=this.barContainer.attribute.y;this.barContainer.removeAllChild(),this.group.removeChild(this.barContainer),this.initBars(),this.setX(t),this.setY(e)}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}showHoverBar(t,e,i,r,o){var s,a,l,h,u;const{startDate:d,endDate:c,taskRecord:f}=this._scene._gantt.getTaskInfoByTaskListIndex(o.task_index,o.sub_task_index);o&&o.name==="task-bar"&&o.appendChild(this.hoverBarGroup),this.hoverBarGroup.setAttribute("x",0),this.hoverBarGroup.setAttribute("y",0),this.hoverBarGroup.setAttribute("width",i),this.hoverBarGroup.setAttribute("height",r),this.hoverBarGroup.setAttribute("visibleAll",!0);const g=this._scene._gantt.getTaskBarStyle(o.task_index,o.sub_task_index);if(f.type===Me.MILESTONE)this.hoverBarGroup.setAttribute("cornerRadius",o.attribute.cornerRadius);else{const b=(a=(s=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&s!==void 0?s:g.cornerRadius)!==null&&a!==void 0?a:0;this.hoverBarGroup.setAttribute("cornerRadius",b)}(l=this.hoverBarLeftIcon)===null||l===void 0||l.setAttribute("visible",!1),(h=this.hoverBarRightIcon)===null||h===void 0||h.setAttribute("visible",!1),(u=this.hoverBarProgressHandle)===null||u===void 0||u.setAttribute("visibleAll",!1);let p=!0,v=!0,m=!0;const y=this._scene._gantt.parsedOptions.progressField;if(y&&f[y]!==void 0&&f[y]!==null)if(typeof this._scene._gantt.parsedOptions.taskBarProgressAdjustable=="function"){const b={index:o.task_index,startDate:d,endDate:c,taskRecord:f,ganttInstance:this._scene._gantt};m=this._scene._gantt.parsedOptions.taskBarProgressAdjustable(b)}else m=this._scene._gantt.parsedOptions.taskBarProgressAdjustable;else m=!1;if(f.type===Me.MILESTONE)p=!1,v=!1,m=!1;else if(typeof this._scene._gantt.parsedOptions.taskBarResizable=="function"){const b={index:o.task_index,startDate:d,endDate:c,taskRecord:f,ganttInstance:this._scene._gantt},_=this._scene._gantt.parsedOptions.taskBarResizable(b);Array.isArray(_)?[p,v]=_:(p=_,v=_)}else Array.isArray(this._scene._gantt.parsedOptions.taskBarResizable)?[p,v]=this._scene._gantt.parsedOptions.taskBarResizable:(p=this._scene._gantt.parsedOptions.taskBarResizable,v=this._scene._gantt.parsedOptions.taskBarResizable);if(p&&this.hoverBarLeftIcon.setAttribute("visible",!0),v&&this.hoverBarRightIcon.setAttribute("visible",!0),m&&this.hoverBarProgressHandle.setAttribute("visibleAll",!0),this.hoverBarLeftIcon&&(this.hoverBarLeftIcon.setAttribute("x",0),this.hoverBarLeftIcon.setAttribute("y",Math.ceil(r/10)),this.hoverBarLeftIcon.setAttribute("width",10),this.hoverBarLeftIcon.setAttribute("height",r-2*Math.ceil(r/10)),this.hoverBarRightIcon.setAttribute("x",i-10),this.hoverBarRightIcon.setAttribute("y",Math.ceil(r/10)),this.hoverBarRightIcon.setAttribute("width",10),this.hoverBarRightIcon.setAttribute("height",r-2*Math.ceil(r/10))),this.hoverBarProgressHandle){const{progress:b}=this._scene._gantt.getTaskInfoByTaskListIndex(o.task_index,o.sub_task_index),_=i*b/100-6;this.hoverBarProgressHandle.setAttribute("x",_),this.hoverBarProgressHandle.setAttribute("y",r-3)}}hideHoverBar(){this.hoverBarGroup.setAttribute("visibleAll",!1)}createSelectedBorder(t,e,i,r,o,s=!1){const a=o.record,l=new ge({x:t,y:e,width:i,height:r,pickable:!1,attachedToTaskBarNode:o,zIndex:1e4});l.name="task-bar-select-border",this.barContainer.appendChild(l),this.selectedBorders.push(l);const h=new ge({x:0,y:0,width:i,height:r,lineWidth:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderLineWidth,pickable:!1,cornerRadius:o.attribute.cornerRadius,fill:!1,stroke:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderColor,shadowColor:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowColor,shadowOffsetX:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetX,shadowOffsetY:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetY,shadowBlur:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowBlur,angle:o.attribute.angle,anchor:[i/2,r/2]});if(l.appendChild(h),s){const u=a.type===Me.MILESTONE?15:10,d=new ge({x:-u,y:0,width:10,height:r,pickable:!0}),c=new ru({x:5,y:r/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1});d.appendChild(c),d.name="task-bar-link-point-left",l.appendChild(d);const f=new ge({x:i+(u-10),y:0,width:10,height:r,pickable:!0}),g=new ru({x:5,y:r/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1,pickStrokeBuffer:10});f.appendChild(g),f.name="task-bar-link-point-right",l.appendChild(f)}}removeSelectedBorder(){this.selectedBorders.forEach(t=>{t.delete()}),this.selectedBorders=[]}removeSecondSelectedBorder(){this.selectedBorders.length===2&&this.selectedBorders.pop().delete()}updateCreatingDependencyLine(t,e,i,r){this.creatingDependencyLine&&(this.creatingDependencyLine.delete(),this.creatingDependencyLine=void 0);const o=new YO({points:[{x:t,y:e},{x:i,y:r}],stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineWidth,lineDash:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineDash,pickable:!1});this.creatingDependencyLine=o,this.selectedBorders[0].appendChild(o)}getTaskBarNodeByIndex(t,e){let i=this.barContainer.firstChild;if(!i)return null;for(let r=0;r<this.barContainer.childrenCount;r++){if(i.task_index===t&&(!Y(e)||Y(e)&&i.sub_task_index===e))return i;i=i._next}return null}}class k$t{constructor(t){this.markLineContainerWidth=20,this._scene=t,this.height=Math.min(t._gantt.tableNoFrameHeight,t._gantt.drawHeight)-t._gantt.getAllHeaderRowsHeight(),this.group=new ge({x:0,y:t._gantt.getAllHeaderRowsHeight(),width:t._gantt.tableNoFrameWidth,height:this.height,pickable:!1,clip:!0}),this.group.name="mark-line-container",t.ganttGroup.addChild(this.group),this.markLIneContainer=new ge({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this.height,pickable:!1,clip:!0}),this.group.appendChild(this.markLIneContainer),this.initMarkLines()}initMarkLines(){const t=Math.min(this._scene._gantt.tableNoFrameHeight,this._scene._gantt.drawHeight)-this._scene._gantt.getAllHeaderRowsHeight();this.group.setAttributes({y:this._scene._gantt.getAllHeaderRowsHeight(),width:this._scene._gantt.tableNoFrameWidth,height:t}),this.markLIneContainer.setAttribute("width",this._scene._gantt.getAllDateColsWidth()),this.markLIneContainer.setAttribute("height",t);const e=this._scene._gantt.parsedOptions.markLine,i=this._scene._gantt.parsedOptions.minDate;i&&e.forEach(r=>{const o=r.style,s=r.contentStyle||{},a=this._scene._gantt.parsedOptions.timeScaleIncludeHour?Ai(r.date):Ai(r.date,!0),{unit:l,step:h}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],u=Oe(a,i,l,h);let d=0;if(r.position==="right")d=1;else if(r.position==="middle")d=.5;else if(r.position==="date"){const p=Ai(r.date),v=Oe(p,i,l,h);d=v-Math.floor(v)}const c=this._scene._gantt.parsedOptions.timelineColWidth*(Math.floor(u)+d),f=new ge({pickable:!1,x:c-this.markLineContainerWidth/2,y:0,width:this.markLineContainerWidth,height:this.height});f.name="mark-line",this.markLIneContainer.appendChild(f);const g=Ri({pickable:!1,stroke:o.lineColor,lineWidth:o.lineWidth,lineDash:o.lineDash,points:[{x:this.markLineContainerWidth/2,y:0},{x:this.markLineContainerWidth/2,y:this.height}]});if(f.appendChild(g),r.content){const p=this._scene._gantt.parsedOptions.timelineColWidth,v=s.lineHeight||18,m=new ge({x:this.markLineContainerWidth/2,y:0,cursor:"pointer",height:v,clip:!1,fill:s.backgroundColor||o.lineColor,display:"flex",cornerRadius:s.cornerRadius||[0,2,2,0]});m.name="mark-line-content",m.data=r,f.appendChild(m);const y=new si({maxLineWidth:p,text:r.content,cursor:"pointer",lineHeight:v,fontWeight:s.fontWeight||"normal",fill:s.color||o.lineColor,fontSize:s.fontSize||12,poptip:{position:"top",dx:p/4,dy:-v/4}});m.appendChild(y)}})}refresh(){this.height=Math.min(this._scene._gantt.tableNoFrameHeight,this._scene._gantt.drawHeight)-this._scene._gantt.getAllHeaderRowsHeight(),this.markLIneContainer.removeAllChild(),this.group.setAttribute("height",this.height),this.markLIneContainer.setAttribute("height",this.height),this.initMarkLines()}setX(t){this.markLIneContainer.setAttribute("x",t)}}class E$t{constructor(t){this._scene=t,this.createFrameBorder()}createFrameBorder(){var t,e,i,r,o,s;const a=this._scene.ganttGroup,l=this._scene._gantt.parsedOptions.outerFrameStyle;if(!l)return;const{cornerRadius:h,borderColor:u,borderLineWidth:d,borderLineDash:c}=l,f={},g={pickable:!1},p=Ls(d??0),v=[p[0],p[1],p[2],this._scene._gantt.taskListTableInstance?0:p[3]];g.stroke=!0,g.fill=!1,g.stroke=u,g.lineWidth=Math.max(...v),g.strokeArrayWidth=v,c&&(g.lineDash=c),g.lineCap="butt";const m=!!this._scene._gantt.taskListTableInstance;g.x=m?0:v[3]/2,g.y=v[0]/2;const y=(e=(t=this._scene._gantt.parsedOptions.verticalSplitLine)===null||t===void 0?void 0:t.lineWidth)!==null&&e!==void 0?e:0;if(g.width=a.attribute.width+v[3]/2+v[1]/2+(m?y:0),g.height=a.attribute.height+v[0]/2+v[2]/2,h){const b=Array.isArray(h)?h:[h,h,h,h];this._scene._gantt.taskListTableInstance?(g.cornerRadius=[0,(i=b[1])!==null&&i!==void 0?i:0,(r=b[2])!==null&&r!==void 0?r:0,0],f.cornerRadius=[0,(o=b[1])!==null&&o!==void 0?o:0,(s=b[2])!==null&&s!==void 0?s:0,0]):(g.cornerRadius=b,f.cornerRadius=b)}if(a.setAttributes(f),g.stroke){const b=Ne(g);b.name="border-rect",a.parent.insertAfter(b,a),this.border=b,a.border=b}}refresh(){this.border&&this.border.parent&&this.border.parent.removeChild(this.border),this.createFrameBorder()}resize(){var t,e,i;const{borderLineWidth:r}=this._scene._gantt.parsedOptions.outerFrameStyle,o=Ls(r??0),s=[o[0],o[1],o[2],this._scene._gantt.taskListTableInstance?0:o[3]],a=(e=(t=this._scene._gantt.parsedOptions.verticalSplitLine)===null||t===void 0?void 0:t.lineWidth)!==null&&e!==void 0?e:0,l=!!this._scene._gantt.taskListTableInstance;(i=this.border)===null||i===void 0||i.setAttributes({x:l?0:s[3]/2,y:s[0]/2,width:this._scene.ganttGroup.attribute.width+s[3]/2+s[1]/2+(l?a:0),height:this._scene.ganttGroup.attribute.height+s[0]/2+s[2]/2}),this.border.strokeArrayWidth=s}}var L$t=function(n,t,e,i){var r,o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(s=(o<3?r(s):o>3?r(t,e,s):r(t,e))||s);return o>3&&s&&Object.defineProperty(t,e,s),s};let Yx=class{constructor(){this.time=xe.beforeFillStroke,this.useStyle=!0,this.order=0,this.supportedAppName="vtable"}drawShape(n,t,e,i,r,o,s,a,l,h,u,d,c){n.name==="date-header-cell"&&n.forEachChildren(f=>{var g;if(f.name==="date-header-cell-text"&&f.attribute.textStick===!0){const p=f;p.setAttribute("dx",0);const v=p.globalAABBBounds,m=p.stage.globalAABBBounds,y=p.parent.globalAABBBounds,b=m.intersect(y);m.intersect(y)&&(v.width()>=b.width()&&p.attribute.last_dx?p.setAttribute("dx",(g=p.attribute.last_dx)!==null&&g!==void 0?g:0):m.x1>=v.x1?(p.setAttribute("dx",m.x1-v.x1),p.setAttribute("last_dx",m.x1-v.x1)):m.x2<=v.x2&&(p.setAttribute("dx",m.x2-v.x2),p.setAttribute("last_dx",m.x1-v.x1)))}})}};Yx=L$t([yt()],Yx);const O$t=new Ut((n,t,e,i)=>{n(Yx).toSelf().inSingletonScope(),n(No).toService(Yx)});class D$t{constructor(t){this._scene=t,this.createAddButton()}createAddButton(){var t;this._scene._gantt.parsedOptions.taskBarCreationCustomLayout?this.group=new ge({x:0,y:0,width:100,height:100}):(this.group=new ge({x:0,y:0,width:100,height:100,lineDash:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineDash,cursor:"pointer",lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,cornerRadius:(t=this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.cornerRadius)!==null&&t!==void 0?t:0,fill:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.backgroundColor}),this.lineVertical=Ri({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:50,y:0},{x:50,y:100}]}),this.group.appendChild(this.lineVertical),this.lineHorizontal=Ri({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:0,y:50},{x:100,y:50}]}),this.group.appendChild(this.lineHorizontal)),this.group.name="task-creation-button",this._scene.taskBar.group.addChild(this.group)}show(t,e,i,r){if(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout)this.group.appendChild(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout({width:i,height:r,ganttInstance:this._scene._gantt}).rootContainer);else{const o=Math.min(i,r)/6;this.lineHorizontal.setAttribute("points",[{x:(i-4*o)/2,y:r/2},{x:(i-4*o)/2+4*o,y:r/2}]),this.lineVertical.setAttribute("points",[{x:i/2,y:(r-4*o)/2},{x:i/2,y:(r-4*o)/2+4*o}])}this.group.setAttribute("x",t),this.group.setAttribute("y",e),this.group.setAttribute("width",i),this.group.setAttribute("height",r),this.group.setAttribute("visibleAll",!0)}hide(){this.group.setAttribute("visibleAll",!1),this._scene._gantt.parsedOptions.taskBarCreationCustomLayout&&this.group.removeAllChild()}}class JG{constructor(t){this._scene=t,this.group=new rp({position:"top",content:"",contentStyle:{fill:"#fff"},visible:!1,panel:{background:"#14161c",cornerRadius:4}}),t.ganttGroup.addChild(this.group)}show(t){var e,i,r;const o=((e=this._scene._gantt.parsedOptions.markLineCreateOptions)===null||e===void 0?void 0:e.markLineCreationHoverToolTip)||{},s=t.globalTransMatrix,a=t.attribute.width,l=t.attribute.height;let h,u;const d=o.position||"top";d==="top"?(h=s.e+a/2-2,u=s.f):d==="bottom"&&(h=s.e+a/2-2,u=s.f+l);const c=((i=o.style)===null||i===void 0?void 0:i.contentStyle)||{fill:"#fff"},f=((r=o.style)===null||r===void 0?void 0:r.panelStyle)||{background:"#14161c",cornerRadius:4};this.group.setAttributes({content:o.tipContent,position:d,visibleAll:!0,visible:!0,contentStyle:c,panel:Object.assign(Object.assign({},f),{visible:!0}),x:h,y:u})}hide(){this.group.setAttributes({visibleAll:!1,visible:!1})}}class I$t{constructor(t){this._scene=t,this.width=t._gantt.tableNoFrameWidth,this.height=t._gantt.gridHeight,this.group=new ge({x:0,y:t._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="dependency-link-container",t.ganttGroup.addChild(this.group),this.initLinkLines()}initLinkLines(){var t;if(BZ(this._scene._gantt.records),this.linkLinesContainer=new ge({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.linkLinesContainer),(t=this._scene._gantt.records)===null||t===void 0?void 0:t.length)for(let e=0;e<this._scene._gantt.parsedOptions.dependencyLinks.length;e++)this.initLinkLine(e)}initLinkLine(t){var e,i,r,o,s,a,l,h,u,d;const{taskKeyField:c,dependencyLinks:f}=this._scene._gantt.parsedOptions,g=f[t],{linkedToTaskKey:p,linkedFromTaskKey:v,type:m}=g,y=Oa(this._scene._gantt.records,c,p),b=Oa(this._scene._gantt.records,c,v);if(!y||!b)return;let _,w,C,x,S,A,T,M;if(y.record.vtable_gantt_linkedTo||(y.record.vtable_gantt_linkedTo=[]),y.record.vtable_gantt_linkedTo.push(g),b.record.vtable_gantt_linkedFrom||(b.record.vtable_gantt_linkedFrom=[]),b.record.vtable_gantt_linkedFrom.push(g),this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline)M=b.index[0],T=y.index[0],{startDate:_,endDate:w,taskDays:C}=this._scene._gantt.getTaskInfoByTaskListIndex(y.index[0],y.index[1]),{startDate:x,endDate:S,taskDays:A}=this._scene._gantt.getTaskInfoByTaskListIndex(b.index[0],b.index[1]);else if(this._scene._gantt.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline){const L=this._scene._gantt.getTaskShowIndexByRecordIndex(b.index.slice(0,-1)),O=this._scene._gantt.getTaskShowIndexByRecordIndex(y.index.slice(0,-1)),D=this._scene._gantt.getRecordByIndex(L),I=this._scene._gantt.getRecordByIndex(O);M=D.type===Me.PROJECT&&D.hierarchyState!=="expand"&&this._scene._gantt.parsedOptions.projectSubTasksExpandable!==!1?L:this._scene._gantt.getTaskShowIndexByRecordIndex(b.index),T=I.type===Me.PROJECT&&I.hierarchyState!=="expand"&&this._scene._gantt.parsedOptions.projectSubTasksExpandable!==!1?O:this._scene._gantt.getTaskShowIndexByRecordIndex(y.index),{startDate:_,endDate:w,taskDays:C}=this._scene._gantt.getTaskInfoByTaskListIndex(T,y.index),{startDate:x,endDate:S,taskDays:A}=this._scene._gantt.getTaskInfoByTaskListIndex(M,b.index)}else this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?(M=this._scene._gantt.getRowsHeightByIndex(0,b.index[0]-1)/this._scene._gantt.parsedOptions.rowHeight+(this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?b.record.vtable_gantt_showIndex:(e=b.index[1])!==null&&e!==void 0?e:0),T=this._scene._gantt.getRowsHeightByIndex(0,y.index[0]-1)/this._scene._gantt.parsedOptions.rowHeight+(this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?y.record.vtable_gantt_showIndex:(i=y.index[1])!==null&&i!==void 0?i:0),{startDate:_,endDate:w,taskDays:C}=this._scene._gantt.getTaskInfoByTaskListIndex(y.index[0],y.index[1]),{startDate:x,endDate:S,taskDays:A}=this._scene._gantt.getTaskInfoByTaskListIndex(b.index[0],b.index[1])):(M=this._scene._gantt.getTaskShowIndexByRecordIndex(b.index),T=this._scene._gantt.getTaskShowIndexByRecordIndex(y.index),{startDate:_,endDate:w,taskDays:C}=this._scene._gantt.getTaskInfoByTaskListIndex(T),{startDate:x,endDate:S,taskDays:A}=this._scene._gantt.getTaskInfoByTaskListIndex(M));if(!A||!C)return;Ai(this._scene._gantt.parsedOptions.minDate);const{arrowPoints:R,linePoints:E}=H$t(m,x,S,M,A,b.record.type===Me.MILESTONE,_,w,T,C,y.record.type===Me.MILESTONE,this._scene._gantt),P=this._scene._gantt.parsedOptions.dependencyLinkLineStyle,B=Ri({pickable:!0,stroke:(o=(r=g.linkLineStyle)===null||r===void 0?void 0:r.lineColor)!==null&&o!==void 0?o:P.lineColor,lineWidth:(a=(s=g.linkLineStyle)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:P.lineWidth,lineDash:(h=(l=g.linkLineStyle)===null||l===void 0?void 0:l.lineDash)!==null&&h!==void 0?h:P.lineDash,points:E,pickStrokeBuffer:3,vtable_link:g});this.linkLinesContainer.appendChild(B),g.vtable_gantt_linkLineNode=B;const k=new mc({fill:(d=(u=g.linkLineStyle)===null||u===void 0?void 0:u.lineColor)!==null&&d!==void 0?d:P.lineColor,points:R});this.linkLinesContainer.appendChild(k),g.vtable_gantt_linkArrowNode=k}setX(t){this.linkLinesContainer.setAttribute("x",t)}setY(t){this.linkLinesContainer.setAttribute("y",t)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()});const t=this.linkLinesContainer.attribute.x,e=this.linkLinesContainer.attribute.y;this.linkLinesContainer.removeAllChild(),this.group.removeChild(this.linkLinesContainer),this.initLinkLines(),this.setX(t),this.setY(e)}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}createSelectedLinkLine(t){const e=t.vtable_gantt_linkLineNode,i=t.vtable_gantt_linkArrowNode,r=e.clone(),o=i.clone();r.setAttribute("stroke",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),r.setAttribute("lineWidth",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineWidth),r.setAttribute("shadowColor",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowColor),r.setAttribute("shadowOffsetX",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),r.setAttribute("shadowOffsetY",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),r.setAttribute("shadowBlur",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowBlur),this.linkLinesContainer.appendChild(r),o.setAttribute("fill",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),this.linkLinesContainer.appendChild(o),this.selectedEffectNodes=[r,o]}removeSelectedLinkLine(){var t;(t=this.selectedEffectNodes)===null||t===void 0||t.forEach(e=>{e.delete()}),this.selectedEffectNodes=[]}deleteLink(t){const e=t.vtable_gantt_linkLineNode,i=t.vtable_gantt_linkArrowNode;e.delete(),i.delete()}}function H$t(n,t,e,i,r,o,s,a,l,h,u,d){const{unit:c,step:f}=d.parsedOptions.reverseSortedTimelineScales[0],{minDate:g,rowHeight:p,timelineColWidth:v}=d.parsedOptions,m=d.parsedOptions.taskBarMilestoneHypotenuse;let y=[],b=[];if(n===Gr.FinishToStart){let _=Oe(e,g,c,f,1)*v;o&&(_=Oe(t,g,c,f,1)*v+m/2);let w=Oe(s,g,c,f)*v;u&&(w-=m/2),y=[{x:_,y:p*(i+.5)},{x:_+20,y:p*(i+.5)},{x:_+20,y:p*(i+(i>l?0:1))},{x:w-20,y:p*(i+(i>l?0:1))},{x:w-20,y:p*(l+.5)},{x:w,y:p*(l+.5)}],_+20<=w-20&&y.splice(2,3,{x:_+20,y:p*(l+.5)});const C=y[y.length-1];b=[{x:C.x,y:C.y},{x:C.x-10,y:C.y-5},{x:C.x-10,y:C.y+5},{x:C.x,y:C.y}]}else if(n===Gr.StartToFinish){let _=Oe(t,g,c,f)*v;o&&(_-=m/2);let w=Oe(a,g,c,f,1)*v;u&&(w=Oe(s,g,c,f,1)*v+m/2),y=[{x:_,y:p*(i+.5)},{x:_-20,y:p*(i+.5)},{x:_-20,y:p*(i+(i>l?0:1))},{x:w+20,y:p*(i+(i>l?0:1))},{x:w+20,y:p*(l+.5)},{x:w,y:p*(l+.5)}],_-20>=w+20&&y.splice(2,3,{x:_-20,y:p*(l+.5)});const C=y[y.length-1];b=[{x:C.x,y:C.y},{x:C.x+10,y:C.y-5},{x:C.x+10,y:C.y+5},{x:C.x,y:C.y}]}else if(n===Gr.StartToStart){let _=Oe(t,g,c,f)*v;o&&(_-=m/2);let w=Oe(s,g,c,f)*v;u&&(w-=m/2),y=[{x:_,y:p*(i+.5)},{x:(i===l?_:Math.min(_,w))-20,y:p*(i+.5)},{x:(i===l?_:Math.min(_,w))-20,y:p*(l+(i===l?1:.5))},{x:w-20,y:p*(l+(i===l?1:.5))},{x:(i===l?w:Math.min(_,w))-20,y:p*(l+.5)},{x:w,y:p*(l+.5)}];const C=y[y.length-1];b=[{x:C.x,y:C.y},{x:C.x-10,y:C.y-5},{x:C.x-10,y:C.y+5},{x:C.x,y:C.y}]}else if(n===Gr.FinishToFinish){let _=Oe(e,g,c,f,1)*v;o&&(_=Oe(t,g,c,f,1)*v+m/2);let w=Oe(a,g,c,f,1)*v;u&&(w=Oe(s,g,c,f,1)*v+m/2),y=[{x:_,y:p*(i+.5)},{x:(i===l?_:Math.max(_,w))+20,y:p*(i+.5)},{x:(i===l?_:Math.max(_,w))+20,y:p*(l+(i===l?1:.5))},{x:w+20,y:p*(l+(i===l?1:.5))},{x:w+20,y:p*(l+.5)},{x:w,y:p*(l+.5)}];const C=y[y.length-1];b=[{x:C.x,y:C.y},{x:C.x+10,y:C.y-5},{x:C.x+10,y:C.y+5},{x:C.x,y:C.y}]}return{linePoints:y,arrowPoints:b}}function QG(n,t,e,i,r,o,s,a,l,h,u,d,c,f,g,p){const{unit:v,step:m}=p.parsedOptions.reverseSortedTimelineScales[0],{minDate:y,rowHeight:b,timelineColWidth:_}=p.parsedOptions,w=p.parsedOptions.taskBarMilestoneHypotenuse,C=p.parsedOptions.taskBarMilestoneStyle.width;let x=[],S=[];if(n===Gr.FinishToStart){let A=s?s.attribute.x+s.attribute.width:Oe(e,y,v,m,1)*_;o&&(A=s?s.attribute.x+s.attribute.width+(w-C)/2:Oe(t,y,v,m,1)*_+w/2);let T=f?f.attribute.x:Oe(l,y,v,m)*_;c&&(T-=(w-C)/2),x=[{x:A,y:b*(i+.5)+a},{x:A+20,y:b*(i+.5)+a},{x:A+20,y:b*(i+(i>u?0:1))+a},{x:T-20,y:b*(i+(i>u?0:1))+a},{x:T-20,y:b*(u+.5)+g},{x:T,y:b*(u+.5)+g}],A+20<=T-20&&x.splice(2,3,{x:A+20,y:b*(u+.5)+g});const M=x[x.length-1];S=[{x:M.x,y:M.y},{x:M.x-10,y:M.y-5},{x:M.x-10,y:M.y+5},{x:M.x,y:M.y}]}else if(n===Gr.StartToFinish){let A=s?s.attribute.x:Oe(t,y,v,m)*_;o&&(A-=(w-C)/2);let T=f?f.attribute.x+f.attribute.width:Oe(h,y,v,m,1)*_;c&&(T=f?f.attribute.x+f.attribute.width+(w-C)/2:Oe(l,y,v,m,1)*_+w/2),x=[{x:A,y:b*(i+.5)+a},{x:A-20,y:b*(i+.5)+a},{x:A-20,y:b*(i+(i>u?0:1))+a},{x:T+20,y:b*(i+(i>u?0:1))+a},{x:T+20,y:b*(u+.5)+g},{x:T,y:b*(u+.5)+g}],A-20>=T+20&&x.splice(2,3,{x:A-20,y:b*(u+.5)+g});const M=x[x.length-1];S=[{x:M.x,y:M.y},{x:M.x+10,y:M.y-5},{x:M.x+10,y:M.y+5},{x:M.x,y:M.y}]}else if(n===Gr.StartToStart){let A=s?s.attribute.x:Oe(t,y,v,m)*_;o&&(A-=(w-C)/2);let T=f?f.attribute.x:Oe(l,y,v,m)*_;c&&(T-=(w-C)/2),x=[{x:A,y:b*(i+.5)+a},{x:(i===u?A:Math.min(A,T))-20,y:b*(i+.5)+a},{x:(i===u?A:Math.min(A,T))-20,y:b*(u+(i===u?1:.5))+g},{x:T-20,y:b*(u+(i===u?1:.5))+g},{x:(i===u?T:Math.min(A,T))-20,y:b*(u+.5)+g},{x:T,y:b*(u+.5)+g}];const M=x[x.length-1];S=[{x:M.x,y:M.y},{x:M.x-10,y:M.y-5},{x:M.x-10,y:M.y+5},{x:M.x,y:M.y}]}else if(n===Gr.FinishToFinish){let A=s?s.attribute.x+s.attribute.width:Oe(e,y,v,m,1)*_;o&&(A=s?s.attribute.x+s.attribute.width+(w-C)/2:Oe(t,y,v,m,1)*_+w/2);let T=f?f.attribute.x+f.attribute.width:Oe(h,y,v,m,1)*_;c&&(T=f?f.attribute.x+f.attribute.width+(w-C)/2:Oe(l,y,v,m,1)*_+w/2),x=[{x:A,y:b*(i+.5)+a},{x:(i===u?A:Math.max(A,T))+20,y:b*(i+.5)+a},{x:(i===u?A:Math.max(A,T))+20,y:b*(u+(i===u?1:.5))+g},{x:T+20,y:b*(u+(i===u?1:.5))+g},{x:T+20,y:b*(u+.5)+g},{x:T,y:b*(u+.5)+g}];const M=x[x.length-1];S=[{x:M.x,y:M.y},{x:M.x+10,y:M.y-5},{x:M.x+10,y:M.y+5},{x:M.x,y:M.y}]}return{linePoints:x,arrowPoints:S}}class F$t{constructor(t){this._scene=t,this.dragLineContainer=new ge({x:0,y:0,width:t._gantt.tableNoFrameWidth,height:Math.min(t._gantt.tableNoFrameHeight,t._gantt.drawHeight),pickable:!1,clip:!0,visible:!1}),this.dragLineContainer.name="drag-order-line-container",t.ganttGroup.addChild(this.dragLineContainer),this.initDragLine()}initDragLine(){if(this._scene._gantt.taskListTableInstance){const t=this._scene._gantt.taskListTableInstance.theme.dragHeaderSplitLine,e=Ri({pickable:!1,stroke:t.lineColor,lineWidth:t.lineWidth,points:[]});this.dragLine=e,this.dragLineContainer.appendChild(e)}}showDragLine(t){this.dragLineContainer.showAll(),this.dragLine.setAttribute("points",[{x:0,y:t},{x:this._scene._gantt.tableNoFrameWidth,y:t}])}hideDragLine(){this.dragLineContainer.hideAll()}}Nt.load(O$t);class z$t{constructor(t){let e,i;this._gantt=t,this.tableGroupWidth=t.tableNoFrameWidth,this.tableGroupHeight=Math.min(t.tableNoFrameHeight,t.drawHeight),Ko.mode==="node"||(Dt.setEnv("browser"),e=t.canvas.width,i=t.canvas.height),this.stage=sq({canvas:t.canvas,width:e,height:i,disableDirtyBounds:!1,background:t.parsedOptions.underlayBackgroundColor,enableLayout:!0,autoRender:!1,context:{appName:"vtable"},pluginList:["poptipForText"]}),this.stage.gantt=this._gantt,this.stage.table=this._gantt,this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph()}initSceneGraph(){this.ganttGroup=new ge({x:this._gantt.tableX,y:this._gantt.tableY,width:this.tableGroupWidth,height:this.tableGroupHeight,clip:!0,pickable:!1}),this.stage.defaultLayer.add(this.ganttGroup),this.ganttGroup.name="table",this.timelineHeader=new bHt(this),this.grid=new EIt(this),this.dependencyLink=new I$t(this),this.taskBar=new P$t(this),this.markLine=new k$t(this),this.toolTip=new JG(this),this.frameBorder=new E$t(this),this.scrollbarComponent=new KIt(this._gantt),this.stage.defaultLayer.addChild(this.scrollbarComponent.hScrollBar),this.stage.defaultLayer.addChild(this.scrollbarComponent.vScrollBar),this.dragOrderLine=new F$t(this)}updateSceneGraph(){const t=this._gantt;let e,i;this.tableGroupWidth=t.tableNoFrameWidth,this.tableGroupHeight=Math.min(t.tableNoFrameHeight,t.drawHeight),Ko.mode==="node"||(Dt.setEnv("browser"),e=t.canvas.width,i=t.canvas.height),this.stage.resize(e,i),this.refreshAll()}afterCreateSceneGraph(){this.scrollbarComponent.updateScrollBar(),eHt(this._gantt.eventManager)}refreshAll(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroupWidth=this._gantt.tableNoFrameWidth,this.ganttGroup.setAttribute("height",this.tableGroupHeight),this.ganttGroup.setAttribute("width",this.tableGroupWidth),this.timelineHeader.refresh(),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.dependencyLink.refresh(),this.frameBorder.refresh(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}refreshTaskBars(){this.dependencyLink.refresh(),this.taskBar.refresh(),this.updateNextFrame()}refreshTaskBarsAndGrid(){this._gantt.verticalSplitResizeLine.style.height=this._gantt.drawHeight+"px",this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.ganttGroup.setAttribute("height",this.tableGroupHeight),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.frameBorder.resize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}updateTableSize(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroupWidth=this._gantt.tableNoFrameWidth,this.ganttGroup.setAttributes({x:this._gantt.tableX,y:this._gantt.tableY,width:this._gantt.tableNoFrameWidth,height:this.tableGroupHeight}),this.grid.resize(),this.taskBar.resize(),this.dependencyLink.resize(),this.markLine.refresh(),this.frameBorder.resize()}updateStageBackground(){this.stage.background=this._gantt.parsedOptions.underlayBackgroundColor,this.updateNextFrame()}renderSceneGraph(){this.stage.render()}updateNextFrame(){this.stage.renderNextFrame()}get width(){var t,e;return(e=(t=this.ganttGroup.attribute)===null||t===void 0?void 0:t.width)!==null&&e!==void 0?e:0}get height(){var t,e;return(e=(t=this.ganttGroup.attribute)===null||t===void 0?void 0:t.height)!==null&&e!==void 0?e:0}get x(){var t,e;return(e=(t=this.ganttGroup.attribute)===null||t===void 0?void 0:t.x)!==null&&e!==void 0?e:0}get y(){var t,e;return(e=(t=this.ganttGroup.attribute)===null||t===void 0?void 0:t.y)!==null&&e!==void 0?e:0}setX(t,e=!1){this.timelineHeader.setX(t),this.grid.setX(t),this.taskBar.setX(t),this.dependencyLink.setX(t),this.markLine.setX(t),this.updateNextFrame()}setY(t,e=!1){this.grid.setY(t),this.taskBar.setY(t),this.dependencyLink.setY(t),this.updateNextFrame()}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}resize(){this.updateTableSize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}release(){this.stage.release()}showTaskCreationButton(t,e,i){this.taskCreationButton||(this.taskCreationButton=new D$t(this._gantt.scenegraph));const r=this._gantt.parsedOptions.taskBarCreationMaxWidth,o=this._gantt.parsedOptions.taskBarCreationMinWidth,s=this._gantt.getDateColWidth(i),a=r?Math.min(r,o?Math.max(o,s):s):o?Math.max(o,s):s,l=t-(a-s)/2;this.taskCreationButton.show(l,e,a,this._gantt.parsedOptions.rowHeight),this.updateNextFrame()}hideTaskCreationButton(){this.taskCreationButton&&(this.taskCreationButton.hide(),this.updateNextFrame())}showToolTip(t){this.toolTip||(this.toolTip=new JG(this._gantt.scenegraph)),this.toolTip.show(t)}hideToolTip(){this.toolTip.hide()}refreshRecordLinkNodes(t,e,i,r=0){const o=this._gantt,s=o.getRecordByIndex(t,e),a=s.vtable_gantt_linkedTo,l=s.vtable_gantt_linkedFrom;for(let h=0;h<a?.length;h++){const u=a[h],d=u.vtable_gantt_linkLineNode,c=u.vtable_gantt_linkArrowNode,{linkedToTaskKey:f,linkedFromTaskKey:g,type:p}=u,{taskKeyField:v,minDate:m}=o.parsedOptions,y=Oa(o.records,v,g),b=Oa(o.records,v,f);let _,w,C,x,S,A,T,M,R;const E=this._gantt.getTaskBarStyle(t,e);if(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline){const k=vo(i.attribute.y+r,o);M=y.index[0],T=o.getRowsHeightByIndex(0,k.task_index-1)/o.parsedOptions.rowHeight,{startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(b.index[0],b.index[1]),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(y.index[0],y.index[1]);const L=E.width;R=i.attribute.y+L/2-(T+.5)*o.parsedOptions.rowHeight}else if(o.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline){const k=o.getTaskShowIndexByRecordIndex(y.index.slice(0,-1)),L=o.getTaskShowIndexByRecordIndex(b.index.slice(0,-1)),O=o.getRecordByIndex(k),D=o.getRecordByIndex(L);M=O.type===Me.PROJECT&&O.hierarchyState!=="expand"&&o.parsedOptions.projectSubTasksExpandable!==!1?k:o.getTaskShowIndexByRecordIndex(y.index),T=D.type===Me.PROJECT&&D.hierarchyState!=="expand"&&o.parsedOptions.projectSubTasksExpandable!==!1?L:o.getTaskShowIndexByRecordIndex(b.index),{startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(T,b.index),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(M,y.index)}else if(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact){const k=vo(i.attribute.y+r,o);M=o.getRowsHeightByIndex(0,y.index[0]-1)/o.parsedOptions.rowHeight+(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?y.record.vtable_gantt_showIndex:y.index[1]),T=o.getRowsHeightByIndex(0,k.task_index-1)/o.parsedOptions.rowHeight+(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?b.record.vtable_gantt_showIndex:k.sub_task_index),{startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(b.index[0],b.index[1]),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(y.index[0],y.index[1]);const L=E.width;R=i.attribute.y+L/2-(T+.5)*o.parsedOptions.rowHeight}else{if(M=o.getTaskShowIndexByRecordIndex(y.index),T=o.getTaskShowIndexByRecordIndex(b.index),M===-1||T===-1)continue;({startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(T)),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(M)}if(!(x&&S&&_&&w&&d&&c))return;const{linePoints:P,arrowPoints:B}=QG(p,x,S,M,A,y.record.type===Me.MILESTONE,null,0,_,w,T,C,b.record.type===Me.MILESTONE,i,R??0,this._gantt);d.setAttribute("points",P),c.setAttribute("points",B)}for(let h=0;h<l?.length;h++){const u=l[h],d=u.vtable_gantt_linkLineNode,c=u.vtable_gantt_linkArrowNode,{linkedToTaskKey:f,linkedFromTaskKey:g,type:p}=u,{taskKeyField:v,minDate:m}=o.parsedOptions,y=Oa(o.records,v,f),b=Oa(o.records,v,g);let _,w,C,x,S,A,T,M,R;const E=this._gantt.getTaskBarStyle(t,e);if(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline){const k=vo(i.attribute.y+r,o);M=o.getRowsHeightByIndex(0,k.task_index-1)/o.parsedOptions.rowHeight,T=y.index[0],{startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(y.index[0],y.index[1]),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(b.index[0],b.index[1]);const L=E.width;R=i.attribute.y+L/2-(M+.5)*o.parsedOptions.rowHeight}else if(o.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline){const k=o.getTaskShowIndexByRecordIndex(b.index.slice(0,-1)),L=o.getTaskShowIndexByRecordIndex(y.index.slice(0,-1)),O=o.getRecordByIndex(k),D=o.getRecordByIndex(L);M=O.type===Me.PROJECT&&O.hierarchyState!=="expand"&&o.parsedOptions.projectSubTasksExpandable!==!1?k:o.getTaskShowIndexByRecordIndex(b.index),T=D.type===Me.PROJECT&&D.hierarchyState!=="expand"&&o.parsedOptions.projectSubTasksExpandable!==!1?L:o.getTaskShowIndexByRecordIndex(y.index),{startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(T,y.index),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(M,b.index)}else if(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact){const k=vo(i.attribute.y+r,o);M=o.getRowsHeightByIndex(0,k.task_index-1)/o.parsedOptions.rowHeight+(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?b.record.vtable_gantt_showIndex:k.sub_task_index),T=o.getRowsHeightByIndex(0,y.index[0]-1)/o.parsedOptions.rowHeight+(o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||o.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?y.record.vtable_gantt_showIndex:y.index[1]),{startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(y.index[0],y.index[1]),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(b.index[0],b.index[1]);const L=E.width;R=i.attribute.y+L/2-(M+.5)*o.parsedOptions.rowHeight}else{if(M=o.getTaskShowIndexByRecordIndex(b.index),T=o.getTaskShowIndexByRecordIndex(y.index),M===-1||T===-1)continue;({startDate:_,endDate:w,taskDays:C}=o.getTaskInfoByTaskListIndex(T)),{startDate:x,endDate:S,taskDays:A}=o.getTaskInfoByTaskListIndex(M)}if(!(x&&S&&_&&w&&d&&c))return;const{linePoints:P,arrowPoints:B}=QG(p,x,S,M,A,b.record.type===Me.MILESTONE,i,R??0,_,w,T,C,y.record.type===Me.MILESTONE,null,0,this._gantt);d.setAttribute("points",P),c.setAttribute("points",B)}}}const N$t=n=>{switch(Object.prototype.toString.call(n)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},W$t=(n,t)=>N$t(n)===t,V$t=n=>W$t(n,"object");function TQ(n,t,e){let i,r,o,s,a,l,h=0,u=!1,d=!1,c=!0;const f=!t&&t!==0&&typeof requestAnimationFrame=="function";if(typeof n!="function")throw new TypeError("Expected a function");function g(y){const b=i,_=r;return r=void 0,i=void 0,h=y,s=n.apply(_,b),s}function p(y,b){return f?requestAnimationFrame(y):setTimeout(y,b)}function v(y){const b=y-l;return l===void 0||b>=t||b<0||u&&y-h>=o}function m(){const y=Date.now();if(v(y))return function(b){return a=void 0,c&&i?g(b):(r=void 0,i=void 0,s)}(y);a=p(m,function(b){const _=b-h,w=t&&-(b-l);return u?Math.min(w,o-_):w}(y))}return t=+t||0,V$t(e)&&(d=!!e.leading,u="maxWait"in e,u&&(o=Math.max(+e.maxWait||0,t)),c="trailing"in e?!!e.trailing:c),function(...y){const b=Date.now(),_=v(b);if(i=y,r=this,l=b,_){if(a===void 0)return function(w){return h=w,a=p(m,t),d?g(w):s}(l);if(u)return a=p(m,t),g(l)}return a===void 0&&(a=p(m,t)),s}}let G$t=1,$$t=class{constructor(t,e,i){var r;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const o=this.getSize();let s=!1;o.width===this.lastSize.width&&o.height===this.lastSize.height&&(s=!0),this.lastSize=o,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:s}))},this.onResize=()=>{this.callBackDebounce()},this.element=t,this.cb=e,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=TQ(this.callBack,this.resizeTime),window?.addEventListener("resize",this.onResize),"ResizeObserver"in window){const o=window.ResizeObserver;this.observer=new o(this.mutationResize),(r=this.observer)===null||r===void 0||r.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(t){this.lastSize=t}checkSize(){const t=this.getSize();return t.width!==this.lastSize.width||t.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}};class j$t{constructor(){this.listeners={},this.reseizeListeners={}}on(t,e,i,...r){if(Ko.mode==="node")return-1;const o=G$t++;if(t?.addEventListener)if(e!=="resize"||t===window)t?.addEventListener(e,i,...r);else{const a=new $$t(t,i,this.resizeTime);this.reseizeListeners[o]=a}const s={target:t,type:e,listener:i,options:r};return this.listeners[o]=s,o}once(t,e,i,...r){if(Ko.mode==="node")return-1;const o=this.on(t,e,(...s)=>{this.off(o),i(...s)},...r);return o}off(t){var e;if(Ko.mode==="node"||t==null)return;const i=(e=this.listeners)===null||e===void 0?void 0:e[t];i&&(delete this.listeners[t],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(t,e,...i){if(Ko.mode!=="node")for(const r in this.listeners){const o=this.listeners[r];o.target===t&&o.type===e&&o.listener.call(o.target,...i)}}hasListener(t,e){if(Ko.mode==="node")return!1;let i=!1;for(const r in this.listeners){const o=this.listeners[r];o.target===t&&o.type===e&&(i=!0)}return i}clear(){if(Ko.mode!=="node"){for(const t in this.listeners){const e=this.listeners[t];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(const t in this.reseizeListeners){const e=this.reseizeListeners[t];e?.disConnect()}this.listeners={}}}release(){Ko.mode!=="node"&&(this.clear(),this.listeners={})}}let pf=1;function MQ(){return nHt?pf=1:(pf=Math.ceil(window.devicePixelRatio||1),pf>1&&pf%2!=0&&(pf+=1)),pf}MQ();function U$t(n){const t=n._gantt,e=t.stateManager,i=t.scenegraph;if(Dt.envContribution.supportsTouchEvents===!1)return;Dt.addEventListener("contextmenu",a=>{a.stopPropagation(),a.preventDefault()},{capture:!0}),n.touchMovePoints=[],t.scenegraph.ganttGroup.addEventListener("touchstart",a=>{a.target.isChildOf(i.scrollbarComponent.vScrollBar)||a.target.isChildOf(i.scrollbarComponent.hScrollBar)||(n.isTouchdown=!0,n.touchMovePoints.push({x:a.page.x,y:a.page.y,timestamp:Date.now()}))});const r=a=>{if(n.isLongTouch&&a.preventDefault(),n.isTouchdown&&t8(a)&&(n.isTouchMove=!0,n.touchMovePoints.length>4&&n.touchMovePoints.shift(),n.touchMovePoints.push({x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY,timestamp:Date.now()}),n._enableTableScroll)){const l=-n.touchMovePoints[n.touchMovePoints.length-1].x+n.touchMovePoints[n.touchMovePoints.length-2].x,h=-n.touchMovePoints[n.touchMovePoints.length-1].y+n.touchMovePoints[n.touchMovePoints.length-2].y;Vk(a,e,t),a.cancelable&&(t.parsedOptions.overscrollBehavior==="none"||Math.abs(h)>=Math.abs(l)&&h!==0&&MZ(h,e)||Math.abs(h)<=Math.abs(l)&&l!==0&&RZ(l,e))&&a.preventDefault()}};Dt.addEventListener("touchmove",r,{passive:!1}),n.globalEventListeners.push({name:"touchmove",env:"vglobal",callback:r});const o=a=>{var l,h;if(n.touchEnd=!0,n.isLongTouch=!1,n.isTouchdown&&t8(a)){if(!((l=n.touchMovePoints)===null||l===void 0)&&l.length&&(n.touchMovePoints.length>4&&n.touchMovePoints.shift(),n.touchMovePoints.push({x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY,timestamp:Date.now()}),n._enableTableScroll)){const u=n.touchMovePoints[0],d=n.touchMovePoints[((h=n.touchMovePoints)===null||h===void 0?void 0:h.length)-1],c=(d.x-u.x)/(d.timestamp-u.timestamp),f=(d.y-u.y)/(d.timestamp-u.timestamp);n.inertiaScroll.startInertia(c,f,.95),t.eventManager.inertiaScroll.setScrollHandle((g,p)=>{Vk({deltaX:-g,deltaY:-p},t.stateManager,t)})}n.isTouchdown=!1,n.isTouchMove=!1,n.isDraging=!1,n.touchMovePoints=[]}};Dt.addEventListener("touchend",o),n.globalEventListeners.push({name:"touchend",env:"vglobal",callback:o});const s=a=>{n.touchEnd=!0,n.isLongTouch=!1,n.isTouchdown&&(n.isTouchdown=!1,n.isTouchMove=!1,n.touchMovePoints=[],n.isDraging=!1)};Dt.addEventListener("touchcancel",s),n.globalEventListeners.push({name:"touchcancel",env:"vglobal",callback:s})}function t8(n){return!!n.changedTouches}class RQ{constructor(){}setScrollHandle(t){this.scrollHandle=t}startInertia(t,e,i){this.stopped=!1,this.lastTime=Date.now(),this.speedX=t,this.speedY=e,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var t;if(this.stopped)return;const e=Date.now(),i=e-this.lastTime;let r=!0;const o=Math.pow(this.friction,i/16),s=o*this.speedX,a=o*this.speedY;let l=0,h=0;Math.abs(s)>.05&&(r=!1,l=(this.speedX+s)/2*i),Math.abs(a)>.05&&(r=!1,h=(this.speedY+a)/2*i),(t=this.scrollHandle)===null||t===void 0||t.call(this,l,h),r?this.runingId=null:(this.lastTime=e,this.speedX=s,this.speedY=a,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null,this.stopped=!0}isInertiaScrolling(){return!!this.runingId}}class X$t{constructor(t){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this._gantt=t,this.inertiaScroll=new RQ,this._eventHandler=new j$t,this.bindEvent()}release(){this._eventHandler.release(),this.globalEventListeners.forEach(t=>{t.env==="document"?document.removeEventListener(t.name,t.callback):t.env==="body"?document.body.removeEventListener(t.name,t.callback):t.env==="window"&&window.removeEventListener(t.name,t.callback)}),this.globalEventListeners=[],this.inertiaScroll.endInertia()}bindEvent(){Y$t(this),K$t(this),U$t(this)}}function Y$t(n){const t=n._gantt.scenegraph,e=n._gantt,i=e.stateManager;t.ganttGroup.addEventListener("pointerdown",r=>{if(r.button!==0)return;let o,s,a;if(r.detailPath.find(l=>l.name==="task-bar"?(o=l,!0):l.name==="task-creation-button"?!0:l.name==="task-bar-link-point-left"?(s=l,!0):l.name==="task-bar-link-point-right"?(a=l,!0):!!l.attribute.vtable_link&&(l.attribute.vtable_link,!0)),o){const l=o.record;if(l?.type!==Me.PROJECT){if(r.target.name==="task-bar-hover-shadow-left-icon")i.startResizeTaskBar(o,r.nativeEvent.x,r.nativeEvent.y,r.offset.y,"left"),i.updateInteractionState(Ve.grabing);else if(r.target.name==="task-bar-hover-shadow-right-icon")i.startResizeTaskBar(o,r.nativeEvent.x,r.nativeEvent.y,r.offset.y,"right"),i.updateInteractionState(Ve.grabing);else if(r.target.name==="task-bar-progress-handle")i.startAdjustProgressBar(o,r.nativeEvent.x,r.nativeEvent.y),i.updateInteractionState(Ve.grabing);else if(e.parsedOptions.taskBarMoveable){const h=()=>{let u=!0;if(typeof e.parsedOptions.taskBarMoveable=="function"){const{startDate:d,endDate:c,taskRecord:f}=t._gantt.getTaskInfoByTaskListIndex(o.task_index,o.sub_task_index),g={index:o.task_index,startDate:d,endDate:c,taskRecord:f,ganttInstance:t._gantt};u=e.parsedOptions.taskBarMoveable(g)}else u=e.parsedOptions.taskBarMoveable;u&&(i.startMoveTaskBar(o,r.nativeEvent.x,r.nativeEvent.y,r.offset.y),i.updateInteractionState(Ve.grabing))};r.pointerType==="touch"?(n.touchEnd=!1,n.touchSetTimeout=setTimeout(()=>{n.isTouchdown=!1,n.isLongTouch=!0,h()},100)):h()}}}else s?(i.startCreateDependencyLine(s,r.nativeEvent.x,r.nativeEvent.y,r.offset.y,"left"),i.updateInteractionState(Ve.grabing)):a&&(i.startCreateDependencyLine(a,r.nativeEvent.x,r.nativeEvent.y,r.offset.y,"right"),i.updateInteractionState(Ve.grabing))}),t.ganttGroup.addEventListener("pointermove",r=>{var o,s,a,l,h;if(n.touchSetTimeout&&(clearTimeout(n.touchSetTimeout),n.touchSetTimeout=void 0),i.interactionState===Ve.default){const u=r.detailPath.find(f=>f.name==="task-bar"),d=r.detailPath.find(f=>f.name==="markline-hover-group"),c=r.detailPath.find(f=>f.name==="mark-line-content");if(!((o=e.parsedOptions.markLineCreateOptions)===null||o===void 0)&&o.markLineCreatable&&(d&&!vHt(d.data,e.parsedOptions.markLine)?t._gantt.stateManager.marklineIcon.target!==d&&(t._gantt.stateManager.marklineIcon.target=d,i.showMarklineIconHover()):t._gantt.stateManager.marklineIcon.target&&i.hideMarklineIconHover()),u){if(t._gantt.stateManager.hoverTaskBar.target!==u){t._gantt.stateManager.hoverTaskBar.target=u;const f=u.task_index,g=u.sub_task_index,p=u.record;p.type!==Me.PROJECT&&i.showTaskBarHover(),t._gantt.hasListeners(de.MOUSEENTER_TASK_BAR)&&t._gantt.fireListeners(de.MOUSEENTER_TASK_BAR,{federatedEvent:r,event:r.nativeEvent,index:f,sub_task_index:g,record:p})}}else{if(t._gantt.stateManager.hoverTaskBar.target){if(t._gantt.hasListeners(de.MOUSELEAVE_TASK_BAR)){const f=t._gantt.stateManager.hoverTaskBar.target.task_index,g=t._gantt.stateManager.hoverTaskBar.target.sub_task_index,p=t._gantt.getRecordByIndex(f,g);t._gantt.fireListeners(de.MOUSELEAVE_TASK_BAR,{federatedEvent:r,event:r.nativeEvent,index:f,sub_task_index:g,record:p})}i.hideTaskBarHover(r)}if(e.parsedOptions.taskBarCreatable&&!c){const f=vo(r.offset.y-e.headerHeight+e.stateManager.scrollTop,e),g=e.getTaskInfoByTaskListIndex(f.task_index,f.sub_task_index);let p=!0;if(typeof e.parsedOptions.taskBarCreatable=="function"){const{startDate:v,endDate:m,taskRecord:y}=g,b={index:f.task_index,sub_task_index:f.sub_task_index,startDate:v,endDate:m,taskRecord:y,ganttInstance:e};p=e.parsedOptions.taskBarCreatable(b)}else p=e.parsedOptions.taskBarCreatable;if(p){const v=pHt(r.offset.x,r.offset.y,e);if((e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||e.parsedOptions.tasksShowMode===mt.Tasks_Separate)&&!g.taskDays&&g.taskRecord&&!g.taskRecord.vtableMerge||(e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact)&&!v){const m=og(r.offset.x,e),y=(m>=1?e.getDateColsWidth(0,m-1):0)-e.stateManager.scroll.horizontalBarPos,b=e.taskListTableInstance.getRowsHeight(e.taskListTableInstance.columnHeaderLevelCount,f.task_index+e.taskListTableInstance.columnHeaderLevelCount-1)+((s=f.sub_task_index)!==null&&s!==void 0?s:0)*e.parsedOptions.rowHeight-e.stateManager.scroll.verticalBarPos;return void e.scenegraph.showTaskCreationButton(y,b,m)}}}}e.scenegraph.hideTaskCreationButton()}else if(i.interactionState===Ve.grabing){let u,d,c;r.detailPath.find(f=>f.name==="task-bar"?(u=f,!0):f.name==="task-creation-button"?!0:f.name==="task-bar-link-point-left"?(d=f,!0):f.name==="task-bar-link-point-right"?(c=f,!0):!!f.attribute.vtable_link&&(f.attribute.vtable_link,!0)),u=(l=u??((a=d?.parent)===null||a===void 0?void 0:a.attribute.attachedToTaskBarNode))!==null&&l!==void 0?l:(h=c?.parent)===null||h===void 0?void 0:h.attribute.attachedToTaskBarNode,t._gantt.stateManager.isCreatingDependencyLine()&&!u?i.hideSecondTaskBarSelectedBorder():t._gantt.stateManager.isCreatingDependencyLine()&&d&&t._gantt.stateManager.selectedTaskBar.target!==u?(i.highlightLinkPointNode(d),i.creatingDenpendencyLink.lastHighLightLinkPoint=d,i.creatingDenpendencyLink.secondTaskBarPosition="left"):t._gantt.stateManager.isCreatingDependencyLine()&&c&&t._gantt.stateManager.selectedTaskBar.target!==u?(i.highlightLinkPointNode(c),i.creatingDenpendencyLink.lastHighLightLinkPoint=c,i.creatingDenpendencyLink.secondTaskBarPosition="right"):t._gantt.stateManager.isCreatingDependencyLine()&&u&&t._gantt.stateManager.selectedTaskBar.target!==u&&(i.unhighlightLinkPointNode(i.creatingDenpendencyLink.lastHighLightLinkPoint),i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode===u||(i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode!==u&&i.hideSecondTaskBarSelectedBorder(),i.creatingDenpendencyLink.secondTaskBarNode=u,i.showSecondTaskBarSelectedBorder()))}}),t.ganttGroup.addEventListener("pointerup",r=>{var o,s;if(n.touchSetTimeout&&(clearTimeout(n.touchSetTimeout),n.touchSetTimeout=void 0),r.button===0){let a,l,h,u=!1,d=!1,c=!1,f=!1,g=!1,p=!1,v=!1;const m=r.detailPath.find(y=>y.name==="task-bar"?(u=!0,!0):y.name==="task-creation-button"?(d=!0,!1):y.name==="task-bar-link-point-left"?(f=!0,!1):y.name==="task-bar-link-point-right"?(g=!0,!1):y.attribute.vtable_link?(c=!0,a=y.attribute.vtable_link,!1):y.name==="markline-hover-group"?(p=!0,h=y,!1):y.name==="mark-line-content"&&(v=!0,l=y,!1));if(u&&t._gantt.parsedOptions.taskBarSelectable&&n.poniterState==="down"){if(i.hideDependencyLinkSelectedLine(),i.showTaskBarSelectedBorder(m),e.hasListeners(de.CLICK_TASK_BAR)){const y=m.task_index,b=m.sub_task_index,_=e.getRecordByIndex(y,b);e.fireListeners(de.CLICK_TASK_BAR,{federatedEvent:r,event:r.nativeEvent,index:y,sub_task_index:b,record:_})}}else if(d&&n.poniterState==="down"){i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder();const y=vo(r.offset.y-e.headerHeight+e.stateManager.scrollTop,e);if(e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||e.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact){if(e.hasListeners(de.CREATE_TASK_SCHEDULE)){const b=og(r.offset.x,e),_=e.getDateRangeByIndex(b),w=(o=e.parsedOptions.dateFormat)!==null&&o!==void 0?o:e.parsedOptions.timeScaleIncludeHour?"yyyy-mm-dd hh:mm:ss":"yyyy-mm-dd";e.fireListeners(de.CREATE_TASK_SCHEDULE,{federatedEvent:r,event:r.nativeEvent,index:y.task_index,sub_task_index:y.sub_task_index,startDate:Sl(_.startDate,w),endDate:Sl(_.endDate,w),record:void 0,parentRecord:e.getRecordByIndex(y.task_index)})}}else{const b=e.getTaskInfoByTaskListIndex(y.task_index,y.sub_task_index);if(b.taskRecord){const _=(s=e.parsedOptions.dateFormat)!==null&&s!==void 0?s:e.parsedOptions.timeScaleIncludeHour?"yyyy-mm-dd hh:mm:ss":"yyyy-mm-dd",w=og(r.offset.x,e),C=e.getDateRangeByIndex(w);b.taskRecord[e.parsedOptions.startDateField]=Sl(C.startDate,_),b.taskRecord[e.parsedOptions.endDateField]=Sl(C.endDate,_),e.scenegraph.hideTaskCreationButton(),e.updateTaskRecord(b.taskRecord,y.task_index,y.sub_task_index),e.hasListeners(de.CREATE_TASK_SCHEDULE)&&e.fireListeners(de.CREATE_TASK_SCHEDULE,{federatedEvent:r,event:r.nativeEvent,index:y.task_index,sub_task_index:y.sub_task_index,startDate:b.taskRecord[e.parsedOptions.startDateField],endDate:b.taskRecord[e.parsedOptions.endDateField],record:b.taskRecord})}}}else if(c&&t._gantt.parsedOptions.dependencyLinkSelectable&&n.poniterState==="down")i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder(),t._gantt.stateManager.selectedDenpendencyLink.link=a,i.showDependencyLinkSelectedLine();else if((f||g)&&n.poniterState==="down"){if(e.hasListeners(de.CLICK_DEPENDENCY_LINK_POINT)){const y=vo(r.offset.y-e.headerHeight+e.stateManager.scrollTop,e),b=e.getRecordByIndex(y.task_index,y.sub_task_index);e.fireListeners(de.CLICK_DEPENDENCY_LINK_POINT,{event:r.nativeEvent,index:y.task_index,sub_task_index:y.sub_task_index,point:f?"start":"end",record:b})}i.hideTaskBarSelectedBorder()}else if(p&&n.poniterState==="down")e.hasListeners(de.CLICK_MARKLINE_CREATE)&&e.fireListeners(de.CLICK_MARKLINE_CREATE,{event:r.nativeEvent,position:R6(h,t._gantt),data:t._gantt.stateManager.marklineIcon.target.data});else if(v&&n.poniterState==="down")e.hasListeners(de.CLICK_MARKLINE_CONTENT)&&e.fireListeners(de.CLICK_MARKLINE_CONTENT,{event:r.nativeEvent,position:R6(l,t._gantt),data:l.data});else if(f&&n.poniterState==="draging"){if(i.isCreatingDependencyLine()){const y=i.endCreateDependencyLine(r.offset.y);e.hasListeners(de.CREATE_DEPENDENCY_LINK)&&e.fireListeners(de.CREATE_DEPENDENCY_LINK,{federatedEvent:r,event:r.nativeEvent,link:y})}}else if(g&&n.poniterState==="draging"){if(i.isCreatingDependencyLine()){const y=i.endCreateDependencyLine(r.offset.y);e.hasListeners(de.CREATE_DEPENDENCY_LINK)&&e.fireListeners(de.CREATE_DEPENDENCY_LINK,{federatedEvent:r,event:r.nativeEvent,link:y})}}else i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder()}}),t.ganttGroup.addEventListener("rightdown",r=>{let o,s=!1,a=!1;const l=r.detailPath.find(h=>h.name==="task-bar"?(s=!0,!0):!!h.attribute.vtable_link&&(a=!0,o=h.attribute.vtable_link,!1));if(s){if(e.hasListeners(de.CONTEXTMENU_TASK_BAR)){const h=l.task_index,u=l.sub_task_index,d=e.getRecordByIndex(h,u);e.fireListeners(de.CONTEXTMENU_TASK_BAR,{federatedEvent:r,event:r.nativeEvent,index:h,sub_task_index:u,record:d})}}else a&&e.hasListeners(de.CONTEXTMENU_DEPENDENCY_LINK)&&e.fireListeners(de.CONTEXTMENU_DEPENDENCY_LINK,{federatedEvent:r,event:r.nativeEvent,link:o})}),t.ganttGroup.addEventListener("pointerenter",r=>{(e.parsedOptions.scrollStyle.horizontalVisible&&e.parsedOptions.scrollStyle.horizontalVisible==="focus"||!e.parsedOptions.scrollStyle.horizontalVisible&&e.parsedOptions.scrollStyle.visible==="focus")&&t.scrollbarComponent.showHorizontalScrollBar(),(e.parsedOptions.scrollStyle.verticalVisible&&e.parsedOptions.scrollStyle.verticalVisible==="focus"||!e.parsedOptions.scrollStyle.verticalVisible&&e.parsedOptions.scrollStyle.visible==="focus")&&t.scrollbarComponent.showVerticalScrollBar()}),t.ganttGroup.addEventListener("pointerleave",r=>{if((e.parsedOptions.scrollStyle.horizontalVisible&&e.parsedOptions.scrollStyle.horizontalVisible==="focus"||!e.parsedOptions.scrollStyle.horizontalVisible&&e.parsedOptions.scrollStyle.visible==="focus")&&t.scrollbarComponent.hideHorizontalScrollBar(),(e.parsedOptions.scrollStyle.verticalVisible&&e.parsedOptions.scrollStyle.verticalVisible==="focus"||!e.parsedOptions.scrollStyle.verticalVisible&&e.parsedOptions.scrollStyle.visible==="focus")&&t.scrollbarComponent.hideVerticalScrollBar(),t._gantt.stateManager.hoverTaskBar.target){if(t._gantt.hasListeners(de.MOUSELEAVE_TASK_BAR)){const o=t._gantt.stateManager.hoverTaskBar.target.task_index,s=t._gantt.stateManager.hoverTaskBar.target.sub_task_index,a=t._gantt.getRecordByIndex(o,s);t._gantt.fireListeners(de.MOUSELEAVE_TASK_BAR,{federatedEvent:r,event:r.nativeEvent,index:o,sub_task_index:s,record:a})}i.hideTaskBarHover(r)}}),t.ganttGroup.addEventListener("wheel",r=>{Vk(r,i,e)})}function K$t(n){const t=n._gantt,e=(n._gantt.scenegraph,t.stateManager),i=n._eventHandler;i.on(t.getElement(),"contextmenu",l=>{var h;((h=t.parsedOptions.eventOptions)===null||h===void 0?void 0:h.preventDefaultContextMenu)!==!1&&l.preventDefault()}),i.on(t.getContainer(),"resize",l=>{l.width===0&&l.height===0||(Y(t.options.pixelRatio)||t.setPixelRatio(MQ()),l.windowSizeNotChange||t._resize())}),t.taskListTableInstance&&t.parsedOptions.verticalSplitLineMoveable&&i.on(t.verticalSplitResizeLine,"mousedown",l=>{e.updateInteractionState(Ve.grabing),e.startResizeTableWidth(l)}),t.parsedOptions.verticalSplitLineHighlight&&(t.verticalSplitResizeLine&&i.on(t.verticalSplitResizeLine,"mouseover",l=>{t.verticalSplitResizeLine.childNodes[1].style.opacity="1"}),t.verticalSplitResizeLine&&i.on(t.verticalSplitResizeLine,"mouseout",l=>{t.verticalSplitResizeLine.childNodes[1].style.opacity="0"}));const r=l=>{t.eventManager.lastDragPointerXYOnWindow={x:l.x,y:l.y},t.eventManager.poniterState="down"};n.globalEventListeners.push({name:"pointerdown",env:"document",callback:r}),Dt.addEventListener("pointerdown",r);const o=l=>{var h,u,d,c,f,g;if(t.eventManager.poniterState==="down"){const p=(h=t.eventManager.lastDragPointerXYOnWindow.x)!==null&&h!==void 0?h:l.x,v=l.x-p,m=(u=t.eventManager.lastDragPointerXYOnWindow.y)!==null&&u!==void 0?u:l.y,y=l.y-m;(Math.abs(v)>=1||Math.abs(y)>=1)&&(t.eventManager.poniterState="draging")}if(e.interactionState===Ve.grabing&&t.eventManager.poniterState==="draging"){const p=(c=(d=t.eventManager.lastDragPointerXYOnWindow)===null||d===void 0?void 0:d.x)!==null&&c!==void 0?c:l.x,v=(g=(f=t.eventManager.lastDragPointerXYOnWindow)===null||f===void 0?void 0:f.y)!==null&&g!==void 0?g:l.y;(Math.abs(p-l.x)>=1||Math.abs(v-l.y)>=1)&&(e.isResizingTableWidth()?(e.hideDependencyLinkSelectedLine(),e.hideTaskBarSelectedBorder(),e.dealResizeTableWidth(l)):e.isMoveingTaskBar()?(e.hideDependencyLinkSelectedLine(),e.hideTaskBarSelectedBorder(),e.dealTaskBarMove(l)):e.isResizingTaskBar()?(e.hideDependencyLinkSelectedLine(),e.hideTaskBarSelectedBorder(),e.dealTaskBarResize(l)):e.isAdjustingProgressBar()?e.dealAdjustProgressBar(l):e.isCreatingDependencyLine()&&e.dealCreateDependencyLine(l),t.eventManager.lastDragPointerXYOnWindow={x:l.x,y:l.y})}};n.globalEventListeners.push({name:"pointermove",env:"document",callback:o}),Dt.addEventListener("pointermove",o);const s=l=>{e.interactionState==="grabing"&&(e.updateInteractionState(Ve.default),e.isResizingTableWidth()?e.endResizeTableWidth():e.isMoveingTaskBar()?e.endMoveTaskBar():e.isResizingTaskBar()?e.endResizeTaskBar(l.x):e.isAdjustingProgressBar()&&e.endAdjustProgressBar(l.x)),setTimeout(()=>{t.eventManager.lastDragPointerXYOnWindow=void 0,t.eventManager.poniterState="up"},0)};n.globalEventListeners.push({name:"pointerup",env:"document",callback:s}),Dt.addEventListener("pointerup",s);const a=l=>{var h,u;if(t.parsedOptions.dependencyLinkDeletable&&(l.key==="Delete"&&(!((h=t.parsedOptions.keyboardOptions)===null||h===void 0)&&h.deleteLinkOnDel)||l.key==="Backspace"&&(!((u=t.parsedOptions.keyboardOptions)===null||u===void 0)&&u.deleteLinkOnBack))&&t.stateManager.selectedDenpendencyLink.link){const d=t.stateManager.selectedDenpendencyLink.link;t.deleteLink(t.stateManager.selectedDenpendencyLink.link),e.hideDependencyLinkSelectedLine(),e.hideTaskBarSelectedBorder(),t.hasListeners(de.DELETE_DEPENDENCY_LINK)&&t.fireListeners(de.DELETE_DEPENDENCY_LINK,{event:l,link:d})}};n.globalEventListeners.push({name:"keydown",env:"document",callback:a}),Dt.addEventListener("keydown",a)}function e8(n){const{scroll:t}=n.stateManager,{verticalBarPos:e}=t;n.taskListTableInstance.stateManager.setScrollTop(e,void 0,!1)}function q$t(n){var t;n.taskListTableInstance&&((t=n.taskListTableInstance)===null||t===void 0||t.on("scroll",e=>{if(e.scrollDirection==="vertical"){const{scroll:i}=n.taskListTableInstance.stateManager,{verticalBarPos:r}=i;n.stateManager.scroll.verticalBarPos!==r&&n.stateManager.setScrollTop(r,!1)}}))}function Z$t(n){var t;(t=n.taskListTableInstance)===null||t===void 0||t.on("change_cell_value",e=>{const{col:i,row:r}=e;n.taskListTableInstance.isHeader(i,r)||n._refreshTaskBar(r-n.taskListTableInstance.columnHeaderLevelCount)})}function J$t(n){var t;(t=n.taskListTableInstance)===null||t===void 0||t.on("tree_hierarchy_state_change",e=>{var i,r;const{row:o,hierarchyState:s}=e;if(n.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline){const h=o-n.taskListTableInstance.columnHeaderLevelCount,u=n.getRecordByIndex(h);u&&u.type===Me.PROJECT&&((i=u.children)===null||i===void 0?void 0:i.length)>0&&(u.hierarchyState=s)}n._syncPropsFromTable(),n.scenegraph.refreshTaskBarsAndGrid(),!n.taskListTableInstance.checkHasColumnAutoWidth()||((r=n.options.taskListTable)===null||r===void 0?void 0:r.tableWidth)!=="auto"&&n.taskTableWidth!==-1||BQ(n);const a=n.stateManager.scroll.horizontalBarPos,l=n.stateManager.scroll.verticalBarPos;n.scenegraph.setX(-a),n.scenegraph.setY(-l)})}function Q$t(n){var t;(t=n.taskListTableInstance)===null||t===void 0||t.on("after_sort",e=>{n.scenegraph.refreshTaskBars();const i=n.stateManager.scroll.horizontalBarPos,r=n.stateManager.scroll.verticalBarPos;n.scenegraph.setX(-i),n.scenegraph.setY(-r)})}function t7t(n){var t,e,i,r;(t=n.taskListTableInstance)===null||t===void 0||t.on("change_header_position",o=>{n.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact||n.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||n.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline?n.scenegraph.refreshTaskBarsAndGrid():n.scenegraph.refreshTaskBars(),n.scenegraph.dragOrderLine.hideDragLine();const s=n.stateManager.scroll.horizontalBarPos,a=n.stateManager.scroll.verticalBarPos;n.scenegraph.setX(-s),n.scenegraph.setY(-a)}),(e=n.taskListTableInstance)===null||e===void 0||e.on("change_header_position_start",o=>{const{col:s,row:a,x:l,y:h,backX:u,lineX:d,backY:c,lineY:f,event:g}=o;n.scenegraph.dragOrderLine.showDragLine(f),n.scenegraph.updateNextFrame()}),(i=n.taskListTableInstance)===null||i===void 0||i.on("changing_header_position",o=>{const{col:s,row:a,x:l,y:h,backX:u,lineX:d,backY:c,lineY:f,event:g}=o;n.scenegraph.dragOrderLine.showDragLine(f),n.scenegraph.updateNextFrame()}),(r=n.taskListTableInstance)===null||r===void 0||r.on("change_header_position_fail",o=>{n.scenegraph.dragOrderLine.hideDragLine(),n.scenegraph.updateNextFrame()})}function e7t(n){var t;(t=n.taskListTableInstance)===null||t===void 0||t.on("resize_column",e=>{BQ(n)})}function BQ(n){var t,e,i,r,o,s,a,l;const h=n.taskTableWidth;n.taskTableWidth=n.taskListTableInstance.getAllColsWidth()+n.parsedOptions.outerFrameStyle.borderLineWidth,!((e=(t=n.options)===null||t===void 0?void 0:t.taskListTable)===null||e===void 0)&&e.maxTableWidth&&(n.taskTableWidth=Math.min((r=(i=n.options)===null||i===void 0?void 0:i.taskListTable)===null||r===void 0?void 0:r.maxTableWidth,n.taskTableWidth)),!((s=(o=n.options)===null||o===void 0?void 0:o.taskListTable)===null||s===void 0)&&s.minTableWidth&&(n.taskTableWidth=Math.max((l=(a=n.options)===null||a===void 0?void 0:a.taskListTable)===null||l===void 0?void 0:l.minTableWidth,n.taskTableWidth)),h!==n.taskTableWidth&&(n.element.style.left=n.taskTableWidth?`${n.taskTableWidth}px`:"0px",n.taskListTableInstance.setCanvasSize(n.taskTableWidth,n.tableNoFrameHeight+2*n.parsedOptions.outerFrameStyle.borderLineWidth),n._updateSize(),yC(n))}class i7t{constructor(t){var e;this.interactionState=Ve.default,this.resetInteractionState=TQ(()=>{this.updateInteractionState(Ve.default)},100),this._gantt=t,this.scroll={horizontalBarPos:0,verticalBarPos:0},this.moveTaskBar={targetStartX:null,targetStartY:null,deltaX:0,deltaY:0,startOffsetY:null,startX:null,startY:null,moving:!1,target:null,moveTaskBarXSpeed:0,moveTaskBarXInertia:new RQ},this.hoverTaskBar={targetStartX:null,startX:null,target:null},this.marklineIcon={target:null},this.selectedTaskBar={target:null},this.resizeTaskBar={startOffsetY:null,targetStartX:null,targetEndX:null,startX:null,startY:null,target:null,resizing:!1,onIconName:""},this.adjustProgressBar={startX:null,startY:null,target:null,adjusting:!1,originalProgress:0},this.resizeTableWidth={lastX:null,resizing:!1},this.selectedDenpendencyLink={link:null},this.creatingDenpendencyLink={startClickedPoint:null,startX:null,startY:null,startOffsetY:null,targetStartX:null,creating:!1,secondTaskBarNode:null},this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this),q$t(this._gantt),Z$t(this._gantt),t7t(this._gantt),J$t(this._gantt),Q$t(this._gantt),((e=this._gantt.options.taskListTable)===null||e===void 0?void 0:e.tableWidth)!=="auto"&&this._gantt.taskTableWidth!==-1||e7t(this._gantt)}setScrollTop(t,e=!0){const i=this._gantt.getAllRowsHeight();t=Math.max(0,Math.min(t,i-this._gantt.scenegraph.height)),t=Math.ceil(t);const r=this.scroll.verticalBarPos;this.scroll.verticalBarPos=t,Y(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-t);const o=t/(i-this._gantt.scenegraph.height);this._gantt.scenegraph.scrollbarComponent.updateVerticalScrollBarPos(o),r!==t&&e&&(e8(this._gantt),this._gantt.fireListeners(de.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:o}))}get scrollLeft(){return this.scroll.horizontalBarPos}get scrollTop(){return this.scroll.verticalBarPos}setScrollLeft(t,e=!0){const i=this._gantt.getAllDateColsWidth();t=Math.max(0,Math.min(t,i-this._gantt.scenegraph.width)),t=Math.ceil(t);const r=this.scroll.horizontalBarPos;this.scroll.horizontalBarPos=t,Y(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-t);const o=t/(i-this._gantt.scenegraph.width);this._gantt.scenegraph.scrollbarComponent.updateHorizontalScrollBarPos(o),r!==t&&e&&this._gantt.fireListeners(de.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioX:o})}updateInteractionState(t){if(this.interactionState===t)return;const e=this.interactionState;this.interactionState=t,e===Ve.scrolling&&Ve.default}updateVerticalScrollBar(t){const e=this._gantt.getAllRowsHeight();this.scroll.verticalBarPos,this.scroll.verticalBarPos=Math.ceil(t*(e-this._gantt.scenegraph.height)),Y(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-this.scroll.verticalBarPos,t===1),e8(this._gantt),this._gantt.fireListeners(de.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:t})}updateHorizontalScrollBar(t){const e=this._gantt.getAllDateColsWidth();this.scroll.horizontalBarPos,this.scroll.horizontalBarPos=Math.ceil(t*(e-this._gantt.scenegraph.width)),Y(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-this.scroll.horizontalBarPos,t===1),this._gantt.fireListeners(de.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioY:t})}startMoveTaskBar(t,e,i,r){t.name==="task-bar-hover-shadow"&&(t=t.parent),this.moveTaskBar.moving=!0,this.moveTaskBar.target=t,this.moveTaskBar.targetStartX=t.attribute.x,this.moveTaskBar.targetStartY=t.attribute.y,this.moveTaskBar.startX=e,this.moveTaskBar.startY=i,this.moveTaskBar.startOffsetY=r,t.setAttribute("zIndex",1e4)}isMoveingTaskBar(){return this.moveTaskBar.moving}endMoveTaskBar(){this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()&&this.moveTaskBar.moveTaskBarXInertia.endInertia();const t=this.moveTaskBar.deltaX,e=this.moveTaskBar.deltaY,i=this.moveTaskBar.target;if(Math.abs(t)>=1||Math.abs(e)>=1){const r=i.task_index,o=i.task_index,s=i.sub_task_index,{startDate:a,endDate:l}=this._gantt.getTaskInfoByTaskListIndex(o,s),h=this.moveTaskBar.targetStartY+this._gantt.parsedOptions.rowHeight*Math.round(e/this._gantt.parsedOptions.rowHeight),u=this._gantt.parsedOptions.taskBarMilestoneStyle.width,d=this.moveTaskBar.target.attribute.x+(i.record.type===Me.MILESTONE?u/2:0),c=og(d-this._gantt.stateManager.scroll.horizontalBarPos,this._gantt),f=this._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates[c];if(!f)return;const g=f.startDate,p=new Date(g.getTime()+(Ai(l).getTime()-Ai(a).getTime()));let v;if(Ai(a).getTime()!==g.getTime()){v=Ai(a).getTime()>g.getTime()?"left":"right",this._gantt._updateStartEndDateToTaskRecord(g,p,o,s);const m=this._gantt.getRecordByIndex(o,s);this._gantt.hasListeners(de.CHANGE_DATE_RANGE)&&this._gantt.fireListeners(de.CHANGE_DATE_RANGE,{startDate:m[this._gantt.parsedOptions.startDateField],endDate:m[this._gantt.parsedOptions.endDateField],oldStartDate:a,oldEndDate:l,index:o,record:m});const y=vo(h,this._gantt).task_index;this._gantt.hasListeners(de.MOVE_END_TASK_BAR)&&this._gantt.fireListeners(de.MOVE_END_TASK_BAR,{startDate:m[this._gantt.parsedOptions.startDateField],endDate:m[this._gantt.parsedOptions.endDateField],oldStartDate:a,oldEndDate:l,oldRowIndex:r,newRowIndex:y,index:o,record:m})}else{const m=this._gantt.getRecordByIndex(o,s),y=vo(h,this._gantt).task_index;this._gantt.hasListeners(de.MOVE_END_TASK_BAR)&&this._gantt.fireListeners(de.MOVE_END_TASK_BAR,{startDate:m[this._gantt.parsedOptions.startDateField],endDate:m[this._gantt.parsedOptions.endDateField],oldStartDate:a,oldEndDate:l,oldRowIndex:r,newRowIndex:y,index:y,record:m})}if(this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact){const m=vo(h,this._gantt);this._gantt._dragOrderTaskRecord(i.task_index,i.sub_task_index,m.task_index,m.sub_task_index),PZ(this._gantt.records),this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt._syncPropsFromTable(),this._gantt.scenegraph.refreshTaskBarsAndGrid()}else if(this._gantt.parsedOptions.tasksShowMode!==mt.Tasks_Separate&&Math.abs(Math.round(e/this._gantt.parsedOptions.rowHeight))>=1){const m=vo(h,this._gantt);this._gantt._dragOrderTaskRecord(i.task_index,i.sub_task_index,m.task_index,m.sub_task_index),this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate?(this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt.scenegraph.refreshTaskBarsAndGrid()):(this._gantt.scenegraph.taskBar.refresh(),this._gantt.scenegraph.dependencyLink.refresh())}else{let m=c>=1?this._gantt.getDateColsWidth(0,c-1):0;if(i.record.type===Me.MILESTONE&&(m-=this._gantt.parsedOptions.taskBarMilestoneStyle.width/2),vf(i,m-i.attribute.x,h-i.attribute.y,this),v==="right"){let y=i;for(;y.nextSibling&&y.nextSibling.attribute.y===i.attribute.y&&y.nextSibling.record[this._gantt.parsedOptions.startDateField]<=i.record[this._gantt.parsedOptions.startDateField];)y=y.nextSibling;y!==i&&y.parent.insertAfter(i,y)}else if(v==="left"){let y=i;for(;y.previousSibling&&y.previousSibling.attribute.y===i.attribute.y&&y.previousSibling.record[this._gantt.parsedOptions.startDateField]>=i.record[this._gantt.parsedOptions.startDateField];)y=y.previousSibling;y!==i&&y.parent.insertBefore(i,y)}}this._gantt.scenegraph.updateNextFrame()}this.moveTaskBar.moving=!1,this.selectedTaskBar.target!==i&&i.setAttribute("zIndex",0),i.updateTextPosition(),this.moveTaskBar.target=null,this.moveTaskBar.deltaX=0,this.moveTaskBar.deltaY=0,this.moveTaskBar.moveTaskBarXSpeed=0}dealTaskBarMove(t){var e,i,r,o,s,a;const l=this._gantt;let h=this.moveTaskBar.target;h.setAttribute("zIndex",1e4);const u=l.eventManager.lastDragPointerXYOnWindow.x,d=t.x-u,c=l.eventManager.lastDragPointerXYOnWindow.y,f=t.y-c;if(this.moveTaskBar.deltaX+=d,this.moveTaskBar.deltaY+=f,vf(h,d,f,this),h.attribute.x<=l.stateManager.scrollLeft&&d<0)if(l.parsedOptions.moveTaskBarToExtendDateRange&&l.stateManager.scrollLeft===0){(e=this.moveTaskBar.moveTaskBarXInertia)===null||e===void 0||e.endInertia();const g=l.parsedOptions.reverseSortedTimelineScales[0].timelineDates[1].startDate.getTime()-l.parsedOptions.reverseSortedTimelineScales[0].timelineDates[0].startDate.getTime(),{unit:p,startOfWeek:v}=l.parsedOptions.reverseSortedTimelineScales[0];l.parsedOptions.minDate=_c(new Date(l.parsedOptions.reverseSortedTimelineScales[0].timelineDates[0].startDate.getTime()-g/2),p,v),l.parsedOptions._minDateTime=(i=l.parsedOptions.minDate)===null||i===void 0?void 0:i.getTime(),l._generateTimeLineDateMap(),l._updateSize(),l.scenegraph.refreshAll(),h=this.moveTaskBar.target=l.scenegraph.taskBar.getTaskBarNodeByIndex(this.moveTaskBar.target.task_index,this.moveTaskBar.target.sub_task_index),l.scrollLeft=l.parsedOptions.timelineColWidth-1,l.eventManager.lastDragPointerXYOnWindow.x=t.x,((r=h.record)===null||r===void 0?void 0:r.type)==="milestone"?vf(h,l.scrollLeft-h.attribute.x,0,this):h.setAttribute("x",l.scrollLeft)}else this.moveTaskBar.moveTaskBarXSpeed=-l.parsedOptions.timelineColWidth/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((g,p)=>{this.moveTaskBar.deltaX+=g,this.moveTaskBar.deltaY+=p,vf(h,g,p,this),l.stateManager.setScrollLeft(h.attribute.x),l.stateManager.scrollLeft===0&&this.moveTaskBar.moveTaskBarXInertia.endInertia()});else if(h.attribute.x+h.attribute.width>=l.stateManager.scrollLeft+l.tableNoFrameWidth&&d>0)if(l.parsedOptions.moveTaskBarToExtendDateRange&&l.stateManager.scrollLeft+l.tableNoFrameWidth===l.getAllDateColsWidth()){(o=this.moveTaskBar.moveTaskBarXInertia)===null||o===void 0||o.endInertia();const g=l.parsedOptions.reverseSortedTimelineScales[0].timelineDates,p=g[1].startDate.getTime()-g[0].startDate.getTime(),{unit:v,startOfWeek:m,step:y}=l.parsedOptions.reverseSortedTimelineScales[0];if(l.parsedOptions.maxDate=ap(l.parsedOptions.minDate,new Date(g[g.length-1].endDate.getTime()+p/2),v,y),l.parsedOptions._maxDateTime=(s=l.parsedOptions.maxDate)===null||s===void 0?void 0:s.getTime(),l._generateTimeLineDateMap(),l._updateSize(),l.scenegraph.refreshAll(),h=this.moveTaskBar.target=l.scenegraph.taskBar.getTaskBarNodeByIndex(this.moveTaskBar.target.task_index,this.moveTaskBar.target.sub_task_index),l.scrollLeft+=1,l.eventManager.lastDragPointerXYOnWindow.x=t.x,((a=h.record)===null||a===void 0?void 0:a.type)==="milestone"){const b=l.scrollLeft+l.tableNoFrameWidth-h.attribute.width;vf(h,b-h.attribute.x,0,this)}else h.setAttribute("x",l.scrollLeft+l.tableNoFrameWidth-h.attribute.width)}else this.moveTaskBar.moveTaskBarXSpeed=l.parsedOptions.timelineColWidth/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((g,p)=>{this.moveTaskBar.deltaX+=g,this.moveTaskBar.deltaY+=p,vf(h,g,p,this),l.stateManager.setScrollLeft(h.attribute.x+h.attribute.width-l.tableNoFrameWidth),l.stateManager.scrollLeft===l.getAllDateColsWidth()-l.tableNoFrameWidth&&this.moveTaskBar.moveTaskBarXInertia.endInertia()});else this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()?this.moveTaskBar.moveTaskBarXInertia.endInertia():this.moveTaskBar.moveTaskBarXSpeed=0;l.scenegraph.updateNextFrame()}startResizeTaskBar(t,e,i,r,o){this.resizeTaskBar.onIconName=o,this.resizeTaskBar.resizing=!0,this.resizeTaskBar.target=t,this.resizeTaskBar.targetStartX=t.attribute.x,this.resizeTaskBar.targetEndX=t.attribute.x+t.attribute.width,this.resizeTaskBar.startX=e,this.resizeTaskBar.startY=i,this.resizeTaskBar.startOffsetY=r}isResizingTaskBar(){return this.resizeTaskBar.resizing}endResizeTaskBar(t){const e=this._gantt.stateManager.resizeTaskBar.onIconName,i=t-this.resizeTaskBar.startX;if(Math.abs(i)>=1){const r=og((e==="left"?this.resizeTaskBar.target.attribute.x:this.resizeTaskBar.target.attribute.x+this.resizeTaskBar.target.attribute.width)-this._gantt.stateManager.scroll.horizontalBarPos,this._gantt),o=this._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates[r];if(!o)return;const s=e==="left"?o.startDate:o.endDate,a=this.resizeTaskBar.target,l=a.clipGroupBox,h=a.barRect,u=a.progressRect,d=a.textLabel,c=a.task_index,f=a.sub_task_index,{taskDays:g,progress:p,startDate:v,endDate:m}=this._gantt.getTaskInfoByTaskListIndex(c,f);let y=!1;if(e==="left"?(this._gantt._updateStartDateToTaskRecord(s,c,f),s.getTime()!==new Date(v).getTime()&&(y=!0)):(this._gantt._updateEndDateToTaskRecord(s,c,f),s.getTime()!==new Date(m).getTime()&&(y=!0)),this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact)this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt._syncPropsFromTable(),this._gantt.scenegraph.refreshTaskBarsAndGrid();else{if(e==="left"){const b=r>=1?this._gantt.getDateColsWidth(0,r-1):0;a.setAttribute("x",b),a.setAttribute("width",this.resizeTaskBar.targetEndX-b)}else if(e==="right"){const b=this._gantt.getDateColsWidth(0,r);a.setAttribute("width",b-this.resizeTaskBar.targetStartX)}if(l.setAttribute("width",a.attribute.width),h?.setAttribute("width",a.attribute.width),u?.setAttribute("width",p/100*a.attribute.width),d){const{textAlign:b,textBaseline:_,padding:w}=this._gantt.parsedOptions.taskBarLabelStyle,C=Dy(Oy(w),b,_,a.attribute.width,a.attribute.height);d.setAttribute("maxLineWidth",a.attribute.width-2*AQ),d.setAttribute("x",C.x)}this._gantt.scenegraph.refreshRecordLinkNodes(c,f,a,0),this.showTaskBarHover(),PQ(this._gantt,a,c,f),a.setAttribute("zIndex",0)}if(a.updateTextPosition(),this.resizeTaskBar.resizing=!1,this.resizeTaskBar.target=null,y&&this._gantt.hasListeners(de.CHANGE_DATE_RANGE)){const b=this._gantt.getRecordByIndex(c,f);this._gantt.fireListeners(de.CHANGE_DATE_RANGE,{startDate:b[this._gantt.parsedOptions.startDateField],endDate:b[this._gantt.parsedOptions.endDateField],oldStartDate:v,oldEndDate:m,index:c,record:b})}this._gantt.scenegraph.updateNextFrame()}}dealTaskBarResize(t){const e=this._gantt.eventManager.lastDragPointerXYOnWindow.x,i=t.x-e,r=this._gantt.stateManager.resizeTaskBar.target;let o=this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-i:i;const s=Math.max(1,r.attribute.width+o);o=s-r.attribute.width,n7t(r,this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-o:0,s,this),this._gantt.scenegraph.updateNextFrame()}startAdjustProgressBar(t,e,i){const{progress:r}=this._gantt.getTaskInfoByTaskListIndex(t.task_index,t.sub_task_index);this.adjustProgressBar.target=t,this.adjustProgressBar.adjusting=!0,this.adjustProgressBar.startX=e,this.adjustProgressBar.startY=i,this.adjustProgressBar.originalProgress=r}isAdjustingProgressBar(){return this.adjustProgressBar.adjusting}endAdjustProgressBar(t){const e=this.adjustProgressBar.target,i=e.attribute.width,r=t-this.adjustProgressBar.startX,o=Math.max(0,Math.min(100,this.adjustProgressBar.originalProgress+r/i*100));if(Math.abs(o-this.adjustProgressBar.originalProgress)>=.1){const s=e.task_index,a=e.sub_task_index;this._gantt._updateProgressToTaskRecord(Math.round(10*o)/10,s,a);const l=this._gantt.getRecordByIndex(s,a);this._gantt.hasListeners(de.PROGRESS_UPDATE)&&this._gantt.fireListeners(de.PROGRESS_UPDATE,{federatedEvent:null,event:null,index:s,sub_task_index:a,progress:Math.round(10*o)/10,oldProgress:Math.round(10*this.adjustProgressBar.originalProgress)/10,record:l})}this.adjustProgressBar.adjusting=!1,this.adjustProgressBar.target=null,this.adjustProgressBar.startX=null,this.adjustProgressBar.startY=null,this.adjustProgressBar.originalProgress=0}dealAdjustProgressBar(t){const e=this.adjustProgressBar.target,i=e.attribute.width,r=t.x-this.adjustProgressBar.startX,o=Math.max(0,Math.min(100,this.adjustProgressBar.originalProgress+r/i*100));if(e.progressRect&&e.progressRect.setAttribute("width",i*o/100),this._gantt.scenegraph.taskBar.hoverBarProgressHandle&&this._gantt.scenegraph.taskBar.hoverBarProgressHandle.attribute.visibleAll&&this._gantt.scenegraph.taskBar.hoverBarProgressHandle.setAttribute("x",i*o/100-6),e.textLabel&&e.record){const s=Object.assign(Object.assign({},e.record),{progress:Math.round(10*o)/10}),a=xZ(this._gantt.parsedOptions.taskBarLabelText,s);e.textLabel.setAttribute("text",a)}this._gantt.scenegraph&&this._gantt.scenegraph.stage&&this._gantt.scenegraph.stage.renderNextFrame()}startCreateDependencyLine(t,e,i,r,o){this.resizeTaskBar.resizing=!1,this.creatingDenpendencyLink.creating=!0,this.creatingDenpendencyLink.startClickedPoint=t,this.creatingDenpendencyLink.startX=e,this.creatingDenpendencyLink.startY=i,this.creatingDenpendencyLink.startOffsetY=r,this.creatingDenpendencyLink.firstTaskBarPosition=o,this.highlightLinkPointNode(t)}isCreatingDependencyLine(){return this.creatingDenpendencyLink.creating}endCreateDependencyLine(t){const e=this._gantt.parsedOptions.taskKeyField,i=this.selectedTaskBar.target.task_index,r=this.selectedTaskBar.target.sub_task_index,o=this.creatingDenpendencyLink.secondTaskBarNode.task_index,s=this.creatingDenpendencyLink.secondTaskBarNode.sub_task_index,a={linkedFromTaskKey:this._gantt.getRecordByIndex(i,r)[e],linkedToTaskKey:this._gantt.getRecordByIndex(o,s)[e],type:this.creatingDenpendencyLink.firstTaskBarPosition==="left"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?Gr.StartToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?Gr.FinishToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="right"?Gr.FinishToFinish:Gr.StartToFinish};return this._gantt.addLink(a),this.hideTaskBarSelectedBorder(),this._gantt.scenegraph.updateNextFrame(),this.creatingDenpendencyLink.creating=!1,a}dealCreateDependencyLine(t){const e=this.creatingDenpendencyLink.startX,i=this.creatingDenpendencyLink.startY,r=t.x-e,o=t.y-i,s=this.creatingDenpendencyLink.startClickedPoint,a=s.attribute.x+s.attribute.width/2,l=s.attribute.y+s.attribute.height/2;this._gantt.scenegraph.taskBar.updateCreatingDependencyLine(a,l,a+r,l+o),this._gantt.scenegraph.updateNextFrame()}startResizeTableWidth(t){this.resizeTableWidth.resizing=!0,this.resizeTableWidth.lastX=t.pageX}isResizingTableWidth(){return this.resizeTableWidth.resizing}endResizeTableWidth(){this.resizeTableWidth.resizing=!1}dealResizeTableWidth(t){var e,i;if(!this.resizeTableWidth.resizing)return;const r=t.pageX-this.resizeTableWidth.lastX;if(Math.abs(r)>=1){let o=this._gantt.taskTableWidth+r;const s=Math.min(this._gantt.taskListTableInstance.getAllColsWidth()+this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(e=this._gantt.options.taskListTable.maxTableWidth)!==null&&e!==void 0?e:1e5),a=Math.max(this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(i=this._gantt.options.taskListTable.minTableWidth)!==null&&i!==void 0?i:0);r>0&&o>s&&(o=s),r<0&&o<a&&(o=a),this._gantt.taskTableWidth=o,this._gantt.element.style.left=this._gantt.taskTableWidth?`${this._gantt.taskTableWidth}px`:"0px",this._gantt.verticalSplitResizeLine.style.left=this._gantt.taskTableWidth?this._gantt.taskTableWidth-7+"px":"0px",this._gantt._resize(),this.resizeTableWidth.lastX=t.pageX}}showTaskBarHover(){const t=this._gantt.stateManager.hoverTaskBar.target;if(t){const e=t.attribute.x,i=t.attribute.y,r=t.attribute.width,o=t.attribute.height;this._gantt.scenegraph.taskBar.showHoverBar(e,i,r,o,t),this._gantt.scenegraph.updateNextFrame()}}hideTaskBarHover(t){this._gantt.stateManager.hoverTaskBar.target=null,this._gantt.scenegraph.taskBar.hideHoverBar(),this._gantt.scenegraph.updateNextFrame()}showTaskBarSelectedBorder(t){var e;(e=this._gantt.stateManager.selectedTaskBar.target)===null||e===void 0||e.setAttribute("zIndex",0),this._gantt.stateManager.selectedTaskBar.target=t;const i=this._gantt.parsedOptions.dependencyLinkCreatable;t.setAttribute("zIndex",1e4);const r=t.attribute.x,o=t.attribute.y,s=t.attribute.width,a=t.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(r,o,s,a,t,i),this._gantt.scenegraph.updateNextFrame()}hideTaskBarSelectedBorder(){var t;(t=this._gantt.stateManager.selectedTaskBar.target)===null||t===void 0||t.setAttribute("zIndex",0),this._gantt.stateManager.selectedTaskBar.target=null,this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showSecondTaskBarSelectedBorder(){const t=this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode,e=t.attribute.x,i=t.attribute.y,r=t.attribute.width,o=t.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(e,i,r,o,t,!0),this._gantt.scenegraph.updateNextFrame()}hideSecondTaskBarSelectedBorder(){this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode=null,this._gantt.scenegraph.taskBar.removeSecondSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showDependencyLinkSelectedLine(){const t=this._gantt.stateManager.selectedDenpendencyLink.link;this._gantt.scenegraph.dependencyLink.createSelectedLinkLine(t);const{taskKeyField:e,dependencyLinks:i}=this._gantt.parsedOptions,{linkedToTaskKey:r,linkedFromTaskKey:o,type:s}=t;let a,l,h,u;const d=Oa(this._gantt.records,e,r),c=Oa(this._gantt.records,e,o);this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?(a=c.index[0],l=c.index[1],h=d.index[0],u=d.index[1]):(a=this._gantt.getTaskShowIndexByRecordIndex(c.index),h=this._gantt.getTaskShowIndexByRecordIndex(d.index));const f=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(a,l);this._gantt.scenegraph.taskBar.createSelectedBorder(f.attribute.x,f.attribute.y,f.attribute.width,f.attribute.height,f,!1);const g=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(h,u);this._gantt.scenegraph.taskBar.createSelectedBorder(g.attribute.x,g.attribute.y,g.attribute.width,g.attribute.height,g,!1),this._gantt.scenegraph.updateNextFrame()}hideDependencyLinkSelectedLine(){this._gantt.stateManager.selectedDenpendencyLink.link=null,this._gantt.scenegraph.dependencyLink.removeSelectedLinkLine(),this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}highlightLinkPointNode(t){if(t?.children.length>0){const e=t.children[0];e.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.fillColor),e.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeColor),e.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.radius),e.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}unhighlightLinkPointNode(t){if(t?.children.length>0){const e=t.children[0];e.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor),e.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor),e.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius),e.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}showMarklineIconHover(){var t,e;const i=this._gantt.stateManager.marklineIcon.target;if(i){const r=this._gantt.scenegraph.timelineHeader.showMarklineIcon(i.parent);r&&(!((e=(t=this._gantt.parsedOptions.markLineCreateOptions)===null||t===void 0?void 0:t.markLineCreationHoverToolTip)===null||e===void 0)&&e.tipContent)&&this._gantt.scenegraph.showToolTip(r),this._gantt.scenegraph.updateNextFrame()}}hideMarklineIconHover(){this._gantt.scenegraph.timelineHeader.hideMarklineIconHover(this._gantt.stateManager.marklineIcon.target.parent),this._gantt.scenegraph.hideToolTip(),this._gantt.stateManager.marklineIcon.target=null,this._gantt.scenegraph.updateNextFrame()}updateProjectTaskTimes(t){var e,i;if(!t||t.length===0||!this._gantt||!this._gantt.records)return;const r=this._gantt.parsedOptions.startDateField,o=this._gantt.parsedOptions.endDateField,s=[...t];for(;s.length>0;){const a=[...s],l=a.pop();let h=this._gantt.records;for(const d of a){if(!h[d]||!h[d].children)return;h=h[d].children}const u=a.length===0?this._gantt.records[l]:h[l];if(u&&u.type===Me.PROJECT&&u.children&&u.children.length>0){let d=null,c=null;for(const f of u.children)if(f[r]&&f[o]){const g=new Date(f[r]),p=new Date(f[o]);(!d||g<d)&&(d=g),(!c||p>c)&&(c=p)}if(d&&c){const f=u[r]?new Date(u[r]):null,g=u[o]?new Date(u[o]):null;if(!f||!g||d.getTime()!==f.getTime()||c.getTime()!==g.getTime()){const p=(e=this._gantt.parsedOptions.dateFormat)!==null&&e!==void 0?e:this._gantt.parseTimeFormat(u[r]||u.children[0][r]),v=m=>this._gantt.formatDate?this._gantt.formatDate(m,p):m.toISOString().split("T")[0];u[r]=v(d),u[o]=v(c)}}}s.pop()}(i=this._gantt.scenegraph)===null||i===void 0||i.refreshAll()}}function PQ(n,t,e,i){const r=n.parsedOptions.taskBarCustomLayout;if(r){let o;if(typeof r=="function"){const{startDate:s,endDate:a,taskDays:l,progress:h,taskRecord:u}=n.getTaskInfoByTaskListIndex(e,i);o=r({width:t.attribute.width,height:t.attribute.height,index:e,startDate:s,endDate:a,taskDays:l,progress:h,taskRecord:u,ganttInstance:n})}else o=r;if(o){const s=o.rootContainer;s.name="task-bar-custom-render";const a=t.children.find(l=>l.name==="task-bar-group");if(a){const l=a.children.findIndex(u=>u.name==="task-bar-custom-render"),h=a.children[l];h&&(a.removeChild(h),a.insertInto(s,l))}}}}function vf(n,t,e,i){const r=n.task_index,o=n.sub_task_index,s=n.record.type===Me.MILESTONE,a=n.attribute.x,l=n.attribute.y;if(t&&n.setAttribute("x",Math.max(0,n.attribute.x+t)),i._gantt.parsedOptions.tasksShowMode!==mt.Tasks_Separate&&i._gantt.parsedOptions.tasksShowMode!==mt.Project_Sub_Tasks_Inline?e&&n.setAttribute("y",n.attribute.y+e):e=0,s&&(n.setAttribute("anchor",[n.attribute.x+n.attribute.width/2,n.attribute.y+n.attribute.height/2]),n.milestoneTextContainer)){const h=n.attribute.x-a,u=n.attribute.y-l,d=n.milestoneTextContainer.attribute.x,c=n.milestoneTextContainer.attribute.y;n.milestoneTextContainer.setAttribute("x",d+h),n.milestoneTextContainer.setAttribute("y",c+u)}n.updateTextPosition(),i._gantt.scenegraph.refreshRecordLinkNodes(r,o,n,e)}function n7t(n,t,e,i){const r=i._gantt.parsedOptions.progressField,o=n.clipGroupBox,s=n.barRect,a=n.progressRect,l=n.textLabel,h=n.task_index,u=n.sub_task_index,d=n.record,c=d[r],f=d.type===Me.MILESTONE;if(n.setAttribute("zIndex",1e4),t&&n.setAttribute("x",n.attribute.x+t),f&&n.setAttribute("anchor",[n.attribute.x+n.attribute.width/2,n.attribute.y+n.attribute.height/2]),e&&n.setAttribute("width",e),o.setAttribute("width",n.attribute.width),s?.setAttribute("width",n.attribute.width),a?.setAttribute("width",c/100*n.attribute.width),l){const{textAlign:g,textBaseline:p,padding:v}=i._gantt.parsedOptions.taskBarLabelStyle,m=Dy(Oy(v),g,p,e,n.attribute.height);l.setAttribute("maxLineWidth",e-2*AQ),l.setAttribute("x",m.x)}n.updateTextPosition(),i.showTaskBarHover(),PQ(i._gantt,n,h,u),i._gantt.scenegraph.refreshRecordLinkNodes(h,u,n,0)}let r7t=1,o7t=class{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,e){const i=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]);i.push(e);const r=r7t++;return this.listenersData.listenerData[r]={type:t,listener:e,remove:()=>{delete this.listenersData.listenerData[r];const o=i.indexOf(e);i.splice(o,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},r}off(t,e){var i;if(e){const r=t;this.removeEventListener(r,e)}else{const r=t;if(!this.listenersData)return;(i=this.listenersData.listenerData[r])===null||i===void 0||i.remove()}}addEventListener(t,e,i){this.on(t,e)}removeEventListener(t,e){if(this.listenersData)for(const i in this.listenersData.listenerData){const r=this.listenersData.listenerData[i];r.type===t&&r.listener===e&&this.off(i)}}hasListeners(t){return!!this.listenersData&&!!this.listenersData.listeners[t]}fireListeners(t,e){if(!this.listenersData)return[];const i=this.listenersData.listeners[t];return i?i.map(r=>r.call(this,e)).filter(r=>Y(r)):[]}release(){delete this.listenersData}};class s7t{constructor(t){this._gantt=t,this.records=t.records,this.processRecords()}processRecords(){const t=!this._gantt.options.minDate,e=!this._gantt.options.maxDate;let i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;if((t||e||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact)&&this.records.length){for(let l=0;l<this.records.length;l++){const h=this.records[l];if(t&&h[this._gantt.parsedOptions.startDateField]){const u=Ai(h[this._gantt.parsedOptions.startDateField]);i=Math.min(i,u.getTime())}if(e&&h[this._gantt.parsedOptions.endDateField]){const u=Ai(h[this._gantt.parsedOptions.endDateField]);r=Math.max(r,u.getTime())}this._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Inline&&this._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Compact||h.children&&h.children.sort((u,d)=>Ai(u[this._gantt.parsedOptions.startDateField]).getTime()-Ai(d[this._gantt.parsedOptions.startDateField]).getTime())}const{unit:o,startOfWeek:s,step:a}=this._gantt.parsedOptions.reverseSortedTimelineScales[0];t&&(this._gantt.parsedOptions.minDate=_c(new Date(i),o,s),this._gantt.parsedOptions._minDateTime=this._gantt.parsedOptions.minDate.getTime()),t&&!e&&(this._gantt.parsedOptions.maxDate=ap(this._gantt.parsedOptions.minDate,new Date(this._gantt.options.maxDate),o,a),this._gantt.parsedOptions._maxDateTime=this._gantt.parsedOptions.maxDate.getTime()),e&&(this._gantt.parsedOptions.maxDate=ap(this._gantt.parsedOptions.minDate,new Date(r),o,a),this._gantt.parsedOptions._maxDateTime=this._gantt.parsedOptions.maxDate.getTime())}}adjustOrder(t,e,i,r){var o,s,a,l;if(this._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Arrange&&this._gantt.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Compact||t!==i){if(this._gantt.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline){if(Y(e)&&Y(r)&&Y(t)&&Y(i)){const h=this.records[t].children[e];this.records[t].children.splice(e,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(r,0,h)}(s=(o=this.records[i])===null||o===void 0?void 0:o.children)===null||s===void 0||s.sort((h,u)=>Ai(h[this._gantt.parsedOptions.startDateField]).getTime()-Ai(u[this._gantt.parsedOptions.startDateField]).getTime())}else if(this._gantt.parsedOptions.tasksShowMode===mt.Project_Sub_Tasks_Inline){if(Y(e)&&Y(r)&&Y(t)&&Y(i)){this.records[t].type,Me.PROJECT;const h=this.records[i].type===Me.PROJECT,u=this.records[t].children[e];this.records[t].children.splice(e,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(r,0,u),h&&((l=(a=this.records[i])===null||a===void 0?void 0:a.children)===null||l===void 0||l.sort((d,c)=>Ai(d[this._gantt.parsedOptions.startDateField]).getTime()-Ai(c[this._gantt.parsedOptions.startDateField]).getTime()))}}else if(Y(e)&&Y(r)&&Y(t)&&Y(i)){const h=this.records[t].children[e];this.records[t].children.splice(e,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(r,0,h)}}}setRecords(t){this.records=t,this.processRecords()}}class a7t{constructor(t,e){var i;this.plugins=new Map,this.gantt=t,(i=e.plugins)===null||i===void 0||i.forEach(r=>{this.register(r),this._initializePluginRun(r)})}_initializePluginRun(t){if(t.runTime===void 0)try{t.run(this.gantt)}catch{}else this._bindGanttEventForPlugin(t)}register(t){this.plugins.set(t.id,t)}registerAll(t){t.forEach(e=>this.register(e))}getPlugin(t){return this.plugins.get(t)}getPluginByName(t){return Array.from(this.plugins.values()).find(e=>e.name===t)}_bindGanttEventForPlugin(t){t.runTime&&t.runTime.forEach(e=>{this.gantt.on(e,(...i)=>{var r;try{(r=t.run)===null||r===void 0||r.call(t,...i,e,this.gantt)}catch{}})})}updatePlugins(t){Array.from(this.plugins.values()).filter(i=>!t?.some(r=>r.id===i.id)).forEach(i=>{this.release(),this.plugins.delete(i.id)}),this.plugins.forEach(i=>{i.update&&i.update()});const e=t?.filter(i=>!this.plugins.has(i.id));e?.forEach(i=>{this.register(i),this._initializePluginRun(i)})}release(){this.plugins.forEach(t=>{var e;try{(e=t.release)===null||e===void 0||e.call(t,this.gantt)}catch{}})}}function l7t(n,t="vtable-gantt"){var e,i;const r=document.createElement("div");r.setAttribute("tabindex","0"),r.classList.add(t),r.style.outline="none",r.style.margin=`${n.top}px ${n.right}px ${n.bottom}px ${n.left}px`;const o=(r.offsetWidth||((e=r.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,s=(r.offsetHeight||((i=r.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;return r.style.width=o&&o-n.left-n.right+"px"||"0px",r.style.height=s&&s-n.top-n.bottom+"px"||"0px",r}class h7t extends o7t{constructor(t,e){var i,r,o,s,a;super(),this.parsedOptions={},this.container=t,this.options=e,this.taskTableWidth=typeof((i=e?.taskListTable)===null||i===void 0?void 0:i.tableWidth)=="number"?(r=e?.taskListTable)===null||r===void 0?void 0:r.tableWidth:-1,this.taskTableColumns=(s=(o=e?.taskListTable)===null||o===void 0?void 0:o.columns)!==null&&s!==void 0?s:[],this.records=(a=e?.records)!==null&&a!==void 0?a:[],this._sortScales(),M6(this),mHt(this),this.data=new s7t(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.element=l7t({top:0,right:0,left:0,bottom:0},"vtable-gantt"),this.element.style.left=this.taskTableWidth!==-1?`${this.taskTableWidth}px`:"0px",this.canvas=document.createElement("canvas"),this.element.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),t?(t.appendChild(this.element),this._updateSize()):this._updateSize(),this._generateListTable(),this._syncPropsFromTable(),hHt(this),this.scenegraph=new z$t(this),this.stateManager=new i7t(this),this.eventManager=new X$t(this),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine(),this.pluginManager=new a7t(this,e)}renderTaskBarsTable(){this.scenegraph.updateNextFrame()}_updateSize(){var t,e,i,r,o,s,a,l,h;let u=0,d=0;if(Ko.mode==="browser"){const g=this.getElement();let p=0,v=0;if(g.parentElement){const _=g.parentElement.style||window.getComputedStyle(g.parentElement);p=g.parentElement.offsetWidth-parseInt(_.paddingLeft||"0px",10)-parseInt(_.paddingRight||"0px",10),v=g.parentElement.offsetHeight-parseInt(_.paddingTop||"0px",10)-parseInt(_.paddingBottom||"0px",20)}const m=(p??1)-1-this.taskTableWidth,y=(v??1)-1;g.style.width=m&&`${m}px`||"0px",g.style.height=y&&`${y}px`||"0px";const{canvas:b}=this;u=(e=(t=b.parentElement)===null||t===void 0?void 0:t.offsetWidth)!==null&&e!==void 0?e:1,d=(r=(i=b.parentElement)===null||i===void 0?void 0:i.offsetHeight)!==null&&r!==void 0?r:1,!((o=this==null?void 0:this.scenegraph)===null||o===void 0)&&o.stage?this.scenegraph.stage.resize(u,d):(b.style.width="",b.style.height="",b.width=u,b.height=d,b.style.width=`${u}px`,b.style.height=`${d}px`)}else Ko.mode;const c=Math.floor(u-oHt(this.parsedOptions.scrollStyle)),f=Math.floor(d-rHt(this.parsedOptions.scrollStyle));if(this.tableNoFrameWidth=u,this.tableNoFrameHeight=Math.floor(d),this.parsedOptions.outerFrameStyle){const[g,p,v,m]=Ls((a=(s=this.parsedOptions.outerFrameStyle)===null||s===void 0?void 0:s.borderLineWidth)!==null&&a!==void 0?a:0);this.tableX=this.taskTableColumns.length>=1||!((l=this.options)===null||l===void 0)&&l.rowSeriesNumber?(h=this.parsedOptions.verticalSplitLine.lineWidth)!==null&&h!==void 0?h:0:m,this.tableY=g,this.tableNoFrameWidth=Math.min(c-p-this.tableX,this.getAllDateColsWidth()),this.tableNoFrameHeight=f-g-v}}_updateListTableSize(t){var e,i,r,o,s,a,l,h,u,d,c,f;if(t){if(((i=(e=this.options)===null||e===void 0?void 0:e.taskListTable)===null||i===void 0?void 0:i.tableWidth)==="auto"||this.taskTableWidth===-1){const[g,p,v]=Ls((o=(r=this.parsedOptions.outerFrameStyle)===null||r===void 0?void 0:r.borderLineWidth)!==null&&o!==void 0?o:0);this.taskTableWidth=t.getAllColsWidth()+p,!((a=(s=this.options)===null||s===void 0?void 0:s.taskListTable)===null||a===void 0)&&a.maxTableWidth&&(this.taskTableWidth=Math.min((h=(l=this.options)===null||l===void 0?void 0:l.taskListTable)===null||h===void 0?void 0:h.maxTableWidth,this.taskTableWidth)),!((d=(u=this.options)===null||u===void 0?void 0:u.taskListTable)===null||d===void 0)&&d.minTableWidth&&(this.taskTableWidth=Math.max((f=(c=this.options)===null||c===void 0?void 0:c.taskListTable)===null||f===void 0?void 0:f.minTableWidth,this.taskTableWidth)),this.element.style.left=this.taskTableWidth!==-1?`${this.taskTableWidth}px`:"0px",t.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+g+v),this._updateSize()}if(t.columnHeaderLevelCount>1)if(t.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let g=0;g<t.columnHeaderLevelCount;g++)t.setRowHeight(g,this.parsedOptions.timeLineHeaderRowHeights[g]);else{const g=this.getAllHeaderRowsHeight()/t.columnHeaderLevelCount;for(let p=0;p<t.columnHeaderLevelCount;p++)t.setRowHeight(p,g)}}}_generateListTable(){var t;if(this.taskTableColumns.length>=1||!((t=this.options)===null||t===void 0)&&t.rowSeriesNumber){const e=this._generateListTableOptions();this.taskListTableInstance=new R$t(this.container,e),this._updateListTableSize(this.taskListTableInstance)}}_generateListTableOptions(){var t,e,i,r,o,s,a,l,h,u,d,c,f,g,p,v,m,y,b,_,w,C,x,S,A,T,M,R,E,P,B,k,L,O,D,I,H,F,G,j,W,K,J,q,X,it,Z,et,nt,z,V,$,U,Q;const rt={},st=["container","records","rowSeriesNumber","overscrollBehavior","pixelRatio","eventOptions"];for(const at of st)at in this.options&&(rt[at]=this.options[at]);if(rt.defaultRowHeight=this.options.rowHeight,this.options.taskListTable)for(const at in this.options.taskListTable){if(rt[at]=this.options.taskListTable[at],at==="columns"&&(rt[at][rt[at].length-1].disableColumnResize=!0,this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Inline||this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate||this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange||this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact))for(let ht=0;ht<rt.columns.length;ht++)rt.columns[ht].tree&&(rt.columns[ht].tree=!1);at!=="hierarchyExpandLevel"||this.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Inline&&this.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Separate&&this.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Arrange&&this.parsedOptions.tasksShowMode!==mt.Sub_Tasks_Compact||delete rt[at]}if(!((t=this.options.taskListTable)===null||t===void 0)&&t.theme)if(rt.theme=(e=this.options.taskListTable)===null||e===void 0?void 0:e.theme,rt.theme.bodyStyle&&!BIt(rt.theme,"bodyStyle")){rt.theme=((i=this.options.taskListTable)===null||i===void 0?void 0:i.theme).extends(((r=this.options.taskListTable)===null||r===void 0?void 0:r.theme).getExtendTheme());const at=rt.theme.getExtendTheme();rt.theme.clearBodyStyleCache(),!((o=rt.theme.headerStyle)===null||o===void 0)&&o.bgColor||(at.headerStyle?at.headerStyle.bgColor||(at.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):at.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor}),at.bodyStyle?at.bodyStyle.frameStyle={borderLineWidth:[(a=(s=this.parsedOptions.horizontalSplitLine)===null||s===void 0?void 0:s.lineWidth)!==null&&a!==void 0?a:0,0,0,0],borderColor:(l=this.parsedOptions.horizontalSplitLine)===null||l===void 0?void 0:l.lineColor}:at.bodyStyle={frameStyle:{borderLineWidth:[(u=(h=this.parsedOptions.horizontalSplitLine)===null||h===void 0?void 0:h.lineWidth)!==null&&u!==void 0?u:0,0,0,0],borderColor:(d=this.parsedOptions.horizontalSplitLine)===null||d===void 0?void 0:d.lineColor}},at.cellInnerBorder=!1;const[ht,gt,dt,vt]=Ls((f=(c=this.parsedOptions.outerFrameStyle)===null||c===void 0?void 0:c.borderLineWidth)!==null&&f!==void 0?f:0);at.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{shadowBlur:0,cornerRadius:[(p=(g=this.parsedOptions.outerFrameStyle)===null||g===void 0?void 0:g.cornerRadius)!==null&&p!==void 0?p:0,0,0,(m=(v=this.parsedOptions.outerFrameStyle)===null||v===void 0?void 0:v.cornerRadius)!==null&&m!==void 0?m:0],borderLineWidth:[ht,0,dt,vt]}),at.scrollStyle=Object.assign({},(b=(y=this.options.taskListTable)===null||y===void 0?void 0:y.theme)===null||b===void 0?void 0:b.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),at.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},at?.columnResize),at.underlayBackgroundColor||(at.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor)}else{rt.theme.headerStyle?rt.theme.headerStyle.bgColor||(rt.theme.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):rt.theme.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor},rt.theme.headerStyle=Object.assign({},If.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(w=(_=this.options.taskListTable)===null||_===void 0?void 0:_.theme)===null||w===void 0?void 0:w.headerStyle),rt.theme.bodyStyle=Object.assign({},If.bodyStyle,(x=(C=this.options.taskListTable)===null||C===void 0?void 0:C.theme)===null||x===void 0?void 0:x.bodyStyle,{frameStyle:{borderLineWidth:[(A=(S=this.parsedOptions.horizontalSplitLine)===null||S===void 0?void 0:S.lineWidth)!==null&&A!==void 0?A:0,0,0,0],borderColor:(T=this.parsedOptions.horizontalSplitLine)===null||T===void 0?void 0:T.lineColor}}),rt.theme.cellInnerBorder=!1;const[at,ht,gt,dt]=Ls((R=(M=this.parsedOptions.outerFrameStyle)===null||M===void 0?void 0:M.borderLineWidth)!==null&&R!==void 0?R:0);rt.theme.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(P=(E=this.parsedOptions.outerFrameStyle)===null||E===void 0?void 0:E.cornerRadius)!==null&&P!==void 0?P:0,0,0,(k=(B=this.parsedOptions.outerFrameStyle)===null||B===void 0?void 0:B.cornerRadius)!==null&&k!==void 0?k:0],borderLineWidth:[at,0,gt,dt]}),rt.theme.scrollStyle=Object.assign({},(O=(L=this.options.taskListTable)===null||L===void 0?void 0:L.theme)===null||O===void 0?void 0:O.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),rt.theme.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(I=(D=this.options.taskListTable)===null||D===void 0?void 0:D.theme)===null||I===void 0?void 0:I.columnResize),rt.theme.underlayBackgroundColor||(rt.theme.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor)}else{const[at,ht,gt,dt]=Ls((F=(H=this.parsedOptions.outerFrameStyle)===null||H===void 0?void 0:H.borderLineWidth)!==null&&F!==void 0?F:0);rt.theme={scrollStyle:Object.assign({},(j=(G=this.options.taskListTable)===null||G===void 0?void 0:G.theme)===null||j===void 0?void 0:j.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),headerStyle:Object.assign({},If.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(K=(W=this.options.taskListTable)===null||W===void 0?void 0:W.theme)===null||K===void 0?void 0:K.headerStyle),bodyStyle:Object.assign({},If.bodyStyle,(q=(J=this.options.taskListTable)===null||J===void 0?void 0:J.theme)===null||q===void 0?void 0:q.bodyStyle,{frameStyle:{borderLineWidth:[(it=(X=this.parsedOptions.horizontalSplitLine)===null||X===void 0?void 0:X.lineWidth)!==null&&it!==void 0?it:0,0,0,0],borderColor:(Z=this.parsedOptions.horizontalSplitLine)===null||Z===void 0?void 0:Z.lineColor}}),cellInnerBorder:!1,frameStyle:Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(nt=(et=this.parsedOptions.outerFrameStyle)===null||et===void 0?void 0:et.cornerRadius)!==null&&nt!==void 0?nt:0,0,0,(V=(z=this.parsedOptions.outerFrameStyle)===null||z===void 0?void 0:z.cornerRadius)!==null&&V!==void 0?V:0],borderLineWidth:[at,0,gt,dt]}),columnResize:Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(U=($=this.options.taskListTable)===null||$===void 0?void 0:$.theme)===null||U===void 0?void 0:U.columnResize),underlayBackgroundColor:this.parsedOptions.underlayBackgroundColor}}return rt.canvasWidth=this.taskTableWidth,rt.canvasHeight=this.canvas.height,rt.defaultHeaderRowHeight=this.getAllHeaderRowsHeight(),this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Separate?(rt.customComputeRowHeight=at=>{var ht;const{row:gt,table:dt}=at,vt=dt.getRecordByRowCol(0,gt);if(vt)return(((ht=vt.children)===null||ht===void 0?void 0:ht.length)||1)*this.parsedOptions.rowHeight},rt.defaultRowHeight="auto",rt.customConfig={forceComputeAllRowHeight:!0}):this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Compact?(rt.customComputeRowHeight=at=>{const{row:ht,table:gt}=at,dt=gt.getRecordByRowCol(0,ht);if(dt)return uHt(this,dt)*this.parsedOptions.rowHeight},rt.defaultRowHeight="auto",rt.customConfig={forceComputeAllRowHeight:!0}):this.parsedOptions.tasksShowMode===mt.Sub_Tasks_Arrange?(rt.customComputeRowHeight=at=>{const{row:ht,table:gt}=at,dt=gt.getRecordByRowCol(0,ht);if(dt)return cHt(this,dt)*this.parsedOptions.rowHeight},rt.defaultRowHeight="auto",rt.customConfig={forceComputeAllRowHeight:!0}):rt.defaultRowHeight=(Q=this.options.rowHeight)!==null&&Q!==void 0?Q:40,rt.clearDOM=!1,rt}getElement(){return this.element}getContainer(){return this.element.parentElement}_sortScales(){const{timelineHeader:t}=this.options;if(t){const e=t.scales,i=["year","quarter","month","week","day","hour","minute","second"];e.length===1&&(e[0].unit!=="hour"&&e[0].unit!=="minute"&&e[0].unit!=="second"||(this.parsedOptions.timeScaleIncludeHour=!0));const r=e.slice().sort((s,a)=>{s.unit!=="hour"&&s.unit!=="minute"&&s.unit!=="second"||(this.parsedOptions.timeScaleIncludeHour=!0);const l=i.indexOf(s.unit),h=i.indexOf(a.unit);return l===-1?1:h===-1?-1:l-h}),o=e.slice().sort((s,a)=>{const l=i.indexOf(s.unit),h=i.indexOf(a.unit);return l===-1?1:h===-1?-1:h-l});this.parsedOptions.sortedTimelineScales=r,this.parsedOptions.reverseSortedTimelineScales=o}}_generateTimeLineDateMap(){if(this.parsedOptions.minDate&&this.parsedOptions.maxDate)for(const t of this.parsedOptions.reverseSortedTimelineScales)t.timelineDates=aHt(new Date(this.parsedOptions.minDate),this.parsedOptions.maxDate,t)}getRowHeightByIndex(t){return this.taskListTableInstance?this.taskListTableInstance.getRowHeight(t+this.taskListTableInstance.columnHeaderLevelCount):this.parsedOptions.rowHeight}getRowsHeightByIndex(t,e){return this.taskListTableInstance?this.taskListTableInstance.getRowsHeight(t+this.taskListTableInstance.columnHeaderLevelCount,e+this.taskListTableInstance.columnHeaderLevelCount):this.parsedOptions.rowHeight*(e-t+1)}getAllRowsHeight(){return this.taskListTableInstance?this.taskListTableInstance.getAllRowsHeight():this.getAllHeaderRowsHeight()+this.itemCount*this.parsedOptions.rowHeight}getAllHeaderRowsHeight(){return this.parsedOptions.timeLineHeaderRowHeights.reduce((t,e,i)=>this.parsedOptions.sortedTimelineScales[i].visible===!1?t:t+e,0)}getAllDateColsWidth(){var t,e;return this.parsedOptions.timelineColWidth*((e=(t=this.parsedOptions.reverseSortedTimelineScales[0].timelineDates)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0)}getAllTaskBarsHeight(){return this.taskListTableInstance?this.taskListTableInstance.getRowsHeight(this.taskListTableInstance.columnHeaderLevelCount,this.taskListTableInstance.rowCount-1):this.itemCount*this.parsedOptions.rowHeight}getRecordIndexByTaskShowIndex(t){return this.taskListTableInstance?this.taskListTableInstance.getRecordIndexByCell(0,this.taskListTableInstance.columnHeaderLevelCount+t):t}getTaskShowIndexByRecordIndex(t){return this.taskListTableInstance.getBodyRowIndexByRecordIndex(t)}getRecordByIndex(t,e){var i,r;if(this.taskListTableInstance){if(Y(e)){const o=this.taskListTableInstance.getRecordByCell(0,t+this.taskListTableInstance.columnHeaderLevelCount);if(Array.isArray(e)){const s=this.getRecordIndexByTaskShowIndex(t),a=Array.isArray(s)?s.length:1,l=[...e];l.splice(0,a);let h=o;for(;l.length>0;){const u=l.shift();h=(i=h?.children)===null||i===void 0?void 0:i[u]}return h}return(r=o?.children)===null||r===void 0?void 0:r[e]}return this.taskListTableInstance.getRecordByCell(0,t+this.taskListTableInstance.columnHeaderLevelCount)}return this.records[t]}_refreshTaskBar(t,e){this.scenegraph.taskBar.updateTaskBarNode(t,e),this.scenegraph.refreshRecordLinkNodes(t,void 0,this.scenegraph.taskBar.getTaskBarNodeByIndex(t,e)),this.scenegraph.updateNextFrame()}_updateRecordToListTable(t,e){this.taskListTableInstance.updateRecords([t],[e])}getTaskInfoByTaskListIndex(t,e){const i=this.getRecordByIndex(t,e),r=i?.type,o=this.parsedOptions.startDateField,s=this.parsedOptions.endDateField,a=this.parsedOptions.progressField,l=Ai(i?.[o]).getTime(),h=Ai(i?.[s]).getTime();if(r&&!i?.[o]||!r&&(h<this.parsedOptions._minDateTime||l>this.parsedOptions._maxDateTime||!i?.[o]||!i?.[s]))return{taskDays:0,progress:0,startDate:null,endDate:null,taskRecord:i};const u=lHt(i[a]);let d,c;return this.parsedOptions.timeScaleIncludeHour?(d=Ai(Math.min(Math.max(this.parsedOptions._minDateTime,l),this.parsedOptions._maxDateTime)),c=SZ(Math.max(Math.min(this.parsedOptions._maxDateTime,h),this.parsedOptions._minDateTime),!0)):(d=Ai(Math.min(Math.max(this.parsedOptions._minDateTime,l),this.parsedOptions._maxDateTime),!0),c=Mh(Math.max(Math.min(this.parsedOptions._maxDateTime,h),this.parsedOptions._minDateTime),!0)),{taskRecord:i,taskDays:(c.getTime()-d.getTime()+1)/864e5,startDate:d,endDate:c,progress:u}}_updateStartDateToTaskRecord(t,e,i){var r;const o=this.getRecordByIndex(e,i),s=this.parsedOptions.startDateField,a=(r=this.parsedOptions.dateFormat)!==null&&r!==void 0?r:S_(o[s]),l=Sl(t,a);if(o[s]=l,Y(i))Array.isArray(i)&&this.stateManager.updateProjectTaskTimes(i);else{const h=this.getRecordIndexByTaskShowIndex(e);this._updateRecordToListTable(o,h),Array.isArray(h)&&this.stateManager.updateProjectTaskTimes(h)}}_updateEndDateToTaskRecord(t,e,i){var r;const o=this.getRecordByIndex(e,i),s=this.parsedOptions.endDateField,a=(r=this.parsedOptions.dateFormat)!==null&&r!==void 0?r:S_(o[s]),l=Sl(t,a);if(o[s]=l,Y(i))Array.isArray(i)&&this.stateManager.updateProjectTaskTimes(i);else{const h=this.getRecordIndexByTaskShowIndex(e);this._updateRecordToListTable(o,h),Array.isArray(h)&&this.stateManager.updateProjectTaskTimes(h)}}_updateStartEndDateToTaskRecord(t,e,i,r){var o;const s=this.getRecordByIndex(i,r),a=this.parsedOptions.startDateField,l=this.parsedOptions.endDateField,h=(o=this.parsedOptions.dateFormat)!==null&&o!==void 0?o:S_(s[a]),u=Sl(t,h);s[a]=u;const d=Sl(e,h);if(s[l]=d,Y(r))Array.isArray(r)&&this.stateManager.updateProjectTaskTimes(r);else{const c=this.getRecordIndexByTaskShowIndex(i);this._updateRecordToListTable(s,c),Array.isArray(c)&&this.stateManager.updateProjectTaskTimes(c)}}_updateProgressToTaskRecord(t,e,i){const r=this.getRecordByIndex(e,i),o=this.parsedOptions.progressField;if(o){r[o]=t;const s=this.getRecordIndexByTaskShowIndex(e);this._updateRecordToListTable(r,s),this._refreshTaskBar(e,i)}}_dragOrderTaskRecord(t,e,i,r){this.data.adjustOrder(t,e,i,r)}updateTaskRecord(t,e,i){if(Y(i)){const o=typeof e=="number"?e:e[0];return this._updateRecordToListTable(t,[o,i]),void this._refreshTaskBar(o,i)}if(Array.isArray(e)){const o=e[0],s=e[1];return this._updateRecordToListTable(t,e),void this._refreshTaskBar(o,s)}let r=e;this.taskListTableInstance.rowHierarchyType==="tree"&&(r=this.taskListTableInstance.getRecordIndexByCell(0,e+this.taskListTableInstance.columnHeaderLevelCount)),this._updateRecordToListTable(t,r),this._refreshTaskBar(e,void 0)}setPixelRatio(t){var e;(e=this.taskListTableInstance)===null||e===void 0||e.setPixelRatio(t),this.parsedOptions.pixelRatio=t,this.scenegraph.setPixelRatio(t)}updateTasksShowMode(t){this.options.tasksShowMode=t,this.updateOption(this.options)}_resize(){var t,e,i,r,o;this._updateSize(),(t=this.taskListTableInstance)===null||t===void 0||t.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+Ls((i=(e=this.parsedOptions.outerFrameStyle)===null||e===void 0?void 0:e.borderLineWidth)!==null&&i!==void 0?i:0)[0]+Ls((o=(r=this.parsedOptions.outerFrameStyle)===null||r===void 0?void 0:r.borderLineWidth)!==null&&o!==void 0?o:0)[2]),this._syncPropsFromTable(),this.scenegraph.resize(),yC(this)}_syncPropsFromTable(){this.itemCount=this.taskListTableInstance?this.taskListTableInstance.rowCount-this.taskListTableInstance.columnHeaderLevelCount:this.records.length,this.headerHeight=this.getAllHeaderRowsHeight(),this.drawHeight=Math.min(this.getAllRowsHeight(),this.tableNoFrameHeight),this.gridHeight=this.drawHeight-this.headerHeight}getContext(){return this.context}release(){var t,e,i;(t=super.release)===null||t===void 0||t.call(this),this.eventManager.release(),(e=this.taskListTableInstance)===null||e===void 0||e.release();const r=(i=this.element)===null||i===void 0?void 0:i.parentElement;r&&(r.removeChild(this.element),this.verticalSplitResizeLine&&r.removeChild(this.verticalSplitResizeLine),this.horizontalSplitLine&&r.removeChild(this.horizontalSplitLine)),this.scenegraph=null,this.pluginManager.release()}updateOption(t){var e,i,r,o,s;if(this.parsedOptions={},this.options=t,this.taskTableWidth=typeof((e=t?.taskListTable)===null||e===void 0?void 0:e.tableWidth)=="number"?(i=t?.taskListTable)===null||i===void 0?void 0:i.tableWidth:-1,this.taskTableColumns=(o=(r=t?.taskListTable)===null||r===void 0?void 0:r.columns)!==null&&o!==void 0?o:[],this.records=(s=t?.records)!==null&&s!==void 0?s:[],this._sortScales(),M6(this),this.data.setRecords(this.records),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this._updateSize(),this.taskListTableInstance){const a=this._generateListTableOptions();this.taskListTableInstance.updateOption(a),this._updateListTableSize(this.taskListTableInstance)}this._syncPropsFromTable(),this.scenegraph.updateStageBackground(),this.element.style.left=this.taskTableWidth!==-1?`${this.taskTableWidth}px`:"0px",yC(this),this.scenegraph.updateSceneGraph(),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine()}setRecords(t){this.records=t,this.data.setRecords(t),fHt(this),this.taskListTableInstance.setRecords(t),this._syncPropsFromTable(),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this._updateSize(),this.scenegraph.refreshAll(),this.verticalSplitResizeLine.style.height=this.drawHeight+"px";const e=this.stateManager.scroll.horizontalBarPos,i=this.stateManager.scroll.verticalBarPos;this.scenegraph.setX(-e),this.scenegraph.setY(-i)}updateScales(t){const e=this.parsedOptions.sortedTimelineScales.length;if(this.options.timelineHeader.scales=t,this._sortScales(),sHt(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.scenegraph.refreshAll(),yC(this),this.taskListTableInstance)if(this.taskListTableInstance.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let i=0;i<this.taskListTableInstance.columnHeaderLevelCount;i++)this.taskListTableInstance.setRowHeight(i,this.parsedOptions.timeLineHeaderRowHeights[i]);else{const i=this.getAllHeaderRowsHeight()/this.taskListTableInstance.columnHeaderLevelCount;for(let r=0;r<this.taskListTableInstance.columnHeaderLevelCount;r++)this.taskListTableInstance.setRowHeight(r,i)}e!==t.length&&this._resize()}updateDateRange(t,e){this.options.minDate=t,this.options.maxDate=e,gHt(this),this._generateTimeLineDateMap(),this._updateSize(),this.scenegraph.refreshAll(),this._scrollToMarkLine()}updateMarkLine(t){this.options.markLine=t,XR(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph()}addMarkLine(t){this.options.markLine=[...this.parsedOptions.markLine,t],XR(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph(),this.scenegraph.updateNextFrame()}updateCurrentMarkLine(t){const e=this.parsedOptions.markLine.findIndex(i=>i.date===t.date);e!==-1&&(this.options.markLine=[...this.parsedOptions.markLine.slice(0,e),Object.assign(Object.assign({},this.options.markLine[e]),t),...this.parsedOptions.markLine.slice(e+1)],XR(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph(),this.scenegraph.updateNextFrame())}_scrollToMarkLine(){if(this.parsedOptions.scrollToMarkLineDate&&this.parsedOptions.minDate){const t=this.parsedOptions.minDate,{unit:e,step:i}=this.parsedOptions.reverseSortedTimelineScales[0],r=Oe(this.parsedOptions.scrollToMarkLineDate,t,e,i)*this.parsedOptions.timelineColWidth-this.tableNoFrameWidth/2;this.stateManager.setScrollLeft(r)}}scrollToMarkLine(t){if(!t||!this.parsedOptions.minDate)return;const e=this.parsedOptions.minDate,{unit:i,step:r}=this.parsedOptions.reverseSortedTimelineScales[0],o=Oe(t,e,i,r)*this.parsedOptions.timelineColWidth-this.tableNoFrameWidth/2;this.stateManager.setScrollLeft(o)}addLink(t){this.parsedOptions.dependencyLinks.push(t),this.scenegraph.dependencyLink.initLinkLine(this.parsedOptions.dependencyLinks.length-1),this.scenegraph.updateNextFrame()}deleteLink(t){if(this.parsedOptions.dependencyLinkDeletable){const e=this.parsedOptions.dependencyLinks.findIndex(i=>i.type===t.type&&i.linkedFromTaskKey===t.linkedFromTaskKey&&i.linkedToTaskKey===t.linkedToTaskKey);if(e!==-1){const i=this.parsedOptions.dependencyLinks[e];this.parsedOptions.dependencyLinks.splice(e,1),this.scenegraph.dependencyLink.deleteLink(i),this.scenegraph.updateNextFrame()}}}get scrollTop(){return this.stateManager.scrollTop}set scrollTop(t){this.stateManager.setScrollTop(t)}get scrollLeft(){return this.stateManager.scrollLeft}set scrollLeft(t){this.stateManager.setScrollLeft(t)}getTaskBarRelativeRect(t){const e=this.scenegraph.taskBar.getTaskBarNodeByIndex(t);return{left:e.attribute.x+this.taskListTableInstance.tableNoFrameWidth+this.taskListTableInstance.tableX+this.tableX-this.scrollLeft,top:e.attribute.y+this.tableY+this.headerHeight-this.scrollTop,width:e.attribute.width,height:e.attribute.height}}getDateColWidth(t){return this.parsedOptions.timelineColWidth}getDateColsWidth(t,e){return(e-t+1)*this.parsedOptions.timelineColWidth}getDateRangeByIndex(t){const e=this.parsedOptions.reverseSortedTimelineScales[0];return t<e.timelineDates.length?{startDate:e.timelineDates[t].startDate,endDate:e.timelineDates[t].endDate}:null}parseTimeFormat(t){return S_(t)}getTaskBarStyle(t,e){const{startDate:i,endDate:r,taskRecord:o}=this.getTaskInfoByTaskListIndex(t,e);let s;return s=o.type===Me.PROJECT?this.parsedOptions.projectBarStyle:this.parsedOptions.taskBarStyle,typeof s=="function"?s({index:t,startDate:i,endDate:r,taskRecord:o,ganttInstance:this}):s}formatDate(t,e){return Sl(t,e)}}const hjt=Object.freeze(Object.defineProperty({__proto__:null,Gantt:h7t},Symbol.toStringTag,{value:"Module"}));export{Jr as G,x9 as L,E7t as _,_E as a,b7t as b,$y as c,p7t as d,C7t as e,x7t as f,c7t as g,M7t as h,f7t as i,m7t as j,y7t as k,_7t as l,w7t as m,S7t as n,g7t as o,A7t as p,T7t as q,R7t as r,yp as s,v7t as t,Xs as u,hjt as v};
