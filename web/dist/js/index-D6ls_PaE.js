import{i as H,a as L,b as O,F as j}from"./calendar-vendor-CyE9zJ0V.js";import{H as J,M as Q,ac as X,T as Z,ad as q}from"./ui-vendor-qucRfopV.js";import{k as K,r as u,w as S,O as M,P as D,Q as v,Z as Y,X as ee,J as n,R as b,S as i,j as $,a2 as A,F as te,W as ae,L as ne}from"./vue-vendor-DIhTWhib.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";var de={code:"zh-cn",week:{dow:1,doy:4},buttonText:{prev:"上月",next:"下月",today:"今天",year:"年",month:"月",week:"周",day:"日",list:"日程"},weekText:"周",allDayText:"全天",moreLinkText(y){return"另外 "+y+" 个"},noEventsText:"没有事件显示"};const ie={class:"c-full-calendar"},oe={class:"ml-10% mt-20px"},se={style:{padding:"20px"}},re={style:{"margin-bottom":"16px"}},ue={style:{"margin-bottom":"16px"}},ve={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"16px"}},pe={style:{"margin-top":"16px"}},ce={style:{display:"flex",gap:"8px"}},me=["onClick"],fe=K({__name:"index",props:{events:{type:Array,default:()=>[]},initialView:{type:String,default:"dayGridMonth",validator:y=>["dayGridMonth","dayGridWeek","dayGridDay","listWeek"].includes(y)},editable:{type:Boolean,default:!0},showAddDialog:{type:Boolean,default:!0},showEditDialog:{type:Boolean,default:!0}},emits:["update:events","event-added","event-updated","event-deleted","event-dropped"],setup(y,{expose:B,emit:N}){const s=y,r=N,h=u(),m=J(),o=u([...s.events]),p=u(!1),f=u(!1),g=u(!1),c=u(null),a=u({id:"",title:"",date:Date.now(),startTime:"09:00",endTime:"10:00",color:"#3f86ff"}),k=["#3f86ff","#ff6b6b","#67c23a","#e6a23c","#9c27b0","#00bcd4","#ff5722"],_=u({plugins:[H,L,O],locale:de,initialView:s.initialView,events:o,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,dayGridWeek,dayGridDay,listWeek"},buttonText:{today:"今天",month:"月",week:"周",day:"日",list:"列表"},editable:s.editable,eventClick:G,dateClick:R,eventDrop:V,eventResize:z});function G(e){s.editable&&(e.jsEvent.preventDefault(),c.value=e.event,s.showEditDialog&&(p.value=!0))}function R(e){if(!s.editable||!s.showAddDialog)return;const t=new Date(e.dateStr);F(t)}function V(e){x({id:e.event.id,start:e.event.start,end:e.event.end}),r("event-dropped",{id:e.event.id,start:e.event.start,end:e.event.end}),m.success(`事件 "${e.event.title}" 时间已更新`)}function z(e){x({id:e.event.id,start:e.event.start,end:e.event.end}),r("event-updated",{id:e.event.id,start:e.event.start,end:e.event.end})}function F(e){g.value=!1,a.value={id:"",title:"",date:e.getTime(),startTime:"09:00",endTime:"10:00",color:k[Math.floor(Math.random()*k.length)]},f.value=!0}function I(){if(!c.value)return;g.value=!0;const e=c.value,t=new Date(e.start),d=e.end?new Date(e.end):new Date(e.start.getTime()+36e5);a.value={id:e.id,title:e.title,date:t.getTime(),startTime:`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`,endTime:`${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`,color:e.backgroundColor||"#3f86ff"},p.value=!1,f.value=!0}function U(){if(!a.value.title.trim())return m.error("请输入事件标题"),!1;if(a.value.startTime>=a.value.endTime)return m.error("结束时间必须晚于开始时间"),!1;const t=new Date(a.value.date).toISOString().split("T")[0],d={id:g.value?a.value.id:Date.now().toString(),title:a.value.title,start:new Date(`${t}T${a.value.startTime}:00`),end:new Date(`${t}T${a.value.endTime}:00`),color:a.value.color};return g.value?(x(d),r("event-updated",d),m.success("事件已更新")):(E(d),r("event-added",d),m.success("事件已添加")),f.value=!1,!0}function W(){if(!c.value)return;const e=c.value.id,t=c.value.title;C(e),r("event-deleted",{id:e,title:t}),p.value=!1,m.success(`已删除事件: ${t}`)}function E(e){o.value=[...o.value,e],r("update:events",o.value)}function x(e){const t=o.value.findIndex(d=>d.id===e.id);t!==-1&&(o.value=o.value.map((d,w)=>w===t?{...d,...e}:d),r("update:events",o.value))}function C(e){o.value=o.value.filter(t=>t.id!==e),r("update:events",o.value)}return S(()=>s.events,e=>{o.value=[...e]},{deep:!0}),S(o,e=>{_.value.events=e},{deep:!0}),B({getApi:()=>h.value?.getApi(),addEvent:E,updateEvent:x,deleteEvent:C,getEvents:()=>o.value}),(e,t)=>{const d=Q,w=X,T=Z,P=q;return D(),M("div",ie,[v(n(j),{ref_key:"calendarRef",ref:h,options:n(_)},null,8,["options"]),n(p)?(D(),Y(w,{key:0,show:n(p),"onUpdate:show":t[0]||(t[0]=l=>A(p)?p.value=l:null),preset:"dialog",title:`事件操作 - ${n(c)?.title}`,style:{width:"400px"}},{default:b(()=>[i("div",oe,[v(d,{type:"primary",onClick:I,style:{"margin-right":"12px"},size:"small"},{default:b(()=>[...t[6]||(t[6]=[$(" 编辑 ",-1)])]),_:1}),v(d,{type:"error",onClick:W,size:"small"},{default:b(()=>[...t[7]||(t[7]=[$(" 删除 ",-1)])]),_:1})])]),_:1},8,["show","title"])):ee("",!0),v(w,{show:n(f),"onUpdate:show":t[5]||(t[5]=l=>A(f)?f.value=l:null),preset:"dialog",title:n(g)?"编辑事件":"添加事件","positive-text":"保存","negative-text":"取消",onPositiveClick:U},{default:b(()=>[i("div",se,[i("div",re,[t[8]||(t[8]=i("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"事件标题",-1)),v(T,{value:n(a).title,"onUpdate:value":t[1]||(t[1]=l=>n(a).title=l),placeholder:"请输入事件标题"},null,8,["value"])]),i("div",ue,[t[9]||(t[9]=i("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"事件日期",-1)),v(P,{value:n(a).date,"onUpdate:value":t[2]||(t[2]=l=>n(a).date=l),type:"date",format:"yyyy-MM-dd",style:{width:"100%"}},null,8,["value"])]),i("div",ve,[i("div",null,[t[10]||(t[10]=i("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"开始时间",-1)),v(T,{value:n(a).startTime,"onUpdate:value":t[3]||(t[3]=l=>n(a).startTime=l),type:"time",placeholder:"09:00"},null,8,["value"])]),i("div",null,[t[11]||(t[11]=i("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"结束时间",-1)),v(T,{value:n(a).endTime,"onUpdate:value":t[4]||(t[4]=l=>n(a).endTime=l),type:"time",placeholder:"10:00"},null,8,["value"])])]),i("div",pe,[t[12]||(t[12]=i("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"事件颜色",-1)),i("div",ce,[(D(),M(te,null,ae(k,l=>i("div",{key:l,style:ne({width:"30px",height:"30px",backgroundColor:l,borderRadius:"50%",cursor:"pointer",border:n(a).color===l?"3px solid #000":"2px solid #ddd"}),onClick:ye=>n(a).color=l},null,12,me)),64))])])])]),_:1},8,["show","title"])])}}}),ke=le(fe,[["__scopeId","data-v-8b4ad03c"]]);export{ke as default};
