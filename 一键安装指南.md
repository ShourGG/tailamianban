# 🚀 泰拉瑞亚管理平台 - 一键安装指南

## 方式一：一键自动安装（推荐）

### 中国大陆用户（使用镜像加速）

在Linux服务器上执行：

```bash
curl -fsSL https://github.akams.cn/https://raw.githubusercontent.com/ShourGG/tailamianban/main/deploy-cn.sh | sudo bash
```

### 海外用户

```bash
curl -fsSL https://raw.githubusercontent.com/ShourGG/tailamianban/main/deploy.sh | sudo bash
```

**安装完成后：**
- 访问地址: `http://服务器IP:8080`
- 默认账号: `CHENY` / `123456`
- 中国版本自动使用 `https://github.akams.cn` 镜像加速

## 方式二：手动下载安装

### 1. 下载最新版本

访问 [Releases](https://github.com/ShourGG/tailamianban/releases/latest) 下载对应版本：

- **x64服务器**: `terraria-admin-linux-amd64.tar.gz`
- **ARM服务器**: `terraria-admin-linux-arm64.tar.gz`

### 2. 解压并安装

```bash
# 解压
tar -xzf terraria-admin-linux-amd64.tar.gz
cd terraria-admin-linux-amd64

# 复制到安装目录
sudo mkdir -p /opt/terraria-admin
sudo cp -r * /opt/terraria-admin/

# 设置权限
sudo chmod +x /opt/terraria-admin/terraria-server
sudo chmod +x /opt/terraria-admin/deploy.sh

# 运行安装脚本
cd /opt/terraria-admin
sudo ./deploy.sh
```

## 管理命令

安装后可使用以下命令：

```bash
terraria-admin start      # 启动服务
terraria-admin stop       # 停止服务
terraria-admin restart    # 重启服务
terraria-admin status     # 查看状态
terraria-admin logs       # 查看日志
terraria-admin port 3000  # 修改端口为3000
terraria-admin update     # 更新到最新版本
terraria-admin uninstall  # 卸载
```

## 使用流程

### 1. 登录面板

访问 `http://服务器IP:8080`，使用默认账号登录：
- 用户名: `CHENY`
- 密码: `123456`

⚠️ **首次登录后请立即修改密码！**

### 2. 安装游戏服务器

登录后，点击左侧菜单：
```
系统设置 → 安装游戏服务器
```

选择要安装的版本：
- ✅ **TShock 5.2.0** (推荐) - 支持插件和权限管理
- ✅ **官方原版** - 纯净游戏体验
- ✅ **TModLoader** - 支持Mod扩展

点击"安装"按钮，等待自动下载和安装完成。

### 3. 创建游戏房间

游戏服务器安装完成后：

1. 点击左侧菜单 `房间管理 → 房间列表`
2. 点击右上角"创建房间"
3. 填写房间信息：
   - 房间名称
   - 选择游戏类型（TShock/官方/TModLoader）
   - 设置端口（默认7777）
   - 选择世界文件
4. 点击"创建"完成

### 4. 启动游戏服务器

在房间列表中，点击对应房间的"启动"按钮，即可启动游戏服务器。

玩家可以通过以下方式连接：
```
服务器IP:端口号
例如: 192.168.1.100:7777
```

## 常见问题

### 1. 端口被占用

修改监听端口：
```bash
terraria-admin port 3000
```

### 2. 无法下载游戏服务器

检查服务器网络连接：
```bash
curl -I https://github.com
```

如需使用代理：
```bash
export HTTP_PROXY=http://proxy:port
export HTTPS_PROXY=http://proxy:port
terraria-admin restart
```

### 3. 服务无法启动

查看详细日志：
```bash
terraria-admin logs
# 或
sudo journalctl -u terraria-admin -n 50
```

### 4. 防火墙设置

开放必要端口：
```bash
# 管理面板端口
sudo ufw allow 8080/tcp

# 游戏服务器端口（根据实际情况）
sudo ufw allow 7777/tcp
```

## 目录结构

```
/opt/terraria-admin/
├── terraria-server        # 后端可执行文件
├── web/                   # 前端静态文件
├── config.json            # 配置文件
├── config/                # 数据库目录
├── logs/                  # 日志目录
├── terraria_servers/      # 游戏服务器安装目录
└── deploy.sh              # 部署脚本
```

## 更新流程

### 自动更新

```bash
terraria-admin update
```

### 手动更新

```bash
# 1. 停止服务
sudo systemctl stop terraria-admin

# 2. 备份配置
sudo cp -r /opt/terraria-admin/config /tmp/config-backup

# 3. 下载新版本
wget https://github.com/ShourGG/tailamianban/releases/latest/download/terraria-admin-linux-amd64.tar.gz

# 4. 解压并替换
tar -xzf terraria-admin-linux-amd64.tar.gz
sudo cp -r terraria-admin-linux-amd64/* /opt/terraria-admin/

# 5. 恢复配置
sudo cp -r /tmp/config-backup/* /opt/terraria-admin/config/

# 6. 重启服务
sudo systemctl start terraria-admin
```

## 技术支持

- **GitHub**: https://github.com/ShourGG/tailamianban
- **Issues**: https://github.com/ShourGG/tailamianban/issues

---

**🌟 如果这个项目对你有帮助，请给个Star！**
