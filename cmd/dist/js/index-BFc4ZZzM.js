import{k as le,r as v,c as B,o as ie,Z as h,P as l,R as r,Q as p,J as i,O as _,S as u,F as z,W as E,X as d,_ as M,ai as P,j as x,H as ce}from"./vue-vendor-DIhTWhib.js";import{g as ue,s as pe}from"./index-CIpQTZjJ.js";import{H as de,X as fe,Y as me,T as he,at as _e,a2 as ve,ad as ge,K as ye,a9 as ke,M as Fe,$ as Se}from"./ui-vendor-qucRfopV.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./spline-vendor-BYERog9l.js";import"./charts-vendor-XI8Sg87J.js";import"./editor-vendor-CUlQiixb.js";const Ie={key:1,class:"input-history"},Ne=["onClick"],He={class:"history-text"},xe={key:0,class:"history-footer"},Le=["onClick"],we={class:"form-search-item-box"},Ce={class:"form-item-input"},Be=le({__name:"index",props:{bordered:{type:Boolean,default:!0},formItemList:{default:()=>[]},formParams:{},formSearchInputHistoryString:{},size:{default:"medium"}},emits:["search","reset","change-params"],setup(F,{expose:$,emit:A}){const f=F,S=A,D=de(),b=v(null),c=v([...f.formItemList]),t=v({...f.formParams}),g=v(!1),U=v(!1),V=B(()=>c.value.filter(e=>e.show!==!1)),O=B(()=>c.value.length>7),y=e=>{c.value.forEach(s=>{s.isFocus=s.hisList&&s.prop===e})},T=e=>{const s=ue(f.formSearchInputHistoryString);s&&(c.value=s),y(e)},j=(e,s)=>{t.value[s]=e,y()},I=e=>c.value.find(s=>s.prop===e),k=()=>{f.formSearchInputHistoryString&&pe(f.formSearchInputHistoryString,c.value)},R=(e,s)=>{const n=I(e);n?.hisList&&(n.hisList.splice(s,1),n.hisList.length===0&&(n.isFocus=!1),k())},X=e=>{const s=I(e);s?.hisList&&(s.hisList=[],s.isFocus=!1,k())},J=()=>{setTimeout(()=>y(),200)},K=(e,s)=>{const n=e.indexOf(s);return n>-1&&e.splice(n,1),e.unshift(s),e.length>5?e.slice(0,5):e},Q=e=>{const s=I(e);if(!s?.hisList)return;s.isFocus=!0;const n=t.value[e];if(n&&n.toString().trim()){const m=n.toString().trim();s.hisList=K(s.hisList,m)}c.value.forEach(m=>{m.prop!==e&&(m.isFocus=!1)})},W=e=>e===void 0||e===""||e===null||Array.isArray(e)&&e.length===0,Y=()=>{Object.keys(t.value).forEach(e=>{t.value[e]&&Q(e)}),y(),k()},L=()=>{Object.entries(t.value).filter(([s])=>s!=="pageNum"&&s!=="pageSize").some(([s,n])=>s.includes("Time")&&Array.isArray(n)?n[0]:!W(n))?(f.formSearchInputHistoryString&&Y(),S("search",t.value)):D.warning("请输入搜索内容，或选择筛选条件")},w=()=>{b.value?.restoreValidation(),Object.keys(t.value).forEach(e=>{e!=="pageNum"&&e!=="pageSize"&&(t.value[e]=null)}),S("change-params",t.value),S("reset")},C=()=>{g.value=!g.value,c.value.forEach((e,s)=>{s>6&&(e.show=!e.show)}),k()},Z=()=>{c.value.forEach((e,s)=>{e.isFocus=!1,s>6&&e.show===void 0&&(e.show=!1),e.type==="select"&&(e.placeholder||(e.placeholder="请选择"),t.value[e.prop]===void 0&&(t.value[e.prop]=null))})};return ie(()=>{Z()}),$({formRef:b,formParams:t,searchFn:L,cleanFn:w,changeFoldState:C}),(e,s)=>{const n=he,m=_e,q=ve,G=ge,ee=me,N=Fe,H=ke,se=ye,oe=fe,te=Se;return l(),h(te,{class:"form-search-card custom-card",bordered:F.bordered},{default:r(()=>[p(oe,{class:"form-search",model:i(t),ref_key:"formRef",ref:b,size:F.size},{default:r(()=>[(l(!0),_(z,null,E(i(V),(o,ae)=>(l(),_("div",{class:"form-search-item-box",key:ae},[o.type!=="%"?(l(),h(ee,{key:0,class:"form-item-input",path:o.prop,"show-feedback":!1,"show-label":!1},{default:r(()=>[o.type==="input"?(l(),h(n,{key:0,clearable:"",value:i(t)[o.prop],"onUpdate:value":a=>i(t)[o.prop]=a,placeholder:o.placeholder,onFocus:a=>T(o.prop),onBlur:J},null,8,["value","onUpdate:value","placeholder","onFocus"])):d("",!0),o.isFocus?(l(),_("div",Ie,[(l(!0),_(z,null,E(o.hisList,(a,ne)=>(l(),_("div",{class:"history-item",onClick:re=>j(a,o.prop),key:a},[u("span",He,M(a),1),p(m,{class:"delete-icon",size:"14",onClick:P(re=>R(o.prop,ne),["stop"])},{default:r(()=>[...s[1]||(s[1]=[u("div",{class:"i-mdi:close"},null,-1)])]),_:1},8,["onClick"])],8,Ne))),128)),o.hisList&&o.hisList.length>0?(l(),_("div",xe,[u("span",{class:"clear-all",onClick:P(a=>X(o.prop),["stop"])}," 清空历史记录 ",8,Le)])):d("",!0)])):d("",!0),o.type==="select"?(l(),h(q,{key:2,value:i(t)[o.prop],"onUpdate:value":a=>i(t)[o.prop]=a,placeholder:o.placeholder||"请选择",clearable:"",options:o.list?.map(a=>({label:a.label||a.labelDefault,value:a.value!==void 0?a.value:a.label||a.labelDefault}))},null,8,["value","onUpdate:value","placeholder","options"])):d("",!0),o.type==="date-range"?(l(),h(G,{key:3,type:"datetimerange",value:i(t)[o.prop],"onUpdate:value":a=>i(t)[o.prop]=a,format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm","start-placeholder":"开始时间","end-placeholder":"结束时间",clearable:""},null,8,["value","onUpdate:value"])):d("",!0)]),_:2},1032,["path"])):d("",!0)]))),128)),u("div",we,[u("div",Ce,[s[6]||(s[6]=u("div",{class:"button-label-placeholder"},null,-1)),p(se,null,{default:r(()=>[p(H,{trigger:"hover"},{trigger:r(()=>[p(N,{type:"primary",onClick:L,loading:i(U)},{icon:r(()=>[...s[2]||(s[2]=[u("div",{class:"i-mdi:search w-4 h-4"},null,-1)])]),_:1},8,["loading"])]),default:r(()=>[s[3]||(s[3]=x(" 搜索 ",-1))]),_:1}),p(H,{trigger:"hover"},{trigger:r(()=>[p(N,{onClick:s[0]||(s[0]=o=>w())},{icon:r(()=>[...s[4]||(s[4]=[u("div",{class:"i-mdi:refresh w-4 h-4"},null,-1)])]),_:1})]),default:r(()=>[s[5]||(s[5]=x(" 重置 ",-1))]),_:1}),i(O)?(l(),h(H,{key:0,trigger:"hover"},{trigger:r(()=>[p(N,{onClick:C},{icon:r(()=>[u("div",{class:ce(i(g)?"i-mdi:chevron-up w-4 h-4":"i-mdi:chevron-down w-4 h-4")},null,2)]),_:1})]),default:r(()=>[x(" "+M(i(g)?"收起":"展开"),1)]),_:1})):d("",!0)]),_:1})])])]),_:1},8,["model","size"])]),_:1},8,["bordered"])}}}),Ue=be(Be,[["__scopeId","data-v-63fe2683"]]);export{Ue as default};
