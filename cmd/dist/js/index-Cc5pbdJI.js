import{o}from"./index-DbHuSC4d.js";import{i as fe}from"./charts-vendor-DjXuxi75.js";import{H as me,a4 as ge,X as ve,aQ as ye,aw as he,a5 as we,K as xe,M as be,ay as Ce,az as Me,L as $e,al as ke,b0 as Se}from"./ui-vendor-Dblj447Y.js";import{k as Le,r as l,c as _,o as Ue,E as Pe,a0 as p,P as Te,Q as Ae,R as e,S as t,j as i,_ as f,U as Be}from"./vue-vendor-DgJqRHrX.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./spline-vendor-Btm54g1Q.js";import"./editor-vendor-BwkH8h9-.js";const v={auth:{login:a=>o.post("/api/auth/login",a),logout:()=>o.post("/api/auth/logout"),getCurrentUser:()=>o.get("/api/auth/me")},server:{getStatus:()=>o.get("/api/server/status"),start:()=>o.post("/api/server/start"),stop:()=>o.post("/api/server/stop"),restart:()=>o.post("/api/server/restart"),getConfig:()=>o.get("/api/server/config"),updateConfig:a=>o.put("/api/server/config",a),getLogs:(a=100)=>o.get(`/api/server/logs?lines=${a}`),clearLogs:()=>o.delete("/api/server/logs")},world:{getList:()=>o.get("/api/worlds"),create:a=>o.post("/api/worlds",a),getById:a=>o.get(`/api/worlds/${a}`),update:(a,n)=>o.put(`/api/worlds/${a}`,n),delete:a=>o.delete(`/api/worlds/${a}`),backup:a=>o.post(`/api/worlds/${a}/backup`),restore:(a,n)=>o.post(`/api/worlds/${a}/restore`,{backup_path:n}),upload:a=>{const n=new FormData;return n.append("world",a),o.post("/api/worlds/upload",n,{headers:{"Content-Type":"multipart/form-data"}})},download:a=>window.open(`/api/worlds/${a}/download`,"_blank")},player:{getList:a=>o.get("/api/players",{params:a}),getOnline:()=>o.get("/api/players/online"),getById:a=>o.get(`/api/players/${a}`),kick:(a,n)=>o.post(`/api/players/${a}/kick`,{reason:n}),ban:(a,n)=>o.post(`/api/players/${a}/ban`,n),unban:a=>o.delete(`/api/players/${a}/ban`),getBanned:()=>o.get("/api/players/bans")},system:{getMetrics:()=>o.get("/api/system/metrics"),getMetricsHistory:(a="1h",n="1m")=>o.get("/api/system/metrics/history",{params:{duration:a,resolution:n}}),getInfo:()=>o.get("/api/system/info"),getProcesses:()=>o.get("/api/system/processes")},panel:{getSettings:()=>o.get("/api/panel/settings"),updateSettings:a=>o.put("/api/panel/settings",a),getUsers:()=>o.get("/api/panel/users"),createUser:a=>o.post("/api/panel/users",a),updateUser:(a,n)=>o.put(`/api/panel/users/${a}`,n),deleteUser:a=>o.delete(`/api/panel/users/${a}`),getAuditLogs:a=>o.get("/api/panel/audit-logs",{params:a})},ws:{connect:()=>{const a=window.location.protocol==="https:"?"wss:":"ws:",n=window.location.host;return new WebSocket(`${a}//${n}/api/ws`)}}},Ne={class:"dashboard-container"},De=Le({__name:"index",setup(a){const n=me(),m=l("stopped"),T=l(0),A=l(8),B=l(""),z=l("1.4.4.9"),I=l(7777),b=l(0),N=l("classic"),C=l(0),M=l(0),k=l(!1),S=l(!1),L=l(!1),D=l([]),U=l();let d=null,P=null;const E=_(()=>({running:"运行中",stopped:"已停止",starting:"启动中",stopping:"停止中"})[m.value]||"未知"),H=_(()=>({running:"#18a058",stopped:"#d03050",starting:"#f0a020",stopping:"#f0a020"})[m.value]||"#999"),Q=_(()=>C.value>=80?"#d03050":C.value>=60?"#f0a020":"#18a058"),W=_(()=>M.value>=80?"#d03050":M.value>=60?"#f0a020":"#18a058"),F=_(()=>{const r=Math.floor(b.value/3600),s=Math.floor(b.value%3600/60),h=b.value%60;return`${r}小时 ${s}分钟 ${h}秒`}),K=_(()=>({classic:"经典",expert:"专家",master:"大师",journey:"旅程"})[N.value]||"经典"),R=_(()=>({classic:"default",expert:"warning",master:"error",journey:"info"})[N.value]||"default"),y=async()=>{try{const s=(await v.server.getStatus()).data.data;m.value=s.status,T.value=s.player_count,A.value=s.max_players,B.value=s.world_name,I.value=s.port,b.value=s.uptime}catch{}},O=async()=>{try{const s=(await v.system.getMetrics()).data.data;C.value=Math.round(s.cpu.usage_percent),M.value=Math.round(s.memory.used_percent),ee(s)}catch{}},V=async()=>{try{const r=await v.server.getLogs(20);D.value=r.data.data}catch{}},X=async()=>{k.value=!0;try{await v.server.start(),n.success("服务器启动成功"),await y()}catch{n.error("服务器启动失败")}finally{k.value=!1}},q=async()=>{S.value=!0;try{await v.server.stop(),n.success("服务器停止成功"),await y()}catch{n.error("服务器停止失败")}finally{S.value=!1}},G=async()=>{L.value=!0;try{await v.server.restart(),n.success("服务器重启成功"),await y()}catch{n.error("服务器重启失败")}finally{L.value=!1}},J=async()=>{n.info("备份功能开发中...")},Y=()=>{V()},Z=()=>{if(!U.value)return;d=fe(U.value);const r={tooltip:{trigger:"axis"},legend:{data:["CPU","内存","磁盘"]},xAxis:{type:"category",data:[]},yAxis:{type:"value",max:100,axisLabel:{formatter:"{value}%"}},series:[{name:"CPU",type:"line",smooth:!0,data:[]},{name:"内存",type:"line",smooth:!0,data:[]},{name:"磁盘",type:"line",smooth:!0,data:[]}]};d.setOption(r)},ee=r=>{if(!d)return;const s=d.getOption(),h=new Date().toLocaleTimeString();s.xAxis[0].data.length>=30&&(s.xAxis[0].data.shift(),s.series[0].data.shift(),s.series[1].data.shift(),s.series[2].data.shift()),s.xAxis[0].data.push(h),s.series[0].data.push(Math.round(r.cpu.usage_percent)),s.series[1].data.push(Math.round(r.memory.used_percent)),s.series[2].data.push(Math.round(r.disk.used_percent)),d.setOption(s)};return Ue(()=>{y(),O(),V(),Z(),P=setInterval(()=>{y(),O()},5e3)}),Pe(()=>{P&&clearInterval(P),d&&d.dispose()}),(r,s)=>{const h=p("i-mdi-server"),u=he,$=ye,c=ve,g=ge,te=p("i-mdi-account-group"),ae=p("i-mdi-cpu-64-bit"),se=p("i-mdi-memory"),j=we,oe=p("i-mdi-play"),w=be,ne=p("i-mdi-stop"),re=p("i-mdi-restart"),le=p("i-mdi-content-save"),ie=xe,x=Me,ue=$e,pe=Ce,ce=Se,de=ke,_e=p("i-mdi-refresh");return Ae(),Te("div",Ne,[e(j,{"x-gap":16,"y-gap":16,cols:24},{default:t(()=>[e(g,{span:6},{default:t(()=>[e(c,null,{default:t(()=>[e($,{label:"服务器状态"},{prefix:t(()=>[e(u,{color:H.value},{default:t(()=>[e(h)]),_:1},8,["color"])]),default:t(()=>[i(" "+f(E.value),1)]),_:1})]),_:1})]),_:1}),e(g,{span:6},{default:t(()=>[e(c,null,{default:t(()=>[e($,{label:"在线玩家",value:T.value},{prefix:t(()=>[e(u,{color:"#18a058"},{default:t(()=>[e(te)]),_:1})]),suffix:t(()=>[i(" / "+f(A.value),1)]),_:1},8,["value"])]),_:1})]),_:1}),e(g,{span:6},{default:t(()=>[e(c,null,{default:t(()=>[e($,{label:"CPU使用率",value:C.value},{prefix:t(()=>[e(u,{color:Q.value},{default:t(()=>[e(ae)]),_:1},8,["color"])]),suffix:t(()=>[...s[0]||(s[0]=[i("%",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),e(g,{span:6},{default:t(()=>[e(c,null,{default:t(()=>[e($,{label:"内存使用",value:M.value},{prefix:t(()=>[e(u,{color:W.value},{default:t(()=>[e(se)]),_:1},8,["color"])]),suffix:t(()=>[...s[1]||(s[1]=[i("%",-1)])]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(c,{title:"快捷操作",class:"mt-4"},{default:t(()=>[e(ie,null,{default:t(()=>[e(w,{type:"success",loading:k.value,disabled:m.value==="running",onClick:X},{icon:t(()=>[e(u,null,{default:t(()=>[e(oe)]),_:1})]),default:t(()=>[s[2]||(s[2]=i(" 启动服务器 ",-1))]),_:1},8,["loading","disabled"]),e(w,{type:"error",loading:S.value,disabled:m.value!=="running",onClick:q},{icon:t(()=>[e(u,null,{default:t(()=>[e(ne)]),_:1})]),default:t(()=>[s[3]||(s[3]=i(" 停止服务器 ",-1))]),_:1},8,["loading","disabled"]),e(w,{type:"warning",loading:L.value,disabled:m.value!=="running",onClick:G},{icon:t(()=>[e(u,null,{default:t(()=>[e(re)]),_:1})]),default:t(()=>[s[4]||(s[4]=i(" 重启服务器 ",-1))]),_:1},8,["loading","disabled"]),e(w,{type:"info",onClick:J},{icon:t(()=>[e(u,null,{default:t(()=>[e(le)]),_:1})]),default:t(()=>[s[5]||(s[5]=i(" 备份世界 ",-1))]),_:1})]),_:1})]),_:1}),e(j,{"x-gap":16,"y-gap":16,cols:24,class:"mt-4"},{default:t(()=>[e(g,{span:12},{default:t(()=>[e(c,{title:"服务器信息"},{default:t(()=>[e(pe,{column:1,"label-placement":"left"},{default:t(()=>[e(x,{label:"世界名称"},{default:t(()=>[i(f(B.value||"-"),1)]),_:1}),e(x,{label:"游戏版本"},{default:t(()=>[i(f(z.value||"-"),1)]),_:1}),e(x,{label:"服务器端口"},{default:t(()=>[i(f(I.value||"-"),1)]),_:1}),e(x,{label:"运行时间"},{default:t(()=>[i(f(F.value),1)]),_:1}),e(x,{label:"难度模式"},{default:t(()=>[e(ue,{type:R.value},{default:t(()=>[i(f(K.value),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{span:12},{default:t(()=>[e(c,{title:"系统资源"},{default:t(()=>[Be("div",{ref_key:"chartContainer",ref:U,style:{height:"250px"}},null,512)]),_:1})]),_:1})]),_:1}),e(c,{title:"最近日志",class:"mt-4"},{"header-extra":t(()=>[e(w,{text:"",onClick:Y},{icon:t(()=>[e(u,null,{default:t(()=>[e(_e)]),_:1})]),default:t(()=>[s[6]||(s[6]=i(" 刷新 ",-1))]),_:1})]),default:t(()=>[e(de,{style:{"max-height":"300px"}},{default:t(()=>[e(ce,{lines:D.value,"font-size":12},null,8,["lines"])]),_:1})]),_:1})])}}}),We=Ie(De,[["__scopeId","data-v-9f7040fa"]]);export{We as default};
