import{P as le,_ as oe}from"./index.vue_vue_type_script_setup_true_lang-D3cPmkgY.js";import{u as ne,D as se}from"./useDynamicFormState-DmIdlYeK.js";import{K as ie,M as re,X as de,a9 as ce,a8 as ue}from"./ui-vendor-Dblj447Y.js";import{k as me,ao as O,ap as pe,r as b,e as _e,c as R,K as fe,w as x,o as ve,n as ge,P as I,Q as F,U as c,X as ye,R as r,S as o,J as t,j as E,_ as h,H as w,F as Fe,M as he,Z as Ce,p as Se}from"./vue-vendor-DgJqRHrX.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const{required:Ie}=le,Ee={maxFields:20,autoSave:!0,enableSort:!0,showControls:!0,showItemControls:!0},z=[{type:"input",prop:"name",label:"姓名",placeholder:"请输入姓名",rules:[Ie("姓名")],layout:{span:12}},{type:"select",prop:"gender",label:"性别",placeholder:"请选择性别",children:[{label:"男",value:"male"},{label:"女",value:"female"},{label:"其他",value:"other"}],layout:{span:12}},{type:"inputNumber",prop:"age",label:"年龄",placeholder:"请输入年龄",attrs:{min:1,max:120},layout:{span:8}},{type:"switch",prop:"isActive",label:"是否激活",value:!1,layout:{span:8}},{type:"rate",prop:"rating",label:"评分",value:0,layout:{span:8}},{type:"textarea",prop:"description",label:"描述",placeholder:"请输入描述信息",layout:{span:24}}],we=a=>({type:"dynamic",dynamic:{dynamic:{maxFields:a.maxFields},controls:{showControls:a.showControls,showItemControls:a.showItemControls},grid:{cols:24,gutter:16}}}),Te={SUBMIT_DELAY:1500,MESSAGES:{SUBMIT_SUCCESS:"表单提交成功",SUBMIT_ERROR:"表单提交失败",VALIDATION_SUCCESS:"验证成功",VALIDATION_ERROR:"验证失败",FIELD_ADD:"字段添加成功",FIELD_REMOVE:"字段移除成功",FIELD_TOGGLE:"字段状态切换",FIELDS_CLEAR:"所有动态字段已清空"}},De=[{name:"formData",tab:"表单数据",icon:"i-mdi:form-select"},{name:"config",tab:"动态配置",icon:"i-mdi:cog"},{name:"allFields",tab:"所有字段",icon:"i-mdi:view-list"}],Ne=(a,l)=>({totalFields:a.allFieldsCount,baseFields:a.baseFieldsCount,dynamicFields:a.dynamicFieldsCount,visibleFields:a.visibleFieldsCount,hiddenFields:a.hiddenFieldsCount,config:l.config,stateInitialized:l.isInitialized}),Oe=(a,l,m,C,d)=>({allFieldsCount:a,baseFieldsCount:l,dynamicFieldsCount:m,visibleFieldsCount:C,hiddenFieldsCount:d}),Re=(a,l)=>({config:a,isInitialized:l}),xe=a=>a.map(l=>({prop:l.prop,label:l.label,type:l.type,required:l.rules?.some(m=>m.required)||!1,span:l.layout?.span||12})),s={submit:{type:"primary",size:"large",icon:"i-mdi:check-circle-outline",getText:a=>a?"提交中...":"提交表单"},reset:{size:"large",icon:"i-mdi:refresh",text:"重置表单"},preview:{size:"large",icon:"i-mdi:code-json",text:"预览数据"}},ze={class:"demo-page"},Ae={class:"form-section"},Ve={class:"form-actions"},Me={key:0,class:"preview-section"},Le={class:"json-preview"},ke=me({__name:"index",props:O({labelPlacement:{default:"left"},validateOnChange:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:O(["submit","validate-success","validate-error","fields-change"],["update:modelValue"]),setup(a,{expose:l,emit:m}){const C=a,d=m,f=pe(a,"modelValue"),v=b(),g=b(!1),S=b(!1),p=_e({...Ee}),u=ne();Se(se,u);const{allFields:_,visibleFields:A,dynamicFieldsCount:V,hiddenFieldsCount:M}=u,L=R(()=>we(p)),{labelPlacement:k,validateOnChange:B}=fe(C),P=R(()=>{const e=Oe(_.value.length,z.length,V.value,A.value.length,M.value),n=Re(p,u.state.isInitialized);return Ne(e,n)}),U=e=>{switch(e){case"formData":return JSON.stringify(f.value,null,2);case"config":return JSON.stringify(P.value,null,2);case"allFields":return JSON.stringify(xe(_.value),null,2);default:return"{}"}},T=()=>{S.value=!0},D=async e=>{try{g.value=!0,await e(),await new Promise(n=>setTimeout(n,Te.SUBMIT_DELAY))}catch{}finally{g.value=!1}},G=e=>{d("submit",e)},Y=e=>{d("validate-success",e)},j=e=>{d("validate-error",e)},q=e=>{},J=e=>{},K=(e,n)=>{},$=()=>{},W=e=>{d("fields-change",e)},X=async()=>v.value?.validate(),H=()=>{v.value?.resetFields()};return x(p,e=>{u.updateConfig(e)},{deep:!0}),x(_,e=>{d("fields-change",e)},{deep:!0}),ve(()=>{u.initialize(z,p),ge(()=>{d("fields-change",_.value)})}),l({validate:X,resetFields:H,formData:f,formConfig:p,dynamicState:u,previewData:T,submitWithValidation:D,formRef:v}),(e,n)=>{const y=re,Q=ie,Z=oe,N=de,ee=ue,ae=ce;return F(),I("div",ze,[c("div",Ae,[r(N,{size:"medium"},{default:o(()=>[r(Z,{ref_key:"formRef",ref:v,modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=i=>f.value=i),options:t(_),"layout-type":"dynamic","layout-config":t(L),"label-placement":t(k),"validate-on-value-change":t(B),onSubmit:G,onValidateSuccess:Y,onValidateError:j,onFieldAdd:q,onFieldRemove:J,onFieldToggle:K,onFieldsClear:$,onFieldsChange:W},{action:o(({validate:i,reset:te})=>[c("div",Ve,[r(Q,{justify:"center"},{default:o(()=>[r(y,{type:t(s).submit.type,size:t(s).submit.size,loading:t(g),onClick:Be=>D(i)},{icon:o(()=>[c("div",{class:w(t(s).submit.icon)},null,2)]),default:o(()=>[E(" "+h(t(s).submit.getText(t(g))),1)]),_:1},8,["type","size","loading","onClick"]),r(y,{size:t(s).reset.size,onClick:te},{icon:o(()=>[c("div",{class:w(t(s).reset.icon)},null,2)]),default:o(()=>[E(" "+h(t(s).reset.text),1)]),_:2},1032,["size","onClick"]),r(y,{size:t(s).preview.size,onClick:T},{icon:o(()=>[c("div",{class:w(t(s).preview.icon)},null,2)]),default:o(()=>[E(" "+h(t(s).preview.text),1)]),_:1},8,["size"])]),_:2},1024)])]),_:1},8,["modelValue","options","layout-config","label-placement","validate-on-value-change"])]),_:1})]),t(S)?(F(),I("div",Me,[r(N,{title:"数据预览",size:"small"},{"header-extra":o(()=>[r(y,{size:"small",onClick:n[1]||(n[1]=i=>S.value=!1)},{icon:o(()=>[...n[2]||(n[2]=[c("div",{class:"i-mdi:close"},null,-1)])]),_:1})]),default:o(()=>[r(ae,{type:"line",animated:""},{default:o(()=>[(F(!0),I(Fe,null,he(t(De),i=>(F(),Ce(ee,{key:i.name,name:i.name,tab:i.tab},{default:o(()=>[c("div",Le,[c("pre",null,h(U(i.name)),1)])]),_:2},1032,["name","tab"]))),128))]),_:1})]),_:1})])):ye("",!0)])}}}),qe=be(ke,[["__scopeId","data-v-95d1a4ad"]]);export{qe as default};
