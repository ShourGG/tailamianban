import G from"./index-C1FBFoXM.js";import{k as H,r as C,c as $,y as Q,w as Z,P as p,Q as a,R as d,Z as _,X as U,U as s,S as l,J as u,j as m,_ as f,F as g,H as x,ah as q,a2 as I,M as B,a6 as W}from"./vue-vendor-DgJqRHrX.js";import{$ as Y,M as tt,X as et,a0 as st,L as ot,a1 as lt}from"./ui-vendor-Dblj447Y.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const at={class:"custom-layout"},it={class:"toolbar-content"},dt={class:"mode-section"},rt={class:"stats-section"},ut={class:"stat-item"},pt={class:"stat-value"},mt={class:"stat-item"},ct={class:"stat-value"},ft={class:"actions-section"},vt={class:"design-tools"},_t={class:"tool-group"},yt={key:0,class:"canvas-hint"},gt={class:"area-header"},kt={class:"area-info"},bt=["onClick"],Ct={class:"area-controls"},$t={class:"field-item"},xt={class:"field-preview"},zt={class:"field-label"},ht={class:"field-type"},wt={key:0,class:"area-drop-zone"},Dt={class:"pool-field"},Vt={class:"field-name"},Ft={class:"field-type-tag"},Nt={key:0,class:"empty-layout"},St={key:1,class:"form-container"},Ut={class:"form-areas"},It=H({__name:"index",props:{options:{default:()=>[]},formItems:{default:()=>[]},formData:{default:()=>({})}},emits:["fields-change","export-data"],setup(L,{emit:M}){const y=L,V=M,c=C(!0),r=C([]),F=C([]),k=C(""),R=$(()=>y.options?.length>0?y.options:y.formItems?.map(o=>{const t=o.props;return{prop:t?.path||"",label:t?.label||t?.path||"",type:"input",show:!0}}).filter(o=>o.prop)||[]),j=$(()=>r.value.reduce((o,t)=>o+t.fields.length,0)),z=$({get:()=>r.value,set:o=>{r.value=o}}),h=$({get:()=>F.value,set:o=>{}}),E=()=>`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,N=o=>({input:"输入框",select:"下拉框",radio:"单选框",checkbox:"复选框",textarea:"文本域",date:"日期",number:"数字"})[o]||o,O=o=>y.formItems?.find(t=>t.props?.path===o.prop)||null,w=o=>{const t={id:E(),title:`${o==="horizontal"?"水平":o==="vertical"?"垂直":"网格"}区域`,type:o,fields:[]};r.value.push(t)},P=o=>{const t=r.value.findIndex(n=>n.id===o);t!==-1&&r.value.splice(t,1)},T=()=>{const o=JSON.stringify(r.value,null,2),t=new Blob([o],{type:"application/json"}),n=URL.createObjectURL(t),v=document.createElement("a");v.href=n,v.download=`layout-config-${Date.now()}.json`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(n)},A=()=>{r.value=[]},J=()=>{const o={layout:r.value,formData:y.formData,timestamp:new Date().toISOString()};V("export-data",o)};return Q(()=>{const o=new Set(r.value.flatMap(t=>t.fields.map(n=>n.prop)));F.value=R.value.filter(t=>!o.has(t.prop)).map(t=>({...t,id:t.prop}))}),Z(()=>r.value,()=>{const o=r.value.flatMap(t=>t.fields.map(n=>({...n,id:void 0})));V("fields-change",o)},{deep:!0}),(o,t)=>{const n=tt,v=Y,b=et,K=st,X=ot,D=G,S=lt;return a(),p("div",at,[d(b,{bordered:!1,class:"toolbar-card"},{default:l(()=>[s("div",it,[s("div",dt,[t[13]||(t[13]=s("span",{class:"section-label"},"自定义模式:",-1)),d(v,null,{default:l(()=>[d(n,{type:u(c)?"primary":"default",onClick:t[0]||(t[0]=e=>c.value=!0),size:"small"},{default:l(()=>[...t[11]||(t[11]=[m(" 🎨 设计模式 ",-1)])]),_:1},8,["type"]),d(n,{type:u(c)?"default":"primary",onClick:t[1]||(t[1]=e=>c.value=!1),size:"small"},{default:l(()=>[...t[12]||(t[12]=[m(" 📝 填写模式 ",-1)])]),_:1},8,["type"])]),_:1})]),s("div",rt,[s("div",ut,[s("div",pt,f(u(r).length),1),t[14]||(t[14]=s("div",{class:"stat-label"},"自定义区域",-1))]),s("div",mt,[s("div",ct,f(u(j)),1),t[15]||(t[15]=s("div",{class:"stat-label"},"字段总数",-1))])]),s("div",ft,[u(c)?(a(),p(g,{key:0},[d(n,{secondary:"",onClick:T,size:"small"},{default:l(()=>[...t[16]||(t[16]=[m(" 💾 保存布局 ",-1)])]),_:1}),d(n,{secondary:"",onClick:A,size:"small"},{default:l(()=>[...t[17]||(t[17]=[m(" 🔄 重置布局 ",-1)])]),_:1})],64)):(a(),_(n,{key:1,secondary:"",onClick:J,size:"small"},{default:l(()=>[...t[18]||(t[18]=[m(" 📊 导出数据 ",-1)])]),_:1}))])])]),_:1}),u(c)?(a(),_(b,{key:0,class:"design-panel",title:"🎨 设计工具"},{default:l(()=>[s("div",vt,[s("div",_t,[t[22]||(t[22]=s("span",{class:"group-label"},"添加区域:",-1)),d(n,{onClick:t[2]||(t[2]=e=>w("horizontal")),size:"small"},{default:l(()=>[...t[19]||(t[19]=[m(" ➡️ 水平区域 ",-1)])]),_:1}),d(n,{onClick:t[3]||(t[3]=e=>w("vertical")),size:"small"},{default:l(()=>[...t[20]||(t[20]=[m(" ⬇️ 垂直区域 ",-1)])]),_:1}),d(n,{onClick:t[4]||(t[4]=e=>w("grid")),size:"small"},{default:l(()=>[...t[21]||(t[21]=[m(" ⚏ 网格区域 ",-1)])]),_:1})])])]),_:1})):U("",!0),s("div",{class:x(["layout-canvas",{"design-mode":u(c)}])},[u(c)?(a(),p(g,{key:0},[u(r).length===0?(a(),p("div",yt,[...t[23]||(t[23]=[s("div",{class:"hint-content"},[s("h3",null,"🎨 开始自定义你的布局"),s("p",null,"点击上方按钮添加区域")],-1)])])):(a(),_(D,{key:1,modelValue:u(z),"onUpdate:modelValue":t[7]||(t[7]=e=>I(z)?z.value=e:null),group:"areas",class:"areas-container",animation:200,"ghost-class":"area-ghost","item-key":e=>String(e.id),"show-empty-state":!1},{default:l(({item:e})=>[s("div",{class:x(["custom-area",`area-${e.type}`])},[s("div",gt,[s("div",kt,[u(k)===e.id?(a(),_(K,{key:0,value:e.title,"onUpdate:value":i=>e.title=i,size:"small",onBlur:t[5]||(t[5]=i=>k.value=""),onKeyup:t[6]||(t[6]=q(i=>k.value="",["enter"])),class:"title-input"},null,8,["value","onUpdate:value"])):(a(),p("span",{key:1,class:"area-title",onClick:i=>k.value=e.id},f(e.title),9,bt)),d(X,{size:"small"},{default:l(()=>[m(f(e.fields.length)+" 字段",1)]),_:2},1024)]),s("div",Ct,[d(n,{text:"",onClick:i=>P(e.id),size:"tiny",type:"error",title:"删除区域"},{default:l(()=>[...t[24]||(t[24]=[m(" 🗑️ ",-1)])]),_:1},8,["onClick"])])]),d(D,{modelValue:e.fields,"onUpdate:modelValue":i=>e.fields=i,group:"fields",class:"area-fields",animation:200,"ghost-class":"field-ghost","item-key":i=>String(i.id),"show-empty-state":!1},{default:l(({item:i})=>[s("div",$t,[s("div",xt,[s("span",zt,f(i.label||i.prop),1),s("span",ht,f(N(i.type)),1)])])]),_:1},8,["modelValue","onUpdate:modelValue","item-key"]),e.fields.length===0?(a(),p("div",wt," 拖拽字段到这里 ")):U("",!0)],2)]),_:1},8,["modelValue","item-key"])),d(b,{class:"field-pool",title:"📦 可用字段"},{default:l(()=>[d(D,{modelValue:u(h),"onUpdate:modelValue":t[8]||(t[8]=e=>I(h)?h.value=e:null),layout:"grid","grid-columns":4,gap:"12px",group:"fields",animation:200,"item-key":e=>String(e.id),"show-empty-state":!1},{default:l(({item:e})=>[s("div",Dt,[s("span",Vt,f(e.label||e.prop),1),s("span",Ft,f(N(e.type)),1)])]),_:1},8,["modelValue","item-key"])]),_:1})],64)):(a(),p(g,{key:1},[u(r).length===0?(a(),p("div",Nt,[d(S,{description:"尚未设计布局"},{extra:l(()=>[d(n,{onClick:t[9]||(t[9]=e=>c.value=!0),type:"primary"},{default:l(()=>[...t[25]||(t[25]=[m(" 🎨 开始设计 ",-1)])]),_:1})]),_:1})])):(a(),p("div",St,[s("div",Ut,[(a(!0),p(g,null,B(u(r),e=>(a(),p("div",{key:e.id,class:x(["form-area",`area-${e.type}`])},[e.fields.length>0?(a(),_(b,{key:0,title:e.title},{default:l(()=>[s("div",{class:x(["area-form-items",`layout-${e.type}`])},[(a(!0),p(g,null,B(e.fields,i=>(a(),_(W(O(i)),{key:i.prop}))),128))],2)]),_:2},1032,["title"])):(a(),_(S,{key:1,description:"此区域暂无字段",size:"small"},{extra:l(()=>[d(n,{onClick:t[10]||(t[10]=i=>c.value=!0),size:"small",secondary:""},{default:l(()=>[...t[26]||(t[26]=[m(" 🎨 添加字段 ",-1)])]),_:1})]),_:1}))],2))),128))])]))],64))],2)])}}}),jt=nt(It,[["__scopeId","data-v-197bdadf"]]);export{jt as default};
