import{J as P,F as Z}from"./office-vendor-DeHr7Ug1.js";import{H as L,aJ as I,ao as W,Y as q,X,a0 as Q,af as Y,ag as G,M as K,aq as ee,a2 as te,aU as ae,D as ne}from"./ui-vendor-Dblj447Y.js";import{r as S,c as oe,k as se,P as $,Q as M,R as r,U as i,Z as le,X as ie,S as c,j as x,J as a,_ as b,a2 as J,F as A,M as O,H as re}from"./vue-vendor-DgJqRHrX.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./charts-vendor-DjXuxi75.js";function ue(){const y=L(),p=S({loading:!1,progress:0,currentFile:"",lastResult:null}),_=()=>new P,u=(t,s,n)=>{t.file(s,n)},f=(t,s)=>t.folder(s),m=(t,s="")=>{p.value.progress=t,p.value.currentFile=s},h=async(t,s)=>{const n=await t.generateAsync({type:"blob"});Z.saveAs(n,s)},j=t=>{p.value.lastResult=t,p.value.loading=!1,t.success?y.success(t.message):y.error(t.message)},N=async(t,s,n)=>{p.value.loading=!0,m(0,"准备中...");try{const d=_(),{fileName:l,fileCount:g}=await s(d,t);m(90,"生成压缩文件..."),await h(d,l),m(100);const v={success:!0,fileName:l,fileCount:g,message:n};return j(v),v}catch(d){const l={success:!1,fileName:"",fileCount:0,message:`导出失败: ${d.message}`};return j(l),l}},C=async t=>N(t,async(s,n)=>{const d=n.framework?f(s,"src"):s;if(n.files.forEach((l,g)=>{u(d,l.path,l.content),m(10+g/n.files.length*60,l.path)}),n.includeConfig){const l=F(n);u(s,"package.json",JSON.stringify(l,null,2)),m(75,"package.json")}if(n.includeReadme){const l=U(n);u(s,"README.md",l),m(85,"README.md")}return{fileName:`${n.projectName}.zip`,fileCount:n.files.length}},`项目 ${t.projectName} 导出成功！`),R=async t=>N(t,async(s,n)=>{m(20,"处理数据...");const d=n.format==="csv"?k(n.data):JSON.stringify(n.data,null,2),l=n.format==="excel"?"csv":n.format;if(u(s,`${n.title}.${l}`,d),m(60,`${n.title}.${l}`),n.includeSummary){const g={title:n.title,totalRecords:n.data.length,exportTime:new Date().toISOString()};u(s,"summary.json",JSON.stringify(g,null,2)),m(80,"summary.json")}return{fileName:`${n.title}_report.zip`,fileCount:n.data.length}},`报表 ${t.title} 导出成功！包含 ${t.data.length} 条数据`),E=async t=>N(t,async(s,n)=>{const d=n.organizeByCategory?{image:f(s,"images"),video:f(s,"videos"),audio:f(s,"audios"),other:f(s,"others")}:null,l=[];for(let g=0;g<n.files.length;g++){const v=n.files[g],w=v.category||"other",B=d?d[w]||d.other:s;u(B,v.name,v.file),n.includeMetadata&&l.push({name:v.name,size:v.file.size,type:v.file.type,category:v.category}),m(20+g/n.files.length*60,v.name)}return n.includeMetadata&&l.length&&u(s,"media-info.json",JSON.stringify(l,null,2)),{fileName:`${n.packageName}.zip`,fileCount:n.files.length}},`媒体包 ${t.packageName} 导出成功！`),D=async t=>N(t,async(s,n)=>{if(n.bundleMode==="separate"?n.templates.forEach((d,l)=>{const g=f(s,d.name);Object.entries(d.files).forEach(([v,w])=>{u(g,v,w)}),m(20+l/n.templates.length*60,d.name)}):n.templates.forEach(d=>{Object.entries(d.files).forEach(([l,g])=>{u(s,`${d.name}/${l}`,g)})}),n.includeDocumentation){const d=e(n);u(s,"README.md",d),m(85,"README.md")}return{fileName:`${n.libraryName}_templates.zip`,fileCount:n.templates.length}},`模板库 ${t.libraryName} 导出成功！`);function F(t){const s={vue:{vue:"^3.4.0"},react:{react:"^18.0.0"},nodejs:{express:"^4.18.0"},vanilla:{}};return{name:t.projectName,version:"1.0.0",dependencies:s[t.framework||"vanilla"]}}function U(t){return`# ${t.projectName}

## 技术栈
${t.framework?`- ${t.framework}`:"- Vanilla JavaScript"}

## 安装
\`\`\`bash
npm install
\`\`\`

## 使用
\`\`\`bash
npm run dev
\`\`\`

生成时间: ${new Date().toLocaleString()}`}function k(t){if(!t.length)return"";const s=Object.keys(t[0]);return[s.join(","),...t.map(d=>s.map(l=>d[l]).join(","))].join(`
`)}function e(t){return`# ${t.libraryName}

## 包含模板
${t.templates.map(s=>`- ${s.name}`).join(`
`)}

## 使用方法
1. 解压到目标目录
2. 选择需要的模板
3. 根据文档配置

生成时间: ${new Date().toLocaleString()}`}return{createZip:_,addFile:u,createFolder:f,downloadZip:h,state:oe(()=>p.value),exportCodeProject:C,exportReport:R,exportMedia:E,exportTemplates:D}}const ce=[{label:"Vue 3",value:"vue"},{label:"React",value:"react"},{label:"Node.js",value:"nodejs"},{label:"Vanilla JS",value:"vanilla"}],pe=[{label:"Excel (.csv)",value:"excel"},{label:"CSV (.csv)",value:"csv"},{label:"JSON (.json)",value:"json"}],me=[{label:"分离模式",value:"separate"},{label:"合并模式",value:"combined"}],V=[{id:"vue-component",name:"Vue 组件",category:"Vue"},{id:"react-hook",name:"React Hook",category:"React"},{id:"typescript-utils",name:"TS 工具",category:"TypeScript"},{id:"nodejs-api",name:"Node API",category:"Backend"}],ve=[{id:1,name:"产品A",value:1200,date:"2024-01-15"},{id:2,name:"产品B",value:850,date:"2024-01-16"},{id:3,name:"产品C",value:1500,date:"2024-01-17"},{id:4,name:"产品D",value:920,date:"2024-01-18"},{id:5,name:"产品E",value:1100,date:"2024-01-19"}],fe=`<template>
  <div class="app">
    <h1>{{ title }}</h1>
    <NButton @click="handleClick" type="primary">
      点击计数: {{ count }}
    </NButton>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { NButton } from 'naive-ui'

const title = ref('Hello Vue 3!')
const count = ref(0)

const handleClick = () => {
  count.value++
}
<\/script>

<style scoped>
.app {
  text-align: center;
  padding: 20px;
}
</style>`,ge=y=>({"vue-component":{"Component.vue":`<template>
  <div>{{ message }}</div>
</template>`,"index.ts":'export { default } from "./Component.vue"'},"react-hook":{"useHook.ts":`import { useState } from "react"
export const useHook = () => useState(0)`},"typescript-utils":{"utils.ts":"export const formatDate = (date: Date) => date.toISOString()"},"nodejs-api":{"server.js":`const express = require("express")
const app = express()
app.listen(3000)`}})[y]||{},ye=y=>y.startsWith("image/")?"image":y.startsWith("video/")?"video":y.startsWith("audio/")?"audio":"document",_e=y=>y.file instanceof File&&typeof y.name=="string",ke={class:"jszip-demo"},xe={class:"flex items-center gap-4"},Ne={class:"flex-1"},be={class:"text-sm text-gray-600 mb-1"},Ce={class:"text-lg font-bold"},we={class:"form-row"},Se={class:"actions"},he={class:"form-row"},je={class:"data-preview"},Me={class:"preview-header"},$e={class:"preview-grid"},Re={class:"actions"},Ee={class:"form-row"},De={class:"actions"},Fe={class:"form-row"},Ue={class:"template-selection"},Be={class:"template-grid"},Je=["onClick"],Ae={class:"font-semibold"},Oe={class:"text-xs text-gray-500"},Ve={class:"actions"},Te=se({__name:"index",setup(y){const p=ue(),_=S({projectName:"my-awesome-app",framework:"vue",includeConfig:!0,includeReadme:!0,files:[]}),u=S({title:"sales-report",format:"excel",dateRange:null,includeSummary:!0}),f=S({packageName:"media-resources",organizeByCategory:!0,includeMetadata:!0,maxFileSize:10}),m=S({libraryName:"my-template-library",bundleMode:"separate",includeDocumentation:!0,templates:[]}),h=S(fe),j=S(ve),N=S([]),C=S(["vue-component","typescript-utils"]),R=k=>{const e=C.value.indexOf(k);e>-1?C.value.splice(e,1):C.value.push(k)},E=async()=>{const k=[{path:"App.vue",content:h.value},{path:"main.ts",content:`import { createApp } from 'vue'
import App from './App.vue'

createApp(App).mount('#app')`}],e={..._.value,files:k};await p.exportCodeProject(e)},D=async()=>{const k={title:u.value.title,format:u.value.format,includeSummary:u.value.includeSummary,data:j.value};await p.exportReport(k)},F=async()=>{const e=N.value.filter(_e).map(s=>({name:s.name,file:s.file,category:ye(s.file.type||"")})),t={packageName:f.value.packageName,organizeByCategory:f.value.organizeByCategory,includeMetadata:f.value.includeMetadata,files:e};await p.exportMedia(t)},U=async()=>{const k=V.filter(t=>C.value.includes(t.id)).map(t=>({id:t.id,name:t.name,files:ge(t.id)})),e={...m.value,templates:k};await p.exportTemplates(e)};return(k,e)=>{const t=I,s=W,n=q,d=X,l=Q,g=Y,v=G,w=K,B=ee,T=te,z=ae,H=ne;return M(),$("div",ke,[r(t,null,{default:c(()=>[...e[17]||(e[17]=[x("导出 Zip - [useJsZip] 场景示例",-1)])]),_:1}),e[34]||(e[34]=i("p",{class:"mb-20px"},"JSZip Hooks 配置驱动的文件压缩导出工具",-1)),a(p).state.value.loading?(M(),le(d,{key:0,class:"progress-card"},{default:c(()=>[i("div",xe,[r(s,{size:"small"}),i("div",Ne,[i("div",be,b(a(p).state.value.currentFile||"准备中..."),1),r(n,{percentage:a(p).state.value.progress,"show-indicator":!1},null,8,["percentage"])]),i("div",Ce,b(Math.round(a(p).state.value.progress))+"% ",1)])]),_:1})):ie("",!0),r(d,{title:"📝 代码项目导出",class:"section"},{default:c(()=>[i("div",we,[r(l,{value:a(_).projectName,"onUpdate:value":e[0]||(e[0]=o=>a(_).projectName=o),placeholder:"项目名称"},null,8,["value"]),r(g,{value:a(_).framework,"onUpdate:value":e[1]||(e[1]=o=>a(_).framework=o),options:a(ce),placeholder:"框架"},null,8,["value","options"]),r(v,{checked:a(_).includeConfig,"onUpdate:checked":e[2]||(e[2]=o=>a(_).includeConfig=o)},{default:c(()=>[...e[18]||(e[18]=[x("配置文件",-1)])]),_:1},8,["checked"]),r(v,{checked:a(_).includeReadme,"onUpdate:checked":e[3]||(e[3]=o=>a(_).includeReadme=o)},{default:c(()=>[...e[19]||(e[19]=[x("README",-1)])]),_:1},8,["checked"])]),r(l,{value:a(h),"onUpdate:value":e[4]||(e[4]=o=>J(h)?h.value=o:null),type:"textarea",placeholder:"输入代码内容...",rows:6,class:"mt-4"},null,8,["value"]),i("div",Se,[r(w,{type:"primary",loading:a(p).state.value.loading,onClick:E},{icon:c(()=>[...e[20]||(e[20]=[i("div",{class:"i-mdi:download"},null,-1)])]),default:c(()=>[e[21]||(e[21]=x(" 导出项目 ",-1))]),_:1},8,["loading"])])]),_:1}),r(d,{title:"📊 数据报表导出",class:"section"},{default:c(()=>[i("div",he,[r(l,{value:a(u).title,"onUpdate:value":e[5]||(e[5]=o=>a(u).title=o),placeholder:"报表标题"},null,8,["value"]),r(g,{value:a(u).format,"onUpdate:value":e[6]||(e[6]=o=>a(u).format=o),options:a(pe),placeholder:"格式"},null,8,["value","options"]),r(B,{value:a(u).dateRange,"onUpdate:value":e[7]||(e[7]=o=>a(u).dateRange=o),type:"daterange",clearable:""},null,8,["value"]),r(v,{checked:a(u).includeSummary,"onUpdate:checked":e[8]||(e[8]=o=>a(u).includeSummary=o)},{default:c(()=>[...e[22]||(e[22]=[x("数据摘要",-1)])]),_:1},8,["checked"])]),i("div",je,[i("div",Me,"预览数据 ("+b(a(j).length)+" 条)",1),i("div",$e,[(M(!0),$(A,null,O(a(j).slice(0,3),o=>(M(),$("div",{key:o.id,class:"preview-row"},[i("span",null,b(o.id),1),i("span",null,b(o.name),1),i("span",null,b(o.value),1),i("span",null,b(o.date),1)]))),128))])]),i("div",Re,[r(w,{type:"success",loading:a(p).state.value.loading,onClick:D},{icon:c(()=>[...e[23]||(e[23]=[i("div",{class:"i-mdi:table-arrow-down"},null,-1)])]),default:c(()=>[e[24]||(e[24]=x(" 导出报表 ",-1))]),_:1},8,["loading"])])]),_:1}),r(d,{title:"🖼️ 媒体资源导出",class:"section"},{default:c(()=>[i("div",Ee,[r(l,{value:a(f).packageName,"onUpdate:value":e[9]||(e[9]=o=>a(f).packageName=o),placeholder:"资源包名称"},null,8,["value"]),r(T,{value:a(f).maxFileSize,"onUpdate:value":e[10]||(e[10]=o=>a(f).maxFileSize=o),placeholder:"最大文件(MB)",min:1,max:100},null,8,["value"]),r(v,{checked:a(f).organizeByCategory,"onUpdate:checked":e[11]||(e[11]=o=>a(f).organizeByCategory=o)},{default:c(()=>[...e[25]||(e[25]=[x("按类别分组",-1)])]),_:1},8,["checked"]),r(v,{checked:a(f).includeMetadata,"onUpdate:checked":e[12]||(e[12]=o=>a(f).includeMetadata=o)},{default:c(()=>[...e[26]||(e[26]=[x("包含元数据",-1)])]),_:1},8,["checked"])]),r(z,{"file-list":a(N),"onUpdate:fileList":e[13]||(e[13]=o=>J(N)?N.value=o:null),multiple:"","list-type":"image-card",accept:"image/*,video/*,audio/*",class:"mt-4"},{default:c(()=>[r(w,null,{icon:c(()=>[...e[27]||(e[27]=[i("div",{class:"i-mdi:upload"},null,-1)])]),default:c(()=>[e[28]||(e[28]=x(" 上传文件 ",-1))]),_:1})]),_:1},8,["file-list"]),i("div",De,[r(w,{type:"warning",loading:a(p).state.value.loading,disabled:!a(N).length,onClick:F},{icon:c(()=>[...e[29]||(e[29]=[i("div",{class:"i-mdi:image-multiple"},null,-1)])]),default:c(()=>[x(" 导出媒体包 ("+b(a(N).length)+") ",1)]),_:1},8,["loading","disabled"])])]),_:1}),r(d,{title:"🚀 模板库导出",class:"section"},{default:c(()=>[i("div",Fe,[r(l,{value:a(m).libraryName,"onUpdate:value":e[14]||(e[14]=o=>a(m).libraryName=o),placeholder:"模板库名称"},null,8,["value"]),r(g,{value:a(m).bundleMode,"onUpdate:value":e[15]||(e[15]=o=>a(m).bundleMode=o),options:a(me),placeholder:"打包模式"},null,8,["value","options"]),r(v,{checked:a(m).includeDocumentation,"onUpdate:checked":e[16]||(e[16]=o=>a(m).includeDocumentation=o)},{default:c(()=>[...e[30]||(e[30]=[x("包含文档",-1)])]),_:1},8,["checked"])]),i("div",Ue,[e[32]||(e[32]=i("div",{class:"selection-header"},"选择模板:",-1)),i("div",Be,[(M(!0),$(A,null,O(a(V),o=>(M(),$("div",{key:o.id,class:re(["template-card",{active:a(C).includes(o.id)}]),onClick:ze=>R(o.id)},[e[31]||(e[31]=i("div",{class:"i-mdi:code-braces text-xl text-blue-500"},null,-1)),i("div",null,[i("div",Ae,b(o.name),1),i("div",Oe,b(o.category),1)])],10,Je))),128))])]),i("div",Ve,[r(w,{type:"info",loading:a(p).state.value.loading,disabled:!a(C).length,onClick:U},{icon:c(()=>[...e[33]||(e[33]=[i("div",{class:"i-mdi:package-down"},null,-1)])]),default:c(()=>[x(" 导出模板库 ("+b(a(C).length)+") ",1)]),_:1},8,["loading","disabled"])])]),_:1}),r(H)])}}}),We=de(Te,[["__scopeId","data-v-66c91267"]]);export{We as default};
