import he from"./index-CmtMtyJe.js";import De from"./index-CFLWBDW1.js";import{H as Ie,K as Te,a0 as Ae,M as $e,X as Le,a4 as Se,a1 as Ve,a5 as Ue,at as Me,L as Pe,aD as Re,aQ as je,ah as Be,ad as Fe,V as Oe,W as qe,af as Ee,a2 as Ke,U as Ge,ap as He}from"./ui-vendor-Dblj447Y.js";import{k as Qe,r as x,e as ee,c as z,o as Xe,P as te,Q as m,R as t,U as Je,S as e,a2 as ae,J as l,j as d,_ as f,Z as y,X as g,H as b,F as We,M as Ze,n as Ye}from"./vue-vendor-DgJqRHrX.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconify-sN5qq56k.js";import"./index-D3z4ySpN.js";import"./robot-avatar-1-CBzFR956.js";const tt={name:[{required:!0,message:"请输入名称",trigger:["input","blur"]}],type:[{required:!0,message:"请选择类型",trigger:["change","blur"]}],typeCode:[{required:!0,message:"请输入字典类型编码",trigger:["input","blur"]}],dictLabel:[{required:!0,message:"请输入字典标签",trigger:["input","blur"]}],dictValue:[{required:!0,message:"请输入字典值",trigger:["input","blur"]}],sort:[{required:!0,type:"number",message:"请输入排序号",trigger:["input","blur"]}]},at=[{field:"status",values:{0:{text:"禁用",type:"error"},1:{text:"",type:"success"}}}],M={name:"",type:"type",parentId:null,code:"",value:"",sort:0,status:1,remark:"",typeCode:"",dictLabel:"",dictValue:""},lt=[{id:"user_status",name:"用户状态",type:"type",parentId:null,code:"user_status",typeCode:"user_status",sort:1,status:1,remark:"用户状态字典",children:[{id:"user_status_1",name:"正常",type:"item",parentId:"user_status",code:"normal",value:"1",dictLabel:"正常",dictValue:"1",sort:1,status:1,remark:"用户状态正常"},{id:"user_status_2",name:"禁用",type:"item",parentId:"user_status",code:"disabled",value:"0",dictLabel:"禁用",dictValue:"0",sort:2,status:0,remark:"用户状态禁用"}]},{id:"gender",name:"性别",type:"type",parentId:null,code:"gender",typeCode:"gender",sort:2,status:0,remark:"性别字典",children:[{id:"gender_1",name:"男",type:"item",parentId:"gender",code:"male",value:"1",dictLabel:"男",dictValue:"1",sort:1,status:1,remark:"男性"},{id:"gender_2",name:"女",type:"item",parentId:"gender",code:"female",value:"0",dictLabel:"女",dictValue:"0",sort:2,status:1,remark:"女性"}]}],st=async()=>new Promise(I=>{setTimeout(()=>{I({code:"0",data:lt,msg:"成功"})},500)}),nt=async I=>new Promise(_=>setTimeout(_,500)),ot=async I=>new Promise(_=>setTimeout(_,500)),ut=async I=>new Promise(_=>setTimeout(_,500)),it=async(I,_)=>new Promise(L=>setTimeout(L,300)),dt={class:"dictionary-management"},rt={class:"main-content"},ct=Qe({__name:"index",setup(I){const _=Ie(),L=x(!1),T=x(""),w=x(!1),A=x("add"),K=x(null),P=x(null),le=x([]),$=x([]),S=x(!1),N=ee([]),n=ee({...M}),se=tt,ne=z(()=>A.value==="add"?`新增${n.type==="type"?"字典类型":"字典项"}`:`编辑${n.type==="type"?"字典类型":"字典项"}`),oe=z(()=>at),ue=z(()=>({typeMap:{type:"mdi:folder-table",item:"mdi:tag"},colorMap:{type:"#1890ff",item:"#52c41a"}})),ie=z(()=>[{key:"add",text:"新增字典项",icon:"mdi:plus",type:"primary",show:s=>{const a=s;return a.type==="type"&&a.status===1}},{key:"edit",text:"编辑",icon:"mdi:pencil",type:"info"},{key:"toggle",text:"切换状态",icon:"mdi:toggle-switch",type:"warning"},{key:"delete",text:"删除",icon:"mdi:delete",type:"error",confirm:"确认删除该字典吗？"}]),o=z(()=>$.value.length?X(N,$.value[0]):null),R=z(()=>o.value?.children||[]),V=z(()=>{if(!o.value||o.value.type!=="type")return null;const s=R.value;return{total:s.length,enabled:s.filter(a=>a.status===1).length,disabled:s.filter(a=>a.status===0).length}}),de=z(()=>N.filter(s=>s.type==="type").map(s=>({label:s.name,value:s.id}))),re=z(()=>{if(!T.value.trim())return N;const s=a=>{const i=a.name.toLowerCase().includes(T.value.toLowerCase()),c=a.children?.map(s).filter(Boolean)||[];return i||c.length>0?{...a,children:c}:null};return N.map(s).filter(Boolean)}),G=s=>s==="type"?"字典类型":"字典项",H=s=>s==="type"?{icon:"mdi:folder-table",color:"info"}:{icon:"mdi:tag",color:"success"},Q=s=>s==="type"?"#1890ff":"#52c41a",X=(s,a)=>{for(const i of s){if(i.id===a)return i;if(i.children){const c=X(i.children,a);if(c)return c}}return null},j=(s,a,i)=>{for(let c=0;c<s.length;c++){if(s[c].id===a)return s[c].status=i,!0;if(s[c].children&&j(s[c].children,a,i))return!0}return!1},ce=(s,a)=>{$.value=a.map(i=>String(i))},pe=(s,a)=>{const i=a;switch(s){case"edit":F(i);break;case"delete":W(i.id);break;case"add":B(i.id);break;case"toggle":O(i);break}},me=s=>{const a=s;a?.type==="type"?B(a.id):J()},fe=()=>{S.value?(P.value?.collapseAll(),S.value=!1):(P.value?.expandAll(),S.value=!0)},_e=async()=>{await U(),_.success("刷新成功")},J=s=>{A.value="add",Object.assign(n,M),w.value=!0},B=s=>{A.value="add",Object.assign(n,M),n.type="item",s?n.parentId=s:o.value?.type==="type"&&(n.parentId=o.value.id),w.value=!0},F=s=>{A.value="edit",Object.assign(n,{id:s.id,name:s.name,type:s.type,parentId:s.parentId,code:s.code,value:s.value||"",sort:s.sort,status:s.status,remark:s.remark||"",typeCode:s.typeCode||"",dictLabel:s.dictLabel||"",dictValue:s.dictValue||""}),w.value=!0},W=async s=>{try{await ut(s),_.success("删除成功"),await U()}catch{_.error("删除失败")}},O=async s=>{const a=s.status===1?0:1,i=a===1?"启用":"禁用";try{await it(s.id,a),_.success(`${i}成功`),j(N,s.id,a),Ye(()=>{o.value?.id===s.id&&($.value=[...$.value])})}catch{_.error(`${i}失败`)}},ye=async()=>{try{return await K.value?.validate(),n.type==="type"?(n.code=n.typeCode,n.value=""):(n.code=n.dictLabel,n.value=n.dictValue),A.value==="add"?(await nt(n),_.success("添加成功"),await U()):(await ot(n),_.success("修改成功"),n.id&&j(N,n.id,n.status)),w.value=!1,!0}catch(s){return s instanceof Array||_.error("保存失败"),!1}},ge=()=>{w.value=!1,Object.assign(n,M)},U=async()=>{L.value=!0;try{const s=await st();N.length=0,N.push(...s.data)}catch{_.error("加载字典失败")}finally{L.value=!1}};return Xe(()=>{U()}),(s,a)=>{const i=he,c=Ae,k=$e,r=Te,h=Le,v=Se,p=Me,D=Pe,ve=Ve,q=Ue,be=Re,E=je,Z=qe,ke=Oe,C=Fe,Ce=Ee,xe=Ke,ze=Ge,we=Be,Ne=He;return m(),te("div",dt,[t(h,{class:"header-card"},{default:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(c,{value:l(T),"onUpdate:value":a[0]||(a[0]=u=>ae(T)?T.value=u:null),placeholder:"搜索字典名称",clearable:"",style:{width:"300px"}},{prefix:e(()=>[t(i,{name:"mdi:magnify",size:16})]),_:1},8,["value"]),t(r,null,{default:e(()=>[t(k,{type:"primary",onClick:a[1]||(a[1]=u=>J())},{icon:e(()=>[t(i,{name:"mdi:plus",size:16})]),default:e(()=>[a[14]||(a[14]=d(" 新增字典类型 ",-1))]),_:1}),t(k,{onClick:fe},{icon:e(()=>[t(i,{name:"mdi:file-tree",size:16})]),default:e(()=>[d(" "+f(l(S)?"收起全部":"展开全部"),1)]),_:1}),t(k,{onClick:_e},{icon:e(()=>[t(i,{name:"mdi:refresh",size:16})]),default:e(()=>[a[15]||(a[15]=d(" 刷新 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),Je("div",rt,[t(q,{cols:24,"x-gap":16,responsive:"screen"},{default:e(()=>[t(v,{span:8,md:12,sm:24},{default:e(()=>[t(h,{title:"数据字典",class:"content-card"},{default:e(()=>[t(De,{ref_key:"treeRef",ref:P,mode:"custom",data:l(re),"search-pattern":l(T),searchable:!1,"show-toolbar":!1,"status-configs":l(oe),"icon-config":l(ue),actions:l(ie),"default-expanded-keys":l(le),"default-selected-keys":l($),onNodeSelect:ce,onNodeAction:pe,onAdd:me,class:"dict-tree"},null,8,["data","search-pattern","status-configs","icon-config","actions","default-expanded-keys","default-selected-keys"])]),_:1})]),_:1}),t(v,{span:16,md:12,sm:24},{default:e(()=>[t(h,{class:"content-card"},{header:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{class:b({"disabled-text":l(o)&&l(o).status===0})},{default:e(()=>[d(f(l(o)?`${G(l(o).type)} - ${l(o).name}`:"选择字典查看详情"),1)]),_:1},8,["class"]),l(o)&&l(o).status===0?(m(),y(D,{key:0,type:"error",size:"small"},{icon:e(()=>[t(i,{name:"mdi:pause-circle",size:10})]),default:e(()=>[a[16]||(a[16]=d(" 已禁用 ",-1))]),_:1})):g("",!0)]),_:1}),t(r,null,{default:e(()=>[l(o)?(m(),y(k,{key:0,size:"small",onClick:a[2]||(a[2]=u=>F(l(o)))},{icon:e(()=>[t(i,{name:"mdi:pencil",size:14})]),default:e(()=>[a[17]||(a[17]=d(" 编辑 ",-1))]),_:1})):g("",!0),l(o)?(m(),y(k,{key:1,size:"small",type:l(o).status===1?"warning":"success",onClick:a[3]||(a[3]=u=>O(l(o)))},{icon:e(()=>[t(i,{name:l(o).status===1?"mdi:pause":"mdi:play",size:14},null,8,["name"])]),default:e(()=>[d(" "+f(l(o).status===1?"禁用":"启用"),1)]),_:1},8,["type"])):g("",!0)]),_:1})]),_:1})]),default:e(()=>[l(o)?(m(),y(r,{key:1,vertical:"",size:24},{default:e(()=>[t(h,{title:"基本信息",size:"small"},{default:e(()=>[t(q,{cols:2,"x-gap":16,"y-gap":12},{default:e(()=>[t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[18]||(a[18]=[d("名称：",-1)])]),_:1}),t(p,{class:b({"disabled-text":l(o).status===0})},{default:e(()=>[d(f(l(o).name),1)]),_:1},8,["class"])]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[19]||(a[19]=[d("类型：",-1)])]),_:1}),t(D,{type:H(l(o).type).color,size:"small",class:b({"disabled-tag":l(o).status===0})},{icon:e(()=>[t(i,{name:H(l(o).type).icon,size:12,color:l(o).status===0?"#d9d9d9":Q(l(o).type)},null,8,["name","color"])]),default:e(()=>[d(" "+f(G(l(o).type)),1)]),_:1},8,["type","class"])]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[20]||(a[20]=[d("编码：",-1)])]),_:1}),t(D,{type:"info",size:"small",class:b({"disabled-tag":l(o).status===0})},{default:e(()=>[d(f(l(o).code),1)]),_:1},8,["class"])]),_:1})]),_:1}),l(o).value?(m(),y(v,{key:0},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[21]||(a[21]=[d("字典值：",-1)])]),_:1}),t(D,{type:"success",size:"small",class:b({"disabled-tag":l(o).status===0})},{default:e(()=>[d(f(l(o).value),1)]),_:1},8,["class"])]),_:1})]),_:1})):g("",!0),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[22]||(a[22]=[d("排序：",-1)])]),_:1}),t(p,{class:b({"disabled-text":l(o).status===0})},{default:e(()=>[d(f(l(o).sort),1)]),_:1},8,["class"])]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[23]||(a[23]=[d("状态：",-1)])]),_:1}),t(D,{type:l(o).status===1?"success":"error",size:"small"},{icon:e(()=>[t(i,{name:l(o).status===1?"mdi:check-circle":"mdi:pause-circle",size:10},null,8,["name"])]),default:e(()=>[d(" "+f(l(o).status===1?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1}),l(o).type==="type"&&l(R).length>0?(m(),y(h,{key:0,size:"small"},{header:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(p,null,{default:e(()=>[...a[24]||(a[24]=[d("字典项",-1)])]),_:1}),l(o).status===1?(m(),y(k,{key:0,size:"small",type:"primary",onClick:B},{icon:e(()=>[t(i,{name:"mdi:plus",size:14})]),default:e(()=>[a[25]||(a[25]=d(" 添加字典项 ",-1))]),_:1})):g("",!0)]),_:1})]),default:e(()=>[t(r,{vertical:"",size:12},{default:e(()=>[(m(!0),te(We,null,Ze(l(R),u=>(m(),y(h,{key:u.id,size:"small",hoverable:"",class:b({"disabled-item":u.status===0})},{default:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(r,{vertical:"",size:6},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(i,{name:"mdi:tag",size:16,color:u.status===0?"#d9d9d9":Q("item")},null,8,["color"]),t(p,{strong:"",class:b({"disabled-text":u.status===0})},{default:e(()=>[d(f(u.name),1)]),_:2},1032,["class"]),t(D,{type:u.status===1?"success":"error",size:"tiny"},{icon:e(()=>[t(i,{name:u.status===1?"mdi:check-circle":"mdi:pause-circle",size:10},null,8,["name"])]),default:e(()=>[d(" "+f(u.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:2},1024),t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[26]||(a[26]=[d("值:",-1)])]),_:1}),t(D,{size:"small",type:"info",class:b({"disabled-tag":u.status===0})},{default:e(()=>[d(f(u.value),1)]),_:2},1032,["class"]),t(p,{depth:"3"},{default:e(()=>[...a[27]||(a[27]=[d("编码:",-1)])]),_:1}),t(D,{size:"small",type:"default",class:b({"disabled-tag":u.status===0})},{default:e(()=>[d(f(u.code),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),t(r,null,{default:e(()=>[t(k,{size:"tiny",onClick:Y=>F(u)},{icon:e(()=>[t(i,{name:"mdi:pencil",size:12,title:"编辑"})]),_:1},8,["onClick"]),t(k,{size:"tiny",type:u.status===1?"warning":"success",onClick:Y=>O(u)},{icon:e(()=>[t(i,{name:u.status===1?"mdi:pause":"mdi:play",size:12,title:u.status===1?"禁用":"启用"},null,8,["name","title"])]),_:2},1032,["type","onClick"]),t(be,{onPositiveClick:Y=>W(u.id)},{trigger:e(()=>[t(k,{size:"tiny",type:"error"},{icon:e(()=>[t(i,{name:"mdi:delete",size:12,title:"删除"})]),_:1})]),default:e(()=>[a[28]||(a[28]=d(" 确认删除该字典项吗？ ",-1))]),_:1},8,["onPositiveClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})):g("",!0),l(o).type==="type"&&l(V)?(m(),y(h,{key:1,title:"统计信息",size:"small"},{default:e(()=>[t(q,{cols:3,"x-gap":16},{default:e(()=>[t(v,null,{default:e(()=>[t(E,{label:"字典项总数"},{default:e(()=>[t(p,{style:{"font-size":"28px","font-weight":"bold",color:"#52c41a"}},{default:e(()=>[d(f(l(V).total),1)]),_:1})]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(E,{label:"启用"},{default:e(()=>[t(p,{style:{"font-size":"28px","font-weight":"bold",color:"#52c41a"}},{default:e(()=>[d(f(l(V).enabled),1)]),_:1})]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(E,{label:"禁用"},{default:e(()=>[t(p,{style:{"font-size":"28px","font-weight":"bold",color:"#ff4d4f"}},{default:e(()=>[d(f(l(V).disabled),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),l(o).remark?(m(),y(h,{key:2,title:"备注信息",size:"small"},{default:e(()=>[t(p,null,{default:e(()=>[d(f(l(o).remark),1)]),_:1})]),_:1})):g("",!0)]),_:1})):(m(),y(ve,{key:0,description:"请从左侧选择一个字典项查看详细信息",class:"mt-80px"},{icon:e(()=>[t(i,{name:"mdi:book-open-variant",size:72,class:"mt--80px"})]),_:1}))]),_:1})]),_:1})]),_:1})]),t(Ne,{show:l(w),"onUpdate:show":a[13]||(a[13]=u=>ae(w)?w.value=u:null),preset:"dialog",title:l(ne),"positive-text":l(A)==="add"?"确认添加":"确认修改","negative-text":"取消",onPositiveClick:ye,onNegativeClick:ge,style:{width:"600px"}},{default:e(()=>[t(we,{ref_key:"formRef",ref:K,model:l(n),rules:l(se),"label-placement":"left","label-width":"100px"},{default:e(()=>[t(C,{label:"类型",path:"type"},{default:e(()=>[t(ke,{value:l(n).type,"onUpdate:value":a[4]||(a[4]=u=>l(n).type=u)},{default:e(()=>[t(Z,{value:"type"},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(i,{name:"mdi:folder-table",size:16,color:"#1890ff",class:"vertical-middle"}),t(p,null,{default:e(()=>[...a[29]||(a[29]=[d("字典类型",-1)])]),_:1})]),_:1})]),_:1}),t(Z,{value:"item"},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(i,{name:"mdi:tag",size:16,color:"#52c41a",class:"vertical-middle"}),t(p,null,{default:e(()=>[...a[30]||(a[30]=[d("字典项",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),t(C,{label:"名称",path:"name"},{default:e(()=>[t(c,{value:l(n).name,"onUpdate:value":a[5]||(a[5]=u=>l(n).name=u),placeholder:"请输入名称"},null,8,["value"])]),_:1}),l(n).type==="item"?(m(),y(C,{key:0,label:"所属字典类型",path:"parentId"},{default:e(()=>[t(Ce,{value:l(n).parentId,"onUpdate:value":a[6]||(a[6]=u=>l(n).parentId=u),options:l(de),placeholder:"请选择字典类型",clearable:""},null,8,["value","options"])]),_:1})):g("",!0),l(n).type==="type"?(m(),y(C,{key:1,label:"类型编码",path:"typeCode"},{default:e(()=>[t(c,{value:l(n).typeCode,"onUpdate:value":a[7]||(a[7]=u=>l(n).typeCode=u),placeholder:"请输入类型编码，如：user_status"},null,8,["value"])]),_:1})):g("",!0),l(n).type==="item"?(m(),y(C,{key:2,label:"字典标签",path:"dictLabel"},{default:e(()=>[t(c,{value:l(n).dictLabel,"onUpdate:value":a[8]||(a[8]=u=>l(n).dictLabel=u),placeholder:"请输入字典标签"},null,8,["value"])]),_:1})):g("",!0),l(n).type==="item"?(m(),y(C,{key:3,label:"字典值",path:"dictValue"},{default:e(()=>[t(c,{value:l(n).dictValue,"onUpdate:value":a[9]||(a[9]=u=>l(n).dictValue=u),placeholder:"请输入字典值"},null,8,["value"])]),_:1})):g("",!0),t(C,{label:"排序号",path:"sort"},{default:e(()=>[t(xe,{value:l(n).sort,"onUpdate:value":a[10]||(a[10]=u=>l(n).sort=u),placeholder:"排序号",min:0,max:9999,style:{width:"100%"}},null,8,["value"])]),_:1}),t(C,{label:"状态",path:"status"},{default:e(()=>[t(ze,{value:l(n).status,"onUpdate:value":a[11]||(a[11]=u=>l(n).status=u),"checked-value":1,"unchecked-value":0},{checked:e(()=>[...a[31]||(a[31]=[d("启用",-1)])]),unchecked:e(()=>[...a[32]||(a[32]=[d("禁用",-1)])]),_:1},8,["value"])]),_:1}),t(C,{label:"备注",path:"remark"},{default:e(()=>[t(c,{value:l(n).remark,"onUpdate:value":a[12]||(a[12]=u=>l(n).remark=u),type:"textarea",placeholder:"请输入备注信息",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show","title","positive-text"])])}}}),kt=et(ct,[["__scopeId","data-v-401f92c5"]]);export{kt as default};
