import{D as K}from"./useDynamicFormState-DmIdlYeK.js";import{K as L,M as R,a2 as U,L as X,Z as Y,X as Z,a3 as H,a4 as J,a5 as O}from"./ui-vendor-Dblj447Y.js";import{k as P,i as Q,c as i,P as c,Q as r,X as q,U as o,J as n,R as a,S as t,j as u,_,F as W,M as h,Z as D,H as ee,a6 as ne}from"./vue-vendor-DgJqRHrX.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"c-form-dynamic"},ae={key:0,class:"dynamic-controls"},oe={class:"max-fields-config"},le={class:"dynamic-stats"},ie={key:1,class:"dynamic-controls-fallback"},de={class:"dynamic-form-items"},me=P({__name:"index",props:{formItems:{},layoutConfig:{default:()=>({})},options:{default:()=>[]},dynamicFormState:{default:null}},emits:["field-add","field-remove","fields-clear"],setup(F,{expose:I}){const m=F,$=Q(K,null),s=i(()=>m.dynamicFormState||$),f=i(()=>!!s.value),y=i(()=>m.layoutConfig?.dynamic?.grid?.cols??24),C=i(()=>m.layoutConfig?.dynamic?.grid?.gutter??16),N=i(()=>m.layoutConfig?.dynamic?.controls?.showControls!==!1),b=i(()=>s.value?.state.config.maxFields??m.layoutConfig?.dynamic?.dynamic?.maxFields??50),p=i(()=>s.value?.dynamicFieldsCount.value??0),z=i(()=>s.value?.canAddMoreFields.value??!1),A=i(()=>m.formItems.length),B=(d,e)=>d.key?.toString()||d.props?.path||`dynamic-item-${e}`,M=d=>{const e=m.options?.[d]?.layout?.span;return typeof e=="number"&&e>0&&e<=y.value?e:Math.min(12,y.value)},j=d=>{if(!s.value)return!1;const e=d.props?.path||d.key?.toString()||"";return s.value.state.dynamicFields.some(v=>v.prop===e)};return I({addField:()=>s.value?.addField(),removeField:()=>s.value?.removeField(),clearAllDynamic:()=>s.value?.clearDynamicFields(),isDynamicStateAvailable:f,dynamicState:s}),(d,e)=>{const v=Y,g=R,x=L,T=U,k=X,S=Z,V=H,E=J,G=O;return r(),c("div",se,[n(N)&&n(f)?(r(),c("div",ae,[a(S,{size:"small",title:"动态表单控制",bordered:!1},{"header-extra":t(()=>[a(v,{value:n(p),type:"warning"},{default:t(()=>[...e[4]||(e[4]=[o("div",{class:"i-mdi:layers text-16px"},null,-1)])]),_:1},8,["value"])]),default:t(()=>[a(x,{justify:"space-between",align:"center"},{default:t(()=>[a(x,null,{default:t(()=>[a(g,{size:"small",type:"primary",disabled:!n(z),onClick:e[0]||(e[0]=l=>n(s).addField())},{icon:t(()=>[...e[5]||(e[5]=[o("div",{class:"i-mdi:plus text-14px"},null,-1)])]),default:t(()=>[u(" 添加字段 ("+_(n(p))+"/"+_(n(b))+") ",1)]),_:1},8,["disabled"]),a(g,{size:"small",type:"warning",disabled:n(p)===0,onClick:e[1]||(e[1]=l=>n(s).removeField())},{icon:t(()=>[...e[6]||(e[6]=[o("div",{class:"i-mdi:minus text-14px"},null,-1)])]),default:t(()=>[e[7]||(e[7]=u(" 移除字段 ",-1))]),_:1},8,["disabled"]),a(g,{size:"small",type:"error",disabled:n(p)===0,onClick:e[2]||(e[2]=l=>n(s).clearDynamicFields())},{icon:t(()=>[...e[8]||(e[8]=[o("div",{class:"i-mdi:delete-sweep text-14px"},null,-1)])]),default:t(()=>[e[9]||(e[9]=u(" 清空动态 ",-1))]),_:1},8,["disabled"])]),_:1}),o("div",oe,[e[10]||(e[10]=o("span",null,"最大字段数:",-1)),a(T,{value:n(b),"onUpdate:value":e[3]||(e[3]=l=>l&&n(s).updateConfig({maxFields:l})),min:5,max:50,size:"small",style:{width:"100px"}},null,8,["value"])])]),_:1}),o("div",le,[a(x,null,{default:t(()=>[a(k,{type:"info"},{default:t(()=>[u("总字段: "+_(n(A)),1)]),_:1}),a(k,{type:"warning"},{default:t(()=>[u("动态: "+_(n(p)),1)]),_:1})]),_:1})])]),_:1})])):n(N)&&!n(f)?(r(),c("div",ie,[a(S,{size:"small",title:"动态表单控制 (静态模式)",bordered:!1},{default:t(()=>[a(V,{type:"info","show-icon":""},{icon:t(()=>[...e[11]||(e[11]=[o("div",{class:"i-mdi:information-outline text-16px"},null,-1)])]),default:t(()=>[e[12]||(e[12]=u(" 当前为静态模式，如需动态功能请在父组件中提供动态表单状态。 ",-1))]),_:1})]),_:1})])):q("",!0),o("div",de,[a(G,{cols:n(y),"x-gap":n(C),"y-gap":n(C)},{default:t(()=>[(r(!0),c(W,null,h(F.formItems,(l,w)=>(r(),D(E,{key:B(l,w),span:M(w)},{default:t(()=>[o("div",{class:ee(["dynamic-item-wrapper",{"is-dynamic-field":j(l)}])},[(r(),D(ne(l)))],2)]),_:2},1032,["span"]))),128))]),_:1},8,["cols","x-gap","y-gap"])])])}}}),_e=te(me,[["__scopeId","data-v-a091ca6c"]]);export{_e as default};
