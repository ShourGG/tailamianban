import{a as q,k as E,d as O,s as S}from"./terraria-QXqyvlub.js";import{ab as V,aA as A,ak as D,K as g,M as r,$ as H,X as x,Y as f,T as v,ac as C,L as J}from"./ui-vendor-qucRfopV.js";import{k as L,r as i,o as Q,E as X,O as Y,P as M,Q as l,R as n,J as a,Z as P,j as d,m as k}from"./vue-vendor-DIhTWhib.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./auth-IWVIEBlm.js";import"./index-ClRVJH89.js";import"./spline-vendor-BYERog9l.js";import"./charts-vendor-XI8Sg87J.js";import"./editor-vendor-CUlQiixb.js";const F={class:"terraria-players"},G=L({__name:"index",setup(W){const u=i(!1),$=i([]),m=i(!1),p=i(!1),w=i(!1),s=i(null),b=i(""),y=i(""),_=i(""),h=i(null),c=async()=>{try{const t=await q();$.value=t||[]}catch{window.$message?.error("加载玩家列表失败")}},z=t=>{s.value=t,b.value="",m.value=!0},B=async()=>{if(s.value){u.value=!0;try{await E(s.value.id,b.value),window.$message?.success(`已踢出玩家: ${s.value.name}`),m.value=!1,c()}catch{window.$message?.error("踢出玩家失败")}finally{u.value=!1}}},U=t=>{s.value=t,y.value="",p.value=!0},I=async()=>{if(!s.value||!y.value){window.$message?.warning("请输入封禁原因");return}u.value=!0;try{await O(s.value.id,y.value),window.$message?.success(`已封禁玩家: ${s.value.name}`),p.value=!1,c()}catch{window.$message?.error("封禁玩家失败")}finally{u.value=!1}},j=t=>{s.value=t,_.value="",w.value=!0},T=async()=>{if(!s.value||!_.value){window.$message?.warning("请输入消息内容");return}u.value=!0;try{await S(s.value.id,_.value),window.$message?.success("消息已发送"),w.value=!1}catch{window.$message?.error("发送消息失败")}finally{u.value=!1}},K=t=>({0:"default",1:"error",2:"success",3:"info",4:"warning"})[t]||"default",N=t=>({0:"无队伍",1:"红队",2:"绿队",3:"蓝队",4:"黄队"})[t]||"未知",R=[{title:"ID",key:"id",width:80},{title:"玩家名称",key:"name",width:150},{title:"IP地址",key:"ip",width:150},{title:"加入时间",key:"joinTime",width:180},{title:"队伍",key:"team",width:100,render:t=>k(J,{type:K(t.team),size:"small"},{default:()=>N(t.team)})},{title:"生命值",key:"health",width:100,render:t=>`${t.health}/${t.maxHealth||400}`},{title:"魔力值",key:"mana",width:100,render:t=>`${t.mana}/${t.maxMana||200}`},{title:"操作",key:"actions",width:220,render:t=>k(g,{size:"small"},{default:()=>[k(r,{size:"small",type:"info",onClick:()=>j(t)},{default:()=>"发消息"}),k(r,{size:"small",type:"warning",onClick:()=>z(t)},{default:()=>"踢出"}),k(r,{size:"small",type:"error",onClick:()=>U(t)},{default:()=>"封禁"})]})}];return Q(()=>{c(),h.value=window.setInterval(c,5e3)}),X(()=>{h.value&&clearInterval(h.value)}),(t,e)=>(M(),Y("div",F,[l(a(H),{title:"在线玩家管理",bordered:!1},{"header-extra":n(()=>[l(a(g),null,{default:n(()=>[l(a(r),{size:"small",onClick:c},{default:n(()=>[...e[9]||(e[9]=[d("刷新",-1)])]),_:1})]),_:1})]),default:n(()=>[l(a(V),{show:u.value},{default:n(()=>[$.value.length>0?(M(),P(a(A),{key:0,columns:R,data:$.value,pagination:!1,bordered:!1,size:"small"},null,8,["data"])):(M(),P(a(D),{key:1,description:"当前无在线玩家"}))]),_:1},8,["show"])]),_:1}),l(a(C),{show:m.value,"onUpdate:show":e[2]||(e[2]=o=>m.value=o),preset:"card",title:"踢出玩家",style:{width:"500px"},bordered:!1},{footer:n(()=>[l(a(g),{justify:"end"},{default:n(()=>[l(a(r),{onClick:e[1]||(e[1]=o=>m.value=!1)},{default:n(()=>[...e[10]||(e[10]=[d("取消",-1)])]),_:1}),l(a(r),{type:"warning",loading:u.value,onClick:B},{default:n(()=>[...e[11]||(e[11]=[d(" 确认踢出 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:n(()=>[l(a(x),{"label-placement":"left","label-width":"100"},{default:n(()=>[l(a(f),{label:"玩家名称"},{default:n(()=>[l(a(v),{value:s.value?.name,disabled:""},null,8,["value"])]),_:1}),l(a(f),{label:"踢出原因"},{default:n(()=>[l(a(v),{value:b.value,"onUpdate:value":e[0]||(e[0]=o=>b.value=o),type:"textarea",placeholder:"请输入踢出原因（可选）",rows:3},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"]),l(a(C),{show:p.value,"onUpdate:show":e[5]||(e[5]=o=>p.value=o),preset:"card",title:"封禁玩家",style:{width:"500px"},bordered:!1},{footer:n(()=>[l(a(g),{justify:"end"},{default:n(()=>[l(a(r),{onClick:e[4]||(e[4]=o=>p.value=!1)},{default:n(()=>[...e[12]||(e[12]=[d("取消",-1)])]),_:1}),l(a(r),{type:"error",loading:u.value,onClick:I},{default:n(()=>[...e[13]||(e[13]=[d(" 确认封禁 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:n(()=>[l(a(x),{"label-placement":"left","label-width":"100"},{default:n(()=>[l(a(f),{label:"玩家名称"},{default:n(()=>[l(a(v),{value:s.value?.name,disabled:""},null,8,["value"])]),_:1}),l(a(f),{label:"封禁原因",required:""},{default:n(()=>[l(a(v),{value:y.value,"onUpdate:value":e[3]||(e[3]=o=>y.value=o),type:"textarea",placeholder:"请输入封禁原因（必填）",rows:3},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"]),l(a(C),{show:w.value,"onUpdate:show":e[8]||(e[8]=o=>w.value=o),preset:"card",title:"发送消息",style:{width:"500px"},bordered:!1},{footer:n(()=>[l(a(g),{justify:"end"},{default:n(()=>[l(a(r),{onClick:e[7]||(e[7]=o=>w.value=!1)},{default:n(()=>[...e[14]||(e[14]=[d("取消",-1)])]),_:1}),l(a(r),{type:"primary",loading:u.value,onClick:T},{default:n(()=>[...e[15]||(e[15]=[d(" 发送 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:n(()=>[l(a(x),{"label-placement":"left","label-width":"100"},{default:n(()=>[l(a(f),{label:"接收玩家"},{default:n(()=>[l(a(v),{value:s.value?.name,disabled:""},null,8,["value"])]),_:1}),l(a(f),{label:"消息内容",required:""},{default:n(()=>[l(a(v),{value:_.value,"onUpdate:value":e[6]||(e[6]=o=>_.value=o),type:"textarea",placeholder:"请输入要发送的消息",rows:4},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["show"])]))}}),ie=Z(G,[["__scopeId","data-v-6933e8bc"]]);export{ie as default};
