import{n as c}from"./index-DbUecRfU.js";import{u as f}from"./index-DLz9CAvw.js";import{r as d}from"./vue-vendor-DgJqRHrX.js";const h=()=>{const n=d(!1),o=()=>{c.error({content:"表单实例未准备好",duration:3e3})},u=async r=>await r.form.validate(),l=(r,e)=>{if(r.code===(e.successCode||"0")){e.onSuccess?.(r);const s=e.successMsg||"提交成功";let a;return e.meta&&(a=typeof e.meta=="function"?e.meta(r):e.meta),c.success({content:s,meta:a,duration:3e3}),!0}return!1},m=(r,e)=>{e.globalErrorHandler&&e.globalErrorHandler(r),c.error({content:r instanceof Error?r.message:"提交失败",duration:3e3})};return{loading:n,createSubmit:(r,e={})=>{const s=e.debounce!==!1?f(r,e.debounce||500):r;return async a=>{if(!a.form){o();return}try{await u(a),n.value=!0;const t=await s(a.model);if(l(t,e))return t;throw new Error(t.message||e.errorMsg||"操作失败")}catch(t){throw m(t,e),t}finally{n.value=!1}}}}};export{h as u};
