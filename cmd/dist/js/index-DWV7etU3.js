import{i as L,a as P,b as j,F as O}from"./calendar-vendor-DybU7NOu.js";import{H as q,M as J,ap as Q,a0 as X,aq as Z}from"./ui-vendor-Dblj447Y.js";import{k as K,r as u,w as M,P as S,Q as T,R as v,Z as Y,X as ee,J as a,S as b,U as d,j as $,a2 as A,F as te,M as ne,L as ae}from"./vue-vendor-DgJqRHrX.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";var ie={code:"zh-cn",week:{dow:1,doy:4},buttonText:{prev:"上月",next:"下月",today:"今天",year:"年",month:"月",week:"周",day:"日",list:"日程"},weekText:"周",allDayText:"全天",moreLinkText(y){return"另外 "+y+" 个"},noEventsText:"没有事件显示"};const de={class:"c-full-calendar"},oe={class:"ml-10% mt-20px"},se={style:{padding:"20px"}},re={style:{"margin-bottom":"16px"}},ue={style:{"margin-bottom":"16px"}},ve={style:{display:"grid","grid-template-columns":"1fr 1fr",gap:"16px"}},pe={style:{"margin-top":"16px"}},me={style:{display:"flex",gap:"8px"}},ce=["onClick"],fe=K({__name:"index",props:{events:{type:Array,default:()=>[]},initialView:{type:String,default:"dayGridMonth",validator:y=>["dayGridMonth","dayGridWeek","dayGridDay","listWeek"].includes(y)},editable:{type:Boolean,default:!0},showAddDialog:{type:Boolean,default:!0},showEditDialog:{type:Boolean,default:!0}},emits:["update:events","event-added","event-updated","event-deleted","event-dropped"],setup(y,{expose:B,emit:N}){const s=y,r=N,h=u(),c=q(),o=u([...s.events]),p=u(!1),f=u(!1),g=u(!1),m=u(null),n=u({id:"",title:"",date:Date.now(),startTime:"09:00",endTime:"10:00",color:"#3f86ff"}),k=["#3f86ff","#ff6b6b","#67c23a","#e6a23c","#9c27b0","#00bcd4","#ff5722"],D=u({plugins:[L,P,j],locale:ie,initialView:s.initialView,events:o,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,dayGridWeek,dayGridDay,listWeek"},buttonText:{today:"今天",month:"月",week:"周",day:"日",list:"列表"},editable:s.editable,eventClick:G,dateClick:R,eventDrop:U,eventResize:V});function G(e){s.editable&&(e.jsEvent.preventDefault(),m.value=e.event,s.showEditDialog&&(p.value=!0))}function R(e){if(!s.editable||!s.showAddDialog)return;const t=new Date(e.dateStr);z(t)}function U(e){x({id:e.event.id,start:e.event.start,end:e.event.end}),r("event-dropped",{id:e.event.id,start:e.event.start,end:e.event.end}),c.success(`事件 "${e.event.title}" 时间已更新`)}function V(e){x({id:e.event.id,start:e.event.start,end:e.event.end}),r("event-updated",{id:e.event.id,start:e.event.start,end:e.event.end})}function z(e){g.value=!1,n.value={id:"",title:"",date:e.getTime(),startTime:"09:00",endTime:"10:00",color:k[Math.floor(Math.random()*k.length)]},f.value=!0}function F(){if(!m.value)return;g.value=!0;const e=m.value,t=new Date(e.start),i=e.end?new Date(e.end):new Date(e.start.getTime()+36e5);n.value={id:e.id,title:e.title,date:t.getTime(),startTime:`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`,endTime:`${String(i.getHours()).padStart(2,"0")}:${String(i.getMinutes()).padStart(2,"0")}`,color:e.backgroundColor||"#3f86ff"},p.value=!1,f.value=!0}function I(){if(!n.value.title.trim())return c.error("请输入事件标题"),!1;if(n.value.startTime>=n.value.endTime)return c.error("结束时间必须晚于开始时间"),!1;const t=new Date(n.value.date).toISOString().split("T")[0],i={id:g.value?n.value.id:Date.now().toString(),title:n.value.title,start:new Date(`${t}T${n.value.startTime}:00`),end:new Date(`${t}T${n.value.endTime}:00`),color:n.value.color};return g.value?(x(i),r("event-updated",i),c.success("事件已更新")):(E(i),r("event-added",i),c.success("事件已添加")),f.value=!1,!0}function W(){if(!m.value)return;const e=m.value.id,t=m.value.title;C(e),r("event-deleted",{id:e,title:t}),p.value=!1,c.success(`已删除事件: ${t}`)}function E(e){o.value=[...o.value,e],r("update:events",o.value)}function x(e){const t=o.value.findIndex(i=>i.id===e.id);t!==-1&&(o.value=o.value.map((i,w)=>w===t?{...i,...e}:i),r("update:events",o.value))}function C(e){o.value=o.value.filter(t=>t.id!==e),r("update:events",o.value)}return M(()=>s.events,e=>{o.value=[...e]},{deep:!0}),M(o,e=>{D.value.events=e},{deep:!0}),B({getApi:()=>h.value?.getApi(),addEvent:E,updateEvent:x,deleteEvent:C,getEvents:()=>o.value}),(e,t)=>{const i=J,w=Q,_=X,H=Z;return T(),S("div",de,[v(a(O),{ref_key:"calendarRef",ref:h,options:a(D)},null,8,["options"]),a(p)?(T(),Y(w,{key:0,show:a(p),"onUpdate:show":t[0]||(t[0]=l=>A(p)?p.value=l:null),preset:"dialog",title:`事件操作 - ${a(m)?.title}`,style:{width:"400px"}},{default:b(()=>[d("div",oe,[v(i,{type:"primary",onClick:F,style:{"margin-right":"12px"},size:"small"},{default:b(()=>[...t[6]||(t[6]=[$(" 编辑 ",-1)])]),_:1}),v(i,{type:"error",onClick:W,size:"small"},{default:b(()=>[...t[7]||(t[7]=[$(" 删除 ",-1)])]),_:1})])]),_:1},8,["show","title"])):ee("",!0),v(w,{show:a(f),"onUpdate:show":t[5]||(t[5]=l=>A(f)?f.value=l:null),preset:"dialog",title:a(g)?"编辑事件":"添加事件","positive-text":"保存","negative-text":"取消",onPositiveClick:I},{default:b(()=>[d("div",se,[d("div",re,[t[8]||(t[8]=d("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"事件标题",-1)),v(_,{value:a(n).title,"onUpdate:value":t[1]||(t[1]=l=>a(n).title=l),placeholder:"请输入事件标题"},null,8,["value"])]),d("div",ue,[t[9]||(t[9]=d("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"事件日期",-1)),v(H,{value:a(n).date,"onUpdate:value":t[2]||(t[2]=l=>a(n).date=l),type:"date",format:"yyyy-MM-dd",style:{width:"100%"}},null,8,["value"])]),d("div",ve,[d("div",null,[t[10]||(t[10]=d("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"开始时间",-1)),v(_,{value:a(n).startTime,"onUpdate:value":t[3]||(t[3]=l=>a(n).startTime=l),type:"time",placeholder:"09:00"},null,8,["value"])]),d("div",null,[t[11]||(t[11]=d("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"结束时间",-1)),v(_,{value:a(n).endTime,"onUpdate:value":t[4]||(t[4]=l=>a(n).endTime=l),type:"time",placeholder:"10:00"},null,8,["value"])])]),d("div",pe,[t[12]||(t[12]=d("label",{style:{display:"block","margin-bottom":"8px","font-weight":"500"}},"事件颜色",-1)),d("div",me,[(T(),S(te,null,ne(k,l=>d("div",{key:l,style:ae({width:"30px",height:"30px",backgroundColor:l,borderRadius:"50%",cursor:"pointer",border:a(n).color===l?"3px solid #000":"2px solid #ddd"}),onClick:ye=>a(n).color=l},null,12,ce)),64))])])])]),_:1},8,["show","title"])])}}}),ke=le(fe,[["__scopeId","data-v-8b4ad03c"]]);export{ke as default};
