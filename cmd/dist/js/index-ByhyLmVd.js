import{k as xt,r as _,e as B,c as j,o as Tt,P as E,Q as g,R as s,U as Ut,S as n,ah as It,J as a,j as k,_ as C,m as h,a2 as ae,Z as U,X as F,H as D,F as ne,M as se,a6 as Ie,s as Ne}from"./vue-vendor-DgJqRHrX.js";import Nt from"./index-CFLWBDW1.js";import b from"./index-CmtMtyJe.js";import{H as Ct,I as Pt,K as Ce,a0 as A,af as ie,M as de,X as zt,a4 as Rt,aA as St,at as Dt,L as V,a5 as At,ac as Lt,ax as Ot,ab as Et,ah as Ft,a$ as Mt,U as $t,ad as Bt,ap as jt,aD as Vt,aa as Kt}from"./ui-vendor-Dblj447Y.js";import{_ as Gt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconify-sN5qq56k.js";import"./index-D3z4ySpN.js";import"./robot-avatar-1-CBzFR956.js";const ce={userType:[{label:"内部员工",value:"internal"},{label:"外部客户",value:"external"},{label:"合作伙伴",value:"partner"},{label:"访客",value:"guest"}],userStatus:[{label:"正常",value:1},{label:"禁用",value:0}],pagination:{defaultPage:1,defaultPageSize:20,pageSizes:[10,20,50,100]}},L=(v,r,i=["input","blur"],y=[])=>[...v?[{required:!0,message:r,trigger:i}]:[{required:!1}],...y],Wt={username:L(!0,"请输入用户名",["input","blur"],[{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:["input","blur"]}]),nickname:L(!0,"请输入昵称"),userType:L(!0,"请选择用户类型",["change","blur"]),email:L(!1,"",["input","blur"],[{type:"email",message:"请输入正确的邮箱格式",trigger:["input","blur"]}]),phone:L(!1,"",["input","blur"],[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:["input","blur"]}]),password:L(!0,"请输入密码",["input","blur"],[{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:["input","blur"]}])},qt={newPassword:L(!0,"请输入新密码",["input","blur"],[{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:["input","blur"]}]),confirmPassword:L(!0,"请再次输入新密码",["input","blur"],[{validator:(v,r)=>{const i=v.form;return r!==i.newPassword?Promise.reject("两次密码输入不一致"):Promise.resolve()},trigger:["input","blur"]}])},ue={username:"",nickname:"",email:"",phone:"",userType:"internal",deptId:null,roleIds:[],password:"123456",status:1,remark:"",companyName:"",contactPerson:""},Pe={newPassword:"",confirmPassword:""},ze=[{id:"dept_1",name:"总公司",parentId:null,sort:1,status:1,type:"dept",children:[{id:"dept_2",name:"技术部",parentId:"dept_1",sort:1,status:1,type:"dept",children:[{id:"dept_3",name:"前端组",parentId:"dept_2",sort:1,status:1,type:"dept"},{id:"dept_4",name:"后端组",parentId:"dept_2",sort:2,status:1,type:"dept"}]},{id:"dept_5",name:"市场部",parentId:"dept_1",sort:2,status:1,type:"dept"},{id:"dept_6",name:"人事部",parentId:"dept_1",sort:3,status:1,type:"dept"}]},{id:"dept_external",name:"外部客户",parentId:null,sort:2,status:1,type:"external"}],Re=[{id:"role_1",name:"超级管理员",code:"admin",status:1},{id:"role_2",name:"部门经理",code:"manager",status:1},{id:"role_3",name:"普通员工",code:"user",status:1},{id:"role_4",name:"客户",code:"customer",status:1},{id:"role_5",name:"访客",code:"guest",status:1}],w=[{id:"user_1",username:"admin",nickname:"超级管理员",email:"admin@example.com",phone:"13800138001",userType:"internal",deptId:"dept_1",deptName:"总公司",roleIds:["role_1"],roleNames:["超级管理员"],status:1,avatar:"",remark:"系统超级管理员",createTime:"2024-01-01 09:00:00",updateTime:"2024-01-15 14:30:00",lastLoginTime:"2024-01-15 09:15:00"},{id:"user_2",username:"zhangsan",nickname:"张三",email:"zhangsan@example.com",phone:"13800138002",userType:"internal",deptId:"dept_3",deptName:"前端组",roleIds:["role_3"],roleNames:["普通员工"],status:1,remark:"前端开发工程师",createTime:"2024-01-02 09:00:00",updateTime:"2024-01-10 16:20:00",lastLoginTime:"2024-01-15 08:45:00"},{id:"user_3",username:"lisi",nickname:"李四",email:"lisi@example.com",phone:"13800138003",userType:"internal",deptId:"dept_4",deptName:"后端组",roleIds:["role_2","role_3"],roleNames:["部门经理","普通员工"],status:0,remark:"后端开发工程师",createTime:"2024-01-03 09:00:00",updateTime:"2024-01-12 11:10:00",lastLoginTime:"2024-01-14 17:30:00"},{id:"user_4",username:"wangwu",nickname:"王五",email:"wangwu@example.com",phone:"13800138004",userType:"internal",deptId:"dept_5",deptName:"市场部",roleIds:["role_3"],roleNames:["普通员工"],status:1,remark:"市场专员",createTime:"2024-01-04 09:00:00",updateTime:"2024-01-08 13:45:00",lastLoginTime:"2024-01-13 10:20:00"},{id:"user_5",username:"customer001",nickname:"ABC公司",email:"contact@abc.com",phone:"13800138005",userType:"external",deptId:"dept_external",deptName:"外部客户",roleIds:["role_4"],roleNames:["客户"],status:1,remark:"ABC科技有限公司",companyName:"ABC科技有限公司",contactPerson:"刘总",createTime:"2024-01-05 09:00:00",updateTime:"2024-01-12 15:20:00",lastLoginTime:"2024-01-14 10:30:00"}],pe=(v,r=500)=>new Promise(i=>{setTimeout(()=>{i({code:"0",data:v,msg:"成功"})},r)}),Ht=(v,r)=>{let i=[...v];if(r.keyword){const y=r.keyword.toLowerCase();i=i.filter(x=>x.username.toLowerCase().includes(y)||x.nickname.toLowerCase().includes(y)||x.email&&x.email.toLowerCase().includes(y))}return r.status!==null&&r.status!==void 0&&(i=i.filter(y=>y.status===r.status)),r.userType&&(i=i.filter(y=>y.userType===r.userType)),r.deptId&&(i=i.filter(y=>y.deptId===r.deptId)),r.roleId&&(i=i.filter(y=>y.roleIds&&y.roleIds.includes(r.roleId))),i},Jt=(v,r,i)=>{const y=v.length,x=(r-1)*i,P=x+i;return{list:v.slice(x,P),total:y,page:r,pageSize:i}},Qt=async v=>{const r=Ht(w,v),i=Jt(r,v.page,v.pageSize);return pe(i)},Xt=async()=>pe(ze,300),Zt=async()=>pe(Re,300),Yt={class:"user-management"},ea={class:"main-content"},ta={key:0,class:"user-detail"},aa={key:0,class:"disabled-overlay"},na=xt({__name:"index",setup(v){const r={icons:{search:"mdi:magnify",plus:"mdi:plus",refresh:"mdi:refresh",tree:"mdi:file-tree",toggle:"mdi:toggle-switch",delete:"mdi:delete",edit:"mdi:pencil",eye:"mdi:eye",pause:"mdi:pause",play:"mdi:play",key:"mdi:key",cancel:"mdi:cancel",role:"mdi:account-key",check:"mdi:check-circle",info:"mdi:information"},statusConfig:{1:{text:"正常",type:"success",icon:"mdi:check-circle"},0:{text:"禁用",type:"error",icon:"mdi:pause-circle"}},userTypeConfig:{internal:{text:"内部",type:"info",icon:"mdi:account"},external:{text:"外部",type:"warning",icon:"mdi:account-group"},partner:{text:"伙伴",type:"success",icon:"mdi:handshake"},guest:{text:"访客",type:"default",icon:"mdi:account-outline"}},defaultAvatar:"https://07akioni.oss-cn-beijing.aliyuncs.com/07akioni.jpeg",batchConfig:{delete:{title:"批量删除",content:"确认删除选中的用户吗？此操作不可恢复！",type:"error"},toggle:{title:"批量状态操作",content:"确认对选中的用户进行状态切换吗？",type:"warning"}}},i=Ct(),y=Pt(),x=_(!1),P=_(!1),M=_(!1),K=_(!1),z=_("add"),me=_(null),fe=_(null),Se=_(),le=_(null),De=_([]),J=_([]),I=_([]),Q=_(!1),p=_(null),Ae=_(""),X=B([]),G=B([]),Z=_([]),f=B({...ue}),Le=Wt,$=B({...Pe}),Oe=qt,N=B({keyword:"",status:null,roleId:null,deptId:null,userType:null}),R=B({page:1,pageSize:20,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100],showQuickJumper:!0}),Ee=j(()=>z.value==="add"?"新增用户":"编辑用户"),W=j(()=>J.value.length?ge(G,J.value[0]):null),Fe=j(()=>({typeMap:{dept:"mdi:office-building",external:"mdi:account-group"},colorMap:{dept:"#1890ff",external:"#52c41a"}})),Me=j(()=>f.userType==="external"?Z.value.filter(e=>["role_4","role_5"].includes(e.value)):Z.value),$e=j(()=>_e(G)),Be=j(()=>({...R,onChange:e=>ke(e),onUpdatePageSize:e=>be(e)})),je=e=>Re.find(t=>t.id===e)?.name||"",Ve=e=>{const t=(d,m)=>{for(const l of d){if(l.id===m)return l.name;if(l.children){const c=t(l.children,m);if(c)return c}}return null};return t(ze,e)||"未知部门"},ye=(e,t)=>{[{data:w,key:"id"},{data:X,key:"id"}].forEach(({data:m,key:l})=>{const c=m.findIndex(u=>u[l]===e);c!==-1&&(m[c]={...m[c],...t})}),p.value?.id===e&&(p.value={...p.value,...t})},oe=e=>r.statusConfig[e]||r.statusConfig[1],re=e=>r.userTypeConfig[e]||r.userTypeConfig.internal,Ke=e=>e.status===0?"disabled-row":"",ge=(e,t)=>{for(const d of e){if(d.id===t)return d;if(d.children){const m=ge(d.children,t);if(m)return m}}return null},_e=e=>e.map(t=>({id:t.id,name:t.name,children:t.children?_e(t.children):void 0})),he=(e,t)=>d=>h(V,{type:e(d[t]).type,size:"small",class:{"disabled-tag":d.status===0}},{icon:()=>h(b,{name:e(d[t]).icon,size:10}),default:()=>e(d[t]).text}),Y=(e,t="-")=>d=>h("div",{class:{"disabled-text":d.status===0}},d[e]||t),Ge=e=>h("div",{class:["username-cell",{"disabled-user":e.status===0}],style:e.status===0?{textDecoration:"line-through",color:"#999",backgroundColor:"#f5f5f5",padding:"2px 6px",borderRadius:"4px",display:"inline-block",border:"1px solid #e0e0e0"}:void 0},e.username),We=e=>!e.roleNames||e.roleNames.length===0?h("div","-"):h(Ce,{size:4},{default:()=>e.roleNames.map(t=>h(V,{key:t,size:"small",type:"info",class:{"disabled-tag":e.status===0}},{default:()=>t}))}),qe=e=>{const t=[{icon:r.icons.eye,text:"详情",type:"info",onClick:()=>ut(e)},{icon:r.icons.edit,text:"编辑",onClick:()=>ct(e)},{icon:e.status===1?r.icons.pause:r.icons.play,text:e.status===1?"禁用":"启用",type:e.status===1?"warning":"success",onClick:()=>pt(e)},{icon:r.icons.key,text:"重置",type:"warning",onClick:()=>ft(e),disabled:e.status===0}];return h("div",{style:{display:"flex",gap:"4px",flexWrap:"nowrap"}},[...t.map(d=>h(de,{size:"tiny",type:d.type,disabled:d.disabled,onClick:d.onClick},{icon:()=>h(b,{name:d.icon,size:12}),default:()=>d.text})),h(Vt,{onPositiveClick:()=>mt(e.id)},{trigger:()=>h(de,{size:"tiny",type:"error"},{icon:()=>h(b,{name:r.icons.delete,size:12}),default:()=>"删除"}),default:()=>"确认删除该用户吗？"})])},He=[{type:"selection"},{title:"用户类型",key:"userType",width:100,render:he(re,"userType")},{title:"用户名",key:"username",width:120,fixed:"left",render:Ge},{title:"昵称",key:"nickname",width:120,render:Y("nickname")},{title:"邮箱",key:"email",width:180,render:Y("email")},{title:"手机号",key:"phone",width:120,render:Y("phone")},{title:"部门/公司",key:"deptName",width:120,render:e=>h("div",{class:{"disabled-text":e.status===0}},e.userType==="external"?e.companyName||"-":e.deptName||"-")},{title:"角色",key:"roleNames",width:150,render:We},{title:"状态",key:"status",width:80,render:he(oe,"status")},{title:"创建时间",key:"createTime",width:160,render:Y("createTime")},{title:"操作",key:"actions",width:250,fixed:"right",render:qe}],Je=e=>[{key:"username",label:"用户名",value:e.username,component:"div",props:{class:{"disabled-text":e.status===0}}},{key:"nickname",label:"昵称",value:e.nickname,component:"div",props:{class:{"disabled-text":e.status===0}}},{key:"userType",label:"用户类型",value:re(e.userType).text,component:V,props:{type:re(e.userType).type,size:"small",class:{"disabled-tag":e.status===0}}},{key:"email",label:"邮箱",value:e.email||"-",component:"div",props:{class:{"disabled-text":e.status===0}}},{key:"phone",label:"手机号",value:e.phone||"-",component:"div",props:{class:{"disabled-text":e.status===0}}},{key:"deptName",label:"所属部门",value:e.deptName||"-",component:V,props:{type:"info",size:"small",class:{"disabled-tag":e.status===0}}},...e.userType==="external"?[{key:"companyName",label:"公司名称",value:e.companyName||"-",component:"div",props:{class:{"disabled-text":e.status===0}}},{key:"contactPerson",label:"联系人",value:e.contactPerson||"-",component:"div",props:{class:{"disabled-text":e.status===0}}}]:[],{key:"status",label:"用户状态",value:oe(e.status).text,component:V,props:{type:oe(e.status).type,size:"small"}}],Qe=e=>[{key:"createTime",label:"创建时间",value:e.createTime},...e.updateTime?[{key:"updateTime",label:"更新时间",value:e.updateTime}]:[],...e.lastLoginTime?[{key:"lastLoginTime",label:"最后登录",value:e.lastLoginTime}]:[]],Xe=()=>[{key:"userType",label:"用户类型",path:"userType",component:ie,props:{options:ce.userType,placeholder:"请选择用户类型",onUpdateValue:it},condition:!0},{key:"username",label:"用户名",path:"username",component:A,props:{placeholder:"请输入用户名",disabled:z.value==="edit",...z.value==="edit"&&{suffix:()=>h(Kt,{},{trigger:()=>h(b,{name:r.icons.info,size:16}),default:()=>"用户名作为登录凭证，创建后不可修改"})}},condition:!0},{key:"nickname",label:"昵称",path:"nickname",component:A,props:{placeholder:"请输入昵称"},condition:!0},{key:"email",label:"邮箱",path:"email",component:A,props:{placeholder:"请输入邮箱"},condition:!0},{key:"phone",label:"手机号",path:"phone",component:A,props:{placeholder:"请输入手机号"},condition:!0},{key:"deptId",label:"所属部门",path:"deptId",component:Mt,props:{options:$e.value,placeholder:"请选择部门",clearable:!0,checkStrategy:"child",keyField:"id",labelField:"name",childrenField:"children"},condition:f.userType==="internal"},{key:"companyName",label:"公司名称",path:"companyName",component:A,props:{placeholder:"请输入公司名称"},condition:f.userType==="external"},{key:"contactPerson",label:"联系人",path:"contactPerson",component:A,props:{placeholder:"请输入联系人"},condition:f.userType==="external"},{key:"roleIds",label:"用户角色",path:"roleIds",component:ie,props:{options:Me.value,placeholder:"请选择角色",multiple:!0,clearable:!0},condition:!0},{key:"password",label:"初始密码",path:"password",component:A,props:{type:"password",placeholder:"请输入初始密码",showPasswordOn:"click"},condition:z.value==="add"},{key:"status",label:"用户状态",path:"status",component:$t,props:{checkedValue:1,uncheckedValue:0,...z.value==="edit"&&{checked:()=>"正常",unchecked:()=>"禁用"}},condition:!0}],Ze=()=>({handleBatchOperation:(m,l)=>{if(I.value.length===0){i.warning("请先选择用户");return}const c=r.batchConfig[m],u=`${c.content.replace("选中的用户",`选中的 ${I.value.length} 个用户`)}`;y[c.type]({title:c.title,content:u,positiveText:"确认",negativeText:"取消",onPositiveClick:async()=>{try{l(I.value),i.success(`批量${m==="delete"?"删除":"操作"}成功`),I.value=[],await S()}catch{i.error(`批量${m==="delete"?"删除":"操作"}失败`)}}})},batchDeleteUsers:m=>{m.forEach(l=>{const c=w.findIndex(u=>u.id===l);c!==-1&&w.splice(c,1)})},batchToggleUsers:m=>{m.forEach(l=>{const c=w.find(u=>u.id===l);c&&ye(l,{status:c.status===1?0:1,updateTime:new Date().toLocaleString()})})}}),Ye=()=>{const e=(l,c)=>{const u={nickname:l.nickname,email:l.email||void 0,phone:l.phone||void 0,userType:l.userType,deptId:l.deptId||void 0,deptName:l.deptId?Ve(l.deptId):void 0,roleIds:l.roleIds,roleNames:l.roleIds.map(T=>je(T)),status:l.status,remark:l.remark||void 0,companyName:l.companyName||void 0,contactPerson:l.contactPerson||void 0};return c?{...c,...u,updateTime:new Date().toLocaleString()}:{id:`user_${Date.now()}`,username:l.username,createTime:new Date().toLocaleString(),...u}},t=(l,c)=>c==="edit"&&!l.id?{valid:!1,error:"用户ID不存在"}:c==="add"&&w.find(T=>T.username===l.username)?{valid:!1,error:"用户名已存在"}:{valid:!0};return{handleAddUserData:async l=>{const c=t(l,"add");if(!c.valid)return i.error(c.error),!1;const u=e(l);return w.push(u),i.success("添加成功"),!0},handleUpdateUserData:async l=>{const c=t(l,"edit");if(!c.valid)return i.error(c.error),!1;const u=w.findIndex(O=>O.id===l.id);if(u===-1)return i.error("用户不存在"),!1;const T=w[u],H=e(l,T);return w[u]=H,p.value?.id===l.id&&(p.value={...H}),i.success("修改成功"),!0}}},{handleBatchOperation:ve,batchDeleteUsers:et,batchToggleUsers:tt}=Ze(),{handleAddUserData:at,handleUpdateUserData:nt}=Ye(),st=(e,t)=>{J.value=t.map(d=>String(d)),N.deptId=t.length>0?String(t[0]):null,q()},q=()=>{R.page=1,S()},lt=e=>{I.value=e},ke=e=>{R.page=e,S()},be=e=>{R.pageSize=e,R.page=1,S()},ot=()=>{Q.value?(le.value?.collapseAll(),Q.value=!1):(le.value?.expandAll(),Q.value=!0)},rt=async()=>{await Promise.all([S(),we(),xe()]),i.success("刷新成功")},it=e=>{e==="external"?f.deptId="dept_external":e==="internal"&&(f.companyName="",f.contactPerson="",f.deptId=null),f.roleIds=[]},dt=e=>{z.value="add",Object.assign(f,ue),W.value&&(f.deptId=W.value.id,W.value.id==="dept_external"&&(f.userType="external")),P.value=!0},ct=e=>{z.value="edit",Object.assign(f,{id:e.id,username:e.username,nickname:e.nickname,email:e.email||"",phone:e.phone||"",userType:e.userType,deptId:e.deptId,roleIds:e.roleIds||[],status:e.status,remark:e.remark||"",companyName:e.companyName||"",contactPerson:e.contactPerson||""}),P.value=!0},ut=e=>{p.value=e,M.value=!0},pt=async e=>{const t=e.status===1?0:1,d=t===1?"启用":"禁用";try{ye(e.id,{status:t,updateTime:new Date().toLocaleString()}),i.success(`${d}成功`)}catch{i.error(`${d}失败`)}},mt=async e=>{try{const t=w.findIndex(d=>d.id===e);t!==-1&&w.splice(t,1),i.success("删除成功"),await S()}catch{i.error("删除失败")}},ft=e=>{if(e.status===0){i.warning("禁用用户无法重置密码");return}Ae.value=e.id,Object.assign($,Pe),K.value=!0},yt=async()=>{try{return await fe.value?.validate(),i.success("密码重置成功"),K.value=!1,!0}catch(e){return e instanceof Array||i.error("密码重置失败"),!1}},gt=async()=>{try{await me.value?.validate();const e=z.value==="add"?await at(f):await nt(f);return e&&(P.value=!1,await S()),e}catch(e){return e instanceof Array||i.error("保存失败"),!1}},_t=()=>{P.value=!1,Object.assign(f,ue)},S=async()=>{x.value=!0;try{const e={...N,page:R.page,pageSize:R.pageSize},t=await Qt(e);X.length=0,X.push(...t.data.list),R.itemCount=t.data.total}catch{i.error("加载用户列表失败")}finally{x.value=!1}},we=async()=>{try{const e=await Xt();G.length=0,G.push(...e.data)}catch{i.error("加载部门列表失败")}},xe=async()=>{try{const e=await Zt();Z.value=e.data.map(t=>({label:t.name,value:t.id}))}catch{i.error("加载角色列表失败")}};return Tt(async()=>{await Promise.all([S(),we(),xe()])}),(e,t)=>{const d=A,m=ie,l=Ce,c=de,u=zt,T=Rt,H=V,O=Dt,ht=St,ee=At,vt=Ot,kt=Lt,bt=Et,te=Bt,Te=Ft,Ue=jt;return g(),E("div",Yt,[s(u,{class:"header-card"},{default:n(()=>[s(l,{justify:"space-between",align:"center"},{default:n(()=>[s(l,null,{default:n(()=>[s(d,{value:a(N).keyword,"onUpdate:value":t[0]||(t[0]=o=>a(N).keyword=o),placeholder:"搜索用户名、昵称、邮箱",clearable:"",style:{width:"300px"},onKeyup:It(q,["enter"])},{prefix:n(()=>[s(b,{name:r.icons.search,size:16},null,8,["name"])]),_:1},8,["value"]),s(m,{value:a(N).userType,"onUpdate:value":[t[1]||(t[1]=o=>a(N).userType=o),q],placeholder:"用户类型",clearable:"",style:{width:"120px"},options:a(ce).userType},null,8,["value","options"]),s(m,{value:a(N).status,"onUpdate:value":[t[2]||(t[2]=o=>a(N).status=o),q],placeholder:"用户状态",clearable:"",style:{width:"120px"},options:a(ce).userStatus},null,8,["value","options"]),s(m,{value:a(N).roleId,"onUpdate:value":[t[3]||(t[3]=o=>a(N).roleId=o),q],placeholder:"用户角色",clearable:"",style:{width:"120px"},options:a(Z)},null,8,["value","options"])]),_:1}),s(l,null,{default:n(()=>[s(c,{type:"primary",onClick:t[4]||(t[4]=o=>dt())},{icon:n(()=>[s(b,{name:r.icons.plus,size:16},null,8,["name"])]),default:n(()=>[t[15]||(t[15]=k(" 新增用户 ",-1))]),_:1}),s(c,{onClick:ot},{icon:n(()=>[s(b,{name:r.icons.tree,size:16},null,8,["name"])]),default:n(()=>[k(" "+C(a(Q)?"收起全部":"展开全部"),1)]),_:1}),s(c,{onClick:rt},{icon:n(()=>[s(b,{name:r.icons.refresh,size:16},null,8,["name"])]),default:n(()=>[t[16]||(t[16]=k(" 刷新 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),Ut("div",ea,[s(ee,{cols:24,"x-gap":16,responsive:"screen"},{default:n(()=>[s(T,{span:6,md:8,sm:24},{default:n(()=>[s(u,{title:"组织架构",class:"content-card"},{default:n(()=>[s(Nt,{ref_key:"deptTreeRef",ref:le,mode:"custom",data:a(G),searchable:!1,"show-toolbar":!1,"icon-config":a(Fe),"default-expanded-keys":a(De),"default-selected-keys":a(J),onNodeSelect:st,class:"dept-tree"},null,8,["data","icon-config","default-expanded-keys","default-selected-keys"])]),_:1})]),_:1}),s(T,{span:18,md:16,sm:24},{default:n(()=>[s(u,{class:"content-card"},{header:n(()=>[s(l,{justify:"space-between",align:"center"},{default:n(()=>[s(O,null,{default:n(()=>[k(C(a(W)?`${a(W).name} - 用户列表`:"用户列表")+" ",1),s(H,{type:"info",size:"small",style:{"margin-left":"8px"}},{default:n(()=>[k(" 共 "+C(a(R).itemCount)+" 人 ",1)]),_:1})]),_:1}),s(l,null,{default:n(()=>[a(I).length>0?(g(),U(c,{key:0,type:"warning",size:"small",onClick:t[5]||(t[5]=()=>a(ve)("toggle",a(tt)))},{icon:n(()=>[s(b,{name:r.icons.toggle,size:14},null,8,["name"])]),default:n(()=>[t[17]||(t[17]=k(" 批量操作 ",-1))]),_:1})):F("",!0),a(I).length>0?(g(),U(c,{key:1,type:"error",size:"small",onClick:t[6]||(t[6]=()=>a(ve)("delete",a(et)))},{icon:n(()=>[s(b,{name:r.icons.delete,size:14},null,8,["name"])]),default:n(()=>[t[18]||(t[18]=k(" 批量删除 ",-1))]),_:1})):F("",!0)]),_:1})]),_:1})]),default:n(()=>[s(ht,{ref_key:"tableRef",ref:Se,"checked-row-keys":a(I),"onUpdate:checkedRowKeys":[t[7]||(t[7]=o=>ae(I)?I.value=o:null),lt],columns:He,data:a(X),pagination:a(Be),loading:a(x),"row-key":o=>o.id,"scroll-x":1600,"row-class-name":Ke,size:"small",remote:"",striped:"","onUpdate:page":ke,"onUpdate:pageSize":be},null,8,["checked-row-keys","data","pagination","loading","row-key"])]),_:1})]),_:1})]),_:1})]),s(bt,{show:a(M),"onUpdate:show":t[9]||(t[9]=o=>ae(M)?M.value=o:null),width:600,placement:"right"},{default:n(()=>[s(kt,{title:"用户详情",closable:""},{default:n(()=>[a(p)?(g(),E("div",ta,[s(l,{vertical:"",size:24},{default:n(()=>[s(u,{title:"基本信息",size:"small",class:D({"disabled-card":a(p).status===0})},{default:n(()=>[s(l,{vertical:"",size:16},{default:n(()=>[s(l,{align:"center",justify:"center",style:{position:"relative"}},{default:n(()=>[s(vt,{size:80,src:a(p).avatar,"fallback-src":r.defaultAvatar,class:D({"disabled-avatar":a(p).status===0})},{default:n(()=>[k(C(a(p).nickname?.charAt(0)),1)]),_:1},8,["src","fallback-src","class"]),a(p).status===0?(g(),E("div",aa,[s(b,{name:r.icons.cancel,size:24,color:"#ff4d4f"},null,8,["name"])])):F("",!0)]),_:1}),s(ee,{cols:2,"x-gap":16,"y-gap":12},{default:n(()=>[(g(!0),E(ne,null,se(Je(a(p)),o=>(g(),U(T,{key:o.key},{default:n(()=>[s(l,{align:"center"},{default:n(()=>[s(O,{depth:"3"},{default:n(()=>[k(C(o.label)+"：",1)]),_:2},1024),(g(),U(Ie(o.component),Ne({ref_for:!0},o.props),{default:n(()=>[k(C(o.value),1)]),_:2},1040))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["class"]),a(p).roleNames?.length?(g(),U(u,{key:0,title:"角色信息",size:"small",class:D({"disabled-card":a(p).status===0})},{default:n(()=>[s(l,null,{default:n(()=>[(g(!0),E(ne,null,se(a(p).roleNames,o=>(g(),U(H,{key:o,type:"success",size:"medium",class:D({"disabled-tag":a(p).status===0})},{icon:n(()=>[s(b,{name:r.icons.role,size:12},null,8,["name"])]),default:n(()=>[k(" "+C(o),1)]),_:2},1032,["class"]))),128))]),_:1})]),_:1},8,["class"])):F("",!0),s(u,{title:"时间信息",size:"small",class:D({"disabled-card":a(p).status===0})},{default:n(()=>[s(ee,{cols:1,"y-gap":12},{default:n(()=>[(g(!0),E(ne,null,se(Qe(a(p)),o=>(g(),U(T,{key:o.key},{default:n(()=>[s(l,{align:"center"},{default:n(()=>[s(O,{depth:"3"},{default:n(()=>[k(C(o.label)+"：",1)]),_:2},1024),s(O,{class:D({"disabled-text":a(p).status===0})},{default:n(()=>[k(C(o.value),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["class"]),a(p).remark?(g(),U(u,{key:1,title:"备注信息",size:"small",class:D({"disabled-card":a(p).status===0})},{default:n(()=>[s(O,{class:D({"disabled-text":a(p).status===0})},{default:n(()=>[k(C(a(p).remark),1)]),_:1},8,["class"])]),_:1},8,["class"])):F("",!0),s(l,{justify:"center"},{default:n(()=>[s(c,{type:"primary",onClick:t[8]||(t[8]=o=>M.value=!1)},{default:n(()=>[...t[19]||(t[19]=[k("关闭",-1)])]),_:1})]),_:1})]),_:1})])):F("",!0)]),_:1})]),_:1},8,["show"]),s(Ue,{show:a(P),"onUpdate:show":t[11]||(t[11]=o=>ae(P)?P.value=o:null),preset:"dialog",title:a(Ee),"positive-text":a(z)==="add"?"确认添加":"确认修改","negative-text":"取消",onPositiveClick:gt,onNegativeClick:_t,style:{width:"800px"}},{default:n(()=>[s(Te,{ref_key:"formRef",ref:me,model:a(f),rules:a(Le),"label-placement":"left","label-width":"100px"},{default:n(()=>[s(ee,{cols:2,"x-gap":16},{default:n(()=>[(g(!0),E(ne,null,se(Xe(),o=>(g(),U(T,{key:o.key},{default:n(()=>[o.condition?(g(),U(te,{key:0,label:o.label,path:o.path},{default:n(()=>[(g(),U(Ie(o.component),Ne({ref_for:!0},o.props,{value:a(f)[o.key],"onUpdate:value":wt=>a(f)[o.key]=wt}),null,16,["value","onUpdate:value"]))]),_:2},1032,["label","path"])):F("",!0)]),_:2},1024))),128))]),_:1}),s(te,{label:"备注",path:"remark"},{default:n(()=>[s(d,{value:a(f).remark,"onUpdate:value":t[10]||(t[10]=o=>a(f).remark=o),type:"textarea",placeholder:"请输入备注信息",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show","title","positive-text"]),s(Ue,{show:a(K),"onUpdate:show":t[14]||(t[14]=o=>ae(K)?K.value=o:null),preset:"dialog",title:"重置密码","positive-text":"确认重置","negative-text":"取消",onPositiveClick:yt},{default:n(()=>[s(Te,{ref_key:"resetPasswordFormRef",ref:fe,model:a($),rules:a(Oe),"label-placement":"left","label-width":"100px"},{default:n(()=>[s(te,{label:"新密码",path:"newPassword"},{default:n(()=>[s(d,{value:a($).newPassword,"onUpdate:value":t[12]||(t[12]=o=>a($).newPassword=o),type:"password",placeholder:"请输入新密码","show-password-on":"click"},null,8,["value"])]),_:1}),s(te,{label:"确认密码",path:"confirmPassword"},{default:n(()=>[s(d,{value:a($).confirmPassword,"onUpdate:value":t[13]||(t[13]=o=>a($).confirmPassword=o),type:"password",placeholder:"请再次输入新密码","show-password-on":"click"},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show"])])}}}),pa=Gt(na,[["__scopeId","data-v-d8a3942e"]]);export{pa as default};
