import{C as _}from"./spline-vendor-Btm54g1Q.js";import{u as z,_ as C}from"./ParentSize.vue_vue_type_script_setup_true_lang-DEcuBWDs.js";import{k as L,r as o,c as v,o as B,w as E,E as F,P as O,F as V,R,U as f,s as q,S as x,q as D,X as H,L as N,n as U,Q as W}from"./vue-vendor-DgJqRHrX.js";import{u as $}from"./index-DLz9CAvw.js";const M=L({__name:"Spline",props:{scene:{type:String,required:!0},onLoad:Function,renderOnDemand:{type:Boolean,default:!0},style:Object},emits:["error","spline-mouse-down","spline-mouse-up","spline-mouse-hover","spline-key-down","spline-key-up","spline-start","spline-look-at","spline-follow","spline-scroll"],setup(m,{emit:y}){const w=console.log;console.log=(...e)=>{e.some(s=>typeof s=="string"&&s.includes("updating from"))||w.apply(console,e)};const r=m,i=y,t=o(null),l=o(!1),n=o(null),u=o(!0);let c=()=>{};const h=v(()=>({overflow:"hidden",...r.style})),g=v(()=>({display:"block",width:"100%",height:"100%"})),{stop:k}=z(t,([{isIntersecting:e}])=>{u.value=e,e&&n.value&&U(()=>{t.value&&n.value&&(n.value.requestRender(),n.value.setSize(t.value.clientWidth,t.value.clientHeight))})},{threshold:.1});function S(e,s){if(!s||!n.value)return;const a=$(s,100,{maxWait:200});return n.value.addEventListener(e,a),()=>n.value?.removeEventListener(e,a)}async function b(){if(t.value){l.value=!0;try{n.value&&(n.value.dispose(),n.value=null),n.value=new _(t.value,{renderOnDemand:!0,alpha:!1,antialias:!1});const e=console.warn;console.warn=(...a)=>{a.some(d=>typeof d=="string"&&d.includes("updating from"))||e.apply(console,a)},await n.value.load(r.scene),console.warn=e;const s=[S("start",a=>i("spline-start",a))].filter(Boolean);return l.value=!1,r.onLoad?.(n.value),()=>{s.forEach(a=>a?.())}}catch(e){return i("error",e),l.value=!1,()=>{}}}}async function p(){c(),c=await b()??(()=>{})}return B(async()=>{await p(),E(u,e=>{e&&p()})}),F(()=>{k(),n.value&&(n.value.dispose(),n.value=null)}),(e,s)=>(W(),O(V,null,[R(C,q({"parent-size-styles":h.value,"debounce-time":50},e.$attrs),{default:x(()=>[f("canvas",{ref_key:"canvasRef",ref:t,style:N(g.value)},null,4),l.value?D(e.$slots,"default",{key:0}):H("",!0)]),_:3},16,["parent-size-styles"]),s[0]||(s[0]=f("div",{class:"login-logo"},null,-1))],64))}});export{M as _};
