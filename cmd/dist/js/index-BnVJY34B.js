import{g as W,e as X,c as q,f as A,h as G,r as H,u as J}from"./terraria-QXqyvlub.js";import{a1 as T,$ as L,ab as K,K as y,L as Q,M as f,V as Y,a7 as Z,an as S,a0 as h,X as ee,Y as d,T as N,ag as B,ac as le}from"./ui-vendor-qucRfopV.js";import{k as ae,r as v,o as te,E as se,O as w,P as g,Q as a,R as t,J as l,X as b,Z as P,S as p,j as i,_ as m,F as oe,W as re,L as ne}from"./vue-vendor-DIhTWhib.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./auth-IWVIEBlm.js";import"./index-ClRVJH89.js";import"./spline-vendor-BYERog9l.js";import"./charts-vendor-XI8Sg87J.js";import"./editor-vendor-CUlQiixb.js";const ie={class:"terraria-server"},de={key:0,class:"status-section"},ve={style:{color:"#666"}},pe={style:{color:"#666"}},me={style:{color:"#666"}},fe={class:"log-container"},ge={class:"log-time"},_e={class:"log-message"},ce={key:0,class:"log-empty"},ye=ae({__name:"index",setup(we){const n=v(!1),u=v(null),I=v(null),x=v([]),_=v(!1),r=v(null),C=v(null),k=v(!0),c=async()=>{try{const o=await W();u.value=o}catch{}},U=async()=>{try{const o=await X();I.value=o,r.value={...o}}catch{window.$message?.error("加载配置失败")}},$=async()=>{try{const o=await q(100);x.value=o||[],k.value&&E()}catch{}},R=async()=>{n.value=!0;try{await A(),window.$message?.success("服务器启动命令已发送"),setTimeout(c,2e3)}catch{window.$message?.error("启动服务器失败")}finally{n.value=!1}},z=async()=>{n.value=!0;try{await G(),window.$message?.success("服务器停止命令已发送"),setTimeout(c,2e3)}catch{window.$message?.error("停止服务器失败")}finally{n.value=!1}},V=async()=>{n.value=!0;try{await H(),window.$message?.success("服务器重启命令已发送"),setTimeout(c,2e3)}catch{window.$message?.error("重启服务器失败")}finally{n.value=!1}},j=async()=>{if(r.value){n.value=!0;try{await J(r.value),window.$message?.success("配置已保存，重启服务器后生效"),_.value=!1,U()}catch{window.$message?.error("保存配置失败")}finally{n.value=!1}}},E=()=>{setTimeout(()=>{const o=document.querySelector(".log-container");o&&(o.scrollTop=o.scrollHeight)},100)},F=o=>({running:"success",stopped:"error",starting:"warning",stopping:"warning",error:"error"})[o]||"default",M=o=>({running:"运行中",stopped:"已停止",starting:"启动中",stopping:"停止中",error:"错误"})[o]||"未知",O=o=>({ERROR:"#d03050",WARN:"#f0a020",INFO:"#18a058",DEBUG:"#666666"})[o]||"#666666";return te(()=>{c(),U(),$(),C.value=window.setInterval(()=>{c(),$()},3e3)}),se(()=>{C.value&&clearInterval(C.value)}),(o,e)=>(g(),w("div",ie,[a(l(h),{"x-gap":16,"y-gap":16,cols:1},{default:t(()=>[a(l(T),null,{default:t(()=>[a(l(L),{title:"服务器控制",bordered:!1},{default:t(()=>[a(l(K),{show:n.value},{default:t(()=>[a(l(y),{vertical:"",size:"large"},{default:t(()=>[u.value?(g(),w("div",de,[a(l(y),{align:"center"},{default:t(()=>[e[12]||(e[12]=p("span",{style:{"font-weight":"600"}},"当前状态:",-1)),a(l(Q),{type:F(u.value.status),size:"medium"},{default:t(()=>[i(m(M(u.value.status)),1)]),_:1},8,["type"]),p("span",ve,"端口: "+m(u.value.port),1),p("span",pe,"版本: "+m(u.value.version),1),p("span",me,"在线: "+m(u.value.currentPlayers)+"/"+m(u.value.maxPlayers),1)]),_:1})])):b("",!0),a(l(y),null,{default:t(()=>[a(l(f),{type:"success",disabled:u.value?.status==="running"||n.value,onClick:R},{default:t(()=>[...e[13]||(e[13]=[i(" 启动服务器 ",-1)])]),_:1},8,["disabled"]),a(l(f),{type:"error",disabled:u.value?.status==="stopped"||n.value,onClick:z},{default:t(()=>[...e[14]||(e[14]=[i(" 停止服务器 ",-1)])]),_:1},8,["disabled"]),a(l(f),{type:"warning",disabled:u.value?.status!=="running"||n.value,onClick:V},{default:t(()=>[...e[15]||(e[15]=[i(" 重启服务器 ",-1)])]),_:1},8,["disabled"]),a(l(f),{type:"primary",onClick:e[0]||(e[0]=s=>_.value=!0)},{default:t(()=>[...e[16]||(e[16]=[i(" 编辑配置 ",-1)])]),_:1})]),_:1}),u.value?.status==="error"?(g(),P(l(Y),{key:1,type:"error",title:"服务器错误"},{default:t(()=>[...e[17]||(e[17]=[i(" 服务器遇到错误，请查看日志了解详情 ",-1)])]),_:1})):b("",!0)]),_:1})]),_:1},8,["show"])]),_:1})]),_:1}),a(l(T),null,{default:t(()=>[a(l(L),{title:"服务器日志",bordered:!1},{"header-extra":t(()=>[a(l(y),null,{default:t(()=>[a(l(S),{value:k.value,"onUpdate:value":e[1]||(e[1]=s=>k.value=s),size:"small"},{checked:t(()=>[...e[18]||(e[18]=[i("自动滚动",-1)])]),unchecked:t(()=>[...e[19]||(e[19]=[i("手动滚动",-1)])]),_:1},8,["value"]),a(l(f),{size:"small",onClick:$},{default:t(()=>[...e[20]||(e[20]=[i("刷新",-1)])]),_:1})]),_:1})]),default:t(()=>[a(l(Z),{style:{"max-height":"500px"},trigger:"none"},{default:t(()=>[p("div",fe,[(g(!0),w(oe,null,re(x.value,(s,D)=>(g(),w("div",{key:D,class:"log-line"},[p("span",ge,m(s.timestamp),1),p("span",{class:"log-level",style:ne({color:O(s.level)})}," ["+m(s.level)+"] ",5),p("span",_e,m(s.message),1)]))),128)),x.value.length===0?(g(),w("div",ce," 暂无日志数据 ")):b("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),a(l(le),{show:_.value,"onUpdate:show":e[11]||(e[11]=s=>_.value=s),preset:"card",title:"服务器配置",style:{width:"600px"},bordered:!1,segmented:{content:!0}},{footer:t(()=>[a(l(y),{justify:"end"},{default:t(()=>[a(l(f),{onClick:e[10]||(e[10]=s=>_.value=!1)},{default:t(()=>[...e[21]||(e[21]=[i("取消",-1)])]),_:1}),a(l(f),{type:"primary",loading:n.value,onClick:j},{default:t(()=>[...e[22]||(e[22]=[i(" 保存配置 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:t(()=>[r.value?(g(),P(l(ee),{key:0,model:r.value,"label-placement":"left","label-width":"120"},{default:t(()=>[a(l(d),{label:"服务器名称"},{default:t(()=>[a(l(N),{value:r.value.serverName,"onUpdate:value":e[2]||(e[2]=s=>r.value.serverName=s),placeholder:"请输入服务器名称"},null,8,["value"])]),_:1}),a(l(d),{label:"服务器端口"},{default:t(()=>[a(l(B),{value:r.value.port,"onUpdate:value":e[3]||(e[3]=s=>r.value.port=s),min:1024,max:65535,style:{width:"100%"}},null,8,["value"])]),_:1}),a(l(d),{label:"最大玩家数"},{default:t(()=>[a(l(B),{value:r.value.maxPlayers,"onUpdate:value":e[4]||(e[4]=s=>r.value.maxPlayers=s),min:1,max:255,style:{width:"100%"}},null,8,["value"])]),_:1}),a(l(d),{label:"服务器密码"},{default:t(()=>[a(l(N),{value:r.value.password,"onUpdate:value":e[5]||(e[5]=s=>r.value.password=s),type:"password",placeholder:"留空表示无密码"},null,8,["value"])]),_:1}),a(l(d),{label:"世界名称"},{default:t(()=>[a(l(N),{value:r.value.worldName,"onUpdate:value":e[6]||(e[6]=s=>r.value.worldName=s),placeholder:"请输入世界名称"},null,8,["value"])]),_:1}),a(l(d),{label:"自动保存"},{default:t(()=>[a(l(S),{value:r.value.autoSave,"onUpdate:value":e[7]||(e[7]=s=>r.value.autoSave=s)},null,8,["value"])]),_:1}),a(l(d),{label:"PvP模式"},{default:t(()=>[a(l(S),{value:r.value.pvp,"onUpdate:value":e[8]||(e[8]=s=>r.value.pvp=s)},null,8,["value"])]),_:1}),a(l(d),{label:"旅程模式"},{default:t(()=>[a(l(S),{value:r.value.journey,"onUpdate:value":e[9]||(e[9]=s=>r.value.journey=s)},null,8,["value"])]),_:1})]),_:1},8,["model"])):b("",!0)]),_:1},8,["show"])]))}}),Le=ue(ye,[["__scopeId","data-v-7ce65267"]]);export{Le as default};
