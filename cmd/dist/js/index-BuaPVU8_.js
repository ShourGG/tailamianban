import{k as ee,ag as te,r as g,c as p,w as oe,o as se,E as ne,O as a,P as r,S as t,Z as I,H as k,J as l,T as le,Q as re,z as ie,R as ae,X as y,ah as f,ai as R,l as ce,aj as ue,a2 as de,j as q,_ as m,F as V,W as z,a6 as O,n as ve}from"./vue-vendor-DIhTWhib.js";import{u as me,c as he}from"./index-CIpQTZjJ.js";import{n as B}from"./d_menu-CvqaH7AJ.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./spline-vendor-BYERog9l.js";import"./ui-vendor-qucRfopV.js";import"./charts-vendor-XI8Sg87J.js";import"./editor-vendor-CUlQiixb.js";import"./iconify-CfW7wLRI.js";const be={class:"robot-search-palette"},ge={class:"robot-search-header"},ye={class:"robot-search-content"},fe={key:0,class:"robot-empty-state"},ke={key:1,class:"robot-search-results"},_e={class:"robot-result-group"},Ce={class:"robot-group-title"},Me={class:"robot-group-count"},we={class:"robot-group-items"},Ie=["onClick","onMouseenter"],Se={key:1,class:"robot-item-icon robot-default-icon"},xe={class:"robot-item-content"},De={class:"robot-item-label"},He={class:"robot-item-desc"},Te=["onClick"],Ke={key:2,class:"robot-search-results"},Le={key:0,class:"robot-empty-state"},Ne={key:1,class:"robot-result-group"},$e={class:"robot-group-title"},Ee={class:"robot-group-count"},Re={class:"robot-group-items"},qe=["onClick","onMouseenter"],Ve={key:1,class:"robot-item-icon robot-default-icon"},ze={class:"robot-item-content"},Oe=["innerHTML"],Be={class:"robot-item-desc"},Fe={key:2,class:"robot-item-badge"},Je={class:"robot-search-footer"},Pe={key:0,class:"robot-footer-info"},je={key:0},Ue={key:1},Ge=ee({__name:"index",setup(Qe){const S=te(),F=me(),J=he(),_=g(!1),i=g(""),c=g(0),x=g(),d=g([]),D=p(()=>F.isDark),C=p(()=>J.showMenuListGet),P=p(()=>{if(!C.value?.length)return[];const o=B(C.value),e=s=>{const u=[];return s.forEach(n=>{n.key&&n.label&&u.push({key:n.key,label:n.label,icon:n.icon,children:n.children}),n.children?.length&&u.push(...e(n.children))}),u};return e(o)}),h=p(()=>{if(!i.value.trim())return[];const o=i.value.toLowerCase();return P.value.filter(e=>e.label.toLowerCase().includes(o)||w(e.key).toLowerCase().includes(o))}),v=p(()=>d.value.slice(0,5)),M=p(()=>h.value.length>0),H=p(()=>M.value||v.value.length>0),T=(o,e)=>["robot-result-item",e&&"robot-history-item",{"robot-result-item-selected":c.value===o}],j=(o,e)=>{if(!e)return o;const s=new RegExp(`(${e})`,"gi");return o.replace(s,'<mark class="robot-highlight">$1</mark>')},w=o=>o.replace(/^\//,"").replace(/\//g," > ")||"首页",U=o=>{if(!o.label.trim())return;const e=o.label,s=Date.now(),u=d.value.filter(n=>!(n.query===e&&n.menuItem?.key===o.key));d.value=[{query:e,menuItem:o,timestamp:s},...u].slice(0,10),localStorage.setItem("robot-search-history",JSON.stringify(d.value))},G=()=>{try{const o=localStorage.getItem("robot-search-history");if(o){const e=JSON.parse(o);d.value=e.map(s=>typeof s=="string"?{query:s,menuItem:null,timestamp:0}:s)}}catch{}},Q=()=>{d.value=[],localStorage.removeItem("robot-search-history")},W=o=>{d.value.splice(o,1),localStorage.setItem("robot-search-history",JSON.stringify(d.value)),c.value>=d.value.length&&(c.value=Math.max(0,d.value.length-1))},X=o=>{const e=B(C.value),s=u=>{for(const n of u){if(n.key===o&&n.children?.length)return n.children[0]?.key||null;if(n.children?.length){const E=s(n.children);if(E)return E}}return null};return s(e)},K=(o,e=!1)=>{if(e){const s=X(o);if(s){S.push(s);return}}S.push(o)},L=async()=>{_.value=!0,i.value="",c.value=0,await ve(),x.value?.focus()},b=()=>{_.value=!1,i.value="",c.value=0},N=o=>{o.menuItem?(K(o.menuItem.key,!!o.menuItem.children?.length),b()):(i.value=o.query,c.value=0)},$=o=>{U(o),K(o.key,!!o.children?.length),b()},Z=()=>{const o=!i.value.trim()&&v.value.length>0,e=i.value.trim()&&h.value.length>0;if(o){const s=v.value[c.value];s&&N(s)}else if(e){const s=h.value[c.value];s&&$(s)}},A=()=>{const o=i.value.trim()?h.value.length-1:v.value.length-1;c.value=Math.min(c.value+1,o)},Y=()=>{c.value=Math.max(c.value-1,0)};return oe(i,()=>{c.value=0}),se(()=>{G();const o=e=>{(e.ctrlKey||e.metaKey)&&e.key==="k"&&(e.preventDefault(),L())};document.addEventListener("keydown",o),ne(()=>document.removeEventListener("keydown",o))}),(o,e)=>(r(),a("div",be,[t("div",{class:k(["robot-search-trigger",{"trigger-dark":l(D)}]),onClick:L},[...e[2]||(e[2]=[t("div",{class:"i-mdi:search robot-trigger-icon"},null,-1),t("span",{class:"robot-trigger-text"},"搜索",-1),t("span",{class:"robot-trigger-shortcut"},"Ctrl K",-1)])],2),(r(),I(le,{to:"body"},[re(ie,{name:"robot-dialog"},{default:ae(()=>[l(_)?(r(),a("div",{key:0,class:"robot-dialog-overlay",onClick:b,onKeydown:f(b,["esc"])},[t("div",{class:k(["robot-dialog-container",{"dialog-dark":l(D)}]),onClick:e[1]||(e[1]=R(()=>{},["stop"]))},[t("div",ge,[e[4]||(e[4]=t("div",{class:"i-mdi:magnify robot-search-icon"},null,-1)),ce(t("input",{ref_key:"searchInputRef",ref:x,"onUpdate:modelValue":e[0]||(e[0]=s=>de(i)?i.value=s:null),type:"text",placeholder:"搜索导航菜单...",class:"robot-search-input",onKeydown:[f(b,["esc"]),f(Z,["enter"]),f(A,["arrow-down"]),f(Y,["arrow-up"])]},null,544),[[ue,l(i)]]),t("button",{class:"robot-close-btn",onClick:b},[...e[3]||(e[3]=[t("div",{class:"i-mdi:close"},null,-1)])])]),t("div",ye,[l(H)?!l(i).trim()&&l(v).length>0?(r(),a("div",ke,[t("div",_e,[t("div",Ce,[e[7]||(e[7]=t("div",{class:"i-mdi:clock-time-four-outline robot-group-icon"},null,-1)),e[8]||(e[8]=q(" 最近搜索 ",-1)),t("span",Me,m(l(v).length),1),t("button",{class:"robot-clear-history",onClick:Q,title:"清空历史"},[...e[6]||(e[6]=[t("div",{class:"i-mdi:delete-outline"},null,-1)])])]),t("div",we,[(r(!0),a(V,null,z(l(v),(s,u)=>(r(),a("div",{key:`history-${u}`,class:k(T(u,!0)),onClick:n=>N(s),onMouseenter:n=>c.value=u},[s.menuItem?.icon?(r(),I(O(s.menuItem.icon),{key:0,class:"robot-item-icon"})):(r(),a("div",Se,[...e[9]||(e[9]=[t("div",{class:"i-mdi:file-document-outline"},null,-1)])])),t("div",xe,[t("div",De,m(s.query),1),t("div",He,m(w(s.menuItem?.key||"")),1)]),t("button",{class:"robot-history-delete",onClick:R(n=>W(u),["stop"]),title:"删除此记录"},[...e[10]||(e[10]=[t("div",{class:"i-mdi:close"},null,-1)])],8,Te)],42,Ie))),128))])])])):l(i).trim()?(r(),a("div",Ke,[l(M)?(r(),a("div",Ne,[t("div",$e,[e[12]||(e[12]=t("div",{class:"i-mdi:menu robot-group-icon"},null,-1)),e[13]||(e[13]=q(" 菜单导航 ",-1)),t("span",Ee,m(l(h).length),1)]),t("div",Re,[(r(!0),a(V,null,z(l(h),(s,u)=>(r(),a("div",{key:s.key,class:k(T(u,!1)),onClick:n=>$(s),onMouseenter:n=>c.value=u},[s.icon?(r(),I(O(s.icon),{key:0,class:"robot-item-icon"})):(r(),a("div",Ve,[...e[14]||(e[14]=[t("div",{class:"i-mdi:file-document-outline"},null,-1)])])),t("div",ze,[t("div",{class:"robot-item-label",innerHTML:j(s.label,l(i))},null,8,Oe),t("div",Be,m(w(s.key)),1)]),s.children?.length?(r(),a("div",Fe,m(s.children.length),1)):y("",!0)],42,qe))),128))])])):(r(),a("div",Le,[e[11]||(e[11]=t("div",{class:"i-mdi:magnify robot-empty-icon"},null,-1)),t("p",null,'未找到 "'+m(l(i))+'" 相关内容',1)]))])):y("",!0):(r(),a("div",fe,[...e[5]||(e[5]=[t("div",{class:"i-mdi:magnify robot-empty-icon"},null,-1),t("p",null,"输入关键词搜索菜单",-1)])]))]),t("div",Je,[e[15]||(e[15]=t("div",{class:"robot-footer-actions"},[t("div",{class:"robot-action-item"},[t("kbd",null,"↵"),t("span",null,"选择")]),t("div",{class:"robot-action-item"},[t("kbd",null,"↑↓"),t("span",null,"导航")]),t("div",{class:"robot-action-item"},[t("kbd",null,"esc"),t("span",null,"关闭")])],-1)),l(H)?(r(),a("div",Pe,[l(i).trim()&&l(M)?(r(),a("span",je," 共 "+m(l(h).length)+" 项结果 ",1)):!l(i).trim()&&l(v).length>0?(r(),a("span",Ue,m(l(v).length)+" 条历史记录 ",1)):y("",!0)])):y("",!0)])],2)],32)):y("",!0)]),_:1})]))]))}}),nt=pe(Ge,[["__scopeId","data-v-2fa5c319"]]);export{nt as default};
