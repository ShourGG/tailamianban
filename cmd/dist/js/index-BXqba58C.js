import{i as X}from"./charts-vendor-DjXuxi75.js";import{k as yt,r as u,c as x,w as bt,o as Ct,n as wt,E as Dt,P as m,Q as h,U as e,_ as l,J as n,F as L,M as F,H as St,R as V,S as Z,j as Rt,L as W,Z as Tt,m as g}from"./vue-vendor-DgJqRHrX.js";import{aa as xt,aA as kt}from"./ui-vendor-Dblj447Y.js";import{_ as Ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";const v={title:"日 成 本 管 控 大 屏",headerInfo:{datePrefix:"日期",temperature:"☀ 17°C"},panels:{factoryTitle:"分厂日成本",keyIndicatorsTitle:"关键指标",costChartTitle:"成本构成",costChartSubtitle:"成本构成数据数据库",dataTableTitle:"成本中心日成本",analysisTableTitle:"分厂原材料成本数据（占比）",trendChartTitle:"分厂日单本成本近30日趋势图",productionTableTitle:"成本中心日产量",productionNotice:"厂成本实际产量"}},q={name:"分厂",labels:["实际成本","标准成本","成本偏差"]},Mt=[{color:"#ff6b6b",label:"原材料消耗成本"},{color:"#4ecdc4",label:"人工成本"},{color:"#45b7d1",label:"能耗"},{color:"#f9ca24",label:"制造费用"}],G=a=>{if(!a&&a!==0)return"green";const s=Math.abs(parseFloat(a.toString()));return s<=.05?"green":s<=.2?"yellow":"red"},zt=["球团矿","石灰车间","烧结矿","炼铁厂-炼钢铁水","炼钢一厂","炼钢二厂","棒线厂-高棒(RRB613,YRY613)","棒线厂-普棒(RRB612,YRY612)","热轧厂-1580轧线","热轧厂-900轧线","冷轧厂-酸轧","冷轧厂-罩平","冷轧厂-镀锌#1","冷轧厂-镀锌#2","冷轧厂-镀锌#3","冷轧厂-彩涂","冷轧厂-酸平"],c=(a,s)=>Math.random()*(s-a)+a,Lt=(a,s)=>{const p=c(5e5,8e5),f=c(8e6,12e6),r=c(150,250),S=f*c(.95,1.05),y=r-S/p,R=y/r;return{id:s+1,costCenter:`CC${(s+1).toString().padStart(3,"0")}`,costCenterDesc:a,acctDate:"20250914",type:{key:1,value:"日成本"},wgt:Math.round(p),amtReal:Math.round(f),amtUnitReal:Math.round(r*100)/100,amtStandard:Math.round(S),amtUnitDiff:Math.round(y*100)/100,amtUnitDiffRate:Math.round(R*1e4)/1e4,wgtDiff:c(-5e4,5e4),wgtDiffRate:c(-.1,.1),mom:c(-15,15),yoy:c(-25,25),progressPercentage:Math.round(c(60,95)),standardPercentage:Math.round(c(85,100))}},Ft=a=>a?{wgtDiffRate:c(-.15,.15),amtUnitDiffRate:c(-.2,.2),amtUnitDiff:c(-50,50),amtReal:a.amtReal||c(8e6,12e6),amtStandard:a.amtStandard||c(75e5,115e5),materialCostRate:c(.4,.65),laborCostRate:c(.12,.25),energyCostRate:c(.15,.3),efficiencyRate:c(.75,.95)}:null,It=a=>{if(!a)return[];const s=a.amtUnitReal||200,p=[];for(let f=0;f<30;f++){const r=new Date;r.setDate(r.getDate()-(29-f));const S=Math.sin(f*.2)*20,y=c(-15,15),R=s+S+y;p.push({acctDate:r.toISOString().slice(0,10).replace(/-/g,""),amtUnitReal:Math.max(R,100),day:f+1})}return p},D=(a,s=!1)=>a==null||isNaN(a)?"0.0":Math.abs(s?a*100:a).toFixed(1),Pt=a=>a?[{icon:"🔵",value:D(a.wgtDiffRate,!0),unit:"%",name:"钢铁料偏差"},{icon:"🔵",value:D(a.amtUnitDiffRate,!0),unit:"%",name:"综合成本偏差"},{icon:"🔵",value:D(a.amtUnitDiff),unit:"元",name:"实际计划成本偏差"},{icon:"🔵",value:D(a.amtUnitDiffRate,!0),unit:"%",name:"差异率"},{icon:"🟢",value:D(a.materialCostRate,!0),unit:"%",name:"原料成本占比"},{icon:"🟡",value:D(a.laborCostRate,!0),unit:"%",name:"人工成本占比"},{icon:"🟠",value:D(a.energyCostRate,!0),unit:"%",name:"能耗成本占比"},{icon:"🟣",value:D(a.efficiencyRate,!0),unit:"%",name:"生产效率"}]:[{icon:"🔵",value:"2.5",unit:"%",name:"钢铁料偏差"},{icon:"🔵",value:"1.8",unit:"%",name:"综合成本偏差"},{icon:"🔵",value:"12.3",unit:"元",name:"计划成本偏差"},{icon:"🔵",value:"3.2",unit:"%",name:"差异率"},{icon:"🟢",value:"52.6",unit:"%",name:"原料成本占比"},{icon:"🟡",value:"18.4",unit:"%",name:"人工成本占比"},{icon:"🟠",value:"22.1",unit:"%",name:"能耗成本占比"},{icon:"🟣",value:"88.5",unit:"%",name:"生产效率"}],Nt=a=>{if(!a||!Array.isArray(a))return Array.from({length:30},(f,r)=>({day:(r+1).toString().padStart(2,"0"),value:180+Math.sin(r*.3)*40+Math.random()*20}));const s=a.map((f,r)=>({day:(r+1).toString().padStart(2,"0"),value:f.amtUnitReal||0})),p=30-s.length;if(p>0){const f=s.length>0?s[s.length-1].value:200;for(let r=0;r<p;r++)s.push({day:(s.length+r+1).toString().padStart(2,"0"),value:f+(Math.random()-.5)*50})}return s.slice(0,30)},E=(a=300)=>new Promise(s=>setTimeout(s,a));let $=null;const At=()=>($||($=zt.map((a,s)=>Lt(a,s))),$),Bt=async()=>{try{const a=At();return await E(200),a}catch{throw new Error("模拟数据加载失败")}},Ot=async a=>{if(!a)return null;try{const s=Ft(a);return await E(200),s}catch{throw new Error("KPI数据获取失败")}},Vt=async a=>{if(!a)return null;try{const s=It(a);return await E(300),s}catch{throw new Error("趋势数据获取失败")}},Wt=a=>({backgroundColor:"transparent",series:[{type:"pie",radius:["45%","75%"],center:["50%","50%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:8,borderColor:"rgba(29, 59, 120, 0.8)",borderWidth:3},label:{show:!0,position:"outside",fontSize:12,fontWeight:"bold",color:"#fff",formatter:s=>`${s.name}
${s.percent}%`},labelLine:{show:!0,length:15,length2:10,lineStyle:{color:"rgba(255, 255, 255, 0.5)",width:1}},emphasis:{label:{show:!0,fontSize:16,fontWeight:"bold",color:"#fff"},itemStyle:{shadowBlur:20,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},data:a}]}),tt=a=>({backgroundColor:"transparent",grid:{top:20,left:40,right:20,bottom:30},xAxis:{type:"category",data:a.map(s=>s.day),axisLine:{lineStyle:{color:"rgba(64, 169, 243, 0.5)"}},axisLabel:{color:"#fff",fontSize:10,interval:4},axisTick:{show:!1}},yAxis:{type:"value",axisLine:{show:!1},axisLabel:{color:"#fff",fontSize:10},splitLine:{lineStyle:{color:"rgba(64, 169, 243, 0.2)",type:"dashed"}},axisTick:{show:!1}},series:[{data:a.map(s=>s.value),type:"line",smooth:!0,symbol:"none",lineStyle:{color:"#00ffff",width:3},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(0, 255, 255, 0.4)"},{offset:1,color:"rgba(0, 255, 255, 0.05)"}]}}}]}),$t=()=>[{value:45,name:"原材料消耗成本",itemStyle:{color:"#ff6b6b"}},{value:25,name:"人工成本",itemStyle:{color:"#4ecdc4"}},{value:20,name:"能耗",itemStyle:{color:"#45b7d1"}},{value:10,name:"制造费用",itemStyle:{color:"#f9ca24"}}],Et={class:"jingang-dashboard"},Ht={class:"dashboard-header"},Kt={class:"header-info"},Yt={class:"date"},jt={class:"time"},Jt={class:"temp"},Qt={class:"dashboard-content"},Xt={class:"left-panel"},Zt={class:"panel-container"},qt={class:"panel-title"},Gt={class:"factory-header"},te={class:"factory-name-header"},ee={class:"factory-data-header"},ae={key:0,class:"no-data-placeholder"},se={key:1,class:"factory-list-content"},ne=["onClick"],oe={class:"factory-name"},le={class:"factory-data"},ie={class:"progress-bar"},re={class:"progress-text"},ce={class:"progress-bar"},de={class:"progress-text"},ue={class:"status-indicator"},fe={class:"panel-container"},he={class:"panel-title"},me={class:"key-indicators"},pe={class:"indicators-grid"},ve={class:"indicator-icon"},_e={class:"indicator-content"},ge={class:"indicator-value-line"},ye={class:"indicator-value"},be={class:"indicator-unit"},Ce={class:"indicator-name"},we={class:"center-panel"},De={class:"panel-container cost-chart-container"},Se={class:"chart-header"},Re={class:"chart-title"},Te={class:"completion-rate"},xe={class:"chart-content"},ke={class:"cost-legend"},Ue={class:"legend-text"},Me={class:"panel-container data-table-container"},ze={class:"panel-title"},Le={class:"table-wrapper"},Fe={key:0,class:"loading-state"},Ie={key:1,class:"error-state"},Pe={class:"right-panel"},Ne={class:"panel-container analysis-table-container"},Ae={class:"panel-title"},Be={class:"table-wrapper"},Oe={class:"panel-container trend-container"},Ve={class:"panel-title"},We={class:"trend-value"},$e={class:"panel-container production-table-container"},Ee={class:"panel-title"},He={class:"table-wrapper"},Ke={class:"completion-notice"},Ye=yt({__name:"index",setup(a){const s=u([]),p=u(null),f=u(null),r=u(null),S=u(!1),y=u(null),R=u("2025.03.12"),H=u("16:45"),I=u(702),U=u(null),P=u(!1),k=u(null),et=u(.3),N=u(null),A=u(null);let b=null,C=null;const M=(t,i)=>i==="actual"?t.progressPercentage||Math.min(t.amtUnitReal/200*100,100):t.standardPercentage||85,T=t=>t.toLocaleString(),at=t=>`${(t*100).toFixed(2)}%`,st=(t,i,d=!1)=>{const _=G(t.amtUnitDiffRate),o=d?at(t[i]):T(t[i]);return g("div",{class:"status-cell"},[g("span",{class:["status-light",_]}),g("span",{style:"margin-left: 4px; color: #fff;"},o)])},K=(t,i)=>{const d=G(t.amtUnitDiffRate);return g("div",{class:"status-cell"},[g("span",{class:"cost-value",style:"color: #40a9f3; font-weight: bold; font-size: 11px;"},T(t[i]||0)),g("span",{class:["status-light",d]})])},nt=x(()=>[...s.value,...s.value]),ot=x(()=>s.value),lt=x(()=>s.value),it=x(()=>s.value),rt=x(()=>Pt(f.value)),w=x(()=>Nt(r.value)),ct=[{title:"厂别",key:"costCenterDesc",width:140,ellipsis:{tooltip:!0}},{title:"产量",key:"wgt",width:90,render:t=>T(t.wgt||0)},{title:"综合成本",key:"amtReal",width:100,render:t=>T(t.amtReal||0)},{title:"综合单本",key:"amtUnitReal",width:90,render:t=>(t.amtUnitReal||0).toFixed(2)},{title:"标准成本",key:"amtStandard",width:100,render:t=>T(t.amtStandard||0)},{title:"偏差",key:"amtUnitDiff",width:70,render:t=>(t.amtUnitDiff||0).toFixed(2)},{title:"偏差率",key:"amtUnitDiffRate",width:80,render:t=>st(t,"amtUnitDiffRate",!0)}],dt=[{title:"分厂",key:"costCenterDesc",width:80,ellipsis:{tooltip:!0},render:t=>g("span",{style:"color: #fff; font-size: 11px;"},t.costCenterDesc)},{title:"环比",key:"mom",width:55,render:t=>g("span",{style:"color: #fff; font-size: 11px;"},`${(t.mom||0).toFixed(1)}%`)},{title:"同比",key:"yoy",width:55,render:t=>g("span",{style:"color: #fff; font-size: 11px;"},`${(t.yoy||0).toFixed(1)}%`)},{title:"综合单本",key:"amtUnitReal",minWidth:75,render:t=>K(t,"amtUnitReal")}],ut=[{title:"分厂",key:"costCenterDesc",minWidth:80,ellipsis:{tooltip:!0},render:t=>g("span",{style:"color: #fff; font-size: 11px;"},t.costCenterDesc)},{title:"计划产量",key:"wgt",minWidth:70,render:t=>K(t,"wgt")},{title:"计划偏差",key:"wgtDiff",minWidth:60,render:t=>g("span",{style:"color: #fff; font-size: 11px;"},T(t.wgtDiff||0))}],Y=()=>{b?.resize(),C?.resize()},j=()=>{const t=new Date;R.value=t.toLocaleDateString("zh-CN").replace(/\//g,"."),H.value=t.toLocaleTimeString("zh-CN",{hour12:!1})},ft=t=>{p.value=t,vt(t),Promise.all([mt(t),pt(t)])},B=async(t,i,d)=>{try{return i.value=!0,await t()}catch(_){return d?d(_):null}finally{i.value=!1}},ht=async()=>{const t=await B(Bt,S,()=>[]);t&&(s.value=t)},mt=async t=>{const i=u(!1),d=await B(()=>Ot(t),i,()=>({wgtDiffRate:0,amtUnitDiffRate:0,amtUnitDiff:0}));d&&(f.value=d)},pt=async t=>{const i=u(!1),d=await B(()=>Vt(t),i);d&&(r.value=d)},z={start(){if(!U.value||k.value||s.value.length===0)return;const t=U.value,d=s.value.length*42;if(t.scrollHeight<=t.clientHeight)return;const _=()=>{P.value||(t.scrollTop+=et.value,t.scrollTop>=d&&(t.scrollTop=0))};k.value=setInterval(_,20)},pause(){P.value=!0},resume(){P.value=!1},stop(){k.value&&(clearInterval(k.value),k.value=null)}},J=z.pause,Q=z.resume,vt=t=>{if(b&&t){const i=t.amtUnitReal||0,d=[{value:i*.6,name:"原材料消耗成本",itemStyle:{color:"#ff6b6b"}},{value:i*.15,name:"人工成本",itemStyle:{color:"#4ecdc4"}},{value:i*.15,name:"能耗",itemStyle:{color:"#45b7d1"}},{value:i*.1,name:"制造费用",itemStyle:{color:"#f9ca24"}}].filter(_=>_.value>0);b.setOption({series:[{data:d}]})}},_t=()=>{if(C){const t=tt(w.value);C.setOption(t),w.value.length>0&&(I.value=Math.round(w.value[w.value.length-1].value))}},gt=()=>{N.value&&(b=X(N.value),b.setOption(Wt($t()))),A.value&&(C=X(A.value),C.setOption(tt(w.value)),w.value.length>0&&(I.value=Math.round(w.value[w.value.length-1].value)))};return bt(r,t=>{t&&_t()},{deep:!0}),Ct(async()=>{j(),setInterval(j,1e3),await ht(),wt(()=>{gt(),setTimeout(()=>{U.value&&s.value.length>0&&z.start()},800),window.addEventListener("resize",Y)})}),Dt(()=>{z.stop(),b&&(b.dispose(),b=null),C&&(C.dispose(),C=null),window.removeEventListener("resize",Y)}),(t,i)=>{const d=xt,_=kt;return h(),m("div",Et,[e("div",Ht,[e("h1",null,l(n(v).title),1),e("div",Kt,[e("span",Yt,l(n(v).headerInfo.datePrefix)+" "+l(n(R)),1),e("span",jt,l(n(H)),1),e("span",Jt,l(n(v).headerInfo.temperature),1)])]),e("div",Qt,[e("div",Xt,[e("div",Zt,[e("div",qt,l(n(v).panels.factoryTitle),1),e("div",Gt,[e("div",te,l(n(q).name),1),e("div",ee,[(h(!0),m(L,null,F(n(q).labels,o=>(h(),m("span",{key:o,class:"progress-label"},l(o),1))),128))])]),e("div",{ref_key:"factoryListRef",ref:U,class:"factory-list",onMouseenter:i[0]||(i[0]=(...o)=>n(J)&&n(J)(...o)),onMouseleave:i[1]||(i[1]=(...o)=>n(Q)&&n(Q)(...o))},[n(s).length===0?(h(),m("div",ae," 暂无数据 ")):(h(),m("div",se,[(h(!0),m(L,null,F(n(nt),(o,O)=>(h(),m("div",{key:`${o.costCenterDesc}-${O}`,class:St(["factory-item",{active:n(p)?.costCenter===o.costCenter}]),onClick:je=>ft(o)},[V(d,{disabled:o.costCenterDesc.length<=8,placement:"right"},{trigger:Z(()=>[e("div",oe,l(o.costCenterDesc),1)]),default:Z(()=>[Rt(" "+l(o.costCenterDesc),1)]),_:2},1032,["disabled"]),e("div",le,[e("div",ie,[e("div",{class:"progress-fill",style:W({width:M(o,"actual")+"%"})},[e("span",re,l(M(o,"actual"))+"%",1)],4)]),e("div",ce,[e("div",{class:"progress-fill cyan",style:W({width:M(o,"standard")+"%"})},[e("span",de,l(M(o,"standard"))+"%",1)],4)]),e("span",ue,l(o.amtUnitDiff.toFixed(2)),1)])],10,ne))),128))]))],544)]),e("div",fe,[e("div",he,l(n(v).panels.keyIndicatorsTitle),1),e("div",me,[e("div",pe,[(h(!0),m(L,null,F(n(rt),(o,O)=>(h(),m("div",{key:O,class:"indicator-card"},[e("div",ve,l(o.icon),1),e("div",_e,[e("div",ge,[e("div",ye,l(o.value),1),e("div",be,l(o.unit),1)]),e("div",Ce,l(o.name),1)])]))),128))])])])]),e("div",we,[e("div",De,[e("div",Se,[e("span",Re,l(n(v).panels.costChartTitle),1),e("span",Te,l(n(v).panels.costChartSubtitle),1)]),e("div",xe,[e("div",{ref_key:"costChart",ref:N,class:"cost-chart"},null,512),e("div",ke,[(h(!0),m(L,null,F(n(Mt),o=>(h(),m("div",{key:o.label,class:"legend-item"},[e("div",{class:"legend-color",style:W({background:o.color})},null,4),e("span",Ue,l(o.label),1)]))),128))])])]),e("div",Me,[e("div",ze,l(n(v).panels.dataTableTitle),1),e("div",Le,[n(S)?(h(),m("div",Fe,"数据加载中...")):n(y)?(h(),m("div",Ie," 数据加载失败: "+l(n(y).message||n(y)),1)):(h(),Tt(_,{key:2,columns:ct,data:n(ot),bordered:!1,"single-line":!1,size:"small","scroll-x":800,"max-height":"290","virtual-scroll":"",striped:""},null,8,["data"]))])])]),e("div",Pe,[e("div",Ne,[e("div",Ae,l(n(v).panels.analysisTableTitle),1),e("div",Be,[V(_,{columns:dt,data:n(lt),bordered:!1,"single-line":!1,size:"small","max-height":"190"},null,8,["data"])])]),e("div",Oe,[e("div",Ve,l(n(v).panels.trendChartTitle),1),e("div",{ref_key:"trendChart",ref:A,class:"trend-chart"},null,512),e("div",We,l(n(I)),1)]),e("div",$e,[e("div",Ee,l(n(v).panels.productionTableTitle),1),e("div",He,[V(_,{columns:ut,data:n(it),bordered:!1,"single-line":!1,size:"small","max-height":"190"},null,8,["data"])]),e("div",Ke,l(n(v).panels.productionNotice),1)])])])])}}}),qe=Ut(Ye,[["__scopeId","data-v-10ff2ce0"]]);export{qe as default};
