import m from"./index-DP8QyUpt.js";import{R as J,P as N,aH as O,S as X,aI as Z,U as ee}from"./ui-vendor-lRdd6BJd.js";import{k as te,r as k,c as b,Q as E,R as h,Y as C,V as B,_ as w,U as u,S as y,a3 as ne,K as g,q as ae,j as P,$ as A,m as s}from"./vue-vendor-Bom1XEVO.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconify-W0kOH8CK.js";import"./index-Chx56wke.js";const le={class:"c-tree"},ie={key:0,class:"c-tree-toolbar"},de={class:"toolbar-left"},se={class:"toolbar-right"},re={class:"c-tree-container"},ce=te({__name:"index",props:{data:{},mode:{default:"custom"},keyField:{default:"id"},labelField:{default:"name"},childrenField:{default:"children"},searchPattern:{default:""},searchable:{type:Boolean,default:!0},searchPlaceholder:{default:"搜索..."},draggable:{type:Boolean,default:!1},showLine:{type:Boolean,default:!0},showToolbar:{type:Boolean,default:!0},addable:{type:Boolean,default:!0},addText:{default:"新增"},refreshable:{type:Boolean,default:!0},iconField:{default:"icon"},iconConfig:{default:()=>({default:"mdi:circle-outline",typeMap:{},colorMap:{}})},statusConfigs:{default:()=>[]},actions:{default:()=>[]},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{default:()=>[]},defaultSelectedKeys:{default:()=>[]}},emits:["node-select","node-action","node-drop","add","refresh"],setup(i,{expose:M,emit:T}){const I={menu:{draggable:!0,showLine:!0,iconConfig:{typeMap:{directory:"mdi:folder",menu:"mdi:file-document",button:"mdi:button-cursor"}},actions:[{key:"add",text:"新增子菜单",icon:"mdi:plus",type:"primary"},{key:"edit",text:"编辑",icon:"mdi:pencil",type:"info"},{key:"delete",text:"删除",icon:"mdi:delete",type:"error",confirm:"确认删除该菜单吗？"}]},file:{draggable:!1,showLine:!1,iconConfig:{typeMap:{folder:"mdi:folder",file:"mdi:file-document",image:"mdi:file-image",video:"mdi:file-video",audio:"mdi:file-music"}},actions:[{key:"open",text:"打开",icon:"mdi:folder-open",type:"primary"},{key:"rename",text:"重命名",icon:"mdi:rename-box",type:"info"},{key:"delete",text:"删除",icon:"mdi:delete",type:"error",confirm:"确认删除该文件吗？"}]},org:{draggable:!1,showLine:!0,iconConfig:{typeMap:{department:"mdi:domain",user:"mdi:account",manager:"mdi:account-tie"}},actions:[{key:"add",text:"新增下级",icon:"mdi:plus",type:"primary"},{key:"edit",text:"编辑",icon:"mdi:pencil",type:"info"}]},custom:{}},n=i,f=T,x=k(""),r=k(n.defaultExpandedKeys),p=k(n.defaultSelectedKeys),c=k(n.defaultExpandAll),_=b(()=>{const e=I[n.mode]||{};return{...e,...n,iconConfig:{...e.iconConfig,...n.iconConfig},actions:n.actions?.length?n.actions:e.actions||[]}}),L=b(()=>n.data),U=b(()=>n.searchPattern||x.value),K=b(()=>{if(p.value.length===0)return null;const e=(t,l)=>{for(const o of t){if(o[n.keyField]===l)return o;if(o[n.childrenField]){const a=e(o[n.childrenField],l);if(a)return a}}return null};return e(n.data,p.value[0])}),v=e=>{const t=[];return e.forEach(l=>{t.push(l[n.keyField]),l[n.childrenField]&&t.push(...v(l[n.childrenField]))}),t},V=e=>{const t=_.value.iconConfig;return e[n.iconField||"icon"]?e[n.iconField||"icon"]:e.type&&t.typeMap?.[e.type]?t.typeMap[e.type]:t.default||"mdi:circle-outline"},$=e=>{const t=_.value.iconConfig;return e.type&&t.colorMap?.[e.type]?t.colorMap[e.type]:"currentColor"},D=({option:e})=>{const t=e,l=V(t),o=$(t);return s(m,{name:l,size:18,color:o,class:"mr-3 flex-shrink-0"})},R=({option:e})=>{const t=e,l=n.statusConfigs?.map(o=>{const a=t[o.field],d=o.values[a];return!d||!d.text?null:s(X,{type:d.type,size:"small",class:"ml-2",style:{fontSize:"12px"}},{default:()=>d.text})}).filter(Boolean)||[];return s("div",{class:"flex items-center flex-1 min-w-0 py-1",style:{lineHeight:"1.5"}},[s("span",{class:"mr-3 font-medium text-sm"},t[n.labelField||"name"]),...l])},H=({option:e})=>{const t=e,o=(_.value.actions||[]).filter(a=>!a.show||a.show(t)).map(a=>{const d={size:"tiny",type:a.type||"default",secondary:!0,style:{padding:"4px 6px",minWidth:"24px",height:"24px"},onClick:F=>{F.stopPropagation(),S(a.key,t)}},z=s(m,{name:a.icon,size:12,title:a.text});return a.confirm?s(Z,{onPositiveClick:()=>S(a.key,t)},{trigger:()=>s(N,{...d,onClick:F=>F.stopPropagation()},{icon:()=>z}),default:()=>a.confirm}):s(N,d,{icon:()=>z})});return s("div",{class:"tree-actions",style:{display:"flex",alignItems:"center",marginLeft:"8px",opacity:"0",transition:"opacity 0.2s ease"}},[s(ee,{size:4},{default:()=>o})])},j=()=>{c.value?(r.value=[],c.value=!1):(r.value=v(n.data),c.value=!0)},q=e=>{r.value=e,c.value=e.length===v(n.data).length},Q=e=>{p.value=e,f("node-select",K.value,e)},W=e=>{f("node-drop",e)},S=(e,t)=>{e==="add"?f("add",t):f("node-action",e,t)},Y=()=>{f("add")},G=()=>{f("refresh")};return M({expandAll:()=>{r.value=v(n.data),c.value=!0},collapseAll:()=>{r.value=[],c.value=!1},selectNode:e=>{p.value=[e]},getSelectedNode:()=>K.value,expandedKeys:r,selectedKeys:p}),(e,t)=>{const l=J,o=N,a=O;return h(),E("div",le,[i.showToolbar?(h(),E("div",ie,[B("div",de,[i.searchable?(h(),w(l,{key:0,value:g(x),"onUpdate:value":t[0]||(t[0]=d=>ne(x)?x.value=d:null),placeholder:i.searchPlaceholder,clearable:"",class:"search-input"},{prefix:u(()=>[y(m,{name:"mdi:magnify",size:16})]),_:1},8,["value","placeholder"])):C("",!0)]),B("div",se,[ae(e.$slots,"toolbar-actions",{},()=>[i.addable?(h(),w(o,{key:0,type:"primary",onClick:t[1]||(t[1]=d=>Y())},{icon:u(()=>[y(m,{name:"mdi:plus",size:16})]),default:u(()=>[P(" "+A(i.addText),1)]),_:1})):C("",!0),y(o,{onClick:j},{icon:u(()=>[y(m,{name:"mdi:file-tree",size:16})]),default:u(()=>[P(" "+A(g(c)?"收起全部":"展开全部"),1)]),_:1}),i.refreshable?(h(),w(o,{key:1,onClick:G},{icon:u(()=>[y(m,{name:"mdi:refresh",size:16})]),default:u(()=>[t[2]||(t[2]=P(" 刷新 ",-1))]),_:1})):C("",!0)],!0)])])):C("",!0),B("div",re,[y(a,{data:g(L),pattern:g(U),"expanded-keys":g(r),"selected-keys":g(p),draggable:i.draggable,"show-line":i.showLine,"render-prefix":D,"render-suffix":H,"render-label":R,"key-field":i.keyField,"label-field":i.labelField,"children-field":i.childrenField,"onUpdate:expandedKeys":q,"onUpdate:selectedKeys":Q,onDrop:W,class:"tree-instance"},null,8,["data","pattern","expanded-keys","selected-keys","draggable","show-line","key-field","label-field","children-field"])])])}}}),he=oe(ce,[["__scopeId","data-v-694a3730"]]);export{he as default};
