import Ie from"./index-DP8QyUpt.js";import he from"./index-C2EORnFX.js";import{aA as De,U as Te,R as Ae,P as Le,L as Se,X as $e,T as Ve,Y as Ue,as as Re,S as Pe,aI as Fe,aV as Me,ai as je,ae as Be,J as Oe,K as qe,ag as Ee,V as Ke,I as Ge,ao as Ye}from"./ui-vendor-lRdd6BJd.js";import{k as Je,r as x,e as ee,c as z,o as Qe,Q as te,R as m,S as t,V as Xe,U as e,a3 as ae,K as l,j as i,$ as f,_ as y,Y as g,I as b,F as He,N as We,n as Ze}from"./vue-vendor-Bom1XEVO.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconify-W0kOH8CK.js";import"./index-Chx56wke.js";const tt={name:[{required:!0,message:"请输入名称",trigger:["input","blur"]}],type:[{required:!0,message:"请选择类型",trigger:["change","blur"]}],typeCode:[{required:!0,message:"请输入字典类型编码",trigger:["input","blur"]}],dictLabel:[{required:!0,message:"请输入字典标签",trigger:["input","blur"]}],dictValue:[{required:!0,message:"请输入字典值",trigger:["input","blur"]}],sort:[{required:!0,type:"number",message:"请输入排序号",trigger:["input","blur"]}]},at=[{field:"status",values:{0:{text:"禁用",type:"error"},1:{text:"",type:"success"}}}],R={name:"",type:"type",parentId:null,code:"",value:"",sort:0,status:1,remark:"",typeCode:"",dictLabel:"",dictValue:""},lt=[{id:"user_status",name:"用户状态",type:"type",parentId:null,code:"user_status",typeCode:"user_status",sort:1,status:1,remark:"用户状态字典",children:[{id:"user_status_1",name:"正常",type:"item",parentId:"user_status",code:"normal",value:"1",dictLabel:"正常",dictValue:"1",sort:1,status:1,remark:"用户状态正常"},{id:"user_status_2",name:"禁用",type:"item",parentId:"user_status",code:"disabled",value:"0",dictLabel:"禁用",dictValue:"0",sort:2,status:0,remark:"用户状态禁用"}]},{id:"gender",name:"性别",type:"type",parentId:null,code:"gender",typeCode:"gender",sort:2,status:0,remark:"性别字典",children:[{id:"gender_1",name:"男",type:"item",parentId:"gender",code:"male",value:"1",dictLabel:"男",dictValue:"1",sort:1,status:1,remark:"男性"},{id:"gender_2",name:"女",type:"item",parentId:"gender",code:"female",value:"0",dictLabel:"女",dictValue:"0",sort:2,status:1,remark:"女性"}]}],st=async()=>new Promise(D=>{setTimeout(()=>{D({code:"0",data:lt,msg:"成功"})},500)}),nt=async D=>new Promise(_=>setTimeout(_,500)),ot=async D=>new Promise(_=>setTimeout(_,500)),ut=async D=>new Promise(_=>setTimeout(_,500)),dt=async(D,_)=>new Promise(S=>setTimeout(S,300)),it={class:"dictionary-management"},rt={class:"main-content"},ct=Je({__name:"index",setup(D){const _=De(),S=x(!1),T=x(""),w=x(!1),A=x("add"),K=x(null),P=x(null),le=x([]),L=x([]),$=x(!1),N=ee([]),n=ee({...R}),se=tt,ne=z(()=>A.value==="add"?`新增${n.type==="type"?"字典类型":"字典项"}`:`编辑${n.type==="type"?"字典类型":"字典项"}`),oe=z(()=>at),ue=z(()=>({typeMap:{type:"mdi:folder-table",item:"mdi:tag"},colorMap:{type:"#1890ff",item:"#52c41a"}})),de=z(()=>[{key:"add",text:"新增字典项",icon:"mdi:plus",type:"primary",show:s=>{const a=s;return a.type==="type"&&a.status===1}},{key:"edit",text:"编辑",icon:"mdi:pencil",type:"info"},{key:"toggle",text:"切换状态",icon:"mdi:toggle-switch",type:"warning"},{key:"delete",text:"删除",icon:"mdi:delete",type:"error",confirm:"确认删除该字典吗？"}]),o=z(()=>L.value.length?Q(N,L.value[0]):null),F=z(()=>o.value?.children||[]),V=z(()=>{if(!o.value||o.value.type!=="type")return null;const s=F.value;return{total:s.length,enabled:s.filter(a=>a.status===1).length,disabled:s.filter(a=>a.status===0).length}}),ie=z(()=>N.filter(s=>s.type==="type").map(s=>({label:s.name,value:s.id}))),re=z(()=>{if(!T.value.trim())return N;const s=a=>{const d=a.name.toLowerCase().includes(T.value.toLowerCase()),c=a.children?.map(s).filter(Boolean)||[];return d||c.length>0?{...a,children:c}:null};return N.map(s).filter(Boolean)}),G=s=>s==="type"?"字典类型":"字典项",Y=s=>s==="type"?{icon:"mdi:folder-table",color:"info"}:{icon:"mdi:tag",color:"success"},J=s=>s==="type"?"#1890ff":"#52c41a",Q=(s,a)=>{for(const d of s){if(d.id===a)return d;if(d.children){const c=Q(d.children,a);if(c)return c}}return null},M=(s,a,d)=>{for(let c=0;c<s.length;c++){if(s[c].id===a)return s[c].status=d,!0;if(s[c].children&&M(s[c].children,a,d))return!0}return!1},ce=(s,a)=>{L.value=a.map(d=>String(d))},pe=(s,a)=>{const d=a;switch(s){case"edit":B(d);break;case"delete":H(d.id);break;case"add":j(d.id);break;case"toggle":O(d);break}},me=s=>{const a=s;a?.type==="type"?j(a.id):X()},fe=()=>{$.value?(P.value?.collapseAll(),$.value=!1):(P.value?.expandAll(),$.value=!0)},_e=async()=>{await U(),_.success("刷新成功")},X=s=>{A.value="add",Object.assign(n,R),w.value=!0},j=s=>{A.value="add",Object.assign(n,R),n.type="item",s?n.parentId=s:o.value?.type==="type"&&(n.parentId=o.value.id),w.value=!0},B=s=>{A.value="edit",Object.assign(n,{id:s.id,name:s.name,type:s.type,parentId:s.parentId,code:s.code,value:s.value||"",sort:s.sort,status:s.status,remark:s.remark||"",typeCode:s.typeCode||"",dictLabel:s.dictLabel||"",dictValue:s.dictValue||""}),w.value=!0},H=async s=>{try{await ut(s),_.success("删除成功"),await U()}catch{_.error("删除失败")}},O=async s=>{const a=s.status===1?0:1,d=a===1?"启用":"禁用";try{await dt(s.id,a),_.success(`${d}成功`),M(N,s.id,a),Ze(()=>{o.value?.id===s.id&&(L.value=[...L.value])})}catch{_.error(`${d}失败`)}},ye=async()=>{try{return await K.value?.validate(),n.type==="type"?(n.code=n.typeCode,n.value=""):(n.code=n.dictLabel,n.value=n.dictValue),A.value==="add"?(await nt(n),_.success("添加成功"),await U()):(await ot(n),_.success("修改成功"),n.id&&M(N,n.id,n.status)),w.value=!1,!0}catch(s){return s instanceof Array||_.error("保存失败"),!1}},ge=()=>{w.value=!1,Object.assign(n,R)},U=async()=>{S.value=!0;try{const s=await st();N.length=0,N.push(...s.data)}catch{_.error("加载字典失败")}finally{S.value=!1}};return Qe(()=>{U()}),(s,a)=>{const d=Ie,c=Ae,k=Le,r=Te,I=Se,v=$e,p=Re,h=Pe,ve=Ve,q=Ue,be=Fe,E=Me,W=qe,ke=Oe,C=Be,Ce=Ee,xe=Ke,ze=Ge,we=je,Ne=Ye;return m(),te("div",it,[t(I,{class:"header-card"},{default:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(c,{value:l(T),"onUpdate:value":a[0]||(a[0]=u=>ae(T)?T.value=u:null),placeholder:"搜索字典名称",clearable:"",style:{width:"300px"}},{prefix:e(()=>[t(d,{name:"mdi:magnify",size:16})]),_:1},8,["value"]),t(r,null,{default:e(()=>[t(k,{type:"primary",onClick:a[1]||(a[1]=u=>X())},{icon:e(()=>[t(d,{name:"mdi:plus",size:16})]),default:e(()=>[a[14]||(a[14]=i(" 新增字典类型 ",-1))]),_:1}),t(k,{onClick:fe},{icon:e(()=>[t(d,{name:"mdi:file-tree",size:16})]),default:e(()=>[i(" "+f(l($)?"收起全部":"展开全部"),1)]),_:1}),t(k,{onClick:_e},{icon:e(()=>[t(d,{name:"mdi:refresh",size:16})]),default:e(()=>[a[15]||(a[15]=i(" 刷新 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),Xe("div",rt,[t(q,{cols:24,"x-gap":16,responsive:"screen"},{default:e(()=>[t(v,{span:8,md:12,sm:24},{default:e(()=>[t(I,{title:"数据字典",class:"content-card"},{default:e(()=>[t(he,{ref_key:"treeRef",ref:P,mode:"custom",data:l(re),"search-pattern":l(T),searchable:!1,"show-toolbar":!1,"status-configs":l(oe),"icon-config":l(ue),actions:l(de),"default-expanded-keys":l(le),"default-selected-keys":l(L),onNodeSelect:ce,onNodeAction:pe,onAdd:me,class:"dict-tree"},null,8,["data","search-pattern","status-configs","icon-config","actions","default-expanded-keys","default-selected-keys"])]),_:1})]),_:1}),t(v,{span:16,md:12,sm:24},{default:e(()=>[t(I,{class:"content-card"},{header:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{class:b({"disabled-text":l(o)&&l(o).status===0})},{default:e(()=>[i(f(l(o)?`${G(l(o).type)} - ${l(o).name}`:"选择字典查看详情"),1)]),_:1},8,["class"]),l(o)&&l(o).status===0?(m(),y(h,{key:0,type:"error",size:"small"},{icon:e(()=>[t(d,{name:"mdi:pause-circle",size:10})]),default:e(()=>[a[16]||(a[16]=i(" 已禁用 ",-1))]),_:1})):g("",!0)]),_:1}),t(r,null,{default:e(()=>[l(o)?(m(),y(k,{key:0,size:"small",onClick:a[2]||(a[2]=u=>B(l(o)))},{icon:e(()=>[t(d,{name:"mdi:pencil",size:14})]),default:e(()=>[a[17]||(a[17]=i(" 编辑 ",-1))]),_:1})):g("",!0),l(o)?(m(),y(k,{key:1,size:"small",type:l(o).status===1?"warning":"success",onClick:a[3]||(a[3]=u=>O(l(o)))},{icon:e(()=>[t(d,{name:l(o).status===1?"mdi:pause":"mdi:play",size:14},null,8,["name"])]),default:e(()=>[i(" "+f(l(o).status===1?"禁用":"启用"),1)]),_:1},8,["type"])):g("",!0)]),_:1})]),_:1})]),default:e(()=>[l(o)?(m(),y(r,{key:1,vertical:"",size:24},{default:e(()=>[t(I,{title:"基本信息",size:"small"},{default:e(()=>[t(q,{cols:2,"x-gap":16,"y-gap":12},{default:e(()=>[t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[18]||(a[18]=[i("名称：",-1)])]),_:1}),t(p,{class:b({"disabled-text":l(o).status===0})},{default:e(()=>[i(f(l(o).name),1)]),_:1},8,["class"])]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[19]||(a[19]=[i("类型：",-1)])]),_:1}),t(h,{type:Y(l(o).type).color,size:"small",class:b({"disabled-tag":l(o).status===0})},{icon:e(()=>[t(d,{name:Y(l(o).type).icon,size:12,color:l(o).status===0?"#d9d9d9":J(l(o).type)},null,8,["name","color"])]),default:e(()=>[i(" "+f(G(l(o).type)),1)]),_:1},8,["type","class"])]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[20]||(a[20]=[i("编码：",-1)])]),_:1}),t(h,{type:"info",size:"small",class:b({"disabled-tag":l(o).status===0})},{default:e(()=>[i(f(l(o).code),1)]),_:1},8,["class"])]),_:1})]),_:1}),l(o).value?(m(),y(v,{key:0},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[21]||(a[21]=[i("字典值：",-1)])]),_:1}),t(h,{type:"success",size:"small",class:b({"disabled-tag":l(o).status===0})},{default:e(()=>[i(f(l(o).value),1)]),_:1},8,["class"])]),_:1})]),_:1})):g("",!0),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[22]||(a[22]=[i("排序：",-1)])]),_:1}),t(p,{class:b({"disabled-text":l(o).status===0})},{default:e(()=>[i(f(l(o).sort),1)]),_:1},8,["class"])]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[23]||(a[23]=[i("状态：",-1)])]),_:1}),t(h,{type:l(o).status===1?"success":"error",size:"small"},{icon:e(()=>[t(d,{name:l(o).status===1?"mdi:check-circle":"mdi:pause-circle",size:10},null,8,["name"])]),default:e(()=>[i(" "+f(l(o).status===1?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1})]),_:1}),l(o).type==="type"&&l(F).length>0?(m(),y(I,{key:0,size:"small"},{header:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(p,null,{default:e(()=>[...a[24]||(a[24]=[i("字典项",-1)])]),_:1}),l(o).status===1?(m(),y(k,{key:0,size:"small",type:"primary",onClick:j},{icon:e(()=>[t(d,{name:"mdi:plus",size:14})]),default:e(()=>[a[25]||(a[25]=i(" 添加字典项 ",-1))]),_:1})):g("",!0)]),_:1})]),default:e(()=>[t(r,{vertical:"",size:12},{default:e(()=>[(m(!0),te(He,null,We(l(F),u=>(m(),y(I,{key:u.id,size:"small",hoverable:"",class:b({"disabled-item":u.status===0})},{default:e(()=>[t(r,{justify:"space-between",align:"center"},{default:e(()=>[t(r,{vertical:"",size:6},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(d,{name:"mdi:tag",size:16,color:u.status===0?"#d9d9d9":J("item")},null,8,["color"]),t(p,{strong:"",class:b({"disabled-text":u.status===0})},{default:e(()=>[i(f(u.name),1)]),_:2},1032,["class"]),t(h,{type:u.status===1?"success":"error",size:"tiny"},{icon:e(()=>[t(d,{name:u.status===1?"mdi:check-circle":"mdi:pause-circle",size:10},null,8,["name"])]),default:e(()=>[i(" "+f(u.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:2},1024),t(r,{align:"center"},{default:e(()=>[t(p,{depth:"3"},{default:e(()=>[...a[26]||(a[26]=[i("值:",-1)])]),_:1}),t(h,{size:"small",type:"info",class:b({"disabled-tag":u.status===0})},{default:e(()=>[i(f(u.value),1)]),_:2},1032,["class"]),t(p,{depth:"3"},{default:e(()=>[...a[27]||(a[27]=[i("编码:",-1)])]),_:1}),t(h,{size:"small",type:"default",class:b({"disabled-tag":u.status===0})},{default:e(()=>[i(f(u.code),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),t(r,null,{default:e(()=>[t(k,{size:"tiny",onClick:Z=>B(u)},{icon:e(()=>[t(d,{name:"mdi:pencil",size:12,title:"编辑"})]),_:1},8,["onClick"]),t(k,{size:"tiny",type:u.status===1?"warning":"success",onClick:Z=>O(u)},{icon:e(()=>[t(d,{name:u.status===1?"mdi:pause":"mdi:play",size:12,title:u.status===1?"禁用":"启用"},null,8,["name","title"])]),_:2},1032,["type","onClick"]),t(be,{onPositiveClick:Z=>H(u.id)},{trigger:e(()=>[t(k,{size:"tiny",type:"error"},{icon:e(()=>[t(d,{name:"mdi:delete",size:12,title:"删除"})]),_:1})]),default:e(()=>[a[28]||(a[28]=i(" 确认删除该字典项吗？ ",-1))]),_:1},8,["onPositiveClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})):g("",!0),l(o).type==="type"&&l(V)?(m(),y(I,{key:1,title:"统计信息",size:"small"},{default:e(()=>[t(q,{cols:3,"x-gap":16},{default:e(()=>[t(v,null,{default:e(()=>[t(E,{label:"字典项总数"},{default:e(()=>[t(p,{style:{"font-size":"28px","font-weight":"bold",color:"#52c41a"}},{default:e(()=>[i(f(l(V).total),1)]),_:1})]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(E,{label:"启用"},{default:e(()=>[t(p,{style:{"font-size":"28px","font-weight":"bold",color:"#52c41a"}},{default:e(()=>[i(f(l(V).enabled),1)]),_:1})]),_:1})]),_:1}),t(v,null,{default:e(()=>[t(E,{label:"禁用"},{default:e(()=>[t(p,{style:{"font-size":"28px","font-weight":"bold",color:"#ff4d4f"}},{default:e(()=>[i(f(l(V).disabled),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),l(o).remark?(m(),y(I,{key:2,title:"备注信息",size:"small"},{default:e(()=>[t(p,null,{default:e(()=>[i(f(l(o).remark),1)]),_:1})]),_:1})):g("",!0)]),_:1})):(m(),y(ve,{key:0,description:"请从左侧选择一个字典项查看详细信息",class:"mt-80px"},{icon:e(()=>[t(d,{name:"mdi:book-open-variant",size:72,class:"mt--80px"})]),_:1}))]),_:1})]),_:1})]),_:1})]),t(Ne,{show:l(w),"onUpdate:show":a[13]||(a[13]=u=>ae(w)?w.value=u:null),preset:"dialog",title:l(ne),"positive-text":l(A)==="add"?"确认添加":"确认修改","negative-text":"取消",onPositiveClick:ye,onNegativeClick:ge,style:{width:"600px"}},{default:e(()=>[t(we,{ref_key:"formRef",ref:K,model:l(n),rules:l(se),"label-placement":"left","label-width":"100px"},{default:e(()=>[t(C,{label:"类型",path:"type"},{default:e(()=>[t(ke,{value:l(n).type,"onUpdate:value":a[4]||(a[4]=u=>l(n).type=u)},{default:e(()=>[t(W,{value:"type"},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(d,{name:"mdi:folder-table",size:16,color:"#1890ff",class:"vertical-middle"}),t(p,null,{default:e(()=>[...a[29]||(a[29]=[i("字典类型",-1)])]),_:1})]),_:1})]),_:1}),t(W,{value:"item"},{default:e(()=>[t(r,{align:"center"},{default:e(()=>[t(d,{name:"mdi:tag",size:16,color:"#52c41a",class:"vertical-middle"}),t(p,null,{default:e(()=>[...a[30]||(a[30]=[i("字典项",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),t(C,{label:"名称",path:"name"},{default:e(()=>[t(c,{value:l(n).name,"onUpdate:value":a[5]||(a[5]=u=>l(n).name=u),placeholder:"请输入名称"},null,8,["value"])]),_:1}),l(n).type==="item"?(m(),y(C,{key:0,label:"所属字典类型",path:"parentId"},{default:e(()=>[t(Ce,{value:l(n).parentId,"onUpdate:value":a[6]||(a[6]=u=>l(n).parentId=u),options:l(ie),placeholder:"请选择字典类型",clearable:""},null,8,["value","options"])]),_:1})):g("",!0),l(n).type==="type"?(m(),y(C,{key:1,label:"类型编码",path:"typeCode"},{default:e(()=>[t(c,{value:l(n).typeCode,"onUpdate:value":a[7]||(a[7]=u=>l(n).typeCode=u),placeholder:"请输入类型编码，如：user_status"},null,8,["value"])]),_:1})):g("",!0),l(n).type==="item"?(m(),y(C,{key:2,label:"字典标签",path:"dictLabel"},{default:e(()=>[t(c,{value:l(n).dictLabel,"onUpdate:value":a[8]||(a[8]=u=>l(n).dictLabel=u),placeholder:"请输入字典标签"},null,8,["value"])]),_:1})):g("",!0),l(n).type==="item"?(m(),y(C,{key:3,label:"字典值",path:"dictValue"},{default:e(()=>[t(c,{value:l(n).dictValue,"onUpdate:value":a[9]||(a[9]=u=>l(n).dictValue=u),placeholder:"请输入字典值"},null,8,["value"])]),_:1})):g("",!0),t(C,{label:"排序号",path:"sort"},{default:e(()=>[t(xe,{value:l(n).sort,"onUpdate:value":a[10]||(a[10]=u=>l(n).sort=u),placeholder:"排序号",min:0,max:9999,style:{width:"100%"}},null,8,["value"])]),_:1}),t(C,{label:"状态",path:"status"},{default:e(()=>[t(ze,{value:l(n).status,"onUpdate:value":a[11]||(a[11]=u=>l(n).status=u),"checked-value":1,"unchecked-value":0},{checked:e(()=>[...a[31]||(a[31]=[i("启用",-1)])]),unchecked:e(()=>[...a[32]||(a[32]=[i("禁用",-1)])]),_:1},8,["value"])]),_:1}),t(C,{label:"备注",path:"remark"},{default:e(()=>[t(c,{value:l(n).remark,"onUpdate:value":a[12]||(a[12]=u=>l(n).remark=u),type:"textarea",placeholder:"请输入备注信息",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show","title","positive-text"])])}}}),bt=et(ct,[["__scopeId","data-v-401f92c5"]]);export{bt as default};
