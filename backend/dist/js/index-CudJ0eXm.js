import et from"./index-BrNtnUIZ.js";import{k as tt,r as y,e as I,c as O,m as d,o as st,Q as C,R as c,S as i,V as ye,U as a,aD as nt,K as n,j as g,$ as w,Y as X,_ as k,F as E,N as F,a7 as ge,s as fe,a3 as P,I as at}from"./vue-vendor-Bom1XEVO.js";import z from"./index-DP8QyUpt.js";import it from"./index-gzm7A0xy.js";import{aA as ot,S as x,R as ee,ag as he,V as rt,I as lt,a2 as mt,U as ve,P as ke,L as pt,at as dt,as as ut,ad as ct,aD as _t,aE as yt,ac as gt,ai as ft,Y as ht,X as vt,ae as kt,ao as bt,K as wt,aF as xt}from"./ui-vendor-D9aA433m.js";import{_ as Nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./iconify-W0kOH8CK.js";import"./index-Chx56wke.js";import"./charts-vendor-PiKWrtPe.js";import"./TableEditModal-Dtq4AZzf.js";import"./index.vue_vue_type_script_setup_true_lang-BnsbD_S9.js";import"./index-ikUMOiiF.js";import"./editor-vendor-CufumsHQ.js";import"./index-DecMlK-y.js";import"./spline-vendor-C3Tmx0e7.js";import"./data-Cv884YeX.js";const K={search:"mdi:magnify",plus:"mdi:plus",refresh:"mdi:refresh",toggle:"mdi:toggle-switch",delete:"mdi:delete",edit:"mdi:pencil",eye:"mdi:eye",pause:"mdi:pause",play:"mdi:play",permission:"mdi:shield-account",users:"mdi:account-group"},q={1:{text:"正常",type:"success",icon:"mdi:check-circle"},0:{text:"禁用",type:"error",icon:"mdi:pause-circle"}},B={system:{text:"系统",type:"error",icon:"mdi:cog"},custom:{text:"自定义",type:"info",icon:"mdi:account-key"},temp:{text:"临时",type:"warning",icon:"mdi:clock"}},te={roleType:[{label:"系统角色",value:"system"},{label:"自定义角色",value:"custom"},{label:"临时角色",value:"temp"}],roleStatus:[{label:"正常",value:1},{label:"禁用",value:0}],permissionType:[{label:"菜单权限",value:"menu"},{label:"按钮权限",value:"button"},{label:"API权限",value:"api"}]},Tt={name:[{required:!0,message:"请输入角色名称",trigger:["input","blur"]},{min:2,max:50,message:"角色名称长度在 2 到 50 个字符",trigger:["input","blur"]}],code:[{required:!0,message:"请输入角色编码",trigger:["input","blur"]},{min:2,max:50,message:"角色编码长度在 2 到 50 个字符",trigger:["input","blur"]},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"角色编码必须以字母开头，只能包含字母、数字和下划线",trigger:["input","blur"]}],type:[{required:!0,message:"请选择角色类型",trigger:["change","blur"]}],sort:[{required:!0,message:"请输入排序值",trigger:["input","blur"]},{type:"number",min:0,max:9999,message:"排序值必须在 0 到 9999 之间",trigger:["input","blur"]}]},se={name:"",code:"",type:"custom",status:1,description:"",permissionIds:[],sort:0,remark:""},be=[{id:"perm_1",name:"系统管理",code:"system",type:"menu",parentId:null,path:"/system",icon:"mdi:cog",sort:1,status:1,children:[{id:"perm_1_1",name:"用户管理",code:"system:user",type:"menu",parentId:"perm_1",path:"/system/user",icon:"mdi:account",sort:1,status:1,children:[{id:"perm_1_1_1",name:"新增用户",code:"system:user:add",type:"button",parentId:"perm_1_1",icon:"mdi:plus",sort:1,status:1},{id:"perm_1_1_2",name:"编辑用户",code:"system:user:edit",type:"button",parentId:"perm_1_1",icon:"mdi:pencil",sort:2,status:1},{id:"perm_1_1_3",name:"删除用户",code:"system:user:delete",type:"button",parentId:"perm_1_1",icon:"mdi:delete",sort:3,status:1}]},{id:"perm_1_2",name:"角色管理",code:"system:role",type:"menu",parentId:"perm_1",path:"/system/role",icon:"mdi:account-key",sort:2,status:1,children:[{id:"perm_1_2_1",name:"新增角色",code:"system:role:add",type:"button",parentId:"perm_1_2",icon:"mdi:plus",sort:1,status:1},{id:"perm_1_2_2",name:"编辑角色",code:"system:role:edit",type:"button",parentId:"perm_1_2",icon:"mdi:pencil",sort:2,status:1},{id:"perm_1_2_3",name:"删除角色",code:"system:role:delete",type:"button",parentId:"perm_1_2",icon:"mdi:delete",sort:3,status:1}]}]},{id:"perm_2",name:"内容管理",code:"content",type:"menu",parentId:null,path:"/content",icon:"mdi:file-document",sort:2,status:1,children:[{id:"perm_2_1",name:"文章管理",code:"content:article",type:"menu",parentId:"perm_2",path:"/content/article",icon:"mdi:file-document-edit",sort:1,status:1,children:[{id:"perm_2_1_1",name:"发布文章",code:"content:article:publish",type:"button",parentId:"perm_2_1",icon:"mdi:publish",sort:1,status:1},{id:"perm_2_1_2",name:"编辑文章",code:"content:article:edit",type:"button",parentId:"perm_2_1",icon:"mdi:pencil",sort:2,status:1}]}]},{id:"perm_3",name:"数据统计",code:"analytics",type:"menu",parentId:null,path:"/analytics",icon:"mdi:chart-line",sort:3,status:1,children:[{id:"perm_3_1",name:"查看报表",code:"analytics:report:view",type:"button",parentId:"perm_3",icon:"mdi:eye",sort:1,status:1},{id:"perm_3_2",name:"导出数据",code:"analytics:data:export",type:"button",parentId:"perm_3",icon:"mdi:download",sort:2,status:1}]}],$=[{id:"role_1",name:"超级管理员",code:"super_admin",type:"system",status:1,description:"系统超级管理员，拥有所有权限",permissionIds:["perm_1","perm_1_1","perm_1_1_1","perm_1_1_2","perm_1_1_3","perm_1_2","perm_1_2_1","perm_1_2_2","perm_1_2_3","perm_2","perm_2_1","perm_2_1_1","perm_2_1_2","perm_3","perm_3_1","perm_3_2"],permissionNames:["系统管理","用户管理","新增用户","编辑用户","删除用户","角色管理","新增角色","编辑角色","删除角色","内容管理","文章管理","发布文章","编辑文章","数据统计","查看报表","导出数据"],userCount:1,sort:1,createTime:"2024-01-01 09:00:00",updateTime:"2024-01-15 14:30:00",remark:"系统内置角色，不可删除"},{id:"role_2",name:"系统管理员",code:"admin",type:"system",status:1,description:"系统管理员，拥有系统管理权限",permissionIds:["perm_1","perm_1_1","perm_1_1_1","perm_1_1_2","perm_1_2","perm_1_2_1","perm_1_2_2"],permissionNames:["系统管理","用户管理","新增用户","编辑用户","角色管理","新增角色","编辑角色"],userCount:3,sort:2,createTime:"2024-01-02 09:00:00",updateTime:"2024-01-10 16:20:00",remark:"系统管理员角色"},{id:"role_3",name:"内容编辑员",code:"editor",type:"custom",status:1,description:"内容编辑员，负责内容管理",permissionIds:["perm_2","perm_2_1","perm_2_1_1","perm_2_1_2"],permissionNames:["内容管理","文章管理","发布文章","编辑文章"],userCount:8,sort:3,createTime:"2024-01-03 09:00:00",updateTime:"2024-01-12 11:10:00"},{id:"role_4",name:"数据分析师",code:"analyst",type:"custom",status:1,description:"数据分析师，查看统计数据",permissionIds:["perm_3","perm_3_1","perm_3_2"],permissionNames:["数据统计","查看报表","导出数据"],userCount:5,sort:4,createTime:"2024-01-04 09:00:00",updateTime:"2024-01-08 13:45:00"},{id:"role_5",name:"测试角色",code:"test_role",type:"temp",status:0,description:"临时测试角色",permissionIds:[],permissionNames:[],userCount:0,sort:5,createTime:"2024-01-06 09:00:00",remark:"测试用角色，已禁用"}],It=[{id:"user_1",username:"admin",nickname:"超级管理员",email:"admin@example.com",phone:"13800138000",deptName:"技术部",status:1,createTime:"2024-01-01 09:00:00"},{id:"user_2",username:"manager1",nickname:"系统管理员1",email:"manager1@example.com",phone:"13800138001",deptName:"管理部",status:1,createTime:"2024-01-02 09:00:00"},{id:"user_3",username:"manager2",nickname:"系统管理员2",email:"manager2@example.com",phone:"13800138002",deptName:"管理部",status:1,createTime:"2024-01-02 10:00:00"},{id:"user_4",username:"manager3",nickname:"系统管理员3",email:"manager3@example.com",deptName:"管理部",status:1,createTime:"2024-01-02 11:00:00"},{id:"user_5",username:"editor1",nickname:"编辑员1",email:"editor1@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 09:00:00"},{id:"user_6",username:"editor2",nickname:"编辑员2",email:"editor2@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 10:00:00"},{id:"user_7",username:"editor3",nickname:"编辑员3",email:"editor3@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 11:00:00"},{id:"user_8",username:"editor4",nickname:"编辑员4",email:"editor4@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 12:00:00"},{id:"user_9",username:"editor5",nickname:"编辑员5",email:"editor5@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 13:00:00"},{id:"user_10",username:"editor6",nickname:"编辑员6",email:"editor6@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 14:00:00"},{id:"user_11",username:"editor7",nickname:"编辑员7",email:"editor7@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 15:00:00"},{id:"user_12",username:"editor8",nickname:"编辑员8",email:"editor8@example.com",deptName:"内容部",status:1,createTime:"2024-01-03 16:00:00"},{id:"user_13",username:"analyst1",nickname:"分析师1",email:"analyst1@example.com",deptName:"数据部",status:1,createTime:"2024-01-04 09:00:00"},{id:"user_14",username:"analyst2",nickname:"分析师2",email:"analyst2@example.com",deptName:"数据部",status:1,createTime:"2024-01-04 10:00:00"},{id:"user_15",username:"analyst3",nickname:"分析师3",email:"analyst3@example.com",deptName:"数据部",status:1,createTime:"2024-01-04 11:00:00"},{id:"user_16",username:"analyst4",nickname:"分析师4",email:"analyst4@example.com",deptName:"数据部",status:1,createTime:"2024-01-04 12:00:00"},{id:"user_17",username:"analyst5",nickname:"分析师5",email:"analyst5@example.com",deptName:"数据部",status:1,createTime:"2024-01-04 13:00:00"}],Ct=[{id:"admin_template",name:"管理员模板",description:"包含用户管理、角色管理等核心管理权限，适合系统管理员使用",icon:"mdi:account-key",permissions:["perm_1","perm_1_1","perm_1_1_1","perm_1_1_2","perm_1_2","perm_1_2_1","perm_1_2_2"]},{id:"editor_template",name:"编辑员模板",description:"包含内容管理相关权限，适合内容编辑人员使用",icon:"mdi:file-document-edit",permissions:["perm_2","perm_2_1","perm_2_1_1","perm_2_1_2"]},{id:"analyst_template",name:"分析师模板",description:"包含数据查看和分析权限，适合数据分析人员使用",icon:"mdi:chart-line",permissions:["perm_3","perm_3_1","perm_3_2"]},{id:"viewer_template",name:"查看员模板",description:"只包含基础查看权限，适合临时访问用户使用",icon:"mdi:eye",permissions:["perm_3_1"]}],we=(p,o)=>{for(const r of p){if(r.id===o)return r;if(r.children){const l=we(r.children,o);if(l)return l}}return null},G=(p,o)=>{[$].forEach(l=>{const u=l.findIndex(h=>h.id===p);u!==-1&&(l[u]={...l[u],...o})})},ne=(p,o=500)=>new Promise(r=>{setTimeout(()=>{r({code:"0",data:p,msg:"成功"})},o)}),zt=(p,o)=>{let r=[...p];if(o.keyword){const l=o.keyword.toLowerCase();r=r.filter(u=>u.name.toLowerCase().includes(l)||u.code.toLowerCase().includes(l)||u.description&&u.description.toLowerCase().includes(l))}return o.status!==null&&o.status!==void 0&&(r=r.filter(l=>l.status===o.status)),o.type&&(r=r.filter(l=>l.type===o.type)),r},Rt=(p,o,r)=>{const l=p.length,u=(o-1)*r,h=u+r;return{list:p.slice(u,h),total:l,page:o,pageSize:r}},St=()=>({role_1:["user_1"],role_2:["user_2","user_3","user_4"],role_3:["user_5","user_6","user_7","user_8","user_9","user_10","user_11","user_12"],role_4:["user_13","user_14","user_15","user_16","user_17"],role_5:[]}),Ut=p=>{const r=St()[p]||[];return It.filter(l=>r.includes(l.id))},Pt=async p=>{const o=zt($,p),r=Rt(o,p.page,p.pageSize);return ne(r)},$t=async()=>ne(be,300),Dt=async p=>{const o=Ut(p);return ne(o,300)},Lt={class:"role-management"},At={class:"main-content"},Mt={key:0,class:"role-detail"},Ot={class:"permission-templates"},Et=tt({__name:"index",setup(p){const o=ot(),r=y(!1),l=y(!1),u=y(!1),h=y(!1),R=y(!1),D=y(!1),S=y("add"),ae=y(null),xe=y(),N=y([]),j=y(null),b=y(null),V=y(null),Y=I([]),Q=I([]),ie=I([...Ct]),W=I([]),m=I({...se}),Ne=Tt,T=I({keyword:"",status:null,type:null}),_=I({page:1,pageSize:20,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100],showQuickJumper:!0}),Te=O(()=>S.value==="add"?"新增角色":"编辑角色"),Ie=O(()=>{if(!b.value)return[];const e=b.value;return[{key:"name",label:"角色名称",value:e.name,component:"div",props:{}},{key:"code",label:"角色编码",value:e.code,component:"div",props:{}},{key:"type",label:"角色类型",value:B[e.type].text,component:x,props:{type:B[e.type].type,size:"small"}},{key:"status",label:"角色状态",value:q[e.status].text,component:x,props:{type:q[e.status].type,size:"small"}},{key:"description",label:"角色描述",value:e.description||"-",component:"div",props:{}},{key:"userCount",label:"用户数量",value:`${e.userCount||0} 人`,component:"div",props:{}}]}),Ce=O(()=>[{key:"name",label:"角色名称",path:"name",component:ee,props:{placeholder:"请输入角色名称"}},{key:"code",label:"角色编码",path:"code",component:ee,props:{placeholder:"请输入角色编码",disabled:S.value==="edit"}},{key:"type",label:"角色类型",path:"type",component:he,props:{options:te.roleType,placeholder:"请选择角色类型",disabled:S.value==="edit"}},{key:"sort",label:"排序",path:"sort",component:rt,props:{placeholder:"请输入排序值",min:0,max:9999,style:{width:"100%"}}},{key:"status",label:"角色状态",path:"status",component:lt,props:{checkedValue:1,uncheckedValue:0}}]),ze=e=>e.id,Re=O(()=>[{key:"type",title:"角色类型",width:100,editable:!1,render:e=>d(x,{type:B[e.type].type,size:"small"},{icon:()=>d(z,{name:B[e.type].icon,size:10}),default:()=>B[e.type].text})},{key:"name",title:"角色名称",width:120,editable:!0,required:!0},{key:"code",title:"角色编码",width:120,editable:!1},{key:"description",title:"描述",width:180,editable:!0,editType:"textarea"},{key:"permissionNames",title:"权限",width:200,align:"center",editable:!1,render:e=>e.permissionNames?.length?d("div",{style:{textAlign:"center"}},[d(mt,{trigger:"hover",placement:"top",style:{maxWidth:"300px"}},{trigger:()=>d(ve,{size:4,justify:"center"},()=>[d(x,{size:"small",type:"primary"},()=>e.permissionNames[0]),e.permissionNames.length>1&&d(x,{size:"small",type:"default"},()=>`+${e.permissionNames.length-1}`)]),default:()=>d("div",{style:{padding:"8px"}},[d("div",{style:{fontWeight:"bold",marginBottom:"8px",borderBottom:"1px solid #f0f0f0",paddingBottom:"4px"}},`权限列表 (${e.permissionNames.length})`),d("div",{style:{maxHeight:"200px",overflowY:"auto"}},e.permissionNames.map(t=>d("div",{style:{padding:"2px 0",display:"flex",alignItems:"center"}},[d(z,{name:"mdi:shield-check",size:12,style:{marginRight:"6px",color:"#18a058"}}),d("span",t)])))])})]):d("div",{style:{textAlign:"center"}},"-")},{key:"userCount",title:"用户数",width:80,align:"center",editable:!1,render:e=>e.userCount?d(ke,{text:!0,type:"primary",size:"small",onClick:()=>Ke(e)},()=>`${e.userCount} 人`):d("span","0")},{key:"sort",title:"排序",width:80,editable:!0,editType:"number"},{key:"status",title:"状态",width:80,editable:!0,editType:"switch",render:e=>d(x,{type:q[e.status].type,size:"small"},()=>q[e.status].text)},{key:"createTime",title:"创建时间",width:160,editable:!1}]),Se=O(()=>({detail:{onView:e=>Oe(e)},edit:{onEdit:e=>Me(e)},delete:{onDelete:async e=>{if(e.type==="system")return o.warning("系统角色不能删除"),Promise.reject("系统角色不能删除");await Ee(e.id)},confirmText:e=>e.type==="system"?"系统角色不可删除":`确认删除角色"${e.name}"吗？`},custom:[{key:"permission",label:"权限",icon:"mdi:shield-account",type:"primary",onClick:e=>Be(e)},{key:"enable",label:"启用",icon:"mdi:play",type:"success",onClick:e=>le(e),show:e=>e.status===0&&!(e.type==="system"&&e.code==="super_admin")},{key:"disable",label:"禁用",icon:"mdi:pause",type:"warning",onClick:e=>le(e),show:e=>e.status===1&&!(e.type==="system"&&e.code==="super_admin")}]})),Ue=[{title:"用户名",key:"username",width:120},{title:"昵称",key:"nickname",width:120},{title:"邮箱",key:"email",width:200},{title:"手机号",key:"phone",width:120},{title:"部门",key:"deptName",width:120},{title:"状态",key:"status",width:80,render:e=>d(x,{type:e.status===1?"success":"error",size:"small"},{default:()=>e.status===1?"正常":"禁用"})}],oe=e=>we(be,e)?.name||"",Pe=async e=>{try{G(e.id,{name:e.name,description:e.description||void 0,status:e.status,sort:e.sort,updateTime:new Date().toLocaleString()}),o.success("修改成功"),await f()}catch{o.error("保存失败")}},Z=()=>{_.page=1,f()},$e=e=>{_.page=e,f()},De=e=>{_.pageSize=e,_.page=1,f()},Le=async()=>{await Promise.all([f(),me()]),o.success("刷新成功")},re=e=>{S.value=e?"edit":"add",e?Object.assign(m,{id:e.id,name:e.name,code:e.code,type:e.type,status:e.status,description:e.description||"",permissionIds:[],sort:e.sort,remark:e.remark||""}):Object.assign(m,se),l.value=!0},Ae=()=>{l.value=!1,Object.assign(m,se)},Me=e=>re(e),Oe=e=>{b.value=e,u.value=!0},le=async e=>{if(e.type==="system"&&e.code==="super_admin"){o.warning("超级管理员角色不能禁用");return}const t=e.status===1?0:1;G(e.id,{status:t,updateTime:new Date().toLocaleString()}),o.success(`${t===1?"启用":"禁用"}成功`),await f()},Ee=async e=>{const t=$.findIndex(U=>U.id===e);t!==-1&&($.splice(t,1),await f())},Fe=async()=>{try{if(await ae.value?.validate(),S.value==="add"){if($.find(U=>U.code===m.code))return o.error("角色编码已存在"),!1;const t={id:`role_${Date.now()}`,name:m.name,code:m.code,type:m.type,status:m.status,description:m.description||void 0,permissionIds:[],permissionNames:[],userCount:0,sort:m.sort,createTime:new Date().toLocaleString(),remark:m.remark||void 0};$.push(t),o.success("添加成功")}else G(m.id,{name:m.name,description:m.description||void 0,status:m.status,sort:m.sort,remark:m.remark||void 0,updateTime:new Date().toLocaleString()}),o.success("修改成功");return l.value=!1,await f(),!0}catch{return!1}},Be=e=>{V.value=e,N.value=[...e.permissionIds||[]],h.value=!0},je=async()=>{if(!V.value)return;const e=N.value.map(t=>oe(t)).filter(Boolean);G(V.value.id,{permissionIds:[...N.value],permissionNames:e,updateTime:new Date().toLocaleString()}),o.success("权限分配成功"),h.value=!1,await f()},Ve=()=>{const e=ie.find(t=>t.id===j.value);e&&(N.value=[...e.permissions],R.value=!1,o.success(`已应用 ${e.name}`))},Ke=async e=>{b.value=e;try{const t=await Dt(e.id);W.splice(0,W.length,...t.data),D.value=!0}catch{o.error("获取用户列表失败")}},f=async()=>{r.value=!0;try{const e={...T,page:_.page,pageSize:_.pageSize},t=await Pt(e);Y.length=0,Y.push(...t.data.list),_.itemCount=t.data.total}catch{o.error("加载角色列表失败")}finally{r.value=!1}},me=async()=>{try{const e=await $t();Q.length=0,Q.push(...e.data)}catch{o.error("加载权限列表失败")}};return st(async()=>{await Promise.all([f(),me()])}),(e,t)=>{const U=ee,pe=he,v=ve,de=ke,L=pt,A=x,H=ut,qe=dt,Ge=yt,Ye=_t,Qe=ct,We=gt,ue=kt,ce=vt,_e=ht,Ze=ft,J=bt,He=et,Je=wt,Xe=xt;return c(),C("div",Lt,[i(L,{class:"header-card"},{default:a(()=>[i(v,{justify:"space-between",align:"center"},{default:a(()=>[i(v,null,{default:a(()=>[i(U,{value:n(T).keyword,"onUpdate:value":t[0]||(t[0]=s=>n(T).keyword=s),placeholder:"搜索角色名称、编码、描述",clearable:"",style:{width:"300px"},onKeyup:nt(Z,["enter"])},{prefix:a(()=>[i(z,{name:n(K).search,size:16},null,8,["name"])]),_:1},8,["value"]),i(pe,{value:n(T).type,"onUpdate:value":[t[1]||(t[1]=s=>n(T).type=s),Z],placeholder:"角色类型",clearable:"",style:{width:"120px"},options:n(te).roleType},null,8,["value","options"]),i(pe,{value:n(T).status,"onUpdate:value":[t[2]||(t[2]=s=>n(T).status=s),Z],placeholder:"角色状态",clearable:"",style:{width:"120px"},options:n(te).roleStatus},null,8,["value","options"])]),_:1}),i(v,null,{default:a(()=>[i(de,{type:"primary",onClick:t[3]||(t[3]=s=>re())},{icon:a(()=>[i(z,{name:n(K).plus,size:16},null,8,["name"])]),default:a(()=>[t[15]||(t[15]=g(" 新增角色 ",-1))]),_:1}),i(de,{onClick:Le},{icon:a(()=>[i(z,{name:n(K).refresh,size:16},null,8,["name"])]),default:a(()=>[t[16]||(t[16]=g(" 刷新 ",-1))]),_:1})]),_:1})]),_:1})]),_:1}),ye("div",At,[i(L,{class:"content-card"},{header:a(()=>[i(v,{justify:"space-between",align:"center"},{default:a(()=>[i(H,null,{default:a(()=>[t[17]||(t[17]=g(" 角色列表 ",-1)),i(A,{type:"info",size:"small",style:{"margin-left":"8px"}},{default:a(()=>[g(" 共 "+w(n(_).itemCount)+" 个 ",1)]),_:1})]),_:1})]),_:1})]),default:a(()=>[i(it,{ref_key:"tableRef",ref:xe,columns:n(Re),data:n(Y),loading:n(r),"row-key":ze,actions:n(Se),"edit-mode":"modal","modal-title":"编辑角色","modal-width":800,size:"small",striped:"",bordered:"","single-line":"",onSave:Pe},null,8,["columns","data","loading","actions"]),i(v,{justify:"end",style:{"margin-top":"16px"}},{default:a(()=>[i(qe,{page:n(_).page,"onUpdate:page":[t[4]||(t[4]=s=>n(_).page=s),$e],"page-size":n(_).pageSize,"onUpdate:pageSize":[t[5]||(t[5]=s=>n(_).pageSize=s),De],"item-count":n(_).itemCount,"page-sizes":n(_).pageSizes,"show-size-picker":"","show-quick-jumper":""},null,8,["page","page-size","item-count","page-sizes"])]),_:1})]),_:1})]),i(We,{show:n(u),"onUpdate:show":t[6]||(t[6]=s=>P(u)?u.value=s:null),width:600,placement:"right"},{default:a(()=>[i(Qe,{title:"角色详情",closable:""},{default:a(()=>[n(b)?(c(),C("div",Mt,[i(v,{vertical:"",size:24},{default:a(()=>[i(L,{title:"基本信息",size:"small"},{default:a(()=>[i(Ye,{column:2,bordered:""},{default:a(()=>[(c(!0),C(E,null,F(n(Ie),s=>(c(),k(Ge,{key:s.key,label:s.label},{default:a(()=>[(c(),k(ge(s.component),fe({ref_for:!0},s.props),{default:a(()=>[g(w(s.value),1)]),_:2},1040))]),_:2},1032,["label"]))),128))]),_:1})]),_:1}),n(b).permissionNames?.length?(c(),k(L,{key:0,title:"权限信息",size:"small"},{default:a(()=>[i(v,null,{default:a(()=>[(c(!0),C(E,null,F(n(b).permissionNames,s=>(c(),k(A,{key:s,type:"primary",size:"medium"},{icon:a(()=>[i(z,{name:n(K).permission,size:12},null,8,["name"])]),default:a(()=>[g(" "+w(s),1)]),_:2},1024))),128))]),_:1})]),_:1})):X("",!0)]),_:1})])):X("",!0)]),_:1})]),_:1},8,["show"]),i(J,{show:n(l),"onUpdate:show":t[8]||(t[8]=s=>P(l)?l.value=s:null),preset:"dialog",title:n(Te),"positive-text":n(S)==="add"?"确认添加":"确认修改","negative-text":"取消",onPositiveClick:Fe,onNegativeClick:Ae,style:{width:"800px"}},{default:a(()=>[i(Ze,{ref_key:"formRef",ref:ae,model:n(m),rules:n(Ne),"label-placement":"left","label-width":"100px"},{default:a(()=>[i(_e,{cols:2,"x-gap":16},{default:a(()=>[(c(!0),C(E,null,F(n(Ce),s=>(c(),k(ce,{key:s.key},{default:a(()=>[i(ue,{label:s.label,path:s.path},{default:a(()=>[(c(),k(ge(s.component),fe({ref_for:!0},s.props,{value:n(m)[s.key],"onUpdate:value":M=>n(m)[s.key]=M}),null,16,["value","onUpdate:value"]))]),_:2},1032,["label","path"])]),_:2},1024))),128))]),_:1}),i(ue,{label:"备注",path:"remark"},{default:a(()=>[i(U,{value:n(m).remark,"onUpdate:value":t[7]||(t[7]=s=>n(m).remark=s),type:"textarea",placeholder:"请输入备注信息",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show","title","positive-text"]),i(He,{show:n(h),"onUpdate:show":t[9]||(t[9]=s=>P(h)?h.value=s:null),selectedIds:n(N),"onUpdate:selectedIds":t[10]||(t[10]=s=>P(N)?N.value=s:null),role:n(V),permissions:n(Q),onSave:je,onShowTemplate:t[11]||(t[11]=s=>R.value=!0)},null,8,["show","selectedIds","role","permissions"]),i(J,{show:n(R),"onUpdate:show":t[12]||(t[12]=s=>P(R)?R.value=s:null),preset:"dialog",title:"选择权限模板","positive-text":"应用模板","negative-text":"取消",onPositiveClick:Ve,style:{width:"600px"}},{default:a(()=>[ye("div",Ot,[i(_e,{cols:1,"y-gap":12},{default:a(()=>[(c(!0),C(E,null,F(n(ie),s=>(c(),k(ce,{key:s.id},{default:a(()=>[i(L,{size:"small",class:at({"template-selected":n(j)===s.id}),hoverable:"",onClick:M=>j.value=s.id},{header:a(()=>[i(v,{align:"center"},{default:a(()=>[i(Je,{checked:n(j)===s.id},null,8,["checked"]),i(z,{name:s.icon,size:18},null,8,["name"]),i(H,{strong:""},{default:a(()=>[g(w(s.name),1)]),_:2},1024),i(A,{size:"small",type:"info"},{default:a(()=>[g(w(s.permissions.length)+" 项权限",1)]),_:2},1024)]),_:2},1024)]),footer:a(()=>[i(v,{size:"small"},{default:a(()=>[(c(!0),C(E,null,F(s.permissions.slice(0,3),M=>(c(),k(A,{key:M,size:"small",type:"primary"},{default:a(()=>[g(w(oe(M)),1)]),_:2},1024))),128)),s.permissions.length>3?(c(),k(A,{key:0,size:"small",type:"default"},{default:a(()=>[g(" +"+w(s.permissions.length-3),1)]),_:2},1024)):X("",!0)]),_:2},1024)]),default:a(()=>[i(H,{depth:"3"},{default:a(()=>[g(w(s.description),1)]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1})])]),_:1},8,["show"]),i(J,{show:n(D),"onUpdate:show":t[13]||(t[13]=s=>P(D)?D.value=s:null),preset:"dialog",title:`${n(b)?.name} - 用户列表`,"positive-text":"关闭",onPositiveClick:t[14]||(t[14]=s=>D.value=!1),style:{width:"800px"}},{default:a(()=>[i(Xe,{columns:Ue,data:n(W),pagination:{pageSize:10},size:"small",striped:""},null,8,["data"])]),_:1},8,["show","title"])])}}}),ss=Nt(Et,[["__scopeId","data-v-22ce3c92"]]);export{ss as default};
