import{a0 as q,T as D,U as L,O,a1 as Q,P as Y}from"./ui-vendor-D9aA433m.js";import{k as G,r as J,e as X,c as y,o as Z,w as z,a as V,Q as u,R as o,K as l,F as w,N as x,_ as p,a7 as E,S as _,Y as m,U as d,V as k,$ as A,I as ee,a3 as te,j as ae,q as ne,n as se}from"./vue-vendor-Bom1XEVO.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"c-form-tabs"},ie={key:0,class:"single-panel"},ce={key:1,class:"tabs-container"},re={key:0,class:"tab-header"},ue={class:"tab-description"},de={class:"tab-form-items"},fe={key:0,class:"tabs-actions"},pe=G({__name:"index",props:{formItems:{},layoutConfig:{default:()=>({})},options:{default:()=>[]}},emits:["tab-change","tab-before-change","tab-validate","tab-close","tab-add"],setup(I,{expose:K,emit:M}){const T=I,f=M,a=J(""),N=X({}),P=()=>({tabs:[],type:"line",size:"medium",placement:"top",animated:!0,closable:!1,addable:!1,showTabHeader:!0,showActions:!1,showCount:!1,validateBeforeSwitch:!1,defaultTab:""}),s=y(()=>{const e=P(),t=T.layoutConfig?.tabs||{};return{...e,...t}}),C=y(()=>s.value.tabs.length>0),c=y(()=>{if(!C.value)return[];const e=new Map;return s.value.tabs.forEach(t=>{e.set(t.key,[])}),T.formItems.forEach((t,i)=>{const b=T.options?.[i]?.layout?.tab||s.value.tabs[0]?.key||"default";e.has(b)||e.set(b,[]),e.get(b).push(t)}),s.value.tabs.map(t=>({config:t,items:e.get(t.key)||[]}))}),B=(e,t)=>{if(e.key!=null)return String(e.key);const i=e.props;return i?.path?i.path:`tab-item-${t}`},v=async()=>{if(!a.value)return!0;try{f("tab-validate",a.value);const e=!0;return N[a.value]=e,e}catch{return N[a.value]=!1,!1}},h=async e=>{if(!e||e===a.value)return!0;if(!c.value.some(i=>i.config.key===e))return!1;try{if(s.value.validateBeforeSwitch&&a.value&&!await v())return!1;a.value&&f("tab-before-change",a.value,e),a.value=e;const i=c.value.findIndex(r=>r.config.key===e);return f("tab-change",e,i),!0}catch{return!1}},U=e=>{h(e)},$=e=>{f("tab-close",e)},j=()=>{f("tab-add")},S=()=>{if(!C.value||c.value.length===0)return;const{defaultTab:e}=s.value,t=e||c.value[0]?.config.key;t&&t!==a.value&&(a.value=t,se(()=>{const i=c.value.findIndex(r=>r.config.key===t);i>=0&&f("tab-change",t,i)}))};return Z(()=>{S()}),z(()=>c.value,()=>{a.value&&!c.value.some(e=>e.config.key===a.value)&&S()},{deep:!0}),z(()=>s.value.defaultTab,e=>{e&&e!==a.value&&h(e)}),K({switchToTab:h,validateCurrentTab:v,currentTab:V(a),totalTabs:y(()=>c.value.length),tabsWithItems:V(c)}),(e,t)=>{const i=O,r=L,b=D,F=q,H=Q,R=Y;return o(),u("div",le,[l(C)?(o(),u("div",ce,[_(H,{value:l(a),"onUpdate:value":[t[0]||(t[0]=n=>te(a)?a.value=n:null),U],type:l(s).type,size:l(s).size,placement:l(s).placement,animated:l(s).animated,closable:l(s).closable,addable:l(s).addable,class:"form-tabs",onClose:$,onAdd:j},{default:d(()=>[(o(!0),u(w,null,x(l(c),n=>(o(),p(F,{key:n.config.key,name:n.config.key,tab:n.config.title,disabled:n.config.disabled,closable:n.config.closable},{tab:d(()=>[_(r,{align:"center",size:8},{default:d(()=>[n.config.icon?(o(),u("div",{key:0,class:ee([n.config.icon,"tab-icon"])},null,2)):m("",!0),k("span",null,A(n.config.title),1),l(s).showCount?(o(),p(i,{key:1,value:n.items.length,max:99,show:n.items.length>0,type:"info"},null,8,["value","show"])):m("",!0)]),_:2},1024)]),default:d(()=>[l(s).showTabHeader&&n.config.description?(o(),u("div",re,[k("p",ue,A(n.config.description),1)])):m("",!0),k("div",de,[(o(!0),u(w,null,x(n.items,(g,W)=>(o(),p(E(g),{key:B(g,W)}))),128))]),n.items.length===0?(o(),p(b,{key:1,description:"暂无表单项",class:"tab-empty"})):m("",!0)]),_:2},1032,["name","tab","disabled","closable"]))),128))]),_:1},8,["value","type","size","placement","animated","closable","addable"]),l(s).showActions?(o(),u("div",fe,[_(r,{justify:"space-between"},{default:d(()=>[_(r,null,{default:d(()=>[l(s).validateBeforeSwitch?(o(),p(R,{key:0,type:"primary",size:"small",onClick:v},{default:d(()=>[...t[1]||(t[1]=[k("div",{class:"i-carbon：star-check mr-1"},null,-1),ae(" 验证当前标签 ",-1)])]),_:1})):m("",!0)]),_:1}),_(r,null,{default:d(()=>[ne(e.$slots,"tab-actions",{currentTab:l(a),totalTabs:l(c).length,validateTab:v,switchToTab:h},void 0,!0)]),_:3})]),_:3})])):m("",!0)])):(o(),u("div",ie,[(o(!0),u(w,null,x(I.formItems,(n,g)=>(o(),p(E(n),{key:B(n,g)}))),128))]))])}}}),ve=oe(pe,[["__scopeId","data-v-b8642328"]]);export{ve as default};
