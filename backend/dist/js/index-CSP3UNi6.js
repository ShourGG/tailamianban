import{z as A,aO as oe,P as ne,L as ae,ai as se,ae as le,R as ie,ag as ce,I as re,ay as de,ah as pe,aF as me}from"./ui-vendor-lRdd6BJd.js";import{m as ue,k as fe,e as R,r as $,c as J,Q as O,R as N,S as i,V as p,U as s,j as v,F as B,N as E,K as l,_ as L,$ as M,I as ge,a3 as we}from"./vue-vendor-Bom1XEVO.js";const{notification:xe}=A(["notification"]);var I=(e=>(e.XLSX=".xlsx",e.XLS=".xls",e.CSV=".csv",e.PDF=".pdf",e.DOC=".doc",e.DOCX=".docx",e.PPT=".ppt",e.PPTX=".pptx",e.TXT=".txt",e.JSON=".json",e.XML=".xml",e.ZIP=".zip",e.RAR=".rar",e.PNG=".png",e.JPG=".jpg",e.JPEG=".jpeg",e.GIF=".gif",e.SVG=".svg",e.MP4=".mp4",e.MP3=".mp3",e.WAV=".wav",e))(I||{});const ye={".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xls":"application/vnd.ms-excel",".csv":"text/csv",".pdf":"application/pdf",".doc":"application/msword",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".ppt":"application/vnd.ms-powerpoint",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".txt":"text/plain",".json":"application/json",".xml":"application/xml",".zip":"application/zip",".rar":"application/x-rar-compressed",".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".gif":"image/gif",".svg":"image/svg+xml",".mp4":"video/mp4",".mp3":"audio/mpeg",".wav":"audio/wav"},ve={loading:"文件下载中，请稍候...",success:"文件下载成功",error:"文件下载失败"},j=(e,a,n=2e3)=>{xe[e]({content:a,duration:n})},be=(e,a)=>e.endsWith(a)?e:`${e}${a}`,he=(e,a)=>{const n=ye[a]||"application/octet-stream";return new Blob([e],{type:n})},Ne=(e,a)=>{const n=navigator;return"msSaveOrOpenBlob"in navigator&&n.msSaveOrOpenBlob?(n.msSaveOrOpenBlob(e,a),!0):!1},Se=(e,a)=>{const n=URL.createObjectURL(e),o=document.createElement("a");Object.assign(o,{href:n,download:a,style:"display: none"}),document.body.appendChild(o),o.click(),setTimeout(()=>{o.remove(),URL.revokeObjectURL(n)},100)},De=(e,a)=>{Ne(e,a)||Se(e,a)},_e=(e,a)=>{const n=`${a}：${e instanceof Error?e.message:"未知错误"}`;throw new Error(n)},P=async(e,a)=>{const{fileName:n,fileType:o,params:r={},showNotification:m=!0,notificationConfig:_={}}=a,w={...ve,..._};try{m&&j("info",w.loading);const u=await e(r),x=he(u,o),T=be(n,o);De(x,T),m&&j("success",w.success)}catch(u){m&&j("error",`${w.error}：${u instanceof Error?u.message:"未知错误"}`,3e3),_e(u,w.error)}},D=e=>(a,n,o)=>P(a,{fileName:n,fileType:e,params:o}),Te=D(".xlsx"),Oe=D(".csv"),je=D(".pdf"),Ce=D(".json"),ke=()=>Object.values(I).map(e=>({label:e.toUpperCase().substring(1),value:e})),C=()=>[["序号","姓名","邮箱","部门","入职日期","薪资"],...[["1","张三","zhangsan@example.com","技术部","2023-01-15","15000"],["2","李四","lisi@example.com","市场部","2023-02-20","12000"],["3","王五","wangwu@example.com","人事部","2023-03-10","10000"],["4","赵六","zhaoliu@example.com","财务部","2023-04-05","13000"],["5","刘七","liuqi@example.com","技术部","2023-05-12","16000"]]].map(n=>n.join(",")).join(`
`),U=(e,a)=>{const n="Demo Document",o="This is a sample PDF document generated by the download demo.",r=new Date().toISOString();return`%PDF-1.4
1 0 obj
<<
/Type /Catalog
/Pages 2 0 R
>>
endobj

2 0 obj
<<
/Type /Pages
/Kids [3 0 R]
/Count 1
>>
endobj

3 0 obj
<<
/Type /Page
/Parent 2 0 R
/MediaBox [0 0 612 792]
/Contents 4 0 R
/Resources <<
/Font <<
/F1 5 0 R
>>
>>
>>
endobj

4 0 obj
<<
/Length 150
>>
stream
BT
/F1 16 Tf
50 750 Td
(${n}) Tj
0 -30 Td
/F1 12 Tf
(${o}) Tj
0 -20 Td
(Generated: ${r}) Tj
0 -20 Td
(File: ${e}) Tj
ET
endstream
endobj

5 0 obj
<<
/Type /Font
/Subtype /Type1
/BaseFont /Helvetica
>>
endobj

xref
0 6
0000000000 65535 f 
0000000009 00000 n 
0000000058 00000 n 
0000000115 00000 n 
0000000274 00000 n 
0000000476 00000 n 
trailer
<<
/Size 6
/Root 1 0 R
>>
starter
565
%%EOF`},Pe={excel:()=>({content:C(),mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),csv:()=>({content:C(),mimeType:"text/csv"}),json:e=>({content:JSON.stringify({code:200,message:"Success",data:[{id:1,name:"Sample Data",type:"demo",createTime:new Date().toISOString()},{id:2,name:"Test Data",type:"test",createTime:new Date().toISOString()}],meta:{total:2,params:e,exportTime:new Date().toISOString()}},null,2),mimeType:"application/json"}),pdf:()=>({content:U("Demo Document"),mimeType:"application/pdf"}),users:()=>({content:C(),mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),orders:()=>({content:`Order ID,Customer,Product,Quantity,Amount,Date
ORD001,John Doe,Product A,2,299.00,2024-01-15
ORD002,Jane Smith,Product B,1,599.00,2024-01-16`,mimeType:"text/csv"}),products:()=>({content:U("Product List"),mimeType:"application/pdf"}),logs:e=>({content:`System Log File
Generated: ${new Date().toISOString()}
Parameters: ${JSON.stringify(e)}

[INFO] 2024-01-15 10:00:00 - System started successfully
[INFO] 2024-01-15 10:01:00 - User login: admin
[WARN] 2024-01-15 10:02:00 - Memory usage reached 80%
[INFO] 2024-01-15 10:03:00 - Data backup completed`,mimeType:"text/plain"}),config:e=>({content:JSON.stringify({app:{name:"Robot Admin",version:"1.0.0",environment:"production"},database:{host:"localhost",port:3306,name:"robot_admin"},features:{download:!0,upload:!0,export:!0},exportTime:new Date().toISOString(),params:e},null,2),mimeType:"application/json"})},b=e=>async(a={})=>{await new Promise(m=>setTimeout(m,1e3+Math.random()*2e3));const n=Pe[e],{content:o,mimeType:r}=n?n(a):{content:`File Type: ${e}
Generated: ${new Date().toISOString()}
Parameters: ${JSON.stringify(a,null,2)}`,mimeType:"text/plain"};return new Blob([o],{type:r})},k=[{key:"users",label:"用户数据报表.xlsx"},{key:"orders",label:"订单统计.csv"},{key:"products",label:"商品清单.pdf"},{key:"logs",label:"系统日志.txt"},{key:"config",label:"配置信息.json"}],Ie=[{title:"文件名",key:"fileName"},{title:"类型",key:"fileType"},{title:"状态",key:"status",render:e=>{const n={success:{text:"成功",color:"#18a058"},failed:{text:"失败",color:"#d03050"},pending:{text:"进行中",color:"#f0a020"}}[e.status];return ue("span",{style:{color:n.color}},n.text)}},{title:"下载时间",key:"downloadTime"}],Fe={class:"download-demo"},Re={class:"demo-content"},$e={class:"button-grid"},Je={class:"batch-controls"},Be={class:"checkbox-grid"},Ee={class:"batch-actions"},Ue=fe({__name:"index",setup(e){const{message:a}=A(["message"]),n=R({excel:!1,csv:!1,pdf:!1,json:!1,custom:!1,batch:!1}),o=R({fileName:"",fileType:I.XLSX,showNotification:!0,paramsJson:""}),r=$([]),m=$([]),_=J(()=>ke().map(d=>({label:d.label,value:d.value}))),w=J(()=>({excel:{type:"primary",icon:"i-mdi:microsoft-excel",label:"下载 Excel",handler:T},csv:{type:"success",icon:"i-mdi:file-csv-outline",label:"下载 CSV",handler:V},pdf:{type:"error",icon:"i-mdi:file-pdf-box",label:"下载 PDF",handler:z},json:{type:"info",icon:"i-mdi:code-json",label:"下载 JSON",handler:G}})),u=(d,t,f)=>{m.value.unshift({id:Date.now().toString(),fileName:d,fileType:t,status:f,downloadTime:new Date().toLocaleString("zh-CN")}),m.value.length>10&&(m.value=m.value.slice(0,10))},x=async(d,t,f,g)=>{n[g]=!0;try{await d(),u(t,f,"success")}catch{u(t,f,"failed")}finally{n[g]=!1}};async function T(){await x(()=>Te(b("excel"),"用户数据报表",{format:"detailed",date:new Date().toISOString().split("T")[0]}),"用户数据报表.xlsx","XLSX","excel")}async function V(){await x(()=>Oe(b("csv"),"订单统计"),"订单统计.csv","CSV","csv")}async function z(){await x(()=>je(b("pdf"),"商品清单"),"商品清单.pdf","PDF","pdf")}async function G(){await x(()=>Ce(b("json"),"配置信息"),"配置信息.json","JSON","json")}async function X(){n.custom=!0;try{let d={};if(o.paramsJson.trim())try{d=JSON.parse(o.paramsJson)}catch{throw new Error("参数格式错误，请输入有效的 JSON")}const t={fileName:o.fileName,fileType:o.fileType,params:d,showNotification:o.showNotification,notificationConfig:{loading:`正在生成 ${o.fileName} 文件...`,success:`${o.fileName} 下载完成！`,error:`${o.fileName} 下载失败`}};await P(b("custom"),t),u(o.fileName+o.fileType,o.fileType.toUpperCase().substring(1),"success")}catch{u(o.fileName+o.fileType,o.fileType.toUpperCase().substring(1),"failed")}finally{n.custom=!1}}async function H(){n.batch=!0;try{const d=r.value.map(async t=>{const f=k.find(S=>S.key===t);if(!f)return;const g=f.label.split(".").pop()?.toLowerCase()||"txt",y=f.label.split(".")[0];await P(b(t),{fileName:y,fileType:`.${g}`,showNotification:!1}),u(f.label,g.toUpperCase(),"success")});await Promise.all(d),a.success(`批量下载完成，共 ${r.value.length} 个文件`)}catch{a.error("批量下载失败")}finally{n.batch=!1}}const q=()=>{r.value=k.map(d=>d.key)},Q=()=>{r.value=[]};return(d,t)=>{const f=oe,g=ne,y=ae,S=ie,h=le,W=ce,Y=re,Z=se,K=pe,ee=de,te=me;return N(),O("div",Fe,[i(f,{class:"demo-title"},{default:s(()=>[...t[5]||(t[5]=[v(" 下载 All - [useDownload] 场景示例 ",-1)])]),_:1}),t[15]||(t[15]=p("p",{class:"mb-20px"}," 展示支持多种文件类型的通用下载钩子函数使用方法 ",-1)),p("div",Re,[i(y,{title:"快捷下载",class:"demo-card demo-section"},{"header-extra":s(()=>[...t[6]||(t[6]=[p("span",{class:"i-mdi:flash-outline text-yellow-500"},null,-1)])]),default:s(()=>[p("div",$e,[(N(!0),O(B,null,E(l(w),(c,F)=>(N(),L(g,{key:F,type:c.type,loading:l(n)[F],onClick:c.handler},{icon:s(()=>[p("span",{class:ge(c.icon)},null,2)]),default:s(()=>[v(" "+M(c.label),1)]),_:2},1032,["type","loading","onClick"]))),128))])]),_:1}),i(y,{title:"自定义下载",class:"demo-card demo-section"},{"header-extra":s(()=>[...t[7]||(t[7]=[p("span",{class:"i-mdi:wrench-settings text-purple-500"},null,-1)])]),default:s(()=>[i(Z,{model:l(o),"label-placement":"left","label-width":"120"},{default:s(()=>[i(h,{label:"文件名称"},{default:s(()=>[i(S,{value:l(o).fileName,"onUpdate:value":t[0]||(t[0]=c=>l(o).fileName=c),placeholder:"请输入文件名称",clearable:""},null,8,["value"])]),_:1}),i(h,{label:"文件类型"},{default:s(()=>[i(W,{value:l(o).fileType,"onUpdate:value":t[1]||(t[1]=c=>l(o).fileType=c),options:l(_),placeholder:"请选择文件类型",clearable:""},null,8,["value","options"])]),_:1}),i(h,{label:"显示通知"},{default:s(()=>[i(Y,{value:l(o).showNotification,"onUpdate:value":t[2]||(t[2]=c=>l(o).showNotification=c)},null,8,["value"])]),_:1}),i(h,{label:"自定义参数"},{default:s(()=>[i(S,{value:l(o).paramsJson,"onUpdate:value":t[3]||(t[3]=c=>l(o).paramsJson=c),type:"textarea",placeholder:'例如: {"category": "report", "format": "detailed"}',rows:3},null,8,["value"])]),_:1}),i(h,null,{default:s(()=>[i(g,{type:"primary",loading:l(n).custom,disabled:!l(o).fileName||!l(o).fileType,onClick:X},{icon:s(()=>[...t[8]||(t[8]=[p("span",{class:"i-mdi:cloud-download-outline"},null,-1)])]),default:s(()=>[t[9]||(t[9]=v(" 自定义下载 ",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"])]),_:1}),i(y,{title:"批量下载",class:"demo-card demo-section"},{"header-extra":s(()=>[...t[10]||(t[10]=[p("span",{class:"i-mdi:folder text-green-500"},null,-1)])]),default:s(()=>[p("div",Je,[i(ee,{value:l(r),"onUpdate:value":t[4]||(t[4]=c=>we(r)?r.value=c:null)},{default:s(()=>[p("div",Be,[(N(!0),O(B,null,E(l(k),c=>(N(),L(K,{key:c.key,value:c.key,label:c.label},null,8,["value","label"]))),128))])]),_:1},8,["value"]),p("div",Ee,[i(g,{type:"primary",loading:l(n).batch,disabled:l(r).length===0,onClick:H},{icon:s(()=>[...t[11]||(t[11]=[p("span",{class:"i-mdi:download-multiple-outline"},null,-1)])]),default:s(()=>[v(" 批量下载 ("+M(l(r).length)+") ",1)]),_:1},8,["loading","disabled"]),i(g,{quaternary:"",type:"info",onClick:q},{default:s(()=>[...t[12]||(t[12]=[v(" 全选 ",-1)])]),_:1}),i(g,{quaternary:"",type:"warning",onClick:Q},{default:s(()=>[...t[13]||(t[13]=[v(" 清空 ",-1)])]),_:1})])])]),_:1}),i(y,{title:"下载历史",class:"demo-card demo-section"},{"header-extra":s(()=>[...t[14]||(t[14]=[p("span",{class:"i-mdi:clock-time-four-outline text-indigo-500"},null,-1)])]),default:s(()=>[i(te,{columns:l(Ie),data:l(m),pagination:{pageSize:5},size:"small"},null,8,["columns","data"])]),_:1})])])}}});export{Ue as default};
