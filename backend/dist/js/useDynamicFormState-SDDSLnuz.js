import{e as I,c as l,a as v}from"./vue-vendor-Bom1XEVO.js";const C={maxFields:20,autoSave:!1,enableSort:!0,showControls:!0,showItemControls:!0},t=[{label:"文本输入",value:"input"},{label:"数字输入",value:"inputNumber"},{label:"多行文本",value:"textarea"},{label:"下拉选择",value:"select"},{label:"开关切换",value:"switch"},{label:"评分组件",value:"rate"}],S=()=>{const e=I({config:{...C},baseFields:[],dynamicFields:[],hiddenFieldIds:new Set,fieldCounter:0,isInitialized:!1}),a=l(()=>[...e.baseFields,...e.dynamicFields.map(i=>({...i,show:!e.hiddenFieldIds.has(i.prop)}))]),c=l(()=>a.value.filter(i=>i.show!==!1)),r=l(()=>e.dynamicFields.length),F=l(()=>e.hiddenFieldIds.size),n=l(()=>e.dynamicFields.length<e.config.maxFields),o=l(()=>e.hiddenFieldIds.size===0),u=(i={})=>{if(!n.value)return;e.fieldCounter++;const d=i.type||t[Math.floor(Math.random()*t.length)].value,s={id:`dynamic_field_${e.fieldCounter}`,type:d,prop:i.prop||`dynamic_${e.fieldCounter}`,label:i.label||`动态字段 ${e.fieldCounter}`,placeholder:i.placeholder||`请输入${i.label||"内容"}`,visible:!0,removable:!0,created:Date.now(),layout:i.layout||{span:12},...i};e.dynamicFields.push(s)},m=i=>{if(e.dynamicFields.length===0)return;const d=i??e.dynamicFields.length-1;if(d<0||d>=e.dynamicFields.length)return;const s=e.dynamicFields.splice(d,1)[0];s&&e.hiddenFieldIds.delete(s.prop)},h=()=>{e.dynamicFields.forEach(i=>e.hiddenFieldIds.delete(i.prop)),e.dynamicFields.length=0,e.fieldCounter=0},y=i=>{e.hiddenFieldIds.has(i)?e.hiddenFieldIds.delete(i):e.hiddenFieldIds.add(i)},p=()=>{o.value?e.dynamicFields.forEach(i=>{e.hiddenFieldIds.add(i.prop)}):e.hiddenFieldIds.clear()},b=i=>{Object.assign(e.config,i)},f=()=>{const i={baseFields:e.baseFields,dynamicFields:e.dynamicFields,config:e.config,hiddenFields:Array.from(e.hiddenFieldIds),timestamp:Date.now()};return JSON.stringify(i,null,2)},g=(i,d={})=>{e.baseFields=[...i],Object.assign(e.config,d),e.isInitialized=!0};return{state:v(e),allFields:a,visibleFields:c,dynamicFieldsCount:r,hiddenFieldsCount:F,canAddMoreFields:n,allVisible:o,FIELD_TYPE_OPTIONS:t,addField:u,removeField:m,clearDynamicFields:h,toggleFieldVisibility:y,toggleAllVisibility:p,updateConfig:b,exportConfig:f,initialize:g}},_=Symbol("dynamicFormState");export{_ as D,S as u};
