import{C as _}from"./spline-vendor-Cs6wJgUK.js";import{u as z,_ as C}from"./ParentSize.vue_vue_type_script_setup_true_lang-CHreb_9N.js";import{k as D,r as u,c as m,o as O,w as V,E as B,Q as E,F,S as L,V as f,s as U,U as H,q as R,Y as q,M as x,n as N,R as W}from"./vue-vendor-Bom1XEVO.js";import{u as $}from"./index-COuCnG4I.js";const P=D({__name:"Spline",props:{scene:{type:String,required:!0},onLoad:Function,renderOnDemand:{type:Boolean,default:!0},style:Object},emits:["error","spline-mouse-down","spline-mouse-up","spline-mouse-hover","spline-key-down","spline-key-up","spline-start","spline-look-at","spline-follow","spline-scroll"],setup(y,{emit:w}){const k=console.log;console.log=(...n)=>{n.some(l=>typeof l=="string"&&l.includes("updating from"))||k.apply(console,n)};const r=y,o=w,a=u(null),i=u(!1),s=u(null),p=u(!0);let c=()=>{};const h=m(()=>({overflow:"hidden",...r.style})),g=m(()=>({display:"block",width:"100%",height:"100%"})),{stop:S}=z(a,([{isIntersecting:n}])=>{p.value=n,n&&s.value&&N(()=>{a.value&&s.value&&(s.value.requestRender(),s.value.setSize(a.value.clientWidth,a.value.clientHeight))})},{threshold:.1});function t(n,l){if(!l||!s.value)return;const e=$(l,50,{maxWait:100});return s.value.addEventListener(n,e),()=>s.value?.removeEventListener(n,e)}async function b(){if(a.value){i.value=!0;try{s.value&&(s.value.dispose(),s.value=null),s.value=new _(a.value,{renderOnDemand:r.renderOnDemand});const n=console.warn;console.warn=(...e)=>{e.some(v=>typeof v=="string"&&v.includes("updating from"))||n.apply(console,e)},await s.value.load(r.scene),console.warn=n;const l=[t("mouseDown",e=>o("spline-mouse-down",e)),t("mouseUp",e=>o("spline-mouse-up",e)),t("mouseHover",e=>o("spline-mouse-hover",e)),t("keyDown",e=>o("spline-key-down",e)),t("keyUp",e=>o("spline-key-up",e)),t("start",e=>o("spline-start",e)),t("lookAt",e=>o("spline-look-at",e)),t("follow",e=>o("spline-follow",e)),t("scroll",e=>o("spline-scroll",e))].filter(Boolean);return i.value=!1,r.onLoad?.(s.value),()=>{l.forEach(e=>e?.())}}catch(n){return o("error",n),i.value=!1,()=>{}}}}async function d(){c(),c=await b()??(()=>{})}return O(async()=>{await d(),V(p,n=>{n&&d()})}),B(()=>{S(),s.value&&(s.value.dispose(),s.value=null)}),(n,l)=>(W(),E(F,null,[L(C,U({"parent-size-styles":h.value,"debounce-time":50},n.$attrs),{default:H(()=>[f("canvas",{ref_key:"canvasRef",ref:a,style:x(g.value)},null,4),i.value?R(n.$slots,"default",{key:0}):q("",!0)]),_:3},16,["parent-size-styles"]),l[0]||(l[0]=f("div",{class:"login-logo"},null,-1))],64))}});export{P as _};
