import{D as G}from"./useDynamicFormState-SDDSLnuz.js";import{U as K,P as U,V as L,S as O,O as R,L as P,W as Q,X as W,Y as X}from"./ui-vendor-lRdd6BJd.js";import{k as q,i as H,c as i,Q as c,R as r,Y as J,V as a,K as n,S as o,U as t,j as u,$ as _,F as Z,N as h,_ as I,I as ee,a7 as ne}from"./vue-vendor-Bom1XEVO.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"c-form-dynamic"},oe={key:0,class:"dynamic-controls"},ae={class:"max-fields-config"},le={class:"dynamic-stats"},ie={key:1,class:"dynamic-controls-fallback"},de={class:"dynamic-form-items"},me=q({__name:"index",props:{formItems:{},layoutConfig:{default:()=>({})},options:{default:()=>[]},dynamicFormState:{default:null}},emits:["field-add","field-remove","fields-clear"],setup(F,{expose:D}){const m=F,$=H(G,null),s=i(()=>m.dynamicFormState||$),f=i(()=>!!s.value),y=i(()=>m.layoutConfig?.dynamic?.grid?.cols??24),C=i(()=>m.layoutConfig?.dynamic?.grid?.gutter??16),N=i(()=>m.layoutConfig?.dynamic?.controls?.showControls!==!1),b=i(()=>s.value?.state.config.maxFields??m.layoutConfig?.dynamic?.dynamic?.maxFields??50),p=i(()=>s.value?.dynamicFieldsCount.value??0),z=i(()=>s.value?.canAddMoreFields.value??!1),A=i(()=>m.formItems.length),B=(d,e)=>d.key?.toString()||d.props?.path||`dynamic-item-${e}`,V=d=>{const e=m.options?.[d]?.layout?.span;return typeof e=="number"&&e>0&&e<=y.value?e:Math.min(12,y.value)},M=d=>{if(!s.value)return!1;const e=d.props?.path||d.key?.toString()||"";return s.value.state.dynamicFields.some(v=>v.prop===e)};return D({addField:()=>s.value?.addField(),removeField:()=>s.value?.removeField(),clearAllDynamic:()=>s.value?.clearDynamicFields(),isDynamicStateAvailable:f,dynamicState:s}),(d,e)=>{const v=R,g=U,x=K,j=L,k=O,S=P,T=Q,Y=W,E=X;return r(),c("div",se,[n(N)&&n(f)?(r(),c("div",oe,[o(S,{size:"small",title:"动态表单控制",bordered:!1},{"header-extra":t(()=>[o(v,{value:n(p),type:"warning"},{default:t(()=>[...e[4]||(e[4]=[a("div",{class:"i-mdi:layers text-16px"},null,-1)])]),_:1},8,["value"])]),default:t(()=>[o(x,{justify:"space-between",align:"center"},{default:t(()=>[o(x,null,{default:t(()=>[o(g,{size:"small",type:"primary",disabled:!n(z),onClick:e[0]||(e[0]=l=>n(s).addField())},{icon:t(()=>[...e[5]||(e[5]=[a("div",{class:"i-mdi:plus text-14px"},null,-1)])]),default:t(()=>[u(" 添加字段 ("+_(n(p))+"/"+_(n(b))+") ",1)]),_:1},8,["disabled"]),o(g,{size:"small",type:"warning",disabled:n(p)===0,onClick:e[1]||(e[1]=l=>n(s).removeField())},{icon:t(()=>[...e[6]||(e[6]=[a("div",{class:"i-mdi:minus text-14px"},null,-1)])]),default:t(()=>[e[7]||(e[7]=u(" 移除字段 ",-1))]),_:1},8,["disabled"]),o(g,{size:"small",type:"error",disabled:n(p)===0,onClick:e[2]||(e[2]=l=>n(s).clearDynamicFields())},{icon:t(()=>[...e[8]||(e[8]=[a("div",{class:"i-mdi:delete-sweep text-14px"},null,-1)])]),default:t(()=>[e[9]||(e[9]=u(" 清空动态 ",-1))]),_:1},8,["disabled"])]),_:1}),a("div",ae,[e[10]||(e[10]=a("span",null,"最大字段数:",-1)),o(j,{value:n(b),"onUpdate:value":e[3]||(e[3]=l=>l&&n(s).updateConfig({maxFields:l})),min:5,max:50,size:"small",style:{width:"100px"}},null,8,["value"])])]),_:1}),a("div",le,[o(x,null,{default:t(()=>[o(k,{type:"info"},{default:t(()=>[u("总字段: "+_(n(A)),1)]),_:1}),o(k,{type:"warning"},{default:t(()=>[u("动态: "+_(n(p)),1)]),_:1})]),_:1})])]),_:1})])):n(N)&&!n(f)?(r(),c("div",ie,[o(S,{size:"small",title:"动态表单控制 (静态模式)",bordered:!1},{default:t(()=>[o(T,{type:"info","show-icon":""},{icon:t(()=>[...e[11]||(e[11]=[a("div",{class:"i-mdi:information-outline text-16px"},null,-1)])]),default:t(()=>[e[12]||(e[12]=u(" 当前为静态模式，如需动态功能请在父组件中提供动态表单状态。 ",-1))]),_:1})]),_:1})])):J("",!0),a("div",de,[o(E,{cols:n(y),"x-gap":n(C),"y-gap":n(C)},{default:t(()=>[(r(!0),c(Z,null,h(F.formItems,(l,w)=>(r(),I(Y,{key:B(l,w),span:V(w)},{default:t(()=>[a("div",{class:ee(["dynamic-item-wrapper",{"is-dynamic-field":M(l)}])},[(r(),I(ne(l)))],2)]),_:2},1032,["span"]))),128))]),_:1},8,["cols","x-gap","y-gap"])])])}}}),_e=te(me,[["__scopeId","data-v-a091ca6c"]]);export{_e as default};
