import{P as le,_ as oe}from"./index.vue_vue_type_script_setup_true_lang-BYfZxNJP.js";import{u as ne,D as se}from"./useDynamicFormState-SDDSLnuz.js";import{U as ie,P as re,L as de,a1 as ce,a0 as ue}from"./ui-vendor-D9aA433m.js";import{k as me,aJ as O,aK as pe,r as b,e as _e,c as R,L as fe,w as V,o as ve,n as ge,Q as I,R as F,V as c,Y as ye,S as r,U as o,K as a,j as E,$ as h,I as w,F as Fe,N as he,_ as Ce,p as Se}from"./vue-vendor-Bom1XEVO.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DP7nhEPh.js";import"./charts-vendor-PiKWrtPe.js";import"./editor-vendor-CufumsHQ.js";import"./index-DMzwf6y-.js";import"./spline-vendor-C3Tmx0e7.js";const{required:Ie}=le,Ee={maxFields:20,autoSave:!0,enableSort:!0,showControls:!0,showItemControls:!0},x=[{type:"input",prop:"name",label:"姓名",placeholder:"请输入姓名",rules:[Ie("姓名")],layout:{span:12}},{type:"select",prop:"gender",label:"性别",placeholder:"请选择性别",children:[{label:"男",value:"male"},{label:"女",value:"female"},{label:"其他",value:"other"}],layout:{span:12}},{type:"inputNumber",prop:"age",label:"年龄",placeholder:"请输入年龄",attrs:{min:1,max:120},layout:{span:8}},{type:"switch",prop:"isActive",label:"是否激活",value:!1,layout:{span:8}},{type:"rate",prop:"rating",label:"评分",value:0,layout:{span:8}},{type:"textarea",prop:"description",label:"描述",placeholder:"请输入描述信息",layout:{span:24}}],we=t=>({type:"dynamic",dynamic:{dynamic:{maxFields:t.maxFields},controls:{showControls:t.showControls,showItemControls:t.showItemControls},grid:{cols:24,gutter:16}}}),Ne={SUBMIT_DELAY:1500,MESSAGES:{SUBMIT_SUCCESS:"表单提交成功",SUBMIT_ERROR:"表单提交失败",VALIDATION_SUCCESS:"验证成功",VALIDATION_ERROR:"验证失败",FIELD_ADD:"字段添加成功",FIELD_REMOVE:"字段移除成功",FIELD_TOGGLE:"字段状态切换",FIELDS_CLEAR:"所有动态字段已清空"}},Te=[{name:"formData",tab:"表单数据",icon:"i-mdi:form-select"},{name:"config",tab:"动态配置",icon:"i-mdi:cog"},{name:"allFields",tab:"所有字段",icon:"i-mdi:view-list"}],De=(t,l)=>({totalFields:t.allFieldsCount,baseFields:t.baseFieldsCount,dynamicFields:t.dynamicFieldsCount,visibleFields:t.visibleFieldsCount,hiddenFields:t.hiddenFieldsCount,config:l.config,stateInitialized:l.isInitialized}),Oe=(t,l,m,C,d)=>({allFieldsCount:t,baseFieldsCount:l,dynamicFieldsCount:m,visibleFieldsCount:C,hiddenFieldsCount:d}),Re=(t,l)=>({config:t,isInitialized:l}),Ve=t=>t.map(l=>({prop:l.prop,label:l.label,type:l.type,required:l.rules?.some(m=>m.required)||!1,span:l.layout?.span||12})),s={submit:{type:"primary",size:"large",icon:"i-mdi:check-circle-outline",getText:t=>t?"提交中...":"提交表单"},reset:{size:"large",icon:"i-mdi:refresh",text:"重置表单"},preview:{size:"large",icon:"i-mdi:code-json",text:"预览数据"}},xe={class:"demo-page"},ze={class:"form-section"},Ae={class:"form-actions"},Le={key:0,class:"preview-section"},Me={class:"json-preview"},ke=me({__name:"index",props:O({labelPlacement:{default:"left"},validateOnChange:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:O(["submit","validate-success","validate-error","fields-change"],["update:modelValue"]),setup(t,{expose:l,emit:m}){const C=t,d=m,f=pe(t,"modelValue"),v=b(),g=b(!1),S=b(!1),p=_e({...Ee}),u=ne();Se(se,u);const{allFields:_,visibleFields:z,dynamicFieldsCount:A,hiddenFieldsCount:L}=u,M=R(()=>we(p)),{labelPlacement:k,validateOnChange:B}=fe(C),P=R(()=>{const e=Oe(_.value.length,x.length,A.value,z.value.length,L.value),n=Re(p,u.state.isInitialized);return De(e,n)}),U=e=>{switch(e){case"formData":return JSON.stringify(f.value,null,2);case"config":return JSON.stringify(P.value,null,2);case"allFields":return JSON.stringify(Ve(_.value),null,2);default:return"{}"}},N=()=>{S.value=!0},T=async e=>{try{g.value=!0,await e(),await new Promise(n=>setTimeout(n,Ne.SUBMIT_DELAY))}catch{}finally{g.value=!1}},Y=e=>{d("submit",e)},G=e=>{d("validate-success",e)},j=e=>{d("validate-error",e)},q=e=>{},J=e=>{},$=(e,n)=>{},K=()=>{},W=e=>{d("fields-change",e)},Q=async()=>v.value?.validate(),H=()=>{v.value?.resetFields()};return V(p,e=>{u.updateConfig(e)},{deep:!0}),V(_,e=>{d("fields-change",e)},{deep:!0}),ve(()=>{u.initialize(x,p),ge(()=>{d("fields-change",_.value)})}),l({validate:Q,resetFields:H,formData:f,formConfig:p,dynamicState:u,previewData:N,submitWithValidation:T,formRef:v}),(e,n)=>{const y=re,X=ie,Z=oe,D=de,ee=ue,te=ce;return F(),I("div",xe,[c("div",ze,[r(D,{size:"medium"},{default:o(()=>[r(Z,{ref_key:"formRef",ref:v,modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=i=>f.value=i),options:a(_),"layout-type":"dynamic","layout-config":a(M),"label-placement":a(k),"validate-on-value-change":a(B),onSubmit:Y,onValidateSuccess:G,onValidateError:j,onFieldAdd:q,onFieldRemove:J,onFieldToggle:$,onFieldsClear:K,onFieldsChange:W},{action:o(({validate:i,reset:ae})=>[c("div",Ae,[r(X,{justify:"center"},{default:o(()=>[r(y,{type:a(s).submit.type,size:a(s).submit.size,loading:a(g),onClick:Be=>T(i)},{icon:o(()=>[c("div",{class:w(a(s).submit.icon)},null,2)]),default:o(()=>[E(" "+h(a(s).submit.getText(a(g))),1)]),_:1},8,["type","size","loading","onClick"]),r(y,{size:a(s).reset.size,onClick:ae},{icon:o(()=>[c("div",{class:w(a(s).reset.icon)},null,2)]),default:o(()=>[E(" "+h(a(s).reset.text),1)]),_:2},1032,["size","onClick"]),r(y,{size:a(s).preview.size,onClick:N},{icon:o(()=>[c("div",{class:w(a(s).preview.icon)},null,2)]),default:o(()=>[E(" "+h(a(s).preview.text),1)]),_:1},8,["size"])]),_:2},1024)])]),_:1},8,["modelValue","options","layout-config","label-placement","validate-on-value-change"])]),_:1})]),a(S)?(F(),I("div",Le,[r(D,{title:"数据预览",size:"small"},{"header-extra":o(()=>[r(y,{size:"small",onClick:n[1]||(n[1]=i=>S.value=!1)},{icon:o(()=>[...n[2]||(n[2]=[c("div",{class:"i-mdi:close"},null,-1)])]),_:1})]),default:o(()=>[r(te,{type:"line",animated:""},{default:o(()=>[(F(!0),I(Fe,null,he(a(Te),i=>(F(),Ce(ee,{key:i.name,name:i.name,tab:i.tab},{default:o(()=>[c("div",Me,[c("pre",null,h(U(i.name)),1)])]),_:2},1032,["name","tab"]))),128))]),_:1})]),_:1})])):ye("",!0)])}}}),Qe=be(ke,[["__scopeId","data-v-95d1a4ad"]]);export{Qe as default};
