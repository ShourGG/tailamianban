# ğŸ® æ³°æ‹‰ç‘äºšæœåŠ¡å™¨ç®¡ç†é¢æ¿ - å®Œæ•´åˆ¶ä½œæ•™ç¨‹

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®åç§°**: æ³°æ‹‰ç‘äºšæœåŠ¡å™¨ç®¡ç†é¢æ¿  
**æŠ€æœ¯æ ˆ**: Go + Vue3 + SQLite  
**éƒ¨ç½²æ–¹å¼**: LinuxæœåŠ¡å™¨ + systemdæœåŠ¡  
**åŠŸèƒ½**: æœåŠ¡å™¨å¯åœã€é…ç½®ç®¡ç†ã€ç©å®¶ç®¡ç†ã€å¤‡ä»½æ¢å¤

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
terraria-panel/
â”œâ”€â”€ backend/                 # Goåç«¯
â”‚   â”œâ”€â”€ main.go             # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ handlers/           # APIå¤„ç†å™¨
â”‚   â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ go.mod              # Goä¾èµ–
â”œâ”€â”€ frontend/               # Vue3å‰ç«¯
â”‚   â”œâ”€â”€ src/                # æºç 
â”‚   â”œâ”€â”€ dist/               # æ„å»ºäº§ç‰©
â”‚   â””â”€â”€ package.json        # å‰ç«¯ä¾èµ–
â”œâ”€â”€ scripts/                # éƒ¨ç½²è„šæœ¬
â””â”€â”€ docs/                   # æ–‡æ¡£
```

---

## ğŸš€ ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡

### 1.1 æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 7+
- **å†…å­˜**: æœ€ä½2GBï¼Œæ¨è4GB+
- **å­˜å‚¨**: æœ€ä½20GBå¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: å…¬ç½‘IPï¼Œ**åªéœ€å¼€æ”¾ä¸€ä¸ªç«¯å£** (80/443æˆ–8080)

### 1.2 ç«¯å£è®¾è®¡åŸåˆ™ â­
```
âœ… æ­£ç¡®è®¾è®¡: å•ç«¯å£ç»Ÿä¸€å…¥å£
å…¬ç½‘ç«¯å£: 80/443 (ç”Ÿäº§) æˆ– 8080 (å¼€å‘)
â”œâ”€â”€ / (å‰ç«¯é¡µé¢)
â”œâ”€â”€ /api/ (åç«¯API)
â””â”€â”€ /ws/ (WebSocket)

å†…ç½‘æœåŠ¡:
â”œâ”€â”€ é¢æ¿åç«¯: 127.0.0.1:8080
â””â”€â”€ æ³°æ‹‰ç‘äºš: 127.0.0.1:7777 (ä¸å¯¹å¤–å¼€æ”¾!)

âŒ é”™è¯¯è®¾è®¡: å¤šç«¯å£æš´éœ²
å‰ç«¯:3000 + åç«¯:8080 + æ¸¸æˆ:7777 = å®‰å…¨é£é™©!
```

### 1.2 åŸºç¡€è½¯ä»¶å®‰è£…
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…å¿…è¦å·¥å…·
sudo apt install -y wget curl git unzip

# å®‰è£…Go (1.19+)
wget https://go.dev/dl/go1.21.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.21.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc

# éªŒè¯å®‰è£…
go version
```

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šåç«¯å¼€å‘

### 2.1 åˆå§‹åŒ–Goé¡¹ç›®
```bash
mkdir terraria-panel && cd terraria-panel
mkdir backend && cd backend
go mod init terraria-panel
```

### 2.2 æ ¸å¿ƒä¾èµ–
```bash
go get github.com/gin-gonic/gin
go get github.com/gin-contrib/cors
go get gorm.io/gorm
go get gorm.io/driver/sqlite
go get github.com/joho/godotenv
```

### 2.3 ä¸»ç¨‹åºç»“æ„ (main.go)
```go
package main

import (
    "log"
    "net/http"
    "github.com/gin-gonic/gin"
    "github.com/gin-contrib/cors"
)

func main() {
    // åˆ›å»ºGinå¼•æ“
    r := gin.Default()
    
    // é…ç½®CORS
    r.Use(cors.Default())
    
    // é™æ€æ–‡ä»¶æœåŠ¡ (å…³é”®é…ç½®!)
    r.Static("/assets", "./frontend/dist/assets")
    r.Static("/js", "./frontend/dist/js")
    r.StaticFile("/favicon.ico", "./frontend/dist/favicon.ico")
    
    // SPAè·¯ç”±æ”¯æŒ (é‡è¦!)
    r.NoRoute(func(c *gin.Context) {
        c.File("./frontend/dist/index.html")
    })
    
    // APIè·¯ç”±
    api := r.Group("/api/v1")
    {
        api.GET("/health", healthCheck)
        api.GET("/server/status", getServerStatus)
        api.POST("/server/start", startServer)
        api.POST("/server/stop", stopServer)
    }
    
    log.Println("ğŸš€ æ³°æ‹‰ç‘äºšé¢æ¿å¯åŠ¨æˆåŠŸ!")
    log.Println("ğŸŒ Webç•Œé¢: http://localhost:8080")
    log.Println("ğŸ“Š APIæ–‡æ¡£: http://localhost:8080/api/v1/health")
    
    r.Run(":8080")
}

func healthCheck(c *gin.Context) {
    c.JSON(http.StatusOK, gin.H{
        "message": "Terraria Panel API is running",
        "status":  "ok",
        "version": "1.0.0",
        "service": "terraria-panel",
    })
}

func getServerStatus(c *gin.Context) {
    // TODO: å®ç°æœåŠ¡å™¨çŠ¶æ€æ£€æŸ¥
    c.JSON(http.StatusOK, gin.H{
        "status": "stopped",
        "players": 0,
        "uptime": "0s",
    })
}

func startServer(c *gin.Context) {
    // TODO: å®ç°æœåŠ¡å™¨å¯åŠ¨
    c.JSON(http.StatusOK, gin.H{"message": "Server starting..."})
}

func stopServer(c *gin.Context) {
    // TODO: å®ç°æœåŠ¡å™¨åœæ­¢
    c.JSON(http.StatusOK, gin.H{"message": "Server stopping..."})
}
```

---

## ğŸ¨ ç¬¬ä¸‰æ­¥ï¼šå‰ç«¯å¼€å‘

### 3.1 Vue3é¡¹ç›®åˆå§‹åŒ–
```bash
cd ../
npm create vue@latest frontend
cd frontend
npm install
```

### 3.2 æ ¸å¿ƒä¾èµ–
```bash
npm install axios
npm install @element-plus/icons-vue
npm install element-plus
```

### 3.3 æ„å»ºå‰ç«¯
```bash
npm run build
# æ„å»ºäº§ç‰©åœ¨ dist/ ç›®å½•
```

---

## ğŸ“¦ ç¬¬å››æ­¥ï¼šé¡¹ç›®æ‰“åŒ…

### 4.1 åˆ›å»ºæ„å»ºè„šæœ¬
```bash
# åˆ›å»º scripts/build.sh
#!/bin/bash
set -e

echo "ğŸ—ï¸ å¼€å§‹æ„å»ºæ³°æ‹‰ç‘äºšé¢æ¿..."

# æ„å»ºå‰ç«¯
echo "ğŸ“¦ æ„å»ºå‰ç«¯..."
cd frontend
npm install
npm run build
cd ..

# æ„å»ºåç«¯
echo "ğŸ”§ æ„å»ºåç«¯..."
cd backend
CGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build -o ../terraria-panel
cd ..

echo "âœ… æ„å»ºå®Œæˆ!"
echo "ğŸ“ å¯æ‰§è¡Œæ–‡ä»¶: ./terraria-panel"
echo "ğŸ“ å‰ç«¯æ–‡ä»¶: ./frontend/dist/"
```

### 4.2 æ‰§è¡Œæ„å»º
```bash
chmod +x scripts/build.sh
./scripts/build.sh
```

---

## ğŸš€ ç¬¬äº”æ­¥ï¼šæœåŠ¡å™¨éƒ¨ç½²

### 5.1 åˆ›å»ºéƒ¨ç½²ç›®å½•
```bash
sudo mkdir -p /opt/terraria-panel
sudo chown $USER:$USER /opt/terraria-panel
```

### 5.2 ä¸Šä¼ æ–‡ä»¶
```bash
# ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶
scp terraria-panel user@server:/opt/terraria-panel/

# ä¸Šä¼ å‰ç«¯æ–‡ä»¶
scp -r frontend/dist user@server:/opt/terraria-panel/frontend/

# è®¾ç½®æƒé™
ssh user@server "chmod +x /opt/terraria-panel/terraria-panel"
```

### 5.3 åˆ›å»ºsystemdæœåŠ¡
```bash
sudo cat > /etc/systemd/system/terraria-panel.service << 'EOF'
[Unit]
Description=Terraria Panel Service
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/terraria-panel
ExecStart=/opt/terraria-panel/terraria-panel
Restart=always
RestartSec=5
Environment=GIN_MODE=release

[Install]
WantedBy=multi-user.target
EOF
```

### 5.4 å¯åŠ¨æœåŠ¡
```bash
sudo systemctl daemon-reload
sudo systemctl enable terraria-panel
sudo systemctl start terraria-panel
sudo systemctl status terraria-panel
```

---

## ğŸ” ç¬¬å…­æ­¥ï¼šé—®é¢˜æ’æŸ¥

### 6.1 å¸¸è§é—®é¢˜

**é—®é¢˜1: é¡µé¢ç©ºç™½**
```bash
# æ£€æŸ¥é™æ€æ–‡ä»¶
ls -la /opt/terraria-panel/frontend/dist/

# æ£€æŸ¥æœåŠ¡æ—¥å¿—
sudo journalctl -u terraria-panel -f

# è§£å†³æ–¹æ¡ˆ: ç¡®ä¿WorkingDirectoryæ­£ç¡®
sudo systemctl edit --full terraria-panel
# æ·»åŠ : WorkingDirectory=/opt/terraria-panel
```

**é—®é¢˜2: APIæ— æ³•è®¿é—®**
```bash
# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep 8080

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw allow 8080
```

**é—®é¢˜3: æƒé™é—®é¢˜**
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
sudo chown -R root:root /opt/terraria-panel
sudo chmod +x /opt/terraria-panel/terraria-panel
```

### 6.2 è°ƒè¯•å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status terraria-panel

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
sudo journalctl -u terraria-panel -f

# é‡å¯æœåŠ¡
sudo systemctl restart terraria-panel

# æ£€æŸ¥é…ç½®
sudo systemctl cat terraria-panel
```

---

## ğŸ¯ ç¬¬ä¸ƒæ­¥ï¼šä¸€é”®å®‰è£…è„šæœ¬

### 7.1 åˆ›å»ºè‡ªåŠ¨å®‰è£…è„šæœ¬
```bash
# åˆ›å»º install.sh
#!/bin/bash
set -e

echo "ğŸ® æ³°æ‹‰ç‘äºšé¢æ¿ä¸€é”®å®‰è£…è„šæœ¬"
echo "================================"

# æ£€æŸ¥ç³»ç»Ÿ
if [[ "$EUID" -ne 0 ]]; then
    echo "âŒ è¯·ä½¿ç”¨rootæƒé™è¿è¡Œæ­¤è„šæœ¬"
    exit 1
fi

# å®‰è£…ä¾èµ–
echo "ğŸ“¦ å®‰è£…ç³»ç»Ÿä¾èµ–..."
apt update && apt install -y wget curl unzip

# åˆ›å»ºç›®å½•
echo "ğŸ“ åˆ›å»ºå®‰è£…ç›®å½•..."
mkdir -p /opt/terraria-panel/{frontend,terraria,logs,backups,data}
cd /opt/terraria-panel

# ä¸‹è½½ç¨‹åº
echo "â¬‡ï¸ ä¸‹è½½ç¨‹åºæ–‡ä»¶..."
wget -O terraria-panel https://github.com/ä½ çš„ç”¨æˆ·å/terraria-panel/releases/latest/download/terraria-panel
chmod +x terraria-panel

# ä¸‹è½½å‰ç«¯
echo "â¬‡ï¸ ä¸‹è½½å‰ç«¯æ–‡ä»¶..."
wget -O frontend.tar.gz https://github.com/ä½ çš„ç”¨æˆ·å/terraria-panel/releases/latest/download/frontend.tar.gz
tar -xzf frontend.tar.gz -C frontend/
rm frontend.tar.gz

# åˆ›å»ºé…ç½®æ–‡ä»¶
echo "âš™ï¸ åˆ›å»ºé…ç½®æ–‡ä»¶..."
cat > .env << 'EOF'
# æœåŠ¡å™¨é…ç½®
PORT=8080
GIN_MODE=release

# æ•°æ®åº“é…ç½®
DB_PATH=./data/panel.db

# æ³°æ‹‰ç‘äºšæœåŠ¡å™¨é…ç½®
TERRARIA_PATH=./terraria
TERRARIA_WORLD_PATH=./terraria/worlds
TERRARIA_CONFIG_PATH=./terraria/config

# ç®¡ç†å‘˜é…ç½®
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin123

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_PATH=./logs
EOF

# åˆ›å»ºsystemdæœåŠ¡
echo "ğŸ”§ åˆ›å»ºç³»ç»ŸæœåŠ¡..."
cat > /etc/systemd/system/terraria-panel.service << 'EOF'
[Unit]
Description=Terraria Panel Service
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/terraria-panel
ExecStart=/opt/terraria-panel/terraria-panel
Restart=always
RestartSec=5
Environment=GIN_MODE=release

[Install]
WantedBy=multi-user.target
EOF

# å¯åŠ¨æœåŠ¡
echo "ğŸš€ å¯åŠ¨æœåŠ¡..."
systemctl daemon-reload
systemctl enable terraria-panel
systemctl start terraria-panel

# æ£€æŸ¥çŠ¶æ€
sleep 3
if systemctl is-active --quiet terraria-panel; then
    echo "âœ… å®‰è£…æˆåŠŸ!"
    echo ""
    echo "ğŸŒ è®¿é—®åœ°å€: http://$(curl -s ifconfig.me):8080"
    echo "ğŸ‘¤ é»˜è®¤è´¦å·: admin"
    echo "ğŸ”‘ é»˜è®¤å¯†ç : admin123"
    echo ""
    echo "ğŸ“Š æŸ¥çœ‹çŠ¶æ€: systemctl status terraria-panel"
    echo "ğŸ“‹ æŸ¥çœ‹æ—¥å¿—: journalctl -u terraria-panel -f"
else
    echo "âŒ å®‰è£…å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—: journalctl -u terraria-panel"
fi
```

### 7.2 ä½¿ç”¨æ–¹æ³•
```bash
# ä¸‹è½½å¹¶è¿è¡Œå®‰è£…è„šæœ¬
curl -fsSL https://raw.githubusercontent.com/ä½ çš„ç”¨æˆ·å/terraria-panel/main/install.sh | bash

# æˆ–è€…æ‰‹åŠ¨ä¸‹è½½
wget https://raw.githubusercontent.com/ä½ çš„ç”¨æˆ·å/terraria-panel/main/install.sh
chmod +x install.sh
sudo ./install.sh
```

---

## ğŸ”§ ç¬¬å…«æ­¥ï¼šé«˜çº§åŠŸèƒ½

### 8.1 æ³°æ‹‰ç‘äºšæœåŠ¡å™¨é›†æˆ
```go
// æ·»åŠ åˆ°åç«¯ä»£ç 
func startTerrariaServer(c *gin.Context) {
    cmd := exec.Command("./terraria/TerrariaServer.exe", "-config", "./terraria/config.txt")
    cmd.Dir = "/opt/terraria-panel"

    if err := cmd.Start(); err != nil {
        c.JSON(500, gin.H{"error": err.Error()})
        return
    }

    c.JSON(200, gin.H{"message": "æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ", "pid": cmd.Process.Pid})
}
```

### 8.2 å®æ—¶ç›‘æ§
```javascript
// å‰ç«¯WebSocketè¿æ¥
const ws = new WebSocket('ws://localhost:8080/ws')
ws.onmessage = (event) => {
    const data = JSON.parse(event.data)
    updateServerStatus(data)
}
```

### 8.3 è‡ªåŠ¨å¤‡ä»½
```bash
# æ·»åŠ å®šæ—¶ä»»åŠ¡
echo "0 2 * * * /opt/terraria-panel/scripts/backup.sh" | crontab -
```

---

## ğŸ›¡ï¸ ç¬¬ä¹æ­¥ï¼šå®‰å…¨åŠ å›º

### 9.1 é˜²ç«å¢™é…ç½®
```bash
# åªå¼€æ”¾å¿…è¦ç«¯å£
ufw --force reset
ufw default deny incoming
ufw default allow outgoing
ufw allow ssh
ufw allow 8080/tcp
ufw --force enable
```

### 9.2 SSLè¯ä¹¦ (å¯é€‰)
```bash
# ä½¿ç”¨Let's Encrypt
apt install -y certbot
certbot certonly --standalone -d your-domain.com
```

### 9.3 å•ç«¯å£åå‘ä»£ç† (æ¨èç”Ÿäº§æ¶æ„) â­
```nginx
# /etc/nginx/sites-available/terraria-panel
server {
    listen 80;  # åªå¼€æ”¾ä¸€ä¸ªå…¬ç½‘ç«¯å£!
    server_name your-domain.com;

    # å‰ç«¯é™æ€æ–‡ä»¶ (ä¼˜å…ˆçº§æœ€é«˜)
    location / {
        root /opt/terraria-panel/frontend/dist;
        try_files $uri $uri/ /index.html;

        # ç¼“å­˜é™æ€èµ„æº
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }

    # åç«¯APIä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # WebSocketä»£ç† (å®æ—¶é€šä¿¡)
    location /ws/ {
        proxy_pass http://127.0.0.1:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}

# HTTPSç‰ˆæœ¬ (ç”Ÿäº§å¿…å¤‡)
server {
    listen 443 ssl http2;
    server_name your-domain.com;

    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;

    # å…¶ä»–é…ç½®åŒä¸Š...
}
```

### 9.4 é˜²ç«å¢™é…ç½® (å•ç«¯å£ç­–ç•¥)
```bash
# é‡ç½®é˜²ç«å¢™
ufw --force reset

# é»˜è®¤ç­–ç•¥
ufw default deny incoming
ufw default allow outgoing

# åªå¼€æ”¾å¿…è¦ç«¯å£
ufw allow ssh                    # SSHç®¡ç†
ufw allow 80/tcp                 # HTTP (ç”Ÿäº§)
ufw allow 443/tcp                # HTTPS (ç”Ÿäº§)
# ufw allow 8080/tcp             # å¼€å‘ç¯å¢ƒ (å¯é€‰)

# å¯ç”¨é˜²ç«å¢™
ufw --force enable

# æ£€æŸ¥çŠ¶æ€
ufw status numbered
```

### 9.5 å†…ç½‘æœåŠ¡å®‰å…¨
```bash
# ç¡®ä¿æ³°æ‹‰ç‘äºšåªç›‘å¬å†…ç½‘
# åœ¨æ³°æ‹‰ç‘äºšé…ç½®æ–‡ä»¶ä¸­è®¾ç½®:
# ip=127.0.0.1
# port=7777

# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tlnp | grep :7777
# åº”è¯¥æ˜¾ç¤º: 127.0.0.1:7777 (ä¸æ˜¯ 0.0.0.0:7777)
```

---

## ğŸ“š å‚è€ƒèµ„æº

- **Go Ginæ¡†æ¶**: https://gin-gonic.com/
- **Vue3å®˜æ–¹æ–‡æ¡£**: https://vuejs.org/
- **æ³°æ‹‰ç‘äºšæœåŠ¡å™¨**: https://terraria.fandom.com/wiki/Server
- **systemdæœåŠ¡**: https://systemd.io/

---

## ğŸ‰ æ€»ç»“

è¿™ä¸ªå®Œæ•´æ•™ç¨‹åŒ…å«ï¼š

1. **å¼€å‘ç¯å¢ƒæ­å»º** - Go + Vue3 + å·¥å…·é“¾
2. **é¡¹ç›®æ¶æ„è®¾è®¡** - å‰åç«¯åˆ†ç¦»ï¼ŒRESTful API
3. **æ ¸å¿ƒåŠŸèƒ½å®ç°** - æœåŠ¡å™¨ç®¡ç†ï¼ŒçŠ¶æ€ç›‘æ§
4. **éƒ¨ç½²è‡ªåŠ¨åŒ–** - ä¸€é”®å®‰è£…è„šæœ¬ï¼ŒsystemdæœåŠ¡
5. **é—®é¢˜æ’æŸ¥æŒ‡å—** - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
6. **å®‰å…¨åŠ å›º** - é˜²ç«å¢™ï¼ŒSSLï¼Œåå‘ä»£ç†

**å…³é”®æˆåŠŸå› ç´ **:
- æ­£ç¡®çš„é™æ€æ–‡ä»¶æœåŠ¡é…ç½®
- åˆé€‚çš„å·¥ä½œç›®å½•è®¾ç½®
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—
- è‡ªåŠ¨åŒ–çš„éƒ¨ç½²æµç¨‹

**è€ç‹çš„å»ºè®®**: å…ˆè·‘é€šåŸºç¡€åŠŸèƒ½ï¼Œå†é€æ­¥æ·»åŠ é«˜çº§ç‰¹æ€§ã€‚ä»£ç è¦å†™å¾—ç®€æ´æ˜äº†ï¼Œéƒ¨ç½²è¦åšåˆ°ä¸€é”®æå®šï¼

---

*è€ç‹æš´èºæŠ€æœ¯æµå‡ºå“ - ä¸“æ²»å„ç§ä¸æœ - 2024å¹´9æœˆ*
